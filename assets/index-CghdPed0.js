(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();const zh=!1;var Hh=Array.isArray,km=Array.prototype.indexOf,$a=Array.from,Wh=Object.defineProperty,nr=Object.getOwnPropertyDescriptor,Gh=Object.getOwnPropertyDescriptors,Nm=Object.prototype,Dm=Array.prototype,za=Object.getPrototypeOf,rl=Object.isExtensible;const rr=()=>{};function Vm(n){return n()}function aa(n){for(var e=0;e<n.length;e++)n[e]()}function Kh(){var n,e,t=new Promise((r,s)=>{n=r,e=s});return{promise:t,resolve:n,reject:e}}const Oe=2,Ha=4,Hi=8,xt=16,Ft=32,Un=64,Wi=128,at=512,Re=1024,Ge=2048,bt=4096,Ye=8192,Yt=16384,Wa=32768,dr=65536,sl=1<<17,Qh=1<<18,Pr=1<<19,Xh=1<<20,ds=32768,ca=1<<21,Ga=1<<22,Zt=1<<23,sr=Symbol("$state"),Om=Symbol("legacy props"),Mm=Symbol(""),er=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function Lm(n){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function xm(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function Fm(n){throw new Error("https://svelte.dev/e/effect_in_teardown")}function Um(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Bm(n){throw new Error("https://svelte.dev/e/effect_orphan")}function jm(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function qm(n){throw new Error("https://svelte.dev/e/props_invalid_value")}function $m(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function zm(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Hm(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function Wm(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const Gm=1,Km=2,Qm=16,Xm=2,Jm=4,Ym=8,Zm=1,eg=2,Ne=Symbol(),tg="http://www.w3.org/1999/xhtml";function ng(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}let rg=!1;function Jh(n){return n===this.v}function Yh(n,e){return n!=n?e==e:n!==e||n!==null&&typeof n=="object"||typeof n=="function"}function Zh(n){return!Yh(n,this.v)}let Cr=!1,sg=!1;function ig(){Cr=!0}let ce=null;function pr(n){ce=n}function Bn(n,e=!1,t){ce={p:ce,i:!1,c:null,e:null,s:n,x:null,l:Cr&&!e?{s:null,u:null,$:[]}:null}}function jn(n){var e=ce,t=e.e;if(t!==null){e.e=null;for(var r of t)mf(r)}return e.i=!0,ce=e.p,{}}function As(){return!Cr||ce!==null&&ce.l===null}let wn=[];function ef(){var n=wn;wn=[],aa(n)}function Gi(n){if(wn.length===0&&!is){var e=wn;queueMicrotask(()=>{e===wn&&ef()})}wn.push(n)}function og(){for(;wn.length>0;)ef()}function tf(n){var e=J;if(e===null)return X.f|=Zt,n;if((e.f&Wa)===0){if((e.f&Wi)===0)throw n;e.b.error(n)}else mr(n,e)}function mr(n,e){for(;e!==null;){if((e.f&Wi)!==0)try{e.b.error(n);return}catch(t){n=t}e=e.parent}throw n}const Js=new Set;let ie=null,ii=null,Xe=null,ft=[],Ki=null,ua=!1,is=!1;class dt{committed=!1;current=new Map;previous=new Map;#e=new Set;#t=new Set;#n=0;#r=0;#c=null;#o=[];#a=[];skipped_effects=new Set;is_fork=!1;process(e){ft=[],ii=null,this.apply();var t={parent:null,effect:null,effects:[],render_effects:[],block_effects:[]};for(const r of e)this.#s(r,t);this.is_fork||this.#u(),this.#r>0||this.is_fork?(this.#i(t.effects),this.#i(t.render_effects),this.#i(t.block_effects)):(ii=this,ie=null,il(t.render_effects),il(t.effects),ii=null,this.#c?.resolve()),Xe=null}#s(e,t){e.f^=Re;for(var r=e.first;r!==null;){var s=r.f,i=(s&(Ft|Un))!==0,a=i&&(s&Re)!==0,c=a||(s&Ye)!==0||this.skipped_effects.has(r);if((r.f&Wi)!==0&&r.b?.is_pending()&&(t={parent:t,effect:r,effects:[],render_effects:[],block_effects:[]}),!c&&r.fn!==null){i?r.f^=Re:(s&Ha)!==0?t.effects.push(r):kr(r)&&((r.f&xt)!==0&&t.block_effects.push(r),_r(r));var l=r.first;if(l!==null){r=l;continue}}var h=r.parent;for(r=r.next;r===null&&h!==null;)h===t.effect&&(this.#i(t.effects),this.#i(t.render_effects),this.#i(t.block_effects),t=t.parent),r=h.next,h=h.parent}}#i(e){for(const t of e)((t.f&Ge)!==0?this.#o:this.#a).push(t),Se(t,Re)}capture(e,t){this.previous.has(e)||this.previous.set(e,t),(e.f&Zt)===0&&(this.current.set(e,e.v),Xe?.set(e,e.v))}activate(){ie=this,this.apply()}deactivate(){ie=null,Xe=null}flush(){if(this.activate(),ft.length>0){if(nf(),ie!==null&&ie!==this)return}else this.#n===0&&this.process([]);this.deactivate()}discard(){for(const e of this.#t)e(this);this.#t.clear()}#u(){if(this.#r===0){for(const e of this.#e)e();this.#e.clear()}this.#n===0&&this.#l()}#l(){if(Js.size>1){this.previous.clear();var e=Xe,t=!0,r={parent:null,effect:null,effects:[],render_effects:[],block_effects:[]};for(const s of Js){if(s===this){t=!1;continue}const i=[];for(const[c,l]of this.current){if(s.current.has(c))if(t&&l!==s.current.get(c))s.current.set(c,l);else continue;i.push(c)}if(i.length===0)continue;const a=[...s.current.keys()].filter(c=>!this.current.has(c));if(a.length>0){const c=new Set,l=new Map;for(const h of i)rf(h,a,c,l);if(ft.length>0){ie=s,s.apply();for(const h of ft)s.#s(h,r);ft=[],s.deactivate()}}}ie=null,Xe=e}this.committed=!0,Js.delete(this)}increment(e){this.#n+=1,e&&(this.#r+=1)}decrement(e){this.#n-=1,e&&(this.#r-=1),this.revive()}revive(){for(const e of this.#o)Se(e,Ge),Dn(e);for(const e of this.#a)Se(e,bt),Dn(e);this.#o=[],this.#a=[],this.flush()}oncommit(e){this.#e.add(e)}ondiscard(e){this.#t.add(e)}settled(){return(this.#c??=Kh()).promise}static ensure(){if(ie===null){const e=ie=new dt;Js.add(ie),is||dt.enqueue(()=>{ie===e&&e.flush()})}return ie}static enqueue(e){Gi(e)}apply(){}}function ag(n){var e=is;is=!0;try{for(var t;;){if(og(),ft.length===0&&(ie?.flush(),ft.length===0))return Ki=null,t;nf()}}finally{is=e}}function nf(){var n=Rn;ua=!0;try{var e=0;for(cl(!0);ft.length>0;){var t=dt.ensure();if(e++>1e3){var r,s;cg()}t.process(ft),en.clear()}}finally{ua=!1,cl(n),Ki=null}}function cg(){try{jm()}catch(n){mr(n,Ki)}}let St=null;function il(n){var e=n.length;if(e!==0){for(var t=0;t<e;){var r=n[t++];if((r.f&(Yt|Ye))===0&&kr(r)&&(St=new Set,_r(r),r.deps===null&&r.first===null&&r.nodes_start===null&&(r.teardown===null&&r.ac===null?yf(r):r.fn=null),St?.size>0)){en.clear();for(const s of St){if((s.f&(Yt|Ye))!==0)continue;const i=[s];let a=s.parent;for(;a!==null;)St.has(a)&&(St.delete(a),i.push(a)),a=a.parent;for(let c=i.length-1;c>=0;c--){const l=i[c];(l.f&(Yt|Ye))===0&&_r(l)}}St.clear()}}St=null}}function rf(n,e,t,r){if(!t.has(n)&&(t.add(n),n.reactions!==null))for(const s of n.reactions){const i=s.f;(i&Oe)!==0?rf(s,e,t,r):(i&(Ga|xt))!==0&&(i&Ge)===0&&sf(s,e,r)&&(Se(s,Ge),Dn(s))}}function sf(n,e,t){const r=t.get(n);if(r!==void 0)return r;if(n.deps!==null)for(const s of n.deps){if(e.includes(s))return!0;if((s.f&Oe)!==0&&sf(s,e,t))return t.set(s,!0),!0}return t.set(n,!1),!1}function Dn(n){for(var e=Ki=n;e.parent!==null;){e=e.parent;var t=e.f;if(ua&&e===J&&(t&xt)!==0&&(t&Qh)===0)return;if((t&(Un|Ft))!==0){if((t&Re)===0)return;e.f^=Re}}ft.push(e)}function ug(n){let e=0,t=Vn(0),r;return()=>{Xi()&&(U(t),Ji(()=>(e===0&&(r=$e(()=>n(()=>os(t)))),e+=1,()=>{Gi(()=>{e-=1,e===0&&(r?.(),r=void 0,os(t))})})))}}var lg=dr|Pr|Wi;function hg(n,e,t){new fg(n,e,t)}class fg{parent;#e=!1;#t;#n=null;#r;#c;#o;#a=null;#s=null;#i=null;#u=null;#l=null;#d=0;#h=0;#p=!1;#f=null;#v=ug(()=>(this.#f=Vn(this.#d),()=>{this.#f=null}));constructor(e,t,r){this.#t=e,this.#r=t,this.#c=r,this.parent=J.b,this.#e=!!this.#r.pending,this.#o=Ya(()=>{J.b=this;{var s=this.#_();try{this.#a=rt(()=>r(s))}catch(i){this.error(i)}this.#h>0?this.#g():this.#e=!1}return()=>{this.#l?.remove()}},lg)}#E(){try{this.#a=rt(()=>this.#c(this.#t))}catch(e){this.error(e)}this.#e=!1}#T(){const e=this.#r.pending;e&&(this.#s=rt(()=>e(this.#t)),dt.enqueue(()=>{var t=this.#_();this.#a=this.#m(()=>(dt.ensure(),rt(()=>this.#c(t)))),this.#h>0?this.#g():(or(this.#s,()=>{this.#s=null}),this.#e=!1)}))}#_(){var e=this.#t;return this.#e&&(this.#l=gr(),this.#t.before(this.#l),e=this.#l),e}is_pending(){return this.#e||!!this.parent&&this.parent.is_pending()}has_pending_snippet(){return!!this.#r.pending}#m(e){var t=J,r=X,s=ce;Tt(this.#o),He(this.#o),pr(this.#o.ctx);try{return e()}catch(i){return tf(i),null}finally{Tt(t),He(r),pr(s)}}#g(){const e=this.#r.pending;this.#a!==null&&(this.#u=document.createDocumentFragment(),this.#u.append(this.#l),Tf(this.#a,this.#u)),this.#s===null&&(this.#s=rt(()=>e(this.#t)))}#y(e){if(!this.has_pending_snippet()){this.parent&&this.parent.#y(e);return}this.#h+=e,this.#h===0&&(this.#e=!1,this.#s&&or(this.#s,()=>{this.#s=null}),this.#u&&(this.#t.before(this.#u),this.#u=null))}update_pending_count(e){this.#y(e),this.#d+=e,this.#f&&ps(this.#f,this.#d)}get_effect_pending(){return this.#v(),U(this.#f)}error(e){var t=this.#r.onerror;let r=this.#r.failed;if(this.#p||!t&&!r)throw e;this.#a&&(je(this.#a),this.#a=null),this.#s&&(je(this.#s),this.#s=null),this.#i&&(je(this.#i),this.#i=null);var s=!1,i=!1;const a=()=>{if(s){ng();return}s=!0,i&&Wm(),dt.ensure(),this.#d=0,this.#i!==null&&or(this.#i,()=>{this.#i=null}),this.#e=this.has_pending_snippet(),this.#a=this.#m(()=>(this.#p=!1,rt(()=>this.#c(this.#t)))),this.#h>0?this.#g():this.#e=!1};var c=X;try{He(null),i=!0,t?.(e,a),i=!1}catch(l){mr(l,this.#o&&this.#o.parent)}finally{He(c)}r&&Gi(()=>{this.#i=this.#m(()=>{dt.ensure(),this.#p=!0;try{return rt(()=>{r(this.#t,()=>e,()=>a)})}catch(l){return mr(l,this.#o.parent),null}finally{this.#p=!1}})})}}function dg(n,e,t,r){const s=As()?Ka:Qa;if(t.length===0&&n.length===0){r(e.map(s));return}var i=ie,a=J,c=pg();function l(){Promise.all(t.map(h=>mg(h))).then(h=>{c();try{r([...e.map(s),...h])}catch(d){(a.f&Yt)===0&&mr(d,a)}i?.deactivate(),yi()}).catch(h=>{mr(h,a)})}n.length>0?Promise.all(n).then(()=>{c();try{return l()}finally{i?.deactivate(),yi()}}):l()}function pg(){var n=J,e=X,t=ce,r=ie;return function(i=!0){Tt(n),He(e),pr(t),i&&r?.activate()}}function yi(){Tt(null),He(null),pr(null)}function Ka(n){var e=Oe|Ge,t=X!==null&&(X.f&Oe)!==0?X:null;return J!==null&&(J.f|=Pr),{ctx:ce,deps:null,effects:null,equals:Jh,f:e,fn:n,reactions:null,rv:0,v:Ne,wv:0,parent:t??J,ac:null}}function mg(n,e){let t=J;t===null&&xm();var r=t.b,s=void 0,i=Vn(Ne),a=!X,c=new Map;return Sg(()=>{var l=Kh();s=l.promise;try{Promise.resolve(n()).then(l.resolve,l.reject).then(()=>{h===ie&&h.committed&&h.deactivate(),yi()})}catch(m){l.reject(m),yi()}var h=ie;if(a){var d=!r.is_pending();r.update_pending_count(1),h.increment(d),c.get(h)?.reject(er),c.delete(h),c.set(h,l)}const g=(m,T=void 0)=>{if(h.activate(),T)T!==er&&(i.f|=Zt,ps(i,T));else{(i.f&Zt)!==0&&(i.f^=Zt),ps(i,m);for(const[S,C]of c){if(c.delete(S),S===h)break;C.reject(er)}}a&&(r.update_pending_count(-1),h.decrement(d))};l.promise.then(g,m=>g(null,m||"unknown"))}),Ja(()=>{for(const l of c.values())l.reject(er)}),new Promise(l=>{function h(d){function g(){d===s?l(i):h(s)}d.then(g,g)}h(s)})}function Qa(n){const e=Ka(n);return e.equals=Zh,e}function of(n){var e=n.effects;if(e!==null){n.effects=null;for(var t=0;t<e.length;t+=1)je(e[t])}}function gg(n){for(var e=n.parent;e!==null;){if((e.f&Oe)===0)return e;e=e.parent}return null}function Xa(n){var e,t=J;Tt(gg(n));try{n.f&=~ds,of(n),e=bf(n)}finally{Tt(t)}return e}function af(n){var e=Xa(n);if(n.equals(e)||(n.v=e,n.wv=wf()),!qn)if(Xe!==null)Xi()&&Xe.set(n,n.v);else{var t=(n.f&at)===0?bt:Re;Se(n,t)}}let la=new Set;const en=new Map;let cf=!1;function Vn(n,e){var t={f:0,v:n,reactions:null,equals:Jh,rv:0,wv:0};return t}function Wt(n,e){const t=Vn(n);return kg(t),t}function nt(n,e=!1,t=!0){const r=Vn(n);return e||(r.equals=Zh),Cr&&t&&ce!==null&&ce.l!==null&&(ce.l.s??=[]).push(r),r}function Z(n,e,t=!1){X!==null&&(!pt||(X.f&sl)!==0)&&As()&&(X.f&(Oe|xt|Ga|sl))!==0&&!Dt?.includes(n)&&Hm();let r=t?tr(e):e;return ps(n,r)}function ps(n,e){if(!n.equals(e)){var t=n.v;qn?en.set(n,e):en.set(n,t),n.v=e;var r=dt.ensure();r.capture(n,t),(n.f&Oe)!==0&&((n.f&Ge)!==0&&Xa(n),Se(n,(n.f&at)!==0?Re:bt)),n.wv=wf(),uf(n,Ge),As()&&J!==null&&(J.f&Re)!==0&&(J.f&(Ft|Un))===0&&(Ze===null?Ng([n]):Ze.push(n)),!r.is_fork&&la.size>0&&!cf&&_g()}return e}function _g(){cf=!1;const n=Array.from(la);for(const e of n)(e.f&Re)!==0&&Se(e,bt),kr(e)&&_r(e);la.clear()}function os(n){Z(n,n.v+1)}function uf(n,e){var t=n.reactions;if(t!==null)for(var r=As(),s=t.length,i=0;i<s;i++){var a=t[i],c=a.f;if(!(!r&&a===J)){var l=(c&Ge)===0;if(l&&Se(a,e),(c&Oe)!==0){var h=a;Xe?.delete(h),(c&ds)===0&&(c&at&&(a.f|=ds),uf(h,bt))}else l&&((c&xt)!==0&&St!==null&&St.add(a),Dn(a))}}}function tr(n){if(typeof n!="object"||n===null||sr in n)return n;const e=za(n);if(e!==Nm&&e!==Dm)return n;var t=new Map,r=Hh(n),s=Wt(0),i=Sn,a=c=>{if(Sn===i)return c();var l=X,h=Sn;He(null),ll(i);var d=c();return He(l),ll(h),d};return r&&t.set("length",Wt(n.length)),new Proxy(n,{defineProperty(c,l,h){(!("value"in h)||h.configurable===!1||h.enumerable===!1||h.writable===!1)&&$m();var d=t.get(l);return d===void 0?d=a(()=>{var g=Wt(h.value);return t.set(l,g),g}):Z(d,h.value,!0),!0},deleteProperty(c,l){var h=t.get(l);if(h===void 0){if(l in c){const d=a(()=>Wt(Ne));t.set(l,d),os(s)}}else Z(h,Ne),os(s);return!0},get(c,l,h){if(l===sr)return n;var d=t.get(l),g=l in c;if(d===void 0&&(!g||nr(c,l)?.writable)&&(d=a(()=>{var T=tr(g?c[l]:Ne),S=Wt(T);return S}),t.set(l,d)),d!==void 0){var m=U(d);return m===Ne?void 0:m}return Reflect.get(c,l,h)},getOwnPropertyDescriptor(c,l){var h=Reflect.getOwnPropertyDescriptor(c,l);if(h&&"value"in h){var d=t.get(l);d&&(h.value=U(d))}else if(h===void 0){var g=t.get(l),m=g?.v;if(g!==void 0&&m!==Ne)return{enumerable:!0,configurable:!0,value:m,writable:!0}}return h},has(c,l){if(l===sr)return!0;var h=t.get(l),d=h!==void 0&&h.v!==Ne||Reflect.has(c,l);if(h!==void 0||J!==null&&(!d||nr(c,l)?.writable)){h===void 0&&(h=a(()=>{var m=d?tr(c[l]):Ne,T=Wt(m);return T}),t.set(l,h));var g=U(h);if(g===Ne)return!1}return d},set(c,l,h,d){var g=t.get(l),m=l in c;if(r&&l==="length")for(var T=h;T<g.v;T+=1){var S=t.get(T+"");S!==void 0?Z(S,Ne):T in c&&(S=a(()=>Wt(Ne)),t.set(T+"",S))}if(g===void 0)(!m||nr(c,l)?.writable)&&(g=a(()=>Wt(void 0)),Z(g,tr(h)),t.set(l,g));else{m=g.v!==Ne;var C=a(()=>tr(h));Z(g,C)}var P=Reflect.getOwnPropertyDescriptor(c,l);if(P?.set&&P.set.call(d,h),!m){if(r&&typeof l=="string"){var L=t.get("length"),O=Number(l);Number.isInteger(O)&&O>=L.v&&Z(L,O+1)}os(s)}return!0},ownKeys(c){U(s);var l=Reflect.ownKeys(c).filter(g=>{var m=t.get(g);return m===void 0||m.v!==Ne});for(var[h,d]of t)d.v!==Ne&&!(h in c)&&l.push(h);return l},setPrototypeOf(){zm()}})}var ol,lf,hf,ff;function yg(){if(ol===void 0){ol=window,lf=/Firefox/.test(navigator.userAgent);var n=Element.prototype,e=Node.prototype,t=Text.prototype;hf=nr(e,"firstChild").get,ff=nr(e,"nextSibling").get,rl(n)&&(n.__click=void 0,n.__className=void 0,n.__attributes=null,n.__style=void 0,n.__e=void 0),rl(t)&&(t.__t=void 0)}}function gr(n=""){return document.createTextNode(n)}function vi(n){return hf.call(n)}function bs(n){return ff.call(n)}function Ae(n,e){return vi(n)}function ir(n,e=!1){{var t=vi(n);return t instanceof Comment&&t.data===""?bs(t):t}}function _e(n,e=1,t=!1){let r=n;for(;e--;)r=bs(r);return r}function vg(n){n.textContent=""}function df(){return!1}let al=!1;function Eg(){al||(al=!0,document.addEventListener("reset",n=>{Promise.resolve().then(()=>{if(!n.defaultPrevented)for(const e of n.target.elements)e.__on_r?.()})},{capture:!0}))}function Qi(n){var e=X,t=J;He(null),Tt(null);try{return n()}finally{He(e),Tt(t)}}function Tg(n,e,t,r=t){n.addEventListener(e,()=>Qi(t));const s=n.__on_r;s?n.__on_r=()=>{s(),r(!0)}:n.__on_r=()=>r(!0),Eg()}function pf(n){J===null&&(X===null&&Bm(),Um()),qn&&Fm()}function Ig(n,e){var t=e.last;t===null?e.last=e.first=n:(t.next=n,n.prev=t,e.last=n)}function Ut(n,e,t,r=!0){var s=J;s!==null&&(s.f&Ye)!==0&&(n|=Ye);var i={ctx:ce,deps:null,nodes_start:null,nodes_end:null,f:n|Ge|at,first:null,fn:e,last:null,next:null,parent:s,b:s&&s.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(t)try{_r(i),i.f|=Wa}catch(l){throw je(i),l}else e!==null&&Dn(i);if(r){var a=i;if(t&&a.deps===null&&a.teardown===null&&a.nodes_start===null&&a.first===a.last&&(a.f&Pr)===0&&(a=a.first,(n&xt)!==0&&(n&dr)!==0&&a!==null&&(a.f|=dr)),a!==null&&(a.parent=s,s!==null&&Ig(a,s),X!==null&&(X.f&Oe)!==0&&(n&Un)===0)){var c=X;(c.effects??=[]).push(a)}}return i}function Xi(){return X!==null&&!pt}function Ja(n){const e=Ut(Hi,null,!1);return Se(e,Re),e.teardown=n,e}function ha(n){pf();var e=J.f,t=!X&&(e&Ft)!==0&&(e&Wa)===0;if(t){var r=ce;(r.e??=[]).push(n)}else return mf(n)}function mf(n){return Ut(Ha|Xh,n,!1)}function wg(n){return pf(),Ut(Hi|Xh,n,!0)}function Ag(n){dt.ensure();const e=Ut(Un|Pr,n,!0);return(t={})=>new Promise(r=>{t.outro?or(e,()=>{je(e),r(void 0)}):(je(e),r(void 0))})}function bg(n,e){var t=ce,r={effect:null,ran:!1,deps:n};t.l.$.push(r),r.effect=Ji(()=>{n(),!r.ran&&(r.ran=!0,$e(e))})}function Rg(){var n=ce;Ji(()=>{for(var e of n.l.$){e.deps();var t=e.effect;(t.f&Re)!==0&&Se(t,bt),kr(t)&&_r(t),e.ran=!1}})}function Sg(n){return Ut(Ga|Pr,n,!0)}function Ji(n,e=0){return Ut(Hi|e,n,!0)}function Ei(n,e=[],t=[],r=[],s=!1){dg(r,e,t,i=>{Ut(s?Ha:Hi,()=>n(...i.map(U)),!0)})}function Ya(n,e=0){var t=Ut(xt|e,n,!0);return t}function rt(n,e=!0){return Ut(Ft|Pr,n,!0,e)}function gf(n){var e=n.teardown;if(e!==null){const t=qn,r=X;ul(!0),He(null);try{e.call(null)}finally{ul(t),He(r)}}}function _f(n,e=!1){var t=n.first;for(n.first=n.last=null;t!==null;){const s=t.ac;s!==null&&Qi(()=>{s.abort(er)});var r=t.next;(t.f&Un)!==0?t.parent=null:je(t,e),t=r}}function Pg(n){for(var e=n.first;e!==null;){var t=e.next;(e.f&Ft)===0&&je(e),e=t}}function je(n,e=!0){var t=!1;(e||(n.f&Qh)!==0)&&n.nodes_start!==null&&n.nodes_end!==null&&(Cg(n.nodes_start,n.nodes_end),t=!0),_f(n,e&&!t),Ti(n,0),Se(n,Yt);var r=n.transitions;if(r!==null)for(const i of r)i.stop();gf(n);var s=n.parent;s!==null&&s.first!==null&&yf(n),n.next=n.prev=n.teardown=n.ctx=n.deps=n.fn=n.nodes_start=n.nodes_end=n.ac=null}function Cg(n,e){for(;n!==null;){var t=n===e?null:bs(n);n.remove(),n=t}}function yf(n){var e=n.parent,t=n.prev,r=n.next;t!==null&&(t.next=r),r!==null&&(r.prev=t),e!==null&&(e.first===n&&(e.first=r),e.last===n&&(e.last=t))}function or(n,e,t=!0){var r=[];Za(n,r,!0),vf(r,()=>{t&&je(n),e&&e()})}function vf(n,e){var t=n.length;if(t>0){var r=()=>--t||e();for(var s of n)s.out(r)}else e()}function Za(n,e,t){if((n.f&Ye)===0){if(n.f^=Ye,n.transitions!==null)for(const a of n.transitions)(a.is_global||t)&&e.push(a);for(var r=n.first;r!==null;){var s=r.next,i=(r.f&dr)!==0||(r.f&Ft)!==0&&(n.f&xt)!==0;Za(r,e,i?t:!1),r=s}}}function ec(n){Ef(n,!0)}function Ef(n,e){if((n.f&Ye)!==0){n.f^=Ye,(n.f&Re)===0&&(Se(n,Ge),Dn(n));for(var t=n.first;t!==null;){var r=t.next,s=(t.f&dr)!==0||(t.f&Ft)!==0;Ef(t,s?e:!1),t=r}if(n.transitions!==null)for(const i of n.transitions)(i.is_global||e)&&i.in()}}function Tf(n,e){for(var t=n.nodes_start,r=n.nodes_end;t!==null;){var s=t===r?null:bs(t);e.append(t),t=s}}let Rn=!1;function cl(n){Rn=n}let qn=!1;function ul(n){qn=n}let X=null,pt=!1;function He(n){X=n}let J=null;function Tt(n){J=n}let Dt=null;function kg(n){X!==null&&(Dt===null?Dt=[n]:Dt.push(n))}let Be=null,Qe=0,Ze=null;function Ng(n){Ze=n}let If=1,ms=0,Sn=ms;function ll(n){Sn=n}function wf(){return++If}function kr(n){var e=n.f;if((e&Ge)!==0)return!0;if(e&Oe&&(n.f&=~ds),(e&bt)!==0){var t=n.deps;if(t!==null)for(var r=t.length,s=0;s<r;s++){var i=t[s];if(kr(i)&&af(i),i.wv>n.wv)return!0}(e&at)!==0&&Xe===null&&Se(n,Re)}return!1}function Af(n,e,t=!0){var r=n.reactions;if(r!==null&&!Dt?.includes(n))for(var s=0;s<r.length;s++){var i=r[s];(i.f&Oe)!==0?Af(i,e,!1):e===i&&(t?Se(i,Ge):(i.f&Re)!==0&&Se(i,bt),Dn(i))}}function bf(n){var e=Be,t=Qe,r=Ze,s=X,i=Dt,a=ce,c=pt,l=Sn,h=n.f;Be=null,Qe=0,Ze=null,X=(h&(Ft|Un))===0?n:null,Dt=null,pr(n.ctx),pt=!1,Sn=++ms,n.ac!==null&&(Qi(()=>{n.ac.abort(er)}),n.ac=null);try{n.f|=ca;var d=n.fn,g=d(),m=n.deps;if(Be!==null){var T;if(Ti(n,Qe),m!==null&&Qe>0)for(m.length=Qe+Be.length,T=0;T<Be.length;T++)m[Qe+T]=Be[T];else n.deps=m=Be;if(Rn&&Xi()&&(n.f&at)!==0)for(T=Qe;T<m.length;T++)(m[T].reactions??=[]).push(n)}else m!==null&&Qe<m.length&&(Ti(n,Qe),m.length=Qe);if(As()&&Ze!==null&&!pt&&m!==null&&(n.f&(Oe|bt|Ge))===0)for(T=0;T<Ze.length;T++)Af(Ze[T],n);return s!==null&&s!==n&&(ms++,Ze!==null&&(r===null?r=Ze:r.push(...Ze))),(n.f&Zt)!==0&&(n.f^=Zt),g}catch(S){return tf(S)}finally{n.f^=ca,Be=e,Qe=t,Ze=r,X=s,Dt=i,pr(a),pt=c,Sn=l}}function Dg(n,e){let t=e.reactions;if(t!==null){var r=km.call(t,n);if(r!==-1){var s=t.length-1;s===0?t=e.reactions=null:(t[r]=t[s],t.pop())}}t===null&&(e.f&Oe)!==0&&(Be===null||!Be.includes(e))&&(Se(e,bt),(e.f&at)!==0&&(e.f^=at,e.f&=~ds),of(e),Ti(e,0))}function Ti(n,e){var t=n.deps;if(t!==null)for(var r=e;r<t.length;r++)Dg(n,t[r])}function _r(n){var e=n.f;if((e&Yt)===0){Se(n,Re);var t=J,r=Rn;J=n,Rn=!0;try{(e&xt)!==0?Pg(n):_f(n),gf(n);var s=bf(n);n.teardown=typeof s=="function"?s:null,n.wv=If;var i;zh&&sg&&(n.f&Ge)!==0&&n.deps}finally{Rn=r,J=t}}}async function Vg(){await Promise.resolve(),ag()}function U(n){var e=n.f,t=(e&Oe)!==0;if(X!==null&&!pt){var r=J!==null&&(J.f&Yt)!==0;if(!r&&!Dt?.includes(n)){var s=X.deps;if((X.f&ca)!==0)n.rv<ms&&(n.rv=ms,Be===null&&s!==null&&s[Qe]===n?Qe++:Be===null?Be=[n]:Be.includes(n)||Be.push(n));else{(X.deps??=[]).push(n);var i=n.reactions;i===null?n.reactions=[X]:i.includes(X)||i.push(X)}}}if(qn){if(en.has(n))return en.get(n);if(t){var a=n,c=a.v;return((a.f&Re)===0&&a.reactions!==null||Sf(a))&&(c=Xa(a)),en.set(a,c),c}}else if(t){if(a=n,Xe?.has(a))return Xe.get(a);kr(a)&&af(a),Rn&&Xi()&&(a.f&at)===0&&Rf(a)}else if(Xe?.has(n))return Xe.get(n);if((n.f&Zt)!==0)throw n.v;return n.v}function Rf(n){if(n.deps!==null){n.f^=at;for(const e of n.deps)(e.reactions??=[]).push(n),(e.f&Oe)!==0&&(e.f&at)===0&&Rf(e)}}function Sf(n){if(n.v===Ne)return!0;if(n.deps===null)return!1;for(const e of n.deps)if(en.has(e)||(e.f&Oe)!==0&&Sf(e))return!0;return!1}function $e(n){var e=pt;try{return pt=!0,n()}finally{pt=e}}const Og=-7169;function Se(n,e){n.f=n.f&Og|e}function Mg(n){if(!(typeof n!="object"||!n||n instanceof EventTarget)){if(sr in n)fa(n);else if(!Array.isArray(n))for(let e in n){const t=n[e];typeof t=="object"&&t&&sr in t&&fa(t)}}}function fa(n,e=new Set){if(typeof n=="object"&&n!==null&&!(n instanceof EventTarget)&&!e.has(n)){e.add(n),n instanceof Date&&n.getTime();for(let r in n)try{fa(n[r],e)}catch{}const t=za(n);if(t!==Object.prototype&&t!==Array.prototype&&t!==Map.prototype&&t!==Set.prototype&&t!==Date.prototype){const r=Gh(t);for(let s in r){const i=r[s].get;if(i)try{i.call(n)}catch{}}}}}const Lg=["touchstart","touchmove"];function xg(n){return Lg.includes(n)}const Fg=new Set,hl=new Set;function Ug(n,e,t,r={}){function s(i){if(r.capture||es.call(e,i),!i.cancelBubble)return Qi(()=>t?.call(this,i))}return n.startsWith("pointer")||n.startsWith("touch")||n==="wheel"?Gi(()=>{e.addEventListener(n,s,r)}):e.addEventListener(n,s,r),s}function tc(n,e,t,r,s){var i={capture:r,passive:s},a=Ug(n,e,t,i);(e===document.body||e===window||e===document||e instanceof HTMLMediaElement)&&Ja(()=>{e.removeEventListener(n,a,i)})}let fl=null;function es(n){var e=this,t=e.ownerDocument,r=n.type,s=n.composedPath?.()||[],i=s[0]||n.target;fl=n;var a=0,c=fl===n&&n.__root;if(c){var l=s.indexOf(c);if(l!==-1&&(e===document||e===window)){n.__root=e;return}var h=s.indexOf(e);if(h===-1)return;l<=h&&(a=l)}if(i=s[a]||n.target,i!==e){Wh(n,"currentTarget",{configurable:!0,get(){return i||t}});var d=X,g=J;He(null),Tt(null);try{for(var m,T=[];i!==null;){var S=i.assignedSlot||i.parentNode||i.host||null;try{var C=i["__"+r];C!=null&&(!i.disabled||n.target===i)&&C.call(i,n)}catch(P){m?T.push(P):m=P}if(n.cancelBubble||S===e||S===null)break;i=S}if(m){for(let P of T)queueMicrotask(()=>{throw P});throw m}}finally{n.__root=e,delete n.currentTarget,He(d),Tt(g)}}}function Bg(n){var e=document.createElement("template");return e.innerHTML=n.replaceAll("<!>","<!---->"),e.content}function da(n,e){var t=J;t.nodes_start===null&&(t.nodes_start=n,t.nodes_end=e)}function Le(n,e){var t=(e&Zm)!==0,r=(e&eg)!==0,s,i=!n.startsWith("<!>");return()=>{s===void 0&&(s=Bg(i?n:"<!>"+n),t||(s=vi(s)));var a=r||lf?document.importNode(s,!0):s.cloneNode(!0);if(t){var c=vi(a),l=a.lastChild;da(c,l)}else da(a,a);return a}}function pa(){var n=document.createDocumentFragment(),e=document.createComment(""),t=gr();return n.append(e,t),da(e,t),n}function ge(n,e){n!==null&&n.before(e)}function nc(n,e){var t=e==null?"":typeof e=="object"?e+"":e;t!==(n.__t??=n.nodeValue)&&(n.__t=t,n.nodeValue=t+"")}function jg(n,e){return qg(n,e)}const Kn=new Map;function qg(n,{target:e,anchor:t,props:r={},events:s,context:i,intro:a=!0}){yg();var c=new Set,l=g=>{for(var m=0;m<g.length;m++){var T=g[m];if(!c.has(T)){c.add(T);var S=xg(T);e.addEventListener(T,es,{passive:S});var C=Kn.get(T);C===void 0?(document.addEventListener(T,es,{passive:S}),Kn.set(T,1)):Kn.set(T,C+1)}}};l($a(Fg)),hl.add(l);var h=void 0,d=Ag(()=>{var g=t??e.appendChild(gr());return hg(g,{pending:()=>{}},m=>{if(i){Bn({});var T=ce;T.c=i}s&&(r.$$events=s),h=n(m,r)||{},i&&jn()}),()=>{for(var m of c){e.removeEventListener(m,es);var T=Kn.get(m);--T===0?(document.removeEventListener(m,es),Kn.delete(m)):Kn.set(m,T)}hl.delete(l),g!==t&&g.parentNode?.removeChild(g)}});return $g.set(h,d),h}let $g=new WeakMap;class zg{anchor;#e=new Map;#t=new Map;#n=new Map;#r=!0;constructor(e,t=!0){this.anchor=e,this.#r=t}#c=()=>{var e=ie;if(this.#e.has(e)){var t=this.#e.get(e),r=this.#t.get(t);if(r)ec(r);else{var s=this.#n.get(t);s&&(this.#t.set(t,s.effect),this.#n.delete(t),s.fragment.lastChild.remove(),this.anchor.before(s.fragment),r=s.effect)}for(const[i,a]of this.#e){if(this.#e.delete(i),i===e)break;const c=this.#n.get(a);c&&(je(c.effect),this.#n.delete(a))}for(const[i,a]of this.#t){if(i===t)continue;const c=()=>{if(Array.from(this.#e.values()).includes(i)){var h=document.createDocumentFragment();Tf(a,h),h.append(gr()),this.#n.set(i,{effect:a,fragment:h})}else je(a);this.#t.delete(i)};this.#r||!r?or(a,c,!1):c()}}};#o=e=>{this.#e.delete(e);const t=Array.from(this.#e.values());for(const[r,s]of this.#n)t.includes(r)||(je(s.effect),this.#n.delete(r))};ensure(e,t){var r=ie,s=df();if(t&&!this.#t.has(e)&&!this.#n.has(e))if(s){var i=document.createDocumentFragment(),a=gr();i.append(a),this.#n.set(e,{effect:rt(()=>t(a)),fragment:i})}else this.#t.set(e,rt(()=>t(this.anchor)));if(this.#e.set(r,e),s){for(const[c,l]of this.#t)c===e?r.skipped_effects.delete(l):r.skipped_effects.add(l);for(const[c,l]of this.#n)c===e?r.skipped_effects.delete(l.effect):r.skipped_effects.add(l.effect);r.oncommit(this.#c),r.ondiscard(this.#o)}else this.#c()}}function Ct(n,e,t=!1){var r=new zg(n),s=t?dr:0;function i(a,c){r.ensure(a,c)}Ya(()=>{var a=!1;e((c,l=!0)=>{a=!0,i(l,c)}),a||i(!1,null)},s)}function Hg(n,e){return e}function Wg(n,e,t){for(var r=n.items,s=[],i=e.length,a=0;a<i;a++)Za(e[a].e,s,!0);var c=i>0&&s.length===0&&t!==null;if(c){var l=t.parentNode;vg(l),l.append(t),r.clear(),lt(n,e[0].prev,e[i-1].next)}vf(s,()=>{for(var h=0;h<i;h++){var d=e[h];c||(r.delete(d.k),lt(n,d.prev,d.next)),je(d.e,!c)}})}function Gg(n,e,t,r,s,i=null){var a=n,c={flags:e,items:new Map,first:null},l=null,h=!1,d=new Map,g=Qa(()=>{var C=t();return Hh(C)?C:C==null?[]:$a(C)}),m,T;function S(){Kg(T,m,c,d,a,s,e,r,t),i!==null&&(m.length===0?l?ec(l):l=rt(()=>i(a)):l!==null&&or(l,()=>{l=null}))}Ya(()=>{T??=J,m=U(g);var C=m.length;if(!(h&&C===0)){h=C===0;var P,L,O,V;if(df()){var H=new Set,Y=ie;for(L=0;L<C;L+=1){O=m[L],V=r(O,L);var te=c.items.get(V)??d.get(V);te?Pf(te,O,L):(P=Cf(null,c,null,null,O,V,L,s,e,t,!0),d.set(V,P)),H.add(V)}for(const[I,_]of c.items)H.has(I)||Y.skipped_effects.add(_.e);Y.oncommit(S)}else S();U(g)}})}function Kg(n,e,t,r,s,i,a,c,l){var h=e.length,d=t.items,g=t.first,m=g,T,S=null,C=[],P=[],L,O,V,H;for(H=0;H<h;H+=1){if(L=e[H],O=c(L,H),V=d.get(O),V===void 0){var Y=r.get(O);if(Y!==void 0){r.delete(O),d.set(O,Y);var te=S?S.next:m;lt(t,S,Y),lt(t,Y,te),Wo(Y,te,s),S=Y}else{var I=m?m.e.nodes_start:s;S=Cf(I,t,S,S===null?t.first:S.next,L,O,H,i,a,l)}d.set(O,S),C=[],P=[],m=S.next;continue}if(Pf(V,L,H),(V.e.f&Ye)!==0&&ec(V.e),V!==m){if(T!==void 0&&T.has(V)){if(C.length<P.length){var _=P[0],v;S=_.prev;var w=C[0],E=C[C.length-1];for(v=0;v<C.length;v+=1)Wo(C[v],_,s);for(v=0;v<P.length;v+=1)T.delete(P[v]);lt(t,w.prev,E.next),lt(t,S,w),lt(t,E,_),m=_,S=E,H-=1,C=[],P=[]}else T.delete(V),Wo(V,m,s),lt(t,V.prev,V.next),lt(t,V,S===null?t.first:S.next),lt(t,S,V),S=V;continue}for(C=[],P=[];m!==null&&m.k!==O;)(m.e.f&Ye)===0&&(T??=new Set).add(m),P.push(m),m=m.next;if(m===null)continue;V=m}C.push(V),S=V,m=V.next}if(m!==null||T!==void 0){for(var A=T===void 0?[]:$a(T);m!==null;)(m.e.f&Ye)===0&&A.push(m),m=m.next;var y=A.length;if(y>0){var re=null;Wg(t,A,re)}}n.first=t.first&&t.first.e,n.last=S&&S.e;for(var xe of r.values())je(xe.e);r.clear()}function Pf(n,e,t,r){ps(n.v,e),n.i=t}function Cf(n,e,t,r,s,i,a,c,l,h,d){var g=(l&Gm)!==0,m=(l&Qm)===0,T=g?m?nt(s,!1,!1):Vn(s):s,S=(l&Km)===0?a:Vn(a),C={i:S,v:T,k:i,a:null,e:null,prev:t,next:r};try{if(n===null){var P=document.createDocumentFragment();P.append(n=gr())}return C.e=rt(()=>c(n,T,S,h),rg),C.e.prev=t&&t.e,C.e.next=r&&r.e,t===null?d||(e.first=C):(t.next=C,t.e.next=C.e),r!==null&&(r.prev=C,r.e.prev=C.e),C}finally{}}function Wo(n,e,t){for(var r=n.next?n.next.e.nodes_start:t,s=e?e.e.nodes_start:t,i=n.e.nodes_start;i!==null&&i!==r;){var a=bs(i);s.before(i),i=a}}function lt(n,e,t){e===null?n.first=t:(e.next=t,e.e.next=t&&t.e),t!==null&&(t.prev=e,t.e.prev=e&&e.e)}function Qg(n,e,t,r,s){var i=e.$$slots?.[t],a=!1;i===!0&&(i=e.children,a=!0),i===void 0||i(n,a?()=>r:r)}const Xg=Symbol("is custom element"),Jg=Symbol("is html");function oi(n,e,t,r){var s=Yg(n);s[e]!==(s[e]=t)&&(e==="loading"&&(n[Mm]=t),t==null?n.removeAttribute(e):typeof t!="string"&&Zg(n).includes(e)?n[e]=t:n.setAttribute(e,t))}function Yg(n){return n.__attributes??={[Xg]:n.nodeName.includes("-"),[Jg]:n.namespaceURI===tg}}var dl=new Map;function Zg(n){var e=n.getAttribute("is")||n.nodeName,t=dl.get(e);if(t)return t;dl.set(e,t=[]);for(var r,s=n,i=Element.prototype;i!==s;){r=Gh(s);for(var a in r)r[a].set&&t.push(a);s=za(s)}return t}function ar(n,e,t=e){var r=new WeakSet;Tg(n,"input",async s=>{var i=s?n.defaultValue:n.value;if(i=Go(n)?Ko(i):i,t(i),ie!==null&&r.add(ie),await Vg(),i!==(i=e())){var a=n.selectionStart,c=n.selectionEnd,l=n.value.length;if(n.value=i??"",c!==null){var h=n.value.length;a===c&&c===l&&h>l?(n.selectionStart=h,n.selectionEnd=h):(n.selectionStart=a,n.selectionEnd=Math.min(c,h))}}}),$e(e)==null&&n.value&&(t(Go(n)?Ko(n.value):n.value),ie!==null&&r.add(ie)),Ji(()=>{var s=e();if(n===document.activeElement){var i=ii??ie;if(r.has(i))return}Go(n)&&s===Ko(n.value)||n.type==="date"&&!s&&!n.value||s!==n.value&&(n.value=s??"")})}function Go(n){var e=n.type;return e==="number"||e==="range"}function Ko(n){return n===""?null:+n}function kf(n){return function(...e){var t=e[0];return t.preventDefault(),n?.apply(this,e)}}function Nr(n=!1){const e=ce,t=e.l.u;if(!t)return;let r=()=>Mg(e.s);if(n){let s=0,i={};const a=Ka(()=>{let c=!1;const l=e.s;for(const h in l)l[h]!==i[h]&&(i[h]=l[h],c=!0);return c&&s++,s});r=()=>U(a)}t.b.length&&wg(()=>{pl(e,r),aa(t.b)}),ha(()=>{const s=$e(()=>t.m.map(Vm));return()=>{for(const i of s)typeof i=="function"&&i()}}),t.a.length&&ha(()=>{pl(e,r),aa(t.a)})}function pl(n,e){if(n.l.s)for(const t of n.l.s)U(t);e()}function Nf(n,e,t){if(n==null)return e(void 0),rr;const r=$e(()=>n.subscribe(e,t));return r.unsubscribe?()=>r.unsubscribe():r}const Qn=[];function Df(n,e=rr){let t=null;const r=new Set;function s(c){if(Yh(n,c)&&(n=c,t)){const l=!Qn.length;for(const h of r)h[1](),Qn.push(h,n);if(l){for(let h=0;h<Qn.length;h+=2)Qn[h][0](Qn[h+1]);Qn.length=0}}}function i(c){s(c(n))}function a(c,l=rr){const h=[c,l];return r.add(h),r.size===1&&(t=e(s,i)||rr),c(n),()=>{r.delete(h),r.size===0&&t&&(t(),t=null)}}return{set:s,update:i,subscribe:a}}function e_(n){let e;return Nf(n,t=>e=t)(),e}let Ys=!1,ma=Symbol();function ga(n,e,t){const r=t[e]??={store:null,source:nt(void 0),unsubscribe:rr};if(r.store!==n&&!(ma in t))if(r.unsubscribe(),r.store=n??null,n==null)r.source.v=void 0,r.unsubscribe=rr;else{var s=!0;r.unsubscribe=Nf(n,i=>{s?r.source.v=i:Z(r.source,i)}),s=!1}return n&&ma in t?e_(n):U(r.source)}function Vf(){const n={};function e(){Ja(()=>{for(var t in n)n[t].unsubscribe();Wh(n,ma,{enumerable:!1,value:!0})})}return[n,e]}function t_(n){var e=Ys;try{return Ys=!1,[n(),Ys]}finally{Ys=e}}function Pn(n,e,t,r){var s=!Cr||(t&Xm)!==0,i=(t&Ym)!==0,a=r,c=!0,l=()=>(c&&(c=!1,a=r),a),h;{var d=sr in n||Om in n;h=nr(n,e)?.set??(d&&e in n?O=>n[e]=O:void 0)}var g,m=!1;[g,m]=t_(()=>n[e]),g===void 0&&r!==void 0&&(g=l(),h&&(s&&qm(),h(g)));var T;if(s?T=()=>{var O=n[e];return O===void 0?l():(c=!0,O)}:T=()=>{var O=n[e];return O!==void 0&&(a=void 0),O===void 0?a:O},s&&(t&Jm)===0)return T;if(h){var S=n.$$legacy;return(function(O,V){return arguments.length>0?((!s||!V||S||m)&&h(V?T():O),O):T()})}var C=!1,P=Qa(()=>(C=!1,T()));U(P);var L=J;return(function(O,V){if(arguments.length>0){const H=V?U(P):s&&i?tr(O):O;return Z(P,H),C=!0,a!==void 0&&(a=H),O}return qn&&C||(L.f&Yt)!==0?P.v:U(P)})}function n_(n){ce===null&&Lm(),Cr&&ce.l!==null?r_(ce).m.push(n):ha(()=>{const e=$e(n);if(typeof e=="function")return e})}function r_(n){var e=n.l;return e.u??={a:[],b:[],m:[]}}const s_="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(s_);ig();const i_=()=>{};var ml={};const Of=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let s=n.charCodeAt(r);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},o_=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const s=n[t++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=n[t++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=n[t++],a=n[t++],c=n[t++],l=((s&7)<<18|(i&63)<<12|(a&63)<<6|c&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const i=n[t++],a=n[t++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|a&63)}}return e.join("")},Mf={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<n.length;s+=3){const i=n[s],a=s+1<n.length,c=a?n[s+1]:0,l=s+2<n.length,h=l?n[s+2]:0,d=i>>2,g=(i&3)<<4|c>>4;let m=(c&15)<<2|h>>6,T=h&63;l||(T=64,a||(m=64)),r.push(t[d],t[g],t[m],t[T])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(Of(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):o_(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<n.length;){const i=t[n.charAt(s++)],c=s<n.length?t[n.charAt(s)]:0;++s;const h=s<n.length?t[n.charAt(s)]:64;++s;const g=s<n.length?t[n.charAt(s)]:64;if(++s,i==null||c==null||h==null||g==null)throw new a_;const m=i<<2|c>>4;if(r.push(m),h!==64){const T=c<<4&240|h>>2;if(r.push(T),g!==64){const S=h<<6&192|g;r.push(S)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class a_ extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const c_=function(n){const e=Of(n);return Mf.encodeByteArray(e,!0)},Ii=function(n){return c_(n).replace(/\./g,"")},Lf=function(n){try{return Mf.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function u_(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const l_=()=>u_().__FIREBASE_DEFAULTS__,h_=()=>{if(typeof process>"u"||typeof ml>"u")return;const n=ml.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},f_=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&Lf(n[1]);return e&&JSON.parse(e)},Yi=()=>{try{return i_()||l_()||h_()||f_()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},xf=n=>Yi()?.emulatorHosts?.[n],Ff=n=>{const e=xf(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},Uf=()=>Yi()?.config,Bf=n=>Yi()?.[`_${n}`];class d_{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}function pn(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function rc(n){return(await fetch(n,{credentials:"include"})).ok}function p_(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",s=n.iat||0,i=n.sub||n.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a={iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...n};return[Ii(JSON.stringify(t)),Ii(JSON.stringify(a)),""].join(".")}const as={};function m_(){const n={prod:[],emulator:[]};for(const e of Object.keys(as))as[e]?n.emulator.push(e):n.prod.push(e);return n}function g_(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let gl=!1;function sc(n,e){if(typeof window>"u"||typeof document>"u"||!pn(window.location.host)||as[n]===e||as[n]||gl)return;as[n]=e;function t(m){return`__firebase__banner__${m}`}const r="__firebase__banner",i=m_().prod.length>0;function a(){const m=document.getElementById(r);m&&m.remove()}function c(m){m.style.display="flex",m.style.background="#7faaf0",m.style.position="fixed",m.style.bottom="5px",m.style.left="5px",m.style.padding=".5em",m.style.borderRadius="5px",m.style.alignItems="center"}function l(m,T){m.setAttribute("width","24"),m.setAttribute("id",T),m.setAttribute("height","24"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.style.marginLeft="-6px"}function h(){const m=document.createElement("span");return m.style.cursor="pointer",m.style.marginLeft="16px",m.style.fontSize="24px",m.innerHTML=" &times;",m.onclick=()=>{gl=!0,a()},m}function d(m,T){m.setAttribute("id",T),m.innerText="Learn more",m.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",m.setAttribute("target","__blank"),m.style.paddingLeft="5px",m.style.textDecoration="underline"}function g(){const m=g_(r),T=t("text"),S=document.getElementById(T)||document.createElement("span"),C=t("learnmore"),P=document.getElementById(C)||document.createElement("a"),L=t("preprendIcon"),O=document.getElementById(L)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.created){const V=m.element;c(V),d(P,C);const H=h();l(O,L),V.append(O,S,P,H),document.body.appendChild(V)}i?(S.innerText="Preview backend disconnected.",O.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(O.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,S.innerText="Preview backend running in this workspace."),S.setAttribute("id",T)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",g):g()}function Me(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function __(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Me())}function y_(){const n=Yi()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function v_(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function E_(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function T_(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function I_(){const n=Me();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function w_(){return!y_()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function A_(){try{return typeof indexedDB=="object"}catch{return!1}}function b_(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{e(s.error?.message||"")}}catch(t){e(t)}})}const R_="FirebaseError";class Rt extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=R_,Object.setPrototypeOf(this,Rt.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Rs.prototype.create)}}class Rs{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},s=`${this.service}/${e}`,i=this.errors[e],a=i?S_(i,r):"Error",c=`${this.serviceName}: ${a} (${s}).`;return new Rt(s,c,r)}}function S_(n,e){return n.replace(P_,(t,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const P_=/\{\$([^}]+)}/g;function C_(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function On(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const s of t){if(!r.includes(s))return!1;const i=n[s],a=e[s];if(_l(i)&&_l(a)){if(!On(i,a))return!1}else if(i!==a)return!1}for(const s of r)if(!t.includes(s))return!1;return!0}function _l(n){return n!==null&&typeof n=="object"}function Ss(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function k_(n,e){const t=new N_(n,e);return t.subscribe.bind(t)}class N_{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let s;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");D_(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:r},s.next===void 0&&(s.next=Qo),s.error===void 0&&(s.error=Qo),s.complete===void 0&&(s.complete=Qo);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function D_(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Qo(){}function pe(n){return n&&n._delegate?n._delegate:n}class an{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const In="[DEFAULT]";class V_{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new d_;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(M_(e))try{this.getOrInitializeService({instanceIdentifier:In})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=In){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=In){return this.instances.has(e)}getOptions(e=In){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[i,a]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(i);r===c&&a.resolve(s)}return s}onInit(e,t){const r=this.normalizeInstanceIdentifier(t),s=this.onInitCallbacks.get(r)??new Set;s.add(e),this.onInitCallbacks.set(r,s);const i=this.instances.get(r);return i&&e(i,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const s of r)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:O_(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=In){return this.component?this.component.multipleInstances?e:In:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function O_(n){return n===In?void 0:n}function M_(n){return n.instantiationMode==="EAGER"}class L_{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new V_(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var W;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(W||(W={}));const x_={debug:W.DEBUG,verbose:W.VERBOSE,info:W.INFO,warn:W.WARN,error:W.ERROR,silent:W.SILENT},F_=W.INFO,U_={[W.DEBUG]:"log",[W.VERBOSE]:"log",[W.INFO]:"info",[W.WARN]:"warn",[W.ERROR]:"error"},B_=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),s=U_[e];if(s)console[s](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class ic{constructor(e){this.name=e,this._logLevel=F_,this._logHandler=B_,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in W))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?x_[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,W.DEBUG,...e),this._logHandler(this,W.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,W.VERBOSE,...e),this._logHandler(this,W.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,W.INFO,...e),this._logHandler(this,W.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,W.WARN,...e),this._logHandler(this,W.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,W.ERROR,...e),this._logHandler(this,W.ERROR,...e)}}const j_=(n,e)=>e.some(t=>n instanceof t);let yl,vl;function q_(){return yl||(yl=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function $_(){return vl||(vl=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const jf=new WeakMap,_a=new WeakMap,qf=new WeakMap,Xo=new WeakMap,oc=new WeakMap;function z_(n){const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("success",i),n.removeEventListener("error",a)},i=()=>{t(tn(n.result)),s()},a=()=>{r(n.error),s()};n.addEventListener("success",i),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&jf.set(t,n)}).catch(()=>{}),oc.set(e,n),e}function H_(n){if(_a.has(n))return;const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("complete",i),n.removeEventListener("error",a),n.removeEventListener("abort",a)},i=()=>{t(),s()},a=()=>{r(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",i),n.addEventListener("error",a),n.addEventListener("abort",a)});_a.set(n,e)}let ya={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return _a.get(n);if(e==="objectStoreNames")return n.objectStoreNames||qf.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return tn(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function W_(n){ya=n(ya)}function G_(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(Jo(this),e,...t);return qf.set(r,e.sort?e.sort():[e]),tn(r)}:$_().includes(n)?function(...e){return n.apply(Jo(this),e),tn(jf.get(this))}:function(...e){return tn(n.apply(Jo(this),e))}}function K_(n){return typeof n=="function"?G_(n):(n instanceof IDBTransaction&&H_(n),j_(n,q_())?new Proxy(n,ya):n)}function tn(n){if(n instanceof IDBRequest)return z_(n);if(Xo.has(n))return Xo.get(n);const e=K_(n);return e!==n&&(Xo.set(n,e),oc.set(e,n)),e}const Jo=n=>oc.get(n);function Q_(n,e,{blocked:t,upgrade:r,blocking:s,terminated:i}={}){const a=indexedDB.open(n,e),c=tn(a);return r&&a.addEventListener("upgradeneeded",l=>{r(tn(a.result),l.oldVersion,l.newVersion,tn(a.transaction),l)}),t&&a.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),c.then(l=>{i&&l.addEventListener("close",()=>i()),s&&l.addEventListener("versionchange",h=>s(h.oldVersion,h.newVersion,h))}).catch(()=>{}),c}const X_=["get","getKey","getAll","getAllKeys","count"],J_=["put","add","delete","clear"],Yo=new Map;function El(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Yo.get(e))return Yo.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,s=J_.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(s||X_.includes(t)))return;const i=async function(a,...c){const l=this.transaction(a,s?"readwrite":"readonly");let h=l.store;return r&&(h=h.index(c.shift())),(await Promise.all([h[t](...c),s&&l.done]))[0]};return Yo.set(e,i),i}W_(n=>({...n,get:(e,t,r)=>El(e,t)||n.get(e,t,r),has:(e,t)=>!!El(e,t)||n.has(e,t)}));class Y_{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(Z_(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function Z_(n){return n.getComponent()?.type==="VERSION"}const va="@firebase/app",Tl="0.14.5";const Vt=new ic("@firebase/app"),ey="@firebase/app-compat",ty="@firebase/analytics-compat",ny="@firebase/analytics",ry="@firebase/app-check-compat",sy="@firebase/app-check",iy="@firebase/auth",oy="@firebase/auth-compat",ay="@firebase/database",cy="@firebase/data-connect",uy="@firebase/database-compat",ly="@firebase/functions",hy="@firebase/functions-compat",fy="@firebase/installations",dy="@firebase/installations-compat",py="@firebase/messaging",my="@firebase/messaging-compat",gy="@firebase/performance",_y="@firebase/performance-compat",yy="@firebase/remote-config",vy="@firebase/remote-config-compat",Ey="@firebase/storage",Ty="@firebase/storage-compat",Iy="@firebase/firestore",wy="@firebase/ai",Ay="@firebase/firestore-compat",by="firebase",Ry="12.5.0";const Ea="[DEFAULT]",Sy={[va]:"fire-core",[ey]:"fire-core-compat",[ny]:"fire-analytics",[ty]:"fire-analytics-compat",[sy]:"fire-app-check",[ry]:"fire-app-check-compat",[iy]:"fire-auth",[oy]:"fire-auth-compat",[ay]:"fire-rtdb",[cy]:"fire-data-connect",[uy]:"fire-rtdb-compat",[ly]:"fire-fn",[hy]:"fire-fn-compat",[fy]:"fire-iid",[dy]:"fire-iid-compat",[py]:"fire-fcm",[my]:"fire-fcm-compat",[gy]:"fire-perf",[_y]:"fire-perf-compat",[yy]:"fire-rc",[vy]:"fire-rc-compat",[Ey]:"fire-gcs",[Ty]:"fire-gcs-compat",[Iy]:"fire-fst",[Ay]:"fire-fst-compat",[wy]:"fire-vertex","fire-js":"fire-js",[by]:"fire-js-all"};const wi=new Map,Py=new Map,Ta=new Map;function Il(n,e){try{n.container.addComponent(e)}catch(t){Vt.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Mn(n){const e=n.name;if(Ta.has(e))return Vt.debug(`There were multiple attempts to register component ${e}.`),!1;Ta.set(e,n);for(const t of wi.values())Il(t,n);for(const t of Py.values())Il(t,n);return!0}function Zi(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function et(n){return n==null?!1:n.settings!==void 0}const Cy={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},nn=new Rs("app","Firebase",Cy);class ky{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new an("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw nn.create("app-deleted",{appName:this._name})}}const Dr=Ry;function $f(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r={name:Ea,automaticDataCollectionEnabled:!0,...e},s=r.name;if(typeof s!="string"||!s)throw nn.create("bad-app-name",{appName:String(s)});if(t||(t=Uf()),!t)throw nn.create("no-options");const i=wi.get(s);if(i){if(On(t,i.options)&&On(r,i.config))return i;throw nn.create("duplicate-app",{appName:s})}const a=new L_(s);for(const l of Ta.values())a.addComponent(l);const c=new ky(t,r,a);return wi.set(s,c),c}function ac(n=Ea){const e=wi.get(n);if(!e&&n===Ea&&Uf())return $f();if(!e)throw nn.create("no-app",{appName:n});return e}function mt(n,e,t){let r=Sy[n]??n;t&&(r+=`-${t}`);const s=r.match(/\s|\//),i=e.match(/\s|\//);if(s||i){const a=[`Unable to register library "${r}" with version "${e}":`];s&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&i&&a.push("and"),i&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Vt.warn(a.join(" "));return}Mn(new an(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}const Ny="firebase-heartbeat-database",Dy=1,gs="firebase-heartbeat-store";let Zo=null;function zf(){return Zo||(Zo=Q_(Ny,Dy,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(gs)}catch(t){console.warn(t)}}}}).catch(n=>{throw nn.create("idb-open",{originalErrorMessage:n.message})})),Zo}async function Vy(n){try{const t=(await zf()).transaction(gs),r=await t.objectStore(gs).get(Hf(n));return await t.done,r}catch(e){if(e instanceof Rt)Vt.warn(e.message);else{const t=nn.create("idb-get",{originalErrorMessage:e?.message});Vt.warn(t.message)}}}async function wl(n,e){try{const r=(await zf()).transaction(gs,"readwrite");await r.objectStore(gs).put(e,Hf(n)),await r.done}catch(t){if(t instanceof Rt)Vt.warn(t.message);else{const r=nn.create("idb-set",{originalErrorMessage:t?.message});Vt.warn(r.message)}}}function Hf(n){return`${n.name}!${n.options.appId}`}const Oy=1024,My=30;class Ly{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Fy(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=Al();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(s=>s.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:t}),this._heartbeatsCache.heartbeats.length>My){const s=Uy(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(s,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Vt.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Al(),{heartbeatsToSend:t,unsentEntries:r}=xy(this._heartbeatsCache.heartbeats),s=Ii(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(e){return Vt.warn(e),""}}}function Al(){return new Date().toISOString().substring(0,10)}function xy(n,e=Oy){const t=[];let r=n.slice();for(const s of n){const i=t.find(a=>a.agent===s.agent);if(i){if(i.dates.push(s.date),bl(t)>e){i.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),bl(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class Fy{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return A_()?b_().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await Vy(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return wl(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return wl(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function bl(n){return Ii(JSON.stringify({version:2,heartbeats:n})).length}function Uy(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function By(n){Mn(new an("platform-logger",e=>new Y_(e),"PRIVATE")),Mn(new an("heartbeat",e=>new Ly(e),"PRIVATE")),mt(va,Tl,n),mt(va,Tl,"esm2020"),mt("fire-js","")}By("");var jy="firebase",qy="12.5.0";mt(jy,qy,"app");var Rl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var rn,Wf;(function(){var n;function e(I,_){function v(){}v.prototype=_.prototype,I.F=_.prototype,I.prototype=new v,I.prototype.constructor=I,I.D=function(w,E,A){for(var y=Array(arguments.length-2),re=2;re<arguments.length;re++)y[re-2]=arguments[re];return _.prototype[E].apply(w,y)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(I,_,v){v||(v=0);const w=Array(16);if(typeof _=="string")for(var E=0;E<16;++E)w[E]=_.charCodeAt(v++)|_.charCodeAt(v++)<<8|_.charCodeAt(v++)<<16|_.charCodeAt(v++)<<24;else for(E=0;E<16;++E)w[E]=_[v++]|_[v++]<<8|_[v++]<<16|_[v++]<<24;_=I.g[0],v=I.g[1],E=I.g[2];let A=I.g[3],y;y=_+(A^v&(E^A))+w[0]+3614090360&4294967295,_=v+(y<<7&4294967295|y>>>25),y=A+(E^_&(v^E))+w[1]+3905402710&4294967295,A=_+(y<<12&4294967295|y>>>20),y=E+(v^A&(_^v))+w[2]+606105819&4294967295,E=A+(y<<17&4294967295|y>>>15),y=v+(_^E&(A^_))+w[3]+3250441966&4294967295,v=E+(y<<22&4294967295|y>>>10),y=_+(A^v&(E^A))+w[4]+4118548399&4294967295,_=v+(y<<7&4294967295|y>>>25),y=A+(E^_&(v^E))+w[5]+1200080426&4294967295,A=_+(y<<12&4294967295|y>>>20),y=E+(v^A&(_^v))+w[6]+2821735955&4294967295,E=A+(y<<17&4294967295|y>>>15),y=v+(_^E&(A^_))+w[7]+4249261313&4294967295,v=E+(y<<22&4294967295|y>>>10),y=_+(A^v&(E^A))+w[8]+1770035416&4294967295,_=v+(y<<7&4294967295|y>>>25),y=A+(E^_&(v^E))+w[9]+2336552879&4294967295,A=_+(y<<12&4294967295|y>>>20),y=E+(v^A&(_^v))+w[10]+4294925233&4294967295,E=A+(y<<17&4294967295|y>>>15),y=v+(_^E&(A^_))+w[11]+2304563134&4294967295,v=E+(y<<22&4294967295|y>>>10),y=_+(A^v&(E^A))+w[12]+1804603682&4294967295,_=v+(y<<7&4294967295|y>>>25),y=A+(E^_&(v^E))+w[13]+4254626195&4294967295,A=_+(y<<12&4294967295|y>>>20),y=E+(v^A&(_^v))+w[14]+2792965006&4294967295,E=A+(y<<17&4294967295|y>>>15),y=v+(_^E&(A^_))+w[15]+1236535329&4294967295,v=E+(y<<22&4294967295|y>>>10),y=_+(E^A&(v^E))+w[1]+4129170786&4294967295,_=v+(y<<5&4294967295|y>>>27),y=A+(v^E&(_^v))+w[6]+3225465664&4294967295,A=_+(y<<9&4294967295|y>>>23),y=E+(_^v&(A^_))+w[11]+643717713&4294967295,E=A+(y<<14&4294967295|y>>>18),y=v+(A^_&(E^A))+w[0]+3921069994&4294967295,v=E+(y<<20&4294967295|y>>>12),y=_+(E^A&(v^E))+w[5]+3593408605&4294967295,_=v+(y<<5&4294967295|y>>>27),y=A+(v^E&(_^v))+w[10]+38016083&4294967295,A=_+(y<<9&4294967295|y>>>23),y=E+(_^v&(A^_))+w[15]+3634488961&4294967295,E=A+(y<<14&4294967295|y>>>18),y=v+(A^_&(E^A))+w[4]+3889429448&4294967295,v=E+(y<<20&4294967295|y>>>12),y=_+(E^A&(v^E))+w[9]+568446438&4294967295,_=v+(y<<5&4294967295|y>>>27),y=A+(v^E&(_^v))+w[14]+3275163606&4294967295,A=_+(y<<9&4294967295|y>>>23),y=E+(_^v&(A^_))+w[3]+4107603335&4294967295,E=A+(y<<14&4294967295|y>>>18),y=v+(A^_&(E^A))+w[8]+1163531501&4294967295,v=E+(y<<20&4294967295|y>>>12),y=_+(E^A&(v^E))+w[13]+2850285829&4294967295,_=v+(y<<5&4294967295|y>>>27),y=A+(v^E&(_^v))+w[2]+4243563512&4294967295,A=_+(y<<9&4294967295|y>>>23),y=E+(_^v&(A^_))+w[7]+1735328473&4294967295,E=A+(y<<14&4294967295|y>>>18),y=v+(A^_&(E^A))+w[12]+2368359562&4294967295,v=E+(y<<20&4294967295|y>>>12),y=_+(v^E^A)+w[5]+4294588738&4294967295,_=v+(y<<4&4294967295|y>>>28),y=A+(_^v^E)+w[8]+2272392833&4294967295,A=_+(y<<11&4294967295|y>>>21),y=E+(A^_^v)+w[11]+1839030562&4294967295,E=A+(y<<16&4294967295|y>>>16),y=v+(E^A^_)+w[14]+4259657740&4294967295,v=E+(y<<23&4294967295|y>>>9),y=_+(v^E^A)+w[1]+2763975236&4294967295,_=v+(y<<4&4294967295|y>>>28),y=A+(_^v^E)+w[4]+1272893353&4294967295,A=_+(y<<11&4294967295|y>>>21),y=E+(A^_^v)+w[7]+4139469664&4294967295,E=A+(y<<16&4294967295|y>>>16),y=v+(E^A^_)+w[10]+3200236656&4294967295,v=E+(y<<23&4294967295|y>>>9),y=_+(v^E^A)+w[13]+681279174&4294967295,_=v+(y<<4&4294967295|y>>>28),y=A+(_^v^E)+w[0]+3936430074&4294967295,A=_+(y<<11&4294967295|y>>>21),y=E+(A^_^v)+w[3]+3572445317&4294967295,E=A+(y<<16&4294967295|y>>>16),y=v+(E^A^_)+w[6]+76029189&4294967295,v=E+(y<<23&4294967295|y>>>9),y=_+(v^E^A)+w[9]+3654602809&4294967295,_=v+(y<<4&4294967295|y>>>28),y=A+(_^v^E)+w[12]+3873151461&4294967295,A=_+(y<<11&4294967295|y>>>21),y=E+(A^_^v)+w[15]+530742520&4294967295,E=A+(y<<16&4294967295|y>>>16),y=v+(E^A^_)+w[2]+3299628645&4294967295,v=E+(y<<23&4294967295|y>>>9),y=_+(E^(v|~A))+w[0]+4096336452&4294967295,_=v+(y<<6&4294967295|y>>>26),y=A+(v^(_|~E))+w[7]+1126891415&4294967295,A=_+(y<<10&4294967295|y>>>22),y=E+(_^(A|~v))+w[14]+2878612391&4294967295,E=A+(y<<15&4294967295|y>>>17),y=v+(A^(E|~_))+w[5]+4237533241&4294967295,v=E+(y<<21&4294967295|y>>>11),y=_+(E^(v|~A))+w[12]+1700485571&4294967295,_=v+(y<<6&4294967295|y>>>26),y=A+(v^(_|~E))+w[3]+2399980690&4294967295,A=_+(y<<10&4294967295|y>>>22),y=E+(_^(A|~v))+w[10]+4293915773&4294967295,E=A+(y<<15&4294967295|y>>>17),y=v+(A^(E|~_))+w[1]+2240044497&4294967295,v=E+(y<<21&4294967295|y>>>11),y=_+(E^(v|~A))+w[8]+1873313359&4294967295,_=v+(y<<6&4294967295|y>>>26),y=A+(v^(_|~E))+w[15]+4264355552&4294967295,A=_+(y<<10&4294967295|y>>>22),y=E+(_^(A|~v))+w[6]+2734768916&4294967295,E=A+(y<<15&4294967295|y>>>17),y=v+(A^(E|~_))+w[13]+1309151649&4294967295,v=E+(y<<21&4294967295|y>>>11),y=_+(E^(v|~A))+w[4]+4149444226&4294967295,_=v+(y<<6&4294967295|y>>>26),y=A+(v^(_|~E))+w[11]+3174756917&4294967295,A=_+(y<<10&4294967295|y>>>22),y=E+(_^(A|~v))+w[2]+718787259&4294967295,E=A+(y<<15&4294967295|y>>>17),y=v+(A^(E|~_))+w[9]+3951481745&4294967295,I.g[0]=I.g[0]+_&4294967295,I.g[1]=I.g[1]+(E+(y<<21&4294967295|y>>>11))&4294967295,I.g[2]=I.g[2]+E&4294967295,I.g[3]=I.g[3]+A&4294967295}r.prototype.v=function(I,_){_===void 0&&(_=I.length);const v=_-this.blockSize,w=this.C;let E=this.h,A=0;for(;A<_;){if(E==0)for(;A<=v;)s(this,I,A),A+=this.blockSize;if(typeof I=="string"){for(;A<_;)if(w[E++]=I.charCodeAt(A++),E==this.blockSize){s(this,w),E=0;break}}else for(;A<_;)if(w[E++]=I[A++],E==this.blockSize){s(this,w),E=0;break}}this.h=E,this.o+=_},r.prototype.A=function(){var I=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);I[0]=128;for(var _=1;_<I.length-8;++_)I[_]=0;_=this.o*8;for(var v=I.length-8;v<I.length;++v)I[v]=_&255,_/=256;for(this.v(I),I=Array(16),_=0,v=0;v<4;++v)for(let w=0;w<32;w+=8)I[_++]=this.g[v]>>>w&255;return I};function i(I,_){var v=c;return Object.prototype.hasOwnProperty.call(v,I)?v[I]:v[I]=_(I)}function a(I,_){this.h=_;const v=[];let w=!0;for(let E=I.length-1;E>=0;E--){const A=I[E]|0;w&&A==_||(v[E]=A,w=!1)}this.g=v}var c={};function l(I){return-128<=I&&I<128?i(I,function(_){return new a([_|0],_<0?-1:0)}):new a([I|0],I<0?-1:0)}function h(I){if(isNaN(I)||!isFinite(I))return g;if(I<0)return P(h(-I));const _=[];let v=1;for(let w=0;I>=v;w++)_[w]=I/v|0,v*=4294967296;return new a(_,0)}function d(I,_){if(I.length==0)throw Error("number format error: empty string");if(_=_||10,_<2||36<_)throw Error("radix out of range: "+_);if(I.charAt(0)=="-")return P(d(I.substring(1),_));if(I.indexOf("-")>=0)throw Error('number format error: interior "-" character');const v=h(Math.pow(_,8));let w=g;for(let A=0;A<I.length;A+=8){var E=Math.min(8,I.length-A);const y=parseInt(I.substring(A,A+E),_);E<8?(E=h(Math.pow(_,E)),w=w.j(E).add(h(y))):(w=w.j(v),w=w.add(h(y)))}return w}var g=l(0),m=l(1),T=l(16777216);n=a.prototype,n.m=function(){if(C(this))return-P(this).m();let I=0,_=1;for(let v=0;v<this.g.length;v++){const w=this.i(v);I+=(w>=0?w:4294967296+w)*_,_*=4294967296}return I},n.toString=function(I){if(I=I||10,I<2||36<I)throw Error("radix out of range: "+I);if(S(this))return"0";if(C(this))return"-"+P(this).toString(I);const _=h(Math.pow(I,6));var v=this;let w="";for(;;){const E=H(v,_).g;v=L(v,E.j(_));let A=((v.g.length>0?v.g[0]:v.h)>>>0).toString(I);if(v=E,S(v))return A+w;for(;A.length<6;)A="0"+A;w=A+w}},n.i=function(I){return I<0?0:I<this.g.length?this.g[I]:this.h};function S(I){if(I.h!=0)return!1;for(let _=0;_<I.g.length;_++)if(I.g[_]!=0)return!1;return!0}function C(I){return I.h==-1}n.l=function(I){return I=L(this,I),C(I)?-1:S(I)?0:1};function P(I){const _=I.g.length,v=[];for(let w=0;w<_;w++)v[w]=~I.g[w];return new a(v,~I.h).add(m)}n.abs=function(){return C(this)?P(this):this},n.add=function(I){const _=Math.max(this.g.length,I.g.length),v=[];let w=0;for(let E=0;E<=_;E++){let A=w+(this.i(E)&65535)+(I.i(E)&65535),y=(A>>>16)+(this.i(E)>>>16)+(I.i(E)>>>16);w=y>>>16,A&=65535,y&=65535,v[E]=y<<16|A}return new a(v,v[v.length-1]&-2147483648?-1:0)};function L(I,_){return I.add(P(_))}n.j=function(I){if(S(this)||S(I))return g;if(C(this))return C(I)?P(this).j(P(I)):P(P(this).j(I));if(C(I))return P(this.j(P(I)));if(this.l(T)<0&&I.l(T)<0)return h(this.m()*I.m());const _=this.g.length+I.g.length,v=[];for(var w=0;w<2*_;w++)v[w]=0;for(w=0;w<this.g.length;w++)for(let E=0;E<I.g.length;E++){const A=this.i(w)>>>16,y=this.i(w)&65535,re=I.i(E)>>>16,xe=I.i(E)&65535;v[2*w+2*E]+=y*xe,O(v,2*w+2*E),v[2*w+2*E+1]+=A*xe,O(v,2*w+2*E+1),v[2*w+2*E+1]+=y*re,O(v,2*w+2*E+1),v[2*w+2*E+2]+=A*re,O(v,2*w+2*E+2)}for(I=0;I<_;I++)v[I]=v[2*I+1]<<16|v[2*I];for(I=_;I<2*_;I++)v[I]=0;return new a(v,0)};function O(I,_){for(;(I[_]&65535)!=I[_];)I[_+1]+=I[_]>>>16,I[_]&=65535,_++}function V(I,_){this.g=I,this.h=_}function H(I,_){if(S(_))throw Error("division by zero");if(S(I))return new V(g,g);if(C(I))return _=H(P(I),_),new V(P(_.g),P(_.h));if(C(_))return _=H(I,P(_)),new V(P(_.g),_.h);if(I.g.length>30){if(C(I)||C(_))throw Error("slowDivide_ only works with positive integers.");for(var v=m,w=_;w.l(I)<=0;)v=Y(v),w=Y(w);var E=te(v,1),A=te(w,1);for(w=te(w,2),v=te(v,2);!S(w);){var y=A.add(w);y.l(I)<=0&&(E=E.add(v),A=y),w=te(w,1),v=te(v,1)}return _=L(I,E.j(_)),new V(E,_)}for(E=g;I.l(_)>=0;){for(v=Math.max(1,Math.floor(I.m()/_.m())),w=Math.ceil(Math.log(v)/Math.LN2),w=w<=48?1:Math.pow(2,w-48),A=h(v),y=A.j(_);C(y)||y.l(I)>0;)v-=w,A=h(v),y=A.j(_);S(A)&&(A=m),E=E.add(A),I=L(I,y)}return new V(E,I)}n.B=function(I){return H(this,I).h},n.and=function(I){const _=Math.max(this.g.length,I.g.length),v=[];for(let w=0;w<_;w++)v[w]=this.i(w)&I.i(w);return new a(v,this.h&I.h)},n.or=function(I){const _=Math.max(this.g.length,I.g.length),v=[];for(let w=0;w<_;w++)v[w]=this.i(w)|I.i(w);return new a(v,this.h|I.h)},n.xor=function(I){const _=Math.max(this.g.length,I.g.length),v=[];for(let w=0;w<_;w++)v[w]=this.i(w)^I.i(w);return new a(v,this.h^I.h)};function Y(I){const _=I.g.length+1,v=[];for(let w=0;w<_;w++)v[w]=I.i(w)<<1|I.i(w-1)>>>31;return new a(v,I.h)}function te(I,_){const v=_>>5;_%=32;const w=I.g.length-v,E=[];for(let A=0;A<w;A++)E[A]=_>0?I.i(A+v)>>>_|I.i(A+v+1)<<32-_:I.i(A+v);return new a(E,I.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,Wf=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.B,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=h,a.fromString=d,rn=a}).apply(typeof Rl<"u"?Rl:typeof self<"u"?self:typeof window<"u"?window:{});var Zs=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Gf,ts,Kf,ai,Ia,Qf,Xf,Jf;(function(){var n,e=Object.defineProperty;function t(o){o=[typeof globalThis=="object"&&globalThis,o,typeof window=="object"&&window,typeof self=="object"&&self,typeof Zs=="object"&&Zs];for(var u=0;u<o.length;++u){var f=o[u];if(f&&f.Math==Math)return f}throw Error("Cannot find global object")}var r=t(this);function s(o,u){if(u)e:{var f=r;o=o.split(".");for(var p=0;p<o.length-1;p++){var b=o[p];if(!(b in f))break e;f=f[b]}o=o[o.length-1],p=f[o],u=u(p),u!=p&&u!=null&&e(f,o,{configurable:!0,writable:!0,value:u})}}s("Symbol.dispose",function(o){return o||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(o){return o||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(o){return o||function(u){var f=[],p;for(p in u)Object.prototype.hasOwnProperty.call(u,p)&&f.push([p,u[p]]);return f}});var i=i||{},a=this||self;function c(o){var u=typeof o;return u=="object"&&o!=null||u=="function"}function l(o,u,f){return o.call.apply(o.bind,arguments)}function h(o,u,f){return h=l,h.apply(null,arguments)}function d(o,u){var f=Array.prototype.slice.call(arguments,1);return function(){var p=f.slice();return p.push.apply(p,arguments),o.apply(this,p)}}function g(o,u){function f(){}f.prototype=u.prototype,o.Z=u.prototype,o.prototype=new f,o.prototype.constructor=o,o.Ob=function(p,b,R){for(var D=Array(arguments.length-2),z=2;z<arguments.length;z++)D[z-2]=arguments[z];return u.prototype[b].apply(p,D)}}var m=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?o=>o&&AsyncContext.Snapshot.wrap(o):o=>o;function T(o){const u=o.length;if(u>0){const f=Array(u);for(let p=0;p<u;p++)f[p]=o[p];return f}return[]}function S(o,u){for(let p=1;p<arguments.length;p++){const b=arguments[p];var f=typeof b;if(f=f!="object"?f:b?Array.isArray(b)?"array":f:"null",f=="array"||f=="object"&&typeof b.length=="number"){f=o.length||0;const R=b.length||0;o.length=f+R;for(let D=0;D<R;D++)o[f+D]=b[D]}else o.push(b)}}class C{constructor(u,f){this.i=u,this.j=f,this.h=0,this.g=null}get(){let u;return this.h>0?(this.h--,u=this.g,this.g=u.next,u.next=null):u=this.i(),u}}function P(o){a.setTimeout(()=>{throw o},0)}function L(){var o=I;let u=null;return o.g&&(u=o.g,o.g=o.g.next,o.g||(o.h=null),u.next=null),u}class O{constructor(){this.h=this.g=null}add(u,f){const p=V.get();p.set(u,f),this.h?this.h.next=p:this.g=p,this.h=p}}var V=new C(()=>new H,o=>o.reset());class H{constructor(){this.next=this.g=this.h=null}set(u,f){this.h=u,this.g=f,this.next=null}reset(){this.next=this.g=this.h=null}}let Y,te=!1,I=new O,_=()=>{const o=Promise.resolve(void 0);Y=()=>{o.then(v)}};function v(){for(var o;o=L();){try{o.h.call(o.g)}catch(f){P(f)}var u=V;u.j(o),u.h<100&&(u.h++,o.next=u.g,u.g=o)}te=!1}function w(){this.u=this.u,this.C=this.C}w.prototype.u=!1,w.prototype.dispose=function(){this.u||(this.u=!0,this.N())},w.prototype[Symbol.dispose]=function(){this.dispose()},w.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function E(o,u){this.type=o,this.g=this.target=u,this.defaultPrevented=!1}E.prototype.h=function(){this.defaultPrevented=!0};var A=(function(){if(!a.addEventListener||!Object.defineProperty)return!1;var o=!1,u=Object.defineProperty({},"passive",{get:function(){o=!0}});try{const f=()=>{};a.addEventListener("test",f,u),a.removeEventListener("test",f,u)}catch{}return o})();function y(o){return/^[\s\xa0]*$/.test(o)}function re(o,u){E.call(this,o?o.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,o&&this.init(o,u)}g(re,E),re.prototype.init=function(o,u){const f=this.type=o.type,p=o.changedTouches&&o.changedTouches.length?o.changedTouches[0]:null;this.target=o.target||o.srcElement,this.g=u,u=o.relatedTarget,u||(f=="mouseover"?u=o.fromElement:f=="mouseout"&&(u=o.toElement)),this.relatedTarget=u,p?(this.clientX=p.clientX!==void 0?p.clientX:p.pageX,this.clientY=p.clientY!==void 0?p.clientY:p.pageY,this.screenX=p.screenX||0,this.screenY=p.screenY||0):(this.clientX=o.clientX!==void 0?o.clientX:o.pageX,this.clientY=o.clientY!==void 0?o.clientY:o.pageY,this.screenX=o.screenX||0,this.screenY=o.screenY||0),this.button=o.button,this.key=o.key||"",this.ctrlKey=o.ctrlKey,this.altKey=o.altKey,this.shiftKey=o.shiftKey,this.metaKey=o.metaKey,this.pointerId=o.pointerId||0,this.pointerType=o.pointerType,this.state=o.state,this.i=o,o.defaultPrevented&&re.Z.h.call(this)},re.prototype.h=function(){re.Z.h.call(this);const o=this.i;o.preventDefault?o.preventDefault():o.returnValue=!1};var xe="closure_listenable_"+(Math.random()*1e6|0),To=0;function tu(o,u,f,p,b){this.listener=o,this.proxy=null,this.src=u,this.type=f,this.capture=!!p,this.ha=b,this.key=++To,this.da=this.fa=!1}function Ls(o){o.da=!0,o.listener=null,o.proxy=null,o.src=null,o.ha=null}function xs(o,u,f){for(const p in o)u.call(f,o[p],p,o)}function em(o,u){for(const f in o)u.call(void 0,o[f],f,o)}function nu(o){const u={};for(const f in o)u[f]=o[f];return u}const ru="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function su(o,u){let f,p;for(let b=1;b<arguments.length;b++){p=arguments[b];for(f in p)o[f]=p[f];for(let R=0;R<ru.length;R++)f=ru[R],Object.prototype.hasOwnProperty.call(p,f)&&(o[f]=p[f])}}function Fs(o){this.src=o,this.g={},this.h=0}Fs.prototype.add=function(o,u,f,p,b){const R=o.toString();o=this.g[R],o||(o=this.g[R]=[],this.h++);const D=wo(o,u,p,b);return D>-1?(u=o[D],f||(u.fa=!1)):(u=new tu(u,this.src,R,!!p,b),u.fa=f,o.push(u)),u};function Io(o,u){const f=u.type;if(f in o.g){var p=o.g[f],b=Array.prototype.indexOf.call(p,u,void 0),R;(R=b>=0)&&Array.prototype.splice.call(p,b,1),R&&(Ls(u),o.g[f].length==0&&(delete o.g[f],o.h--))}}function wo(o,u,f,p){for(let b=0;b<o.length;++b){const R=o[b];if(!R.da&&R.listener==u&&R.capture==!!f&&R.ha==p)return b}return-1}var Ao="closure_lm_"+(Math.random()*1e6|0),bo={};function iu(o,u,f,p,b){if(Array.isArray(u)){for(let R=0;R<u.length;R++)iu(o,u[R],f,p,b);return null}return f=cu(f),o&&o[xe]?o.J(u,f,c(p)?!!p.capture:!1,b):tm(o,u,f,!1,p,b)}function tm(o,u,f,p,b,R){if(!u)throw Error("Invalid event type");const D=c(b)?!!b.capture:!!b;let z=So(o);if(z||(o[Ao]=z=new Fs(o)),f=z.add(u,f,p,D,R),f.proxy)return f;if(p=nm(),f.proxy=p,p.src=o,p.listener=f,o.addEventListener)A||(b=D),b===void 0&&(b=!1),o.addEventListener(u.toString(),p,b);else if(o.attachEvent)o.attachEvent(au(u.toString()),p);else if(o.addListener&&o.removeListener)o.addListener(p);else throw Error("addEventListener and attachEvent are unavailable.");return f}function nm(){function o(f){return u.call(o.src,o.listener,f)}const u=rm;return o}function ou(o,u,f,p,b){if(Array.isArray(u))for(var R=0;R<u.length;R++)ou(o,u[R],f,p,b);else p=c(p)?!!p.capture:!!p,f=cu(f),o&&o[xe]?(o=o.i,R=String(u).toString(),R in o.g&&(u=o.g[R],f=wo(u,f,p,b),f>-1&&(Ls(u[f]),Array.prototype.splice.call(u,f,1),u.length==0&&(delete o.g[R],o.h--)))):o&&(o=So(o))&&(u=o.g[u.toString()],o=-1,u&&(o=wo(u,f,p,b)),(f=o>-1?u[o]:null)&&Ro(f))}function Ro(o){if(typeof o!="number"&&o&&!o.da){var u=o.src;if(u&&u[xe])Io(u.i,o);else{var f=o.type,p=o.proxy;u.removeEventListener?u.removeEventListener(f,p,o.capture):u.detachEvent?u.detachEvent(au(f),p):u.addListener&&u.removeListener&&u.removeListener(p),(f=So(u))?(Io(f,o),f.h==0&&(f.src=null,u[Ao]=null)):Ls(o)}}}function au(o){return o in bo?bo[o]:bo[o]="on"+o}function rm(o,u){if(o.da)o=!0;else{u=new re(u,this);const f=o.listener,p=o.ha||o.src;o.fa&&Ro(o),o=f.call(p,u)}return o}function So(o){return o=o[Ao],o instanceof Fs?o:null}var Po="__closure_events_fn_"+(Math.random()*1e9>>>0);function cu(o){return typeof o=="function"?o:(o[Po]||(o[Po]=function(u){return o.handleEvent(u)}),o[Po])}function Ce(){w.call(this),this.i=new Fs(this),this.M=this,this.G=null}g(Ce,w),Ce.prototype[xe]=!0,Ce.prototype.removeEventListener=function(o,u,f,p){ou(this,o,u,f,p)};function Fe(o,u){var f,p=o.G;if(p)for(f=[];p;p=p.G)f.push(p);if(o=o.M,p=u.type||u,typeof u=="string")u=new E(u,o);else if(u instanceof E)u.target=u.target||o;else{var b=u;u=new E(p,o),su(u,b)}b=!0;let R,D;if(f)for(D=f.length-1;D>=0;D--)R=u.g=f[D],b=Us(R,p,!0,u)&&b;if(R=u.g=o,b=Us(R,p,!0,u)&&b,b=Us(R,p,!1,u)&&b,f)for(D=0;D<f.length;D++)R=u.g=f[D],b=Us(R,p,!1,u)&&b}Ce.prototype.N=function(){if(Ce.Z.N.call(this),this.i){var o=this.i;for(const u in o.g){const f=o.g[u];for(let p=0;p<f.length;p++)Ls(f[p]);delete o.g[u],o.h--}}this.G=null},Ce.prototype.J=function(o,u,f,p){return this.i.add(String(o),u,!1,f,p)},Ce.prototype.K=function(o,u,f,p){return this.i.add(String(o),u,!0,f,p)};function Us(o,u,f,p){if(u=o.i.g[String(u)],!u)return!0;u=u.concat();let b=!0;for(let R=0;R<u.length;++R){const D=u[R];if(D&&!D.da&&D.capture==f){const z=D.listener,me=D.ha||D.src;D.fa&&Io(o.i,D),b=z.call(me,p)!==!1&&b}}return b&&!p.defaultPrevented}function sm(o,u){if(typeof o!="function")if(o&&typeof o.handleEvent=="function")o=h(o.handleEvent,o);else throw Error("Invalid listener argument");return Number(u)>2147483647?-1:a.setTimeout(o,u||0)}function uu(o){o.g=sm(()=>{o.g=null,o.i&&(o.i=!1,uu(o))},o.l);const u=o.h;o.h=null,o.m.apply(null,u)}class im extends w{constructor(u,f){super(),this.m=u,this.l=f,this.h=null,this.i=!1,this.g=null}j(u){this.h=arguments,this.g?this.i=!0:uu(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Fr(o){w.call(this),this.h=o,this.g={}}g(Fr,w);var lu=[];function hu(o){xs(o.g,function(u,f){this.g.hasOwnProperty(f)&&Ro(u)},o),o.g={}}Fr.prototype.N=function(){Fr.Z.N.call(this),hu(this)},Fr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Co=a.JSON.stringify,om=a.JSON.parse,am=class{stringify(o){return a.JSON.stringify(o,void 0)}parse(o){return a.JSON.parse(o,void 0)}};function fu(){}function du(){}var Ur={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function ko(){E.call(this,"d")}g(ko,E);function No(){E.call(this,"c")}g(No,E);var _n={},pu=null;function Bs(){return pu=pu||new Ce}_n.Ia="serverreachability";function mu(o){E.call(this,_n.Ia,o)}g(mu,E);function Br(o){const u=Bs();Fe(u,new mu(u))}_n.STAT_EVENT="statevent";function gu(o,u){E.call(this,_n.STAT_EVENT,o),this.stat=u}g(gu,E);function Ue(o){const u=Bs();Fe(u,new gu(u,o))}_n.Ja="timingevent";function _u(o,u){E.call(this,_n.Ja,o),this.size=u}g(_u,E);function jr(o,u){if(typeof o!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){o()},u)}function qr(){this.g=!0}qr.prototype.ua=function(){this.g=!1};function cm(o,u,f,p,b,R){o.info(function(){if(o.g)if(R){var D="",z=R.split("&");for(let ne=0;ne<z.length;ne++){var me=z[ne].split("=");if(me.length>1){const Te=me[0];me=me[1];const ut=Te.split("_");D=ut.length>=2&&ut[1]=="type"?D+(Te+"="+me+"&"):D+(Te+"=redacted&")}}}else D=null;else D=R;return"XMLHTTP REQ ("+p+") [attempt "+b+"]: "+u+`
`+f+`
`+D})}function um(o,u,f,p,b,R,D){o.info(function(){return"XMLHTTP RESP ("+p+") [ attempt "+b+"]: "+u+`
`+f+`
`+R+" "+D})}function Hn(o,u,f,p){o.info(function(){return"XMLHTTP TEXT ("+u+"): "+hm(o,f)+(p?" "+p:"")})}function lm(o,u){o.info(function(){return"TIMEOUT: "+u})}qr.prototype.info=function(){};function hm(o,u){if(!o.g)return u;if(!u)return null;try{const R=JSON.parse(u);if(R){for(o=0;o<R.length;o++)if(Array.isArray(R[o])){var f=R[o];if(!(f.length<2)){var p=f[1];if(Array.isArray(p)&&!(p.length<1)){var b=p[0];if(b!="noop"&&b!="stop"&&b!="close")for(let D=1;D<p.length;D++)p[D]=""}}}}return Co(R)}catch{return u}}var js={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},yu={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},vu;function Do(){}g(Do,fu),Do.prototype.g=function(){return new XMLHttpRequest},vu=new Do;function $r(o){return encodeURIComponent(String(o))}function fm(o){var u=1;o=o.split(":");const f=[];for(;u>0&&o.length;)f.push(o.shift()),u--;return o.length&&f.push(o.join(":")),f}function Bt(o,u,f,p){this.j=o,this.i=u,this.l=f,this.S=p||1,this.V=new Fr(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Eu}function Eu(){this.i=null,this.g="",this.h=!1}var Tu={},Vo={};function Oo(o,u,f){o.M=1,o.A=$s(ct(u)),o.u=f,o.R=!0,Iu(o,null)}function Iu(o,u){o.F=Date.now(),qs(o),o.B=ct(o.A);var f=o.B,p=o.S;Array.isArray(p)||(p=[String(p)]),Mu(f.i,"t",p),o.C=0,f=o.j.L,o.h=new Eu,o.g=Zu(o.j,f?u:null,!o.u),o.P>0&&(o.O=new im(h(o.Y,o,o.g),o.P)),u=o.V,f=o.g,p=o.ba;var b="readystatechange";Array.isArray(b)||(b&&(lu[0]=b.toString()),b=lu);for(let R=0;R<b.length;R++){const D=iu(f,b[R],p||u.handleEvent,!1,u.h||u);if(!D)break;u.g[D.key]=D}u=o.J?nu(o.J):{},o.u?(o.v||(o.v="POST"),u["Content-Type"]="application/x-www-form-urlencoded",o.g.ea(o.B,o.v,o.u,u)):(o.v="GET",o.g.ea(o.B,o.v,null,u)),Br(),cm(o.i,o.v,o.B,o.l,o.S,o.u)}Bt.prototype.ba=function(o){o=o.target;const u=this.O;u&&$t(o)==3?u.j():this.Y(o)},Bt.prototype.Y=function(o){try{if(o==this.g)e:{const z=$t(this.g),me=this.g.ya(),ne=this.g.ca();if(!(z<3)&&(z!=3||this.g&&(this.h.h||this.g.la()||qu(this.g)))){this.K||z!=4||me==7||(me==8||ne<=0?Br(3):Br(2)),Mo(this);var u=this.g.ca();this.X=u;var f=dm(this);if(this.o=u==200,um(this.i,this.v,this.B,this.l,this.S,z,u),this.o){if(this.U&&!this.L){t:{if(this.g){var p,b=this.g;if((p=b.g?b.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!y(p)){var R=p;break t}}R=null}if(o=R)Hn(this.i,this.l,o,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Lo(this,o);else{this.o=!1,this.m=3,Ue(12),yn(this),zr(this);break e}}if(this.R){o=!0;let Te;for(;!this.K&&this.C<f.length;)if(Te=pm(this,f),Te==Vo){z==4&&(this.m=4,Ue(14),o=!1),Hn(this.i,this.l,null,"[Incomplete Response]");break}else if(Te==Tu){this.m=4,Ue(15),Hn(this.i,this.l,f,"[Invalid Chunk]"),o=!1;break}else Hn(this.i,this.l,Te,null),Lo(this,Te);if(wu(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),z!=4||f.length!=0||this.h.h||(this.m=1,Ue(16),o=!1),this.o=this.o&&o,!o)Hn(this.i,this.l,f,"[Invalid Chunked Response]"),yn(this),zr(this);else if(f.length>0&&!this.W){this.W=!0;var D=this.j;D.g==this&&D.aa&&!D.P&&(D.j.info("Great, no buffering proxy detected. Bytes received: "+f.length),zo(D),D.P=!0,Ue(11))}}else Hn(this.i,this.l,f,null),Lo(this,f);z==4&&yn(this),this.o&&!this.K&&(z==4?Qu(this.j,this):(this.o=!1,qs(this)))}else Pm(this.g),u==400&&f.indexOf("Unknown SID")>0?(this.m=3,Ue(12)):(this.m=0,Ue(13)),yn(this),zr(this)}}}catch{}finally{}};function dm(o){if(!wu(o))return o.g.la();const u=qu(o.g);if(u==="")return"";let f="";const p=u.length,b=$t(o.g)==4;if(!o.h.i){if(typeof TextDecoder>"u")return yn(o),zr(o),"";o.h.i=new a.TextDecoder}for(let R=0;R<p;R++)o.h.h=!0,f+=o.h.i.decode(u[R],{stream:!(b&&R==p-1)});return u.length=0,o.h.g+=f,o.C=0,o.h.g}function wu(o){return o.g?o.v=="GET"&&o.M!=2&&o.j.Aa:!1}function pm(o,u){var f=o.C,p=u.indexOf(`
`,f);return p==-1?Vo:(f=Number(u.substring(f,p)),isNaN(f)?Tu:(p+=1,p+f>u.length?Vo:(u=u.slice(p,p+f),o.C=p+f,u)))}Bt.prototype.cancel=function(){this.K=!0,yn(this)};function qs(o){o.T=Date.now()+o.H,Au(o,o.H)}function Au(o,u){if(o.D!=null)throw Error("WatchDog timer not null");o.D=jr(h(o.aa,o),u)}function Mo(o){o.D&&(a.clearTimeout(o.D),o.D=null)}Bt.prototype.aa=function(){this.D=null;const o=Date.now();o-this.T>=0?(lm(this.i,this.B),this.M!=2&&(Br(),Ue(17)),yn(this),this.m=2,zr(this)):Au(this,this.T-o)};function zr(o){o.j.I==0||o.K||Qu(o.j,o)}function yn(o){Mo(o);var u=o.O;u&&typeof u.dispose=="function"&&u.dispose(),o.O=null,hu(o.V),o.g&&(u=o.g,o.g=null,u.abort(),u.dispose())}function Lo(o,u){try{var f=o.j;if(f.I!=0&&(f.g==o||xo(f.h,o))){if(!o.L&&xo(f.h,o)&&f.I==3){try{var p=f.Ba.g.parse(u)}catch{p=null}if(Array.isArray(p)&&p.length==3){var b=p;if(b[0]==0){e:if(!f.v){if(f.g)if(f.g.F+3e3<o.F)Ks(f),Ws(f);else break e;$o(f),Ue(18)}}else f.xa=b[1],0<f.xa-f.K&&b[2]<37500&&f.F&&f.A==0&&!f.C&&(f.C=jr(h(f.Va,f),6e3));Su(f.h)<=1&&f.ta&&(f.ta=void 0)}else En(f,11)}else if((o.L||f.g==o)&&Ks(f),!y(u))for(b=f.Ba.g.parse(u),u=0;u<b.length;u++){let ne=b[u];const Te=ne[0];if(!(Te<=f.K))if(f.K=Te,ne=ne[1],f.I==2)if(ne[0]=="c"){f.M=ne[1],f.ba=ne[2];const ut=ne[3];ut!=null&&(f.ka=ut,f.j.info("VER="+f.ka));const Tn=ne[4];Tn!=null&&(f.za=Tn,f.j.info("SVER="+f.za));const zt=ne[5];zt!=null&&typeof zt=="number"&&zt>0&&(p=1.5*zt,f.O=p,f.j.info("backChannelRequestTimeoutMs_="+p)),p=f;const Ht=o.g;if(Ht){const Xs=Ht.g?Ht.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Xs){var R=p.h;R.g||Xs.indexOf("spdy")==-1&&Xs.indexOf("quic")==-1&&Xs.indexOf("h2")==-1||(R.j=R.l,R.g=new Set,R.h&&(Fo(R,R.h),R.h=null))}if(p.G){const Ho=Ht.g?Ht.g.getResponseHeader("X-HTTP-Session-Id"):null;Ho&&(p.wa=Ho,se(p.J,p.G,Ho))}}f.I=3,f.l&&f.l.ra(),f.aa&&(f.T=Date.now()-o.F,f.j.info("Handshake RTT: "+f.T+"ms")),p=f;var D=o;if(p.na=Yu(p,p.L?p.ba:null,p.W),D.L){Pu(p.h,D);var z=D,me=p.O;me&&(z.H=me),z.D&&(Mo(z),qs(z)),p.g=D}else Gu(p);f.i.length>0&&Gs(f)}else ne[0]!="stop"&&ne[0]!="close"||En(f,7);else f.I==3&&(ne[0]=="stop"||ne[0]=="close"?ne[0]=="stop"?En(f,7):qo(f):ne[0]!="noop"&&f.l&&f.l.qa(ne),f.A=0)}}Br(4)}catch{}}var mm=class{constructor(o,u){this.g=o,this.map=u}};function bu(o){this.l=o||10,a.PerformanceNavigationTiming?(o=a.performance.getEntriesByType("navigation"),o=o.length>0&&(o[0].nextHopProtocol=="hq"||o[0].nextHopProtocol=="h2")):o=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=o?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Ru(o){return o.h?!0:o.g?o.g.size>=o.j:!1}function Su(o){return o.h?1:o.g?o.g.size:0}function xo(o,u){return o.h?o.h==u:o.g?o.g.has(u):!1}function Fo(o,u){o.g?o.g.add(u):o.h=u}function Pu(o,u){o.h&&o.h==u?o.h=null:o.g&&o.g.has(u)&&o.g.delete(u)}bu.prototype.cancel=function(){if(this.i=Cu(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const o of this.g.values())o.cancel();this.g.clear()}};function Cu(o){if(o.h!=null)return o.i.concat(o.h.G);if(o.g!=null&&o.g.size!==0){let u=o.i;for(const f of o.g.values())u=u.concat(f.G);return u}return T(o.i)}var ku=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function gm(o,u){if(o){o=o.split("&");for(let f=0;f<o.length;f++){const p=o[f].indexOf("=");let b,R=null;p>=0?(b=o[f].substring(0,p),R=o[f].substring(p+1)):b=o[f],u(b,R?decodeURIComponent(R.replace(/\+/g," ")):"")}}}function jt(o){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let u;o instanceof jt?(this.l=o.l,Hr(this,o.j),this.o=o.o,this.g=o.g,Wr(this,o.u),this.h=o.h,Uo(this,Lu(o.i)),this.m=o.m):o&&(u=String(o).match(ku))?(this.l=!1,Hr(this,u[1]||"",!0),this.o=Gr(u[2]||""),this.g=Gr(u[3]||"",!0),Wr(this,u[4]),this.h=Gr(u[5]||"",!0),Uo(this,u[6]||"",!0),this.m=Gr(u[7]||"")):(this.l=!1,this.i=new Qr(null,this.l))}jt.prototype.toString=function(){const o=[];var u=this.j;u&&o.push(Kr(u,Nu,!0),":");var f=this.g;return(f||u=="file")&&(o.push("//"),(u=this.o)&&o.push(Kr(u,Nu,!0),"@"),o.push($r(f).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f=this.u,f!=null&&o.push(":",String(f))),(f=this.h)&&(this.g&&f.charAt(0)!="/"&&o.push("/"),o.push(Kr(f,f.charAt(0)=="/"?vm:ym,!0))),(f=this.i.toString())&&o.push("?",f),(f=this.m)&&o.push("#",Kr(f,Tm)),o.join("")},jt.prototype.resolve=function(o){const u=ct(this);let f=!!o.j;f?Hr(u,o.j):f=!!o.o,f?u.o=o.o:f=!!o.g,f?u.g=o.g:f=o.u!=null;var p=o.h;if(f)Wr(u,o.u);else if(f=!!o.h){if(p.charAt(0)!="/")if(this.g&&!this.h)p="/"+p;else{var b=u.h.lastIndexOf("/");b!=-1&&(p=u.h.slice(0,b+1)+p)}if(b=p,b==".."||b==".")p="";else if(b.indexOf("./")!=-1||b.indexOf("/.")!=-1){p=b.lastIndexOf("/",0)==0,b=b.split("/");const R=[];for(let D=0;D<b.length;){const z=b[D++];z=="."?p&&D==b.length&&R.push(""):z==".."?((R.length>1||R.length==1&&R[0]!="")&&R.pop(),p&&D==b.length&&R.push("")):(R.push(z),p=!0)}p=R.join("/")}else p=b}return f?u.h=p:f=o.i.toString()!=="",f?Uo(u,Lu(o.i)):f=!!o.m,f&&(u.m=o.m),u};function ct(o){return new jt(o)}function Hr(o,u,f){o.j=f?Gr(u,!0):u,o.j&&(o.j=o.j.replace(/:$/,""))}function Wr(o,u){if(u){if(u=Number(u),isNaN(u)||u<0)throw Error("Bad port number "+u);o.u=u}else o.u=null}function Uo(o,u,f){u instanceof Qr?(o.i=u,Im(o.i,o.l)):(f||(u=Kr(u,Em)),o.i=new Qr(u,o.l))}function se(o,u,f){o.i.set(u,f)}function $s(o){return se(o,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),o}function Gr(o,u){return o?u?decodeURI(o.replace(/%25/g,"%2525")):decodeURIComponent(o):""}function Kr(o,u,f){return typeof o=="string"?(o=encodeURI(o).replace(u,_m),f&&(o=o.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),o):null}function _m(o){return o=o.charCodeAt(0),"%"+(o>>4&15).toString(16)+(o&15).toString(16)}var Nu=/[#\/\?@]/g,ym=/[#\?:]/g,vm=/[#\?]/g,Em=/[#\?@]/g,Tm=/#/g;function Qr(o,u){this.h=this.g=null,this.i=o||null,this.j=!!u}function vn(o){o.g||(o.g=new Map,o.h=0,o.i&&gm(o.i,function(u,f){o.add(decodeURIComponent(u.replace(/\+/g," ")),f)}))}n=Qr.prototype,n.add=function(o,u){vn(this),this.i=null,o=Wn(this,o);let f=this.g.get(o);return f||this.g.set(o,f=[]),f.push(u),this.h+=1,this};function Du(o,u){vn(o),u=Wn(o,u),o.g.has(u)&&(o.i=null,o.h-=o.g.get(u).length,o.g.delete(u))}function Vu(o,u){return vn(o),u=Wn(o,u),o.g.has(u)}n.forEach=function(o,u){vn(this),this.g.forEach(function(f,p){f.forEach(function(b){o.call(u,b,p,this)},this)},this)};function Ou(o,u){vn(o);let f=[];if(typeof u=="string")Vu(o,u)&&(f=f.concat(o.g.get(Wn(o,u))));else for(o=Array.from(o.g.values()),u=0;u<o.length;u++)f=f.concat(o[u]);return f}n.set=function(o,u){return vn(this),this.i=null,o=Wn(this,o),Vu(this,o)&&(this.h-=this.g.get(o).length),this.g.set(o,[u]),this.h+=1,this},n.get=function(o,u){return o?(o=Ou(this,o),o.length>0?String(o[0]):u):u};function Mu(o,u,f){Du(o,u),f.length>0&&(o.i=null,o.g.set(Wn(o,u),T(f)),o.h+=f.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const o=[],u=Array.from(this.g.keys());for(let p=0;p<u.length;p++){var f=u[p];const b=$r(f);f=Ou(this,f);for(let R=0;R<f.length;R++){let D=b;f[R]!==""&&(D+="="+$r(f[R])),o.push(D)}}return this.i=o.join("&")};function Lu(o){const u=new Qr;return u.i=o.i,o.g&&(u.g=new Map(o.g),u.h=o.h),u}function Wn(o,u){return u=String(u),o.j&&(u=u.toLowerCase()),u}function Im(o,u){u&&!o.j&&(vn(o),o.i=null,o.g.forEach(function(f,p){const b=p.toLowerCase();p!=b&&(Du(this,p),Mu(this,b,f))},o)),o.j=u}function wm(o,u){const f=new qr;if(a.Image){const p=new Image;p.onload=d(qt,f,"TestLoadImage: loaded",!0,u,p),p.onerror=d(qt,f,"TestLoadImage: error",!1,u,p),p.onabort=d(qt,f,"TestLoadImage: abort",!1,u,p),p.ontimeout=d(qt,f,"TestLoadImage: timeout",!1,u,p),a.setTimeout(function(){p.ontimeout&&p.ontimeout()},1e4),p.src=o}else u(!1)}function Am(o,u){const f=new qr,p=new AbortController,b=setTimeout(()=>{p.abort(),qt(f,"TestPingServer: timeout",!1,u)},1e4);fetch(o,{signal:p.signal}).then(R=>{clearTimeout(b),R.ok?qt(f,"TestPingServer: ok",!0,u):qt(f,"TestPingServer: server error",!1,u)}).catch(()=>{clearTimeout(b),qt(f,"TestPingServer: error",!1,u)})}function qt(o,u,f,p,b){try{b&&(b.onload=null,b.onerror=null,b.onabort=null,b.ontimeout=null),p(f)}catch{}}function bm(){this.g=new am}function Bo(o){this.i=o.Sb||null,this.h=o.ab||!1}g(Bo,fu),Bo.prototype.g=function(){return new zs(this.i,this.h)};function zs(o,u){Ce.call(this),this.H=o,this.o=u,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}g(zs,Ce),n=zs.prototype,n.open=function(o,u){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=o,this.D=u,this.readyState=1,Jr(this)},n.send=function(o){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const u={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};o&&(u.body=o),(this.H||a).fetch(new Request(this.D,u)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Xr(this)),this.readyState=0},n.Pa=function(o){if(this.g&&(this.l=o,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=o.headers,this.readyState=2,Jr(this)),this.g&&(this.readyState=3,Jr(this),this.g)))if(this.responseType==="arraybuffer")o.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in o){if(this.j=o.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;xu(this)}else o.text().then(this.Oa.bind(this),this.ga.bind(this))};function xu(o){o.j.read().then(o.Ma.bind(o)).catch(o.ga.bind(o))}n.Ma=function(o){if(this.g){if(this.o&&o.value)this.response.push(o.value);else if(!this.o){var u=o.value?o.value:new Uint8Array(0);(u=this.B.decode(u,{stream:!o.done}))&&(this.response=this.responseText+=u)}o.done?Xr(this):Jr(this),this.readyState==3&&xu(this)}},n.Oa=function(o){this.g&&(this.response=this.responseText=o,Xr(this))},n.Na=function(o){this.g&&(this.response=o,Xr(this))},n.ga=function(){this.g&&Xr(this)};function Xr(o){o.readyState=4,o.l=null,o.j=null,o.B=null,Jr(o)}n.setRequestHeader=function(o,u){this.A.append(o,u)},n.getResponseHeader=function(o){return this.h&&this.h.get(o.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const o=[],u=this.h.entries();for(var f=u.next();!f.done;)f=f.value,o.push(f[0]+": "+f[1]),f=u.next();return o.join(`\r
`)};function Jr(o){o.onreadystatechange&&o.onreadystatechange.call(o)}Object.defineProperty(zs.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(o){this.m=o?"include":"same-origin"}});function Fu(o){let u="";return xs(o,function(f,p){u+=p,u+=":",u+=f,u+=`\r
`}),u}function jo(o,u,f){e:{for(p in f){var p=!1;break e}p=!0}p||(f=Fu(f),typeof o=="string"?f!=null&&$r(f):se(o,u,f))}function le(o){Ce.call(this),this.headers=new Map,this.L=o||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}g(le,Ce);var Rm=/^https?$/i,Sm=["POST","PUT"];n=le.prototype,n.Fa=function(o){this.H=o},n.ea=function(o,u,f,p){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+o);u=u?u.toUpperCase():"GET",this.D=o,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():vu.g(),this.g.onreadystatechange=m(h(this.Ca,this));try{this.B=!0,this.g.open(u,String(o),!0),this.B=!1}catch(R){Uu(this,R);return}if(o=f||"",f=new Map(this.headers),p)if(Object.getPrototypeOf(p)===Object.prototype)for(var b in p)f.set(b,p[b]);else if(typeof p.keys=="function"&&typeof p.get=="function")for(const R of p.keys())f.set(R,p.get(R));else throw Error("Unknown input type for opt_headers: "+String(p));p=Array.from(f.keys()).find(R=>R.toLowerCase()=="content-type"),b=a.FormData&&o instanceof a.FormData,!(Array.prototype.indexOf.call(Sm,u,void 0)>=0)||p||b||f.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[R,D]of f)this.g.setRequestHeader(R,D);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(o),this.v=!1}catch(R){Uu(this,R)}};function Uu(o,u){o.h=!1,o.g&&(o.j=!0,o.g.abort(),o.j=!1),o.l=u,o.o=5,Bu(o),Hs(o)}function Bu(o){o.A||(o.A=!0,Fe(o,"complete"),Fe(o,"error"))}n.abort=function(o){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=o||7,Fe(this,"complete"),Fe(this,"abort"),Hs(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Hs(this,!0)),le.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?ju(this):this.Xa())},n.Xa=function(){ju(this)};function ju(o){if(o.h&&typeof i<"u"){if(o.v&&$t(o)==4)setTimeout(o.Ca.bind(o),0);else if(Fe(o,"readystatechange"),$t(o)==4){o.h=!1;try{const R=o.ca();e:switch(R){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var u=!0;break e;default:u=!1}var f;if(!(f=u)){var p;if(p=R===0){let D=String(o.D).match(ku)[1]||null;!D&&a.self&&a.self.location&&(D=a.self.location.protocol.slice(0,-1)),p=!Rm.test(D?D.toLowerCase():"")}f=p}if(f)Fe(o,"complete"),Fe(o,"success");else{o.o=6;try{var b=$t(o)>2?o.g.statusText:""}catch{b=""}o.l=b+" ["+o.ca()+"]",Bu(o)}}finally{Hs(o)}}}}function Hs(o,u){if(o.g){o.m&&(clearTimeout(o.m),o.m=null);const f=o.g;o.g=null,u||Fe(o,"ready");try{f.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function $t(o){return o.g?o.g.readyState:0}n.ca=function(){try{return $t(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(o){if(this.g){var u=this.g.responseText;return o&&u.indexOf(o)==0&&(u=u.substring(o.length)),om(u)}};function qu(o){try{if(!o.g)return null;if("response"in o.g)return o.g.response;switch(o.F){case"":case"text":return o.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in o.g)return o.g.mozResponseArrayBuffer}return null}catch{return null}}function Pm(o){const u={};o=(o.g&&$t(o)>=2&&o.g.getAllResponseHeaders()||"").split(`\r
`);for(let p=0;p<o.length;p++){if(y(o[p]))continue;var f=fm(o[p]);const b=f[0];if(f=f[1],typeof f!="string")continue;f=f.trim();const R=u[b]||[];u[b]=R,R.push(f)}em(u,function(p){return p.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Yr(o,u,f){return f&&f.internalChannelParams&&f.internalChannelParams[o]||u}function $u(o){this.za=0,this.i=[],this.j=new qr,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Yr("failFast",!1,o),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Yr("baseRetryDelayMs",5e3,o),this.Za=Yr("retryDelaySeedMs",1e4,o),this.Ta=Yr("forwardChannelMaxRetries",2,o),this.va=Yr("forwardChannelRequestTimeoutMs",2e4,o),this.ma=o&&o.xmlHttpFactory||void 0,this.Ua=o&&o.Rb||void 0,this.Aa=o&&o.useFetchStreams||!1,this.O=void 0,this.L=o&&o.supportsCrossDomainXhr||!1,this.M="",this.h=new bu(o&&o.concurrentRequestLimit),this.Ba=new bm,this.S=o&&o.fastHandshake||!1,this.R=o&&o.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=o&&o.Pb||!1,o&&o.ua&&this.j.ua(),o&&o.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&o&&o.detectBufferingProxy||!1,this.ia=void 0,o&&o.longPollingTimeout&&o.longPollingTimeout>0&&(this.ia=o.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=$u.prototype,n.ka=8,n.I=1,n.connect=function(o,u,f,p){Ue(0),this.W=o,this.H=u||{},f&&p!==void 0&&(this.H.OSID=f,this.H.OAID=p),this.F=this.X,this.J=Yu(this,null,this.W),Gs(this)};function qo(o){if(zu(o),o.I==3){var u=o.V++,f=ct(o.J);if(se(f,"SID",o.M),se(f,"RID",u),se(f,"TYPE","terminate"),Zr(o,f),u=new Bt(o,o.j,u),u.M=2,u.A=$s(ct(f)),f=!1,a.navigator&&a.navigator.sendBeacon)try{f=a.navigator.sendBeacon(u.A.toString(),"")}catch{}!f&&a.Image&&(new Image().src=u.A,f=!0),f||(u.g=Zu(u.j,null),u.g.ea(u.A)),u.F=Date.now(),qs(u)}Ju(o)}function Ws(o){o.g&&(zo(o),o.g.cancel(),o.g=null)}function zu(o){Ws(o),o.v&&(a.clearTimeout(o.v),o.v=null),Ks(o),o.h.cancel(),o.m&&(typeof o.m=="number"&&a.clearTimeout(o.m),o.m=null)}function Gs(o){if(!Ru(o.h)&&!o.m){o.m=!0;var u=o.Ea;Y||_(),te||(Y(),te=!0),I.add(u,o),o.D=0}}function Cm(o,u){return Su(o.h)>=o.h.j-(o.m?1:0)?!1:o.m?(o.i=u.G.concat(o.i),!0):o.I==1||o.I==2||o.D>=(o.Sa?0:o.Ta)?!1:(o.m=jr(h(o.Ea,o,u),Xu(o,o.D)),o.D++,!0)}n.Ea=function(o){if(this.m)if(this.m=null,this.I==1){if(!o){this.V=Math.floor(Math.random()*1e5),o=this.V++;const b=new Bt(this,this.j,o);let R=this.o;if(this.U&&(R?(R=nu(R),su(R,this.U)):R=this.U),this.u!==null||this.R||(b.J=R,R=null),this.S)e:{for(var u=0,f=0;f<this.i.length;f++){t:{var p=this.i[f];if("__data__"in p.map&&(p=p.map.__data__,typeof p=="string")){p=p.length;break t}p=void 0}if(p===void 0)break;if(u+=p,u>4096){u=f;break e}if(u===4096||f===this.i.length-1){u=f+1;break e}}u=1e3}else u=1e3;u=Wu(this,b,u),f=ct(this.J),se(f,"RID",o),se(f,"CVER",22),this.G&&se(f,"X-HTTP-Session-Id",this.G),Zr(this,f),R&&(this.R?u="headers="+$r(Fu(R))+"&"+u:this.u&&jo(f,this.u,R)),Fo(this.h,b),this.Ra&&se(f,"TYPE","init"),this.S?(se(f,"$req",u),se(f,"SID","null"),b.U=!0,Oo(b,f,null)):Oo(b,f,u),this.I=2}}else this.I==3&&(o?Hu(this,o):this.i.length==0||Ru(this.h)||Hu(this))};function Hu(o,u){var f;u?f=u.l:f=o.V++;const p=ct(o.J);se(p,"SID",o.M),se(p,"RID",f),se(p,"AID",o.K),Zr(o,p),o.u&&o.o&&jo(p,o.u,o.o),f=new Bt(o,o.j,f,o.D+1),o.u===null&&(f.J=o.o),u&&(o.i=u.G.concat(o.i)),u=Wu(o,f,1e3),f.H=Math.round(o.va*.5)+Math.round(o.va*.5*Math.random()),Fo(o.h,f),Oo(f,p,u)}function Zr(o,u){o.H&&xs(o.H,function(f,p){se(u,p,f)}),o.l&&xs({},function(f,p){se(u,p,f)})}function Wu(o,u,f){f=Math.min(o.i.length,f);const p=o.l?h(o.l.Ka,o.l,o):null;e:{var b=o.i;let z=-1;for(;;){const me=["count="+f];z==-1?f>0?(z=b[0].g,me.push("ofs="+z)):z=0:me.push("ofs="+z);let ne=!0;for(let Te=0;Te<f;Te++){var R=b[Te].g;const ut=b[Te].map;if(R-=z,R<0)z=Math.max(0,b[Te].g-100),ne=!1;else try{R="req"+R+"_"||"";try{var D=ut instanceof Map?ut:Object.entries(ut);for(const[Tn,zt]of D){let Ht=zt;c(zt)&&(Ht=Co(zt)),me.push(R+Tn+"="+encodeURIComponent(Ht))}}catch(Tn){throw me.push(R+"type="+encodeURIComponent("_badmap")),Tn}}catch{p&&p(ut)}}if(ne){D=me.join("&");break e}}D=void 0}return o=o.i.splice(0,f),u.G=o,D}function Gu(o){if(!o.g&&!o.v){o.Y=1;var u=o.Da;Y||_(),te||(Y(),te=!0),I.add(u,o),o.A=0}}function $o(o){return o.g||o.v||o.A>=3?!1:(o.Y++,o.v=jr(h(o.Da,o),Xu(o,o.A)),o.A++,!0)}n.Da=function(){if(this.v=null,Ku(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var o=4*this.T;this.j.info("BP detection timer enabled: "+o),this.B=jr(h(this.Wa,this),o)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Ue(10),Ws(this),Ku(this))};function zo(o){o.B!=null&&(a.clearTimeout(o.B),o.B=null)}function Ku(o){o.g=new Bt(o,o.j,"rpc",o.Y),o.u===null&&(o.g.J=o.o),o.g.P=0;var u=ct(o.na);se(u,"RID","rpc"),se(u,"SID",o.M),se(u,"AID",o.K),se(u,"CI",o.F?"0":"1"),!o.F&&o.ia&&se(u,"TO",o.ia),se(u,"TYPE","xmlhttp"),Zr(o,u),o.u&&o.o&&jo(u,o.u,o.o),o.O&&(o.g.H=o.O);var f=o.g;o=o.ba,f.M=1,f.A=$s(ct(u)),f.u=null,f.R=!0,Iu(f,o)}n.Va=function(){this.C!=null&&(this.C=null,Ws(this),$o(this),Ue(19))};function Ks(o){o.C!=null&&(a.clearTimeout(o.C),o.C=null)}function Qu(o,u){var f=null;if(o.g==u){Ks(o),zo(o),o.g=null;var p=2}else if(xo(o.h,u))f=u.G,Pu(o.h,u),p=1;else return;if(o.I!=0){if(u.o)if(p==1){f=u.u?u.u.length:0,u=Date.now()-u.F;var b=o.D;p=Bs(),Fe(p,new _u(p,f)),Gs(o)}else Gu(o);else if(b=u.m,b==3||b==0&&u.X>0||!(p==1&&Cm(o,u)||p==2&&$o(o)))switch(f&&f.length>0&&(u=o.h,u.i=u.i.concat(f)),b){case 1:En(o,5);break;case 4:En(o,10);break;case 3:En(o,6);break;default:En(o,2)}}}function Xu(o,u){let f=o.Qa+Math.floor(Math.random()*o.Za);return o.isActive()||(f*=2),f*u}function En(o,u){if(o.j.info("Error code "+u),u==2){var f=h(o.bb,o),p=o.Ua;const b=!p;p=new jt(p||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Hr(p,"https"),$s(p),b?wm(p.toString(),f):Am(p.toString(),f)}else Ue(2);o.I=0,o.l&&o.l.pa(u),Ju(o),zu(o)}n.bb=function(o){o?(this.j.info("Successfully pinged google.com"),Ue(2)):(this.j.info("Failed to ping google.com"),Ue(1))};function Ju(o){if(o.I=0,o.ja=[],o.l){const u=Cu(o.h);(u.length!=0||o.i.length!=0)&&(S(o.ja,u),S(o.ja,o.i),o.h.i.length=0,T(o.i),o.i.length=0),o.l.oa()}}function Yu(o,u,f){var p=f instanceof jt?ct(f):new jt(f);if(p.g!="")u&&(p.g=u+"."+p.g),Wr(p,p.u);else{var b=a.location;p=b.protocol,u=u?u+"."+b.hostname:b.hostname,b=+b.port;const R=new jt(null);p&&Hr(R,p),u&&(R.g=u),b&&Wr(R,b),f&&(R.h=f),p=R}return f=o.G,u=o.wa,f&&u&&se(p,f,u),se(p,"VER",o.ka),Zr(o,p),p}function Zu(o,u,f){if(u&&!o.L)throw Error("Can't create secondary domain capable XhrIo object.");return u=o.Aa&&!o.ma?new le(new Bo({ab:f})):new le(o.ma),u.Fa(o.L),u}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function el(){}n=el.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Qs(){}Qs.prototype.g=function(o,u){return new Ke(o,u)};function Ke(o,u){Ce.call(this),this.g=new $u(u),this.l=o,this.h=u&&u.messageUrlParams||null,o=u&&u.messageHeaders||null,u&&u.clientProtocolHeaderRequired&&(o?o["X-Client-Protocol"]="webchannel":o={"X-Client-Protocol":"webchannel"}),this.g.o=o,o=u&&u.initMessageHeaders||null,u&&u.messageContentType&&(o?o["X-WebChannel-Content-Type"]=u.messageContentType:o={"X-WebChannel-Content-Type":u.messageContentType}),u&&u.sa&&(o?o["X-WebChannel-Client-Profile"]=u.sa:o={"X-WebChannel-Client-Profile":u.sa}),this.g.U=o,(o=u&&u.Qb)&&!y(o)&&(this.g.u=o),this.A=u&&u.supportsCrossDomainXhr||!1,this.v=u&&u.sendRawJson||!1,(u=u&&u.httpSessionIdParam)&&!y(u)&&(this.g.G=u,o=this.h,o!==null&&u in o&&(o=this.h,u in o&&delete o[u])),this.j=new Gn(this)}g(Ke,Ce),Ke.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Ke.prototype.close=function(){qo(this.g)},Ke.prototype.o=function(o){var u=this.g;if(typeof o=="string"){var f={};f.__data__=o,o=f}else this.v&&(f={},f.__data__=Co(o),o=f);u.i.push(new mm(u.Ya++,o)),u.I==3&&Gs(u)},Ke.prototype.N=function(){this.g.l=null,delete this.j,qo(this.g),delete this.g,Ke.Z.N.call(this)};function tl(o){ko.call(this),o.__headers__&&(this.headers=o.__headers__,this.statusCode=o.__status__,delete o.__headers__,delete o.__status__);var u=o.__sm__;if(u){e:{for(const f in u){o=f;break e}o=void 0}(this.i=o)&&(o=this.i,u=u!==null&&o in u?u[o]:void 0),this.data=u}else this.data=o}g(tl,ko);function nl(){No.call(this),this.status=1}g(nl,No);function Gn(o){this.g=o}g(Gn,el),Gn.prototype.ra=function(){Fe(this.g,"a")},Gn.prototype.qa=function(o){Fe(this.g,new tl(o))},Gn.prototype.pa=function(o){Fe(this.g,new nl)},Gn.prototype.oa=function(){Fe(this.g,"b")},Qs.prototype.createWebChannel=Qs.prototype.g,Ke.prototype.send=Ke.prototype.o,Ke.prototype.open=Ke.prototype.m,Ke.prototype.close=Ke.prototype.close,Jf=function(){return new Qs},Xf=function(){return Bs()},Qf=_n,Ia={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},js.NO_ERROR=0,js.TIMEOUT=8,js.HTTP_ERROR=6,ai=js,yu.COMPLETE="complete",Kf=yu,du.EventType=Ur,Ur.OPEN="a",Ur.CLOSE="b",Ur.ERROR="c",Ur.MESSAGE="d",Ce.prototype.listen=Ce.prototype.J,ts=du,le.prototype.listenOnce=le.prototype.K,le.prototype.getLastError=le.prototype.Ha,le.prototype.getLastErrorCode=le.prototype.ya,le.prototype.getStatus=le.prototype.ca,le.prototype.getResponseJson=le.prototype.La,le.prototype.getResponseText=le.prototype.la,le.prototype.send=le.prototype.ea,le.prototype.setWithCredentials=le.prototype.Fa,Gf=le}).apply(typeof Zs<"u"?Zs:typeof self<"u"?self:typeof window<"u"?window:{});const Sl="@firebase/firestore",Pl="4.9.2";class De{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}De.UNAUTHENTICATED=new De(null),De.GOOGLE_CREDENTIALS=new De("google-credentials-uid"),De.FIRST_PARTY=new De("first-party-uid"),De.MOCK_USER=new De("mock-user");let Vr="12.3.0";const Ln=new ic("@firebase/firestore");function Xn(){return Ln.logLevel}function M(n,...e){if(Ln.logLevel<=W.DEBUG){const t=e.map(cc);Ln.debug(`Firestore (${Vr}): ${n}`,...t)}}function Ot(n,...e){if(Ln.logLevel<=W.ERROR){const t=e.map(cc);Ln.error(`Firestore (${Vr}): ${n}`,...t)}}function yr(n,...e){if(Ln.logLevel<=W.WARN){const t=e.map(cc);Ln.warn(`Firestore (${Vr}): ${n}`,...t)}}function cc(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function B(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,Yf(n,r,t)}function Yf(n,e,t){let r=`FIRESTORE (${Vr}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw Ot(r),new Error(r)}function ee(n,e,t,r){let s="Unexpected state";typeof t=="string"?s=t:r=t,n||Yf(e,s,r)}function $(n,e){return n}const N={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class x extends Rt{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Cn{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class Zf{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class $y{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(De.UNAUTHENTICATED)))}shutdown(){}}class zy{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class Hy{constructor(e){this.t=e,this.currentUser=De.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){ee(this.o===void 0,42304);let r=this.i;const s=l=>this.i!==r?(r=this.i,t(l)):Promise.resolve();let i=new Cn;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Cn,e.enqueueRetryable((()=>s(this.currentUser)))};const a=()=>{const l=i;e.enqueueRetryable((async()=>{await l.promise,await s(this.currentUser)}))},c=l=>{M("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit((l=>c(l))),setTimeout((()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?c(l):(M("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Cn)}}),0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((r=>this.i!==e?(M("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ee(typeof r.accessToken=="string",31837,{l:r}),new Zf(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ee(e===null||typeof e=="string",2055,{h:e}),new De(e)}}class Wy{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=De.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class Gy{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new Wy(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(De.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Cl{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Ky{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,et(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){ee(this.o===void 0,3512);const r=i=>{i.error!=null&&M("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const a=i.token!==this.m;return this.m=i.token,M("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable((()=>r(i)))};const s=i=>{M("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((i=>s(i))),setTimeout((()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):M("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new Cl(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(ee(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new Cl(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function Qy(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}class uc{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=Qy(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<t&&(r+=e.charAt(s[i]%62))}return r}}function G(n,e){return n<e?-1:n>e?1:0}function wa(n,e){const t=Math.min(n.length,e.length);for(let r=0;r<t;r++){const s=n.charAt(r),i=e.charAt(r);if(s!==i)return ea(s)===ea(i)?G(s,i):ea(s)?1:-1}return G(n.length,e.length)}const Xy=55296,Jy=57343;function ea(n){const e=n.charCodeAt(0);return e>=Xy&&e<=Jy}function vr(n,e,t){return n.length===e.length&&n.every(((r,s)=>t(r,e[s])))}const kl="__name__";class ht{constructor(e,t,r){t===void 0?t=0:t>e.length&&B(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&B(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return ht.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof ht?e.forEach((r=>{t.push(r)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let s=0;s<r;s++){const i=ht.compareSegments(e.get(s),t.get(s));if(i!==0)return i}return G(e.length,t.length)}static compareSegments(e,t){const r=ht.isNumericId(e),s=ht.isNumericId(t);return r&&!s?-1:!r&&s?1:r&&s?ht.extractNumericId(e).compare(ht.extractNumericId(t)):wa(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return rn.fromString(e.substring(4,e.length-2))}}class oe extends ht{construct(e,t,r){return new oe(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new x(N.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter((s=>s.length>0)))}return new oe(t)}static emptyPath(){return new oe([])}}const Yy=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class be extends ht{construct(e,t,r){return new be(e,t,r)}static isValidIdentifier(e){return Yy.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),be.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===kl}static keyField(){return new be([kl])}static fromServerFormat(e){const t=[];let r="",s=0;const i=()=>{if(r.length===0)throw new x(N.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let a=!1;for(;s<e.length;){const c=e[s];if(c==="\\"){if(s+1===e.length)throw new x(N.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new x(N.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,s+=2}else c==="`"?(a=!a,s++):c!=="."||a?(r+=c,s++):(i(),s++)}if(i(),a)throw new x(N.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new be(t)}static emptyPath(){return new be([])}}class F{constructor(e){this.path=e}static fromPath(e){return new F(oe.fromString(e))}static fromName(e){return new F(oe.fromString(e).popFirst(5))}static empty(){return new F(oe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&oe.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return oe.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new F(new oe(e.slice()))}}function ed(n,e,t){if(!t)throw new x(N.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function Zy(n,e,t,r){if(e===!0&&r===!0)throw new x(N.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function Nl(n){if(!F.isDocumentKey(n))throw new x(N.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function Dl(n){if(F.isDocumentKey(n))throw new x(N.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function td(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function lc(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":B(12329,{type:typeof n})}function sn(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new x(N.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=lc(n);throw new x(N.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function de(n,e){const t={typeString:n};return e&&(t.value=e),t}function Ps(n,e){if(!td(n))throw new x(N.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const s=e[r].typeString,i="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}const a=n[r];if(s&&typeof a!==s){t=`JSON field '${r}' must be a ${s}.`;break}if(i!==void 0&&a!==i.value){t=`Expected '${r}' field to equal '${i.value}'`;break}}if(t)throw new x(N.INVALID_ARGUMENT,t);return!0}const Vl=-62135596800,Ol=1e6;class ae{static now(){return ae.fromMillis(Date.now())}static fromDate(e){return ae.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*Ol);return new ae(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new x(N.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new x(N.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<Vl)throw new x(N.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new x(N.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Ol}_compareTo(e){return this.seconds===e.seconds?G(this.nanoseconds,e.nanoseconds):G(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:ae._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Ps(e,ae._jsonSchema))return new ae(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Vl;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}ae._jsonSchemaVersion="firestore/timestamp/1.0",ae._jsonSchema={type:de("string",ae._jsonSchemaVersion),seconds:de("number"),nanoseconds:de("number")};class q{static fromTimestamp(e){return new q(e)}static min(){return new q(new ae(0,0))}static max(){return new q(new ae(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const _s=-1;function ev(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,s=q.fromTimestamp(r===1e9?new ae(t+1,0):new ae(t,r));return new cn(s,F.empty(),e)}function tv(n){return new cn(n.readTime,n.key,_s)}class cn{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new cn(q.min(),F.empty(),_s)}static max(){return new cn(q.max(),F.empty(),_s)}}function nv(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=F.comparator(n.documentKey,e.documentKey),t!==0?t:G(n.largestBatchId,e.largestBatchId))}const rv="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class sv{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Or(n){if(n.code!==N.FAILED_PRECONDITION||n.message!==rv)throw n;M("LocalStore","Unexpectedly lost primary lease")}class k{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&B(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new k(((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(t,i).next(r,s)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof k?t:k.resolve(t)}catch(t){return k.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):k.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):k.reject(t)}static resolve(e){return new k(((t,r)=>{t(e)}))}static reject(e){return new k(((t,r)=>{r(e)}))}static waitFor(e){return new k(((t,r)=>{let s=0,i=0,a=!1;e.forEach((c=>{++s,c.next((()=>{++i,a&&i===s&&t()}),(l=>r(l)))})),a=!0,i===s&&t()}))}static or(e){let t=k.resolve(!1);for(const r of e)t=t.next((s=>s?k.resolve(s):r()));return t}static forEach(e,t){const r=[];return e.forEach(((s,i)=>{r.push(t.call(this,s,i))})),this.waitFor(r)}static mapArray(e,t){return new k(((r,s)=>{const i=e.length,a=new Array(i);let c=0;for(let l=0;l<i;l++){const h=l;t(e[h]).next((d=>{a[h]=d,++c,c===i&&r(a)}),(d=>s(d)))}}))}static doWhile(e,t){return new k(((r,s)=>{const i=()=>{e()===!0?t().next((()=>{i()}),s):r()};i()}))}}function iv(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Mr(n){return n.name==="IndexedDbTransactionError"}class eo{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>t.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}eo.ce=-1;const hc=-1;function to(n){return n==null}function Ai(n){return n===0&&1/n==-1/0}function ov(n){return typeof n=="number"&&Number.isInteger(n)&&!Ai(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const nd="";function av(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=Ml(e)),e=cv(n.get(t),e);return Ml(e)}function cv(n,e){let t=e;const r=n.length;for(let s=0;s<r;s++){const i=n.charAt(s);switch(i){case"\0":t+="";break;case nd:t+="";break;default:t+=i}}return t}function Ml(n){return n+nd+""}function Ll(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function mn(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function rd(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class ue{constructor(e,t){this.comparator=e,this.root=t||we.EMPTY}insert(e,t){return new ue(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,we.BLACK,null,null))}remove(e){return new ue(this.comparator,this.root.remove(e,this.comparator).copy(null,null,we.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return t+r.left.size;s<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,r)=>(e(t,r),!1)))}toString(){const e=[];return this.inorderTraversal(((t,r)=>(e.push(`${t}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ei(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ei(this.root,e,this.comparator,!1)}getReverseIterator(){return new ei(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ei(this.root,e,this.comparator,!0)}}class ei{constructor(e,t,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?r(e.key,t):1,t&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class we{constructor(e,t,r,s,i){this.key=e,this.value=t,this.color=r??we.RED,this.left=s??we.EMPTY,this.right=i??we.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,s,i){return new we(e??this.key,t??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,t,r),null):i===0?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return we.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),t(e,s.key)===0){if(s.right.isEmpty())return we.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,we.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,we.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw B(43730,{key:this.key,value:this.value});if(this.right.isRed())throw B(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw B(27949);return e+(this.isRed()?0:1)}}we.EMPTY=null,we.RED=!0,we.BLACK=!1;we.EMPTY=new class{constructor(){this.size=0}get key(){throw B(57766)}get value(){throw B(16141)}get color(){throw B(16727)}get left(){throw B(29726)}get right(){throw B(36894)}copy(e,t,r,s,i){return this}insert(e,t,r){return new we(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Ee{constructor(e){this.comparator=e,this.data=new ue(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,r)=>(e(t),!1)))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new xl(this.data.getIterator())}getIteratorFrom(e){return new xl(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((r=>{t=t.add(r)})),t}isEqual(e){if(!(e instanceof Ee)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Ee(this.comparator);return t.data=e,t}}class xl{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Je{constructor(e){this.fields=e,e.sort(be.comparator)}static empty(){return new Je([])}unionWith(e){let t=new Ee(be.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Je(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return vr(this.fields,e.fields,((t,r)=>t.isEqual(r)))}}class sd extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Pe{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new sd("Invalid base64 string: "+i):i}})(e);return new Pe(t)}static fromUint8Array(e){const t=(function(s){let i="";for(let a=0;a<s.length;++a)i+=String.fromCharCode(s[a]);return i})(e);return new Pe(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const r=new Uint8Array(t.length);for(let s=0;s<t.length;s++)r[s]=t.charCodeAt(s);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return G(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Pe.EMPTY_BYTE_STRING=new Pe("");const uv=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function un(n){if(ee(!!n,39018),typeof n=="string"){let e=0;const t=uv.exec(n);if(ee(!!t,46558,{timestamp:n}),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:he(n.seconds),nanos:he(n.nanos)}}function he(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function ln(n){return typeof n=="string"?Pe.fromBase64String(n):Pe.fromUint8Array(n)}const id="server_timestamp",od="__type__",ad="__previous_value__",cd="__local_write_time__";function fc(n){return(n?.mapValue?.fields||{})[od]?.stringValue===id}function no(n){const e=n.mapValue.fields[ad];return fc(e)?no(e):e}function ys(n){const e=un(n.mapValue.fields[cd].timestampValue);return new ae(e.seconds,e.nanos)}class lv{constructor(e,t,r,s,i,a,c,l,h,d){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=a,this.autoDetectLongPolling=c,this.longPollingOptions=l,this.useFetchStreams=h,this.isUsingEmulator=d}}const bi="(default)";class vs{constructor(e,t){this.projectId=e,this.database=t||bi}static empty(){return new vs("","")}get isDefaultDatabase(){return this.database===bi}isEqual(e){return e instanceof vs&&e.projectId===this.projectId&&e.database===this.database}}const ud="__type__",hv="__max__",ti={mapValue:{}},ld="__vector__",Ri="value";function hn(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?fc(n)?4:dv(n)?9007199254740991:fv(n)?10:11:B(28295,{value:n})}function It(n,e){if(n===e)return!0;const t=hn(n);if(t!==hn(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return ys(n).isEqual(ys(e));case 3:return(function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const a=un(s.timestampValue),c=un(i.timestampValue);return a.seconds===c.seconds&&a.nanos===c.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(s,i){return ln(s.bytesValue).isEqual(ln(i.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(s,i){return he(s.geoPointValue.latitude)===he(i.geoPointValue.latitude)&&he(s.geoPointValue.longitude)===he(i.geoPointValue.longitude)})(n,e);case 2:return(function(s,i){if("integerValue"in s&&"integerValue"in i)return he(s.integerValue)===he(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const a=he(s.doubleValue),c=he(i.doubleValue);return a===c?Ai(a)===Ai(c):isNaN(a)&&isNaN(c)}return!1})(n,e);case 9:return vr(n.arrayValue.values||[],e.arrayValue.values||[],It);case 10:case 11:return(function(s,i){const a=s.mapValue.fields||{},c=i.mapValue.fields||{};if(Ll(a)!==Ll(c))return!1;for(const l in a)if(a.hasOwnProperty(l)&&(c[l]===void 0||!It(a[l],c[l])))return!1;return!0})(n,e);default:return B(52216,{left:n})}}function Es(n,e){return(n.values||[]).find((t=>It(t,e)))!==void 0}function Er(n,e){if(n===e)return 0;const t=hn(n),r=hn(e);if(t!==r)return G(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return G(n.booleanValue,e.booleanValue);case 2:return(function(i,a){const c=he(i.integerValue||i.doubleValue),l=he(a.integerValue||a.doubleValue);return c<l?-1:c>l?1:c===l?0:isNaN(c)?isNaN(l)?0:-1:1})(n,e);case 3:return Fl(n.timestampValue,e.timestampValue);case 4:return Fl(ys(n),ys(e));case 5:return wa(n.stringValue,e.stringValue);case 6:return(function(i,a){const c=ln(i),l=ln(a);return c.compareTo(l)})(n.bytesValue,e.bytesValue);case 7:return(function(i,a){const c=i.split("/"),l=a.split("/");for(let h=0;h<c.length&&h<l.length;h++){const d=G(c[h],l[h]);if(d!==0)return d}return G(c.length,l.length)})(n.referenceValue,e.referenceValue);case 8:return(function(i,a){const c=G(he(i.latitude),he(a.latitude));return c!==0?c:G(he(i.longitude),he(a.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return Ul(n.arrayValue,e.arrayValue);case 10:return(function(i,a){const c=i.fields||{},l=a.fields||{},h=c[Ri]?.arrayValue,d=l[Ri]?.arrayValue,g=G(h?.values?.length||0,d?.values?.length||0);return g!==0?g:Ul(h,d)})(n.mapValue,e.mapValue);case 11:return(function(i,a){if(i===ti.mapValue&&a===ti.mapValue)return 0;if(i===ti.mapValue)return 1;if(a===ti.mapValue)return-1;const c=i.fields||{},l=Object.keys(c),h=a.fields||{},d=Object.keys(h);l.sort(),d.sort();for(let g=0;g<l.length&&g<d.length;++g){const m=wa(l[g],d[g]);if(m!==0)return m;const T=Er(c[l[g]],h[d[g]]);if(T!==0)return T}return G(l.length,d.length)})(n.mapValue,e.mapValue);default:throw B(23264,{he:t})}}function Fl(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return G(n,e);const t=un(n),r=un(e),s=G(t.seconds,r.seconds);return s!==0?s:G(t.nanos,r.nanos)}function Ul(n,e){const t=n.values||[],r=e.values||[];for(let s=0;s<t.length&&s<r.length;++s){const i=Er(t[s],r[s]);if(i)return i}return G(t.length,r.length)}function Tr(n){return Aa(n)}function Aa(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const r=un(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return ln(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return F.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",s=!0;for(const i of t.values||[])s?s=!1:r+=",",r+=Aa(i);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){const r=Object.keys(t.fields||{}).sort();let s="{",i=!0;for(const a of r)i?i=!1:s+=",",s+=`${a}:${Aa(t.fields[a])}`;return s+"}"})(n.mapValue):B(61005,{value:n})}function ci(n){switch(hn(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=no(n);return e?16+ci(e):16;case 5:return 2*n.stringValue.length;case 6:return ln(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((s,i)=>s+ci(i)),0)})(n.arrayValue);case 10:case 11:return(function(r){let s=0;return mn(r.fields,((i,a)=>{s+=i.length+ci(a)})),s})(n.mapValue);default:throw B(13486,{value:n})}}function ba(n){return!!n&&"integerValue"in n}function dc(n){return!!n&&"arrayValue"in n}function Bl(n){return!!n&&"nullValue"in n}function jl(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function ui(n){return!!n&&"mapValue"in n}function fv(n){return(n?.mapValue?.fields||{})[ud]?.stringValue===ld}function cs(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return mn(n.mapValue.fields,((t,r)=>e.mapValue.fields[t]=cs(r))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=cs(n.arrayValue.values[t]);return e}return{...n}}function dv(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===hv}class ze{constructor(e){this.value=e}static empty(){return new ze({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!ui(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=cs(t)}setAll(e){let t=be.emptyPath(),r={},s=[];e.forEach(((a,c)=>{if(!t.isImmediateParentOf(c)){const l=this.getFieldsMap(t);this.applyChanges(l,r,s),r={},s=[],t=c.popLast()}a?r[c.lastSegment()]=cs(a):s.push(c.lastSegment())}));const i=this.getFieldsMap(t);this.applyChanges(i,r,s)}delete(e){const t=this.field(e.popLast());ui(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return It(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=t.mapValue.fields[e.get(r)];ui(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,r){mn(t,((s,i)=>e[s]=i));for(const s of r)delete e[s]}clone(){return new ze(cs(this.value))}}function hd(n){const e=[];return mn(n.fields,((t,r)=>{const s=new be([t]);if(ui(r)){const i=hd(r.mapValue).fields;if(i.length===0)e.push(s);else for(const a of i)e.push(s.child(a))}else e.push(s)})),new Je(e)}class Ve{constructor(e,t,r,s,i,a,c){this.key=e,this.documentType=t,this.version=r,this.readTime=s,this.createTime=i,this.data=a,this.documentState=c}static newInvalidDocument(e){return new Ve(e,0,q.min(),q.min(),q.min(),ze.empty(),0)}static newFoundDocument(e,t,r,s){return new Ve(e,1,t,q.min(),r,s,0)}static newNoDocument(e,t){return new Ve(e,2,t,q.min(),q.min(),ze.empty(),0)}static newUnknownDocument(e,t){return new Ve(e,3,t,q.min(),q.min(),ze.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(q.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ze.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ze.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=q.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Ve&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ve(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Si{constructor(e,t){this.position=e,this.inclusive=t}}function ql(n,e,t){let r=0;for(let s=0;s<n.position.length;s++){const i=e[s],a=n.position[s];if(i.field.isKeyField()?r=F.comparator(F.fromName(a.referenceValue),t.key):r=Er(a,t.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function $l(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!It(n.position[t],e.position[t]))return!1;return!0}class Pi{constructor(e,t="asc"){this.field=e,this.dir=t}}function pv(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class fd{}class ye extends fd{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new gv(e,t,r):t==="array-contains"?new vv(e,r):t==="in"?new Ev(e,r):t==="not-in"?new Tv(e,r):t==="array-contains-any"?new Iv(e,r):new ye(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new _v(e,r):new yv(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Er(t,this.value)):t!==null&&hn(this.value)===hn(t)&&this.matchesComparison(Er(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return B(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class wt extends fd{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new wt(e,t)}matches(e){return dd(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function dd(n){return n.op==="and"}function pd(n){return mv(n)&&dd(n)}function mv(n){for(const e of n.filters)if(e instanceof wt)return!1;return!0}function Ra(n){if(n instanceof ye)return n.field.canonicalString()+n.op.toString()+Tr(n.value);if(pd(n))return n.filters.map((e=>Ra(e))).join(",");{const e=n.filters.map((t=>Ra(t))).join(",");return`${n.op}(${e})`}}function md(n,e){return n instanceof ye?(function(r,s){return s instanceof ye&&r.op===s.op&&r.field.isEqual(s.field)&&It(r.value,s.value)})(n,e):n instanceof wt?(function(r,s){return s instanceof wt&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce(((i,a,c)=>i&&md(a,s.filters[c])),!0):!1})(n,e):void B(19439)}function gd(n){return n instanceof ye?(function(t){return`${t.field.canonicalString()} ${t.op} ${Tr(t.value)}`})(n):n instanceof wt?(function(t){return t.op.toString()+" {"+t.getFilters().map(gd).join(" ,")+"}"})(n):"Filter"}class gv extends ye{constructor(e,t,r){super(e,t,r),this.key=F.fromName(r.referenceValue)}matches(e){const t=F.comparator(e.key,this.key);return this.matchesComparison(t)}}class _v extends ye{constructor(e,t){super(e,"in",t),this.keys=_d("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class yv extends ye{constructor(e,t){super(e,"not-in",t),this.keys=_d("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function _d(n,e){return(e.arrayValue?.values||[]).map((t=>F.fromName(t.referenceValue)))}class vv extends ye{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return dc(t)&&Es(t.arrayValue,this.value)}}class Ev extends ye{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Es(this.value.arrayValue,t)}}class Tv extends ye{constructor(e,t){super(e,"not-in",t)}matches(e){if(Es(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Es(this.value.arrayValue,t)}}class Iv extends ye{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!dc(t)||!t.arrayValue.values)&&t.arrayValue.values.some((r=>Es(this.value.arrayValue,r)))}}class wv{constructor(e,t=null,r=[],s=[],i=null,a=null,c=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=a,this.endAt=c,this.Te=null}}function zl(n,e=null,t=[],r=[],s=null,i=null,a=null){return new wv(n,e,t,r,s,i,a)}function pc(n){const e=$(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((r=>Ra(r))).join(","),t+="|ob:",t+=e.orderBy.map((r=>(function(i){return i.field.canonicalString()+i.dir})(r))).join(","),to(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((r=>Tr(r))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((r=>Tr(r))).join(",")),e.Te=t}return e.Te}function mc(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!pv(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!md(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!$l(n.startAt,e.startAt)&&$l(n.endAt,e.endAt)}function Sa(n){return F.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}class ro{constructor(e,t=null,r=[],s=[],i=null,a="F",c=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=a,this.startAt=c,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function Av(n,e,t,r,s,i,a,c){return new ro(n,e,t,r,s,i,a,c)}function gc(n){return new ro(n)}function Hl(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function bv(n){return n.collectionGroup!==null}function us(n){const e=$(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),t.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let c=new Ee(be.comparator);return a.filters.forEach((l=>{l.getFlattenedFilters().forEach((h=>{h.isInequality()&&(c=c.add(h.field))}))})),c})(e).forEach((i=>{t.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new Pi(i,r))})),t.has(be.keyField().canonicalString())||e.Ie.push(new Pi(be.keyField(),r))}return e.Ie}function gt(n){const e=$(n);return e.Ee||(e.Ee=Rv(e,us(n))),e.Ee}function Rv(n,e){if(n.limitType==="F")return zl(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((s=>{const i=s.dir==="desc"?"asc":"desc";return new Pi(s.field,i)}));const t=n.endAt?new Si(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Si(n.startAt.position,n.startAt.inclusive):null;return zl(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function Pa(n,e,t){return new ro(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function so(n,e){return mc(gt(n),gt(e))&&n.limitType===e.limitType}function yd(n){return`${pc(gt(n))}|lt:${n.limitType}`}function Jn(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map((s=>gd(s))).join(", ")}]`),to(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map((s=>(function(a){return`${a.field.canonicalString()} (${a.dir})`})(s))).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map((s=>Tr(s))).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map((s=>Tr(s))).join(",")),`Target(${r})`})(gt(n))}; limitType=${n.limitType})`}function io(n,e){return e.isFoundDocument()&&(function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):F.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)})(n,e)&&(function(r,s){for(const i of us(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0})(n,e)&&(function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0})(n,e)&&(function(r,s){return!(r.startAt&&!(function(a,c,l){const h=ql(a,c,l);return a.inclusive?h<=0:h<0})(r.startAt,us(r),s)||r.endAt&&!(function(a,c,l){const h=ql(a,c,l);return a.inclusive?h>=0:h>0})(r.endAt,us(r),s))})(n,e)}function Sv(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function vd(n){return(e,t)=>{let r=!1;for(const s of us(n)){const i=Pv(s,e,t);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function Pv(n,e,t){const r=n.field.isKeyField()?F.comparator(e.key,t.key):(function(i,a,c){const l=a.data.field(i),h=c.data.field(i);return l!==null&&h!==null?Er(l,h):B(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return B(19790,{direction:n.dir})}}class $n{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[t]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){mn(this.inner,((t,r)=>{for(const[s,i]of r)e(s,i)}))}isEmpty(){return rd(this.inner)}size(){return this.innerSize}}const Cv=new ue(F.comparator);function Mt(){return Cv}const Ed=new ue(F.comparator);function ns(...n){let e=Ed;for(const t of n)e=e.insert(t.key,t);return e}function Td(n){let e=Ed;return n.forEach(((t,r)=>e=e.insert(t,r.overlayedDocument))),e}function An(){return ls()}function Id(){return ls()}function ls(){return new $n((n=>n.toString()),((n,e)=>n.isEqual(e)))}const kv=new ue(F.comparator),Nv=new Ee(F.comparator);function K(...n){let e=Nv;for(const t of n)e=e.add(t);return e}const Dv=new Ee(G);function Vv(){return Dv}function _c(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ai(e)?"-0":e}}function wd(n){return{integerValue:""+n}}function Ov(n,e){return ov(e)?wd(e):_c(n,e)}class oo{constructor(){this._=void 0}}function Mv(n,e,t){return n instanceof Ci?(function(s,i){const a={fields:{[od]:{stringValue:id},[cd]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&fc(i)&&(i=no(i)),i&&(a.fields[ad]=i),{mapValue:a}})(t,e):n instanceof Ts?bd(n,e):n instanceof Is?Rd(n,e):(function(s,i){const a=Ad(s,i),c=Wl(a)+Wl(s.Ae);return ba(a)&&ba(s.Ae)?wd(c):_c(s.serializer,c)})(n,e)}function Lv(n,e,t){return n instanceof Ts?bd(n,e):n instanceof Is?Rd(n,e):t}function Ad(n,e){return n instanceof ki?(function(r){return ba(r)||(function(i){return!!i&&"doubleValue"in i})(r)})(e)?e:{integerValue:0}:null}class Ci extends oo{}class Ts extends oo{constructor(e){super(),this.elements=e}}function bd(n,e){const t=Sd(e);for(const r of n.elements)t.some((s=>It(s,r)))||t.push(r);return{arrayValue:{values:t}}}class Is extends oo{constructor(e){super(),this.elements=e}}function Rd(n,e){let t=Sd(e);for(const r of n.elements)t=t.filter((s=>!It(s,r)));return{arrayValue:{values:t}}}class ki extends oo{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function Wl(n){return he(n.integerValue||n.doubleValue)}function Sd(n){return dc(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function xv(n,e){return n.field.isEqual(e.field)&&(function(r,s){return r instanceof Ts&&s instanceof Ts||r instanceof Is&&s instanceof Is?vr(r.elements,s.elements,It):r instanceof ki&&s instanceof ki?It(r.Ae,s.Ae):r instanceof Ci&&s instanceof Ci})(n.transform,e.transform)}class Fv{constructor(e,t){this.version=e,this.transformResults=t}}class it{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new it}static exists(e){return new it(void 0,e)}static updateTime(e){return new it(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function li(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class ao{}function Pd(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new yc(n.key,it.none()):new Cs(n.key,n.data,it.none());{const t=n.data,r=ze.empty();let s=new Ee(be.comparator);for(let i of e.fields)if(!s.has(i)){let a=t.field(i);a===null&&i.length>1&&(i=i.popLast(),a=t.field(i)),a===null?r.delete(i):r.set(i,a),s=s.add(i)}return new gn(n.key,r,new Je(s.toArray()),it.none())}}function Uv(n,e,t){n instanceof Cs?(function(s,i,a){const c=s.value.clone(),l=Kl(s.fieldTransforms,i,a.transformResults);c.setAll(l),i.convertToFoundDocument(a.version,c).setHasCommittedMutations()})(n,e,t):n instanceof gn?(function(s,i,a){if(!li(s.precondition,i))return void i.convertToUnknownDocument(a.version);const c=Kl(s.fieldTransforms,i,a.transformResults),l=i.data;l.setAll(Cd(s)),l.setAll(c),i.convertToFoundDocument(a.version,l).setHasCommittedMutations()})(n,e,t):(function(s,i,a){i.convertToNoDocument(a.version).setHasCommittedMutations()})(0,e,t)}function hs(n,e,t,r){return n instanceof Cs?(function(i,a,c,l){if(!li(i.precondition,a))return c;const h=i.value.clone(),d=Ql(i.fieldTransforms,l,a);return h.setAll(d),a.convertToFoundDocument(a.version,h).setHasLocalMutations(),null})(n,e,t,r):n instanceof gn?(function(i,a,c,l){if(!li(i.precondition,a))return c;const h=Ql(i.fieldTransforms,l,a),d=a.data;return d.setAll(Cd(i)),d.setAll(h),a.convertToFoundDocument(a.version,d).setHasLocalMutations(),c===null?null:c.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map((g=>g.field)))})(n,e,t,r):(function(i,a,c){return li(i.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):c})(n,e,t)}function Bv(n,e){let t=null;for(const r of n.fieldTransforms){const s=e.data.field(r.field),i=Ad(r.transform,s||null);i!=null&&(t===null&&(t=ze.empty()),t.set(r.field,i))}return t||null}function Gl(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&vr(r,s,((i,a)=>xv(i,a)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Cs extends ao{constructor(e,t,r,s=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class gn extends ao{constructor(e,t,r,s,i=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Cd(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}})),e}function Kl(n,e,t){const r=new Map;ee(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let s=0;s<t.length;s++){const i=n[s],a=i.transform,c=e.data.field(i.field);r.set(i.field,Lv(a,c,t[s]))}return r}function Ql(n,e,t){const r=new Map;for(const s of n){const i=s.transform,a=t.data.field(s.field);r.set(s.field,Mv(i,a,e))}return r}class yc extends ao{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class jv extends ao{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class qv{constructor(e,t,r,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&Uv(i,e,r[s])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=hs(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=hs(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=Id();return this.mutations.forEach((s=>{const i=e.get(s.key),a=i.overlayedDocument;let c=this.applyToLocalView(a,i.mutatedFields);c=t.has(s.key)?null:c;const l=Pd(a,c);l!==null&&r.set(s.key,l),a.isValidDocument()||a.convertToNoDocument(q.min())})),r}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),K())}isEqual(e){return this.batchId===e.batchId&&vr(this.mutations,e.mutations,((t,r)=>Gl(t,r)))&&vr(this.baseMutations,e.baseMutations,((t,r)=>Gl(t,r)))}}class vc{constructor(e,t,r,s){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=s}static from(e,t,r){ee(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let s=(function(){return kv})();const i=e.mutations;for(let a=0;a<i.length;a++)s=s.insert(i[a].key,r[a].version);return new vc(e,t,r,s)}}class $v{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class zv{constructor(e,t){this.count=e,this.unchangedNames=t}}var fe,Q;function Hv(n){switch(n){case N.OK:return B(64938);case N.CANCELLED:case N.UNKNOWN:case N.DEADLINE_EXCEEDED:case N.RESOURCE_EXHAUSTED:case N.INTERNAL:case N.UNAVAILABLE:case N.UNAUTHENTICATED:return!1;case N.INVALID_ARGUMENT:case N.NOT_FOUND:case N.ALREADY_EXISTS:case N.PERMISSION_DENIED:case N.FAILED_PRECONDITION:case N.ABORTED:case N.OUT_OF_RANGE:case N.UNIMPLEMENTED:case N.DATA_LOSS:return!0;default:return B(15467,{code:n})}}function kd(n){if(n===void 0)return Ot("GRPC error has no .code"),N.UNKNOWN;switch(n){case fe.OK:return N.OK;case fe.CANCELLED:return N.CANCELLED;case fe.UNKNOWN:return N.UNKNOWN;case fe.DEADLINE_EXCEEDED:return N.DEADLINE_EXCEEDED;case fe.RESOURCE_EXHAUSTED:return N.RESOURCE_EXHAUSTED;case fe.INTERNAL:return N.INTERNAL;case fe.UNAVAILABLE:return N.UNAVAILABLE;case fe.UNAUTHENTICATED:return N.UNAUTHENTICATED;case fe.INVALID_ARGUMENT:return N.INVALID_ARGUMENT;case fe.NOT_FOUND:return N.NOT_FOUND;case fe.ALREADY_EXISTS:return N.ALREADY_EXISTS;case fe.PERMISSION_DENIED:return N.PERMISSION_DENIED;case fe.FAILED_PRECONDITION:return N.FAILED_PRECONDITION;case fe.ABORTED:return N.ABORTED;case fe.OUT_OF_RANGE:return N.OUT_OF_RANGE;case fe.UNIMPLEMENTED:return N.UNIMPLEMENTED;case fe.DATA_LOSS:return N.DATA_LOSS;default:return B(39323,{code:n})}}(Q=fe||(fe={}))[Q.OK=0]="OK",Q[Q.CANCELLED=1]="CANCELLED",Q[Q.UNKNOWN=2]="UNKNOWN",Q[Q.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Q[Q.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Q[Q.NOT_FOUND=5]="NOT_FOUND",Q[Q.ALREADY_EXISTS=6]="ALREADY_EXISTS",Q[Q.PERMISSION_DENIED=7]="PERMISSION_DENIED",Q[Q.UNAUTHENTICATED=16]="UNAUTHENTICATED",Q[Q.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Q[Q.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Q[Q.ABORTED=10]="ABORTED",Q[Q.OUT_OF_RANGE=11]="OUT_OF_RANGE",Q[Q.UNIMPLEMENTED=12]="UNIMPLEMENTED",Q[Q.INTERNAL=13]="INTERNAL",Q[Q.UNAVAILABLE=14]="UNAVAILABLE",Q[Q.DATA_LOSS=15]="DATA_LOSS";function Wv(){return new TextEncoder}const Gv=new rn([4294967295,4294967295],0);function Xl(n){const e=Wv().encode(n),t=new Wf;return t.update(e),new Uint8Array(t.digest())}function Jl(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new rn([t,r],0),new rn([s,i],0)]}class Ec{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new rs(`Invalid padding: ${t}`);if(r<0)throw new rs(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new rs(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new rs(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=rn.fromNumber(this.ge)}ye(e,t,r){let s=e.add(t.multiply(rn.fromNumber(r)));return s.compare(Gv)===1&&(s=new rn([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=Xl(e),[r,s]=Jl(t);for(let i=0;i<this.hashCount;i++){const a=this.ye(r,s,i);if(!this.we(a))return!1}return!0}static create(e,t,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),a=new Ec(i,s,t);return r.forEach((c=>a.insert(c))),a}insert(e){if(this.ge===0)return;const t=Xl(e),[r,s]=Jl(t);for(let i=0;i<this.hashCount;i++){const a=this.ye(r,s,i);this.Se(a)}}Se(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class rs extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class co{constructor(e,t,r,s,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const s=new Map;return s.set(e,ks.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new co(q.min(),s,new ue(G),Mt(),K())}}class ks{constructor(e,t,r,s,i){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new ks(r,t,K(),K(),K())}}class hi{constructor(e,t,r,s){this.be=e,this.removedTargetIds=t,this.key=r,this.De=s}}class Nd{constructor(e,t){this.targetId=e,this.Ce=t}}class Dd{constructor(e,t,r=Pe.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=s}}class Yl{constructor(){this.ve=0,this.Fe=Zl(),this.Me=Pe.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=K(),t=K(),r=K();return this.Fe.forEach(((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:r=r.add(s);break;default:B(38017,{changeType:i})}})),new ks(this.Me,this.xe,e,t,r)}qe(){this.Oe=!1,this.Fe=Zl()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,ee(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class Kv{constructor(e){this.Ge=e,this.ze=new Map,this.je=Mt(),this.Je=ni(),this.He=ni(),this.Ye=new ue(G)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:B(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((r,s)=>{this.rt(s)&&t(s)}))}st(e){const t=e.targetId,r=e.Ce.count,s=this.ot(t);if(s){const i=s.target;if(Sa(i))if(r===0){const a=new F(i.path);this.et(t,a,Ve.newNoDocument(a,q.min()))}else ee(r===1,20013,{expectedCount:r});else{const a=this._t(t);if(a!==r){const c=this.ut(e),l=c?this.ct(c,e,a):1;if(l!==0){this.it(t);const h=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,h)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=t;let a,c;try{a=ln(r).toUint8Array()}catch(l){if(l instanceof sd)return yr("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{c=new Ec(a,s,i)}catch(l){return yr(l instanceof rs?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return c.ge===0?null:c}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){const r=this.Ge.getRemoteKeysForTarget(t);let s=0;return r.forEach((i=>{const a=this.Ge.ht(),c=`projects/${a.projectId}/databases/${a.database}/documents/${i.path.canonicalString()}`;e.mightContain(c)||(this.et(t,i,null),s++)})),s}Tt(e){const t=new Map;this.ze.forEach(((i,a)=>{const c=this.ot(a);if(c){if(i.current&&Sa(c.target)){const l=new F(c.target.path);this.It(l).has(a)||this.Et(a,l)||this.et(a,l,Ve.newNoDocument(l,e))}i.Be&&(t.set(a,i.ke()),i.qe())}}));let r=K();this.He.forEach(((i,a)=>{let c=!0;a.forEachWhile((l=>{const h=this.ot(l);return!h||h.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)})),c&&(r=r.add(i))})),this.je.forEach(((i,a)=>a.setReadTime(e)));const s=new co(e,t,this.Ye,this.je,r);return this.je=Mt(),this.Je=ni(),this.He=ni(),this.Ye=new ue(G),s}Xe(e,t){if(!this.rt(e))return;const r=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,r),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,t)?s.Qe(t,1):s.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new Yl,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Ee(G),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Ee(G),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||M("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Yl),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function ni(){return new ue(F.comparator)}function Zl(){return new ue(F.comparator)}const Qv={asc:"ASCENDING",desc:"DESCENDING"},Xv={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Jv={and:"AND",or:"OR"};class Yv{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Ca(n,e){return n.useProto3Json||to(e)?e:{value:e}}function Ni(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Vd(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function Zv(n,e){return Ni(n,e.toTimestamp())}function _t(n){return ee(!!n,49232),q.fromTimestamp((function(t){const r=un(t);return new ae(r.seconds,r.nanos)})(n))}function Tc(n,e){return ka(n,e).canonicalString()}function ka(n,e){const t=(function(s){return new oe(["projects",s.projectId,"databases",s.database])})(n).child("documents");return e===void 0?t:t.child(e)}function Od(n){const e=oe.fromString(n);return ee(Ud(e),10190,{key:e.toString()}),e}function Na(n,e){return Tc(n.databaseId,e.path)}function ta(n,e){const t=Od(e);if(t.get(1)!==n.databaseId.projectId)throw new x(N.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new x(N.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new F(Ld(t))}function Md(n,e){return Tc(n.databaseId,e)}function eE(n){const e=Od(n);return e.length===4?oe.emptyPath():Ld(e)}function Da(n){return new oe(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Ld(n){return ee(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function eh(n,e,t){return{name:Na(n,e),fields:t.value.mapValue.fields}}function tE(n,e){let t;if("targetChange"in e){e.targetChange;const r=(function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:B(39313,{state:h})})(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=(function(h,d){return h.useProto3Json?(ee(d===void 0||typeof d=="string",58123),Pe.fromBase64String(d||"")):(ee(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),Pe.fromUint8Array(d||new Uint8Array))})(n,e.targetChange.resumeToken),a=e.targetChange.cause,c=a&&(function(h){const d=h.code===void 0?N.UNKNOWN:kd(h.code);return new x(d,h.message||"")})(a);t=new Dd(r,s,i,c||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=ta(n,r.document.name),i=_t(r.document.updateTime),a=r.document.createTime?_t(r.document.createTime):q.min(),c=new ze({mapValue:{fields:r.document.fields}}),l=Ve.newFoundDocument(s,i,a,c),h=r.targetIds||[],d=r.removedTargetIds||[];t=new hi(h,d,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=ta(n,r.document),i=r.readTime?_t(r.readTime):q.min(),a=Ve.newNoDocument(s,i),c=r.removedTargetIds||[];t=new hi([],c,a.key,a)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=ta(n,r.document),i=r.removedTargetIds||[];t=new hi([],i,s,null)}else{if(!("filter"in e))return B(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,a=new zv(s,i),c=r.targetId;t=new Nd(c,a)}}return t}function nE(n,e){let t;if(e instanceof Cs)t={update:eh(n,e.key,e.value)};else if(e instanceof yc)t={delete:Na(n,e.key)};else if(e instanceof gn)t={update:eh(n,e.key,e.data),updateMask:hE(e.fieldMask)};else{if(!(e instanceof jv))return B(16599,{Vt:e.type});t={verify:Na(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((r=>(function(i,a){const c=a.transform;if(c instanceof Ci)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof Ts)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof Is)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof ki)return{fieldPath:a.field.canonicalString(),increment:c.Ae};throw B(20930,{transform:a.transform})})(0,r)))),e.precondition.isNone||(t.currentDocument=(function(s,i){return i.updateTime!==void 0?{updateTime:Zv(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:B(27497)})(n,e.precondition)),t}function rE(n,e){return n&&n.length>0?(ee(e!==void 0,14353),n.map((t=>(function(s,i){let a=s.updateTime?_t(s.updateTime):_t(i);return a.isEqual(q.min())&&(a=_t(i)),new Fv(a,s.transformResults||[])})(t,e)))):[]}function sE(n,e){return{documents:[Md(n,e.path)]}}function iE(n,e){const t={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=Md(n,s);const i=(function(h){if(h.length!==0)return Fd(wt.create(h,"and"))})(e.filters);i&&(t.structuredQuery.where=i);const a=(function(h){if(h.length!==0)return h.map((d=>(function(m){return{field:Yn(m.field),direction:cE(m.dir)}})(d)))})(e.orderBy);a&&(t.structuredQuery.orderBy=a);const c=Ca(n,e.limit);return c!==null&&(t.structuredQuery.limit=c),e.startAt&&(t.structuredQuery.startAt=(function(h){return{before:h.inclusive,values:h.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(h){return{before:!h.inclusive,values:h.position}})(e.endAt)),{ft:t,parent:s}}function oE(n){let e=eE(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let s=null;if(r>0){ee(r===1,65062);const d=t.from[0];d.allDescendants?s=d.collectionId:e=e.child(d.collectionId)}let i=[];t.where&&(i=(function(g){const m=xd(g);return m instanceof wt&&pd(m)?m.getFilters():[m]})(t.where));let a=[];t.orderBy&&(a=(function(g){return g.map((m=>(function(S){return new Pi(Zn(S.field),(function(P){switch(P){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(S.direction))})(m)))})(t.orderBy));let c=null;t.limit&&(c=(function(g){let m;return m=typeof g=="object"?g.value:g,to(m)?null:m})(t.limit));let l=null;t.startAt&&(l=(function(g){const m=!!g.before,T=g.values||[];return new Si(T,m)})(t.startAt));let h=null;return t.endAt&&(h=(function(g){const m=!g.before,T=g.values||[];return new Si(T,m)})(t.endAt)),Av(e,s,a,i,c,"F",l,h)}function aE(n,e){const t=(function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return B(28987,{purpose:s})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function xd(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=Zn(t.unaryFilter.field);return ye.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Zn(t.unaryFilter.field);return ye.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Zn(t.unaryFilter.field);return ye.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=Zn(t.unaryFilter.field);return ye.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return B(61313);default:return B(60726)}})(n):n.fieldFilter!==void 0?(function(t){return ye.create(Zn(t.fieldFilter.field),(function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return B(58110);default:return B(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return wt.create(t.compositeFilter.filters.map((r=>xd(r))),(function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return B(1026)}})(t.compositeFilter.op))})(n):B(30097,{filter:n})}function cE(n){return Qv[n]}function uE(n){return Xv[n]}function lE(n){return Jv[n]}function Yn(n){return{fieldPath:n.canonicalString()}}function Zn(n){return be.fromServerFormat(n.fieldPath)}function Fd(n){return n instanceof ye?(function(t){if(t.op==="=="){if(jl(t.value))return{unaryFilter:{field:Yn(t.field),op:"IS_NAN"}};if(Bl(t.value))return{unaryFilter:{field:Yn(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(jl(t.value))return{unaryFilter:{field:Yn(t.field),op:"IS_NOT_NAN"}};if(Bl(t.value))return{unaryFilter:{field:Yn(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Yn(t.field),op:uE(t.op),value:t.value}}})(n):n instanceof wt?(function(t){const r=t.getFilters().map((s=>Fd(s)));return r.length===1?r[0]:{compositeFilter:{op:lE(t.op),filters:r}}})(n):B(54877,{filter:n})}function hE(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function Ud(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}class Jt{constructor(e,t,r,s,i=q.min(),a=q.min(),c=Pe.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=c,this.expectedCount=l}withSequenceNumber(e){return new Jt(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Jt(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Jt(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Jt(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class fE{constructor(e){this.yt=e}}function dE(n){const e=oE({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Pa(e,e.limit,"L"):e}class pE{constructor(){this.Cn=new mE}addToCollectionParentIndex(e,t){return this.Cn.add(t),k.resolve()}getCollectionParents(e,t){return k.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return k.resolve()}deleteFieldIndex(e,t){return k.resolve()}deleteAllFieldIndexes(e){return k.resolve()}createTargetIndexes(e,t){return k.resolve()}getDocumentsMatchingTarget(e,t){return k.resolve(null)}getIndexType(e,t){return k.resolve(0)}getFieldIndexes(e,t){return k.resolve([])}getNextCollectionGroupToUpdate(e){return k.resolve(null)}getMinOffset(e,t){return k.resolve(cn.min())}getMinOffsetFromCollectionGroup(e,t){return k.resolve(cn.min())}updateCollectionGroup(e,t,r){return k.resolve()}updateIndexEntries(e,t){return k.resolve()}}class mE{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t]||new Ee(oe.comparator),i=!s.has(r);return this.index[t]=s.add(r),i}has(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t];return s&&s.has(r)}getEntries(e){return(this.index[e]||new Ee(oe.comparator)).toArray()}}const th={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Bd=41943040;class qe{static withCacheSize(e){return new qe(e,qe.DEFAULT_COLLECTION_PERCENTILE,qe.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}qe.DEFAULT_COLLECTION_PERCENTILE=10,qe.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,qe.DEFAULT=new qe(Bd,qe.DEFAULT_COLLECTION_PERCENTILE,qe.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),qe.DISABLED=new qe(-1,0,0);class Ir{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Ir(0)}static cr(){return new Ir(-1)}}const nh="LruGarbageCollector",gE=1048576;function rh([n,e],[t,r]){const s=G(n,t);return s===0?G(e,r):s}class _E{constructor(e){this.Ir=e,this.buffer=new Ee(rh),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();rh(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class yE{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){M(nh,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Mr(t)?M(nh,"Ignoring IndexedDB error during garbage collection: ",t):await Or(t)}await this.Vr(3e5)}))}}class vE{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((r=>Math.floor(t/100*r)))}nthSequenceNumber(e,t){if(t===0)return k.resolve(eo.ce);const r=new _E(t);return this.mr.forEachTarget(e,(s=>r.Ar(s.sequenceNumber))).next((()=>this.mr.pr(e,(s=>r.Ar(s))))).next((()=>r.maxValue))}removeTargets(e,t,r){return this.mr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(M("LruGarbageCollector","Garbage collection skipped; disabled"),k.resolve(th)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(M("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),th):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let r,s,i,a,c,l,h;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((g=>(g>this.params.maximumSequenceNumbersToCollect?(M("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${g}`),s=this.params.maximumSequenceNumbersToCollect):s=g,a=Date.now(),this.nthSequenceNumber(e,s)))).next((g=>(r=g,c=Date.now(),this.removeTargets(e,r,t)))).next((g=>(i=g,l=Date.now(),this.removeOrphanedDocuments(e,r)))).next((g=>(h=Date.now(),Xn()<=W.DEBUG&&M("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-d}ms
	Determined least recently used ${s} in `+(c-a)+`ms
	Removed ${i} targets in `+(l-c)+`ms
	Removed ${g} documents in `+(h-l)+`ms
Total Duration: ${h-d}ms`),k.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:g}))))}}function EE(n,e){return new vE(n,e)}class TE{constructor(){this.changes=new $n((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Ve.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?k.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class IE{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class wE{constructor(e,t,r,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next((s=>(r=s,this.remoteDocumentCache.getEntry(e,t)))).next((s=>(r!==null&&hs(r.mutation,s,Je.empty(),ae.now()),s)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.getLocalViewOfDocuments(e,r,K()).next((()=>r))))}getLocalViewOfDocuments(e,t,r=K()){const s=An();return this.populateOverlays(e,s,t).next((()=>this.computeViews(e,t,s,r).next((i=>{let a=ns();return i.forEach(((c,l)=>{a=a.insert(c,l.overlayedDocument)})),a}))))}getOverlayedDocuments(e,t){const r=An();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,K())))}populateOverlays(e,t,r){const s=[];return r.forEach((i=>{t.has(i)||s.push(i)})),this.documentOverlayCache.getOverlays(e,s).next((i=>{i.forEach(((a,c)=>{t.set(a,c)}))}))}computeViews(e,t,r,s){let i=Mt();const a=ls(),c=(function(){return ls()})();return t.forEach(((l,h)=>{const d=r.get(h.key);s.has(h.key)&&(d===void 0||d.mutation instanceof gn)?i=i.insert(h.key,h):d!==void 0?(a.set(h.key,d.mutation.getFieldMask()),hs(d.mutation,h,d.mutation.getFieldMask(),ae.now())):a.set(h.key,Je.empty())})),this.recalculateAndSaveOverlays(e,i).next((l=>(l.forEach(((h,d)=>a.set(h,d))),t.forEach(((h,d)=>c.set(h,new IE(d,a.get(h)??null)))),c)))}recalculateAndSaveOverlays(e,t){const r=ls();let s=new ue(((a,c)=>a-c)),i=K();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((a=>{for(const c of a)c.keys().forEach((l=>{const h=t.get(l);if(h===null)return;let d=r.get(l)||Je.empty();d=c.applyToLocalView(h,d),r.set(l,d);const g=(s.get(c.batchId)||K()).add(l);s=s.insert(c.batchId,g)}))})).next((()=>{const a=[],c=s.getReverseIterator();for(;c.hasNext();){const l=c.getNext(),h=l.key,d=l.value,g=Id();d.forEach((m=>{if(!i.has(m)){const T=Pd(t.get(m),r.get(m));T!==null&&g.set(m,T),i=i.add(m)}})),a.push(this.documentOverlayCache.saveOverlays(e,h,g))}return k.waitFor(a)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,t,r,s){return(function(a){return F.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):bv(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,s):this.getDocumentsMatchingCollectionQuery(e,t,r,s)}getNextDocuments(e,t,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,s).next((i=>{const a=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,s-i.size):k.resolve(An());let c=_s,l=i;return a.next((h=>k.forEach(h,((d,g)=>(c<g.largestBatchId&&(c=g.largestBatchId),i.get(d)?k.resolve():this.remoteDocumentCache.getEntry(e,d).next((m=>{l=l.insert(d,m)}))))).next((()=>this.populateOverlays(e,h,i))).next((()=>this.computeViews(e,l,h,K()))).next((d=>({batchId:c,changes:Td(d)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new F(t)).next((r=>{let s=ns();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s}))}getDocumentsMatchingCollectionGroupQuery(e,t,r,s){const i=t.collectionGroup;let a=ns();return this.indexManager.getCollectionParents(e,i).next((c=>k.forEach(c,(l=>{const h=(function(g,m){return new ro(m,null,g.explicitOrderBy.slice(),g.filters.slice(),g.limit,g.limitType,g.startAt,g.endAt)})(t,l.child(i));return this.getDocumentsMatchingCollectionQuery(e,h,r,s).next((d=>{d.forEach(((g,m)=>{a=a.insert(g,m)}))}))})).next((()=>a))))}getDocumentsMatchingCollectionQuery(e,t,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next((a=>(i=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,i,s)))).next((a=>{i.forEach(((l,h)=>{const d=h.getKey();a.get(d)===null&&(a=a.insert(d,Ve.newInvalidDocument(d)))}));let c=ns();return a.forEach(((l,h)=>{const d=i.get(l);d!==void 0&&hs(d.mutation,h,Je.empty(),ae.now()),io(t,h)&&(c=c.insert(l,h))})),c}))}}class AE{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return k.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(s){return{id:s.id,version:s.version,createTime:_t(s.createTime)}})(t)),k.resolve()}getNamedQuery(e,t){return k.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(s){return{name:s.name,query:dE(s.bundledQuery),readTime:_t(s.readTime)}})(t)),k.resolve()}}class bE{constructor(){this.overlays=new ue(F.comparator),this.qr=new Map}getOverlay(e,t){return k.resolve(this.overlays.get(t))}getOverlays(e,t){const r=An();return k.forEach(t,(s=>this.getOverlay(e,s).next((i=>{i!==null&&r.set(s,i)})))).next((()=>r))}saveOverlays(e,t,r){return r.forEach(((s,i)=>{this.St(e,t,i)})),k.resolve()}removeOverlaysForBatchId(e,t,r){const s=this.qr.get(r);return s!==void 0&&(s.forEach((i=>this.overlays=this.overlays.remove(i))),this.qr.delete(r)),k.resolve()}getOverlaysForCollection(e,t,r){const s=An(),i=t.length+1,a=new F(t.child("")),c=this.overlays.getIteratorFrom(a);for(;c.hasNext();){const l=c.getNext().value,h=l.getKey();if(!t.isPrefixOf(h.path))break;h.path.length===i&&l.largestBatchId>r&&s.set(l.getKey(),l)}return k.resolve(s)}getOverlaysForCollectionGroup(e,t,r,s){let i=new ue(((h,d)=>h-d));const a=this.overlays.getIterator();for(;a.hasNext();){const h=a.getNext().value;if(h.getKey().getCollectionGroup()===t&&h.largestBatchId>r){let d=i.get(h.largestBatchId);d===null&&(d=An(),i=i.insert(h.largestBatchId,d)),d.set(h.getKey(),h)}}const c=An(),l=i.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach(((h,d)=>c.set(h,d))),!(c.size()>=s)););return k.resolve(c)}St(e,t,r){const s=this.overlays.get(r.key);if(s!==null){const a=this.qr.get(s.largestBatchId).delete(r.key);this.qr.set(s.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new $v(t,r));let i=this.qr.get(t);i===void 0&&(i=K(),this.qr.set(t,i)),this.qr.set(t,i.add(r.key))}}class RE{constructor(){this.sessionToken=Pe.EMPTY_BYTE_STRING}getSessionToken(e){return k.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,k.resolve()}}class Ic{constructor(){this.Qr=new Ee(Ie.$r),this.Ur=new Ee(Ie.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const r=new Ie(e,t);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,t){e.forEach((r=>this.addReference(r,t)))}removeReference(e,t){this.Gr(new Ie(e,t))}zr(e,t){e.forEach((r=>this.removeReference(r,t)))}jr(e){const t=new F(new oe([])),r=new Ie(t,e),s=new Ie(t,e+1),i=[];return this.Ur.forEachInRange([r,s],(a=>{this.Gr(a),i.push(a.key)})),i}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new F(new oe([])),r=new Ie(t,e),s=new Ie(t,e+1);let i=K();return this.Ur.forEachInRange([r,s],(a=>{i=i.add(a.key)})),i}containsKey(e){const t=new Ie(e,0),r=this.Qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class Ie{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return F.comparator(e.key,t.key)||G(e.Yr,t.Yr)}static Kr(e,t){return G(e.Yr,t.Yr)||F.comparator(e.key,t.key)}}class SE{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Ee(Ie.$r)}checkEmpty(e){return k.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,s){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new qv(i,t,r,s);this.mutationQueue.push(a);for(const c of s)this.Zr=this.Zr.add(new Ie(c.key,i)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return k.resolve(a)}lookupMutationBatch(e,t){return k.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,s=this.ei(r),i=s<0?0:s;return k.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return k.resolve(this.mutationQueue.length===0?hc:this.tr-1)}getAllMutationBatches(e){return k.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new Ie(t,0),s=new Ie(t,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([r,s],(a=>{const c=this.Xr(a.Yr);i.push(c)})),k.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Ee(G);return t.forEach((s=>{const i=new Ie(s,0),a=new Ie(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,a],(c=>{r=r.add(c.Yr)}))})),k.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,s=r.length+1;let i=r;F.isDocumentKey(i)||(i=i.child(""));const a=new Ie(new F(i),0);let c=new Ee(G);return this.Zr.forEachWhile((l=>{const h=l.key.path;return!!r.isPrefixOf(h)&&(h.length===s&&(c=c.add(l.Yr)),!0)}),a),k.resolve(this.ti(c))}ti(e){const t=[];return e.forEach((r=>{const s=this.Xr(r);s!==null&&t.push(s)})),t}removeMutationBatch(e,t){ee(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return k.forEach(t.mutations,(s=>{const i=new Ie(s.key,t.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)})).next((()=>{this.Zr=r}))}ir(e){}containsKey(e,t){const r=new Ie(t,0),s=this.Zr.firstAfterOrEqual(r);return k.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,k.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class PE{constructor(e){this.ri=e,this.docs=(function(){return new ue(F.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,s=this.docs.get(r),i=s?s.size:0,a=this.ri(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return k.resolve(r?r.document.mutableCopy():Ve.newInvalidDocument(t))}getEntries(e,t){let r=Mt();return t.forEach((s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():Ve.newInvalidDocument(s))})),k.resolve(r)}getDocumentsMatchingQuery(e,t,r,s){let i=Mt();const a=t.path,c=new F(a.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(c);for(;l.hasNext();){const{key:h,value:{document:d}}=l.getNext();if(!a.isPrefixOf(h.path))break;h.path.length>a.length+1||nv(tv(d),r)<=0||(s.has(d.key)||io(t,d))&&(i=i.insert(d.key,d.mutableCopy()))}return k.resolve(i)}getAllFromCollectionGroup(e,t,r,s){B(9500)}ii(e,t){return k.forEach(this.docs,(r=>t(r)))}newChangeBuffer(e){return new CE(this)}getSize(e){return k.resolve(this.size)}}class CE extends TE{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((r,s)=>{s.isValidDocument()?t.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(r)})),k.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class kE{constructor(e){this.persistence=e,this.si=new $n((t=>pc(t)),mc),this.lastRemoteSnapshotVersion=q.min(),this.highestTargetId=0,this.oi=0,this._i=new Ic,this.targetCount=0,this.ai=Ir.ur()}forEachTarget(e,t){return this.si.forEach(((r,s)=>t(s))),k.resolve()}getLastRemoteSnapshotVersion(e){return k.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return k.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),k.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.oi&&(this.oi=t),k.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Ir(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,k.resolve()}updateTargetData(e,t){return this.Pr(t),k.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,k.resolve()}removeTargets(e,t,r){let s=0;const i=[];return this.si.forEach(((a,c)=>{c.sequenceNumber<=t&&r.get(c.targetId)===null&&(this.si.delete(a),i.push(this.removeMatchingKeysForTargetId(e,c.targetId)),s++)})),k.waitFor(i).next((()=>s))}getTargetCount(e){return k.resolve(this.targetCount)}getTargetData(e,t){const r=this.si.get(t)||null;return k.resolve(r)}addMatchingKeys(e,t,r){return this._i.Wr(t,r),k.resolve()}removeMatchingKeys(e,t,r){this._i.zr(t,r);const s=this.persistence.referenceDelegate,i=[];return s&&t.forEach((a=>{i.push(s.markPotentiallyOrphaned(e,a))})),k.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),k.resolve()}getMatchingKeysForTargetId(e,t){const r=this._i.Hr(t);return k.resolve(r)}containsKey(e,t){return k.resolve(this._i.containsKey(t))}}class jd{constructor(e,t){this.ui={},this.overlays={},this.ci=new eo(0),this.li=!1,this.li=!0,this.hi=new RE,this.referenceDelegate=e(this),this.Pi=new kE(this),this.indexManager=new pE,this.remoteDocumentCache=(function(s){return new PE(s)})((r=>this.referenceDelegate.Ti(r))),this.serializer=new fE(t),this.Ii=new AE(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new bE,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ui[e.toKey()];return r||(r=new SE(t,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,r){M("MemoryPersistence","Starting transaction:",e);const s=new NE(this.ci.next());return this.referenceDelegate.Ei(),r(s).next((i=>this.referenceDelegate.di(s).next((()=>i)))).toPromise().then((i=>(s.raiseOnCommittedEvent(),i)))}Ai(e,t){return k.or(Object.values(this.ui).map((r=>()=>r.containsKey(e,t))))}}class NE extends sv{constructor(e){super(),this.currentSequenceNumber=e}}class wc{constructor(e){this.persistence=e,this.Ri=new Ic,this.Vi=null}static mi(e){return new wc(e)}get fi(){if(this.Vi)return this.Vi;throw B(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.fi.delete(r.toString()),k.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.fi.add(r.toString()),k.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),k.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((s=>this.fi.add(s.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((s=>{s.forEach((i=>this.fi.add(i.toString())))})).next((()=>r.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return k.forEach(this.fi,(r=>{const s=F.fromPath(r);return this.gi(e,s).next((i=>{i||t.removeEntry(s,q.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((r=>{r?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return k.or([()=>k.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class Di{constructor(e,t){this.persistence=e,this.pi=new $n((r=>av(r.path)),((r,s)=>r.isEqual(s))),this.garbageCollector=EE(this,t)}static mi(e,t){return new Di(e,t)}Ei(){}di(e){return k.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>t.next((s=>r+s))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}pr(e,t){return k.forEach(this.pi,((r,s)=>this.br(e,r,s).next((i=>i?k.resolve():t(s)))))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.ii(e,(a=>this.br(e,a,t).next((c=>{c||(r++,i.removeEntry(a,q.min()))})))).next((()=>i.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),k.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),k.resolve()}removeReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),k.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),k.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=ci(e.data.value)),t}br(e,t,r){return k.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const s=this.pi.get(t);return k.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class Ac{constructor(e,t,r,s){this.targetId=e,this.fromCache=t,this.Es=r,this.ds=s}static As(e,t){let r=K(),s=K();for(const i of t.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new Ac(e,t.fromCache,r,s)}}class DE{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class VE{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return w_()?8:iv(Me())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,s){const i={result:null};return this.ys(e,t).next((a=>{i.result=a})).next((()=>{if(!i.result)return this.ws(e,t,s,r).next((a=>{i.result=a}))})).next((()=>{if(i.result)return;const a=new DE;return this.Ss(e,t,a).next((c=>{if(i.result=c,this.Vs)return this.bs(e,t,a,c.size)}))})).next((()=>i.result))}bs(e,t,r,s){return r.documentReadCount<this.fs?(Xn()<=W.DEBUG&&M("QueryEngine","SDK will not create cache indexes for query:",Jn(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),k.resolve()):(Xn()<=W.DEBUG&&M("QueryEngine","Query:",Jn(t),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.gs*s?(Xn()<=W.DEBUG&&M("QueryEngine","The SDK decides to create cache indexes for query:",Jn(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,gt(t))):k.resolve())}ys(e,t){if(Hl(t))return k.resolve(null);let r=gt(t);return this.indexManager.getIndexType(e,r).next((s=>s===0?null:(t.limit!==null&&s===1&&(t=Pa(t,null,"F"),r=gt(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next((i=>{const a=K(...i);return this.ps.getDocuments(e,a).next((c=>this.indexManager.getMinOffset(e,r).next((l=>{const h=this.Ds(t,c);return this.Cs(t,h,a,l.readTime)?this.ys(e,Pa(t,null,"F")):this.vs(e,h,t,l)}))))})))))}ws(e,t,r,s){return Hl(t)||s.isEqual(q.min())?k.resolve(null):this.ps.getDocuments(e,r).next((i=>{const a=this.Ds(t,i);return this.Cs(t,a,r,s)?k.resolve(null):(Xn()<=W.DEBUG&&M("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Jn(t)),this.vs(e,a,t,ev(s,_s)).next((c=>c)))}))}Ds(e,t){let r=new Ee(vd(e));return t.forEach(((s,i)=>{io(e,i)&&(r=r.add(i))})),r}Cs(e,t,r,s){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const i=e.limitType==="F"?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Ss(e,t,r){return Xn()<=W.DEBUG&&M("QueryEngine","Using full collection scan to execute query:",Jn(t)),this.ps.getDocumentsMatchingQuery(e,t,cn.min(),r)}vs(e,t,r,s){return this.ps.getDocumentsMatchingQuery(e,r,s).next((i=>(t.forEach((a=>{i=i.insert(a.key,a)})),i)))}}const bc="LocalStore",OE=3e8;class ME{constructor(e,t,r,s){this.persistence=e,this.Fs=t,this.serializer=s,this.Ms=new ue(G),this.xs=new $n((i=>pc(i)),mc),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new wE(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function LE(n,e,t,r){return new ME(n,e,t,r)}async function qd(n,e){const t=$(n);return await t.persistence.runTransaction("Handle user change","readonly",(r=>{let s;return t.mutationQueue.getAllMutationBatches(r).next((i=>(s=i,t.Bs(e),t.mutationQueue.getAllMutationBatches(r)))).next((i=>{const a=[],c=[];let l=K();for(const h of s){a.push(h.batchId);for(const d of h.mutations)l=l.add(d.key)}for(const h of i){c.push(h.batchId);for(const d of h.mutations)l=l.add(d.key)}return t.localDocuments.getDocuments(r,l).next((h=>({Ls:h,removedBatchIds:a,addedBatchIds:c})))}))}))}function xE(n,e){const t=$(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const s=e.batch.keys(),i=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(c,l,h,d){const g=h.batch,m=g.keys();let T=k.resolve();return m.forEach((S=>{T=T.next((()=>d.getEntry(l,S))).next((C=>{const P=h.docVersions.get(S);ee(P!==null,48541),C.version.compareTo(P)<0&&(g.applyToRemoteDocument(C,h),C.isValidDocument()&&(C.setReadTime(h.commitVersion),d.addEntry(C)))}))})),T.next((()=>c.mutationQueue.removeMutationBatch(l,g)))})(t,r,e,i).next((()=>i.apply(r))).next((()=>t.mutationQueue.performConsistencyCheck(r))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(c){let l=K();for(let h=0;h<c.mutationResults.length;++h)c.mutationResults[h].transformResults.length>0&&(l=l.add(c.batch.mutations[h].key));return l})(e)))).next((()=>t.localDocuments.getDocuments(r,s)))}))}function $d(n){const e=$(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function FE(n,e){const t=$(n),r=e.snapshotVersion;let s=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(i=>{const a=t.Ns.newChangeBuffer({trackRemovals:!0});s=t.Ms;const c=[];e.targetChanges.forEach(((d,g)=>{const m=s.get(g);if(!m)return;c.push(t.Pi.removeMatchingKeys(i,d.removedDocuments,g).next((()=>t.Pi.addMatchingKeys(i,d.addedDocuments,g))));let T=m.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(g)!==null?T=T.withResumeToken(Pe.EMPTY_BYTE_STRING,q.min()).withLastLimboFreeSnapshotVersion(q.min()):d.resumeToken.approximateByteSize()>0&&(T=T.withResumeToken(d.resumeToken,r)),s=s.insert(g,T),(function(C,P,L){return C.resumeToken.approximateByteSize()===0||P.snapshotVersion.toMicroseconds()-C.snapshotVersion.toMicroseconds()>=OE?!0:L.addedDocuments.size+L.modifiedDocuments.size+L.removedDocuments.size>0})(m,T,d)&&c.push(t.Pi.updateTargetData(i,T))}));let l=Mt(),h=K();if(e.documentUpdates.forEach((d=>{e.resolvedLimboDocuments.has(d)&&c.push(t.persistence.referenceDelegate.updateLimboDocument(i,d))})),c.push(UE(i,a,e.documentUpdates).next((d=>{l=d.ks,h=d.qs}))),!r.isEqual(q.min())){const d=t.Pi.getLastRemoteSnapshotVersion(i).next((g=>t.Pi.setTargetsMetadata(i,i.currentSequenceNumber,r)));c.push(d)}return k.waitFor(c).next((()=>a.apply(i))).next((()=>t.localDocuments.getLocalViewOfDocuments(i,l,h))).next((()=>l))})).then((i=>(t.Ms=s,i)))}function UE(n,e,t){let r=K(),s=K();return t.forEach((i=>r=r.add(i))),e.getEntries(n,r).next((i=>{let a=Mt();return t.forEach(((c,l)=>{const h=i.get(c);l.isFoundDocument()!==h.isFoundDocument()&&(s=s.add(c)),l.isNoDocument()&&l.version.isEqual(q.min())?(e.removeEntry(c,l.readTime),a=a.insert(c,l)):!h.isValidDocument()||l.version.compareTo(h.version)>0||l.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(l),a=a.insert(c,l)):M(bc,"Ignoring outdated watch update for ",c,". Current version:",h.version," Watch version:",l.version)})),{ks:a,qs:s}}))}function BE(n,e){const t=$(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=hc),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function jE(n,e){const t=$(n);return t.persistence.runTransaction("Allocate target","readwrite",(r=>{let s;return t.Pi.getTargetData(r,e).next((i=>i?(s=i,k.resolve(s)):t.Pi.allocateTargetId(r).next((a=>(s=new Jt(e,a,"TargetPurposeListen",r.currentSequenceNumber),t.Pi.addTargetData(r,s).next((()=>s)))))))})).then((r=>{const s=t.Ms.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(r.targetId,r),t.xs.set(e,r.targetId)),r}))}async function Va(n,e,t){const r=$(n),s=r.Ms.get(e),i=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",i,(a=>r.persistence.referenceDelegate.removeTarget(a,s)))}catch(a){if(!Mr(a))throw a;M(bc,`Failed to update sequence numbers for target ${e}: ${a}`)}r.Ms=r.Ms.remove(e),r.xs.delete(s.target)}function sh(n,e,t){const r=$(n);let s=q.min(),i=K();return r.persistence.runTransaction("Execute query","readwrite",(a=>(function(l,h,d){const g=$(l),m=g.xs.get(d);return m!==void 0?k.resolve(g.Ms.get(m)):g.Pi.getTargetData(h,d)})(r,a,gt(e)).next((c=>{if(c)return s=c.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(a,c.targetId).next((l=>{i=l}))})).next((()=>r.Fs.getDocumentsMatchingQuery(a,e,t?s:q.min(),t?i:K()))).next((c=>(qE(r,Sv(e),c),{documents:c,Qs:i})))))}function qE(n,e,t){let r=n.Os.get(e)||q.min();t.forEach(((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)})),n.Os.set(e,r)}class ih{constructor(){this.activeTargetIds=Vv()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class $E{constructor(){this.Mo=new ih,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,r){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new ih,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class zE{Oo(e){}shutdown(){}}const oh="ConnectivityMonitor";class ah{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){M(oh,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){M(oh,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let ri=null;function Oa(){return ri===null?ri=(function(){return 268435456+Math.round(2147483648*Math.random())})():ri++,"0x"+ri.toString(16)}const na="RestConnection",HE={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class WE{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${r}/databases/${s}`,this.Wo=this.databaseId.database===bi?`project_id=${r}`:`project_id=${r}&database_id=${s}`}Go(e,t,r,s,i){const a=Oa(),c=this.zo(e,t.toUriEncodedString());M(na,`Sending RPC '${e}' ${a}:`,c,r);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,s,i);const{host:h}=new URL(c),d=pn(h);return this.Jo(e,c,l,r,d).then((g=>(M(na,`Received RPC '${e}' ${a}: `,g),g)),(g=>{throw yr(na,`RPC '${e}' ${a} failed with error: `,g,"url: ",c,"request:",r),g}))}Ho(e,t,r,s,i,a){return this.Go(e,t,r,s,i)}jo(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Vr})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((s,i)=>e[i]=s)),r&&r.headers.forEach(((s,i)=>e[i]=s))}zo(e,t){const r=HE[e];return`${this.Uo}/v1/${t}:${r}`}terminate(){}}class GE{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const ke="WebChannelConnection";class KE extends WE{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,s,i){const a=Oa();return new Promise(((c,l)=>{const h=new Gf;h.setWithCredentials(!0),h.listenOnce(Kf.COMPLETE,(()=>{try{switch(h.getLastErrorCode()){case ai.NO_ERROR:const g=h.getResponseJson();M(ke,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(g)),c(g);break;case ai.TIMEOUT:M(ke,`RPC '${e}' ${a} timed out`),l(new x(N.DEADLINE_EXCEEDED,"Request time out"));break;case ai.HTTP_ERROR:const m=h.getStatus();if(M(ke,`RPC '${e}' ${a} failed with status:`,m,"response text:",h.getResponseText()),m>0){let T=h.getResponseJson();Array.isArray(T)&&(T=T[0]);const S=T?.error;if(S&&S.status&&S.message){const C=(function(L){const O=L.toLowerCase().replace(/_/g,"-");return Object.values(N).indexOf(O)>=0?O:N.UNKNOWN})(S.status);l(new x(C,S.message))}else l(new x(N.UNKNOWN,"Server responded with status "+h.getStatus()))}else l(new x(N.UNAVAILABLE,"Connection failed."));break;default:B(9055,{l_:e,streamId:a,h_:h.getLastErrorCode(),P_:h.getLastError()})}}finally{M(ke,`RPC '${e}' ${a} completed.`)}}));const d=JSON.stringify(s);M(ke,`RPC '${e}' ${a} sending request:`,s),h.send(t,"POST",d,r,15)}))}T_(e,t,r){const s=Oa(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=Jf(),c=Xf(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(l.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,t,r),l.encodeInitMessageHeaders=!0;const d=i.join("");M(ke,`Creating RPC '${e}' stream ${s}: ${d}`,l);const g=a.createWebChannel(d,l);this.I_(g);let m=!1,T=!1;const S=new GE({Yo:P=>{T?M(ke,`Not sending because RPC '${e}' stream ${s} is closed:`,P):(m||(M(ke,`Opening RPC '${e}' stream ${s} transport.`),g.open(),m=!0),M(ke,`RPC '${e}' stream ${s} sending:`,P),g.send(P))},Zo:()=>g.close()}),C=(P,L,O)=>{P.listen(L,(V=>{try{O(V)}catch(H){setTimeout((()=>{throw H}),0)}}))};return C(g,ts.EventType.OPEN,(()=>{T||(M(ke,`RPC '${e}' stream ${s} transport opened.`),S.o_())})),C(g,ts.EventType.CLOSE,(()=>{T||(T=!0,M(ke,`RPC '${e}' stream ${s} transport closed`),S.a_(),this.E_(g))})),C(g,ts.EventType.ERROR,(P=>{T||(T=!0,yr(ke,`RPC '${e}' stream ${s} transport errored. Name:`,P.name,"Message:",P.message),S.a_(new x(N.UNAVAILABLE,"The operation could not be completed")))})),C(g,ts.EventType.MESSAGE,(P=>{if(!T){const L=P.data[0];ee(!!L,16349);const O=L,V=O?.error||O[0]?.error;if(V){M(ke,`RPC '${e}' stream ${s} received error:`,V);const H=V.status;let Y=(function(_){const v=fe[_];if(v!==void 0)return kd(v)})(H),te=V.message;Y===void 0&&(Y=N.INTERNAL,te="Unknown error status: "+H+" with message "+V.message),T=!0,S.a_(new x(Y,te)),g.close()}else M(ke,`RPC '${e}' stream ${s} received:`,L),S.u_(L)}})),C(c,Qf.STAT_EVENT,(P=>{P.stat===Ia.PROXY?M(ke,`RPC '${e}' stream ${s} detected buffering proxy`):P.stat===Ia.NOPROXY&&M(ke,`RPC '${e}' stream ${s} detected no buffering proxy`)})),setTimeout((()=>{S.__()}),0),S}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function ra(){return typeof document<"u"?document:null}function uo(n){return new Yv(n,!0)}class zd{constructor(e,t,r=1e3,s=1.5,i=6e4){this.Mi=e,this.timerId=t,this.d_=r,this.A_=s,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),s=Math.max(0,t-r);s>0&&M("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const ch="PersistentStream";class Hd{constructor(e,t,r,s,i,a,c,l){this.Mi=e,this.S_=r,this.b_=s,this.connection=i,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=c,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new zd(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===N.RESOURCE_EXHAUSTED?(Ot(t.toString()),Ot("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===N.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,s])=>{this.D_===t&&this.G_(r,s)}),(r=>{e((()=>{const s=new x(N.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(s)}))}))}G_(e,t){const r=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{r((()=>this.listener.Xo()))})),this.stream.t_((()=>{r((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((s=>{r((()=>this.z_(s)))})),this.stream.onMessage((s=>{r((()=>++this.F_==1?this.J_(s):this.onNext(s)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return M(ch,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(M(ch,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class QE extends Hd{constructor(e,t,r,s,i,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,s,a),this.serializer=i}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=tE(this.serializer,e),r=(function(i){if(!("targetChange"in i))return q.min();const a=i.targetChange;return a.targetIds&&a.targetIds.length?q.min():a.readTime?_t(a.readTime):q.min()})(e);return this.listener.H_(t,r)}Y_(e){const t={};t.database=Da(this.serializer),t.addTarget=(function(i,a){let c;const l=a.target;if(c=Sa(l)?{documents:sE(i,l)}:{query:iE(i,l).ft},c.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){c.resumeToken=Vd(i,a.resumeToken);const h=Ca(i,a.expectedCount);h!==null&&(c.expectedCount=h)}else if(a.snapshotVersion.compareTo(q.min())>0){c.readTime=Ni(i,a.snapshotVersion.toTimestamp());const h=Ca(i,a.expectedCount);h!==null&&(c.expectedCount=h)}return c})(this.serializer,e);const r=aE(this.serializer,e);r&&(t.labels=r),this.q_(t)}Z_(e){const t={};t.database=Da(this.serializer),t.removeTarget=e,this.q_(t)}}class XE extends Hd{constructor(e,t,r,s,i,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,s,a),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return ee(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,ee(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){ee(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=rE(e.writeResults,e.commitTime),r=_t(e.commitTime);return this.listener.na(r,t)}ra(){const e={};e.database=Da(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((r=>nE(this.serializer,r)))};this.q_(t)}}class JE{}class YE extends JE{constructor(e,t,r,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new x(N.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,a])=>this.connection.Go(e,ka(t,r),s,i,a))).catch((i=>{throw i.name==="FirebaseError"?(i.code===N.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new x(N.UNKNOWN,i.toString())}))}Ho(e,t,r,s,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,c])=>this.connection.Ho(e,ka(t,r),s,a,c,i))).catch((a=>{throw a.name==="FirebaseError"?(a.code===N.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new x(N.UNKNOWN,a.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class ZE{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Ot(t),this.aa=!1):M("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const xn="RemoteStore";class eT{constructor(e,t,r,s,i){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo((a=>{r.enqueueAndForget((async()=>{zn(this)&&(M(xn,"Restarting streams for network reachability change."),await(async function(l){const h=$(l);h.Ea.add(4),await Ns(h),h.Ra.set("Unknown"),h.Ea.delete(4),await lo(h)})(this))}))})),this.Ra=new ZE(r,s)}}async function lo(n){if(zn(n))for(const e of n.da)await e(!0)}async function Ns(n){for(const e of n.da)await e(!1)}function Wd(n,e){const t=$(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),Cc(t)?Pc(t):Lr(t).O_()&&Sc(t,e))}function Rc(n,e){const t=$(n),r=Lr(t);t.Ia.delete(e),r.O_()&&Gd(t,e),t.Ia.size===0&&(r.O_()?r.L_():zn(t)&&t.Ra.set("Unknown"))}function Sc(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(q.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Lr(n).Y_(e)}function Gd(n,e){n.Va.Ue(e),Lr(n).Z_(e)}function Pc(n){n.Va=new Kv({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),Lr(n).start(),n.Ra.ua()}function Cc(n){return zn(n)&&!Lr(n).x_()&&n.Ia.size>0}function zn(n){return $(n).Ea.size===0}function Kd(n){n.Va=void 0}async function tT(n){n.Ra.set("Online")}async function nT(n){n.Ia.forEach(((e,t)=>{Sc(n,e)}))}async function rT(n,e){Kd(n),Cc(n)?(n.Ra.ha(e),Pc(n)):n.Ra.set("Unknown")}async function sT(n,e,t){if(n.Ra.set("Online"),e instanceof Dd&&e.state===2&&e.cause)try{await(async function(s,i){const a=i.cause;for(const c of i.targetIds)s.Ia.has(c)&&(await s.remoteSyncer.rejectListen(c,a),s.Ia.delete(c),s.Va.removeTarget(c))})(n,e)}catch(r){M(xn,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Vi(n,r)}else if(e instanceof hi?n.Va.Ze(e):e instanceof Nd?n.Va.st(e):n.Va.tt(e),!t.isEqual(q.min()))try{const r=await $d(n.localStore);t.compareTo(r)>=0&&await(function(i,a){const c=i.Va.Tt(a);return c.targetChanges.forEach(((l,h)=>{if(l.resumeToken.approximateByteSize()>0){const d=i.Ia.get(h);d&&i.Ia.set(h,d.withResumeToken(l.resumeToken,a))}})),c.targetMismatches.forEach(((l,h)=>{const d=i.Ia.get(l);if(!d)return;i.Ia.set(l,d.withResumeToken(Pe.EMPTY_BYTE_STRING,d.snapshotVersion)),Gd(i,l);const g=new Jt(d.target,l,h,d.sequenceNumber);Sc(i,g)})),i.remoteSyncer.applyRemoteEvent(c)})(n,t)}catch(r){M(xn,"Failed to raise snapshot:",r),await Vi(n,r)}}async function Vi(n,e,t){if(!Mr(e))throw e;n.Ea.add(1),await Ns(n),n.Ra.set("Offline"),t||(t=()=>$d(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{M(xn,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await lo(n)}))}function Qd(n,e){return e().catch((t=>Vi(n,t,e)))}async function ho(n){const e=$(n),t=fn(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:hc;for(;iT(e);)try{const s=await BE(e.localStore,r);if(s===null){e.Ta.length===0&&t.L_();break}r=s.batchId,oT(e,s)}catch(s){await Vi(e,s)}Xd(e)&&Jd(e)}function iT(n){return zn(n)&&n.Ta.length<10}function oT(n,e){n.Ta.push(e);const t=fn(n);t.O_()&&t.X_&&t.ea(e.mutations)}function Xd(n){return zn(n)&&!fn(n).x_()&&n.Ta.length>0}function Jd(n){fn(n).start()}async function aT(n){fn(n).ra()}async function cT(n){const e=fn(n);for(const t of n.Ta)e.ea(t.mutations)}async function uT(n,e,t){const r=n.Ta.shift(),s=vc.from(r,e,t);await Qd(n,(()=>n.remoteSyncer.applySuccessfulWrite(s))),await ho(n)}async function lT(n,e){e&&fn(n).X_&&await(async function(r,s){if((function(a){return Hv(a)&&a!==N.ABORTED})(s.code)){const i=r.Ta.shift();fn(r).B_(),await Qd(r,(()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s))),await ho(r)}})(n,e),Xd(n)&&Jd(n)}async function uh(n,e){const t=$(n);t.asyncQueue.verifyOperationInProgress(),M(xn,"RemoteStore received new credentials");const r=zn(t);t.Ea.add(3),await Ns(t),r&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await lo(t)}async function hT(n,e){const t=$(n);e?(t.Ea.delete(2),await lo(t)):e||(t.Ea.add(2),await Ns(t),t.Ra.set("Unknown"))}function Lr(n){return n.ma||(n.ma=(function(t,r,s){const i=$(t);return i.sa(),new QE(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)})(n.datastore,n.asyncQueue,{Xo:tT.bind(null,n),t_:nT.bind(null,n),r_:rT.bind(null,n),H_:sT.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),Cc(n)?Pc(n):n.Ra.set("Unknown")):(await n.ma.stop(),Kd(n))}))),n.ma}function fn(n){return n.fa||(n.fa=(function(t,r,s){const i=$(t);return i.sa(),new XE(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:aT.bind(null,n),r_:lT.bind(null,n),ta:cT.bind(null,n),na:uT.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await ho(n)):(await n.fa.stop(),n.Ta.length>0&&(M(xn,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class kc{constructor(e,t,r,s,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new Cn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((a=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,s,i){const a=Date.now()+r,c=new kc(e,t,a,s,i);return c.start(r),c}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new x(N.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Nc(n,e){if(Ot("AsyncQueue",`${e}: ${n}`),Mr(n))return new x(N.UNAVAILABLE,`${e}: ${n}`);throw n}class cr{static emptySet(e){return new cr(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||F.comparator(t.key,r.key):(t,r)=>F.comparator(t.key,r.key),this.keyedMap=ns(),this.sortedSet=new ue(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,r)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof cr)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new cr;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class lh{constructor(){this.ga=new ue(F.comparator)}track(e){const t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):B(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,r)=>{e.push(r)})),e}}class wr{constructor(e,t,r,s,i,a,c,l,h){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=a,this.syncStateChanged=c,this.excludesMetadataChanges=l,this.hasCachedResults=h}static fromInitialDocuments(e,t,r,s,i){const a=[];return t.forEach((c=>{a.push({type:0,doc:c})})),new wr(e,t,cr.emptySet(t),a,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&so(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==r[s].type||!t[s].doc.isEqual(r[s].doc))return!1;return!0}}class fT{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class dT{constructor(){this.queries=hh(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){const s=$(t),i=s.queries;s.queries=hh(),i.forEach(((a,c)=>{for(const l of c.Sa)l.onError(r)}))})(this,new x(N.ABORTED,"Firestore shutting down"))}}function hh(){return new $n((n=>yd(n)),so)}async function pT(n,e){const t=$(n);let r=3;const s=e.query;let i=t.queries.get(s);i?!i.ba()&&e.Da()&&(r=2):(i=new fT,r=e.Da()?0:1);try{switch(r){case 0:i.wa=await t.onListen(s,!0);break;case 1:i.wa=await t.onListen(s,!1);break;case 2:await t.onFirstRemoteStoreListen(s)}}catch(a){const c=Nc(a,`Initialization of query '${Jn(e.query)}' failed`);return void e.onError(c)}t.queries.set(s,i),i.Sa.push(e),e.va(t.onlineState),i.wa&&e.Fa(i.wa)&&Dc(t)}async function mT(n,e){const t=$(n),r=e.query;let s=3;const i=t.queries.get(r);if(i){const a=i.Sa.indexOf(e);a>=0&&(i.Sa.splice(a,1),i.Sa.length===0?s=e.Da()?0:1:!i.ba()&&e.Da()&&(s=2))}switch(s){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function gT(n,e){const t=$(n);let r=!1;for(const s of e){const i=s.query,a=t.queries.get(i);if(a){for(const c of a.Sa)c.Fa(s)&&(r=!0);a.wa=s}}r&&Dc(t)}function _T(n,e,t){const r=$(n),s=r.queries.get(e);if(s)for(const i of s.Sa)i.onError(t);r.queries.delete(e)}function Dc(n){n.Ca.forEach((e=>{e.next()}))}var Ma,fh;(fh=Ma||(Ma={})).Ma="default",fh.Cache="cache";class yT{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new wr(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const r=t!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=wr.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Ma.Cache}}class Yd{constructor(e){this.key=e}}class Zd{constructor(e){this.key=e}}class vT{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=K(),this.mutatedKeys=K(),this.eu=vd(e),this.tu=new cr(this.eu)}get nu(){return this.Ya}ru(e,t){const r=t?t.iu:new lh,s=t?t.tu:this.tu;let i=t?t.mutatedKeys:this.mutatedKeys,a=s,c=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,h=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal(((d,g)=>{const m=s.get(d),T=io(this.query,g)?g:null,S=!!m&&this.mutatedKeys.has(m.key),C=!!T&&(T.hasLocalMutations||this.mutatedKeys.has(T.key)&&T.hasCommittedMutations);let P=!1;m&&T?m.data.isEqual(T.data)?S!==C&&(r.track({type:3,doc:T}),P=!0):this.su(m,T)||(r.track({type:2,doc:T}),P=!0,(l&&this.eu(T,l)>0||h&&this.eu(T,h)<0)&&(c=!0)):!m&&T?(r.track({type:0,doc:T}),P=!0):m&&!T&&(r.track({type:1,doc:m}),P=!0,(l||h)&&(c=!0)),P&&(T?(a=a.add(T),i=C?i.add(d):i.delete(d)):(a=a.delete(d),i=i.delete(d)))})),this.query.limit!==null)for(;a.size>this.query.limit;){const d=this.query.limitType==="F"?a.last():a.first();a=a.delete(d.key),i=i.delete(d.key),r.track({type:1,doc:d})}return{tu:a,iu:r,Cs:c,mutatedKeys:i}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,s){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const a=e.iu.ya();a.sort(((d,g)=>(function(T,S){const C=P=>{switch(P){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return B(20277,{Rt:P})}};return C(T)-C(S)})(d.type,g.type)||this.eu(d.doc,g.doc))),this.ou(r),s=s??!1;const c=t&&!s?this._u():[],l=this.Xa.size===0&&this.current&&!s?1:0,h=l!==this.Za;return this.Za=l,a.length!==0||h?{snapshot:new wr(this.query,e.tu,i,a,e.mutatedKeys,l===0,h,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:c}:{au:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new lh,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=K(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))}));const t=[];return e.forEach((r=>{this.Xa.has(r)||t.push(new Zd(r))})),this.Xa.forEach((r=>{e.has(r)||t.push(new Yd(r))})),t}cu(e){this.Ya=e.Qs,this.Xa=K();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return wr.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Vc="SyncEngine";class ET{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class TT{constructor(e){this.key=e,this.hu=!1}}class IT{constructor(e,t,r,s,i,a){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new $n((c=>yd(c)),so),this.Iu=new Map,this.Eu=new Set,this.du=new ue(F.comparator),this.Au=new Map,this.Ru=new Ic,this.Vu={},this.mu=new Map,this.fu=Ir.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function wT(n,e,t=!0){const r=ip(n);let s;const i=r.Tu.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.lu()):s=await ep(r,e,t,!0),s}async function AT(n,e){const t=ip(n);await ep(t,e,!0,!1)}async function ep(n,e,t,r){const s=await jE(n.localStore,gt(e)),i=s.targetId,a=n.sharedClientState.addLocalQueryTarget(i,t);let c;return r&&(c=await bT(n,e,i,a==="current",s.resumeToken)),n.isPrimaryClient&&t&&Wd(n.remoteStore,s),c}async function bT(n,e,t,r,s){n.pu=(g,m,T)=>(async function(C,P,L,O){let V=P.view.ru(L);V.Cs&&(V=await sh(C.localStore,P.query,!1).then((({documents:I})=>P.view.ru(I,V))));const H=O&&O.targetChanges.get(P.targetId),Y=O&&O.targetMismatches.get(P.targetId)!=null,te=P.view.applyChanges(V,C.isPrimaryClient,H,Y);return ph(C,P.targetId,te.au),te.snapshot})(n,g,m,T);const i=await sh(n.localStore,e,!0),a=new vT(e,i.Qs),c=a.ru(i.documents),l=ks.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",s),h=a.applyChanges(c,n.isPrimaryClient,l);ph(n,t,h.au);const d=new ET(e,t,a);return n.Tu.set(e,d),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),h.snapshot}async function RT(n,e,t){const r=$(n),s=r.Tu.get(e),i=r.Iu.get(s.targetId);if(i.length>1)return r.Iu.set(s.targetId,i.filter((a=>!so(a,e)))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await Va(r.localStore,s.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(s.targetId),t&&Rc(r.remoteStore,s.targetId),La(r,s.targetId)})).catch(Or)):(La(r,s.targetId),await Va(r.localStore,s.targetId,!0))}async function ST(n,e){const t=$(n),r=t.Tu.get(e),s=t.Iu.get(r.targetId);t.isPrimaryClient&&s.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Rc(t.remoteStore,r.targetId))}async function PT(n,e,t){const r=MT(n);try{const s=await(function(a,c){const l=$(a),h=ae.now(),d=c.reduce(((T,S)=>T.add(S.key)),K());let g,m;return l.persistence.runTransaction("Locally write mutations","readwrite",(T=>{let S=Mt(),C=K();return l.Ns.getEntries(T,d).next((P=>{S=P,S.forEach(((L,O)=>{O.isValidDocument()||(C=C.add(L))}))})).next((()=>l.localDocuments.getOverlayedDocuments(T,S))).next((P=>{g=P;const L=[];for(const O of c){const V=Bv(O,g.get(O.key).overlayedDocument);V!=null&&L.push(new gn(O.key,V,hd(V.value.mapValue),it.exists(!0)))}return l.mutationQueue.addMutationBatch(T,h,L,c)})).next((P=>{m=P;const L=P.applyToLocalDocumentSet(g,C);return l.documentOverlayCache.saveOverlays(T,P.batchId,L)}))})).then((()=>({batchId:m.batchId,changes:Td(g)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),(function(a,c,l){let h=a.Vu[a.currentUser.toKey()];h||(h=new ue(G)),h=h.insert(c,l),a.Vu[a.currentUser.toKey()]=h})(r,s.batchId,t),await Ds(r,s.changes),await ho(r.remoteStore)}catch(s){const i=Nc(s,"Failed to persist write");t.reject(i)}}async function tp(n,e){const t=$(n);try{const r=await FE(t.localStore,e);e.targetChanges.forEach(((s,i)=>{const a=t.Au.get(i);a&&(ee(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?a.hu=!0:s.modifiedDocuments.size>0?ee(a.hu,14607):s.removedDocuments.size>0&&(ee(a.hu,42227),a.hu=!1))})),await Ds(t,r,e)}catch(r){await Or(r)}}function dh(n,e,t){const r=$(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const s=[];r.Tu.forEach(((i,a)=>{const c=a.view.va(e);c.snapshot&&s.push(c.snapshot)})),(function(a,c){const l=$(a);l.onlineState=c;let h=!1;l.queries.forEach(((d,g)=>{for(const m of g.Sa)m.va(c)&&(h=!0)})),h&&Dc(l)})(r.eventManager,e),s.length&&r.Pu.H_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function CT(n,e,t){const r=$(n);r.sharedClientState.updateQueryState(e,"rejected",t);const s=r.Au.get(e),i=s&&s.key;if(i){let a=new ue(F.comparator);a=a.insert(i,Ve.newNoDocument(i,q.min()));const c=K().add(i),l=new co(q.min(),new Map,new ue(G),a,c);await tp(r,l),r.du=r.du.remove(i),r.Au.delete(e),Oc(r)}else await Va(r.localStore,e,!1).then((()=>La(r,e,t))).catch(Or)}async function kT(n,e){const t=$(n),r=e.batch.batchId;try{const s=await xE(t.localStore,e);rp(t,r,null),np(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await Ds(t,s)}catch(s){await Or(s)}}async function NT(n,e,t){const r=$(n);try{const s=await(function(a,c){const l=$(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",(h=>{let d;return l.mutationQueue.lookupMutationBatch(h,c).next((g=>(ee(g!==null,37113),d=g.keys(),l.mutationQueue.removeMutationBatch(h,g)))).next((()=>l.mutationQueue.performConsistencyCheck(h))).next((()=>l.documentOverlayCache.removeOverlaysForBatchId(h,d,c))).next((()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,d))).next((()=>l.localDocuments.getDocuments(h,d)))}))})(r.localStore,e);rp(r,e,t),np(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await Ds(r,s)}catch(s){await Or(s)}}function np(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function rp(n,e,t){const r=$(n);let s=r.Vu[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(t?i.reject(t):i.resolve(),s=s.remove(e)),r.Vu[r.currentUser.toKey()]=s}}function La(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Iu.get(e))n.Tu.delete(r),t&&n.Pu.yu(r,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((r=>{n.Ru.containsKey(r)||sp(n,r)}))}function sp(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(Rc(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),Oc(n))}function ph(n,e,t){for(const r of t)r instanceof Yd?(n.Ru.addReference(r.key,e),DT(n,r)):r instanceof Zd?(M(Vc,"Document no longer in limbo: "+r.key),n.Ru.removeReference(r.key,e),n.Ru.containsKey(r.key)||sp(n,r.key)):B(19791,{wu:r})}function DT(n,e){const t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Eu.has(r)||(M(Vc,"New document in limbo: "+t),n.Eu.add(r),Oc(n))}function Oc(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new F(oe.fromString(e)),r=n.fu.next();n.Au.set(r,new TT(t)),n.du=n.du.insert(t,r),Wd(n.remoteStore,new Jt(gt(gc(t.path)),r,"TargetPurposeLimboResolution",eo.ce))}}async function Ds(n,e,t){const r=$(n),s=[],i=[],a=[];r.Tu.isEmpty()||(r.Tu.forEach(((c,l)=>{a.push(r.pu(l,e,t).then((h=>{if((h||t)&&r.isPrimaryClient){const d=h?!h.fromCache:t?.targetChanges.get(l.targetId)?.current;r.sharedClientState.updateQueryState(l.targetId,d?"current":"not-current")}if(h){s.push(h);const d=Ac.As(l.targetId,h);i.push(d)}})))})),await Promise.all(a),r.Pu.H_(s),await(async function(l,h){const d=$(l);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",(g=>k.forEach(h,(m=>k.forEach(m.Es,(T=>d.persistence.referenceDelegate.addReference(g,m.targetId,T))).next((()=>k.forEach(m.ds,(T=>d.persistence.referenceDelegate.removeReference(g,m.targetId,T)))))))))}catch(g){if(!Mr(g))throw g;M(bc,"Failed to update sequence numbers: "+g)}for(const g of h){const m=g.targetId;if(!g.fromCache){const T=d.Ms.get(m),S=T.snapshotVersion,C=T.withLastLimboFreeSnapshotVersion(S);d.Ms=d.Ms.insert(m,C)}}})(r.localStore,i))}async function VT(n,e){const t=$(n);if(!t.currentUser.isEqual(e)){M(Vc,"User change. New user:",e.toKey());const r=await qd(t.localStore,e);t.currentUser=e,(function(i,a){i.mu.forEach((c=>{c.forEach((l=>{l.reject(new x(N.CANCELLED,a))}))})),i.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Ds(t,r.Ls)}}function OT(n,e){const t=$(n),r=t.Au.get(e);if(r&&r.hu)return K().add(r.key);{let s=K();const i=t.Iu.get(e);if(!i)return s;for(const a of i){const c=t.Tu.get(a);s=s.unionWith(c.view.nu)}return s}}function ip(n){const e=$(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=tp.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=OT.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=CT.bind(null,e),e.Pu.H_=gT.bind(null,e.eventManager),e.Pu.yu=_T.bind(null,e.eventManager),e}function MT(n){const e=$(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=kT.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=NT.bind(null,e),e}class Oi{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=uo(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return LE(this.persistence,new VE,e.initialUser,this.serializer)}Cu(e){return new jd(wc.mi,this.serializer)}Du(e){return new $E}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Oi.provider={build:()=>new Oi};class LT extends Oi{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){ee(this.persistence.referenceDelegate instanceof Di,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new yE(r,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?qe.withCacheSize(this.cacheSizeBytes):qe.DEFAULT;return new jd((r=>Di.mi(r,t)),this.serializer)}}class xa{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>dh(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=VT.bind(null,this.syncEngine),await hT(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new dT})()}createDatastore(e){const t=uo(e.databaseInfo.databaseId),r=(function(i){return new KE(i)})(e.databaseInfo);return(function(i,a,c,l){return new YE(i,a,c,l)})(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return(function(r,s,i,a,c){return new eT(r,s,i,a,c)})(this.localStore,this.datastore,e.asyncQueue,(t=>dh(this.syncEngine,t,0)),(function(){return ah.v()?new ah:new zE})())}createSyncEngine(e,t){return(function(s,i,a,c,l,h,d){const g=new IT(s,i,a,c,l,h);return d&&(g.gu=!0),g})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const r=$(t);M(xn,"RemoteStore shutting down."),r.Ea.add(5),await Ns(r),r.Aa.shutdown(),r.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}xa.provider={build:()=>new xa};class xT{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Ot("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const dn="FirestoreClient";class FT{constructor(e,t,r,s,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=s,this.user=De.UNAUTHENTICATED,this.clientId=uc.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,(async a=>{M(dn,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a})),this.appCheckCredentials.start(r,(a=>(M(dn,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Cn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=Nc(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function sa(n,e){n.asyncQueue.verifyOperationInProgress(),M(dn,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener((async s=>{r.isEqual(s)||(await qd(e.localStore,s),r=s)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function mh(n,e){n.asyncQueue.verifyOperationInProgress();const t=await UT(n);M(dn,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((r=>uh(e.remoteStore,r))),n.setAppCheckTokenChangeListener(((r,s)=>uh(e.remoteStore,s))),n._onlineComponents=e}async function UT(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){M(dn,"Using user provided OfflineComponentProvider");try{await sa(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(s){return s.name==="FirebaseError"?s.code===N.FAILED_PRECONDITION||s.code===N.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11})(t))throw t;yr("Error using user provided cache. Falling back to memory cache: "+t),await sa(n,new Oi)}}else M(dn,"Using default OfflineComponentProvider"),await sa(n,new LT(void 0));return n._offlineComponents}async function op(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(M(dn,"Using user provided OnlineComponentProvider"),await mh(n,n._uninitializedComponentsProvider._online)):(M(dn,"Using default OnlineComponentProvider"),await mh(n,new xa))),n._onlineComponents}function BT(n){return op(n).then((e=>e.syncEngine))}async function gh(n){const e=await op(n),t=e.eventManager;return t.onListen=wT.bind(null,e.syncEngine),t.onUnlisten=RT.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=AT.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=ST.bind(null,e.syncEngine),t}function ap(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const _h=new Map;const cp="firestore.googleapis.com",yh=!0;class vh{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new x(N.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=cp,this.ssl=yh}else this.host=e.host,this.ssl=e.ssl??yh;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Bd;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<gE)throw new x(N.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Zy("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=ap(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new x(N.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new x(N.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new x(N.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,s){return r.timeoutSeconds===s.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class fo{constructor(e,t,r,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new vh({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new x(N.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new x(N.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new vh(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new $y;switch(r.type){case"firstParty":return new Gy(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new x(N.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const r=_h.get(t);r&&(M("ComponentProvider","Removing Datastore"),_h.delete(t),r.terminate())})(this),Promise.resolve()}}function jT(n,e,t,r={}){n=sn(n,fo);const s=pn(e),i=n._getSettings(),a={...i,emulatorOptions:n._getEmulatorOptions()},c=`${e}:${t}`;s&&(rc(`https://${c}`),sc("Firestore",!0)),i.host!==cp&&i.host!==c&&yr("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...i,host:c,ssl:s,emulatorOptions:r};if(!On(l,a)&&(n._setSettings(l),r.mockUserToken)){let h,d;if(typeof r.mockUserToken=="string")h=r.mockUserToken,d=De.MOCK_USER;else{h=p_(r.mockUserToken,n._app?.options.projectId);const g=r.mockUserToken.sub||r.mockUserToken.user_id;if(!g)throw new x(N.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new De(g)}n._authCredentials=new zy(new Zf(h,d))}}class po{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new po(this.firestore,e,this._query)}}class ve{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new on(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ve(this.firestore,e,this._key)}toJSON(){return{type:ve._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(Ps(t,ve._jsonSchema))return new ve(e,r||null,new F(oe.fromString(t.referencePath)))}}ve._jsonSchemaVersion="firestore/documentReference/1.0",ve._jsonSchema={type:de("string",ve._jsonSchemaVersion),referencePath:de("string")};class on extends po{constructor(e,t,r){super(e,t,gc(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ve(this.firestore,null,new F(e))}withConverter(e){return new on(this.firestore,e,this._path)}}function up(n,e,...t){if(n=pe(n),ed("collection","path",e),n instanceof fo){const r=oe.fromString(e,...t);return Dl(r),new on(n,null,r)}{if(!(n instanceof ve||n instanceof on))throw new x(N.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(oe.fromString(e,...t));return Dl(r),new on(n.firestore,null,r)}}function Mc(n,e,...t){if(n=pe(n),arguments.length===1&&(e=uc.newId()),ed("doc","path",e),n instanceof fo){const r=oe.fromString(e,...t);return Nl(r),new ve(n,null,new F(r))}{if(!(n instanceof ve||n instanceof on))throw new x(N.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(oe.fromString(e,...t));return Nl(r),new ve(n.firestore,n instanceof on?n.converter:null,new F(r))}}const Eh="AsyncQueue";class Th{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new zd(this,"async_queue_retry"),this._c=()=>{const r=ra();r&&M(Eh,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const t=ra();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=ra();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new Cn;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Mr(e))throw e;M(Eh,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((r=>{throw this.nc=r,this.rc=!1,Ot("INTERNAL UNHANDLED ERROR: ",Ih(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const s=kc.createAndSchedule(this,e,t,r,(i=>this.hc(i)));return this.tc.push(s),s}uc(){this.nc&&B(47125,{Pc:Ih(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,r)=>t.targetTimeMs-r.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function Ih(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}function wh(n){return(function(t,r){if(typeof t!="object"||t===null)return!1;const s=t;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1})(n,["next","error","complete"])}class Ar extends fo{constructor(e,t,r,s){super(e,t,r,s),this.type="firestore",this._queue=new Th,this._persistenceKey=s?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Th(e),this._firestoreClient=void 0,await e}}}function qT(n,e){const t=typeof n=="object"?n:ac(),r=typeof n=="string"?n:bi,s=Zi(t,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=Ff("firestore");i&&jT(s,...i)}return s}function lp(n){if(n._terminated)throw new x(N.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||$T(n),n._firestoreClient}function $T(n){const e=n._freezeSettings(),t=(function(s,i,a,c){return new lv(s,i,a,c.host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,ap(c.experimentalLongPollingOptions),c.useFetchStreams,c.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new FT(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(s){const i=s?._online.build();return{_offline:s?._offline.build(i),_online:i}})(n._componentsProvider))}class tt{constructor(e){this._byteString=e}static fromBase64String(e){try{return new tt(Pe.fromBase64String(e))}catch(t){throw new x(N.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new tt(Pe.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:tt._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Ps(e,tt._jsonSchema))return tt.fromBase64String(e.bytes)}}tt._jsonSchemaVersion="firestore/bytes/1.0",tt._jsonSchema={type:de("string",tt._jsonSchemaVersion),bytes:de("string")};class mo{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new x(N.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new be(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Lc{constructor(e){this._methodName=e}}class yt{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new x(N.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new x(N.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return G(this._lat,e._lat)||G(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:yt._jsonSchemaVersion}}static fromJSON(e){if(Ps(e,yt._jsonSchema))return new yt(e.latitude,e.longitude)}}yt._jsonSchemaVersion="firestore/geoPoint/1.0",yt._jsonSchema={type:de("string",yt._jsonSchemaVersion),latitude:de("number"),longitude:de("number")};class vt{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0})(this._values,e._values)}toJSON(){return{type:vt._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Ps(e,vt._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new vt(e.vectorValues);throw new x(N.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}vt._jsonSchemaVersion="firestore/vectorValue/1.0",vt._jsonSchema={type:de("string",vt._jsonSchemaVersion),vectorValues:de("object")};const zT=/^__.*__$/;class HT{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new gn(e,this.data,this.fieldMask,t,this.fieldTransforms):new Cs(e,this.data,t,this.fieldTransforms)}}class hp{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new gn(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function fp(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw B(40011,{Ac:n})}}class xc{constructor(e,t,r,s,i,a){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new xc({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.gc(e),r}yc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Mi(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(fp(this.Ac)&&zT.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class WT{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||uo(e)}Cc(e,t,r,s=!1){return new xc({Ac:e,methodName:t,Dc:r,path:be.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function dp(n){const e=n._freezeSettings(),t=uo(n._databaseId);return new WT(n._databaseId,!!e.ignoreUndefinedProperties,t)}function GT(n,e,t,r,s,i={}){const a=n.Cc(i.merge||i.mergeFields?2:0,e,t,s);Fc("Data must be an object, but it was:",a,r);const c=pp(r,a);let l,h;if(i.merge)l=new Je(a.fieldMask),h=a.fieldTransforms;else if(i.mergeFields){const d=[];for(const g of i.mergeFields){const m=Fa(e,g,t);if(!a.contains(m))throw new x(N.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);gp(d,m)||d.push(m)}l=new Je(d),h=a.fieldTransforms.filter((g=>l.covers(g.field)))}else l=null,h=a.fieldTransforms;return new HT(new ze(c),l,h)}class go extends Lc{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof go}}function KT(n,e,t,r){const s=n.Cc(1,e,t);Fc("Data must be an object, but it was:",s,r);const i=[],a=ze.empty();mn(r,((l,h)=>{const d=Uc(e,l,t);h=pe(h);const g=s.yc(d);if(h instanceof go)i.push(d);else{const m=_o(h,g);m!=null&&(i.push(d),a.set(d,m))}}));const c=new Je(i);return new hp(a,c,s.fieldTransforms)}function QT(n,e,t,r,s,i){const a=n.Cc(1,e,t),c=[Fa(e,r,t)],l=[s];if(i.length%2!=0)throw new x(N.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<i.length;m+=2)c.push(Fa(e,i[m])),l.push(i[m+1]);const h=[],d=ze.empty();for(let m=c.length-1;m>=0;--m)if(!gp(h,c[m])){const T=c[m];let S=l[m];S=pe(S);const C=a.yc(T);if(S instanceof go)h.push(T);else{const P=_o(S,C);P!=null&&(h.push(T),d.set(T,P))}}const g=new Je(h);return new hp(d,g,a.fieldTransforms)}function _o(n,e){if(mp(n=pe(n)))return Fc("Unsupported field value:",e,n),pp(n,e);if(n instanceof Lc)return(function(r,s){if(!fp(s.Ac))throw s.Sc(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(r,s){const i=[];let a=0;for(const c of r){let l=_o(c,s.wc(a));l==null&&(l={nullValue:"NULL_VALUE"}),i.push(l),a++}return{arrayValue:{values:i}}})(n,e)}return(function(r,s){if((r=pe(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return Ov(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=ae.fromDate(r);return{timestampValue:Ni(s.serializer,i)}}if(r instanceof ae){const i=new ae(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Ni(s.serializer,i)}}if(r instanceof yt)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof tt)return{bytesValue:Vd(s.serializer,r._byteString)};if(r instanceof ve){const i=s.databaseId,a=r.firestore._databaseId;if(!a.isEqual(i))throw s.Sc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Tc(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof vt)return(function(a,c){return{mapValue:{fields:{[ud]:{stringValue:ld},[Ri]:{arrayValue:{values:a.toArray().map((h=>{if(typeof h!="number")throw c.Sc("VectorValues must only contain numeric values.");return _c(c.serializer,h)}))}}}}}})(r,s);throw s.Sc(`Unsupported field value: ${lc(r)}`)})(n,e)}function pp(n,e){const t={};return rd(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):mn(n,((r,s)=>{const i=_o(s,e.mc(r));i!=null&&(t[r]=i)})),{mapValue:{fields:t}}}function mp(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof ae||n instanceof yt||n instanceof tt||n instanceof ve||n instanceof Lc||n instanceof vt)}function Fc(n,e,t){if(!mp(t)||!td(t)){const r=lc(t);throw r==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+r)}}function Fa(n,e,t){if((e=pe(e))instanceof mo)return e._internalPath;if(typeof e=="string")return Uc(n,e);throw Mi("Field path arguments must be of type string or ",n,!1,void 0,t)}const XT=new RegExp("[~\\*/\\[\\]]");function Uc(n,e,t){if(e.search(XT)>=0)throw Mi(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new mo(...e.split("."))._internalPath}catch{throw Mi(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Mi(n,e,t,r,s){const i=r&&!r.isEmpty(),a=s!==void 0;let c=`Function ${e}() called with invalid data`;t&&(c+=" (via `toFirestore()`)"),c+=". ";let l="";return(i||a)&&(l+=" (found",i&&(l+=` in field ${r}`),a&&(l+=` in document ${s}`),l+=")"),new x(N.INVALID_ARGUMENT,c+n+l)}function gp(n,e){return n.some((t=>t.isEqual(e)))}class _p{constructor(e,t,r,s,i){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new ve(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new JT(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(yp("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class JT extends _p{data(){return super.data()}}function yp(n,e){return typeof e=="string"?Uc(n,e):e instanceof mo?e._internalPath:e._delegate._internalPath}function YT(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new x(N.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class ZT{convertValue(e,t="none"){switch(hn(e)){case 0:return null;case 1:return e.booleanValue;case 2:return he(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(ln(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw B(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return mn(e,((s,i)=>{r[s]=this.convertValue(i,t)})),r}convertVectorValue(e){const t=e.fields?.[Ri].arrayValue?.values?.map((r=>he(r.doubleValue)));return new vt(t)}convertGeoPoint(e){return new yt(he(e.latitude),he(e.longitude))}convertArray(e,t){return(e.values||[]).map((r=>this.convertValue(r,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const r=no(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(ys(e));default:return null}}convertTimestamp(e){const t=un(e);return new ae(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=oe.fromString(e);ee(Ud(r),9688,{name:e});const s=new vs(r.get(1),r.get(3)),i=new F(r.popFirst(5));return s.isEqual(t)||Ot(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}function eI(n,e,t){let r;return r=n?n.toFirestore(e):e,r}class ss{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class kn extends _p{constructor(e,t,r,s,i,a){super(e,t,r,s,a),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new fi(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(yp("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new x(N.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=kn._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}kn._jsonSchemaVersion="firestore/documentSnapshot/1.0",kn._jsonSchema={type:de("string",kn._jsonSchemaVersion),bundleSource:de("string","DocumentSnapshot"),bundleName:de("string"),bundle:de("string")};class fi extends kn{data(e={}){return super.data(e)}}class ur{constructor(e,t,r,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new ss(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((r=>{e.call(t,new fi(this._firestore,this._userDataWriter,r.key,r,new ss(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new x(N.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(s,i){if(s._snapshot.oldDocs.isEmpty()){let a=0;return s._snapshot.docChanges.map((c=>{const l=new fi(s._firestore,s._userDataWriter,c.doc.key,c.doc,new ss(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);return c.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}}))}{let a=s._snapshot.oldDocs;return s._snapshot.docChanges.filter((c=>i||c.type!==3)).map((c=>{const l=new fi(s._firestore,s._userDataWriter,c.doc.key,c.doc,new ss(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);let h=-1,d=-1;return c.type!==0&&(h=a.indexOf(c.doc.key),a=a.delete(c.doc.key)),c.type!==1&&(a=a.add(c.doc),d=a.indexOf(c.doc.key)),{type:tI(c.type),doc:l,oldIndex:h,newIndex:d}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new x(N.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=ur._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=uc.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],s=[];return this.docs.forEach((i=>{i._document!==null&&(t.push(i._document),r.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),s.push(i.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function tI(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return B(61501,{type:n})}}ur._jsonSchemaVersion="firestore/querySnapshot/1.0",ur._jsonSchema={type:de("string",ur._jsonSchemaVersion),bundleSource:de("string","QuerySnapshot"),bundleName:de("string"),bundle:de("string")};class vp extends ZT{constructor(e){super(),this.firestore=e}convertBytes(e){return new tt(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new ve(this.firestore,null,t)}}function nI(n,e,t,...r){n=sn(n,ve);const s=sn(n.firestore,Ar),i=dp(s);let a;return a=typeof(e=pe(e))=="string"||e instanceof mo?QT(i,"updateDoc",n._key,e,t,r):KT(i,"updateDoc",n._key,e),Bc(s,[a.toMutation(n._key,it.exists(!0))])}function rI(n){return Bc(sn(n.firestore,Ar),[new yc(n._key,it.none())])}function sI(n,e){const t=sn(n.firestore,Ar),r=Mc(n),s=eI(n.converter,e);return Bc(t,[GT(dp(n.firestore),"addDoc",r._key,s,n.converter!==null,{}).toMutation(r._key,it.exists(!1))]).then((()=>r))}function iI(n,...e){n=pe(n);let t={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||wh(e[r])||(t=e[r++]);const s={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(wh(e[r])){const l=e[r];e[r]=l.next?.bind(l),e[r+1]=l.error?.bind(l),e[r+2]=l.complete?.bind(l)}let i,a,c;if(n instanceof ve)a=sn(n.firestore,Ar),c=gc(n._key.path),i={next:l=>{e[r]&&e[r](oI(a,n,l))},error:e[r+1],complete:e[r+2]};else{const l=sn(n,po);a=sn(l.firestore,Ar),c=l._query;const h=new vp(a);i={next:d=>{e[r]&&e[r](new ur(a,h,l,d))},error:e[r+1],complete:e[r+2]},YT(n._query)}return(function(h,d,g,m){const T=new xT(m),S=new yT(d,T,g);return h.asyncQueue.enqueueAndForget((async()=>pT(await gh(h),S))),()=>{T.Nu(),h.asyncQueue.enqueueAndForget((async()=>mT(await gh(h),S)))}})(lp(a),c,s,i)}function Bc(n,e){return(function(r,s){const i=new Cn;return r.asyncQueue.enqueueAndForget((async()=>PT(await BT(r),s,i))),i.promise})(lp(n),e)}function oI(n,e,t){const r=t.docs.get(e._key),s=new vp(n);return new kn(n,s,e._key,r,new ss(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(s){Vr=s})(Dr),Mn(new an("firestore",((r,{instanceIdentifier:s,options:i})=>{const a=r.getProvider("app").getImmediate(),c=new Ar(new Hy(r.getProvider("auth-internal")),new Ky(a,r.getProvider("app-check-internal")),(function(h,d){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new x(N.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new vs(h.options.projectId,d)})(a,s),a);return i={useFetchStreams:t,...i},c._setSettings(i),c}),"PUBLIC").setMultipleInstances(!0)),mt(Sl,Pl,e),mt(Sl,Pl,"esm2020")})();function Ep(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const aI=Ep,Tp=new Rs("auth","Firebase",Ep());const Li=new ic("@firebase/auth");function cI(n,...e){Li.logLevel<=W.WARN&&Li.warn(`Auth (${Dr}): ${n}`,...e)}function di(n,...e){Li.logLevel<=W.ERROR&&Li.error(`Auth (${Dr}): ${n}`,...e)}function At(n,...e){throw qc(n,...e)}function ot(n,...e){return qc(n,...e)}function jc(n,e,t){const r={...aI(),[e]:t};return new Rs("auth","Firebase",r).create(e,{appName:n.name})}function Nn(n){return jc(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function uI(n,e,t){const r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&At(n,"argument-error"),jc(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function qc(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return Tp.create(n,...e)}function j(n,e,...t){if(!n)throw qc(e,...t)}function kt(n){const e="INTERNAL ASSERTION FAILED: "+n;throw di(e),new Error(e)}function Lt(n,e){n||kt(e)}function Ua(){return typeof self<"u"&&self.location?.href||""}function lI(){return Ah()==="http:"||Ah()==="https:"}function Ah(){return typeof self<"u"&&self.location?.protocol||null}function hI(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(lI()||E_()||"connection"in navigator)?navigator.onLine:!0}function fI(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class Vs{constructor(e,t){this.shortDelay=e,this.longDelay=t,Lt(t>e,"Short delay should be less than long delay!"),this.isMobile=__()||T_()}get(){return hI()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function $c(n,e){Lt(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class Ip{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;kt("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;kt("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;kt("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const dI={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const pI=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],mI=new Vs(3e4,6e4);function zc(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function xr(n,e,t,r,s={}){return wp(n,s,async()=>{let i={},a={};r&&(e==="GET"?a=r:i={body:JSON.stringify(r)});const c=Ss({key:n.config.apiKey,...a}).slice(1),l=await n._getAdditionalHeaders();l["Content-Type"]="application/json",n.languageCode&&(l["X-Firebase-Locale"]=n.languageCode);const h={method:e,headers:l,...i};return v_()||(h.referrerPolicy="no-referrer"),n.emulatorConfig&&pn(n.emulatorConfig.host)&&(h.credentials="include"),Ip.fetch()(await Ap(n,n.config.apiHost,t,c),h)})}async function wp(n,e,t){n._canInitEmulator=!1;const r={...dI,...e};try{const s=new _I(n),i=await Promise.race([t(),s.promise]);s.clearNetworkTimeout();const a=await i.json();if("needConfirmation"in a)throw si(n,"account-exists-with-different-credential",a);if(i.ok&&!("errorMessage"in a))return a;{const c=i.ok?a.errorMessage:a.error.message,[l,h]=c.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw si(n,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw si(n,"email-already-in-use",a);if(l==="USER_DISABLED")throw si(n,"user-disabled",a);const d=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw jc(n,d,h);At(n,d)}}catch(s){if(s instanceof Rt)throw s;At(n,"network-request-failed",{message:String(s)})}}async function gI(n,e,t,r,s={}){const i=await xr(n,e,t,r,s);return"mfaPendingCredential"in i&&At(n,"multi-factor-auth-required",{_serverResponse:i}),i}async function Ap(n,e,t,r){const s=`${e}${t}?${r}`,i=n,a=i.config.emulator?$c(n.config,s):`${n.config.apiScheme}://${s}`;return pI.includes(t)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(a).toString():a}class _I{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(ot(this.auth,"network-request-failed")),mI.get())})}}function si(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const s=ot(n,e,r);return s.customData._tokenResponse=t,s}async function yI(n,e){return xr(n,"POST","/v1/accounts:delete",e)}async function xi(n,e){return xr(n,"POST","/v1/accounts:lookup",e)}function fs(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function vI(n,e=!1){const t=pe(n),r=await t.getIdToken(e),s=Hc(r);j(s&&s.exp&&s.auth_time&&s.iat,t.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,a=i?.sign_in_provider;return{claims:s,token:r,authTime:fs(ia(s.auth_time)),issuedAtTime:fs(ia(s.iat)),expirationTime:fs(ia(s.exp)),signInProvider:a||null,signInSecondFactor:i?.sign_in_second_factor||null}}function ia(n){return Number(n)*1e3}function Hc(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return di("JWT malformed, contained fewer than 3 sections"),null;try{const s=Lf(t);return s?JSON.parse(s):(di("Failed to decode base64 JWT payload"),null)}catch(s){return di("Caught error parsing JWT payload as JSON",s?.toString()),null}}function bh(n){const e=Hc(n);return j(e,"internal-error"),j(typeof e.exp<"u","internal-error"),j(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function ws(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof Rt&&EI(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function EI({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class TI{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class Ba{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=fs(this.lastLoginAt),this.creationTime=fs(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Fi(n){const e=n.auth,t=await n.getIdToken(),r=await ws(n,xi(e,{idToken:t}));j(r?.users.length,e,"internal-error");const s=r.users[0];n._notifyReloadListener(s);const i=s.providerUserInfo?.length?bp(s.providerUserInfo):[],a=wI(n.providerData,i),c=n.isAnonymous,l=!(n.email&&s.passwordHash)&&!a?.length,h=c?l:!1,d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new Ba(s.createdAt,s.lastLoginAt),isAnonymous:h};Object.assign(n,d)}async function II(n){const e=pe(n);await Fi(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function wI(n,e){return[...n.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function bp(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function AI(n,e){const t=await wp(n,{},async()=>{const r=Ss({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=n.config,a=await Ap(n,s,"/v1/token",`key=${i}`),c=await n._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:c,body:r};return n.emulatorConfig&&pn(n.emulatorConfig.host)&&(l.credentials="include"),Ip.fetch()(a,l)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function bI(n,e){return xr(n,"POST","/v2/accounts:revokeToken",zc(n,e))}class lr{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){j(e.idToken,"internal-error"),j(typeof e.idToken<"u","internal-error"),j(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):bh(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){j(e.length!==0,"internal-error");const t=bh(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(j(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:s,expiresIn:i}=await AI(e,t);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:s,expirationTime:i}=t,a=new lr;return r&&(j(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),s&&(j(typeof s=="string","internal-error",{appName:e}),a.accessToken=s),i&&(j(typeof i=="number","internal-error",{appName:e}),a.expirationTime=i),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new lr,this.toJSON())}_performRefresh(){return kt("not implemented")}}function Gt(n,e){j(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class st{constructor({uid:e,auth:t,stsTokenManager:r,...s}){this.providerId="firebase",this.proactiveRefresh=new TI(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Ba(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await ws(this,this.stsTokenManager.getToken(this.auth,e));return j(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return vI(this,e)}reload(){return II(this)}_assign(e){this!==e&&(j(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new st({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){j(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await Fi(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(et(this.auth.app))return Promise.reject(Nn(this.auth));const e=await this.getIdToken();return await ws(this,yI(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const r=t.displayName??void 0,s=t.email??void 0,i=t.phoneNumber??void 0,a=t.photoURL??void 0,c=t.tenantId??void 0,l=t._redirectEventId??void 0,h=t.createdAt??void 0,d=t.lastLoginAt??void 0,{uid:g,emailVerified:m,isAnonymous:T,providerData:S,stsTokenManager:C}=t;j(g&&C,e,"internal-error");const P=lr.fromJSON(this.name,C);j(typeof g=="string",e,"internal-error"),Gt(r,e.name),Gt(s,e.name),j(typeof m=="boolean",e,"internal-error"),j(typeof T=="boolean",e,"internal-error"),Gt(i,e.name),Gt(a,e.name),Gt(c,e.name),Gt(l,e.name),Gt(h,e.name),Gt(d,e.name);const L=new st({uid:g,auth:e,email:s,emailVerified:m,displayName:r,isAnonymous:T,photoURL:a,phoneNumber:i,tenantId:c,stsTokenManager:P,createdAt:h,lastLoginAt:d});return S&&Array.isArray(S)&&(L.providerData=S.map(O=>({...O}))),l&&(L._redirectEventId=l),L}static async _fromIdTokenResponse(e,t,r=!1){const s=new lr;s.updateFromServerResponse(t);const i=new st({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await Fi(i),i}static async _fromGetAccountInfoResponse(e,t,r){const s=t.users[0];j(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?bp(s.providerUserInfo):[],a=!(s.email&&s.passwordHash)&&!i?.length,c=new lr;c.updateFromIdToken(r);const l=new st({uid:s.localId,auth:e,stsTokenManager:c,isAnonymous:a}),h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new Ba(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!i?.length};return Object.assign(l,h),l}}const Rh=new Map;function Nt(n){Lt(n instanceof Function,"Expected a class definition");let e=Rh.get(n);return e?(Lt(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Rh.set(n,e),e)}class Rp{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Rp.type="NONE";const Sh=Rp;function pi(n,e,t){return`firebase:${n}:${e}:${t}`}class hr{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=pi(this.userKey,s.apiKey,i),this.fullPersistenceKey=pi("persistence",s.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await xi(this.auth,{idToken:e}).catch(()=>{});return t?st._fromGetAccountInfoResponse(this.auth,t,e):null}return st._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new hr(Nt(Sh),e,r);const s=(await Promise.all(t.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let i=s[0]||Nt(Sh);const a=pi(r,e.config.apiKey,e.name);let c=null;for(const h of t)try{const d=await h._get(a);if(d){let g;if(typeof d=="string"){const m=await xi(e,{idToken:d}).catch(()=>{});if(!m)break;g=await st._fromGetAccountInfoResponse(e,m,d)}else g=st._fromJSON(e,d);h!==i&&(c=g),i=h;break}}catch{}const l=s.filter(h=>h._shouldAllowMigration);return!i._shouldAllowMigration||!l.length?new hr(i,e,r):(i=l[0],c&&await i._set(a,c.toJSON()),await Promise.all(t.map(async h=>{if(h!==i)try{await h._remove(a)}catch{}})),new hr(i,e,r))}}function Ph(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(kp(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Sp(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Dp(e))return"Blackberry";if(Vp(e))return"Webos";if(Pp(e))return"Safari";if((e.includes("chrome/")||Cp(e))&&!e.includes("edge/"))return"Chrome";if(Np(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function Sp(n=Me()){return/firefox\//i.test(n)}function Pp(n=Me()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Cp(n=Me()){return/crios\//i.test(n)}function kp(n=Me()){return/iemobile/i.test(n)}function Np(n=Me()){return/android/i.test(n)}function Dp(n=Me()){return/blackberry/i.test(n)}function Vp(n=Me()){return/webos/i.test(n)}function Wc(n=Me()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function RI(n=Me()){return Wc(n)&&!!window.navigator?.standalone}function SI(){return I_()&&document.documentMode===10}function Op(n=Me()){return Wc(n)||Np(n)||Vp(n)||Dp(n)||/windows phone/i.test(n)||kp(n)}function Mp(n,e=[]){let t;switch(n){case"Browser":t=Ph(Me());break;case"Worker":t=`${Ph(Me())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Dr}/${r}`}class PI{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=i=>new Promise((a,c)=>{try{const l=e(i);a(l)}catch(l){c(l)}});r.onAbort=t,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const s of t)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}}async function CI(n,e={}){return xr(n,"GET","/v2/passwordPolicy",zc(n,e))}const kI=6;class NI{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??kI,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),s&&(t.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}class DI{constructor(e,t,r,s){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ch(this),this.idTokenSubscription=new Ch(this),this.beforeStateQueue=new PI(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Tp,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Nt(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await hr.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await xi(this,{idToken:e}),r=await st._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(et(this.app)){const i=this.app.settings.authIdToken;return i?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(i).then(a,a))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let r=t,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const i=this.redirectUser?._redirectEventId,a=r?._redirectEventId,c=await this.tryRedirectSignIn(e);(!i||i===a)&&c?.user&&(r=c.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(i){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(i))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return j(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Fi(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=fI()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(et(this.app))return Promise.reject(Nn(this));const t=e?pe(e):null;return t&&j(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&j(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return et(this.app)?Promise.reject(Nn(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return et(this.app)?Promise.reject(Nn(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Nt(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await CI(this),t=new NI(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Rs("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await bI(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Nt(e)||this._popupRedirectResolver;j(t,this,"argument-error"),this.redirectPersistenceManager=await hr.create(this,[Nt(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,s){if(this._deleted)return()=>{};const i=typeof t=="function"?t:t.next.bind(t);let a=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(j(c,this,"internal-error"),c.then(()=>{a||i(this.currentUser)}),typeof t=="function"){const l=e.addObserver(t,r,s);return()=>{a=!0,l()}}else{const l=e.addObserver(t);return()=>{a=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return j(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Mp(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(et(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&cI(`Error while retrieving App Check token: ${e.error}`),e?.token}}function yo(n){return pe(n)}class Ch{constructor(e){this.auth=e,this.observer=null,this.addObserver=k_(t=>this.observer=t)}get next(){return j(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Gc={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function VI(n){Gc=n}function OI(n){return Gc.loadJS(n)}function MI(){return Gc.gapiScript}function LI(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function xI(n,e){const t=Zi(n,"auth");if(t.isInitialized()){const s=t.getImmediate(),i=t.getOptions();if(On(i,e??{}))return s;At(s,"already-initialized")}return t.initialize({options:e})}function FI(n,e){const t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(Nt);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function UI(n,e,t){const r=yo(n);j(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=Lp(e),{host:a,port:c}=BI(e),l=c===null?"":`:${c}`,h={url:`${i}//${a}${l}/`},d=Object.freeze({host:a,port:c,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){j(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),j(On(h,r.config.emulator)&&On(d,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=h,r.emulatorConfig=d,r.settings.appVerificationDisabledForTesting=!0,pn(a)?(rc(`${i}//${a}${l}`),sc("Auth",!0)):jI()}function Lp(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function BI(n){const e=Lp(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:kh(r.substr(i.length+1))}}else{const[i,a]=r.split(":");return{host:i,port:kh(a)}}}function kh(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function jI(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class xp{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return kt("not implemented")}_getIdTokenResponse(e){return kt("not implemented")}_linkToIdToken(e,t){return kt("not implemented")}_getReauthenticationResolver(e){return kt("not implemented")}}async function fr(n,e){return gI(n,"POST","/v1/accounts:signInWithIdp",zc(n,e))}const qI="http://localhost";class Fn extends xp{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Fn(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):At("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,...i}=t;if(!r||!s)return null;const a=new Fn(r,s);return a.idToken=i.idToken||void 0,a.accessToken=i.accessToken||void 0,a.secret=i.secret,a.nonce=i.nonce,a.pendingToken=i.pendingToken||null,a}_getIdTokenResponse(e){const t=this.buildRequest();return fr(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,fr(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,fr(e,t)}buildRequest(){const e={requestUri:qI,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Ss(t)}return e}}class Kc{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Os extends Kc{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Kt extends Os{constructor(){super("facebook.com")}static credential(e){return Fn._fromParams({providerId:Kt.PROVIDER_ID,signInMethod:Kt.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Kt.credentialFromTaggedObject(e)}static credentialFromError(e){return Kt.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Kt.credential(e.oauthAccessToken)}catch{return null}}}Kt.FACEBOOK_SIGN_IN_METHOD="facebook.com";Kt.PROVIDER_ID="facebook.com";class Pt extends Os{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Fn._fromParams({providerId:Pt.PROVIDER_ID,signInMethod:Pt.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Pt.credentialFromTaggedObject(e)}static credentialFromError(e){return Pt.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return Pt.credential(t,r)}catch{return null}}}Pt.GOOGLE_SIGN_IN_METHOD="google.com";Pt.PROVIDER_ID="google.com";class Qt extends Os{constructor(){super("github.com")}static credential(e){return Fn._fromParams({providerId:Qt.PROVIDER_ID,signInMethod:Qt.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Qt.credentialFromTaggedObject(e)}static credentialFromError(e){return Qt.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Qt.credential(e.oauthAccessToken)}catch{return null}}}Qt.GITHUB_SIGN_IN_METHOD="github.com";Qt.PROVIDER_ID="github.com";class Xt extends Os{constructor(){super("twitter.com")}static credential(e,t){return Fn._fromParams({providerId:Xt.PROVIDER_ID,signInMethod:Xt.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Xt.credentialFromTaggedObject(e)}static credentialFromError(e){return Xt.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return Xt.credential(t,r)}catch{return null}}}Xt.TWITTER_SIGN_IN_METHOD="twitter.com";Xt.PROVIDER_ID="twitter.com";class br{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,s=!1){const i=await st._fromIdTokenResponse(e,r,s),a=Nh(r);return new br({user:i,providerId:a,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const s=Nh(r);return new br({user:e,providerId:s,_tokenResponse:r,operationType:t})}}function Nh(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class Ui extends Rt{constructor(e,t,r,s){super(t.code,t.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,Ui.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,s){return new Ui(e,t,r,s)}}function Fp(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Ui._fromErrorAndOperation(n,i,e,r):i})}async function $I(n,e,t=!1){const r=await ws(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return br._forOperation(n,"link",r)}async function zI(n,e,t=!1){const{auth:r}=n;if(et(r.app))return Promise.reject(Nn(r));const s="reauthenticate";try{const i=await ws(n,Fp(r,s,e,n),t);j(i.idToken,r,"internal-error");const a=Hc(i.idToken);j(a,r,"internal-error");const{sub:c}=a;return j(n.uid===c,r,"user-mismatch"),br._forOperation(n,s,i)}catch(i){throw i?.code==="auth/user-not-found"&&At(r,"user-mismatch"),i}}async function HI(n,e,t=!1){if(et(n.app))return Promise.reject(Nn(n));const r="signIn",s=await Fp(n,r,e),i=await br._fromIdTokenResponse(n,r,s);return t||await n._updateCurrentUser(i.user),i}function WI(n,e,t,r){return pe(n).onIdTokenChanged(e,t,r)}function GI(n,e,t){return pe(n).beforeAuthStateChanged(e,t)}function KI(n,e,t,r){return pe(n).onAuthStateChanged(e,t,r)}function QI(n){return pe(n).signOut()}const Bi="__sak";class Up{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Bi,"1"),this.storage.removeItem(Bi),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const XI=1e3,JI=10;class Bp extends Up{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Op(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),s=this.localCache[t];r!==s&&e(t,s,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((a,c,l)=>{this.notifyListeners(a,l)});return}const r=e.key;t?this.detachListener():this.stopPolling();const s=()=>{const a=this.storage.getItem(r);!t&&this.localCache[r]===a||this.notifyListeners(r,a)},i=this.storage.getItem(r);SI()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,JI):s()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},XI)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Bp.type="LOCAL";const YI=Bp;class jp extends Up{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}jp.type="SESSION";const qp=jp;function ZI(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class vo{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(s=>s.isListeningto(e));if(t)return t;const r=new vo(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:s,data:i}=t.data,a=this.handlersMap[s];if(!a?.size)return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const c=Array.from(a).map(async h=>h(t.origin,i)),l=await ZI(c);t.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:l})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}vo.receivers=[];function Qc(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}class ew{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,a;return new Promise((c,l)=>{const h=Qc("",20);s.port1.start();const d=setTimeout(()=>{l(new Error("unsupported_event"))},r);a={messageChannel:s,onMessage(g){const m=g;if(m.data.eventId===h)switch(m.data.status){case"ack":clearTimeout(d),i=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),c(m.data.response);break;default:clearTimeout(d),clearTimeout(i),l(new Error("invalid_response"));break}}},this.handlers.add(a),s.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:h,data:t},[s.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}function Et(){return window}function tw(n){Et().location.href=n}function $p(){return typeof Et().WorkerGlobalScope<"u"&&typeof Et().importScripts=="function"}async function nw(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function rw(){return navigator?.serviceWorker?.controller||null}function sw(){return $p()?self:null}const zp="firebaseLocalStorageDb",iw=1,ji="firebaseLocalStorage",Hp="fbase_key";class Ms{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Eo(n,e){return n.transaction([ji],e?"readwrite":"readonly").objectStore(ji)}function ow(){const n=indexedDB.deleteDatabase(zp);return new Ms(n).toPromise()}function ja(){const n=indexedDB.open(zp,iw);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(ji,{keyPath:Hp})}catch(s){t(s)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(ji)?e(r):(r.close(),await ow(),e(await ja()))})})}async function Dh(n,e,t){const r=Eo(n,!0).put({[Hp]:e,value:t});return new Ms(r).toPromise()}async function aw(n,e){const t=Eo(n,!1).get(e),r=await new Ms(t).toPromise();return r===void 0?null:r.value}function Vh(n,e){const t=Eo(n,!0).delete(e);return new Ms(t).toPromise()}const cw=800,uw=3;class Wp{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await ja(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>uw)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return $p()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=vo._getInstance(sw()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await nw(),!this.activeServiceWorker)return;this.sender=new ew(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||rw()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await ja();return await Dh(e,Bi,"1"),await Vh(e,Bi),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>Dh(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>aw(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Vh(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=Eo(s,!1).getAll();return new Ms(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),t.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),t.push(s));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),cw)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Wp.type="LOCAL";const lw=Wp;new Vs(3e4,6e4);function Gp(n,e){return e?Nt(e):(j(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class Xc extends xp{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return fr(e,this._buildIdpRequest())}_linkToIdToken(e,t){return fr(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return fr(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function hw(n){return HI(n.auth,new Xc(n),n.bypassAuthState)}function fw(n){const{auth:e,user:t}=n;return j(t,e,"internal-error"),zI(t,new Xc(n),n.bypassAuthState)}async function dw(n){const{auth:e,user:t}=n;return j(t,e,"internal-error"),$I(t,new Xc(n),n.bypassAuthState)}class Kp{constructor(e,t,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:s,tenantId:i,error:a,type:c}=e;if(a){this.reject(a);return}const l={auth:this.auth,requestUri:t,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(l))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return hw;case"linkViaPopup":case"linkViaRedirect":return dw;case"reauthViaPopup":case"reauthViaRedirect":return fw;default:At(this.auth,"internal-error")}}resolve(e){Lt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Lt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const pw=new Vs(2e3,1e4);async function mw(n,e,t){if(et(n.app))return Promise.reject(ot(n,"operation-not-supported-in-this-environment"));const r=yo(n);uI(n,e,Kc);const s=Gp(r,t);return new bn(r,"signInViaPopup",e,s).executeNotNull()}class bn extends Kp{constructor(e,t,r,s,i){super(e,t,s,i),this.provider=r,this.authWindow=null,this.pollId=null,bn.currentPopupAction&&bn.currentPopupAction.cancel(),bn.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return j(e,this.auth,"internal-error"),e}async onExecution(){Lt(this.filter.length===1,"Popup operations only handle one event");const e=Qc();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(ot(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(ot(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,bn.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ot(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,pw.get())};e()}}bn.currentPopupAction=null;const gw="pendingRedirect",mi=new Map;class _w extends Kp{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=mi.get(this.auth._key());if(!e){try{const r=await yw(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}mi.set(this.auth._key(),e)}return this.bypassAuthState||mi.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function yw(n,e){const t=Tw(e),r=Ew(n);if(!await r._isAvailable())return!1;const s=await r._get(t)==="true";return await r._remove(t),s}function vw(n,e){mi.set(n._key(),e)}function Ew(n){return Nt(n._redirectPersistence)}function Tw(n){return pi(gw,n.config.apiKey,n.name)}async function Iw(n,e,t=!1){if(et(n.app))return Promise.reject(Nn(n));const r=yo(n),s=Gp(r,e),a=await new _w(r,s,t).execute();return a&&!t&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,e)),a}const ww=600*1e3;class Aw{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!bw(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!Qp(e)){const r=e.error.code?.split("auth/")[1]||"internal-error";t.onError(ot(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=ww&&this.cachedEventUids.clear(),this.cachedEventUids.has(Oh(e))}saveEventToCache(e){this.cachedEventUids.add(Oh(e)),this.lastProcessedEventTime=Date.now()}}function Oh(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function Qp({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function bw(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Qp(n);default:return!1}}async function Rw(n,e={}){return xr(n,"GET","/v1/projects",e)}const Sw=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Pw=/^https?/;async function Cw(n){if(n.config.emulator)return;const{authorizedDomains:e}=await Rw(n);for(const t of e)try{if(kw(t))return}catch{}At(n,"unauthorized-domain")}function kw(n){const e=Ua(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const a=new URL(n);return a.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&a.hostname===r}if(!Pw.test(t))return!1;if(Sw.test(n))return r===n;const s=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}const Nw=new Vs(3e4,6e4);function Mh(){const n=Et().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function Dw(n){return new Promise((e,t)=>{function r(){Mh(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Mh(),t(ot(n,"network-request-failed"))},timeout:Nw.get()})}if(Et().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Et().gapi?.load)r();else{const s=LI("iframefcb");return Et()[s]=()=>{gapi.load?r():t(ot(n,"network-request-failed"))},OI(`${MI()}?onload=${s}`).catch(i=>t(i))}}).catch(e=>{throw gi=null,e})}let gi=null;function Vw(n){return gi=gi||Dw(n),gi}const Ow=new Vs(5e3,15e3),Mw="__/auth/iframe",Lw="emulator/auth/iframe",xw={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Fw=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Uw(n){const e=n.config;j(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?$c(e,Lw):`https://${n.config.authDomain}/${Mw}`,r={apiKey:e.apiKey,appName:n.name,v:Dr},s=Fw.get(n.config.apiHost);s&&(r.eid=s);const i=n._getFrameworks();return i.length&&(r.fw=i.join(",")),`${t}?${Ss(r).slice(1)}`}async function Bw(n){const e=await Vw(n),t=Et().gapi;return j(t,n,"internal-error"),e.open({where:document.body,url:Uw(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:xw,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const a=ot(n,"network-request-failed"),c=Et().setTimeout(()=>{i(a)},Ow.get());function l(){Et().clearTimeout(c),s(r)}r.ping(l).then(l,()=>{i(a)})}))}const jw={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},qw=500,$w=600,zw="_blank",Hw="http://localhost";class Lh{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function Ww(n,e,t,r=qw,s=$w){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let c="";const l={...jw,width:r.toString(),height:s.toString(),top:i,left:a},h=Me().toLowerCase();t&&(c=Cp(h)?zw:t),Sp(h)&&(e=e||Hw,l.scrollbars="yes");const d=Object.entries(l).reduce((m,[T,S])=>`${m}${T}=${S},`,"");if(RI(h)&&c!=="_self")return Gw(e||"",c),new Lh(null);const g=window.open(e||"",c,d);j(g,n,"popup-blocked");try{g.focus()}catch{}return new Lh(g)}function Gw(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}const Kw="__/auth/handler",Qw="emulator/auth/handler",Xw=encodeURIComponent("fac");async function xh(n,e,t,r,s,i){j(n.config.authDomain,n,"auth-domain-config-required"),j(n.config.apiKey,n,"invalid-api-key");const a={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Dr,eventId:s};if(e instanceof Kc){e.setDefaultLanguage(n.languageCode),a.providerId=e.providerId||"",C_(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,g]of Object.entries({}))a[d]=g}if(e instanceof Os){const d=e.getScopes().filter(g=>g!=="");d.length>0&&(a.scopes=d.join(","))}n.tenantId&&(a.tid=n.tenantId);const c=a;for(const d of Object.keys(c))c[d]===void 0&&delete c[d];const l=await n._getAppCheckToken(),h=l?`#${Xw}=${encodeURIComponent(l)}`:"";return`${Jw(n)}?${Ss(c).slice(1)}${h}`}function Jw({config:n}){return n.emulator?$c(n,Qw):`https://${n.authDomain}/${Kw}`}const oa="webStorageSupport";class Yw{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=qp,this._completeRedirectFn=Iw,this._overrideRedirectResult=vw}async _openPopup(e,t,r,s){Lt(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const i=await xh(e,t,r,Ua(),s);return Ww(e,i,Qc())}async _openRedirect(e,t,r,s){await this._originValidation(e);const i=await xh(e,t,r,Ua(),s);return tw(i),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:s,promise:i}=this.eventManagers[t];return s?Promise.resolve(s):(Lt(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await Bw(e),r=new Aw(e);return t.register("authEvent",s=>(j(s?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(oa,{type:oa},s=>{const i=s?.[0]?.[oa];i!==void 0&&t(!!i),At(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=Cw(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Op()||Pp()||Wc()}}const Zw=Yw;var Fh="@firebase/auth",Uh="1.11.1";class eA{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){j(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function tA(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function nA(n){Mn(new an("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:a,authDomain:c}=r.options;j(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:a,authDomain:c,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Mp(n)},h=new DI(r,s,i,l);return FI(h,t),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Mn(new an("auth-internal",e=>{const t=yo(e.getProvider("auth").getImmediate());return(r=>new eA(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),mt(Fh,Uh,tA(n)),mt(Fh,Uh,"esm2020")}const rA=300,sA=Bf("authIdTokenMaxAge")||rA;let Bh=null;const iA=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>sA)return;const s=t?.token;Bh!==s&&(Bh=s,await fetch(n,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function oA(n=ac()){const e=Zi(n,"auth");if(e.isInitialized())return e.getImmediate();const t=xI(n,{popupRedirectResolver:Zw,persistence:[lw,YI,qp]}),r=Bf("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const a=iA(i.toString());GI(t,a,()=>a(t.currentUser)),WI(t,c=>a(c))}}const s=xf("auth");return s&&UI(t,`http://${s}`),t}function aA(){return document.getElementsByTagName("head")?.[0]??document}VI({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=s=>{const i=ot("internal-error");i.customData=s,t(i)},r.type="text/javascript",r.charset="UTF-8",aA().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});nA("Browser");const cA={apiKey:"AIzaSyBC5VHNEcVL9KP8M0d64ZajF6P4Hzqzafc",authDomain:"bbnme-58716.firebaseapp.com",projectId:"bbnme-58716",storageBucket:"bbnme-58716.appspot.com",messagingSenderId:"155088179379",appId:"1:155088179379:web:5d98445c178b7513f520c6"},Jc=$f(cA),qi=qT(Jc),Yc=oA(Jc),uA=new Pt,Zc=Df(null),Xp=Df(!0);KI(Yc,n=>{Zc.set(n),Xp.set(!1)});var lA=Le('<button class="svelte-18sv61c"> </button>');function Rr(n,e){let t=Pn(e,"label",8,"Button"),r=Pn(e,"onClick",8,()=>{});var s=lA(),i=Ae(s);Ei(()=>nc(i,t())),tc("click",s,function(...a){r()?.apply(this,a)}),ge(n,s)}var hA=Le('<div class="login-container svelte-8ukb9p"><h2>Please sign in to continue</h2> <!></div>');function fA(n,e){Bn(e,!1),Nr();var t=hA(),r=_e(Ae(t),2);Rr(r,{label:"Sign in with Google",onClick:()=>mw(Yc,uA)}),ge(n,t),jn()}var dA=Le('<span class="not-authorized-message svelte-rfuq4y">Unauthorized user</span>'),pA=Le('<div class="user-section svelte-rfuq4y"><div class="user-info svelte-rfuq4y"><img alt="Profile" class="svelte-rfuq4y"/> <span> </span></div> <!></div> <!>',1),mA=Le('<nav class="svelte-rfuq4y"><!></nav>');function gA(n,e){Bn(e,!1);const t=()=>ga(Zc,"$user",r),[r,s]=Vf();let i=Pn(e,"isAuthorizedToWrite",8);Nr();var a=mA(),c=Ae(a);{var l=h=>{var d=pA(),g=ir(d),m=Ae(g),T=Ae(m),S=_e(T,2),C=Ae(S),P=_e(m,2);{var L=V=>{var H=dA();ge(V,H)};Ct(P,V=>{i()||V(L)})}var O=_e(g,2);Rr(O,{label:"Sign out",onClick:()=>QI(Yc)}),Ei(()=>{oi(T,"src",(t(),$e(()=>t().photoURL))),nc(C,(t(),$e(()=>t().displayName)))}),ge(h,d)};Ct(c,h=>{t()&&h(l)})}ge(n,a),jn(),s()}var _A=Le('<form class="svelte-7mtrh0"><h2>Add a new place</h2> <input type="text" placeholder="Place name" required class="svelte-7mtrh0"/> <input type="url" placeholder="Website" class="svelte-7mtrh0"/> <input type="url" placeholder="Image URL" class="svelte-7mtrh0"/> <button type="submit" class="svelte-7mtrh0">Add Place</button></form>');function yA(n,e){Bn(e,!1);let t=nt(""),r=nt(""),s=nt("");async function i(){try{const d=await sI(up(qi,"places"),{name:U(t),website:U(r),image:U(s)});console.log("Document written with ID: ",d.id),Z(t,""),Z(r,""),Z(s,"")}catch(d){console.error("Error adding document: ",d)}}Nr();var a=_A(),c=_e(Ae(a),2),l=_e(c,2),h=_e(l,2);ar(c,()=>U(t),d=>Z(t,d)),ar(l,()=>U(r),d=>Z(r,d)),ar(h,()=>U(s),d=>Z(s,d)),tc("submit",a,kf(i)),ge(n,a),jn()}var vA=Le('<div class="card svelte-1udyrqm"><!></div>');function _i(n,e){var t=vA(),r=Ae(t);Qg(r,e,"default",{}),ge(n,t)}var EA=Le('<form class="svelte-136zmjt"><h2>Edit Place</h2> <input type="text" placeholder="Place name" required class="svelte-136zmjt"/> <input type="url" placeholder="Website" class="svelte-136zmjt"/> <input type="url" placeholder="Image URL" class="svelte-136zmjt"/> <div class="actions svelte-136zmjt"><!> <!></div></form>');function TA(n,e){Bn(e,!1);let t=Pn(e,"place",8),r=Pn(e,"onSave",8,()=>{}),s=Pn(e,"onCancel",8,()=>{}),i=nt(t().name),a=nt(t().website),c=nt(t().image);async function l(){try{const P=Mc(qi,"places",t().id);await nI(P,{name:U(i),website:U(a),image:U(c)}),console.log("Document successfully updated!"),r()()}catch(P){console.error("Error updating document: ",P)}}Nr();var h=EA(),d=_e(Ae(h),2),g=_e(d,2),m=_e(g,2),T=_e(m,2),S=Ae(T);Rr(S,{label:"Save",type:"submit"});var C=_e(S,2);Rr(C,{label:"Cancel",get onClick(){return s()}}),ar(d,()=>U(i),P=>Z(i,P)),ar(g,()=>U(a),P=>Z(a,P)),ar(m,()=>U(c),P=>Z(c,P)),tc("submit",h,kf(l)),ge(n,h),jn()}var IA=Le('<a target="_blank" rel="noreferrer"><img class="svelte-13geuu4"/></a>'),wA=Le('<div class="actions svelte-13geuu4"><!> <!></div>'),AA=Le("<h3><b> </b></h3> <!> <!>",1),bA=Le('<div class="svelte-13geuu4"><h2>Travel Wishlist</h2> <!></div>');function RA(n,e){Bn(e,!1);let t=Pn(e,"isAuthorizedToWrite",8),r=nt([]),s=nt(null);n_(()=>{const g=iI(up(qi,"places"),m=>{Z(r,m.docs.map(T=>({id:T.id,...T.data()})))});return()=>g()});async function i(g){try{await rI(Mc(qi,"places",g)),console.log("Document successfully deleted!")}catch(m){console.error("Error removing document: ",m)}}function a(g){Z(s,g)}function c(){Z(s,null)}function l(){Z(s,null)}Nr();var h=bA(),d=_e(Ae(h),2);Gg(d,1,()=>U(r),Hg,(g,m)=>{_i(g,{children:(T,S)=>{var C=pa(),P=ir(C);{var L=V=>{TA(V,{get place(){return U(s)},onSave:c,onCancel:l})},O=V=>{var H=AA(),Y=ir(H),te=Ae(Y),I=Ae(te),_=_e(Y,2);{var v=A=>{var y=IA(),re=Ae(y);Ei(()=>{oi(y,"href",(U(m),$e(()=>U(m).website))),oi(re,"src",(U(m),$e(()=>U(m).image))),oi(re,"alt",(U(m),$e(()=>U(m).name)))}),ge(A,y)};Ct(_,A=>{U(m),$e(()=>U(m).image)&&A(v)})}var w=_e(_,2);{var E=A=>{var y=wA(),re=Ae(y);Rr(re,{label:"Edit",onClick:()=>a(U(m))});var xe=_e(re,2);Rr(xe,{label:"Delete",onClick:()=>i(U(m).id)}),ge(A,y)};Ct(w,A=>{t()&&A(E)})}Ei(()=>nc(I,(U(m),$e(()=>U(m).name)))),ge(V,H)};Ct(P,V=>{U(s),U(m),$e(()=>U(s)&&U(s).id===U(m).id)?V(L):V(O,!1)})}ge(T,C)},$$slots:{default:!0}})}),ge(n,h),jn()}const SA="type.googleapis.com/google.protobuf.Int64Value",PA="type.googleapis.com/google.protobuf.UInt64Value";function Jp(n,e){const t={};for(const r in n)n.hasOwnProperty(r)&&(t[r]=e(n[r]));return t}function $i(n){if(n==null)return null;if(n instanceof Number&&(n=n.valueOf()),typeof n=="number"&&isFinite(n)||n===!0||n===!1||Object.prototype.toString.call(n)==="[object String]")return n;if(n instanceof Date)return n.toISOString();if(Array.isArray(n))return n.map(e=>$i(e));if(typeof n=="function"||typeof n=="object")return Jp(n,e=>$i(e));throw new Error("Data cannot be encoded in JSON: "+n)}function Sr(n){if(n==null)return n;if(n["@type"])switch(n["@type"]){case SA:case PA:{const e=Number(n.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+n);return e}default:throw new Error("Data cannot be decoded from JSON: "+n)}return Array.isArray(n)?n.map(e=>Sr(e)):typeof n=="function"||typeof n=="object"?Jp(n,e=>Sr(e)):n}const eu="functions";const jh={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class We extends Rt{constructor(e,t,r){super(`${eu}/${e}`,t||""),this.details=r,Object.setPrototypeOf(this,We.prototype)}}function CA(n){if(n>=200&&n<300)return"ok";switch(n){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function zi(n,e){let t=CA(n),r=t,s;try{const i=e&&e.error;if(i){const a=i.status;if(typeof a=="string"){if(!jh[a])return new We("internal","internal");t=jh[a],r=a}const c=i.message;typeof c=="string"&&(r=c),s=i.details,s!==void 0&&(s=Sr(s))}}catch{}return t==="ok"?null:new We(t,r,s)}class kA{constructor(e,t,r,s){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,et(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=t.getImmediate({optional:!0}),this.messaging=r.getImmediate({optional:!0}),this.auth||t.get().then(i=>this.auth=i,()=>{}),this.messaging||r.get().then(i=>this.messaging=i,()=>{}),this.appCheck||s?.get().then(i=>this.appCheck=i,()=>{})}async getAuthToken(){if(this.auth)try{return(await this.auth.getToken())?.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){const t=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return t.error?null:t.token}return null}async getContext(e){const t=await this.getAuthToken(),r=await this.getMessagingToken(),s=await this.getAppCheckToken(e);return{authToken:t,messagingToken:r,appCheckToken:s}}}const qa="us-central1",NA=/^data: (.*?)(?:\n|$)/;function DA(n){let e=null;return{promise:new Promise((t,r)=>{e=setTimeout(()=>{r(new We("deadline-exceeded","deadline-exceeded"))},n)}),cancel:()=>{e&&clearTimeout(e)}}}class VA{constructor(e,t,r,s,i=qa,a=(...c)=>fetch(...c)){this.app=e,this.fetchImpl=a,this.emulatorOrigin=null,this.contextProvider=new kA(e,t,r,s),this.cancelAllRequests=new Promise(c=>{this.deleteService=()=>Promise.resolve(c())});try{const c=new URL(i);this.customDomain=c.origin+(c.pathname==="/"?"":c.pathname),this.region=qa}catch{this.customDomain=null,this.region=i}}_delete(){return this.deleteService()}_url(e){const t=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${t}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${t}.cloudfunctions.net/${e}`}}function OA(n,e,t){const r=pn(e);n.emulatorOrigin=`http${r?"s":""}://${e}:${t}`,r&&(rc(n.emulatorOrigin+"/backends"),sc("Functions",!0))}function MA(n,e,t){const r=s=>xA(n,e,s,{});return r.stream=(s,i)=>UA(n,e,s,i),r}function Yp(n){return n.emulatorOrigin&&pn(n.emulatorOrigin)?"include":void 0}async function LA(n,e,t,r,s){t["Content-Type"]="application/json";let i;try{i=await r(n,{method:"POST",body:JSON.stringify(e),headers:t,credentials:Yp(s)})}catch{return{status:0,json:null}}let a=null;try{a=await i.json()}catch{}return{status:i.status,json:a}}async function Zp(n,e){const t={},r=await n.contextProvider.getContext(e.limitedUseAppCheckTokens);return r.authToken&&(t.Authorization="Bearer "+r.authToken),r.messagingToken&&(t["Firebase-Instance-ID-Token"]=r.messagingToken),r.appCheckToken!==null&&(t["X-Firebase-AppCheck"]=r.appCheckToken),t}function xA(n,e,t,r){const s=n._url(e);return FA(n,s,t,r)}async function FA(n,e,t,r){t=$i(t);const s={data:t},i=await Zp(n,r),a=r.timeout||7e4,c=DA(a),l=await Promise.race([LA(e,s,i,n.fetchImpl,n),c.promise,n.cancelAllRequests]);if(c.cancel(),!l)throw new We("cancelled","Firebase Functions instance was deleted.");const h=zi(l.status,l.json);if(h)throw h;if(!l.json)throw new We("internal","Response is not valid JSON object.");let d=l.json.data;if(typeof d>"u"&&(d=l.json.result),typeof d>"u")throw new We("internal","Response is missing data field.");return{data:Sr(d)}}function UA(n,e,t,r){const s=n._url(e);return BA(n,s,t,r||{})}async function BA(n,e,t,r){t=$i(t);const s={data:t},i=await Zp(n,r);i["Content-Type"]="application/json",i.Accept="text/event-stream";let a;try{a=await n.fetchImpl(e,{method:"POST",body:JSON.stringify(s),headers:i,signal:r?.signal,credentials:Yp(n)})}catch(m){if(m instanceof Error&&m.name==="AbortError"){const S=new We("cancelled","Request was cancelled.");return{data:Promise.reject(S),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(S)}}}}}}const T=zi(0,null);return{data:Promise.reject(T),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(T)}}}}}}let c,l;const h=new Promise((m,T)=>{c=m,l=T});r?.signal?.addEventListener("abort",()=>{const m=new We("cancelled","Request was cancelled.");l(m)});const d=a.body.getReader(),g=jA(d,c,l,r?.signal);return{stream:{[Symbol.asyncIterator](){const m=g.getReader();return{async next(){const{value:T,done:S}=await m.read();return{value:T,done:S}},async return(){return await m.cancel(),{done:!0,value:void 0}}}}},data:h}}function jA(n,e,t,r){const s=(a,c)=>{const l=a.match(NA);if(!l)return;const h=l[1];try{const d=JSON.parse(h);if("result"in d){e(Sr(d.result));return}if("message"in d){c.enqueue(Sr(d.message));return}if("error"in d){const g=zi(0,d);c.error(g),t(g);return}}catch(d){if(d instanceof We){c.error(d),t(d);return}}},i=new TextDecoder;return new ReadableStream({start(a){let c="";return l();async function l(){if(r?.aborted){const h=new We("cancelled","Request was cancelled");return a.error(h),t(h),Promise.resolve()}try{const{value:h,done:d}=await n.read();if(d){c.trim()&&s(c.trim(),a),a.close();return}if(r?.aborted){const m=new We("cancelled","Request was cancelled");a.error(m),t(m),await n.cancel();return}c+=i.decode(h,{stream:!0});const g=c.split(`
`);c=g.pop()||"";for(const m of g)m.trim()&&s(m.trim(),a);return l()}catch(h){const d=h instanceof We?h:zi(0,null);a.error(d),t(d)}}},cancel(){return n.cancel()}})}const qh="@firebase/functions",$h="0.13.1";const qA="auth-internal",$A="app-check-internal",zA="messaging-internal";function HA(n){const e=(t,{instanceIdentifier:r})=>{const s=t.getProvider("app").getImmediate(),i=t.getProvider(qA),a=t.getProvider(zA),c=t.getProvider($A);return new VA(s,i,a,c,r)};Mn(new an(eu,e,"PUBLIC").setMultipleInstances(!0)),mt(qh,$h,n),mt(qh,$h,"esm2020")}function WA(n=ac(),e=qa){const r=Zi(pe(n),eu).getImmediate({identifier:e}),s=Ff("functions");return s&&GA(r,...s),r}function GA(n,e,t){OA(pe(n),e,t)}function KA(n,e,t){return MA(pe(n),e)}HA();var QA=Le("<p>Loading application...</p>"),XA=Le("<p>Checking authorization...</p>"),JA=Le('<!> <div class="container svelte-1n46o8q"><h1>Clean Girl Travel Wishlist</h1> <!> <!></div>',1),YA=Le("<main><!></main>");function ZA(n,e){Bn(e,!1);const t=()=>ga(Xp,"$authLoading",s),r=()=>ga(Zc,"$user",s),[s,i]=Vf(),a=WA(Jc),c=KA(a,"checkAuthorization");let l=nt(!1),h=nt(!1);bg(()=>(t(),r()),()=>{!t()&&r()?c().then(S=>{Z(l,S.data.status==="authorized"),Z(h,!0)}).catch(S=>{console.error("Error checking authorization:",S),Z(l,!1),Z(h,!0)}):!t()&&!r()?(Z(l,!1),Z(h,!0)):(Z(l,!1),Z(h,!1))}),Rg(),Nr();var d=YA(),g=Ae(d);{var m=S=>{_i(S,{children:(C,P)=>{var L=QA();ge(C,L)},$$slots:{default:!0}})},T=S=>{var C=pa(),P=ir(C);{var L=V=>{var H=JA(),Y=ir(H);gA(Y,{get isAuthorizedToWrite(){return U(l)}});var te=_e(Y,2),I=_e(Ae(te),2);{var _=E=>{var A=pa(),y=ir(A);{var re=xe=>{_i(xe,{children:(To,tu)=>{yA(To,{})},$$slots:{default:!0}})};Ct(y,xe=>{U(l)&&xe(re)})}ge(E,A)},v=E=>{_i(E,{children:(A,y)=>{var re=XA();ge(A,re)},$$slots:{default:!0}})};Ct(I,E=>{U(h)?E(_):E(v,!1)})}var w=_e(I,2);RA(w,{get isAuthorizedToWrite(){return U(l)}}),ge(V,H)},O=V=>{fA(V,{})};Ct(P,V=>{r()?V(L):V(O,!1)},!0)}ge(S,C)};Ct(g,S=>{t()?S(m):S(T,!1)})}ge(n,d),jn(),i()}jg(ZA,{target:document.getElementById("app")});
