(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();const sf=!1;var ic=Array.isArray,Hm=Array.prototype.indexOf,oc=Array.from,of=Object.defineProperty,mr=Object.getOwnPropertyDescriptor,af=Object.getOwnPropertyDescriptors,Wm=Object.prototype,Gm=Array.prototype,ac=Object.getPrototypeOf,gl=Object.isExtensible;const gr=()=>{};function Km(n){return n()}function Ia(n){for(var e=0;e<n.length;e++)n[e]()}function cf(){var n,e,t=new Promise((r,s)=>{n=r,e=s});return{promise:t,resolve:n,reject:e}}const xe=2,cc=4,no=8,zt=16,Ht=32,Yn=64,ro=128,dt=512,Pe=1024,Qe=2048,Dt=4096,et=8192,an=16384,uc=32768,Sr=65536,_l=1<<17,uf=1<<18,Ur=1<<19,lf=1<<20,bs=32768,Aa=1<<21,lc=1<<22,cn=1<<23,_r=Symbol("$state"),Qm=Symbol("legacy props"),Xm=Symbol(""),dr=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function hc(n){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function Jm(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function Ym(n){throw new Error("https://svelte.dev/e/effect_in_teardown")}function Zm(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function eg(n){throw new Error("https://svelte.dev/e/effect_orphan")}function tg(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function ng(n){throw new Error("https://svelte.dev/e/props_invalid_value")}function rg(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function sg(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function ig(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function og(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const ag=1,cg=2,ug=16,lg=1,hg=2,fg=4,dg=8,pg=16,mg=1,gg=2,Oe=Symbol(),_g="http://www.w3.org/1999/xhtml";function yg(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}let vg=!1;function hf(n){return n===this.v}function ff(n,e){return n!=n?e==e:n!==e||n!==null&&typeof n=="object"||typeof n=="function"}function df(n){return!ff(n,this.v)}let Br=!1,Eg=!1;function Tg(){Br=!0}let ie=null;function Rr(n){ie=n}function Ss(n){return pf().get(n)}function ba(n,e){return pf().set(n,e),e}function tt(n,e=!1,t){ie={p:ie,i:!1,c:null,e:null,s:n,x:null,l:Br&&!e?{s:null,u:null,$:[]}:null}}function nt(n){var e=ie,t=e.e;if(t!==null){e.e=null;for(var r of t)Cf(r)}return e.i=!0,ie=e.p,{}}function Fs(){return!Br||ie!==null&&ie.l===null}function pf(n){return ie===null&&hc(),ie.c??=new Map(wg(ie)||void 0)}function wg(n){let e=n.p;for(;e!==null;){const t=e.c;if(t!==null)return t;e=e.p}return null}let Mn=[];function mf(){var n=Mn;Mn=[],Ia(n)}function so(n){if(Mn.length===0&&!_s){var e=Mn;queueMicrotask(()=>{e===Mn&&mf()})}Mn.push(n)}function Ig(){for(;Mn.length>0;)mf()}function gf(n){var e=Z;if(e===null)return Y.f|=cn,n;if((e.f&uc)===0){if((e.f&ro)===0)throw n;e.b.error(n)}else Pr(n,e)}function Pr(n,e){for(;e!==null;){if((e.f&ro)!==0)try{e.b.error(n);return}catch(t){n=t}e=e.parent}throw n}const hi=new Set;let ae=null,vi=null,Ye=null,vt=[],io=null,Sa=!1,_s=!1;class Et{committed=!1;current=new Map;previous=new Map;#e=new Set;#t=new Set;#n=0;#r=0;#c=null;#o=[];#a=[];skipped_effects=new Set;is_fork=!1;process(e){vt=[],vi=null,this.apply();var t={parent:null,effect:null,effects:[],render_effects:[],block_effects:[]};for(const r of e)this.#s(r,t);this.is_fork||this.#u(),this.#r>0||this.is_fork?(this.#i(t.effects),this.#i(t.render_effects),this.#i(t.block_effects)):(vi=this,ae=null,yl(t.render_effects),yl(t.effects),vi=null,this.#c?.resolve()),Ye=null}#s(e,t){e.f^=Pe;for(var r=e.first;r!==null;){var s=r.f,i=(s&(Ht|Yn))!==0,a=i&&(s&Pe)!==0,c=a||(s&et)!==0||this.skipped_effects.has(r);if((r.f&ro)!==0&&r.b?.is_pending()&&(t={parent:t,effect:r,effects:[],render_effects:[],block_effects:[]}),!c&&r.fn!==null){i?r.f^=Pe:(s&cc)!==0?t.effects.push(r):qr(r)&&((r.f&zt)!==0&&t.block_effects.push(r),Cr(r));var l=r.first;if(l!==null){r=l;continue}}var h=r.parent;for(r=r.next;r===null&&h!==null;)h===t.effect&&(this.#i(t.effects),this.#i(t.render_effects),this.#i(t.block_effects),t=t.parent),r=h.next,h=h.parent}}#i(e){for(const t of e)((t.f&Qe)!==0?this.#o:this.#a).push(t),Ce(t,Pe)}capture(e,t){this.previous.has(e)||this.previous.set(e,t),(e.f&cn)===0&&(this.current.set(e,e.v),Ye?.set(e,e.v))}activate(){ae=this,this.apply()}deactivate(){ae=null,Ye=null}flush(){if(this.activate(),vt.length>0){if(_f(),ae!==null&&ae!==this)return}else this.#n===0&&this.process([]);this.deactivate()}discard(){for(const e of this.#t)e(this);this.#t.clear()}#u(){if(this.#r===0){for(const e of this.#e)e();this.#e.clear()}this.#n===0&&this.#l()}#l(){if(hi.size>1){this.previous.clear();var e=Ye,t=!0,r={parent:null,effect:null,effects:[],render_effects:[],block_effects:[]};for(const s of hi){if(s===this){t=!1;continue}const i=[];for(const[c,l]of this.current){if(s.current.has(c))if(t&&l!==s.current.get(c))s.current.set(c,l);else continue;i.push(c)}if(i.length===0)continue;const a=[...s.current.keys()].filter(c=>!this.current.has(c));if(a.length>0){const c=new Set,l=new Map;for(const h of i)yf(h,a,c,l);if(vt.length>0){ae=s,s.apply();for(const h of vt)s.#s(h,r);vt=[],s.deactivate()}}}ae=null,Ye=e}this.committed=!0,hi.delete(this)}increment(e){this.#n+=1,e&&(this.#r+=1)}decrement(e){this.#n-=1,e&&(this.#r-=1),this.revive()}revive(){for(const e of this.#o)Ce(e,Qe),zn(e);for(const e of this.#a)Ce(e,Dt),zn(e);this.#o=[],this.#a=[],this.flush()}oncommit(e){this.#e.add(e)}ondiscard(e){this.#t.add(e)}settled(){return(this.#c??=cf()).promise}static ensure(){if(ae===null){const e=ae=new Et;hi.add(ae),_s||Et.enqueue(()=>{ae===e&&e.flush()})}return ae}static enqueue(e){so(e)}apply(){}}function Ag(n){var e=_s;_s=!0;try{for(var t;;){if(Ig(),vt.length===0&&(ae?.flush(),vt.length===0))return io=null,t;_f()}}finally{_s=e}}function _f(){var n=Un;Sa=!0;try{var e=0;for(El(!0);vt.length>0;){var t=Et.ensure();if(e++>1e3){var r,s;bg()}t.process(vt),un.clear()}}finally{Sa=!1,El(n),io=null}}function bg(){try{tg()}catch(n){Pr(n,io)}}let Ot=null;function yl(n){var e=n.length;if(e!==0){for(var t=0;t<e;){var r=n[t++];if((r.f&(an|et))===0&&qr(r)&&(Ot=new Set,Cr(r),r.deps===null&&r.first===null&&r.nodes_start===null&&(r.teardown===null&&r.ac===null?Df(r):r.fn=null),Ot?.size>0)){un.clear();for(const s of Ot){if((s.f&(an|et))!==0)continue;const i=[s];let a=s.parent;for(;a!==null;)Ot.has(a)&&(Ot.delete(a),i.push(a)),a=a.parent;for(let c=i.length-1;c>=0;c--){const l=i[c];(l.f&(an|et))===0&&Cr(l)}}Ot.clear()}}Ot=null}}function yf(n,e,t,r){if(!t.has(n)&&(t.add(n),n.reactions!==null))for(const s of n.reactions){const i=s.f;(i&xe)!==0?yf(s,e,t,r):(i&(lc|zt))!==0&&(i&Qe)===0&&vf(s,e,r)&&(Ce(s,Qe),zn(s))}}function vf(n,e,t){const r=t.get(n);if(r!==void 0)return r;if(n.deps!==null)for(const s of n.deps){if(e.includes(s))return!0;if((s.f&xe)!==0&&vf(s,e,t))return t.set(s,!0),!0}return t.set(n,!1),!1}function zn(n){for(var e=io=n;e.parent!==null;){e=e.parent;var t=e.f;if(Sa&&e===Z&&(t&zt)!==0&&(t&uf)===0)return;if((t&(Yn|Ht))!==0){if((t&Pe)===0)return;e.f^=Pe}}vt.push(e)}function Sg(n){let e=0,t=Hn(0),r;return()=>{co()&&(x(t),uo(()=>(e===0&&(r=je(()=>n(()=>ys(t)))),e+=1,()=>{so(()=>{e-=1,e===0&&(r?.(),r=void 0,ys(t))})})))}}var Rg=Sr|Ur|ro;function Pg(n,e,t){new Cg(n,e,t)}class Cg{parent;#e=!1;#t;#n=null;#r;#c;#o;#a=null;#s=null;#i=null;#u=null;#l=null;#d=0;#h=0;#p=!1;#f=null;#v=Sg(()=>(this.#f=Hn(this.#d),()=>{this.#f=null}));constructor(e,t,r){this.#t=e,this.#r=t,this.#c=r,this.parent=Z.b,this.#e=!!this.#r.pending,this.#o=mc(()=>{Z.b=this;{var s=this.#_();try{this.#a=ct(()=>r(s))}catch(i){this.error(i)}this.#h>0?this.#g():this.#e=!1}return()=>{this.#l?.remove()}},Rg)}#E(){try{this.#a=ct(()=>this.#c(this.#t))}catch(e){this.error(e)}this.#e=!1}#T(){const e=this.#r.pending;e&&(this.#s=ct(()=>e(this.#t)),Et.enqueue(()=>{var t=this.#_();this.#a=this.#m(()=>(Et.ensure(),ct(()=>this.#c(t)))),this.#h>0?this.#g():(yr(this.#s,()=>{this.#s=null}),this.#e=!1)}))}#_(){var e=this.#t;return this.#e&&(this.#l=Wn(),this.#t.before(this.#l),e=this.#l),e}is_pending(){return this.#e||!!this.parent&&this.parent.is_pending()}has_pending_snippet(){return!!this.#r.pending}#m(e){var t=Z,r=Y,s=ie;Pt(this.#o),We(this.#o),Rr(this.#o.ctx);try{return e()}catch(i){return gf(i),null}finally{Pt(t),We(r),Rr(s)}}#g(){const e=this.#r.pending;this.#a!==null&&(this.#u=document.createDocumentFragment(),this.#u.append(this.#l),Mf(this.#a,this.#u)),this.#s===null&&(this.#s=ct(()=>e(this.#t)))}#y(e){if(!this.has_pending_snippet()){this.parent&&this.parent.#y(e);return}this.#h+=e,this.#h===0&&(this.#e=!1,this.#s&&yr(this.#s,()=>{this.#s=null}),this.#u&&(this.#t.before(this.#u),this.#u=null))}update_pending_count(e){this.#y(e),this.#d+=e,this.#f&&Rs(this.#f,this.#d)}get_effect_pending(){return this.#v(),x(this.#f)}error(e){var t=this.#r.onerror;let r=this.#r.failed;if(this.#p||!t&&!r)throw e;this.#a&&(qe(this.#a),this.#a=null),this.#s&&(qe(this.#s),this.#s=null),this.#i&&(qe(this.#i),this.#i=null);var s=!1,i=!1;const a=()=>{if(s){yg();return}s=!0,i&&og(),Et.ensure(),this.#d=0,this.#i!==null&&yr(this.#i,()=>{this.#i=null}),this.#e=this.has_pending_snippet(),this.#a=this.#m(()=>(this.#p=!1,ct(()=>this.#c(this.#t)))),this.#h>0?this.#g():this.#e=!1};var c=Y;try{We(null),i=!0,t?.(e,a),i=!1}catch(l){Pr(l,this.#o&&this.#o.parent)}finally{We(c)}r&&so(()=>{this.#i=this.#m(()=>{Et.ensure(),this.#p=!0;try{return ct(()=>{r(this.#t,()=>e,()=>a)})}catch(l){return Pr(l,this.#o.parent),null}finally{this.#p=!1}})})}}function kg(n,e,t,r){const s=Fs()?oo:fc;if(t.length===0&&n.length===0){r(e.map(s));return}var i=ae,a=Z,c=Ng();function l(){Promise.all(t.map(h=>Dg(h))).then(h=>{c();try{r([...e.map(s),...h])}catch(d){(a.f&an)===0&&Pr(d,a)}i?.deactivate(),ki()}).catch(h=>{Pr(h,a)})}n.length>0?Promise.all(n).then(()=>{c();try{return l()}finally{i?.deactivate(),ki()}}):l()}function Ng(){var n=Z,e=Y,t=ie,r=ae;return function(i=!0){Pt(n),We(e),Rr(t),i&&r?.activate()}}function ki(){Pt(null),We(null),Rr(null)}function oo(n){var e=xe|Qe,t=Y!==null&&(Y.f&xe)!==0?Y:null;return Z!==null&&(Z.f|=Ur),{ctx:ie,deps:null,effects:null,equals:hf,f:e,fn:n,reactions:null,rv:0,v:Oe,wv:0,parent:t??Z,ac:null}}function Dg(n,e){let t=Z;t===null&&Jm();var r=t.b,s=void 0,i=Hn(Oe),a=!Y,c=new Map;return jg(()=>{var l=cf();s=l.promise;try{Promise.resolve(n()).then(l.resolve,l.reject).then(()=>{h===ae&&h.committed&&h.deactivate(),ki()})}catch(g){l.reject(g),ki()}var h=ae;if(a){var d=!r.is_pending();r.update_pending_count(1),h.increment(d),c.get(h)?.reject(dr),c.delete(h),c.set(h,l)}const m=(g,T=void 0)=>{if(h.activate(),T)T!==dr&&(i.f|=cn,Rs(i,T));else{(i.f&cn)!==0&&(i.f^=cn),Rs(i,g);for(const[S,C]of c){if(c.delete(S),S===h)break;C.reject(dr)}}a&&(r.update_pending_count(-1),h.decrement(d))};l.promise.then(m,g=>m(null,g||"unknown"))}),pc(()=>{for(const l of c.values())l.reject(dr)}),new Promise(l=>{function h(d){function m(){d===s?l(i):h(s)}d.then(m,m)}h(s)})}function fc(n){const e=oo(n);return e.equals=df,e}function Ef(n){var e=n.effects;if(e!==null){n.effects=null;for(var t=0;t<e.length;t+=1)qe(e[t])}}function Vg(n){for(var e=n.parent;e!==null;){if((e.f&xe)===0)return e;e=e.parent}return null}function dc(n){var e,t=Z;Pt(Vg(n));try{n.f&=~bs,Ef(n),e=Uf(n)}finally{Pt(t)}return e}function Tf(n){var e=dc(n);if(n.equals(e)||(n.v=e,n.wv=xf()),!Zn)if(Ye!==null)co()&&Ye.set(n,n.v);else{var t=(n.f&dt)===0?Dt:Pe;Ce(n,t)}}let Ra=new Set;const un=new Map;let wf=!1;function Hn(n,e){var t={f:0,v:n,reactions:null,equals:hf,rv:0,wv:0};return t}function en(n,e){const t=Hn(n);return Hg(t),t}function _e(n,e=!1,t=!0){const r=Hn(n);return e||(r.equals=df),Br&&t&&ie!==null&&ie.l!==null&&(ie.l.s??=[]).push(r),r}function W(n,e,t=!1){Y!==null&&(!Tt||(Y.f&_l)!==0)&&Fs()&&(Y.f&(xe|zt|lc|_l))!==0&&!Ft?.includes(n)&&ig();let r=t?pr(e):e;return Rs(n,r)}function Rs(n,e){if(!n.equals(e)){var t=n.v;Zn?un.set(n,e):un.set(n,t),n.v=e;var r=Et.ensure();r.capture(n,t),(n.f&xe)!==0&&((n.f&Qe)!==0&&dc(n),Ce(n,(n.f&dt)!==0?Pe:Dt)),n.wv=xf(),If(n,Qe),Fs()&&Z!==null&&(Z.f&Pe)!==0&&(Z.f&(Ht|Yn))===0&&(st===null?Wg([n]):st.push(n)),!r.is_fork&&Ra.size>0&&!wf&&Og()}return e}function Og(){wf=!1;const n=Array.from(Ra);for(const e of n)(e.f&Pe)!==0&&Ce(e,Dt),qr(e)&&Cr(e);Ra.clear()}function ys(n){W(n,n.v+1)}function If(n,e){var t=n.reactions;if(t!==null)for(var r=Fs(),s=t.length,i=0;i<s;i++){var a=t[i],c=a.f;if(!(!r&&a===Z)){var l=(c&Qe)===0;if(l&&Ce(a,e),(c&xe)!==0){var h=a;Ye?.delete(h),(c&bs)===0&&(c&dt&&(a.f|=bs),If(h,Dt))}else l&&((c&zt)!==0&&Ot!==null&&Ot.add(a),zn(a))}}}function pr(n){if(typeof n!="object"||n===null||_r in n)return n;const e=ac(n);if(e!==Wm&&e!==Gm)return n;var t=new Map,r=ic(n),s=en(0),i=Bn,a=c=>{if(Bn===i)return c();var l=Y,h=Bn;We(null),wl(i);var d=c();return We(l),wl(h),d};return r&&t.set("length",en(n.length)),new Proxy(n,{defineProperty(c,l,h){(!("value"in h)||h.configurable===!1||h.enumerable===!1||h.writable===!1)&&rg();var d=t.get(l);return d===void 0?d=a(()=>{var m=en(h.value);return t.set(l,m),m}):W(d,h.value,!0),!0},deleteProperty(c,l){var h=t.get(l);if(h===void 0){if(l in c){const d=a(()=>en(Oe));t.set(l,d),ys(s)}}else W(h,Oe),ys(s);return!0},get(c,l,h){if(l===_r)return n;var d=t.get(l),m=l in c;if(d===void 0&&(!m||mr(c,l)?.writable)&&(d=a(()=>{var T=pr(m?c[l]:Oe),S=en(T);return S}),t.set(l,d)),d!==void 0){var g=x(d);return g===Oe?void 0:g}return Reflect.get(c,l,h)},getOwnPropertyDescriptor(c,l){var h=Reflect.getOwnPropertyDescriptor(c,l);if(h&&"value"in h){var d=t.get(l);d&&(h.value=x(d))}else if(h===void 0){var m=t.get(l),g=m?.v;if(m!==void 0&&g!==Oe)return{enumerable:!0,configurable:!0,value:g,writable:!0}}return h},has(c,l){if(l===_r)return!0;var h=t.get(l),d=h!==void 0&&h.v!==Oe||Reflect.has(c,l);if(h!==void 0||Z!==null&&(!d||mr(c,l)?.writable)){h===void 0&&(h=a(()=>{var g=d?pr(c[l]):Oe,T=en(g);return T}),t.set(l,h));var m=x(h);if(m===Oe)return!1}return d},set(c,l,h,d){var m=t.get(l),g=l in c;if(r&&l==="length")for(var T=h;T<m.v;T+=1){var S=t.get(T+"");S!==void 0?W(S,Oe):T in c&&(S=a(()=>en(Oe)),t.set(T+"",S))}if(m===void 0)(!g||mr(c,l)?.writable)&&(m=a(()=>en(void 0)),W(m,pr(h)),t.set(l,m));else{g=m.v!==Oe;var C=a(()=>pr(h));W(m,C)}var R=Reflect.getOwnPropertyDescriptor(c,l);if(R?.set&&R.set.call(d,h),!g){if(r&&typeof l=="string"){var L=t.get("length"),O=Number(l);Number.isInteger(O)&&O>=L.v&&W(L,O+1)}ys(s)}return!0},ownKeys(c){x(s);var l=Reflect.ownKeys(c).filter(m=>{var g=t.get(m);return g===void 0||g.v!==Oe});for(var[h,d]of t)d.v!==Oe&&!(h in c)&&l.push(h);return l},setPrototypeOf(){sg()}})}var Pa,Af,bf,Sf;function Mg(){if(Pa===void 0){Pa=window,Af=/Firefox/.test(navigator.userAgent);var n=Element.prototype,e=Node.prototype,t=Text.prototype;bf=mr(e,"firstChild").get,Sf=mr(e,"nextSibling").get,gl(n)&&(n.__click=void 0,n.__className=void 0,n.__attributes=null,n.__style=void 0,n.__e=void 0),gl(t)&&(t.__t=void 0)}}function Wn(n=""){return document.createTextNode(n)}function Ni(n){return bf.call(n)}function Us(n){return Sf.call(n)}function re(n,e){return Ni(n)}function Fn(n,e=!1){{var t=Ni(n);return t instanceof Comment&&t.data===""?Us(t):t}}function le(n,e=1,t=!1){let r=n;for(;e--;)r=Us(r);return r}function Lg(n){n.textContent=""}function Rf(){return!1}let vl=!1;function xg(){vl||(vl=!0,document.addEventListener("reset",n=>{Promise.resolve().then(()=>{if(!n.defaultPrevented)for(const e of n.target.elements)e.__on_r?.()})},{capture:!0}))}function ao(n){var e=Y,t=Z;We(null),Pt(null);try{return n()}finally{We(e),Pt(t)}}function Fg(n,e,t,r=t){n.addEventListener(e,()=>ao(t));const s=n.__on_r;s?n.__on_r=()=>{s(),r(!0)}:n.__on_r=()=>r(!0),xg()}function Pf(n){Z===null&&(Y===null&&eg(),Zm()),Zn&&Ym()}function Ug(n,e){var t=e.last;t===null?e.last=e.first=n:(t.next=n,n.prev=t,e.last=n)}function Wt(n,e,t,r=!0){var s=Z;s!==null&&(s.f&et)!==0&&(n|=et);var i={ctx:ie,deps:null,nodes_start:null,nodes_end:null,f:n|Qe|dt,first:null,fn:e,last:null,next:null,parent:s,b:s&&s.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(t)try{Cr(i),i.f|=uc}catch(l){throw qe(i),l}else e!==null&&zn(i);if(r){var a=i;if(t&&a.deps===null&&a.teardown===null&&a.nodes_start===null&&a.first===a.last&&(a.f&Ur)===0&&(a=a.first,(n&zt)!==0&&(n&Sr)!==0&&a!==null&&(a.f|=Sr)),a!==null&&(a.parent=s,s!==null&&Ug(a,s),Y!==null&&(Y.f&xe)!==0&&(n&Yn)===0)){var c=Y;(c.effects??=[]).push(a)}}return i}function co(){return Y!==null&&!Tt}function pc(n){const e=Wt(no,null,!1);return Ce(e,Pe),e.teardown=n,e}function Ca(n){Pf();var e=Z.f,t=!Y&&(e&Ht)!==0&&(e&uc)===0;if(t){var r=ie;(r.e??=[]).push(n)}else return Cf(n)}function Cf(n){return Wt(cc|lf,n,!1)}function Bg(n){return Pf(),Wt(no|lf,n,!0)}function $g(n){Et.ensure();const e=Wt(Yn|Ur,n,!0);return(t={})=>new Promise(r=>{t.outro?yr(e,()=>{qe(e),r(void 0)}):(qe(e),r(void 0))})}function $r(n,e){var t=ie,r={effect:null,ran:!1,deps:n};t.l.$.push(r),r.effect=uo(()=>{n(),!r.ran&&(r.ran=!0,je(e))})}function jr(){var n=ie;uo(()=>{for(var e of n.l.$){e.deps();var t=e.effect;(t.f&Pe)!==0&&Ce(t,Dt),qr(t)&&Cr(t),e.ran=!1}})}function jg(n){return Wt(lc|Ur,n,!0)}function uo(n,e=0){return Wt(no|e,n,!0)}function mn(n,e=[],t=[],r=[],s=!1){kg(r,e,t,i=>{Wt(s?cc:no,()=>n(...i.map(x)),!0)})}function mc(n,e=0){var t=Wt(zt|e,n,!0);return t}function ct(n,e=!0){return Wt(Ht|Ur,n,!0,e)}function kf(n){var e=n.teardown;if(e!==null){const t=Zn,r=Y;Tl(!0),We(null);try{e.call(null)}finally{Tl(t),We(r)}}}function Nf(n,e=!1){var t=n.first;for(n.first=n.last=null;t!==null;){const s=t.ac;s!==null&&ao(()=>{s.abort(dr)});var r=t.next;(t.f&Yn)!==0?t.parent=null:qe(t,e),t=r}}function qg(n){for(var e=n.first;e!==null;){var t=e.next;(e.f&Ht)===0&&qe(e),e=t}}function qe(n,e=!0){var t=!1;(e||(n.f&uf)!==0)&&n.nodes_start!==null&&n.nodes_end!==null&&(zg(n.nodes_start,n.nodes_end),t=!0),Nf(n,e&&!t),Di(n,0),Ce(n,an);var r=n.transitions;if(r!==null)for(const i of r)i.stop();kf(n);var s=n.parent;s!==null&&s.first!==null&&Df(n),n.next=n.prev=n.teardown=n.ctx=n.deps=n.fn=n.nodes_start=n.nodes_end=n.ac=null}function zg(n,e){for(;n!==null;){var t=n===e?null:Us(n);n.remove(),n=t}}function Df(n){var e=n.parent,t=n.prev,r=n.next;t!==null&&(t.next=r),r!==null&&(r.prev=t),e!==null&&(e.first===n&&(e.first=r),e.last===n&&(e.last=t))}function yr(n,e,t=!0){var r=[];gc(n,r,!0),Vf(r,()=>{t&&qe(n),e&&e()})}function Vf(n,e){var t=n.length;if(t>0){var r=()=>--t||e();for(var s of n)s.out(r)}else e()}function gc(n,e,t){if((n.f&et)===0){if(n.f^=et,n.transitions!==null)for(const a of n.transitions)(a.is_global||t)&&e.push(a);for(var r=n.first;r!==null;){var s=r.next,i=(r.f&Sr)!==0||(r.f&Ht)!==0&&(n.f&zt)!==0;gc(r,e,i?t:!1),r=s}}}function _c(n){Of(n,!0)}function Of(n,e){if((n.f&et)!==0){n.f^=et,(n.f&Pe)===0&&(Ce(n,Qe),zn(n));for(var t=n.first;t!==null;){var r=t.next,s=(t.f&Sr)!==0||(t.f&Ht)!==0;Of(t,s?e:!1),t=r}if(n.transitions!==null)for(const i of n.transitions)(i.is_global||e)&&i.in()}}function Mf(n,e){for(var t=n.nodes_start,r=n.nodes_end;t!==null;){var s=t===r?null:Us(t);e.append(t),t=s}}let Un=!1;function El(n){Un=n}let Zn=!1;function Tl(n){Zn=n}let Y=null,Tt=!1;function We(n){Y=n}let Z=null;function Pt(n){Z=n}let Ft=null;function Hg(n){Y!==null&&(Ft===null?Ft=[n]:Ft.push(n))}let $e=null,Je=0,st=null;function Wg(n){st=n}let Lf=1,Ps=0,Bn=Ps;function wl(n){Bn=n}function xf(){return++Lf}function qr(n){var e=n.f;if((e&Qe)!==0)return!0;if(e&xe&&(n.f&=~bs),(e&Dt)!==0){var t=n.deps;if(t!==null)for(var r=t.length,s=0;s<r;s++){var i=t[s];if(qr(i)&&Tf(i),i.wv>n.wv)return!0}(e&dt)!==0&&Ye===null&&Ce(n,Pe)}return!1}function Ff(n,e,t=!0){var r=n.reactions;if(r!==null&&!Ft?.includes(n))for(var s=0;s<r.length;s++){var i=r[s];(i.f&xe)!==0?Ff(i,e,!1):e===i&&(t?Ce(i,Qe):(i.f&Pe)!==0&&Ce(i,Dt),zn(i))}}function Uf(n){var e=$e,t=Je,r=st,s=Y,i=Ft,a=ie,c=Tt,l=Bn,h=n.f;$e=null,Je=0,st=null,Y=(h&(Ht|Yn))===0?n:null,Ft=null,Rr(n.ctx),Tt=!1,Bn=++Ps,n.ac!==null&&(ao(()=>{n.ac.abort(dr)}),n.ac=null);try{n.f|=Aa;var d=n.fn,m=d(),g=n.deps;if($e!==null){var T;if(Di(n,Je),g!==null&&Je>0)for(g.length=Je+$e.length,T=0;T<$e.length;T++)g[Je+T]=$e[T];else n.deps=g=$e;if(Un&&co()&&(n.f&dt)!==0)for(T=Je;T<g.length;T++)(g[T].reactions??=[]).push(n)}else g!==null&&Je<g.length&&(Di(n,Je),g.length=Je);if(Fs()&&st!==null&&!Tt&&g!==null&&(n.f&(xe|Dt|Qe))===0)for(T=0;T<st.length;T++)Ff(st[T],n);return s!==null&&s!==n&&(Ps++,st!==null&&(r===null?r=st:r.push(...st))),(n.f&cn)!==0&&(n.f^=cn),m}catch(S){return gf(S)}finally{n.f^=Aa,$e=e,Je=t,st=r,Y=s,Ft=i,Rr(a),Tt=c,Bn=l}}function Gg(n,e){let t=e.reactions;if(t!==null){var r=Hm.call(t,n);if(r!==-1){var s=t.length-1;s===0?t=e.reactions=null:(t[r]=t[s],t.pop())}}t===null&&(e.f&xe)!==0&&($e===null||!$e.includes(e))&&(Ce(e,Dt),(e.f&dt)!==0&&(e.f^=dt,e.f&=~bs),Ef(e),Di(e,0))}function Di(n,e){var t=n.deps;if(t!==null)for(var r=e;r<t.length;r++)Gg(n,t[r])}function Cr(n){var e=n.f;if((e&an)===0){Ce(n,Pe);var t=Z,r=Un;Z=n,Un=!0;try{(e&zt)!==0?qg(n):Nf(n),kf(n);var s=Uf(n);n.teardown=typeof s=="function"?s:null,n.wv=Lf;var i;sf&&Eg&&(n.f&Qe)!==0&&n.deps}finally{Un=r,Z=t}}}async function Kg(){await Promise.resolve(),Ag()}function x(n){var e=n.f,t=(e&xe)!==0;if(Y!==null&&!Tt){var r=Z!==null&&(Z.f&an)!==0;if(!r&&!Ft?.includes(n)){var s=Y.deps;if((Y.f&Aa)!==0)n.rv<Ps&&(n.rv=Ps,$e===null&&s!==null&&s[Je]===n?Je++:$e===null?$e=[n]:$e.includes(n)||$e.push(n));else{(Y.deps??=[]).push(n);var i=n.reactions;i===null?n.reactions=[Y]:i.includes(Y)||i.push(Y)}}}if(Zn){if(un.has(n))return un.get(n);if(t){var a=n,c=a.v;return((a.f&Pe)===0&&a.reactions!==null||$f(a))&&(c=dc(a)),un.set(a,c),c}}else if(t){if(a=n,Ye?.has(a))return Ye.get(a);qr(a)&&Tf(a),Un&&co()&&(a.f&dt)===0&&Bf(a)}else if(Ye?.has(n))return Ye.get(n);if((n.f&cn)!==0)throw n.v;return n.v}function Bf(n){if(n.deps!==null){n.f^=dt;for(const e of n.deps)(e.reactions??=[]).push(n),(e.f&xe)!==0&&(e.f&dt)===0&&Bf(e)}}function $f(n){if(n.v===Oe)return!0;if(n.deps===null)return!1;for(const e of n.deps)if(un.has(e)||(e.f&xe)!==0&&$f(e))return!0;return!1}function je(n){var e=Tt;try{return Tt=!0,n()}finally{Tt=e}}const Qg=-7169;function Ce(n,e){n.f=n.f&Qg|e}function jf(n){if(!(typeof n!="object"||!n||n instanceof EventTarget)){if(_r in n)ka(n);else if(!Array.isArray(n))for(let e in n){const t=n[e];typeof t=="object"&&t&&_r in t&&ka(t)}}}function ka(n,e=new Set){if(typeof n=="object"&&n!==null&&!(n instanceof EventTarget)&&!e.has(n)){e.add(n),n instanceof Date&&n.getTime();for(let r in n)try{ka(n[r],e)}catch{}const t=ac(n);if(t!==Object.prototype&&t!==Array.prototype&&t!==Map.prototype&&t!==Set.prototype&&t!==Date.prototype){const r=af(t);for(let s in r){const i=r[s].get;if(i)try{i.call(n)}catch{}}}}}const Xg=["touchstart","touchmove"];function Jg(n){return Xg.includes(n)}const Yg=new Set,Il=new Set;function Zg(n,e,t,r={}){function s(i){if(r.capture||fs.call(e,i),!i.cancelBubble)return ao(()=>t?.call(this,i))}return n.startsWith("pointer")||n.startsWith("touch")||n==="wheel"?so(()=>{e.addEventListener(n,s,r)}):e.addEventListener(n,s,r),s}function In(n,e,t,r,s){var i={capture:r,passive:s},a=Zg(n,e,t,i);(e===document.body||e===window||e===document||e instanceof HTMLMediaElement)&&pc(()=>{e.removeEventListener(n,a,i)})}let Al=null;function fs(n){var e=this,t=e.ownerDocument,r=n.type,s=n.composedPath?.()||[],i=s[0]||n.target;Al=n;var a=0,c=Al===n&&n.__root;if(c){var l=s.indexOf(c);if(l!==-1&&(e===document||e===window)){n.__root=e;return}var h=s.indexOf(e);if(h===-1)return;l<=h&&(a=l)}if(i=s[a]||n.target,i!==e){of(n,"currentTarget",{configurable:!0,get(){return i||t}});var d=Y,m=Z;We(null),Pt(null);try{for(var g,T=[];i!==null;){var S=i.assignedSlot||i.parentNode||i.host||null;try{var C=i["__"+r];C!=null&&(!i.disabled||n.target===i)&&C.call(i,n)}catch(R){g?T.push(R):g=R}if(n.cancelBubble||S===e||S===null)break;i=S}if(g){for(let R of T)queueMicrotask(()=>{throw R});throw g}}finally{n.__root=e,delete n.currentTarget,We(d),Pt(m)}}}function e_(n){var e=document.createElement("template");return e.innerHTML=n.replaceAll("<!>","<!---->"),e.content}function Na(n,e){var t=Z;t.nodes_start===null&&(t.nodes_start=n,t.nodes_end=e)}function he(n,e){var t=(e&mg)!==0,r=(e&gg)!==0,s,i=!n.startsWith("<!>");return()=>{s===void 0&&(s=e_(i?n:"<!>"+n),t||(s=Ni(s)));var a=r||Af?document.importNode(s,!0):s.cloneNode(!0);if(t){var c=Ni(a),l=a.lastChild;Na(c,l)}else Na(a,a);return a}}function yc(){var n=document.createDocumentFragment(),e=document.createComment(""),t=Wn();return n.append(e,t),Na(e,t),n}function se(n,e){n!==null&&n.before(e)}function lo(n,e){var t=e==null?"":typeof e=="object"?e+"":e;t!==(n.__t??=n.nodeValue)&&(n.__t=t,n.nodeValue=t+"")}function t_(n,e){return n_(n,e)}const ar=new Map;function n_(n,{target:e,anchor:t,props:r={},events:s,context:i,intro:a=!0}){Mg();var c=new Set,l=m=>{for(var g=0;g<m.length;g++){var T=m[g];if(!c.has(T)){c.add(T);var S=Jg(T);e.addEventListener(T,fs,{passive:S});var C=ar.get(T);C===void 0?(document.addEventListener(T,fs,{passive:S}),ar.set(T,1)):ar.set(T,C+1)}}};l(oc(Yg)),Il.add(l);var h=void 0,d=$g(()=>{var m=t??e.appendChild(Wn());return Pg(m,{pending:()=>{}},g=>{if(i){tt({});var T=ie;T.c=i}s&&(r.$$events=s),h=n(g,r)||{},i&&nt()}),()=>{for(var g of c){e.removeEventListener(g,fs);var T=ar.get(g);--T===0?(document.removeEventListener(g,fs),ar.delete(g)):ar.set(g,T)}Il.delete(l),m!==t&&m.parentNode?.removeChild(m)}});return r_.set(h,d),h}let r_=new WeakMap;class s_{anchor;#e=new Map;#t=new Map;#n=new Map;#r=!0;constructor(e,t=!0){this.anchor=e,this.#r=t}#c=()=>{var e=ae;if(this.#e.has(e)){var t=this.#e.get(e),r=this.#t.get(t);if(r)_c(r);else{var s=this.#n.get(t);s&&(this.#t.set(t,s.effect),this.#n.delete(t),s.fragment.lastChild.remove(),this.anchor.before(s.fragment),r=s.effect)}for(const[i,a]of this.#e){if(this.#e.delete(i),i===e)break;const c=this.#n.get(a);c&&(qe(c.effect),this.#n.delete(a))}for(const[i,a]of this.#t){if(i===t)continue;const c=()=>{if(Array.from(this.#e.values()).includes(i)){var h=document.createDocumentFragment();Mf(a,h),h.append(Wn()),this.#n.set(i,{effect:a,fragment:h})}else qe(a);this.#t.delete(i)};this.#r||!r?yr(a,c,!1):c()}}};#o=e=>{this.#e.delete(e);const t=Array.from(this.#e.values());for(const[r,s]of this.#n)t.includes(r)||(qe(s.effect),this.#n.delete(r))};ensure(e,t){var r=ae,s=Rf();if(t&&!this.#t.has(e)&&!this.#n.has(e))if(s){var i=document.createDocumentFragment(),a=Wn();i.append(a),this.#n.set(e,{effect:ct(()=>t(a)),fragment:i})}else this.#t.set(e,ct(()=>t(this.anchor)));if(this.#e.set(r,e),s){for(const[c,l]of this.#t)c===e?r.skipped_effects.delete(l):r.skipped_effects.add(l);for(const[c,l]of this.#n)c===e?r.skipped_effects.delete(l.effect):r.skipped_effects.add(l.effect);r.oncommit(this.#c),r.ondiscard(this.#o)}else this.#c()}}function lt(n,e,t=!1){var r=new s_(n),s=t?Sr:0;function i(a,c){r.ensure(a,c)}mc(()=>{var a=!1;e((c,l=!0)=>{a=!0,i(l,c)}),a||i(!1,null)},s)}function qf(n,e){return e}function i_(n,e,t){for(var r=n.items,s=[],i=e.length,a=0;a<i;a++)gc(e[a].e,s,!0);var c=i>0&&s.length===0&&t!==null;if(c){var l=t.parentNode;Lg(l),l.append(t),r.clear(),_t(n,e[0].prev,e[i-1].next)}Vf(s,()=>{for(var h=0;h<i;h++){var d=e[h];c||(r.delete(d.k),_t(n,d.prev,d.next)),qe(d.e,!c)}})}function zf(n,e,t,r,s,i=null){var a=n,c={flags:e,items:new Map,first:null};{var l=n;a=l.appendChild(Wn())}var h=null,d=!1,m=new Map,g=fc(()=>{var R=t();return ic(R)?R:R==null?[]:oc(R)}),T,S;function C(){o_(S,T,c,m,a,s,e,r,t),i!==null&&(T.length===0?h?_c(h):h=ct(()=>i(a)):h!==null&&yr(h,()=>{h=null}))}mc(()=>{S??=Z,T=x(g);var R=T.length;if(!(d&&R===0)){d=R===0;var L,O,D,z;if(Rf()){var J=new Set,ee=ae;for(O=0;O<R;O+=1){D=T[O],z=r(D,O);var E=c.items.get(z)??m.get(z);E?Hf(E,D,O):(L=Wf(null,c,null,null,D,z,O,s,e,t,!0),m.set(z,L)),J.add(z)}for(const[_,y]of c.items)J.has(_)||ee.skipped_effects.add(y.e);ee.oncommit(C)}else C();x(g)}})}function o_(n,e,t,r,s,i,a,c,l){var h=e.length,d=t.items,m=t.first,g=m,T,S=null,C=[],R=[],L,O,D,z;for(z=0;z<h;z+=1){if(L=e[z],O=c(L,z),D=d.get(O),D===void 0){var J=r.get(O);if(J!==void 0){r.delete(O),d.set(O,J);var ee=S?S.next:g;_t(t,S,J),_t(t,J,ee),aa(J,ee,s),S=J}else{var E=g?g.e.nodes_start:s;S=Wf(E,t,S,S===null?t.first:S.next,L,O,z,i,a,l)}d.set(O,S),C=[],R=[],g=S.next;continue}if(Hf(D,L,z),(D.e.f&et)!==0&&_c(D.e),D!==g){if(T!==void 0&&T.has(D)){if(C.length<R.length){var _=R[0],y;S=_.prev;var I=C[0],w=C[C.length-1];for(y=0;y<C.length;y+=1)aa(C[y],_,s);for(y=0;y<R.length;y+=1)T.delete(R[y]);_t(t,I.prev,w.next),_t(t,S,I),_t(t,w,_),g=_,S=w,z-=1,C=[],R=[]}else T.delete(D),aa(D,g,s),_t(t,D.prev,D.next),_t(t,D,S===null?t.first:S.next),_t(t,S,D),S=D;continue}for(C=[],R=[];g!==null&&g.k!==O;)(g.e.f&et)===0&&(T??=new Set).add(g),R.push(g),g=g.next;if(g===null)continue;D=g}C.push(D),S=D,g=D.next}if(g!==null||T!==void 0){for(var A=T===void 0?[]:oc(T);g!==null;)(g.e.f&et)===0&&A.push(g),g=g.next;var v=A.length;if(v>0){var ve=h===0?s:null;i_(t,A,ve)}}n.first=t.first&&t.first.e,n.last=S&&S.e;for(var Ne of r.values())qe(Ne.e);r.clear()}function Hf(n,e,t,r){Rs(n.v,e),n.i=t}function Wf(n,e,t,r,s,i,a,c,l,h,d){var m=(l&ag)!==0,g=(l&ug)===0,T=m?g?_e(s,!1,!1):Hn(s):s,S=(l&cg)===0?a:Hn(a),C={i:S,v:T,k:i,a:null,e:null,prev:t,next:r};try{if(n===null){var R=document.createDocumentFragment();R.append(n=Wn())}return C.e=ct(()=>c(n,T,S,h),vg),C.e.prev=t&&t.e,C.e.next=r&&r.e,t===null?d||(e.first=C):(t.next=C,t.e.next=C.e),r!==null&&(r.prev=C,r.e.prev=C.e),C}finally{}}function aa(n,e,t){for(var r=n.next?n.next.e.nodes_start:t,s=e?e.e.nodes_start:t,i=n.e.nodes_start;i!==null&&i!==r;){var a=Us(i);s.before(i),i=a}}function _t(n,e,t){e===null?n.first=t:(e.next=t,e.e.next=t&&t.e),t!==null&&(t.prev=e,t.e.prev=e&&e.e)}function vc(n,e,t,r,s){var i=e.$$slots?.[t],a=!1;i===!0&&(i=e.children,a=!0),i===void 0||i(n,a?()=>r:r)}const bl=[...` 	
\r\fÂ \v\uFEFF`];function a_(n,e,t){var r=n==null?"":""+n;if(t){for(var s in t)if(t[s])r=r?r+" "+s:s;else if(r.length)for(var i=s.length,a=0;(a=r.indexOf(s,a))>=0;){var c=a+i;(a===0||bl.includes(r[a-1]))&&(c===r.length||bl.includes(r[c]))?r=(a===0?"":r.substring(0,a))+r.substring(c+1):a=c}}return r===""?null:r}function c_(n,e){return n==null?null:String(n)}function Ec(n,e,t,r,s,i){var a=n.__className;if(a!==t||a===void 0){var c=a_(t,r,i);c==null?n.removeAttribute("class"):n.className=c,n.__className=t}else if(i&&s!==i)for(var l in i){var h=!!i[l];(s==null||h!==!!s[l])&&n.classList.toggle(l,h)}return i}function u_(n,e,t,r){var s=n.__style;if(s!==e){var i=c_(e);i==null?n.removeAttribute("style"):n.style.cssText=i,n.__style=e}return r}const l_=Symbol("is custom element"),h_=Symbol("is html");function vr(n,e,t,r){var s=f_(n);s[e]!==(s[e]=t)&&(e==="loading"&&(n[Xm]=t),t==null?n.removeAttribute(e):typeof t!="string"&&d_(n).includes(e)?n[e]=t:n.setAttribute(e,t))}function f_(n){return n.__attributes??={[l_]:n.nodeName.includes("-"),[h_]:n.namespaceURI===_g}}var Sl=new Map;function d_(n){var e=n.getAttribute("is")||n.nodeName,t=Sl.get(e);if(t)return t;Sl.set(e,t=[]);for(var r,s=n,i=Element.prototype;i!==s;){r=af(s);for(var a in r)r[a].set&&t.push(a);s=ac(s)}return t}function Er(n,e,t=e){var r=new WeakSet;Fg(n,"input",async s=>{var i=s?n.defaultValue:n.value;if(i=ca(n)?ua(i):i,t(i),ae!==null&&r.add(ae),await Kg(),i!==(i=e())){var a=n.selectionStart,c=n.selectionEnd,l=n.value.length;if(n.value=i??"",c!==null){var h=n.value.length;a===c&&c===l&&h>l?(n.selectionStart=h,n.selectionEnd=h):(n.selectionStart=a,n.selectionEnd=Math.min(c,h))}}}),je(e)==null&&n.value&&(t(ca(n)?ua(n.value):n.value),ae!==null&&r.add(ae)),uo(()=>{var s=e();if(n===document.activeElement){var i=vi??ae;if(r.has(i))return}ca(n)&&s===ua(n.value)||n.type==="date"&&!s&&!n.value||s!==n.value&&(n.value=s??"")})}function ca(n){var e=n.type;return e==="number"||e==="range"}function ua(n){return n===""?null:+n}function Gf(n){return function(...e){var t=e[0];return t.preventDefault(),n?.apply(this,e)}}function at(n=!1){const e=ie,t=e.l.u;if(!t)return;let r=()=>jf(e.s);if(n){let s=0,i={};const a=oo(()=>{let c=!1;const l=e.s;for(const h in l)l[h]!==i[h]&&(i[h]=l[h],c=!0);return c&&s++,s});r=()=>x(a)}t.b.length&&Bg(()=>{Rl(e,r),Ia(t.b)}),Ca(()=>{const s=je(()=>t.m.map(Km));return()=>{for(const i of s)typeof i=="function"&&i()}}),t.a.length&&Ca(()=>{Rl(e,r),Ia(t.a)})}function Rl(n,e){if(n.l.s)for(const t of n.l.s)x(t);e()}function Kf(n,e,t){if(n==null)return e(void 0),gr;const r=je(()=>n.subscribe(e,t));return r.unsubscribe?()=>r.unsubscribe():r}const cr=[];function ho(n,e=gr){let t=null;const r=new Set;function s(c){if(ff(n,c)&&(n=c,t)){const l=!cr.length;for(const h of r)h[1](),cr.push(h,n);if(l){for(let h=0;h<cr.length;h+=2)cr[h][0](cr[h+1]);cr.length=0}}}function i(c){s(c(n))}function a(c,l=gr){const h=[c,l];return r.add(h),r.size===1&&(t=e(s,i)||gr),c(n),()=>{r.delete(h),r.size===0&&t&&(t(),t=null)}}return{set:s,update:i,subscribe:a}}function p_(n){let e;return Kf(n,t=>e=t)(),e}let fi=!1,Da=Symbol();function Ut(n,e,t){const r=t[e]??={store:null,source:_e(void 0),unsubscribe:gr};if(r.store!==n&&!(Da in t))if(r.unsubscribe(),r.store=n??null,n==null)r.source.v=void 0,r.unsubscribe=gr;else{var s=!0;r.unsubscribe=Kf(n,i=>{s?r.source.v=i:W(r.source,i)}),s=!1}return n&&Da in t?p_(n):x(r.source)}function Bs(){const n={};function e(){pc(()=>{for(var t in n)n[t].unsubscribe();of(n,Da,{enumerable:!1,value:!0})})}return[n,e]}function m_(n){var e=fi;try{return fi=!1,[n(),fi]}finally{fi=e}}function Ge(n,e,t,r){var s=!Br||(t&hg)!==0,i=(t&dg)!==0,a=(t&pg)!==0,c=r,l=!0,h=()=>(l&&(l=!1,c=a?je(r):r),c),d;if(i){var m=_r in n||Qm in n;d=mr(n,e)?.set??(m&&e in n?D=>n[e]=D:void 0)}var g,T=!1;i?[g,T]=m_(()=>n[e]):g=n[e],g===void 0&&r!==void 0&&(g=h(),d&&(s&&ng(),d(g)));var S;if(s?S=()=>{var D=n[e];return D===void 0?h():(l=!0,D)}:S=()=>{var D=n[e];return D!==void 0&&(c=void 0),D===void 0?c:D},s&&(t&fg)===0)return S;if(d){var C=n.$$legacy;return(function(D,z){return arguments.length>0?((!s||!z||C||T)&&d(z?S():D),D):S()})}var R=!1,L=((t&lg)!==0?oo:fc)(()=>(R=!1,S()));i&&x(L);var O=Z;return(function(D,z){if(arguments.length>0){const J=z?x(L):s&&i?pr(D):D;return W(L,J),R=!0,c!==void 0&&(c=J),D}return Zn&&R||(O.f&an)!==0?L.v:x(L)})}function g_(n){ie===null&&hc(),Br&&ie.l!==null?y_(ie).m.push(n):Ca(()=>{const e=je(n);if(typeof e=="function")return e})}function __(n,e,{bubbles:t=!1,cancelable:r=!1}={}){return new CustomEvent(n,{detail:e,bubbles:t,cancelable:r})}function $s(){const n=ie;return n===null&&hc(),(e,t,r)=>{const s=n.s.$$events?.[e];if(s){const i=ic(s)?s.slice():[s],a=__(e,t,r);for(const c of i)c.call(n.x,a);return!a.defaultPrevented}return!0}}function y_(n){var e=n.l;return e.u??={a:[],b:[],m:[]}}const v_="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(v_);Tg();const E_=()=>{};var Pl={};const Qf=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let s=n.charCodeAt(r);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},T_=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const s=n[t++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=n[t++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=n[t++],a=n[t++],c=n[t++],l=((s&7)<<18|(i&63)<<12|(a&63)<<6|c&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const i=n[t++],a=n[t++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|a&63)}}return e.join("")},Xf={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<n.length;s+=3){const i=n[s],a=s+1<n.length,c=a?n[s+1]:0,l=s+2<n.length,h=l?n[s+2]:0,d=i>>2,m=(i&3)<<4|c>>4;let g=(c&15)<<2|h>>6,T=h&63;l||(T=64,a||(g=64)),r.push(t[d],t[m],t[g],t[T])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(Qf(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):T_(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<n.length;){const i=t[n.charAt(s++)],c=s<n.length?t[n.charAt(s)]:0;++s;const h=s<n.length?t[n.charAt(s)]:64;++s;const m=s<n.length?t[n.charAt(s)]:64;if(++s,i==null||c==null||h==null||m==null)throw new w_;const g=i<<2|c>>4;if(r.push(g),h!==64){const T=c<<4&240|h>>2;if(r.push(T),m!==64){const S=h<<6&192|m;r.push(S)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class w_ extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const I_=function(n){const e=Qf(n);return Xf.encodeByteArray(e,!0)},Vi=function(n){return I_(n).replace(/\./g,"")},Jf=function(n){try{return Xf.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function A_(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const b_=()=>A_().__FIREBASE_DEFAULTS__,S_=()=>{if(typeof process>"u"||typeof Pl>"u")return;const n=Pl.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},R_=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&Jf(n[1]);return e&&JSON.parse(e)},fo=()=>{try{return E_()||b_()||S_()||R_()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Yf=n=>fo()?.emulatorHosts?.[n],Zf=n=>{const e=Yf(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},ed=()=>fo()?.config,td=n=>fo()?.[`_${n}`];class P_{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}function An(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Tc(n){return(await fetch(n,{credentials:"include"})).ok}function C_(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",s=n.iat||0,i=n.sub||n.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a={iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...n};return[Vi(JSON.stringify(t)),Vi(JSON.stringify(a)),""].join(".")}const vs={};function k_(){const n={prod:[],emulator:[]};for(const e of Object.keys(vs))vs[e]?n.emulator.push(e):n.prod.push(e);return n}function N_(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let Cl=!1;function wc(n,e){if(typeof window>"u"||typeof document>"u"||!An(window.location.host)||vs[n]===e||vs[n]||Cl)return;vs[n]=e;function t(g){return`__firebase__banner__${g}`}const r="__firebase__banner",i=k_().prod.length>0;function a(){const g=document.getElementById(r);g&&g.remove()}function c(g){g.style.display="flex",g.style.background="#7faaf0",g.style.position="fixed",g.style.bottom="5px",g.style.left="5px",g.style.padding=".5em",g.style.borderRadius="5px",g.style.alignItems="center"}function l(g,T){g.setAttribute("width","24"),g.setAttribute("id",T),g.setAttribute("height","24"),g.setAttribute("viewBox","0 0 24 24"),g.setAttribute("fill","none"),g.style.marginLeft="-6px"}function h(){const g=document.createElement("span");return g.style.cursor="pointer",g.style.marginLeft="16px",g.style.fontSize="24px",g.innerHTML=" &times;",g.onclick=()=>{Cl=!0,a()},g}function d(g,T){g.setAttribute("id",T),g.innerText="Learn more",g.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",g.setAttribute("target","__blank"),g.style.paddingLeft="5px",g.style.textDecoration="underline"}function m(){const g=N_(r),T=t("text"),S=document.getElementById(T)||document.createElement("span"),C=t("learnmore"),R=document.getElementById(C)||document.createElement("a"),L=t("preprendIcon"),O=document.getElementById(L)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(g.created){const D=g.element;c(D),d(R,C);const z=h();l(O,L),D.append(O,S,R,z),document.body.appendChild(D)}i?(S.innerText="Preview backend disconnected.",O.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(O.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,S.innerText="Preview backend running in this workspace."),S.setAttribute("id",T)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",m):m()}function Fe(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function D_(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Fe())}function V_(){const n=fo()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function O_(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function M_(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function L_(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function x_(){const n=Fe();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function F_(){return!V_()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function U_(){try{return typeof indexedDB=="object"}catch{return!1}}function B_(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{e(s.error?.message||"")}}catch(t){e(t)}})}const $_="FirebaseError";class Vt extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=$_,Object.setPrototypeOf(this,Vt.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,js.prototype.create)}}class js{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},s=`${this.service}/${e}`,i=this.errors[e],a=i?j_(i,r):"Error",c=`${this.serviceName}: ${a} (${s}).`;return new Vt(s,c,r)}}function j_(n,e){return n.replace(q_,(t,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const q_=/\{\$([^}]+)}/g;function z_(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Gn(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const s of t){if(!r.includes(s))return!1;const i=n[s],a=e[s];if(kl(i)&&kl(a)){if(!Gn(i,a))return!1}else if(i!==a)return!1}for(const s of r)if(!t.includes(s))return!1;return!0}function kl(n){return n!==null&&typeof n=="object"}function qs(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function H_(n,e){const t=new W_(n,e);return t.subscribe.bind(t)}class W_{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let s;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");G_(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:r},s.next===void 0&&(s.next=la),s.error===void 0&&(s.error=la),s.complete===void 0&&(s.complete=la);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function G_(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function la(){}function ye(n){return n&&n._delegate?n._delegate:n}class gn{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const On="[DEFAULT]";class K_{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new P_;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(X_(e))try{this.getOrInitializeService({instanceIdentifier:On})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=On){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=On){return this.instances.has(e)}getOptions(e=On){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[i,a]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(i);r===c&&a.resolve(s)}return s}onInit(e,t){const r=this.normalizeInstanceIdentifier(t),s=this.onInitCallbacks.get(r)??new Set;s.add(e),this.onInitCallbacks.set(r,s);const i=this.instances.get(r);return i&&e(i,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const s of r)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Q_(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=On){return this.component?this.component.multipleInstances?e:On:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Q_(n){return n===On?void 0:n}function X_(n){return n.instantiationMode==="EAGER"}class J_{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new K_(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var G;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(G||(G={}));const Y_={debug:G.DEBUG,verbose:G.VERBOSE,info:G.INFO,warn:G.WARN,error:G.ERROR,silent:G.SILENT},Z_=G.INFO,ey={[G.DEBUG]:"log",[G.VERBOSE]:"log",[G.INFO]:"info",[G.WARN]:"warn",[G.ERROR]:"error"},ty=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),s=ey[e];if(s)console[s](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Ic{constructor(e){this.name=e,this._logLevel=Z_,this._logHandler=ty,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in G))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Y_[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,G.DEBUG,...e),this._logHandler(this,G.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,G.VERBOSE,...e),this._logHandler(this,G.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,G.INFO,...e),this._logHandler(this,G.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,G.WARN,...e),this._logHandler(this,G.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,G.ERROR,...e),this._logHandler(this,G.ERROR,...e)}}const ny=(n,e)=>e.some(t=>n instanceof t);let Nl,Dl;function ry(){return Nl||(Nl=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function sy(){return Dl||(Dl=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const nd=new WeakMap,Va=new WeakMap,rd=new WeakMap,ha=new WeakMap,Ac=new WeakMap;function iy(n){const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("success",i),n.removeEventListener("error",a)},i=()=>{t(ln(n.result)),s()},a=()=>{r(n.error),s()};n.addEventListener("success",i),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&nd.set(t,n)}).catch(()=>{}),Ac.set(e,n),e}function oy(n){if(Va.has(n))return;const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("complete",i),n.removeEventListener("error",a),n.removeEventListener("abort",a)},i=()=>{t(),s()},a=()=>{r(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",i),n.addEventListener("error",a),n.addEventListener("abort",a)});Va.set(n,e)}let Oa={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Va.get(n);if(e==="objectStoreNames")return n.objectStoreNames||rd.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return ln(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function ay(n){Oa=n(Oa)}function cy(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(fa(this),e,...t);return rd.set(r,e.sort?e.sort():[e]),ln(r)}:sy().includes(n)?function(...e){return n.apply(fa(this),e),ln(nd.get(this))}:function(...e){return ln(n.apply(fa(this),e))}}function uy(n){return typeof n=="function"?cy(n):(n instanceof IDBTransaction&&oy(n),ny(n,ry())?new Proxy(n,Oa):n)}function ln(n){if(n instanceof IDBRequest)return iy(n);if(ha.has(n))return ha.get(n);const e=uy(n);return e!==n&&(ha.set(n,e),Ac.set(e,n)),e}const fa=n=>Ac.get(n);function ly(n,e,{blocked:t,upgrade:r,blocking:s,terminated:i}={}){const a=indexedDB.open(n,e),c=ln(a);return r&&a.addEventListener("upgradeneeded",l=>{r(ln(a.result),l.oldVersion,l.newVersion,ln(a.transaction),l)}),t&&a.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),c.then(l=>{i&&l.addEventListener("close",()=>i()),s&&l.addEventListener("versionchange",h=>s(h.oldVersion,h.newVersion,h))}).catch(()=>{}),c}const hy=["get","getKey","getAll","getAllKeys","count"],fy=["put","add","delete","clear"],da=new Map;function Vl(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(da.get(e))return da.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,s=fy.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(s||hy.includes(t)))return;const i=async function(a,...c){const l=this.transaction(a,s?"readwrite":"readonly");let h=l.store;return r&&(h=h.index(c.shift())),(await Promise.all([h[t](...c),s&&l.done]))[0]};return da.set(e,i),i}ay(n=>({...n,get:(e,t,r)=>Vl(e,t)||n.get(e,t,r),has:(e,t)=>!!Vl(e,t)||n.has(e,t)}));class dy{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(py(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function py(n){return n.getComponent()?.type==="VERSION"}const Ma="@firebase/app",Ol="0.14.5";const Bt=new Ic("@firebase/app"),my="@firebase/app-compat",gy="@firebase/analytics-compat",_y="@firebase/analytics",yy="@firebase/app-check-compat",vy="@firebase/app-check",Ey="@firebase/auth",Ty="@firebase/auth-compat",wy="@firebase/database",Iy="@firebase/data-connect",Ay="@firebase/database-compat",by="@firebase/functions",Sy="@firebase/functions-compat",Ry="@firebase/installations",Py="@firebase/installations-compat",Cy="@firebase/messaging",ky="@firebase/messaging-compat",Ny="@firebase/performance",Dy="@firebase/performance-compat",Vy="@firebase/remote-config",Oy="@firebase/remote-config-compat",My="@firebase/storage",Ly="@firebase/storage-compat",xy="@firebase/firestore",Fy="@firebase/ai",Uy="@firebase/firestore-compat",By="firebase",$y="12.5.0";const La="[DEFAULT]",jy={[Ma]:"fire-core",[my]:"fire-core-compat",[_y]:"fire-analytics",[gy]:"fire-analytics-compat",[vy]:"fire-app-check",[yy]:"fire-app-check-compat",[Ey]:"fire-auth",[Ty]:"fire-auth-compat",[wy]:"fire-rtdb",[Iy]:"fire-data-connect",[Ay]:"fire-rtdb-compat",[by]:"fire-fn",[Sy]:"fire-fn-compat",[Ry]:"fire-iid",[Py]:"fire-iid-compat",[Cy]:"fire-fcm",[ky]:"fire-fcm-compat",[Ny]:"fire-perf",[Dy]:"fire-perf-compat",[Vy]:"fire-rc",[Oy]:"fire-rc-compat",[My]:"fire-gcs",[Ly]:"fire-gcs-compat",[xy]:"fire-fst",[Uy]:"fire-fst-compat",[Fy]:"fire-vertex","fire-js":"fire-js",[By]:"fire-js-all"};const Oi=new Map,qy=new Map,xa=new Map;function Ml(n,e){try{n.container.addComponent(e)}catch(t){Bt.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Kn(n){const e=n.name;if(xa.has(e))return Bt.debug(`There were multiple attempts to register component ${e}.`),!1;xa.set(e,n);for(const t of Oi.values())Ml(t,n);for(const t of qy.values())Ml(t,n);return!0}function po(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function it(n){return n==null?!1:n.settings!==void 0}const zy={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},hn=new js("app","Firebase",zy);class Hy{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new gn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw hn.create("app-deleted",{appName:this._name})}}const zr=$y;function sd(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r={name:La,automaticDataCollectionEnabled:!0,...e},s=r.name;if(typeof s!="string"||!s)throw hn.create("bad-app-name",{appName:String(s)});if(t||(t=ed()),!t)throw hn.create("no-options");const i=Oi.get(s);if(i){if(Gn(t,i.options)&&Gn(r,i.config))return i;throw hn.create("duplicate-app",{appName:s})}const a=new J_(s);for(const l of xa.values())a.addComponent(l);const c=new Hy(t,r,a);return Oi.set(s,c),c}function bc(n=La){const e=Oi.get(n);if(!e&&n===La&&ed())return sd();if(!e)throw hn.create("no-app",{appName:n});return e}function wt(n,e,t){let r=jy[n]??n;t&&(r+=`-${t}`);const s=r.match(/\s|\//),i=e.match(/\s|\//);if(s||i){const a=[`Unable to register library "${r}" with version "${e}":`];s&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&i&&a.push("and"),i&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Bt.warn(a.join(" "));return}Kn(new gn(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}const Wy="firebase-heartbeat-database",Gy=1,Cs="firebase-heartbeat-store";let pa=null;function id(){return pa||(pa=ly(Wy,Gy,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Cs)}catch(t){console.warn(t)}}}}).catch(n=>{throw hn.create("idb-open",{originalErrorMessage:n.message})})),pa}async function Ky(n){try{const t=(await id()).transaction(Cs),r=await t.objectStore(Cs).get(od(n));return await t.done,r}catch(e){if(e instanceof Vt)Bt.warn(e.message);else{const t=hn.create("idb-get",{originalErrorMessage:e?.message});Bt.warn(t.message)}}}async function Ll(n,e){try{const r=(await id()).transaction(Cs,"readwrite");await r.objectStore(Cs).put(e,od(n)),await r.done}catch(t){if(t instanceof Vt)Bt.warn(t.message);else{const r=hn.create("idb-set",{originalErrorMessage:t?.message});Bt.warn(r.message)}}}function od(n){return`${n.name}!${n.options.appId}`}const Qy=1024,Xy=30;class Jy{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Zy(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=xl();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(s=>s.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:t}),this._heartbeatsCache.heartbeats.length>Xy){const s=ev(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(s,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Bt.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=xl(),{heartbeatsToSend:t,unsentEntries:r}=Yy(this._heartbeatsCache.heartbeats),s=Vi(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(e){return Bt.warn(e),""}}}function xl(){return new Date().toISOString().substring(0,10)}function Yy(n,e=Qy){const t=[];let r=n.slice();for(const s of n){const i=t.find(a=>a.agent===s.agent);if(i){if(i.dates.push(s.date),Fl(t)>e){i.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),Fl(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class Zy{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return U_()?B_().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await Ky(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Ll(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Ll(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function Fl(n){return Vi(JSON.stringify({version:2,heartbeats:n})).length}function ev(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function tv(n){Kn(new gn("platform-logger",e=>new dy(e),"PRIVATE")),Kn(new gn("heartbeat",e=>new Jy(e),"PRIVATE")),wt(Ma,Ol,n),wt(Ma,Ol,"esm2020"),wt("fire-js","")}tv("");var nv="firebase",rv="12.5.0";wt(nv,rv,"app");var Ul=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var fn,ad;(function(){var n;function e(E,_){function y(){}y.prototype=_.prototype,E.F=_.prototype,E.prototype=new y,E.prototype.constructor=E,E.D=function(I,w,A){for(var v=Array(arguments.length-2),ve=2;ve<arguments.length;ve++)v[ve-2]=arguments[ve];return _.prototype[w].apply(I,v)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(E,_,y){y||(y=0);const I=Array(16);if(typeof _=="string")for(var w=0;w<16;++w)I[w]=_.charCodeAt(y++)|_.charCodeAt(y++)<<8|_.charCodeAt(y++)<<16|_.charCodeAt(y++)<<24;else for(w=0;w<16;++w)I[w]=_[y++]|_[y++]<<8|_[y++]<<16|_[y++]<<24;_=E.g[0],y=E.g[1],w=E.g[2];let A=E.g[3],v;v=_+(A^y&(w^A))+I[0]+3614090360&4294967295,_=y+(v<<7&4294967295|v>>>25),v=A+(w^_&(y^w))+I[1]+3905402710&4294967295,A=_+(v<<12&4294967295|v>>>20),v=w+(y^A&(_^y))+I[2]+606105819&4294967295,w=A+(v<<17&4294967295|v>>>15),v=y+(_^w&(A^_))+I[3]+3250441966&4294967295,y=w+(v<<22&4294967295|v>>>10),v=_+(A^y&(w^A))+I[4]+4118548399&4294967295,_=y+(v<<7&4294967295|v>>>25),v=A+(w^_&(y^w))+I[5]+1200080426&4294967295,A=_+(v<<12&4294967295|v>>>20),v=w+(y^A&(_^y))+I[6]+2821735955&4294967295,w=A+(v<<17&4294967295|v>>>15),v=y+(_^w&(A^_))+I[7]+4249261313&4294967295,y=w+(v<<22&4294967295|v>>>10),v=_+(A^y&(w^A))+I[8]+1770035416&4294967295,_=y+(v<<7&4294967295|v>>>25),v=A+(w^_&(y^w))+I[9]+2336552879&4294967295,A=_+(v<<12&4294967295|v>>>20),v=w+(y^A&(_^y))+I[10]+4294925233&4294967295,w=A+(v<<17&4294967295|v>>>15),v=y+(_^w&(A^_))+I[11]+2304563134&4294967295,y=w+(v<<22&4294967295|v>>>10),v=_+(A^y&(w^A))+I[12]+1804603682&4294967295,_=y+(v<<7&4294967295|v>>>25),v=A+(w^_&(y^w))+I[13]+4254626195&4294967295,A=_+(v<<12&4294967295|v>>>20),v=w+(y^A&(_^y))+I[14]+2792965006&4294967295,w=A+(v<<17&4294967295|v>>>15),v=y+(_^w&(A^_))+I[15]+1236535329&4294967295,y=w+(v<<22&4294967295|v>>>10),v=_+(w^A&(y^w))+I[1]+4129170786&4294967295,_=y+(v<<5&4294967295|v>>>27),v=A+(y^w&(_^y))+I[6]+3225465664&4294967295,A=_+(v<<9&4294967295|v>>>23),v=w+(_^y&(A^_))+I[11]+643717713&4294967295,w=A+(v<<14&4294967295|v>>>18),v=y+(A^_&(w^A))+I[0]+3921069994&4294967295,y=w+(v<<20&4294967295|v>>>12),v=_+(w^A&(y^w))+I[5]+3593408605&4294967295,_=y+(v<<5&4294967295|v>>>27),v=A+(y^w&(_^y))+I[10]+38016083&4294967295,A=_+(v<<9&4294967295|v>>>23),v=w+(_^y&(A^_))+I[15]+3634488961&4294967295,w=A+(v<<14&4294967295|v>>>18),v=y+(A^_&(w^A))+I[4]+3889429448&4294967295,y=w+(v<<20&4294967295|v>>>12),v=_+(w^A&(y^w))+I[9]+568446438&4294967295,_=y+(v<<5&4294967295|v>>>27),v=A+(y^w&(_^y))+I[14]+3275163606&4294967295,A=_+(v<<9&4294967295|v>>>23),v=w+(_^y&(A^_))+I[3]+4107603335&4294967295,w=A+(v<<14&4294967295|v>>>18),v=y+(A^_&(w^A))+I[8]+1163531501&4294967295,y=w+(v<<20&4294967295|v>>>12),v=_+(w^A&(y^w))+I[13]+2850285829&4294967295,_=y+(v<<5&4294967295|v>>>27),v=A+(y^w&(_^y))+I[2]+4243563512&4294967295,A=_+(v<<9&4294967295|v>>>23),v=w+(_^y&(A^_))+I[7]+1735328473&4294967295,w=A+(v<<14&4294967295|v>>>18),v=y+(A^_&(w^A))+I[12]+2368359562&4294967295,y=w+(v<<20&4294967295|v>>>12),v=_+(y^w^A)+I[5]+4294588738&4294967295,_=y+(v<<4&4294967295|v>>>28),v=A+(_^y^w)+I[8]+2272392833&4294967295,A=_+(v<<11&4294967295|v>>>21),v=w+(A^_^y)+I[11]+1839030562&4294967295,w=A+(v<<16&4294967295|v>>>16),v=y+(w^A^_)+I[14]+4259657740&4294967295,y=w+(v<<23&4294967295|v>>>9),v=_+(y^w^A)+I[1]+2763975236&4294967295,_=y+(v<<4&4294967295|v>>>28),v=A+(_^y^w)+I[4]+1272893353&4294967295,A=_+(v<<11&4294967295|v>>>21),v=w+(A^_^y)+I[7]+4139469664&4294967295,w=A+(v<<16&4294967295|v>>>16),v=y+(w^A^_)+I[10]+3200236656&4294967295,y=w+(v<<23&4294967295|v>>>9),v=_+(y^w^A)+I[13]+681279174&4294967295,_=y+(v<<4&4294967295|v>>>28),v=A+(_^y^w)+I[0]+3936430074&4294967295,A=_+(v<<11&4294967295|v>>>21),v=w+(A^_^y)+I[3]+3572445317&4294967295,w=A+(v<<16&4294967295|v>>>16),v=y+(w^A^_)+I[6]+76029189&4294967295,y=w+(v<<23&4294967295|v>>>9),v=_+(y^w^A)+I[9]+3654602809&4294967295,_=y+(v<<4&4294967295|v>>>28),v=A+(_^y^w)+I[12]+3873151461&4294967295,A=_+(v<<11&4294967295|v>>>21),v=w+(A^_^y)+I[15]+530742520&4294967295,w=A+(v<<16&4294967295|v>>>16),v=y+(w^A^_)+I[2]+3299628645&4294967295,y=w+(v<<23&4294967295|v>>>9),v=_+(w^(y|~A))+I[0]+4096336452&4294967295,_=y+(v<<6&4294967295|v>>>26),v=A+(y^(_|~w))+I[7]+1126891415&4294967295,A=_+(v<<10&4294967295|v>>>22),v=w+(_^(A|~y))+I[14]+2878612391&4294967295,w=A+(v<<15&4294967295|v>>>17),v=y+(A^(w|~_))+I[5]+4237533241&4294967295,y=w+(v<<21&4294967295|v>>>11),v=_+(w^(y|~A))+I[12]+1700485571&4294967295,_=y+(v<<6&4294967295|v>>>26),v=A+(y^(_|~w))+I[3]+2399980690&4294967295,A=_+(v<<10&4294967295|v>>>22),v=w+(_^(A|~y))+I[10]+4293915773&4294967295,w=A+(v<<15&4294967295|v>>>17),v=y+(A^(w|~_))+I[1]+2240044497&4294967295,y=w+(v<<21&4294967295|v>>>11),v=_+(w^(y|~A))+I[8]+1873313359&4294967295,_=y+(v<<6&4294967295|v>>>26),v=A+(y^(_|~w))+I[15]+4264355552&4294967295,A=_+(v<<10&4294967295|v>>>22),v=w+(_^(A|~y))+I[6]+2734768916&4294967295,w=A+(v<<15&4294967295|v>>>17),v=y+(A^(w|~_))+I[13]+1309151649&4294967295,y=w+(v<<21&4294967295|v>>>11),v=_+(w^(y|~A))+I[4]+4149444226&4294967295,_=y+(v<<6&4294967295|v>>>26),v=A+(y^(_|~w))+I[11]+3174756917&4294967295,A=_+(v<<10&4294967295|v>>>22),v=w+(_^(A|~y))+I[2]+718787259&4294967295,w=A+(v<<15&4294967295|v>>>17),v=y+(A^(w|~_))+I[9]+3951481745&4294967295,E.g[0]=E.g[0]+_&4294967295,E.g[1]=E.g[1]+(w+(v<<21&4294967295|v>>>11))&4294967295,E.g[2]=E.g[2]+w&4294967295,E.g[3]=E.g[3]+A&4294967295}r.prototype.v=function(E,_){_===void 0&&(_=E.length);const y=_-this.blockSize,I=this.C;let w=this.h,A=0;for(;A<_;){if(w==0)for(;A<=y;)s(this,E,A),A+=this.blockSize;if(typeof E=="string"){for(;A<_;)if(I[w++]=E.charCodeAt(A++),w==this.blockSize){s(this,I),w=0;break}}else for(;A<_;)if(I[w++]=E[A++],w==this.blockSize){s(this,I),w=0;break}}this.h=w,this.o+=_},r.prototype.A=function(){var E=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);E[0]=128;for(var _=1;_<E.length-8;++_)E[_]=0;_=this.o*8;for(var y=E.length-8;y<E.length;++y)E[y]=_&255,_/=256;for(this.v(E),E=Array(16),_=0,y=0;y<4;++y)for(let I=0;I<32;I+=8)E[_++]=this.g[y]>>>I&255;return E};function i(E,_){var y=c;return Object.prototype.hasOwnProperty.call(y,E)?y[E]:y[E]=_(E)}function a(E,_){this.h=_;const y=[];let I=!0;for(let w=E.length-1;w>=0;w--){const A=E[w]|0;I&&A==_||(y[w]=A,I=!1)}this.g=y}var c={};function l(E){return-128<=E&&E<128?i(E,function(_){return new a([_|0],_<0?-1:0)}):new a([E|0],E<0?-1:0)}function h(E){if(isNaN(E)||!isFinite(E))return m;if(E<0)return R(h(-E));const _=[];let y=1;for(let I=0;E>=y;I++)_[I]=E/y|0,y*=4294967296;return new a(_,0)}function d(E,_){if(E.length==0)throw Error("number format error: empty string");if(_=_||10,_<2||36<_)throw Error("radix out of range: "+_);if(E.charAt(0)=="-")return R(d(E.substring(1),_));if(E.indexOf("-")>=0)throw Error('number format error: interior "-" character');const y=h(Math.pow(_,8));let I=m;for(let A=0;A<E.length;A+=8){var w=Math.min(8,E.length-A);const v=parseInt(E.substring(A,A+w),_);w<8?(w=h(Math.pow(_,w)),I=I.j(w).add(h(v))):(I=I.j(y),I=I.add(h(v)))}return I}var m=l(0),g=l(1),T=l(16777216);n=a.prototype,n.m=function(){if(C(this))return-R(this).m();let E=0,_=1;for(let y=0;y<this.g.length;y++){const I=this.i(y);E+=(I>=0?I:4294967296+I)*_,_*=4294967296}return E},n.toString=function(E){if(E=E||10,E<2||36<E)throw Error("radix out of range: "+E);if(S(this))return"0";if(C(this))return"-"+R(this).toString(E);const _=h(Math.pow(E,6));var y=this;let I="";for(;;){const w=z(y,_).g;y=L(y,w.j(_));let A=((y.g.length>0?y.g[0]:y.h)>>>0).toString(E);if(y=w,S(y))return A+I;for(;A.length<6;)A="0"+A;I=A+I}},n.i=function(E){return E<0?0:E<this.g.length?this.g[E]:this.h};function S(E){if(E.h!=0)return!1;for(let _=0;_<E.g.length;_++)if(E.g[_]!=0)return!1;return!0}function C(E){return E.h==-1}n.l=function(E){return E=L(this,E),C(E)?-1:S(E)?0:1};function R(E){const _=E.g.length,y=[];for(let I=0;I<_;I++)y[I]=~E.g[I];return new a(y,~E.h).add(g)}n.abs=function(){return C(this)?R(this):this},n.add=function(E){const _=Math.max(this.g.length,E.g.length),y=[];let I=0;for(let w=0;w<=_;w++){let A=I+(this.i(w)&65535)+(E.i(w)&65535),v=(A>>>16)+(this.i(w)>>>16)+(E.i(w)>>>16);I=v>>>16,A&=65535,v&=65535,y[w]=v<<16|A}return new a(y,y[y.length-1]&-2147483648?-1:0)};function L(E,_){return E.add(R(_))}n.j=function(E){if(S(this)||S(E))return m;if(C(this))return C(E)?R(this).j(R(E)):R(R(this).j(E));if(C(E))return R(this.j(R(E)));if(this.l(T)<0&&E.l(T)<0)return h(this.m()*E.m());const _=this.g.length+E.g.length,y=[];for(var I=0;I<2*_;I++)y[I]=0;for(I=0;I<this.g.length;I++)for(let w=0;w<E.g.length;w++){const A=this.i(I)>>>16,v=this.i(I)&65535,ve=E.i(w)>>>16,Ne=E.i(w)&65535;y[2*I+2*w]+=v*Ne,O(y,2*I+2*w),y[2*I+2*w+1]+=A*Ne,O(y,2*I+2*w+1),y[2*I+2*w+1]+=v*ve,O(y,2*I+2*w+1),y[2*I+2*w+2]+=A*ve,O(y,2*I+2*w+2)}for(E=0;E<_;E++)y[E]=y[2*E+1]<<16|y[2*E];for(E=_;E<2*_;E++)y[E]=0;return new a(y,0)};function O(E,_){for(;(E[_]&65535)!=E[_];)E[_+1]+=E[_]>>>16,E[_]&=65535,_++}function D(E,_){this.g=E,this.h=_}function z(E,_){if(S(_))throw Error("division by zero");if(S(E))return new D(m,m);if(C(E))return _=z(R(E),_),new D(R(_.g),R(_.h));if(C(_))return _=z(E,R(_)),new D(R(_.g),_.h);if(E.g.length>30){if(C(E)||C(_))throw Error("slowDivide_ only works with positive integers.");for(var y=g,I=_;I.l(E)<=0;)y=J(y),I=J(I);var w=ee(y,1),A=ee(I,1);for(I=ee(I,2),y=ee(y,2);!S(I);){var v=A.add(I);v.l(E)<=0&&(w=w.add(y),A=v),I=ee(I,1),y=ee(y,1)}return _=L(E,w.j(_)),new D(w,_)}for(w=m;E.l(_)>=0;){for(y=Math.max(1,Math.floor(E.m()/_.m())),I=Math.ceil(Math.log(y)/Math.LN2),I=I<=48?1:Math.pow(2,I-48),A=h(y),v=A.j(_);C(v)||v.l(E)>0;)y-=I,A=h(y),v=A.j(_);S(A)&&(A=g),w=w.add(A),E=L(E,v)}return new D(w,E)}n.B=function(E){return z(this,E).h},n.and=function(E){const _=Math.max(this.g.length,E.g.length),y=[];for(let I=0;I<_;I++)y[I]=this.i(I)&E.i(I);return new a(y,this.h&E.h)},n.or=function(E){const _=Math.max(this.g.length,E.g.length),y=[];for(let I=0;I<_;I++)y[I]=this.i(I)|E.i(I);return new a(y,this.h|E.h)},n.xor=function(E){const _=Math.max(this.g.length,E.g.length),y=[];for(let I=0;I<_;I++)y[I]=this.i(I)^E.i(I);return new a(y,this.h^E.h)};function J(E){const _=E.g.length+1,y=[];for(let I=0;I<_;I++)y[I]=E.i(I)<<1|E.i(I-1)>>>31;return new a(y,E.h)}function ee(E,_){const y=_>>5;_%=32;const I=E.g.length-y,w=[];for(let A=0;A<I;A++)w[A]=_>0?E.i(A+y)>>>_|E.i(A+y+1)<<32-_:E.i(A+y);return new a(w,E.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,ad=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.B,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=h,a.fromString=d,fn=a}).apply(typeof Ul<"u"?Ul:typeof self<"u"?self:typeof window<"u"?window:{});var di=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var cd,ds,ud,Ei,Fa,ld,hd,fd;(function(){var n,e=Object.defineProperty;function t(o){o=[typeof globalThis=="object"&&globalThis,o,typeof window=="object"&&window,typeof self=="object"&&self,typeof di=="object"&&di];for(var u=0;u<o.length;++u){var f=o[u];if(f&&f.Math==Math)return f}throw Error("Cannot find global object")}var r=t(this);function s(o,u){if(u)e:{var f=r;o=o.split(".");for(var p=0;p<o.length-1;p++){var b=o[p];if(!(b in f))break e;f=f[b]}o=o[o.length-1],p=f[o],u=u(p),u!=p&&u!=null&&e(f,o,{configurable:!0,writable:!0,value:u})}}s("Symbol.dispose",function(o){return o||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(o){return o||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(o){return o||function(u){var f=[],p;for(p in u)Object.prototype.hasOwnProperty.call(u,p)&&f.push([p,u[p]]);return f}});var i=i||{},a=this||self;function c(o){var u=typeof o;return u=="object"&&o!=null||u=="function"}function l(o,u,f){return o.call.apply(o.bind,arguments)}function h(o,u,f){return h=l,h.apply(null,arguments)}function d(o,u){var f=Array.prototype.slice.call(arguments,1);return function(){var p=f.slice();return p.push.apply(p,arguments),o.apply(this,p)}}function m(o,u){function f(){}f.prototype=u.prototype,o.Z=u.prototype,o.prototype=new f,o.prototype.constructor=o,o.Ob=function(p,b,P){for(var V=Array(arguments.length-2),H=2;H<arguments.length;H++)V[H-2]=arguments[H];return u.prototype[b].apply(p,V)}}var g=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?o=>o&&AsyncContext.Snapshot.wrap(o):o=>o;function T(o){const u=o.length;if(u>0){const f=Array(u);for(let p=0;p<u;p++)f[p]=o[p];return f}return[]}function S(o,u){for(let p=1;p<arguments.length;p++){const b=arguments[p];var f=typeof b;if(f=f!="object"?f:b?Array.isArray(b)?"array":f:"null",f=="array"||f=="object"&&typeof b.length=="number"){f=o.length||0;const P=b.length||0;o.length=f+P;for(let V=0;V<P;V++)o[f+V]=b[V]}else o.push(b)}}class C{constructor(u,f){this.i=u,this.j=f,this.h=0,this.g=null}get(){let u;return this.h>0?(this.h--,u=this.g,this.g=u.next,u.next=null):u=this.i(),u}}function R(o){a.setTimeout(()=>{throw o},0)}function L(){var o=E;let u=null;return o.g&&(u=o.g,o.g=o.g.next,o.g||(o.h=null),u.next=null),u}class O{constructor(){this.h=this.g=null}add(u,f){const p=D.get();p.set(u,f),this.h?this.h.next=p:this.g=p,this.h=p}}var D=new C(()=>new z,o=>o.reset());class z{constructor(){this.next=this.g=this.h=null}set(u,f){this.h=u,this.g=f,this.next=null}reset(){this.next=this.g=this.h=null}}let J,ee=!1,E=new O,_=()=>{const o=Promise.resolve(void 0);J=()=>{o.then(y)}};function y(){for(var o;o=L();){try{o.h.call(o.g)}catch(f){R(f)}var u=D;u.j(o),u.h<100&&(u.h++,o.next=u.g,u.g=o)}ee=!1}function I(){this.u=this.u,this.C=this.C}I.prototype.u=!1,I.prototype.dispose=function(){this.u||(this.u=!0,this.N())},I.prototype[Symbol.dispose]=function(){this.dispose()},I.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function w(o,u){this.type=o,this.g=this.target=u,this.defaultPrevented=!1}w.prototype.h=function(){this.defaultPrevented=!0};var A=(function(){if(!a.addEventListener||!Object.defineProperty)return!1;var o=!1,u=Object.defineProperty({},"passive",{get:function(){o=!0}});try{const f=()=>{};a.addEventListener("test",f,u),a.removeEventListener("test",f,u)}catch{}return o})();function v(o){return/^[\s\xa0]*$/.test(o)}function ve(o,u){w.call(this,o?o.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,o&&this.init(o,u)}m(ve,w),ve.prototype.init=function(o,u){const f=this.type=o.type,p=o.changedTouches&&o.changedTouches.length?o.changedTouches[0]:null;this.target=o.target||o.srcElement,this.g=u,u=o.relatedTarget,u||(f=="mouseover"?u=o.fromElement:f=="mouseout"&&(u=o.toElement)),this.relatedTarget=u,p?(this.clientX=p.clientX!==void 0?p.clientX:p.pageX,this.clientY=p.clientY!==void 0?p.clientY:p.pageY,this.screenX=p.screenX||0,this.screenY=p.screenY||0):(this.clientX=o.clientX!==void 0?o.clientX:o.pageX,this.clientY=o.clientY!==void 0?o.clientY:o.pageY,this.screenX=o.screenX||0,this.screenY=o.screenY||0),this.button=o.button,this.key=o.key||"",this.ctrlKey=o.ctrlKey,this.altKey=o.altKey,this.shiftKey=o.shiftKey,this.metaKey=o.metaKey,this.pointerId=o.pointerId||0,this.pointerType=o.pointerType,this.state=o.state,this.i=o,o.defaultPrevented&&ve.Z.h.call(this)},ve.prototype.h=function(){ve.Z.h.call(this);const o=this.i;o.preventDefault?o.preventDefault():o.returnValue=!1};var Ne="closure_listenable_"+(Math.random()*1e6|0),Rn=0;function nr(o,u,f,p,b){this.listener=o,this.proxy=null,this.src=u,this.type=f,this.capture=!!p,this.ha=b,this.key=++Rn,this.da=this.fa=!1}function pt(o){o.da=!0,o.listener=null,o.proxy=null,o.src=null,o.ha=null}function rt(o,u,f){for(const p in o)u.call(f,o[p],p,o)}function rr(o,u){for(const f in o)u.call(void 0,o[f],f,o)}function Pn(o){const u={};for(const f in o)u[f]=o[f];return u}const Gt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Lo(o,u){let f,p;for(let b=1;b<arguments.length;b++){p=arguments[b];for(f in p)o[f]=p[f];for(let P=0;P<Gt.length;P++)f=Gt[P],Object.prototype.hasOwnProperty.call(p,f)&&(o[f]=p[f])}}function Ys(o){this.src=o,this.g={},this.h=0}Ys.prototype.add=function(o,u,f,p,b){const P=o.toString();o=this.g[P],o||(o=this.g[P]=[],this.h++);const V=Fo(o,u,p,b);return V>-1?(u=o[V],f||(u.fa=!1)):(u=new nr(u,this.src,P,!!p,b),u.fa=f,o.push(u)),u};function xo(o,u){const f=u.type;if(f in o.g){var p=o.g[f],b=Array.prototype.indexOf.call(p,u,void 0),P;(P=b>=0)&&Array.prototype.splice.call(p,b,1),P&&(pt(u),o.g[f].length==0&&(delete o.g[f],o.h--))}}function Fo(o,u,f,p){for(let b=0;b<o.length;++b){const P=o[b];if(!P.da&&P.listener==u&&P.capture==!!f&&P.ha==p)return b}return-1}var Uo="closure_lm_"+(Math.random()*1e6|0),Bo={};function yu(o,u,f,p,b){if(Array.isArray(u)){for(let P=0;P<u.length;P++)yu(o,u[P],f,p,b);return null}return f=Tu(f),o&&o[Ne]?o.J(u,f,c(p)?!!p.capture:!1,b):gm(o,u,f,!1,p,b)}function gm(o,u,f,p,b,P){if(!u)throw Error("Invalid event type");const V=c(b)?!!b.capture:!!b;let H=jo(o);if(H||(o[Uo]=H=new Ys(o)),f=H.add(u,f,p,V,P),f.proxy)return f;if(p=_m(),f.proxy=p,p.src=o,p.listener=f,o.addEventListener)A||(b=V),b===void 0&&(b=!1),o.addEventListener(u.toString(),p,b);else if(o.attachEvent)o.attachEvent(Eu(u.toString()),p);else if(o.addListener&&o.removeListener)o.addListener(p);else throw Error("addEventListener and attachEvent are unavailable.");return f}function _m(){function o(f){return u.call(o.src,o.listener,f)}const u=ym;return o}function vu(o,u,f,p,b){if(Array.isArray(u))for(var P=0;P<u.length;P++)vu(o,u[P],f,p,b);else p=c(p)?!!p.capture:!!p,f=Tu(f),o&&o[Ne]?(o=o.i,P=String(u).toString(),P in o.g&&(u=o.g[P],f=Fo(u,f,p,b),f>-1&&(pt(u[f]),Array.prototype.splice.call(u,f,1),u.length==0&&(delete o.g[P],o.h--)))):o&&(o=jo(o))&&(u=o.g[u.toString()],o=-1,u&&(o=Fo(u,f,p,b)),(f=o>-1?u[o]:null)&&$o(f))}function $o(o){if(typeof o!="number"&&o&&!o.da){var u=o.src;if(u&&u[Ne])xo(u.i,o);else{var f=o.type,p=o.proxy;u.removeEventListener?u.removeEventListener(f,p,o.capture):u.detachEvent?u.detachEvent(Eu(f),p):u.addListener&&u.removeListener&&u.removeListener(p),(f=jo(u))?(xo(f,o),f.h==0&&(f.src=null,u[Uo]=null)):pt(o)}}}function Eu(o){return o in Bo?Bo[o]:Bo[o]="on"+o}function ym(o,u){if(o.da)o=!0;else{u=new ve(u,this);const f=o.listener,p=o.ha||o.src;o.fa&&$o(o),o=f.call(p,u)}return o}function jo(o){return o=o[Uo],o instanceof Ys?o:null}var qo="__closure_events_fn_"+(Math.random()*1e9>>>0);function Tu(o){return typeof o=="function"?o:(o[qo]||(o[qo]=function(u){return o.handleEvent(u)}),o[qo])}function De(){I.call(this),this.i=new Ys(this),this.M=this,this.G=null}m(De,I),De.prototype[Ne]=!0,De.prototype.removeEventListener=function(o,u,f,p){vu(this,o,u,f,p)};function Ue(o,u){var f,p=o.G;if(p)for(f=[];p;p=p.G)f.push(p);if(o=o.M,p=u.type||u,typeof u=="string")u=new w(u,o);else if(u instanceof w)u.target=u.target||o;else{var b=u;u=new w(p,o),Lo(u,b)}b=!0;let P,V;if(f)for(V=f.length-1;V>=0;V--)P=u.g=f[V],b=Zs(P,p,!0,u)&&b;if(P=u.g=o,b=Zs(P,p,!0,u)&&b,b=Zs(P,p,!1,u)&&b,f)for(V=0;V<f.length;V++)P=u.g=f[V],b=Zs(P,p,!1,u)&&b}De.prototype.N=function(){if(De.Z.N.call(this),this.i){var o=this.i;for(const u in o.g){const f=o.g[u];for(let p=0;p<f.length;p++)pt(f[p]);delete o.g[u],o.h--}}this.G=null},De.prototype.J=function(o,u,f,p){return this.i.add(String(o),u,!1,f,p)},De.prototype.K=function(o,u,f,p){return this.i.add(String(o),u,!0,f,p)};function Zs(o,u,f,p){if(u=o.i.g[String(u)],!u)return!0;u=u.concat();let b=!0;for(let P=0;P<u.length;++P){const V=u[P];if(V&&!V.da&&V.capture==f){const H=V.listener,Ee=V.ha||V.src;V.fa&&xo(o.i,V),b=H.call(Ee,p)!==!1&&b}}return b&&!p.defaultPrevented}function vm(o,u){if(typeof o!="function")if(o&&typeof o.handleEvent=="function")o=h(o.handleEvent,o);else throw Error("Invalid listener argument");return Number(u)>2147483647?-1:a.setTimeout(o,u||0)}function wu(o){o.g=vm(()=>{o.g=null,o.i&&(o.i=!1,wu(o))},o.l);const u=o.h;o.h=null,o.m.apply(null,u)}class Em extends I{constructor(u,f){super(),this.m=u,this.l=f,this.h=null,this.i=!1,this.g=null}j(u){this.h=arguments,this.g?this.i=!0:wu(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Xr(o){I.call(this),this.h=o,this.g={}}m(Xr,I);var Iu=[];function Au(o){rt(o.g,function(u,f){this.g.hasOwnProperty(f)&&$o(u)},o),o.g={}}Xr.prototype.N=function(){Xr.Z.N.call(this),Au(this)},Xr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var zo=a.JSON.stringify,Tm=a.JSON.parse,wm=class{stringify(o){return a.JSON.stringify(o,void 0)}parse(o){return a.JSON.parse(o,void 0)}};function bu(){}function Su(){}var Jr={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Ho(){w.call(this,"d")}m(Ho,w);function Wo(){w.call(this,"c")}m(Wo,w);var Cn={},Ru=null;function ei(){return Ru=Ru||new De}Cn.Ia="serverreachability";function Pu(o){w.call(this,Cn.Ia,o)}m(Pu,w);function Yr(o){const u=ei();Ue(u,new Pu(u))}Cn.STAT_EVENT="statevent";function Cu(o,u){w.call(this,Cn.STAT_EVENT,o),this.stat=u}m(Cu,w);function Be(o){const u=ei();Ue(u,new Cu(u,o))}Cn.Ja="timingevent";function ku(o,u){w.call(this,Cn.Ja,o),this.size=u}m(ku,w);function Zr(o,u){if(typeof o!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){o()},u)}function es(){this.g=!0}es.prototype.ua=function(){this.g=!1};function Im(o,u,f,p,b,P){o.info(function(){if(o.g)if(P){var V="",H=P.split("&");for(let ne=0;ne<H.length;ne++){var Ee=H[ne].split("=");if(Ee.length>1){const Ae=Ee[0];Ee=Ee[1];const gt=Ae.split("_");V=gt.length>=2&&gt[1]=="type"?V+(Ae+"="+Ee+"&"):V+(Ae+"=redacted&")}}}else V=null;else V=P;return"XMLHTTP REQ ("+p+") [attempt "+b+"]: "+u+`
`+f+`
`+V})}function Am(o,u,f,p,b,P,V){o.info(function(){return"XMLHTTP RESP ("+p+") [ attempt "+b+"]: "+u+`
`+f+`
`+P+" "+V})}function sr(o,u,f,p){o.info(function(){return"XMLHTTP TEXT ("+u+"): "+Sm(o,f)+(p?" "+p:"")})}function bm(o,u){o.info(function(){return"TIMEOUT: "+u})}es.prototype.info=function(){};function Sm(o,u){if(!o.g)return u;if(!u)return null;try{const P=JSON.parse(u);if(P){for(o=0;o<P.length;o++)if(Array.isArray(P[o])){var f=P[o];if(!(f.length<2)){var p=f[1];if(Array.isArray(p)&&!(p.length<1)){var b=p[0];if(b!="noop"&&b!="stop"&&b!="close")for(let V=1;V<p.length;V++)p[V]=""}}}}return zo(P)}catch{return u}}var ti={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Nu={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Du;function Go(){}m(Go,bu),Go.prototype.g=function(){return new XMLHttpRequest},Du=new Go;function ts(o){return encodeURIComponent(String(o))}function Rm(o){var u=1;o=o.split(":");const f=[];for(;u>0&&o.length;)f.push(o.shift()),u--;return o.length&&f.push(o.join(":")),f}function Kt(o,u,f,p){this.j=o,this.i=u,this.l=f,this.S=p||1,this.V=new Xr(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Vu}function Vu(){this.i=null,this.g="",this.h=!1}var Ou={},Ko={};function Qo(o,u,f){o.M=1,o.A=ri(mt(u)),o.u=f,o.R=!0,Mu(o,null)}function Mu(o,u){o.F=Date.now(),ni(o),o.B=mt(o.A);var f=o.B,p=o.S;Array.isArray(p)||(p=[String(p)]),Ku(f.i,"t",p),o.C=0,f=o.j.L,o.h=new Vu,o.g=fl(o.j,f?u:null,!o.u),o.P>0&&(o.O=new Em(h(o.Y,o,o.g),o.P)),u=o.V,f=o.g,p=o.ba;var b="readystatechange";Array.isArray(b)||(b&&(Iu[0]=b.toString()),b=Iu);for(let P=0;P<b.length;P++){const V=yu(f,b[P],p||u.handleEvent,!1,u.h||u);if(!V)break;u.g[V.key]=V}u=o.J?Pn(o.J):{},o.u?(o.v||(o.v="POST"),u["Content-Type"]="application/x-www-form-urlencoded",o.g.ea(o.B,o.v,o.u,u)):(o.v="GET",o.g.ea(o.B,o.v,null,u)),Yr(),Im(o.i,o.v,o.B,o.l,o.S,o.u)}Kt.prototype.ba=function(o){o=o.target;const u=this.O;u&&Jt(o)==3?u.j():this.Y(o)},Kt.prototype.Y=function(o){try{if(o==this.g)e:{const H=Jt(this.g),Ee=this.g.ya(),ne=this.g.ca();if(!(H<3)&&(H!=3||this.g&&(this.h.h||this.g.la()||tl(this.g)))){this.K||H!=4||Ee==7||(Ee==8||ne<=0?Yr(3):Yr(2)),Xo(this);var u=this.g.ca();this.X=u;var f=Pm(this);if(this.o=u==200,Am(this.i,this.v,this.B,this.l,this.S,H,u),this.o){if(this.U&&!this.L){t:{if(this.g){var p,b=this.g;if((p=b.g?b.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!v(p)){var P=p;break t}}P=null}if(o=P)sr(this.i,this.l,o,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Jo(this,o);else{this.o=!1,this.m=3,Be(12),kn(this),ns(this);break e}}if(this.R){o=!0;let Ae;for(;!this.K&&this.C<f.length;)if(Ae=Cm(this,f),Ae==Ko){H==4&&(this.m=4,Be(14),o=!1),sr(this.i,this.l,null,"[Incomplete Response]");break}else if(Ae==Ou){this.m=4,Be(15),sr(this.i,this.l,f,"[Invalid Chunk]"),o=!1;break}else sr(this.i,this.l,Ae,null),Jo(this,Ae);if(Lu(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),H!=4||f.length!=0||this.h.h||(this.m=1,Be(16),o=!1),this.o=this.o&&o,!o)sr(this.i,this.l,f,"[Invalid Chunked Response]"),kn(this),ns(this);else if(f.length>0&&!this.W){this.W=!0;var V=this.j;V.g==this&&V.aa&&!V.P&&(V.j.info("Great, no buffering proxy detected. Bytes received: "+f.length),ia(V),V.P=!0,Be(11))}}else sr(this.i,this.l,f,null),Jo(this,f);H==4&&kn(this),this.o&&!this.K&&(H==4?cl(this.j,this):(this.o=!1,ni(this)))}else qm(this.g),u==400&&f.indexOf("Unknown SID")>0?(this.m=3,Be(12)):(this.m=0,Be(13)),kn(this),ns(this)}}}catch{}finally{}};function Pm(o){if(!Lu(o))return o.g.la();const u=tl(o.g);if(u==="")return"";let f="";const p=u.length,b=Jt(o.g)==4;if(!o.h.i){if(typeof TextDecoder>"u")return kn(o),ns(o),"";o.h.i=new a.TextDecoder}for(let P=0;P<p;P++)o.h.h=!0,f+=o.h.i.decode(u[P],{stream:!(b&&P==p-1)});return u.length=0,o.h.g+=f,o.C=0,o.h.g}function Lu(o){return o.g?o.v=="GET"&&o.M!=2&&o.j.Aa:!1}function Cm(o,u){var f=o.C,p=u.indexOf(`
`,f);return p==-1?Ko:(f=Number(u.substring(f,p)),isNaN(f)?Ou:(p+=1,p+f>u.length?Ko:(u=u.slice(p,p+f),o.C=p+f,u)))}Kt.prototype.cancel=function(){this.K=!0,kn(this)};function ni(o){o.T=Date.now()+o.H,xu(o,o.H)}function xu(o,u){if(o.D!=null)throw Error("WatchDog timer not null");o.D=Zr(h(o.aa,o),u)}function Xo(o){o.D&&(a.clearTimeout(o.D),o.D=null)}Kt.prototype.aa=function(){this.D=null;const o=Date.now();o-this.T>=0?(bm(this.i,this.B),this.M!=2&&(Yr(),Be(17)),kn(this),this.m=2,ns(this)):xu(this,this.T-o)};function ns(o){o.j.I==0||o.K||cl(o.j,o)}function kn(o){Xo(o);var u=o.O;u&&typeof u.dispose=="function"&&u.dispose(),o.O=null,Au(o.V),o.g&&(u=o.g,o.g=null,u.abort(),u.dispose())}function Jo(o,u){try{var f=o.j;if(f.I!=0&&(f.g==o||Yo(f.h,o))){if(!o.L&&Yo(f.h,o)&&f.I==3){try{var p=f.Ba.g.parse(u)}catch{p=null}if(Array.isArray(p)&&p.length==3){var b=p;if(b[0]==0){e:if(!f.v){if(f.g)if(f.g.F+3e3<o.F)ci(f),oi(f);else break e;sa(f),Be(18)}}else f.xa=b[1],0<f.xa-f.K&&b[2]<37500&&f.F&&f.A==0&&!f.C&&(f.C=Zr(h(f.Va,f),6e3));Bu(f.h)<=1&&f.ta&&(f.ta=void 0)}else Dn(f,11)}else if((o.L||f.g==o)&&ci(f),!v(u))for(b=f.Ba.g.parse(u),u=0;u<b.length;u++){let ne=b[u];const Ae=ne[0];if(!(Ae<=f.K))if(f.K=Ae,ne=ne[1],f.I==2)if(ne[0]=="c"){f.M=ne[1],f.ba=ne[2];const gt=ne[3];gt!=null&&(f.ka=gt,f.j.info("VER="+f.ka));const Vn=ne[4];Vn!=null&&(f.za=Vn,f.j.info("SVER="+f.za));const Yt=ne[5];Yt!=null&&typeof Yt=="number"&&Yt>0&&(p=1.5*Yt,f.O=p,f.j.info("backChannelRequestTimeoutMs_="+p)),p=f;const Zt=o.g;if(Zt){const li=Zt.g?Zt.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(li){var P=p.h;P.g||li.indexOf("spdy")==-1&&li.indexOf("quic")==-1&&li.indexOf("h2")==-1||(P.j=P.l,P.g=new Set,P.h&&(Zo(P,P.h),P.h=null))}if(p.G){const oa=Zt.g?Zt.g.getResponseHeader("X-HTTP-Session-Id"):null;oa&&(p.wa=oa,oe(p.J,p.G,oa))}}f.I=3,f.l&&f.l.ra(),f.aa&&(f.T=Date.now()-o.F,f.j.info("Handshake RTT: "+f.T+"ms")),p=f;var V=o;if(p.na=hl(p,p.L?p.ba:null,p.W),V.L){$u(p.h,V);var H=V,Ee=p.O;Ee&&(H.H=Ee),H.D&&(Xo(H),ni(H)),p.g=V}else ol(p);f.i.length>0&&ai(f)}else ne[0]!="stop"&&ne[0]!="close"||Dn(f,7);else f.I==3&&(ne[0]=="stop"||ne[0]=="close"?ne[0]=="stop"?Dn(f,7):ra(f):ne[0]!="noop"&&f.l&&f.l.qa(ne),f.A=0)}}Yr(4)}catch{}}var km=class{constructor(o,u){this.g=o,this.map=u}};function Fu(o){this.l=o||10,a.PerformanceNavigationTiming?(o=a.performance.getEntriesByType("navigation"),o=o.length>0&&(o[0].nextHopProtocol=="hq"||o[0].nextHopProtocol=="h2")):o=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=o?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Uu(o){return o.h?!0:o.g?o.g.size>=o.j:!1}function Bu(o){return o.h?1:o.g?o.g.size:0}function Yo(o,u){return o.h?o.h==u:o.g?o.g.has(u):!1}function Zo(o,u){o.g?o.g.add(u):o.h=u}function $u(o,u){o.h&&o.h==u?o.h=null:o.g&&o.g.has(u)&&o.g.delete(u)}Fu.prototype.cancel=function(){if(this.i=ju(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const o of this.g.values())o.cancel();this.g.clear()}};function ju(o){if(o.h!=null)return o.i.concat(o.h.G);if(o.g!=null&&o.g.size!==0){let u=o.i;for(const f of o.g.values())u=u.concat(f.G);return u}return T(o.i)}var qu=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Nm(o,u){if(o){o=o.split("&");for(let f=0;f<o.length;f++){const p=o[f].indexOf("=");let b,P=null;p>=0?(b=o[f].substring(0,p),P=o[f].substring(p+1)):b=o[f],u(b,P?decodeURIComponent(P.replace(/\+/g," ")):"")}}}function Qt(o){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let u;o instanceof Qt?(this.l=o.l,rs(this,o.j),this.o=o.o,this.g=o.g,ss(this,o.u),this.h=o.h,ea(this,Qu(o.i)),this.m=o.m):o&&(u=String(o).match(qu))?(this.l=!1,rs(this,u[1]||"",!0),this.o=is(u[2]||""),this.g=is(u[3]||"",!0),ss(this,u[4]),this.h=is(u[5]||"",!0),ea(this,u[6]||"",!0),this.m=is(u[7]||"")):(this.l=!1,this.i=new as(null,this.l))}Qt.prototype.toString=function(){const o=[];var u=this.j;u&&o.push(os(u,zu,!0),":");var f=this.g;return(f||u=="file")&&(o.push("//"),(u=this.o)&&o.push(os(u,zu,!0),"@"),o.push(ts(f).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f=this.u,f!=null&&o.push(":",String(f))),(f=this.h)&&(this.g&&f.charAt(0)!="/"&&o.push("/"),o.push(os(f,f.charAt(0)=="/"?Om:Vm,!0))),(f=this.i.toString())&&o.push("?",f),(f=this.m)&&o.push("#",os(f,Lm)),o.join("")},Qt.prototype.resolve=function(o){const u=mt(this);let f=!!o.j;f?rs(u,o.j):f=!!o.o,f?u.o=o.o:f=!!o.g,f?u.g=o.g:f=o.u!=null;var p=o.h;if(f)ss(u,o.u);else if(f=!!o.h){if(p.charAt(0)!="/")if(this.g&&!this.h)p="/"+p;else{var b=u.h.lastIndexOf("/");b!=-1&&(p=u.h.slice(0,b+1)+p)}if(b=p,b==".."||b==".")p="";else if(b.indexOf("./")!=-1||b.indexOf("/.")!=-1){p=b.lastIndexOf("/",0)==0,b=b.split("/");const P=[];for(let V=0;V<b.length;){const H=b[V++];H=="."?p&&V==b.length&&P.push(""):H==".."?((P.length>1||P.length==1&&P[0]!="")&&P.pop(),p&&V==b.length&&P.push("")):(P.push(H),p=!0)}p=P.join("/")}else p=b}return f?u.h=p:f=o.i.toString()!=="",f?ea(u,Qu(o.i)):f=!!o.m,f&&(u.m=o.m),u};function mt(o){return new Qt(o)}function rs(o,u,f){o.j=f?is(u,!0):u,o.j&&(o.j=o.j.replace(/:$/,""))}function ss(o,u){if(u){if(u=Number(u),isNaN(u)||u<0)throw Error("Bad port number "+u);o.u=u}else o.u=null}function ea(o,u,f){u instanceof as?(o.i=u,xm(o.i,o.l)):(f||(u=os(u,Mm)),o.i=new as(u,o.l))}function oe(o,u,f){o.i.set(u,f)}function ri(o){return oe(o,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),o}function is(o,u){return o?u?decodeURI(o.replace(/%25/g,"%2525")):decodeURIComponent(o):""}function os(o,u,f){return typeof o=="string"?(o=encodeURI(o).replace(u,Dm),f&&(o=o.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),o):null}function Dm(o){return o=o.charCodeAt(0),"%"+(o>>4&15).toString(16)+(o&15).toString(16)}var zu=/[#\/\?@]/g,Vm=/[#\?:]/g,Om=/[#\?]/g,Mm=/[#\?@]/g,Lm=/#/g;function as(o,u){this.h=this.g=null,this.i=o||null,this.j=!!u}function Nn(o){o.g||(o.g=new Map,o.h=0,o.i&&Nm(o.i,function(u,f){o.add(decodeURIComponent(u.replace(/\+/g," ")),f)}))}n=as.prototype,n.add=function(o,u){Nn(this),this.i=null,o=ir(this,o);let f=this.g.get(o);return f||this.g.set(o,f=[]),f.push(u),this.h+=1,this};function Hu(o,u){Nn(o),u=ir(o,u),o.g.has(u)&&(o.i=null,o.h-=o.g.get(u).length,o.g.delete(u))}function Wu(o,u){return Nn(o),u=ir(o,u),o.g.has(u)}n.forEach=function(o,u){Nn(this),this.g.forEach(function(f,p){f.forEach(function(b){o.call(u,b,p,this)},this)},this)};function Gu(o,u){Nn(o);let f=[];if(typeof u=="string")Wu(o,u)&&(f=f.concat(o.g.get(ir(o,u))));else for(o=Array.from(o.g.values()),u=0;u<o.length;u++)f=f.concat(o[u]);return f}n.set=function(o,u){return Nn(this),this.i=null,o=ir(this,o),Wu(this,o)&&(this.h-=this.g.get(o).length),this.g.set(o,[u]),this.h+=1,this},n.get=function(o,u){return o?(o=Gu(this,o),o.length>0?String(o[0]):u):u};function Ku(o,u,f){Hu(o,u),f.length>0&&(o.i=null,o.g.set(ir(o,u),T(f)),o.h+=f.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const o=[],u=Array.from(this.g.keys());for(let p=0;p<u.length;p++){var f=u[p];const b=ts(f);f=Gu(this,f);for(let P=0;P<f.length;P++){let V=b;f[P]!==""&&(V+="="+ts(f[P])),o.push(V)}}return this.i=o.join("&")};function Qu(o){const u=new as;return u.i=o.i,o.g&&(u.g=new Map(o.g),u.h=o.h),u}function ir(o,u){return u=String(u),o.j&&(u=u.toLowerCase()),u}function xm(o,u){u&&!o.j&&(Nn(o),o.i=null,o.g.forEach(function(f,p){const b=p.toLowerCase();p!=b&&(Hu(this,p),Ku(this,b,f))},o)),o.j=u}function Fm(o,u){const f=new es;if(a.Image){const p=new Image;p.onload=d(Xt,f,"TestLoadImage: loaded",!0,u,p),p.onerror=d(Xt,f,"TestLoadImage: error",!1,u,p),p.onabort=d(Xt,f,"TestLoadImage: abort",!1,u,p),p.ontimeout=d(Xt,f,"TestLoadImage: timeout",!1,u,p),a.setTimeout(function(){p.ontimeout&&p.ontimeout()},1e4),p.src=o}else u(!1)}function Um(o,u){const f=new es,p=new AbortController,b=setTimeout(()=>{p.abort(),Xt(f,"TestPingServer: timeout",!1,u)},1e4);fetch(o,{signal:p.signal}).then(P=>{clearTimeout(b),P.ok?Xt(f,"TestPingServer: ok",!0,u):Xt(f,"TestPingServer: server error",!1,u)}).catch(()=>{clearTimeout(b),Xt(f,"TestPingServer: error",!1,u)})}function Xt(o,u,f,p,b){try{b&&(b.onload=null,b.onerror=null,b.onabort=null,b.ontimeout=null),p(f)}catch{}}function Bm(){this.g=new wm}function ta(o){this.i=o.Sb||null,this.h=o.ab||!1}m(ta,bu),ta.prototype.g=function(){return new si(this.i,this.h)};function si(o,u){De.call(this),this.H=o,this.o=u,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}m(si,De),n=si.prototype,n.open=function(o,u){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=o,this.D=u,this.readyState=1,us(this)},n.send=function(o){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const u={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};o&&(u.body=o),(this.H||a).fetch(new Request(this.D,u)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,cs(this)),this.readyState=0},n.Pa=function(o){if(this.g&&(this.l=o,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=o.headers,this.readyState=2,us(this)),this.g&&(this.readyState=3,us(this),this.g)))if(this.responseType==="arraybuffer")o.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in o){if(this.j=o.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Xu(this)}else o.text().then(this.Oa.bind(this),this.ga.bind(this))};function Xu(o){o.j.read().then(o.Ma.bind(o)).catch(o.ga.bind(o))}n.Ma=function(o){if(this.g){if(this.o&&o.value)this.response.push(o.value);else if(!this.o){var u=o.value?o.value:new Uint8Array(0);(u=this.B.decode(u,{stream:!o.done}))&&(this.response=this.responseText+=u)}o.done?cs(this):us(this),this.readyState==3&&Xu(this)}},n.Oa=function(o){this.g&&(this.response=this.responseText=o,cs(this))},n.Na=function(o){this.g&&(this.response=o,cs(this))},n.ga=function(){this.g&&cs(this)};function cs(o){o.readyState=4,o.l=null,o.j=null,o.B=null,us(o)}n.setRequestHeader=function(o,u){this.A.append(o,u)},n.getResponseHeader=function(o){return this.h&&this.h.get(o.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const o=[],u=this.h.entries();for(var f=u.next();!f.done;)f=f.value,o.push(f[0]+": "+f[1]),f=u.next();return o.join(`\r
`)};function us(o){o.onreadystatechange&&o.onreadystatechange.call(o)}Object.defineProperty(si.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(o){this.m=o?"include":"same-origin"}});function Ju(o){let u="";return rt(o,function(f,p){u+=p,u+=":",u+=f,u+=`\r
`}),u}function na(o,u,f){e:{for(p in f){var p=!1;break e}p=!0}p||(f=Ju(f),typeof o=="string"?f!=null&&ts(f):oe(o,u,f))}function de(o){De.call(this),this.headers=new Map,this.L=o||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}m(de,De);var $m=/^https?$/i,jm=["POST","PUT"];n=de.prototype,n.Fa=function(o){this.H=o},n.ea=function(o,u,f,p){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+o);u=u?u.toUpperCase():"GET",this.D=o,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Du.g(),this.g.onreadystatechange=g(h(this.Ca,this));try{this.B=!0,this.g.open(u,String(o),!0),this.B=!1}catch(P){Yu(this,P);return}if(o=f||"",f=new Map(this.headers),p)if(Object.getPrototypeOf(p)===Object.prototype)for(var b in p)f.set(b,p[b]);else if(typeof p.keys=="function"&&typeof p.get=="function")for(const P of p.keys())f.set(P,p.get(P));else throw Error("Unknown input type for opt_headers: "+String(p));p=Array.from(f.keys()).find(P=>P.toLowerCase()=="content-type"),b=a.FormData&&o instanceof a.FormData,!(Array.prototype.indexOf.call(jm,u,void 0)>=0)||p||b||f.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[P,V]of f)this.g.setRequestHeader(P,V);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(o),this.v=!1}catch(P){Yu(this,P)}};function Yu(o,u){o.h=!1,o.g&&(o.j=!0,o.g.abort(),o.j=!1),o.l=u,o.o=5,Zu(o),ii(o)}function Zu(o){o.A||(o.A=!0,Ue(o,"complete"),Ue(o,"error"))}n.abort=function(o){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=o||7,Ue(this,"complete"),Ue(this,"abort"),ii(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ii(this,!0)),de.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?el(this):this.Xa())},n.Xa=function(){el(this)};function el(o){if(o.h&&typeof i<"u"){if(o.v&&Jt(o)==4)setTimeout(o.Ca.bind(o),0);else if(Ue(o,"readystatechange"),Jt(o)==4){o.h=!1;try{const P=o.ca();e:switch(P){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var u=!0;break e;default:u=!1}var f;if(!(f=u)){var p;if(p=P===0){let V=String(o.D).match(qu)[1]||null;!V&&a.self&&a.self.location&&(V=a.self.location.protocol.slice(0,-1)),p=!$m.test(V?V.toLowerCase():"")}f=p}if(f)Ue(o,"complete"),Ue(o,"success");else{o.o=6;try{var b=Jt(o)>2?o.g.statusText:""}catch{b=""}o.l=b+" ["+o.ca()+"]",Zu(o)}}finally{ii(o)}}}}function ii(o,u){if(o.g){o.m&&(clearTimeout(o.m),o.m=null);const f=o.g;o.g=null,u||Ue(o,"ready");try{f.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function Jt(o){return o.g?o.g.readyState:0}n.ca=function(){try{return Jt(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(o){if(this.g){var u=this.g.responseText;return o&&u.indexOf(o)==0&&(u=u.substring(o.length)),Tm(u)}};function tl(o){try{if(!o.g)return null;if("response"in o.g)return o.g.response;switch(o.F){case"":case"text":return o.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in o.g)return o.g.mozResponseArrayBuffer}return null}catch{return null}}function qm(o){const u={};o=(o.g&&Jt(o)>=2&&o.g.getAllResponseHeaders()||"").split(`\r
`);for(let p=0;p<o.length;p++){if(v(o[p]))continue;var f=Rm(o[p]);const b=f[0];if(f=f[1],typeof f!="string")continue;f=f.trim();const P=u[b]||[];u[b]=P,P.push(f)}rr(u,function(p){return p.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function ls(o,u,f){return f&&f.internalChannelParams&&f.internalChannelParams[o]||u}function nl(o){this.za=0,this.i=[],this.j=new es,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=ls("failFast",!1,o),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=ls("baseRetryDelayMs",5e3,o),this.Za=ls("retryDelaySeedMs",1e4,o),this.Ta=ls("forwardChannelMaxRetries",2,o),this.va=ls("forwardChannelRequestTimeoutMs",2e4,o),this.ma=o&&o.xmlHttpFactory||void 0,this.Ua=o&&o.Rb||void 0,this.Aa=o&&o.useFetchStreams||!1,this.O=void 0,this.L=o&&o.supportsCrossDomainXhr||!1,this.M="",this.h=new Fu(o&&o.concurrentRequestLimit),this.Ba=new Bm,this.S=o&&o.fastHandshake||!1,this.R=o&&o.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=o&&o.Pb||!1,o&&o.ua&&this.j.ua(),o&&o.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&o&&o.detectBufferingProxy||!1,this.ia=void 0,o&&o.longPollingTimeout&&o.longPollingTimeout>0&&(this.ia=o.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=nl.prototype,n.ka=8,n.I=1,n.connect=function(o,u,f,p){Be(0),this.W=o,this.H=u||{},f&&p!==void 0&&(this.H.OSID=f,this.H.OAID=p),this.F=this.X,this.J=hl(this,null,this.W),ai(this)};function ra(o){if(rl(o),o.I==3){var u=o.V++,f=mt(o.J);if(oe(f,"SID",o.M),oe(f,"RID",u),oe(f,"TYPE","terminate"),hs(o,f),u=new Kt(o,o.j,u),u.M=2,u.A=ri(mt(f)),f=!1,a.navigator&&a.navigator.sendBeacon)try{f=a.navigator.sendBeacon(u.A.toString(),"")}catch{}!f&&a.Image&&(new Image().src=u.A,f=!0),f||(u.g=fl(u.j,null),u.g.ea(u.A)),u.F=Date.now(),ni(u)}ll(o)}function oi(o){o.g&&(ia(o),o.g.cancel(),o.g=null)}function rl(o){oi(o),o.v&&(a.clearTimeout(o.v),o.v=null),ci(o),o.h.cancel(),o.m&&(typeof o.m=="number"&&a.clearTimeout(o.m),o.m=null)}function ai(o){if(!Uu(o.h)&&!o.m){o.m=!0;var u=o.Ea;J||_(),ee||(J(),ee=!0),E.add(u,o),o.D=0}}function zm(o,u){return Bu(o.h)>=o.h.j-(o.m?1:0)?!1:o.m?(o.i=u.G.concat(o.i),!0):o.I==1||o.I==2||o.D>=(o.Sa?0:o.Ta)?!1:(o.m=Zr(h(o.Ea,o,u),ul(o,o.D)),o.D++,!0)}n.Ea=function(o){if(this.m)if(this.m=null,this.I==1){if(!o){this.V=Math.floor(Math.random()*1e5),o=this.V++;const b=new Kt(this,this.j,o);let P=this.o;if(this.U&&(P?(P=Pn(P),Lo(P,this.U)):P=this.U),this.u!==null||this.R||(b.J=P,P=null),this.S)e:{for(var u=0,f=0;f<this.i.length;f++){t:{var p=this.i[f];if("__data__"in p.map&&(p=p.map.__data__,typeof p=="string")){p=p.length;break t}p=void 0}if(p===void 0)break;if(u+=p,u>4096){u=f;break e}if(u===4096||f===this.i.length-1){u=f+1;break e}}u=1e3}else u=1e3;u=il(this,b,u),f=mt(this.J),oe(f,"RID",o),oe(f,"CVER",22),this.G&&oe(f,"X-HTTP-Session-Id",this.G),hs(this,f),P&&(this.R?u="headers="+ts(Ju(P))+"&"+u:this.u&&na(f,this.u,P)),Zo(this.h,b),this.Ra&&oe(f,"TYPE","init"),this.S?(oe(f,"$req",u),oe(f,"SID","null"),b.U=!0,Qo(b,f,null)):Qo(b,f,u),this.I=2}}else this.I==3&&(o?sl(this,o):this.i.length==0||Uu(this.h)||sl(this))};function sl(o,u){var f;u?f=u.l:f=o.V++;const p=mt(o.J);oe(p,"SID",o.M),oe(p,"RID",f),oe(p,"AID",o.K),hs(o,p),o.u&&o.o&&na(p,o.u,o.o),f=new Kt(o,o.j,f,o.D+1),o.u===null&&(f.J=o.o),u&&(o.i=u.G.concat(o.i)),u=il(o,f,1e3),f.H=Math.round(o.va*.5)+Math.round(o.va*.5*Math.random()),Zo(o.h,f),Qo(f,p,u)}function hs(o,u){o.H&&rt(o.H,function(f,p){oe(u,p,f)}),o.l&&rt({},function(f,p){oe(u,p,f)})}function il(o,u,f){f=Math.min(o.i.length,f);const p=o.l?h(o.l.Ka,o.l,o):null;e:{var b=o.i;let H=-1;for(;;){const Ee=["count="+f];H==-1?f>0?(H=b[0].g,Ee.push("ofs="+H)):H=0:Ee.push("ofs="+H);let ne=!0;for(let Ae=0;Ae<f;Ae++){var P=b[Ae].g;const gt=b[Ae].map;if(P-=H,P<0)H=Math.max(0,b[Ae].g-100),ne=!1;else try{P="req"+P+"_"||"";try{var V=gt instanceof Map?gt:Object.entries(gt);for(const[Vn,Yt]of V){let Zt=Yt;c(Yt)&&(Zt=zo(Yt)),Ee.push(P+Vn+"="+encodeURIComponent(Zt))}}catch(Vn){throw Ee.push(P+"type="+encodeURIComponent("_badmap")),Vn}}catch{p&&p(gt)}}if(ne){V=Ee.join("&");break e}}V=void 0}return o=o.i.splice(0,f),u.G=o,V}function ol(o){if(!o.g&&!o.v){o.Y=1;var u=o.Da;J||_(),ee||(J(),ee=!0),E.add(u,o),o.A=0}}function sa(o){return o.g||o.v||o.A>=3?!1:(o.Y++,o.v=Zr(h(o.Da,o),ul(o,o.A)),o.A++,!0)}n.Da=function(){if(this.v=null,al(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var o=4*this.T;this.j.info("BP detection timer enabled: "+o),this.B=Zr(h(this.Wa,this),o)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Be(10),oi(this),al(this))};function ia(o){o.B!=null&&(a.clearTimeout(o.B),o.B=null)}function al(o){o.g=new Kt(o,o.j,"rpc",o.Y),o.u===null&&(o.g.J=o.o),o.g.P=0;var u=mt(o.na);oe(u,"RID","rpc"),oe(u,"SID",o.M),oe(u,"AID",o.K),oe(u,"CI",o.F?"0":"1"),!o.F&&o.ia&&oe(u,"TO",o.ia),oe(u,"TYPE","xmlhttp"),hs(o,u),o.u&&o.o&&na(u,o.u,o.o),o.O&&(o.g.H=o.O);var f=o.g;o=o.ba,f.M=1,f.A=ri(mt(u)),f.u=null,f.R=!0,Mu(f,o)}n.Va=function(){this.C!=null&&(this.C=null,oi(this),sa(this),Be(19))};function ci(o){o.C!=null&&(a.clearTimeout(o.C),o.C=null)}function cl(o,u){var f=null;if(o.g==u){ci(o),ia(o),o.g=null;var p=2}else if(Yo(o.h,u))f=u.G,$u(o.h,u),p=1;else return;if(o.I!=0){if(u.o)if(p==1){f=u.u?u.u.length:0,u=Date.now()-u.F;var b=o.D;p=ei(),Ue(p,new ku(p,f)),ai(o)}else ol(o);else if(b=u.m,b==3||b==0&&u.X>0||!(p==1&&zm(o,u)||p==2&&sa(o)))switch(f&&f.length>0&&(u=o.h,u.i=u.i.concat(f)),b){case 1:Dn(o,5);break;case 4:Dn(o,10);break;case 3:Dn(o,6);break;default:Dn(o,2)}}}function ul(o,u){let f=o.Qa+Math.floor(Math.random()*o.Za);return o.isActive()||(f*=2),f*u}function Dn(o,u){if(o.j.info("Error code "+u),u==2){var f=h(o.bb,o),p=o.Ua;const b=!p;p=new Qt(p||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||rs(p,"https"),ri(p),b?Fm(p.toString(),f):Um(p.toString(),f)}else Be(2);o.I=0,o.l&&o.l.pa(u),ll(o),rl(o)}n.bb=function(o){o?(this.j.info("Successfully pinged google.com"),Be(2)):(this.j.info("Failed to ping google.com"),Be(1))};function ll(o){if(o.I=0,o.ja=[],o.l){const u=ju(o.h);(u.length!=0||o.i.length!=0)&&(S(o.ja,u),S(o.ja,o.i),o.h.i.length=0,T(o.i),o.i.length=0),o.l.oa()}}function hl(o,u,f){var p=f instanceof Qt?mt(f):new Qt(f);if(p.g!="")u&&(p.g=u+"."+p.g),ss(p,p.u);else{var b=a.location;p=b.protocol,u=u?u+"."+b.hostname:b.hostname,b=+b.port;const P=new Qt(null);p&&rs(P,p),u&&(P.g=u),b&&ss(P,b),f&&(P.h=f),p=P}return f=o.G,u=o.wa,f&&u&&oe(p,f,u),oe(p,"VER",o.ka),hs(o,p),p}function fl(o,u,f){if(u&&!o.L)throw Error("Can't create secondary domain capable XhrIo object.");return u=o.Aa&&!o.ma?new de(new ta({ab:f})):new de(o.ma),u.Fa(o.L),u}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function dl(){}n=dl.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function ui(){}ui.prototype.g=function(o,u){return new Xe(o,u)};function Xe(o,u){De.call(this),this.g=new nl(u),this.l=o,this.h=u&&u.messageUrlParams||null,o=u&&u.messageHeaders||null,u&&u.clientProtocolHeaderRequired&&(o?o["X-Client-Protocol"]="webchannel":o={"X-Client-Protocol":"webchannel"}),this.g.o=o,o=u&&u.initMessageHeaders||null,u&&u.messageContentType&&(o?o["X-WebChannel-Content-Type"]=u.messageContentType:o={"X-WebChannel-Content-Type":u.messageContentType}),u&&u.sa&&(o?o["X-WebChannel-Client-Profile"]=u.sa:o={"X-WebChannel-Client-Profile":u.sa}),this.g.U=o,(o=u&&u.Qb)&&!v(o)&&(this.g.u=o),this.A=u&&u.supportsCrossDomainXhr||!1,this.v=u&&u.sendRawJson||!1,(u=u&&u.httpSessionIdParam)&&!v(u)&&(this.g.G=u,o=this.h,o!==null&&u in o&&(o=this.h,u in o&&delete o[u])),this.j=new or(this)}m(Xe,De),Xe.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Xe.prototype.close=function(){ra(this.g)},Xe.prototype.o=function(o){var u=this.g;if(typeof o=="string"){var f={};f.__data__=o,o=f}else this.v&&(f={},f.__data__=zo(o),o=f);u.i.push(new km(u.Ya++,o)),u.I==3&&ai(u)},Xe.prototype.N=function(){this.g.l=null,delete this.j,ra(this.g),delete this.g,Xe.Z.N.call(this)};function pl(o){Ho.call(this),o.__headers__&&(this.headers=o.__headers__,this.statusCode=o.__status__,delete o.__headers__,delete o.__status__);var u=o.__sm__;if(u){e:{for(const f in u){o=f;break e}o=void 0}(this.i=o)&&(o=this.i,u=u!==null&&o in u?u[o]:void 0),this.data=u}else this.data=o}m(pl,Ho);function ml(){Wo.call(this),this.status=1}m(ml,Wo);function or(o){this.g=o}m(or,dl),or.prototype.ra=function(){Ue(this.g,"a")},or.prototype.qa=function(o){Ue(this.g,new pl(o))},or.prototype.pa=function(o){Ue(this.g,new ml)},or.prototype.oa=function(){Ue(this.g,"b")},ui.prototype.createWebChannel=ui.prototype.g,Xe.prototype.send=Xe.prototype.o,Xe.prototype.open=Xe.prototype.m,Xe.prototype.close=Xe.prototype.close,fd=function(){return new ui},hd=function(){return ei()},ld=Cn,Fa={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},ti.NO_ERROR=0,ti.TIMEOUT=8,ti.HTTP_ERROR=6,Ei=ti,Nu.COMPLETE="complete",ud=Nu,Su.EventType=Jr,Jr.OPEN="a",Jr.CLOSE="b",Jr.ERROR="c",Jr.MESSAGE="d",De.prototype.listen=De.prototype.J,ds=Su,de.prototype.listenOnce=de.prototype.K,de.prototype.getLastError=de.prototype.Ha,de.prototype.getLastErrorCode=de.prototype.ya,de.prototype.getStatus=de.prototype.ca,de.prototype.getResponseJson=de.prototype.La,de.prototype.getResponseText=de.prototype.la,de.prototype.send=de.prototype.ea,de.prototype.setWithCredentials=de.prototype.Fa,cd=de}).apply(typeof di<"u"?di:typeof self<"u"?self:typeof window<"u"?window:{});const Bl="@firebase/firestore",$l="4.9.2";class Me{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Me.UNAUTHENTICATED=new Me(null),Me.GOOGLE_CREDENTIALS=new Me("google-credentials-uid"),Me.FIRST_PARTY=new Me("first-party-uid"),Me.MOCK_USER=new Me("mock-user");let Hr="12.3.0";const Qn=new Ic("@firebase/firestore");function ur(){return Qn.logLevel}function M(n,...e){if(Qn.logLevel<=G.DEBUG){const t=e.map(Sc);Qn.debug(`Firestore (${Hr}): ${n}`,...t)}}function $t(n,...e){if(Qn.logLevel<=G.ERROR){const t=e.map(Sc);Qn.error(`Firestore (${Hr}): ${n}`,...t)}}function kr(n,...e){if(Qn.logLevel<=G.WARN){const t=e.map(Sc);Qn.warn(`Firestore (${Hr}): ${n}`,...t)}}function Sc(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function B(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,dd(n,r,t)}function dd(n,e,t){let r=`FIRESTORE (${Hr}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw $t(r),new Error(r)}function te(n,e,t,r){let s="Unexpected state";typeof t=="string"?s=t:r=t,n||dd(e,s,r)}function q(n,e){return n}const N={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class F extends Vt{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class $n{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class pd{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class sv{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Me.UNAUTHENTICATED)))}shutdown(){}}class iv{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class ov{constructor(e){this.t=e,this.currentUser=Me.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){te(this.o===void 0,42304);let r=this.i;const s=l=>this.i!==r?(r=this.i,t(l)):Promise.resolve();let i=new $n;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new $n,e.enqueueRetryable((()=>s(this.currentUser)))};const a=()=>{const l=i;e.enqueueRetryable((async()=>{await l.promise,await s(this.currentUser)}))},c=l=>{M("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit((l=>c(l))),setTimeout((()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?c(l):(M("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new $n)}}),0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((r=>this.i!==e?(M("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(te(typeof r.accessToken=="string",31837,{l:r}),new pd(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return te(e===null||typeof e=="string",2055,{h:e}),new Me(e)}}class av{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=Me.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class cv{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new av(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(Me.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class jl{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class uv{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,it(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){te(this.o===void 0,3512);const r=i=>{i.error!=null&&M("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const a=i.token!==this.m;return this.m=i.token,M("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable((()=>r(i)))};const s=i=>{M("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((i=>s(i))),setTimeout((()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):M("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new jl(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(te(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new jl(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function lv(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}class Rc{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=lv(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<t&&(r+=e.charAt(s[i]%62))}return r}}function K(n,e){return n<e?-1:n>e?1:0}function Ua(n,e){const t=Math.min(n.length,e.length);for(let r=0;r<t;r++){const s=n.charAt(r),i=e.charAt(r);if(s!==i)return ma(s)===ma(i)?K(s,i):ma(s)?1:-1}return K(n.length,e.length)}const hv=55296,fv=57343;function ma(n){const e=n.charCodeAt(0);return e>=hv&&e<=fv}function Nr(n,e,t){return n.length===e.length&&n.every(((r,s)=>t(r,e[s])))}const ql="__name__";class yt{constructor(e,t,r){t===void 0?t=0:t>e.length&&B(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&B(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return yt.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof yt?e.forEach((r=>{t.push(r)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let s=0;s<r;s++){const i=yt.compareSegments(e.get(s),t.get(s));if(i!==0)return i}return K(e.length,t.length)}static compareSegments(e,t){const r=yt.isNumericId(e),s=yt.isNumericId(t);return r&&!s?-1:!r&&s?1:r&&s?yt.extractNumericId(e).compare(yt.extractNumericId(t)):Ua(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return fn.fromString(e.substring(4,e.length-2))}}class ce extends yt{construct(e,t,r){return new ce(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new F(N.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter((s=>s.length>0)))}return new ce(t)}static emptyPath(){return new ce([])}}const dv=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Re extends yt{construct(e,t,r){return new Re(e,t,r)}static isValidIdentifier(e){return dv.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Re.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===ql}static keyField(){return new Re([ql])}static fromServerFormat(e){const t=[];let r="",s=0;const i=()=>{if(r.length===0)throw new F(N.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let a=!1;for(;s<e.length;){const c=e[s];if(c==="\\"){if(s+1===e.length)throw new F(N.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new F(N.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,s+=2}else c==="`"?(a=!a,s++):c!=="."||a?(r+=c,s++):(i(),s++)}if(i(),a)throw new F(N.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Re(t)}static emptyPath(){return new Re([])}}class U{constructor(e){this.path=e}static fromPath(e){return new U(ce.fromString(e))}static fromName(e){return new U(ce.fromString(e).popFirst(5))}static empty(){return new U(ce.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ce.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return ce.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new U(new ce(e.slice()))}}function md(n,e,t){if(!t)throw new F(N.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function pv(n,e,t,r){if(e===!0&&r===!0)throw new F(N.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function zl(n){if(!U.isDocumentKey(n))throw new F(N.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function Hl(n){if(U.isDocumentKey(n))throw new F(N.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function gd(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function Pc(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":B(12329,{type:typeof n})}function dn(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new F(N.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Pc(n);throw new F(N.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function ge(n,e){const t={typeString:n};return e&&(t.value=e),t}function zs(n,e){if(!gd(n))throw new F(N.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const s=e[r].typeString,i="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}const a=n[r];if(s&&typeof a!==s){t=`JSON field '${r}' must be a ${s}.`;break}if(i!==void 0&&a!==i.value){t=`Expected '${r}' field to equal '${i.value}'`;break}}if(t)throw new F(N.INVALID_ARGUMENT,t);return!0}const Wl=-62135596800,Gl=1e6;class ue{static now(){return ue.fromMillis(Date.now())}static fromDate(e){return ue.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*Gl);return new ue(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new F(N.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new F(N.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<Wl)throw new F(N.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new F(N.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Gl}_compareTo(e){return this.seconds===e.seconds?K(this.nanoseconds,e.nanoseconds):K(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:ue._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(zs(e,ue._jsonSchema))return new ue(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Wl;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}ue._jsonSchemaVersion="firestore/timestamp/1.0",ue._jsonSchema={type:ge("string",ue._jsonSchemaVersion),seconds:ge("number"),nanoseconds:ge("number")};class j{static fromTimestamp(e){return new j(e)}static min(){return new j(new ue(0,0))}static max(){return new j(new ue(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const ks=-1;function mv(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,s=j.fromTimestamp(r===1e9?new ue(t+1,0):new ue(t,r));return new _n(s,U.empty(),e)}function gv(n){return new _n(n.readTime,n.key,ks)}class _n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new _n(j.min(),U.empty(),ks)}static max(){return new _n(j.max(),U.empty(),ks)}}function _v(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=U.comparator(n.documentKey,e.documentKey),t!==0?t:K(n.largestBatchId,e.largestBatchId))}const yv="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class vv{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Wr(n){if(n.code!==N.FAILED_PRECONDITION||n.message!==yv)throw n;M("LocalStore","Unexpectedly lost primary lease")}class k{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&B(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new k(((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(t,i).next(r,s)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof k?t:k.resolve(t)}catch(t){return k.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):k.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):k.reject(t)}static resolve(e){return new k(((t,r)=>{t(e)}))}static reject(e){return new k(((t,r)=>{r(e)}))}static waitFor(e){return new k(((t,r)=>{let s=0,i=0,a=!1;e.forEach((c=>{++s,c.next((()=>{++i,a&&i===s&&t()}),(l=>r(l)))})),a=!0,i===s&&t()}))}static or(e){let t=k.resolve(!1);for(const r of e)t=t.next((s=>s?k.resolve(s):r()));return t}static forEach(e,t){const r=[];return e.forEach(((s,i)=>{r.push(t.call(this,s,i))})),this.waitFor(r)}static mapArray(e,t){return new k(((r,s)=>{const i=e.length,a=new Array(i);let c=0;for(let l=0;l<i;l++){const h=l;t(e[h]).next((d=>{a[h]=d,++c,c===i&&r(a)}),(d=>s(d)))}}))}static doWhile(e,t){return new k(((r,s)=>{const i=()=>{e()===!0?t().next((()=>{i()}),s):r()};i()}))}}function Ev(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Gr(n){return n.name==="IndexedDbTransactionError"}class mo{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>t.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}mo.ce=-1;const Cc=-1;function go(n){return n==null}function Mi(n){return n===0&&1/n==-1/0}function Tv(n){return typeof n=="number"&&Number.isInteger(n)&&!Mi(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const _d="";function wv(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=Kl(e)),e=Iv(n.get(t),e);return Kl(e)}function Iv(n,e){let t=e;const r=n.length;for(let s=0;s<r;s++){const i=n.charAt(s);switch(i){case"\0":t+="";break;case _d:t+="";break;default:t+=i}}return t}function Kl(n){return n+_d+""}function Ql(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function bn(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function yd(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class fe{constructor(e,t){this.comparator=e,this.root=t||Se.EMPTY}insert(e,t){return new fe(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Se.BLACK,null,null))}remove(e){return new fe(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Se.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return t+r.left.size;s<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,r)=>(e(t,r),!1)))}toString(){const e=[];return this.inorderTraversal(((t,r)=>(e.push(`${t}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new pi(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new pi(this.root,e,this.comparator,!1)}getReverseIterator(){return new pi(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new pi(this.root,e,this.comparator,!0)}}class pi{constructor(e,t,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?r(e.key,t):1,t&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Se{constructor(e,t,r,s,i){this.key=e,this.value=t,this.color=r??Se.RED,this.left=s??Se.EMPTY,this.right=i??Se.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,s,i){return new Se(e??this.key,t??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,t,r),null):i===0?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Se.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),t(e,s.key)===0){if(s.right.isEmpty())return Se.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Se.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Se.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw B(43730,{key:this.key,value:this.value});if(this.right.isRed())throw B(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw B(27949);return e+(this.isRed()?0:1)}}Se.EMPTY=null,Se.RED=!0,Se.BLACK=!1;Se.EMPTY=new class{constructor(){this.size=0}get key(){throw B(57766)}get value(){throw B(16141)}get color(){throw B(16727)}get left(){throw B(29726)}get right(){throw B(36894)}copy(e,t,r,s,i){return this}insert(e,t,r){return new Se(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Ie{constructor(e){this.comparator=e,this.data=new fe(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,r)=>(e(t),!1)))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Xl(this.data.getIterator())}getIteratorFrom(e){return new Xl(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((r=>{t=t.add(r)})),t}isEqual(e){if(!(e instanceof Ie)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Ie(this.comparator);return t.data=e,t}}class Xl{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Ze{constructor(e){this.fields=e,e.sort(Re.comparator)}static empty(){return new Ze([])}unionWith(e){let t=new Ie(Re.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Ze(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Nr(this.fields,e.fields,((t,r)=>t.isEqual(r)))}}class vd extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class ke{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new vd("Invalid base64 string: "+i):i}})(e);return new ke(t)}static fromUint8Array(e){const t=(function(s){let i="";for(let a=0;a<s.length;++a)i+=String.fromCharCode(s[a]);return i})(e);return new ke(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const r=new Uint8Array(t.length);for(let s=0;s<t.length;s++)r[s]=t.charCodeAt(s);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return K(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ke.EMPTY_BYTE_STRING=new ke("");const Av=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function yn(n){if(te(!!n,39018),typeof n=="string"){let e=0;const t=Av.exec(n);if(te(!!t,46558,{timestamp:n}),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:pe(n.seconds),nanos:pe(n.nanos)}}function pe(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function vn(n){return typeof n=="string"?ke.fromBase64String(n):ke.fromUint8Array(n)}const Ed="server_timestamp",Td="__type__",wd="__previous_value__",Id="__local_write_time__";function kc(n){return(n?.mapValue?.fields||{})[Td]?.stringValue===Ed}function _o(n){const e=n.mapValue.fields[wd];return kc(e)?_o(e):e}function Ns(n){const e=yn(n.mapValue.fields[Id].timestampValue);return new ue(e.seconds,e.nanos)}class bv{constructor(e,t,r,s,i,a,c,l,h,d){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=a,this.autoDetectLongPolling=c,this.longPollingOptions=l,this.useFetchStreams=h,this.isUsingEmulator=d}}const Li="(default)";class Ds{constructor(e,t){this.projectId=e,this.database=t||Li}static empty(){return new Ds("","")}get isDefaultDatabase(){return this.database===Li}isEqual(e){return e instanceof Ds&&e.projectId===this.projectId&&e.database===this.database}}const Ad="__type__",Sv="__max__",mi={mapValue:{}},bd="__vector__",xi="value";function En(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?kc(n)?4:Pv(n)?9007199254740991:Rv(n)?10:11:B(28295,{value:n})}function Ct(n,e){if(n===e)return!0;const t=En(n);if(t!==En(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Ns(n).isEqual(Ns(e));case 3:return(function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const a=yn(s.timestampValue),c=yn(i.timestampValue);return a.seconds===c.seconds&&a.nanos===c.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(s,i){return vn(s.bytesValue).isEqual(vn(i.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(s,i){return pe(s.geoPointValue.latitude)===pe(i.geoPointValue.latitude)&&pe(s.geoPointValue.longitude)===pe(i.geoPointValue.longitude)})(n,e);case 2:return(function(s,i){if("integerValue"in s&&"integerValue"in i)return pe(s.integerValue)===pe(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const a=pe(s.doubleValue),c=pe(i.doubleValue);return a===c?Mi(a)===Mi(c):isNaN(a)&&isNaN(c)}return!1})(n,e);case 9:return Nr(n.arrayValue.values||[],e.arrayValue.values||[],Ct);case 10:case 11:return(function(s,i){const a=s.mapValue.fields||{},c=i.mapValue.fields||{};if(Ql(a)!==Ql(c))return!1;for(const l in a)if(a.hasOwnProperty(l)&&(c[l]===void 0||!Ct(a[l],c[l])))return!1;return!0})(n,e);default:return B(52216,{left:n})}}function Vs(n,e){return(n.values||[]).find((t=>Ct(t,e)))!==void 0}function Dr(n,e){if(n===e)return 0;const t=En(n),r=En(e);if(t!==r)return K(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return K(n.booleanValue,e.booleanValue);case 2:return(function(i,a){const c=pe(i.integerValue||i.doubleValue),l=pe(a.integerValue||a.doubleValue);return c<l?-1:c>l?1:c===l?0:isNaN(c)?isNaN(l)?0:-1:1})(n,e);case 3:return Jl(n.timestampValue,e.timestampValue);case 4:return Jl(Ns(n),Ns(e));case 5:return Ua(n.stringValue,e.stringValue);case 6:return(function(i,a){const c=vn(i),l=vn(a);return c.compareTo(l)})(n.bytesValue,e.bytesValue);case 7:return(function(i,a){const c=i.split("/"),l=a.split("/");for(let h=0;h<c.length&&h<l.length;h++){const d=K(c[h],l[h]);if(d!==0)return d}return K(c.length,l.length)})(n.referenceValue,e.referenceValue);case 8:return(function(i,a){const c=K(pe(i.latitude),pe(a.latitude));return c!==0?c:K(pe(i.longitude),pe(a.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return Yl(n.arrayValue,e.arrayValue);case 10:return(function(i,a){const c=i.fields||{},l=a.fields||{},h=c[xi]?.arrayValue,d=l[xi]?.arrayValue,m=K(h?.values?.length||0,d?.values?.length||0);return m!==0?m:Yl(h,d)})(n.mapValue,e.mapValue);case 11:return(function(i,a){if(i===mi.mapValue&&a===mi.mapValue)return 0;if(i===mi.mapValue)return 1;if(a===mi.mapValue)return-1;const c=i.fields||{},l=Object.keys(c),h=a.fields||{},d=Object.keys(h);l.sort(),d.sort();for(let m=0;m<l.length&&m<d.length;++m){const g=Ua(l[m],d[m]);if(g!==0)return g;const T=Dr(c[l[m]],h[d[m]]);if(T!==0)return T}return K(l.length,d.length)})(n.mapValue,e.mapValue);default:throw B(23264,{he:t})}}function Jl(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return K(n,e);const t=yn(n),r=yn(e),s=K(t.seconds,r.seconds);return s!==0?s:K(t.nanos,r.nanos)}function Yl(n,e){const t=n.values||[],r=e.values||[];for(let s=0;s<t.length&&s<r.length;++s){const i=Dr(t[s],r[s]);if(i)return i}return K(t.length,r.length)}function Vr(n){return Ba(n)}function Ba(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const r=yn(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return vn(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return U.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",s=!0;for(const i of t.values||[])s?s=!1:r+=",",r+=Ba(i);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){const r=Object.keys(t.fields||{}).sort();let s="{",i=!0;for(const a of r)i?i=!1:s+=",",s+=`${a}:${Ba(t.fields[a])}`;return s+"}"})(n.mapValue):B(61005,{value:n})}function Ti(n){switch(En(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=_o(n);return e?16+Ti(e):16;case 5:return 2*n.stringValue.length;case 6:return vn(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((s,i)=>s+Ti(i)),0)})(n.arrayValue);case 10:case 11:return(function(r){let s=0;return bn(r.fields,((i,a)=>{s+=i.length+Ti(a)})),s})(n.mapValue);default:throw B(13486,{value:n})}}function $a(n){return!!n&&"integerValue"in n}function Nc(n){return!!n&&"arrayValue"in n}function Zl(n){return!!n&&"nullValue"in n}function eh(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function wi(n){return!!n&&"mapValue"in n}function Rv(n){return(n?.mapValue?.fields||{})[Ad]?.stringValue===bd}function Es(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return bn(n.mapValue.fields,((t,r)=>e.mapValue.fields[t]=Es(r))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Es(n.arrayValue.values[t]);return e}return{...n}}function Pv(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===Sv}class He{constructor(e){this.value=e}static empty(){return new He({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!wi(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Es(t)}setAll(e){let t=Re.emptyPath(),r={},s=[];e.forEach(((a,c)=>{if(!t.isImmediateParentOf(c)){const l=this.getFieldsMap(t);this.applyChanges(l,r,s),r={},s=[],t=c.popLast()}a?r[c.lastSegment()]=Es(a):s.push(c.lastSegment())}));const i=this.getFieldsMap(t);this.applyChanges(i,r,s)}delete(e){const t=this.field(e.popLast());wi(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Ct(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=t.mapValue.fields[e.get(r)];wi(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,r){bn(t,((s,i)=>e[s]=i));for(const s of r)delete e[s]}clone(){return new He(Es(this.value))}}function Sd(n){const e=[];return bn(n.fields,((t,r)=>{const s=new Re([t]);if(wi(r)){const i=Sd(r.mapValue).fields;if(i.length===0)e.push(s);else for(const a of i)e.push(s.child(a))}else e.push(s)})),new Ze(e)}class Le{constructor(e,t,r,s,i,a,c){this.key=e,this.documentType=t,this.version=r,this.readTime=s,this.createTime=i,this.data=a,this.documentState=c}static newInvalidDocument(e){return new Le(e,0,j.min(),j.min(),j.min(),He.empty(),0)}static newFoundDocument(e,t,r,s){return new Le(e,1,t,j.min(),r,s,0)}static newNoDocument(e,t){return new Le(e,2,t,j.min(),j.min(),He.empty(),0)}static newUnknownDocument(e,t){return new Le(e,3,t,j.min(),j.min(),He.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(j.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=He.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=He.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=j.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Le&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Le(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Fi{constructor(e,t){this.position=e,this.inclusive=t}}function th(n,e,t){let r=0;for(let s=0;s<n.position.length;s++){const i=e[s],a=n.position[s];if(i.field.isKeyField()?r=U.comparator(U.fromName(a.referenceValue),t.key):r=Dr(a,t.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function nh(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Ct(n.position[t],e.position[t]))return!1;return!0}class Ui{constructor(e,t="asc"){this.field=e,this.dir=t}}function Cv(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class Rd{}class Te extends Rd{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new Nv(e,t,r):t==="array-contains"?new Ov(e,r):t==="in"?new Mv(e,r):t==="not-in"?new Lv(e,r):t==="array-contains-any"?new xv(e,r):new Te(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new Dv(e,r):new Vv(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Dr(t,this.value)):t!==null&&En(this.value)===En(t)&&this.matchesComparison(Dr(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return B(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class kt extends Rd{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new kt(e,t)}matches(e){return Pd(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Pd(n){return n.op==="and"}function Cd(n){return kv(n)&&Pd(n)}function kv(n){for(const e of n.filters)if(e instanceof kt)return!1;return!0}function ja(n){if(n instanceof Te)return n.field.canonicalString()+n.op.toString()+Vr(n.value);if(Cd(n))return n.filters.map((e=>ja(e))).join(",");{const e=n.filters.map((t=>ja(t))).join(",");return`${n.op}(${e})`}}function kd(n,e){return n instanceof Te?(function(r,s){return s instanceof Te&&r.op===s.op&&r.field.isEqual(s.field)&&Ct(r.value,s.value)})(n,e):n instanceof kt?(function(r,s){return s instanceof kt&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce(((i,a,c)=>i&&kd(a,s.filters[c])),!0):!1})(n,e):void B(19439)}function Nd(n){return n instanceof Te?(function(t){return`${t.field.canonicalString()} ${t.op} ${Vr(t.value)}`})(n):n instanceof kt?(function(t){return t.op.toString()+" {"+t.getFilters().map(Nd).join(" ,")+"}"})(n):"Filter"}class Nv extends Te{constructor(e,t,r){super(e,t,r),this.key=U.fromName(r.referenceValue)}matches(e){const t=U.comparator(e.key,this.key);return this.matchesComparison(t)}}class Dv extends Te{constructor(e,t){super(e,"in",t),this.keys=Dd("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class Vv extends Te{constructor(e,t){super(e,"not-in",t),this.keys=Dd("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function Dd(n,e){return(e.arrayValue?.values||[]).map((t=>U.fromName(t.referenceValue)))}class Ov extends Te{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Nc(t)&&Vs(t.arrayValue,this.value)}}class Mv extends Te{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Vs(this.value.arrayValue,t)}}class Lv extends Te{constructor(e,t){super(e,"not-in",t)}matches(e){if(Vs(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Vs(this.value.arrayValue,t)}}class xv extends Te{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Nc(t)||!t.arrayValue.values)&&t.arrayValue.values.some((r=>Vs(this.value.arrayValue,r)))}}class Fv{constructor(e,t=null,r=[],s=[],i=null,a=null,c=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=a,this.endAt=c,this.Te=null}}function rh(n,e=null,t=[],r=[],s=null,i=null,a=null){return new Fv(n,e,t,r,s,i,a)}function Dc(n){const e=q(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((r=>ja(r))).join(","),t+="|ob:",t+=e.orderBy.map((r=>(function(i){return i.field.canonicalString()+i.dir})(r))).join(","),go(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((r=>Vr(r))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((r=>Vr(r))).join(",")),e.Te=t}return e.Te}function Vc(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!Cv(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!kd(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!nh(n.startAt,e.startAt)&&nh(n.endAt,e.endAt)}function qa(n){return U.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}class yo{constructor(e,t=null,r=[],s=[],i=null,a="F",c=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=a,this.startAt=c,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function Uv(n,e,t,r,s,i,a,c){return new yo(n,e,t,r,s,i,a,c)}function Oc(n){return new yo(n)}function sh(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function Bv(n){return n.collectionGroup!==null}function Ts(n){const e=q(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),t.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let c=new Ie(Re.comparator);return a.filters.forEach((l=>{l.getFlattenedFilters().forEach((h=>{h.isInequality()&&(c=c.add(h.field))}))})),c})(e).forEach((i=>{t.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new Ui(i,r))})),t.has(Re.keyField().canonicalString())||e.Ie.push(new Ui(Re.keyField(),r))}return e.Ie}function It(n){const e=q(n);return e.Ee||(e.Ee=$v(e,Ts(n))),e.Ee}function $v(n,e){if(n.limitType==="F")return rh(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((s=>{const i=s.dir==="desc"?"asc":"desc";return new Ui(s.field,i)}));const t=n.endAt?new Fi(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Fi(n.startAt.position,n.startAt.inclusive):null;return rh(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function za(n,e,t){return new yo(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function vo(n,e){return Vc(It(n),It(e))&&n.limitType===e.limitType}function Vd(n){return`${Dc(It(n))}|lt:${n.limitType}`}function lr(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map((s=>Nd(s))).join(", ")}]`),go(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map((s=>(function(a){return`${a.field.canonicalString()} (${a.dir})`})(s))).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map((s=>Vr(s))).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map((s=>Vr(s))).join(",")),`Target(${r})`})(It(n))}; limitType=${n.limitType})`}function Eo(n,e){return e.isFoundDocument()&&(function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):U.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)})(n,e)&&(function(r,s){for(const i of Ts(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0})(n,e)&&(function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0})(n,e)&&(function(r,s){return!(r.startAt&&!(function(a,c,l){const h=th(a,c,l);return a.inclusive?h<=0:h<0})(r.startAt,Ts(r),s)||r.endAt&&!(function(a,c,l){const h=th(a,c,l);return a.inclusive?h>=0:h>0})(r.endAt,Ts(r),s))})(n,e)}function jv(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function Od(n){return(e,t)=>{let r=!1;for(const s of Ts(n)){const i=qv(s,e,t);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function qv(n,e,t){const r=n.field.isKeyField()?U.comparator(e.key,t.key):(function(i,a,c){const l=a.data.field(i),h=c.data.field(i);return l!==null&&h!==null?Dr(l,h):B(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return B(19790,{direction:n.dir})}}class er{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[t]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){bn(this.inner,((t,r)=>{for(const[s,i]of r)e(s,i)}))}isEmpty(){return yd(this.inner)}size(){return this.innerSize}}const zv=new fe(U.comparator);function jt(){return zv}const Md=new fe(U.comparator);function ps(...n){let e=Md;for(const t of n)e=e.insert(t.key,t);return e}function Ld(n){let e=Md;return n.forEach(((t,r)=>e=e.insert(t,r.overlayedDocument))),e}function Ln(){return ws()}function xd(){return ws()}function ws(){return new er((n=>n.toString()),((n,e)=>n.isEqual(e)))}const Hv=new fe(U.comparator),Wv=new Ie(U.comparator);function Q(...n){let e=Wv;for(const t of n)e=e.add(t);return e}const Gv=new Ie(K);function Kv(){return Gv}function Mc(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Mi(e)?"-0":e}}function Fd(n){return{integerValue:""+n}}function Qv(n,e){return Tv(e)?Fd(e):Mc(n,e)}class To{constructor(){this._=void 0}}function Xv(n,e,t){return n instanceof Bi?(function(s,i){const a={fields:{[Td]:{stringValue:Ed},[Id]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&kc(i)&&(i=_o(i)),i&&(a.fields[wd]=i),{mapValue:a}})(t,e):n instanceof Os?Bd(n,e):n instanceof Ms?$d(n,e):(function(s,i){const a=Ud(s,i),c=ih(a)+ih(s.Ae);return $a(a)&&$a(s.Ae)?Fd(c):Mc(s.serializer,c)})(n,e)}function Jv(n,e,t){return n instanceof Os?Bd(n,e):n instanceof Ms?$d(n,e):t}function Ud(n,e){return n instanceof $i?(function(r){return $a(r)||(function(i){return!!i&&"doubleValue"in i})(r)})(e)?e:{integerValue:0}:null}class Bi extends To{}class Os extends To{constructor(e){super(),this.elements=e}}function Bd(n,e){const t=jd(e);for(const r of n.elements)t.some((s=>Ct(s,r)))||t.push(r);return{arrayValue:{values:t}}}class Ms extends To{constructor(e){super(),this.elements=e}}function $d(n,e){let t=jd(e);for(const r of n.elements)t=t.filter((s=>!Ct(s,r)));return{arrayValue:{values:t}}}class $i extends To{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function ih(n){return pe(n.integerValue||n.doubleValue)}function jd(n){return Nc(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function Yv(n,e){return n.field.isEqual(e.field)&&(function(r,s){return r instanceof Os&&s instanceof Os||r instanceof Ms&&s instanceof Ms?Nr(r.elements,s.elements,Ct):r instanceof $i&&s instanceof $i?Ct(r.Ae,s.Ae):r instanceof Bi&&s instanceof Bi})(n.transform,e.transform)}class Zv{constructor(e,t){this.version=e,this.transformResults=t}}class ht{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new ht}static exists(e){return new ht(void 0,e)}static updateTime(e){return new ht(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Ii(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class wo{}function qd(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Lc(n.key,ht.none()):new Hs(n.key,n.data,ht.none());{const t=n.data,r=He.empty();let s=new Ie(Re.comparator);for(let i of e.fields)if(!s.has(i)){let a=t.field(i);a===null&&i.length>1&&(i=i.popLast(),a=t.field(i)),a===null?r.delete(i):r.set(i,a),s=s.add(i)}return new Sn(n.key,r,new Ze(s.toArray()),ht.none())}}function eE(n,e,t){n instanceof Hs?(function(s,i,a){const c=s.value.clone(),l=ah(s.fieldTransforms,i,a.transformResults);c.setAll(l),i.convertToFoundDocument(a.version,c).setHasCommittedMutations()})(n,e,t):n instanceof Sn?(function(s,i,a){if(!Ii(s.precondition,i))return void i.convertToUnknownDocument(a.version);const c=ah(s.fieldTransforms,i,a.transformResults),l=i.data;l.setAll(zd(s)),l.setAll(c),i.convertToFoundDocument(a.version,l).setHasCommittedMutations()})(n,e,t):(function(s,i,a){i.convertToNoDocument(a.version).setHasCommittedMutations()})(0,e,t)}function Is(n,e,t,r){return n instanceof Hs?(function(i,a,c,l){if(!Ii(i.precondition,a))return c;const h=i.value.clone(),d=ch(i.fieldTransforms,l,a);return h.setAll(d),a.convertToFoundDocument(a.version,h).setHasLocalMutations(),null})(n,e,t,r):n instanceof Sn?(function(i,a,c,l){if(!Ii(i.precondition,a))return c;const h=ch(i.fieldTransforms,l,a),d=a.data;return d.setAll(zd(i)),d.setAll(h),a.convertToFoundDocument(a.version,d).setHasLocalMutations(),c===null?null:c.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map((m=>m.field)))})(n,e,t,r):(function(i,a,c){return Ii(i.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):c})(n,e,t)}function tE(n,e){let t=null;for(const r of n.fieldTransforms){const s=e.data.field(r.field),i=Ud(r.transform,s||null);i!=null&&(t===null&&(t=He.empty()),t.set(r.field,i))}return t||null}function oh(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&Nr(r,s,((i,a)=>Yv(i,a)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Hs extends wo{constructor(e,t,r,s=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Sn extends wo{constructor(e,t,r,s,i=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function zd(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}})),e}function ah(n,e,t){const r=new Map;te(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let s=0;s<t.length;s++){const i=n[s],a=i.transform,c=e.data.field(i.field);r.set(i.field,Jv(a,c,t[s]))}return r}function ch(n,e,t){const r=new Map;for(const s of n){const i=s.transform,a=t.data.field(s.field);r.set(s.field,Xv(i,a,e))}return r}class Lc extends wo{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class nE extends wo{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class rE{constructor(e,t,r,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&eE(i,e,r[s])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=Is(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=Is(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=xd();return this.mutations.forEach((s=>{const i=e.get(s.key),a=i.overlayedDocument;let c=this.applyToLocalView(a,i.mutatedFields);c=t.has(s.key)?null:c;const l=qd(a,c);l!==null&&r.set(s.key,l),a.isValidDocument()||a.convertToNoDocument(j.min())})),r}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Q())}isEqual(e){return this.batchId===e.batchId&&Nr(this.mutations,e.mutations,((t,r)=>oh(t,r)))&&Nr(this.baseMutations,e.baseMutations,((t,r)=>oh(t,r)))}}class xc{constructor(e,t,r,s){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=s}static from(e,t,r){te(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let s=(function(){return Hv})();const i=e.mutations;for(let a=0;a<i.length;a++)s=s.insert(i[a].key,r[a].version);return new xc(e,t,r,s)}}class sE{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class iE{constructor(e,t){this.count=e,this.unchangedNames=t}}var me,X;function oE(n){switch(n){case N.OK:return B(64938);case N.CANCELLED:case N.UNKNOWN:case N.DEADLINE_EXCEEDED:case N.RESOURCE_EXHAUSTED:case N.INTERNAL:case N.UNAVAILABLE:case N.UNAUTHENTICATED:return!1;case N.INVALID_ARGUMENT:case N.NOT_FOUND:case N.ALREADY_EXISTS:case N.PERMISSION_DENIED:case N.FAILED_PRECONDITION:case N.ABORTED:case N.OUT_OF_RANGE:case N.UNIMPLEMENTED:case N.DATA_LOSS:return!0;default:return B(15467,{code:n})}}function Hd(n){if(n===void 0)return $t("GRPC error has no .code"),N.UNKNOWN;switch(n){case me.OK:return N.OK;case me.CANCELLED:return N.CANCELLED;case me.UNKNOWN:return N.UNKNOWN;case me.DEADLINE_EXCEEDED:return N.DEADLINE_EXCEEDED;case me.RESOURCE_EXHAUSTED:return N.RESOURCE_EXHAUSTED;case me.INTERNAL:return N.INTERNAL;case me.UNAVAILABLE:return N.UNAVAILABLE;case me.UNAUTHENTICATED:return N.UNAUTHENTICATED;case me.INVALID_ARGUMENT:return N.INVALID_ARGUMENT;case me.NOT_FOUND:return N.NOT_FOUND;case me.ALREADY_EXISTS:return N.ALREADY_EXISTS;case me.PERMISSION_DENIED:return N.PERMISSION_DENIED;case me.FAILED_PRECONDITION:return N.FAILED_PRECONDITION;case me.ABORTED:return N.ABORTED;case me.OUT_OF_RANGE:return N.OUT_OF_RANGE;case me.UNIMPLEMENTED:return N.UNIMPLEMENTED;case me.DATA_LOSS:return N.DATA_LOSS;default:return B(39323,{code:n})}}(X=me||(me={}))[X.OK=0]="OK",X[X.CANCELLED=1]="CANCELLED",X[X.UNKNOWN=2]="UNKNOWN",X[X.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",X[X.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",X[X.NOT_FOUND=5]="NOT_FOUND",X[X.ALREADY_EXISTS=6]="ALREADY_EXISTS",X[X.PERMISSION_DENIED=7]="PERMISSION_DENIED",X[X.UNAUTHENTICATED=16]="UNAUTHENTICATED",X[X.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",X[X.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",X[X.ABORTED=10]="ABORTED",X[X.OUT_OF_RANGE=11]="OUT_OF_RANGE",X[X.UNIMPLEMENTED=12]="UNIMPLEMENTED",X[X.INTERNAL=13]="INTERNAL",X[X.UNAVAILABLE=14]="UNAVAILABLE",X[X.DATA_LOSS=15]="DATA_LOSS";function aE(){return new TextEncoder}const cE=new fn([4294967295,4294967295],0);function uh(n){const e=aE().encode(n),t=new ad;return t.update(e),new Uint8Array(t.digest())}function lh(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new fn([t,r],0),new fn([s,i],0)]}class Fc{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new ms(`Invalid padding: ${t}`);if(r<0)throw new ms(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new ms(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new ms(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=fn.fromNumber(this.ge)}ye(e,t,r){let s=e.add(t.multiply(fn.fromNumber(r)));return s.compare(cE)===1&&(s=new fn([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=uh(e),[r,s]=lh(t);for(let i=0;i<this.hashCount;i++){const a=this.ye(r,s,i);if(!this.we(a))return!1}return!0}static create(e,t,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),a=new Fc(i,s,t);return r.forEach((c=>a.insert(c))),a}insert(e){if(this.ge===0)return;const t=uh(e),[r,s]=lh(t);for(let i=0;i<this.hashCount;i++){const a=this.ye(r,s,i);this.Se(a)}}Se(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class ms extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Io{constructor(e,t,r,s,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const s=new Map;return s.set(e,Ws.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new Io(j.min(),s,new fe(K),jt(),Q())}}class Ws{constructor(e,t,r,s,i){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new Ws(r,t,Q(),Q(),Q())}}class Ai{constructor(e,t,r,s){this.be=e,this.removedTargetIds=t,this.key=r,this.De=s}}class Wd{constructor(e,t){this.targetId=e,this.Ce=t}}class Gd{constructor(e,t,r=ke.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=s}}class hh{constructor(){this.ve=0,this.Fe=fh(),this.Me=ke.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Q(),t=Q(),r=Q();return this.Fe.forEach(((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:r=r.add(s);break;default:B(38017,{changeType:i})}})),new Ws(this.Me,this.xe,e,t,r)}qe(){this.Oe=!1,this.Fe=fh()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,te(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class uE{constructor(e){this.Ge=e,this.ze=new Map,this.je=jt(),this.Je=gi(),this.He=gi(),this.Ye=new fe(K)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:B(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((r,s)=>{this.rt(s)&&t(s)}))}st(e){const t=e.targetId,r=e.Ce.count,s=this.ot(t);if(s){const i=s.target;if(qa(i))if(r===0){const a=new U(i.path);this.et(t,a,Le.newNoDocument(a,j.min()))}else te(r===1,20013,{expectedCount:r});else{const a=this._t(t);if(a!==r){const c=this.ut(e),l=c?this.ct(c,e,a):1;if(l!==0){this.it(t);const h=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,h)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=t;let a,c;try{a=vn(r).toUint8Array()}catch(l){if(l instanceof vd)return kr("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{c=new Fc(a,s,i)}catch(l){return kr(l instanceof ms?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return c.ge===0?null:c}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){const r=this.Ge.getRemoteKeysForTarget(t);let s=0;return r.forEach((i=>{const a=this.Ge.ht(),c=`projects/${a.projectId}/databases/${a.database}/documents/${i.path.canonicalString()}`;e.mightContain(c)||(this.et(t,i,null),s++)})),s}Tt(e){const t=new Map;this.ze.forEach(((i,a)=>{const c=this.ot(a);if(c){if(i.current&&qa(c.target)){const l=new U(c.target.path);this.It(l).has(a)||this.Et(a,l)||this.et(a,l,Le.newNoDocument(l,e))}i.Be&&(t.set(a,i.ke()),i.qe())}}));let r=Q();this.He.forEach(((i,a)=>{let c=!0;a.forEachWhile((l=>{const h=this.ot(l);return!h||h.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)})),c&&(r=r.add(i))})),this.je.forEach(((i,a)=>a.setReadTime(e)));const s=new Io(e,t,this.Ye,this.je,r);return this.je=jt(),this.Je=gi(),this.He=gi(),this.Ye=new fe(K),s}Xe(e,t){if(!this.rt(e))return;const r=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,r),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,t)?s.Qe(t,1):s.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new hh,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Ie(K),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Ie(K),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||M("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new hh),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function gi(){return new fe(U.comparator)}function fh(){return new fe(U.comparator)}const lE={asc:"ASCENDING",desc:"DESCENDING"},hE={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},fE={and:"AND",or:"OR"};class dE{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Ha(n,e){return n.useProto3Json||go(e)?e:{value:e}}function ji(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Kd(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function pE(n,e){return ji(n,e.toTimestamp())}function At(n){return te(!!n,49232),j.fromTimestamp((function(t){const r=yn(t);return new ue(r.seconds,r.nanos)})(n))}function Uc(n,e){return Wa(n,e).canonicalString()}function Wa(n,e){const t=(function(s){return new ce(["projects",s.projectId,"databases",s.database])})(n).child("documents");return e===void 0?t:t.child(e)}function Qd(n){const e=ce.fromString(n);return te(ep(e),10190,{key:e.toString()}),e}function Ga(n,e){return Uc(n.databaseId,e.path)}function ga(n,e){const t=Qd(e);if(t.get(1)!==n.databaseId.projectId)throw new F(N.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new F(N.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new U(Jd(t))}function Xd(n,e){return Uc(n.databaseId,e)}function mE(n){const e=Qd(n);return e.length===4?ce.emptyPath():Jd(e)}function Ka(n){return new ce(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Jd(n){return te(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function dh(n,e,t){return{name:Ga(n,e),fields:t.value.mapValue.fields}}function gE(n,e){let t;if("targetChange"in e){e.targetChange;const r=(function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:B(39313,{state:h})})(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=(function(h,d){return h.useProto3Json?(te(d===void 0||typeof d=="string",58123),ke.fromBase64String(d||"")):(te(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),ke.fromUint8Array(d||new Uint8Array))})(n,e.targetChange.resumeToken),a=e.targetChange.cause,c=a&&(function(h){const d=h.code===void 0?N.UNKNOWN:Hd(h.code);return new F(d,h.message||"")})(a);t=new Gd(r,s,i,c||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=ga(n,r.document.name),i=At(r.document.updateTime),a=r.document.createTime?At(r.document.createTime):j.min(),c=new He({mapValue:{fields:r.document.fields}}),l=Le.newFoundDocument(s,i,a,c),h=r.targetIds||[],d=r.removedTargetIds||[];t=new Ai(h,d,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=ga(n,r.document),i=r.readTime?At(r.readTime):j.min(),a=Le.newNoDocument(s,i),c=r.removedTargetIds||[];t=new Ai([],c,a.key,a)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=ga(n,r.document),i=r.removedTargetIds||[];t=new Ai([],i,s,null)}else{if(!("filter"in e))return B(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,a=new iE(s,i),c=r.targetId;t=new Wd(c,a)}}return t}function _E(n,e){let t;if(e instanceof Hs)t={update:dh(n,e.key,e.value)};else if(e instanceof Lc)t={delete:Ga(n,e.key)};else if(e instanceof Sn)t={update:dh(n,e.key,e.data),updateMask:SE(e.fieldMask)};else{if(!(e instanceof nE))return B(16599,{Vt:e.type});t={verify:Ga(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((r=>(function(i,a){const c=a.transform;if(c instanceof Bi)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof Os)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof Ms)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof $i)return{fieldPath:a.field.canonicalString(),increment:c.Ae};throw B(20930,{transform:a.transform})})(0,r)))),e.precondition.isNone||(t.currentDocument=(function(s,i){return i.updateTime!==void 0?{updateTime:pE(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:B(27497)})(n,e.precondition)),t}function yE(n,e){return n&&n.length>0?(te(e!==void 0,14353),n.map((t=>(function(s,i){let a=s.updateTime?At(s.updateTime):At(i);return a.isEqual(j.min())&&(a=At(i)),new Zv(a,s.transformResults||[])})(t,e)))):[]}function vE(n,e){return{documents:[Xd(n,e.path)]}}function EE(n,e){const t={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=Xd(n,s);const i=(function(h){if(h.length!==0)return Zd(kt.create(h,"and"))})(e.filters);i&&(t.structuredQuery.where=i);const a=(function(h){if(h.length!==0)return h.map((d=>(function(g){return{field:hr(g.field),direction:IE(g.dir)}})(d)))})(e.orderBy);a&&(t.structuredQuery.orderBy=a);const c=Ha(n,e.limit);return c!==null&&(t.structuredQuery.limit=c),e.startAt&&(t.structuredQuery.startAt=(function(h){return{before:h.inclusive,values:h.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(h){return{before:!h.inclusive,values:h.position}})(e.endAt)),{ft:t,parent:s}}function TE(n){let e=mE(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let s=null;if(r>0){te(r===1,65062);const d=t.from[0];d.allDescendants?s=d.collectionId:e=e.child(d.collectionId)}let i=[];t.where&&(i=(function(m){const g=Yd(m);return g instanceof kt&&Cd(g)?g.getFilters():[g]})(t.where));let a=[];t.orderBy&&(a=(function(m){return m.map((g=>(function(S){return new Ui(fr(S.field),(function(R){switch(R){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(S.direction))})(g)))})(t.orderBy));let c=null;t.limit&&(c=(function(m){let g;return g=typeof m=="object"?m.value:m,go(g)?null:g})(t.limit));let l=null;t.startAt&&(l=(function(m){const g=!!m.before,T=m.values||[];return new Fi(T,g)})(t.startAt));let h=null;return t.endAt&&(h=(function(m){const g=!m.before,T=m.values||[];return new Fi(T,g)})(t.endAt)),Uv(e,s,a,i,c,"F",l,h)}function wE(n,e){const t=(function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return B(28987,{purpose:s})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Yd(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=fr(t.unaryFilter.field);return Te.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=fr(t.unaryFilter.field);return Te.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=fr(t.unaryFilter.field);return Te.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=fr(t.unaryFilter.field);return Te.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return B(61313);default:return B(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Te.create(fr(t.fieldFilter.field),(function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return B(58110);default:return B(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return kt.create(t.compositeFilter.filters.map((r=>Yd(r))),(function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return B(1026)}})(t.compositeFilter.op))})(n):B(30097,{filter:n})}function IE(n){return lE[n]}function AE(n){return hE[n]}function bE(n){return fE[n]}function hr(n){return{fieldPath:n.canonicalString()}}function fr(n){return Re.fromServerFormat(n.fieldPath)}function Zd(n){return n instanceof Te?(function(t){if(t.op==="=="){if(eh(t.value))return{unaryFilter:{field:hr(t.field),op:"IS_NAN"}};if(Zl(t.value))return{unaryFilter:{field:hr(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(eh(t.value))return{unaryFilter:{field:hr(t.field),op:"IS_NOT_NAN"}};if(Zl(t.value))return{unaryFilter:{field:hr(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:hr(t.field),op:AE(t.op),value:t.value}}})(n):n instanceof kt?(function(t){const r=t.getFilters().map((s=>Zd(s)));return r.length===1?r[0]:{compositeFilter:{op:bE(t.op),filters:r}}})(n):B(54877,{filter:n})}function SE(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function ep(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}class on{constructor(e,t,r,s,i=j.min(),a=j.min(),c=ke.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=c,this.expectedCount=l}withSequenceNumber(e){return new on(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new on(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new on(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new on(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class RE{constructor(e){this.yt=e}}function PE(n){const e=TE({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?za(e,e.limit,"L"):e}class CE{constructor(){this.Cn=new kE}addToCollectionParentIndex(e,t){return this.Cn.add(t),k.resolve()}getCollectionParents(e,t){return k.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return k.resolve()}deleteFieldIndex(e,t){return k.resolve()}deleteAllFieldIndexes(e){return k.resolve()}createTargetIndexes(e,t){return k.resolve()}getDocumentsMatchingTarget(e,t){return k.resolve(null)}getIndexType(e,t){return k.resolve(0)}getFieldIndexes(e,t){return k.resolve([])}getNextCollectionGroupToUpdate(e){return k.resolve(null)}getMinOffset(e,t){return k.resolve(_n.min())}getMinOffsetFromCollectionGroup(e,t){return k.resolve(_n.min())}updateCollectionGroup(e,t,r){return k.resolve()}updateIndexEntries(e,t){return k.resolve()}}class kE{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t]||new Ie(ce.comparator),i=!s.has(r);return this.index[t]=s.add(r),i}has(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t];return s&&s.has(r)}getEntries(e){return(this.index[e]||new Ie(ce.comparator)).toArray()}}const ph={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},tp=41943040;class ze{static withCacheSize(e){return new ze(e,ze.DEFAULT_COLLECTION_PERCENTILE,ze.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}ze.DEFAULT_COLLECTION_PERCENTILE=10,ze.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ze.DEFAULT=new ze(tp,ze.DEFAULT_COLLECTION_PERCENTILE,ze.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ze.DISABLED=new ze(-1,0,0);class Or{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Or(0)}static cr(){return new Or(-1)}}const mh="LruGarbageCollector",NE=1048576;function gh([n,e],[t,r]){const s=K(n,t);return s===0?K(e,r):s}class DE{constructor(e){this.Ir=e,this.buffer=new Ie(gh),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();gh(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class VE{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){M(mh,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Gr(t)?M(mh,"Ignoring IndexedDB error during garbage collection: ",t):await Wr(t)}await this.Vr(3e5)}))}}class OE{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((r=>Math.floor(t/100*r)))}nthSequenceNumber(e,t){if(t===0)return k.resolve(mo.ce);const r=new DE(t);return this.mr.forEachTarget(e,(s=>r.Ar(s.sequenceNumber))).next((()=>this.mr.pr(e,(s=>r.Ar(s))))).next((()=>r.maxValue))}removeTargets(e,t,r){return this.mr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(M("LruGarbageCollector","Garbage collection skipped; disabled"),k.resolve(ph)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(M("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),ph):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let r,s,i,a,c,l,h;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((m=>(m>this.params.maximumSequenceNumbersToCollect?(M("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${m}`),s=this.params.maximumSequenceNumbersToCollect):s=m,a=Date.now(),this.nthSequenceNumber(e,s)))).next((m=>(r=m,c=Date.now(),this.removeTargets(e,r,t)))).next((m=>(i=m,l=Date.now(),this.removeOrphanedDocuments(e,r)))).next((m=>(h=Date.now(),ur()<=G.DEBUG&&M("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-d}ms
	Determined least recently used ${s} in `+(c-a)+`ms
	Removed ${i} targets in `+(l-c)+`ms
	Removed ${m} documents in `+(h-l)+`ms
Total Duration: ${h-d}ms`),k.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:m}))))}}function ME(n,e){return new OE(n,e)}class LE{constructor(){this.changes=new er((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Le.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?k.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class xE{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class FE{constructor(e,t,r,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next((s=>(r=s,this.remoteDocumentCache.getEntry(e,t)))).next((s=>(r!==null&&Is(r.mutation,s,Ze.empty(),ue.now()),s)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.getLocalViewOfDocuments(e,r,Q()).next((()=>r))))}getLocalViewOfDocuments(e,t,r=Q()){const s=Ln();return this.populateOverlays(e,s,t).next((()=>this.computeViews(e,t,s,r).next((i=>{let a=ps();return i.forEach(((c,l)=>{a=a.insert(c,l.overlayedDocument)})),a}))))}getOverlayedDocuments(e,t){const r=Ln();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,Q())))}populateOverlays(e,t,r){const s=[];return r.forEach((i=>{t.has(i)||s.push(i)})),this.documentOverlayCache.getOverlays(e,s).next((i=>{i.forEach(((a,c)=>{t.set(a,c)}))}))}computeViews(e,t,r,s){let i=jt();const a=ws(),c=(function(){return ws()})();return t.forEach(((l,h)=>{const d=r.get(h.key);s.has(h.key)&&(d===void 0||d.mutation instanceof Sn)?i=i.insert(h.key,h):d!==void 0?(a.set(h.key,d.mutation.getFieldMask()),Is(d.mutation,h,d.mutation.getFieldMask(),ue.now())):a.set(h.key,Ze.empty())})),this.recalculateAndSaveOverlays(e,i).next((l=>(l.forEach(((h,d)=>a.set(h,d))),t.forEach(((h,d)=>c.set(h,new xE(d,a.get(h)??null)))),c)))}recalculateAndSaveOverlays(e,t){const r=ws();let s=new fe(((a,c)=>a-c)),i=Q();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((a=>{for(const c of a)c.keys().forEach((l=>{const h=t.get(l);if(h===null)return;let d=r.get(l)||Ze.empty();d=c.applyToLocalView(h,d),r.set(l,d);const m=(s.get(c.batchId)||Q()).add(l);s=s.insert(c.batchId,m)}))})).next((()=>{const a=[],c=s.getReverseIterator();for(;c.hasNext();){const l=c.getNext(),h=l.key,d=l.value,m=xd();d.forEach((g=>{if(!i.has(g)){const T=qd(t.get(g),r.get(g));T!==null&&m.set(g,T),i=i.add(g)}})),a.push(this.documentOverlayCache.saveOverlays(e,h,m))}return k.waitFor(a)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,t,r,s){return(function(a){return U.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Bv(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,s):this.getDocumentsMatchingCollectionQuery(e,t,r,s)}getNextDocuments(e,t,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,s).next((i=>{const a=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,s-i.size):k.resolve(Ln());let c=ks,l=i;return a.next((h=>k.forEach(h,((d,m)=>(c<m.largestBatchId&&(c=m.largestBatchId),i.get(d)?k.resolve():this.remoteDocumentCache.getEntry(e,d).next((g=>{l=l.insert(d,g)}))))).next((()=>this.populateOverlays(e,h,i))).next((()=>this.computeViews(e,l,h,Q()))).next((d=>({batchId:c,changes:Ld(d)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new U(t)).next((r=>{let s=ps();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s}))}getDocumentsMatchingCollectionGroupQuery(e,t,r,s){const i=t.collectionGroup;let a=ps();return this.indexManager.getCollectionParents(e,i).next((c=>k.forEach(c,(l=>{const h=(function(m,g){return new yo(g,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)})(t,l.child(i));return this.getDocumentsMatchingCollectionQuery(e,h,r,s).next((d=>{d.forEach(((m,g)=>{a=a.insert(m,g)}))}))})).next((()=>a))))}getDocumentsMatchingCollectionQuery(e,t,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next((a=>(i=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,i,s)))).next((a=>{i.forEach(((l,h)=>{const d=h.getKey();a.get(d)===null&&(a=a.insert(d,Le.newInvalidDocument(d)))}));let c=ps();return a.forEach(((l,h)=>{const d=i.get(l);d!==void 0&&Is(d.mutation,h,Ze.empty(),ue.now()),Eo(t,h)&&(c=c.insert(l,h))})),c}))}}class UE{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return k.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(s){return{id:s.id,version:s.version,createTime:At(s.createTime)}})(t)),k.resolve()}getNamedQuery(e,t){return k.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(s){return{name:s.name,query:PE(s.bundledQuery),readTime:At(s.readTime)}})(t)),k.resolve()}}class BE{constructor(){this.overlays=new fe(U.comparator),this.qr=new Map}getOverlay(e,t){return k.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Ln();return k.forEach(t,(s=>this.getOverlay(e,s).next((i=>{i!==null&&r.set(s,i)})))).next((()=>r))}saveOverlays(e,t,r){return r.forEach(((s,i)=>{this.St(e,t,i)})),k.resolve()}removeOverlaysForBatchId(e,t,r){const s=this.qr.get(r);return s!==void 0&&(s.forEach((i=>this.overlays=this.overlays.remove(i))),this.qr.delete(r)),k.resolve()}getOverlaysForCollection(e,t,r){const s=Ln(),i=t.length+1,a=new U(t.child("")),c=this.overlays.getIteratorFrom(a);for(;c.hasNext();){const l=c.getNext().value,h=l.getKey();if(!t.isPrefixOf(h.path))break;h.path.length===i&&l.largestBatchId>r&&s.set(l.getKey(),l)}return k.resolve(s)}getOverlaysForCollectionGroup(e,t,r,s){let i=new fe(((h,d)=>h-d));const a=this.overlays.getIterator();for(;a.hasNext();){const h=a.getNext().value;if(h.getKey().getCollectionGroup()===t&&h.largestBatchId>r){let d=i.get(h.largestBatchId);d===null&&(d=Ln(),i=i.insert(h.largestBatchId,d)),d.set(h.getKey(),h)}}const c=Ln(),l=i.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach(((h,d)=>c.set(h,d))),!(c.size()>=s)););return k.resolve(c)}St(e,t,r){const s=this.overlays.get(r.key);if(s!==null){const a=this.qr.get(s.largestBatchId).delete(r.key);this.qr.set(s.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new sE(t,r));let i=this.qr.get(t);i===void 0&&(i=Q(),this.qr.set(t,i)),this.qr.set(t,i.add(r.key))}}class $E{constructor(){this.sessionToken=ke.EMPTY_BYTE_STRING}getSessionToken(e){return k.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,k.resolve()}}class Bc{constructor(){this.Qr=new Ie(be.$r),this.Ur=new Ie(be.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const r=new be(e,t);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,t){e.forEach((r=>this.addReference(r,t)))}removeReference(e,t){this.Gr(new be(e,t))}zr(e,t){e.forEach((r=>this.removeReference(r,t)))}jr(e){const t=new U(new ce([])),r=new be(t,e),s=new be(t,e+1),i=[];return this.Ur.forEachInRange([r,s],(a=>{this.Gr(a),i.push(a.key)})),i}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new U(new ce([])),r=new be(t,e),s=new be(t,e+1);let i=Q();return this.Ur.forEachInRange([r,s],(a=>{i=i.add(a.key)})),i}containsKey(e){const t=new be(e,0),r=this.Qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class be{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return U.comparator(e.key,t.key)||K(e.Yr,t.Yr)}static Kr(e,t){return K(e.Yr,t.Yr)||U.comparator(e.key,t.key)}}class jE{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Ie(be.$r)}checkEmpty(e){return k.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,s){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new rE(i,t,r,s);this.mutationQueue.push(a);for(const c of s)this.Zr=this.Zr.add(new be(c.key,i)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return k.resolve(a)}lookupMutationBatch(e,t){return k.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,s=this.ei(r),i=s<0?0:s;return k.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return k.resolve(this.mutationQueue.length===0?Cc:this.tr-1)}getAllMutationBatches(e){return k.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new be(t,0),s=new be(t,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([r,s],(a=>{const c=this.Xr(a.Yr);i.push(c)})),k.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Ie(K);return t.forEach((s=>{const i=new be(s,0),a=new be(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,a],(c=>{r=r.add(c.Yr)}))})),k.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,s=r.length+1;let i=r;U.isDocumentKey(i)||(i=i.child(""));const a=new be(new U(i),0);let c=new Ie(K);return this.Zr.forEachWhile((l=>{const h=l.key.path;return!!r.isPrefixOf(h)&&(h.length===s&&(c=c.add(l.Yr)),!0)}),a),k.resolve(this.ti(c))}ti(e){const t=[];return e.forEach((r=>{const s=this.Xr(r);s!==null&&t.push(s)})),t}removeMutationBatch(e,t){te(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return k.forEach(t.mutations,(s=>{const i=new be(s.key,t.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)})).next((()=>{this.Zr=r}))}ir(e){}containsKey(e,t){const r=new be(t,0),s=this.Zr.firstAfterOrEqual(r);return k.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,k.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class qE{constructor(e){this.ri=e,this.docs=(function(){return new fe(U.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,s=this.docs.get(r),i=s?s.size:0,a=this.ri(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return k.resolve(r?r.document.mutableCopy():Le.newInvalidDocument(t))}getEntries(e,t){let r=jt();return t.forEach((s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():Le.newInvalidDocument(s))})),k.resolve(r)}getDocumentsMatchingQuery(e,t,r,s){let i=jt();const a=t.path,c=new U(a.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(c);for(;l.hasNext();){const{key:h,value:{document:d}}=l.getNext();if(!a.isPrefixOf(h.path))break;h.path.length>a.length+1||_v(gv(d),r)<=0||(s.has(d.key)||Eo(t,d))&&(i=i.insert(d.key,d.mutableCopy()))}return k.resolve(i)}getAllFromCollectionGroup(e,t,r,s){B(9500)}ii(e,t){return k.forEach(this.docs,(r=>t(r)))}newChangeBuffer(e){return new zE(this)}getSize(e){return k.resolve(this.size)}}class zE extends LE{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((r,s)=>{s.isValidDocument()?t.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(r)})),k.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class HE{constructor(e){this.persistence=e,this.si=new er((t=>Dc(t)),Vc),this.lastRemoteSnapshotVersion=j.min(),this.highestTargetId=0,this.oi=0,this._i=new Bc,this.targetCount=0,this.ai=Or.ur()}forEachTarget(e,t){return this.si.forEach(((r,s)=>t(s))),k.resolve()}getLastRemoteSnapshotVersion(e){return k.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return k.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),k.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.oi&&(this.oi=t),k.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Or(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,k.resolve()}updateTargetData(e,t){return this.Pr(t),k.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,k.resolve()}removeTargets(e,t,r){let s=0;const i=[];return this.si.forEach(((a,c)=>{c.sequenceNumber<=t&&r.get(c.targetId)===null&&(this.si.delete(a),i.push(this.removeMatchingKeysForTargetId(e,c.targetId)),s++)})),k.waitFor(i).next((()=>s))}getTargetCount(e){return k.resolve(this.targetCount)}getTargetData(e,t){const r=this.si.get(t)||null;return k.resolve(r)}addMatchingKeys(e,t,r){return this._i.Wr(t,r),k.resolve()}removeMatchingKeys(e,t,r){this._i.zr(t,r);const s=this.persistence.referenceDelegate,i=[];return s&&t.forEach((a=>{i.push(s.markPotentiallyOrphaned(e,a))})),k.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),k.resolve()}getMatchingKeysForTargetId(e,t){const r=this._i.Hr(t);return k.resolve(r)}containsKey(e,t){return k.resolve(this._i.containsKey(t))}}class np{constructor(e,t){this.ui={},this.overlays={},this.ci=new mo(0),this.li=!1,this.li=!0,this.hi=new $E,this.referenceDelegate=e(this),this.Pi=new HE(this),this.indexManager=new CE,this.remoteDocumentCache=(function(s){return new qE(s)})((r=>this.referenceDelegate.Ti(r))),this.serializer=new RE(t),this.Ii=new UE(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new BE,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ui[e.toKey()];return r||(r=new jE(t,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,r){M("MemoryPersistence","Starting transaction:",e);const s=new WE(this.ci.next());return this.referenceDelegate.Ei(),r(s).next((i=>this.referenceDelegate.di(s).next((()=>i)))).toPromise().then((i=>(s.raiseOnCommittedEvent(),i)))}Ai(e,t){return k.or(Object.values(this.ui).map((r=>()=>r.containsKey(e,t))))}}class WE extends vv{constructor(e){super(),this.currentSequenceNumber=e}}class $c{constructor(e){this.persistence=e,this.Ri=new Bc,this.Vi=null}static mi(e){return new $c(e)}get fi(){if(this.Vi)return this.Vi;throw B(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.fi.delete(r.toString()),k.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.fi.add(r.toString()),k.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),k.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((s=>this.fi.add(s.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((s=>{s.forEach((i=>this.fi.add(i.toString())))})).next((()=>r.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return k.forEach(this.fi,(r=>{const s=U.fromPath(r);return this.gi(e,s).next((i=>{i||t.removeEntry(s,j.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((r=>{r?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return k.or([()=>k.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class qi{constructor(e,t){this.persistence=e,this.pi=new er((r=>wv(r.path)),((r,s)=>r.isEqual(s))),this.garbageCollector=ME(this,t)}static mi(e,t){return new qi(e,t)}Ei(){}di(e){return k.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>t.next((s=>r+s))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}pr(e,t){return k.forEach(this.pi,((r,s)=>this.br(e,r,s).next((i=>i?k.resolve():t(s)))))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.ii(e,(a=>this.br(e,a,t).next((c=>{c||(r++,i.removeEntry(a,j.min()))})))).next((()=>i.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),k.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),k.resolve()}removeReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),k.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),k.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Ti(e.data.value)),t}br(e,t,r){return k.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const s=this.pi.get(t);return k.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class jc{constructor(e,t,r,s){this.targetId=e,this.fromCache=t,this.Es=r,this.ds=s}static As(e,t){let r=Q(),s=Q();for(const i of t.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new jc(e,t.fromCache,r,s)}}class GE{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class KE{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return F_()?8:Ev(Fe())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,s){const i={result:null};return this.ys(e,t).next((a=>{i.result=a})).next((()=>{if(!i.result)return this.ws(e,t,s,r).next((a=>{i.result=a}))})).next((()=>{if(i.result)return;const a=new GE;return this.Ss(e,t,a).next((c=>{if(i.result=c,this.Vs)return this.bs(e,t,a,c.size)}))})).next((()=>i.result))}bs(e,t,r,s){return r.documentReadCount<this.fs?(ur()<=G.DEBUG&&M("QueryEngine","SDK will not create cache indexes for query:",lr(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),k.resolve()):(ur()<=G.DEBUG&&M("QueryEngine","Query:",lr(t),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.gs*s?(ur()<=G.DEBUG&&M("QueryEngine","The SDK decides to create cache indexes for query:",lr(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,It(t))):k.resolve())}ys(e,t){if(sh(t))return k.resolve(null);let r=It(t);return this.indexManager.getIndexType(e,r).next((s=>s===0?null:(t.limit!==null&&s===1&&(t=za(t,null,"F"),r=It(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next((i=>{const a=Q(...i);return this.ps.getDocuments(e,a).next((c=>this.indexManager.getMinOffset(e,r).next((l=>{const h=this.Ds(t,c);return this.Cs(t,h,a,l.readTime)?this.ys(e,za(t,null,"F")):this.vs(e,h,t,l)}))))})))))}ws(e,t,r,s){return sh(t)||s.isEqual(j.min())?k.resolve(null):this.ps.getDocuments(e,r).next((i=>{const a=this.Ds(t,i);return this.Cs(t,a,r,s)?k.resolve(null):(ur()<=G.DEBUG&&M("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),lr(t)),this.vs(e,a,t,mv(s,ks)).next((c=>c)))}))}Ds(e,t){let r=new Ie(Od(e));return t.forEach(((s,i)=>{Eo(e,i)&&(r=r.add(i))})),r}Cs(e,t,r,s){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const i=e.limitType==="F"?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Ss(e,t,r){return ur()<=G.DEBUG&&M("QueryEngine","Using full collection scan to execute query:",lr(t)),this.ps.getDocumentsMatchingQuery(e,t,_n.min(),r)}vs(e,t,r,s){return this.ps.getDocumentsMatchingQuery(e,r,s).next((i=>(t.forEach((a=>{i=i.insert(a.key,a)})),i)))}}const qc="LocalStore",QE=3e8;class XE{constructor(e,t,r,s){this.persistence=e,this.Fs=t,this.serializer=s,this.Ms=new fe(K),this.xs=new er((i=>Dc(i)),Vc),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new FE(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function JE(n,e,t,r){return new XE(n,e,t,r)}async function rp(n,e){const t=q(n);return await t.persistence.runTransaction("Handle user change","readonly",(r=>{let s;return t.mutationQueue.getAllMutationBatches(r).next((i=>(s=i,t.Bs(e),t.mutationQueue.getAllMutationBatches(r)))).next((i=>{const a=[],c=[];let l=Q();for(const h of s){a.push(h.batchId);for(const d of h.mutations)l=l.add(d.key)}for(const h of i){c.push(h.batchId);for(const d of h.mutations)l=l.add(d.key)}return t.localDocuments.getDocuments(r,l).next((h=>({Ls:h,removedBatchIds:a,addedBatchIds:c})))}))}))}function YE(n,e){const t=q(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const s=e.batch.keys(),i=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(c,l,h,d){const m=h.batch,g=m.keys();let T=k.resolve();return g.forEach((S=>{T=T.next((()=>d.getEntry(l,S))).next((C=>{const R=h.docVersions.get(S);te(R!==null,48541),C.version.compareTo(R)<0&&(m.applyToRemoteDocument(C,h),C.isValidDocument()&&(C.setReadTime(h.commitVersion),d.addEntry(C)))}))})),T.next((()=>c.mutationQueue.removeMutationBatch(l,m)))})(t,r,e,i).next((()=>i.apply(r))).next((()=>t.mutationQueue.performConsistencyCheck(r))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(c){let l=Q();for(let h=0;h<c.mutationResults.length;++h)c.mutationResults[h].transformResults.length>0&&(l=l.add(c.batch.mutations[h].key));return l})(e)))).next((()=>t.localDocuments.getDocuments(r,s)))}))}function sp(n){const e=q(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function ZE(n,e){const t=q(n),r=e.snapshotVersion;let s=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(i=>{const a=t.Ns.newChangeBuffer({trackRemovals:!0});s=t.Ms;const c=[];e.targetChanges.forEach(((d,m)=>{const g=s.get(m);if(!g)return;c.push(t.Pi.removeMatchingKeys(i,d.removedDocuments,m).next((()=>t.Pi.addMatchingKeys(i,d.addedDocuments,m))));let T=g.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(m)!==null?T=T.withResumeToken(ke.EMPTY_BYTE_STRING,j.min()).withLastLimboFreeSnapshotVersion(j.min()):d.resumeToken.approximateByteSize()>0&&(T=T.withResumeToken(d.resumeToken,r)),s=s.insert(m,T),(function(C,R,L){return C.resumeToken.approximateByteSize()===0||R.snapshotVersion.toMicroseconds()-C.snapshotVersion.toMicroseconds()>=QE?!0:L.addedDocuments.size+L.modifiedDocuments.size+L.removedDocuments.size>0})(g,T,d)&&c.push(t.Pi.updateTargetData(i,T))}));let l=jt(),h=Q();if(e.documentUpdates.forEach((d=>{e.resolvedLimboDocuments.has(d)&&c.push(t.persistence.referenceDelegate.updateLimboDocument(i,d))})),c.push(eT(i,a,e.documentUpdates).next((d=>{l=d.ks,h=d.qs}))),!r.isEqual(j.min())){const d=t.Pi.getLastRemoteSnapshotVersion(i).next((m=>t.Pi.setTargetsMetadata(i,i.currentSequenceNumber,r)));c.push(d)}return k.waitFor(c).next((()=>a.apply(i))).next((()=>t.localDocuments.getLocalViewOfDocuments(i,l,h))).next((()=>l))})).then((i=>(t.Ms=s,i)))}function eT(n,e,t){let r=Q(),s=Q();return t.forEach((i=>r=r.add(i))),e.getEntries(n,r).next((i=>{let a=jt();return t.forEach(((c,l)=>{const h=i.get(c);l.isFoundDocument()!==h.isFoundDocument()&&(s=s.add(c)),l.isNoDocument()&&l.version.isEqual(j.min())?(e.removeEntry(c,l.readTime),a=a.insert(c,l)):!h.isValidDocument()||l.version.compareTo(h.version)>0||l.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(l),a=a.insert(c,l)):M(qc,"Ignoring outdated watch update for ",c,". Current version:",h.version," Watch version:",l.version)})),{ks:a,qs:s}}))}function tT(n,e){const t=q(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=Cc),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function nT(n,e){const t=q(n);return t.persistence.runTransaction("Allocate target","readwrite",(r=>{let s;return t.Pi.getTargetData(r,e).next((i=>i?(s=i,k.resolve(s)):t.Pi.allocateTargetId(r).next((a=>(s=new on(e,a,"TargetPurposeListen",r.currentSequenceNumber),t.Pi.addTargetData(r,s).next((()=>s)))))))})).then((r=>{const s=t.Ms.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(r.targetId,r),t.xs.set(e,r.targetId)),r}))}async function Qa(n,e,t){const r=q(n),s=r.Ms.get(e),i=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",i,(a=>r.persistence.referenceDelegate.removeTarget(a,s)))}catch(a){if(!Gr(a))throw a;M(qc,`Failed to update sequence numbers for target ${e}: ${a}`)}r.Ms=r.Ms.remove(e),r.xs.delete(s.target)}function _h(n,e,t){const r=q(n);let s=j.min(),i=Q();return r.persistence.runTransaction("Execute query","readwrite",(a=>(function(l,h,d){const m=q(l),g=m.xs.get(d);return g!==void 0?k.resolve(m.Ms.get(g)):m.Pi.getTargetData(h,d)})(r,a,It(e)).next((c=>{if(c)return s=c.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(a,c.targetId).next((l=>{i=l}))})).next((()=>r.Fs.getDocumentsMatchingQuery(a,e,t?s:j.min(),t?i:Q()))).next((c=>(rT(r,jv(e),c),{documents:c,Qs:i})))))}function rT(n,e,t){let r=n.Os.get(e)||j.min();t.forEach(((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)})),n.Os.set(e,r)}class yh{constructor(){this.activeTargetIds=Kv()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class sT{constructor(){this.Mo=new yh,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,r){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new yh,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class iT{Oo(e){}shutdown(){}}const vh="ConnectivityMonitor";class Eh{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){M(vh,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){M(vh,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let _i=null;function Xa(){return _i===null?_i=(function(){return 268435456+Math.round(2147483648*Math.random())})():_i++,"0x"+_i.toString(16)}const _a="RestConnection",oT={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class aT{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${r}/databases/${s}`,this.Wo=this.databaseId.database===Li?`project_id=${r}`:`project_id=${r}&database_id=${s}`}Go(e,t,r,s,i){const a=Xa(),c=this.zo(e,t.toUriEncodedString());M(_a,`Sending RPC '${e}' ${a}:`,c,r);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,s,i);const{host:h}=new URL(c),d=An(h);return this.Jo(e,c,l,r,d).then((m=>(M(_a,`Received RPC '${e}' ${a}: `,m),m)),(m=>{throw kr(_a,`RPC '${e}' ${a} failed with error: `,m,"url: ",c,"request:",r),m}))}Ho(e,t,r,s,i,a){return this.Go(e,t,r,s,i)}jo(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Hr})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((s,i)=>e[i]=s)),r&&r.headers.forEach(((s,i)=>e[i]=s))}zo(e,t){const r=oT[e];return`${this.Uo}/v1/${t}:${r}`}terminate(){}}class cT{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const Ve="WebChannelConnection";class uT extends aT{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,s,i){const a=Xa();return new Promise(((c,l)=>{const h=new cd;h.setWithCredentials(!0),h.listenOnce(ud.COMPLETE,(()=>{try{switch(h.getLastErrorCode()){case Ei.NO_ERROR:const m=h.getResponseJson();M(Ve,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(m)),c(m);break;case Ei.TIMEOUT:M(Ve,`RPC '${e}' ${a} timed out`),l(new F(N.DEADLINE_EXCEEDED,"Request time out"));break;case Ei.HTTP_ERROR:const g=h.getStatus();if(M(Ve,`RPC '${e}' ${a} failed with status:`,g,"response text:",h.getResponseText()),g>0){let T=h.getResponseJson();Array.isArray(T)&&(T=T[0]);const S=T?.error;if(S&&S.status&&S.message){const C=(function(L){const O=L.toLowerCase().replace(/_/g,"-");return Object.values(N).indexOf(O)>=0?O:N.UNKNOWN})(S.status);l(new F(C,S.message))}else l(new F(N.UNKNOWN,"Server responded with status "+h.getStatus()))}else l(new F(N.UNAVAILABLE,"Connection failed."));break;default:B(9055,{l_:e,streamId:a,h_:h.getLastErrorCode(),P_:h.getLastError()})}}finally{M(Ve,`RPC '${e}' ${a} completed.`)}}));const d=JSON.stringify(s);M(Ve,`RPC '${e}' ${a} sending request:`,s),h.send(t,"POST",d,r,15)}))}T_(e,t,r){const s=Xa(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=fd(),c=hd(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(l.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,t,r),l.encodeInitMessageHeaders=!0;const d=i.join("");M(Ve,`Creating RPC '${e}' stream ${s}: ${d}`,l);const m=a.createWebChannel(d,l);this.I_(m);let g=!1,T=!1;const S=new cT({Yo:R=>{T?M(Ve,`Not sending because RPC '${e}' stream ${s} is closed:`,R):(g||(M(Ve,`Opening RPC '${e}' stream ${s} transport.`),m.open(),g=!0),M(Ve,`RPC '${e}' stream ${s} sending:`,R),m.send(R))},Zo:()=>m.close()}),C=(R,L,O)=>{R.listen(L,(D=>{try{O(D)}catch(z){setTimeout((()=>{throw z}),0)}}))};return C(m,ds.EventType.OPEN,(()=>{T||(M(Ve,`RPC '${e}' stream ${s} transport opened.`),S.o_())})),C(m,ds.EventType.CLOSE,(()=>{T||(T=!0,M(Ve,`RPC '${e}' stream ${s} transport closed`),S.a_(),this.E_(m))})),C(m,ds.EventType.ERROR,(R=>{T||(T=!0,kr(Ve,`RPC '${e}' stream ${s} transport errored. Name:`,R.name,"Message:",R.message),S.a_(new F(N.UNAVAILABLE,"The operation could not be completed")))})),C(m,ds.EventType.MESSAGE,(R=>{if(!T){const L=R.data[0];te(!!L,16349);const O=L,D=O?.error||O[0]?.error;if(D){M(Ve,`RPC '${e}' stream ${s} received error:`,D);const z=D.status;let J=(function(_){const y=me[_];if(y!==void 0)return Hd(y)})(z),ee=D.message;J===void 0&&(J=N.INTERNAL,ee="Unknown error status: "+z+" with message "+D.message),T=!0,S.a_(new F(J,ee)),m.close()}else M(Ve,`RPC '${e}' stream ${s} received:`,L),S.u_(L)}})),C(c,ld.STAT_EVENT,(R=>{R.stat===Fa.PROXY?M(Ve,`RPC '${e}' stream ${s} detected buffering proxy`):R.stat===Fa.NOPROXY&&M(Ve,`RPC '${e}' stream ${s} detected no buffering proxy`)})),setTimeout((()=>{S.__()}),0),S}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function ya(){return typeof document<"u"?document:null}function Ao(n){return new dE(n,!0)}class ip{constructor(e,t,r=1e3,s=1.5,i=6e4){this.Mi=e,this.timerId=t,this.d_=r,this.A_=s,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),s=Math.max(0,t-r);s>0&&M("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const Th="PersistentStream";class op{constructor(e,t,r,s,i,a,c,l){this.Mi=e,this.S_=r,this.b_=s,this.connection=i,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=c,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new ip(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===N.RESOURCE_EXHAUSTED?($t(t.toString()),$t("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===N.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,s])=>{this.D_===t&&this.G_(r,s)}),(r=>{e((()=>{const s=new F(N.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(s)}))}))}G_(e,t){const r=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{r((()=>this.listener.Xo()))})),this.stream.t_((()=>{r((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((s=>{r((()=>this.z_(s)))})),this.stream.onMessage((s=>{r((()=>++this.F_==1?this.J_(s):this.onNext(s)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return M(Th,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(M(Th,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class lT extends op{constructor(e,t,r,s,i,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,s,a),this.serializer=i}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=gE(this.serializer,e),r=(function(i){if(!("targetChange"in i))return j.min();const a=i.targetChange;return a.targetIds&&a.targetIds.length?j.min():a.readTime?At(a.readTime):j.min()})(e);return this.listener.H_(t,r)}Y_(e){const t={};t.database=Ka(this.serializer),t.addTarget=(function(i,a){let c;const l=a.target;if(c=qa(l)?{documents:vE(i,l)}:{query:EE(i,l).ft},c.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){c.resumeToken=Kd(i,a.resumeToken);const h=Ha(i,a.expectedCount);h!==null&&(c.expectedCount=h)}else if(a.snapshotVersion.compareTo(j.min())>0){c.readTime=ji(i,a.snapshotVersion.toTimestamp());const h=Ha(i,a.expectedCount);h!==null&&(c.expectedCount=h)}return c})(this.serializer,e);const r=wE(this.serializer,e);r&&(t.labels=r),this.q_(t)}Z_(e){const t={};t.database=Ka(this.serializer),t.removeTarget=e,this.q_(t)}}class hT extends op{constructor(e,t,r,s,i,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,s,a),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return te(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,te(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){te(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=yE(e.writeResults,e.commitTime),r=At(e.commitTime);return this.listener.na(r,t)}ra(){const e={};e.database=Ka(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((r=>_E(this.serializer,r)))};this.q_(t)}}class fT{}class dT extends fT{constructor(e,t,r,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new F(N.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,a])=>this.connection.Go(e,Wa(t,r),s,i,a))).catch((i=>{throw i.name==="FirebaseError"?(i.code===N.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new F(N.UNKNOWN,i.toString())}))}Ho(e,t,r,s,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,c])=>this.connection.Ho(e,Wa(t,r),s,a,c,i))).catch((a=>{throw a.name==="FirebaseError"?(a.code===N.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new F(N.UNKNOWN,a.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class pT{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?($t(t),this.aa=!1):M("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Xn="RemoteStore";class mT{constructor(e,t,r,s,i){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo((a=>{r.enqueueAndForget((async()=>{tr(this)&&(M(Xn,"Restarting streams for network reachability change."),await(async function(l){const h=q(l);h.Ea.add(4),await Gs(h),h.Ra.set("Unknown"),h.Ea.delete(4),await bo(h)})(this))}))})),this.Ra=new pT(r,s)}}async function bo(n){if(tr(n))for(const e of n.da)await e(!0)}async function Gs(n){for(const e of n.da)await e(!1)}function ap(n,e){const t=q(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),Gc(t)?Wc(t):Kr(t).O_()&&Hc(t,e))}function zc(n,e){const t=q(n),r=Kr(t);t.Ia.delete(e),r.O_()&&cp(t,e),t.Ia.size===0&&(r.O_()?r.L_():tr(t)&&t.Ra.set("Unknown"))}function Hc(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(j.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Kr(n).Y_(e)}function cp(n,e){n.Va.Ue(e),Kr(n).Z_(e)}function Wc(n){n.Va=new uE({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),Kr(n).start(),n.Ra.ua()}function Gc(n){return tr(n)&&!Kr(n).x_()&&n.Ia.size>0}function tr(n){return q(n).Ea.size===0}function up(n){n.Va=void 0}async function gT(n){n.Ra.set("Online")}async function _T(n){n.Ia.forEach(((e,t)=>{Hc(n,e)}))}async function yT(n,e){up(n),Gc(n)?(n.Ra.ha(e),Wc(n)):n.Ra.set("Unknown")}async function vT(n,e,t){if(n.Ra.set("Online"),e instanceof Gd&&e.state===2&&e.cause)try{await(async function(s,i){const a=i.cause;for(const c of i.targetIds)s.Ia.has(c)&&(await s.remoteSyncer.rejectListen(c,a),s.Ia.delete(c),s.Va.removeTarget(c))})(n,e)}catch(r){M(Xn,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await zi(n,r)}else if(e instanceof Ai?n.Va.Ze(e):e instanceof Wd?n.Va.st(e):n.Va.tt(e),!t.isEqual(j.min()))try{const r=await sp(n.localStore);t.compareTo(r)>=0&&await(function(i,a){const c=i.Va.Tt(a);return c.targetChanges.forEach(((l,h)=>{if(l.resumeToken.approximateByteSize()>0){const d=i.Ia.get(h);d&&i.Ia.set(h,d.withResumeToken(l.resumeToken,a))}})),c.targetMismatches.forEach(((l,h)=>{const d=i.Ia.get(l);if(!d)return;i.Ia.set(l,d.withResumeToken(ke.EMPTY_BYTE_STRING,d.snapshotVersion)),cp(i,l);const m=new on(d.target,l,h,d.sequenceNumber);Hc(i,m)})),i.remoteSyncer.applyRemoteEvent(c)})(n,t)}catch(r){M(Xn,"Failed to raise snapshot:",r),await zi(n,r)}}async function zi(n,e,t){if(!Gr(e))throw e;n.Ea.add(1),await Gs(n),n.Ra.set("Offline"),t||(t=()=>sp(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{M(Xn,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await bo(n)}))}function lp(n,e){return e().catch((t=>zi(n,t,e)))}async function So(n){const e=q(n),t=Tn(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Cc;for(;ET(e);)try{const s=await tT(e.localStore,r);if(s===null){e.Ta.length===0&&t.L_();break}r=s.batchId,TT(e,s)}catch(s){await zi(e,s)}hp(e)&&fp(e)}function ET(n){return tr(n)&&n.Ta.length<10}function TT(n,e){n.Ta.push(e);const t=Tn(n);t.O_()&&t.X_&&t.ea(e.mutations)}function hp(n){return tr(n)&&!Tn(n).x_()&&n.Ta.length>0}function fp(n){Tn(n).start()}async function wT(n){Tn(n).ra()}async function IT(n){const e=Tn(n);for(const t of n.Ta)e.ea(t.mutations)}async function AT(n,e,t){const r=n.Ta.shift(),s=xc.from(r,e,t);await lp(n,(()=>n.remoteSyncer.applySuccessfulWrite(s))),await So(n)}async function bT(n,e){e&&Tn(n).X_&&await(async function(r,s){if((function(a){return oE(a)&&a!==N.ABORTED})(s.code)){const i=r.Ta.shift();Tn(r).B_(),await lp(r,(()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s))),await So(r)}})(n,e),hp(n)&&fp(n)}async function wh(n,e){const t=q(n);t.asyncQueue.verifyOperationInProgress(),M(Xn,"RemoteStore received new credentials");const r=tr(t);t.Ea.add(3),await Gs(t),r&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await bo(t)}async function ST(n,e){const t=q(n);e?(t.Ea.delete(2),await bo(t)):e||(t.Ea.add(2),await Gs(t),t.Ra.set("Unknown"))}function Kr(n){return n.ma||(n.ma=(function(t,r,s){const i=q(t);return i.sa(),new lT(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)})(n.datastore,n.asyncQueue,{Xo:gT.bind(null,n),t_:_T.bind(null,n),r_:yT.bind(null,n),H_:vT.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),Gc(n)?Wc(n):n.Ra.set("Unknown")):(await n.ma.stop(),up(n))}))),n.ma}function Tn(n){return n.fa||(n.fa=(function(t,r,s){const i=q(t);return i.sa(),new hT(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:wT.bind(null,n),r_:bT.bind(null,n),ta:IT.bind(null,n),na:AT.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await So(n)):(await n.fa.stop(),n.Ta.length>0&&(M(Xn,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class Kc{constructor(e,t,r,s,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new $n,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((a=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,s,i){const a=Date.now()+r,c=new Kc(e,t,a,s,i);return c.start(r),c}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new F(N.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Qc(n,e){if($t("AsyncQueue",`${e}: ${n}`),Gr(n))return new F(N.UNAVAILABLE,`${e}: ${n}`);throw n}class Tr{static emptySet(e){return new Tr(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||U.comparator(t.key,r.key):(t,r)=>U.comparator(t.key,r.key),this.keyedMap=ps(),this.sortedSet=new fe(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,r)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Tr)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new Tr;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class Ih{constructor(){this.ga=new fe(U.comparator)}track(e){const t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):B(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,r)=>{e.push(r)})),e}}class Mr{constructor(e,t,r,s,i,a,c,l,h){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=a,this.syncStateChanged=c,this.excludesMetadataChanges=l,this.hasCachedResults=h}static fromInitialDocuments(e,t,r,s,i){const a=[];return t.forEach((c=>{a.push({type:0,doc:c})})),new Mr(e,t,Tr.emptySet(t),a,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&vo(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==r[s].type||!t[s].doc.isEqual(r[s].doc))return!1;return!0}}class RT{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class PT{constructor(){this.queries=Ah(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){const s=q(t),i=s.queries;s.queries=Ah(),i.forEach(((a,c)=>{for(const l of c.Sa)l.onError(r)}))})(this,new F(N.ABORTED,"Firestore shutting down"))}}function Ah(){return new er((n=>Vd(n)),vo)}async function CT(n,e){const t=q(n);let r=3;const s=e.query;let i=t.queries.get(s);i?!i.ba()&&e.Da()&&(r=2):(i=new RT,r=e.Da()?0:1);try{switch(r){case 0:i.wa=await t.onListen(s,!0);break;case 1:i.wa=await t.onListen(s,!1);break;case 2:await t.onFirstRemoteStoreListen(s)}}catch(a){const c=Qc(a,`Initialization of query '${lr(e.query)}' failed`);return void e.onError(c)}t.queries.set(s,i),i.Sa.push(e),e.va(t.onlineState),i.wa&&e.Fa(i.wa)&&Xc(t)}async function kT(n,e){const t=q(n),r=e.query;let s=3;const i=t.queries.get(r);if(i){const a=i.Sa.indexOf(e);a>=0&&(i.Sa.splice(a,1),i.Sa.length===0?s=e.Da()?0:1:!i.ba()&&e.Da()&&(s=2))}switch(s){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function NT(n,e){const t=q(n);let r=!1;for(const s of e){const i=s.query,a=t.queries.get(i);if(a){for(const c of a.Sa)c.Fa(s)&&(r=!0);a.wa=s}}r&&Xc(t)}function DT(n,e,t){const r=q(n),s=r.queries.get(e);if(s)for(const i of s.Sa)i.onError(t);r.queries.delete(e)}function Xc(n){n.Ca.forEach((e=>{e.next()}))}var Ja,bh;(bh=Ja||(Ja={})).Ma="default",bh.Cache="cache";class VT{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Mr(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const r=t!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Mr.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Ja.Cache}}class dp{constructor(e){this.key=e}}class pp{constructor(e){this.key=e}}class OT{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Q(),this.mutatedKeys=Q(),this.eu=Od(e),this.tu=new Tr(this.eu)}get nu(){return this.Ya}ru(e,t){const r=t?t.iu:new Ih,s=t?t.tu:this.tu;let i=t?t.mutatedKeys:this.mutatedKeys,a=s,c=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,h=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal(((d,m)=>{const g=s.get(d),T=Eo(this.query,m)?m:null,S=!!g&&this.mutatedKeys.has(g.key),C=!!T&&(T.hasLocalMutations||this.mutatedKeys.has(T.key)&&T.hasCommittedMutations);let R=!1;g&&T?g.data.isEqual(T.data)?S!==C&&(r.track({type:3,doc:T}),R=!0):this.su(g,T)||(r.track({type:2,doc:T}),R=!0,(l&&this.eu(T,l)>0||h&&this.eu(T,h)<0)&&(c=!0)):!g&&T?(r.track({type:0,doc:T}),R=!0):g&&!T&&(r.track({type:1,doc:g}),R=!0,(l||h)&&(c=!0)),R&&(T?(a=a.add(T),i=C?i.add(d):i.delete(d)):(a=a.delete(d),i=i.delete(d)))})),this.query.limit!==null)for(;a.size>this.query.limit;){const d=this.query.limitType==="F"?a.last():a.first();a=a.delete(d.key),i=i.delete(d.key),r.track({type:1,doc:d})}return{tu:a,iu:r,Cs:c,mutatedKeys:i}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,s){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const a=e.iu.ya();a.sort(((d,m)=>(function(T,S){const C=R=>{switch(R){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return B(20277,{Rt:R})}};return C(T)-C(S)})(d.type,m.type)||this.eu(d.doc,m.doc))),this.ou(r),s=s??!1;const c=t&&!s?this._u():[],l=this.Xa.size===0&&this.current&&!s?1:0,h=l!==this.Za;return this.Za=l,a.length!==0||h?{snapshot:new Mr(this.query,e.tu,i,a,e.mutatedKeys,l===0,h,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:c}:{au:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Ih,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Q(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))}));const t=[];return e.forEach((r=>{this.Xa.has(r)||t.push(new pp(r))})),this.Xa.forEach((r=>{e.has(r)||t.push(new dp(r))})),t}cu(e){this.Ya=e.Qs,this.Xa=Q();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Mr.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Jc="SyncEngine";class MT{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class LT{constructor(e){this.key=e,this.hu=!1}}class xT{constructor(e,t,r,s,i,a){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new er((c=>Vd(c)),vo),this.Iu=new Map,this.Eu=new Set,this.du=new fe(U.comparator),this.Au=new Map,this.Ru=new Bc,this.Vu={},this.mu=new Map,this.fu=Or.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function FT(n,e,t=!0){const r=Ep(n);let s;const i=r.Tu.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.lu()):s=await mp(r,e,t,!0),s}async function UT(n,e){const t=Ep(n);await mp(t,e,!0,!1)}async function mp(n,e,t,r){const s=await nT(n.localStore,It(e)),i=s.targetId,a=n.sharedClientState.addLocalQueryTarget(i,t);let c;return r&&(c=await BT(n,e,i,a==="current",s.resumeToken)),n.isPrimaryClient&&t&&ap(n.remoteStore,s),c}async function BT(n,e,t,r,s){n.pu=(m,g,T)=>(async function(C,R,L,O){let D=R.view.ru(L);D.Cs&&(D=await _h(C.localStore,R.query,!1).then((({documents:E})=>R.view.ru(E,D))));const z=O&&O.targetChanges.get(R.targetId),J=O&&O.targetMismatches.get(R.targetId)!=null,ee=R.view.applyChanges(D,C.isPrimaryClient,z,J);return Rh(C,R.targetId,ee.au),ee.snapshot})(n,m,g,T);const i=await _h(n.localStore,e,!0),a=new OT(e,i.Qs),c=a.ru(i.documents),l=Ws.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",s),h=a.applyChanges(c,n.isPrimaryClient,l);Rh(n,t,h.au);const d=new MT(e,t,a);return n.Tu.set(e,d),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),h.snapshot}async function $T(n,e,t){const r=q(n),s=r.Tu.get(e),i=r.Iu.get(s.targetId);if(i.length>1)return r.Iu.set(s.targetId,i.filter((a=>!vo(a,e)))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await Qa(r.localStore,s.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(s.targetId),t&&zc(r.remoteStore,s.targetId),Ya(r,s.targetId)})).catch(Wr)):(Ya(r,s.targetId),await Qa(r.localStore,s.targetId,!0))}async function jT(n,e){const t=q(n),r=t.Tu.get(e),s=t.Iu.get(r.targetId);t.isPrimaryClient&&s.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),zc(t.remoteStore,r.targetId))}async function qT(n,e,t){const r=XT(n);try{const s=await(function(a,c){const l=q(a),h=ue.now(),d=c.reduce(((T,S)=>T.add(S.key)),Q());let m,g;return l.persistence.runTransaction("Locally write mutations","readwrite",(T=>{let S=jt(),C=Q();return l.Ns.getEntries(T,d).next((R=>{S=R,S.forEach(((L,O)=>{O.isValidDocument()||(C=C.add(L))}))})).next((()=>l.localDocuments.getOverlayedDocuments(T,S))).next((R=>{m=R;const L=[];for(const O of c){const D=tE(O,m.get(O.key).overlayedDocument);D!=null&&L.push(new Sn(O.key,D,Sd(D.value.mapValue),ht.exists(!0)))}return l.mutationQueue.addMutationBatch(T,h,L,c)})).next((R=>{g=R;const L=R.applyToLocalDocumentSet(m,C);return l.documentOverlayCache.saveOverlays(T,R.batchId,L)}))})).then((()=>({batchId:g.batchId,changes:Ld(m)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),(function(a,c,l){let h=a.Vu[a.currentUser.toKey()];h||(h=new fe(K)),h=h.insert(c,l),a.Vu[a.currentUser.toKey()]=h})(r,s.batchId,t),await Ks(r,s.changes),await So(r.remoteStore)}catch(s){const i=Qc(s,"Failed to persist write");t.reject(i)}}async function gp(n,e){const t=q(n);try{const r=await ZE(t.localStore,e);e.targetChanges.forEach(((s,i)=>{const a=t.Au.get(i);a&&(te(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?a.hu=!0:s.modifiedDocuments.size>0?te(a.hu,14607):s.removedDocuments.size>0&&(te(a.hu,42227),a.hu=!1))})),await Ks(t,r,e)}catch(r){await Wr(r)}}function Sh(n,e,t){const r=q(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const s=[];r.Tu.forEach(((i,a)=>{const c=a.view.va(e);c.snapshot&&s.push(c.snapshot)})),(function(a,c){const l=q(a);l.onlineState=c;let h=!1;l.queries.forEach(((d,m)=>{for(const g of m.Sa)g.va(c)&&(h=!0)})),h&&Xc(l)})(r.eventManager,e),s.length&&r.Pu.H_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function zT(n,e,t){const r=q(n);r.sharedClientState.updateQueryState(e,"rejected",t);const s=r.Au.get(e),i=s&&s.key;if(i){let a=new fe(U.comparator);a=a.insert(i,Le.newNoDocument(i,j.min()));const c=Q().add(i),l=new Io(j.min(),new Map,new fe(K),a,c);await gp(r,l),r.du=r.du.remove(i),r.Au.delete(e),Yc(r)}else await Qa(r.localStore,e,!1).then((()=>Ya(r,e,t))).catch(Wr)}async function HT(n,e){const t=q(n),r=e.batch.batchId;try{const s=await YE(t.localStore,e);yp(t,r,null),_p(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await Ks(t,s)}catch(s){await Wr(s)}}async function WT(n,e,t){const r=q(n);try{const s=await(function(a,c){const l=q(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",(h=>{let d;return l.mutationQueue.lookupMutationBatch(h,c).next((m=>(te(m!==null,37113),d=m.keys(),l.mutationQueue.removeMutationBatch(h,m)))).next((()=>l.mutationQueue.performConsistencyCheck(h))).next((()=>l.documentOverlayCache.removeOverlaysForBatchId(h,d,c))).next((()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,d))).next((()=>l.localDocuments.getDocuments(h,d)))}))})(r.localStore,e);yp(r,e,t),_p(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await Ks(r,s)}catch(s){await Wr(s)}}function _p(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function yp(n,e,t){const r=q(n);let s=r.Vu[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(t?i.reject(t):i.resolve(),s=s.remove(e)),r.Vu[r.currentUser.toKey()]=s}}function Ya(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Iu.get(e))n.Tu.delete(r),t&&n.Pu.yu(r,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((r=>{n.Ru.containsKey(r)||vp(n,r)}))}function vp(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(zc(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),Yc(n))}function Rh(n,e,t){for(const r of t)r instanceof dp?(n.Ru.addReference(r.key,e),GT(n,r)):r instanceof pp?(M(Jc,"Document no longer in limbo: "+r.key),n.Ru.removeReference(r.key,e),n.Ru.containsKey(r.key)||vp(n,r.key)):B(19791,{wu:r})}function GT(n,e){const t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Eu.has(r)||(M(Jc,"New document in limbo: "+t),n.Eu.add(r),Yc(n))}function Yc(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new U(ce.fromString(e)),r=n.fu.next();n.Au.set(r,new LT(t)),n.du=n.du.insert(t,r),ap(n.remoteStore,new on(It(Oc(t.path)),r,"TargetPurposeLimboResolution",mo.ce))}}async function Ks(n,e,t){const r=q(n),s=[],i=[],a=[];r.Tu.isEmpty()||(r.Tu.forEach(((c,l)=>{a.push(r.pu(l,e,t).then((h=>{if((h||t)&&r.isPrimaryClient){const d=h?!h.fromCache:t?.targetChanges.get(l.targetId)?.current;r.sharedClientState.updateQueryState(l.targetId,d?"current":"not-current")}if(h){s.push(h);const d=jc.As(l.targetId,h);i.push(d)}})))})),await Promise.all(a),r.Pu.H_(s),await(async function(l,h){const d=q(l);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",(m=>k.forEach(h,(g=>k.forEach(g.Es,(T=>d.persistence.referenceDelegate.addReference(m,g.targetId,T))).next((()=>k.forEach(g.ds,(T=>d.persistence.referenceDelegate.removeReference(m,g.targetId,T)))))))))}catch(m){if(!Gr(m))throw m;M(qc,"Failed to update sequence numbers: "+m)}for(const m of h){const g=m.targetId;if(!m.fromCache){const T=d.Ms.get(g),S=T.snapshotVersion,C=T.withLastLimboFreeSnapshotVersion(S);d.Ms=d.Ms.insert(g,C)}}})(r.localStore,i))}async function KT(n,e){const t=q(n);if(!t.currentUser.isEqual(e)){M(Jc,"User change. New user:",e.toKey());const r=await rp(t.localStore,e);t.currentUser=e,(function(i,a){i.mu.forEach((c=>{c.forEach((l=>{l.reject(new F(N.CANCELLED,a))}))})),i.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Ks(t,r.Ls)}}function QT(n,e){const t=q(n),r=t.Au.get(e);if(r&&r.hu)return Q().add(r.key);{let s=Q();const i=t.Iu.get(e);if(!i)return s;for(const a of i){const c=t.Tu.get(a);s=s.unionWith(c.view.nu)}return s}}function Ep(n){const e=q(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=gp.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=QT.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=zT.bind(null,e),e.Pu.H_=NT.bind(null,e.eventManager),e.Pu.yu=DT.bind(null,e.eventManager),e}function XT(n){const e=q(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=HT.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=WT.bind(null,e),e}class Hi{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Ao(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return JE(this.persistence,new KE,e.initialUser,this.serializer)}Cu(e){return new np($c.mi,this.serializer)}Du(e){return new sT}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Hi.provider={build:()=>new Hi};class JT extends Hi{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){te(this.persistence.referenceDelegate instanceof qi,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new VE(r,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?ze.withCacheSize(this.cacheSizeBytes):ze.DEFAULT;return new np((r=>qi.mi(r,t)),this.serializer)}}class Za{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Sh(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=KT.bind(null,this.syncEngine),await ST(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new PT})()}createDatastore(e){const t=Ao(e.databaseInfo.databaseId),r=(function(i){return new uT(i)})(e.databaseInfo);return(function(i,a,c,l){return new dT(i,a,c,l)})(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return(function(r,s,i,a,c){return new mT(r,s,i,a,c)})(this.localStore,this.datastore,e.asyncQueue,(t=>Sh(this.syncEngine,t,0)),(function(){return Eh.v()?new Eh:new iT})())}createSyncEngine(e,t){return(function(s,i,a,c,l,h,d){const m=new xT(s,i,a,c,l,h);return d&&(m.gu=!0),m})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const r=q(t);M(Xn,"RemoteStore shutting down."),r.Ea.add(5),await Gs(r),r.Aa.shutdown(),r.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Za.provider={build:()=>new Za};class YT{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):$t("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const wn="FirestoreClient";class ZT{constructor(e,t,r,s,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=s,this.user=Me.UNAUTHENTICATED,this.clientId=Rc.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,(async a=>{M(wn,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a})),this.appCheckCredentials.start(r,(a=>(M(wn,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new $n;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=Qc(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function va(n,e){n.asyncQueue.verifyOperationInProgress(),M(wn,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener((async s=>{r.isEqual(s)||(await rp(e.localStore,s),r=s)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function Ph(n,e){n.asyncQueue.verifyOperationInProgress();const t=await ew(n);M(wn,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((r=>wh(e.remoteStore,r))),n.setAppCheckTokenChangeListener(((r,s)=>wh(e.remoteStore,s))),n._onlineComponents=e}async function ew(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){M(wn,"Using user provided OfflineComponentProvider");try{await va(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(s){return s.name==="FirebaseError"?s.code===N.FAILED_PRECONDITION||s.code===N.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11})(t))throw t;kr("Error using user provided cache. Falling back to memory cache: "+t),await va(n,new Hi)}}else M(wn,"Using default OfflineComponentProvider"),await va(n,new JT(void 0));return n._offlineComponents}async function Tp(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(M(wn,"Using user provided OnlineComponentProvider"),await Ph(n,n._uninitializedComponentsProvider._online)):(M(wn,"Using default OnlineComponentProvider"),await Ph(n,new Za))),n._onlineComponents}function tw(n){return Tp(n).then((e=>e.syncEngine))}async function Ch(n){const e=await Tp(n),t=e.eventManager;return t.onListen=FT.bind(null,e.syncEngine),t.onUnlisten=$T.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=UT.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=jT.bind(null,e.syncEngine),t}function wp(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const kh=new Map;const Ip="firestore.googleapis.com",Nh=!0;class Dh{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new F(N.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Ip,this.ssl=Nh}else this.host=e.host,this.ssl=e.ssl??Nh;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=tp;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<NE)throw new F(N.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}pv("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=wp(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new F(N.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new F(N.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new F(N.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,s){return r.timeoutSeconds===s.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Ro{constructor(e,t,r,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Dh({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new F(N.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new F(N.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Dh(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new sv;switch(r.type){case"firstParty":return new cv(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new F(N.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const r=kh.get(t);r&&(M("ComponentProvider","Removing Datastore"),kh.delete(t),r.terminate())})(this),Promise.resolve()}}function nw(n,e,t,r={}){n=dn(n,Ro);const s=An(e),i=n._getSettings(),a={...i,emulatorOptions:n._getEmulatorOptions()},c=`${e}:${t}`;s&&(Tc(`https://${c}`),wc("Firestore",!0)),i.host!==Ip&&i.host!==c&&kr("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...i,host:c,ssl:s,emulatorOptions:r};if(!Gn(l,a)&&(n._setSettings(l),r.mockUserToken)){let h,d;if(typeof r.mockUserToken=="string")h=r.mockUserToken,d=Me.MOCK_USER;else{h=C_(r.mockUserToken,n._app?.options.projectId);const m=r.mockUserToken.sub||r.mockUserToken.user_id;if(!m)throw new F(N.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new Me(m)}n._authCredentials=new iv(new pd(h,d))}}class Po{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Po(this.firestore,e,this._query)}}class we{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new pn(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new we(this.firestore,e,this._key)}toJSON(){return{type:we._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(zs(t,we._jsonSchema))return new we(e,r||null,new U(ce.fromString(t.referencePath)))}}we._jsonSchemaVersion="firestore/documentReference/1.0",we._jsonSchema={type:ge("string",we._jsonSchemaVersion),referencePath:ge("string")};class pn extends Po{constructor(e,t,r){super(e,t,Oc(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new we(this.firestore,null,new U(e))}withConverter(e){return new pn(this.firestore,e,this._path)}}function Ap(n,e,...t){if(n=ye(n),md("collection","path",e),n instanceof Ro){const r=ce.fromString(e,...t);return Hl(r),new pn(n,null,r)}{if(!(n instanceof we||n instanceof pn))throw new F(N.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(ce.fromString(e,...t));return Hl(r),new pn(n.firestore,null,r)}}function Zc(n,e,...t){if(n=ye(n),arguments.length===1&&(e=Rc.newId()),md("doc","path",e),n instanceof Ro){const r=ce.fromString(e,...t);return zl(r),new we(n,null,new U(r))}{if(!(n instanceof we||n instanceof pn))throw new F(N.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(ce.fromString(e,...t));return zl(r),new we(n.firestore,n instanceof pn?n.converter:null,new U(r))}}const Vh="AsyncQueue";class Oh{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new ip(this,"async_queue_retry"),this._c=()=>{const r=ya();r&&M(Vh,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const t=ya();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=ya();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new $n;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Gr(e))throw e;M(Vh,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((r=>{throw this.nc=r,this.rc=!1,$t("INTERNAL UNHANDLED ERROR: ",Mh(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const s=Kc.createAndSchedule(this,e,t,r,(i=>this.hc(i)));return this.tc.push(s),s}uc(){this.nc&&B(47125,{Pc:Mh(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,r)=>t.targetTimeMs-r.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function Mh(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}function Lh(n){return(function(t,r){if(typeof t!="object"||t===null)return!1;const s=t;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1})(n,["next","error","complete"])}class Lr extends Ro{constructor(e,t,r,s){super(e,t,r,s),this.type="firestore",this._queue=new Oh,this._persistenceKey=s?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Oh(e),this._firestoreClient=void 0,await e}}}function rw(n,e){const t=typeof n=="object"?n:bc(),r=typeof n=="string"?n:Li,s=po(t,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=Zf("firestore");i&&nw(s,...i)}return s}function bp(n){if(n._terminated)throw new F(N.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||sw(n),n._firestoreClient}function sw(n){const e=n._freezeSettings(),t=(function(s,i,a,c){return new bv(s,i,a,c.host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,wp(c.experimentalLongPollingOptions),c.useFetchStreams,c.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new ZT(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(s){const i=s?._online.build();return{_offline:s?._offline.build(i),_online:i}})(n._componentsProvider))}class ot{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ot(ke.fromBase64String(e))}catch(t){throw new F(N.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new ot(ke.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:ot._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(zs(e,ot._jsonSchema))return ot.fromBase64String(e.bytes)}}ot._jsonSchemaVersion="firestore/bytes/1.0",ot._jsonSchema={type:ge("string",ot._jsonSchemaVersion),bytes:ge("string")};class Co{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new F(N.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Re(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class eu{constructor(e){this._methodName=e}}class bt{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new F(N.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new F(N.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return K(this._lat,e._lat)||K(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:bt._jsonSchemaVersion}}static fromJSON(e){if(zs(e,bt._jsonSchema))return new bt(e.latitude,e.longitude)}}bt._jsonSchemaVersion="firestore/geoPoint/1.0",bt._jsonSchema={type:ge("string",bt._jsonSchemaVersion),latitude:ge("number"),longitude:ge("number")};class St{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0})(this._values,e._values)}toJSON(){return{type:St._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(zs(e,St._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new St(e.vectorValues);throw new F(N.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}St._jsonSchemaVersion="firestore/vectorValue/1.0",St._jsonSchema={type:ge("string",St._jsonSchemaVersion),vectorValues:ge("object")};const iw=/^__.*__$/;class ow{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Sn(e,this.data,this.fieldMask,t,this.fieldTransforms):new Hs(e,this.data,t,this.fieldTransforms)}}class Sp{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Sn(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Rp(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw B(40011,{Ac:n})}}class tu{constructor(e,t,r,s,i,a){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new tu({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.gc(e),r}yc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Wi(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(Rp(this.Ac)&&iw.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class aw{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Ao(e)}Cc(e,t,r,s=!1){return new tu({Ac:e,methodName:t,Dc:r,path:Re.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Pp(n){const e=n._freezeSettings(),t=Ao(n._databaseId);return new aw(n._databaseId,!!e.ignoreUndefinedProperties,t)}function cw(n,e,t,r,s,i={}){const a=n.Cc(i.merge||i.mergeFields?2:0,e,t,s);nu("Data must be an object, but it was:",a,r);const c=Cp(r,a);let l,h;if(i.merge)l=new Ze(a.fieldMask),h=a.fieldTransforms;else if(i.mergeFields){const d=[];for(const m of i.mergeFields){const g=ec(e,m,t);if(!a.contains(g))throw new F(N.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);Np(d,g)||d.push(g)}l=new Ze(d),h=a.fieldTransforms.filter((m=>l.covers(m.field)))}else l=null,h=a.fieldTransforms;return new ow(new He(c),l,h)}class ko extends eu{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof ko}}function uw(n,e,t,r){const s=n.Cc(1,e,t);nu("Data must be an object, but it was:",s,r);const i=[],a=He.empty();bn(r,((l,h)=>{const d=ru(e,l,t);h=ye(h);const m=s.yc(d);if(h instanceof ko)i.push(d);else{const g=No(h,m);g!=null&&(i.push(d),a.set(d,g))}}));const c=new Ze(i);return new Sp(a,c,s.fieldTransforms)}function lw(n,e,t,r,s,i){const a=n.Cc(1,e,t),c=[ec(e,r,t)],l=[s];if(i.length%2!=0)throw new F(N.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<i.length;g+=2)c.push(ec(e,i[g])),l.push(i[g+1]);const h=[],d=He.empty();for(let g=c.length-1;g>=0;--g)if(!Np(h,c[g])){const T=c[g];let S=l[g];S=ye(S);const C=a.yc(T);if(S instanceof ko)h.push(T);else{const R=No(S,C);R!=null&&(h.push(T),d.set(T,R))}}const m=new Ze(h);return new Sp(d,m,a.fieldTransforms)}function No(n,e){if(kp(n=ye(n)))return nu("Unsupported field value:",e,n),Cp(n,e);if(n instanceof eu)return(function(r,s){if(!Rp(s.Ac))throw s.Sc(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(r,s){const i=[];let a=0;for(const c of r){let l=No(c,s.wc(a));l==null&&(l={nullValue:"NULL_VALUE"}),i.push(l),a++}return{arrayValue:{values:i}}})(n,e)}return(function(r,s){if((r=ye(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return Qv(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=ue.fromDate(r);return{timestampValue:ji(s.serializer,i)}}if(r instanceof ue){const i=new ue(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:ji(s.serializer,i)}}if(r instanceof bt)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof ot)return{bytesValue:Kd(s.serializer,r._byteString)};if(r instanceof we){const i=s.databaseId,a=r.firestore._databaseId;if(!a.isEqual(i))throw s.Sc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Uc(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof St)return(function(a,c){return{mapValue:{fields:{[Ad]:{stringValue:bd},[xi]:{arrayValue:{values:a.toArray().map((h=>{if(typeof h!="number")throw c.Sc("VectorValues must only contain numeric values.");return Mc(c.serializer,h)}))}}}}}})(r,s);throw s.Sc(`Unsupported field value: ${Pc(r)}`)})(n,e)}function Cp(n,e){const t={};return yd(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):bn(n,((r,s)=>{const i=No(s,e.mc(r));i!=null&&(t[r]=i)})),{mapValue:{fields:t}}}function kp(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof ue||n instanceof bt||n instanceof ot||n instanceof we||n instanceof eu||n instanceof St)}function nu(n,e,t){if(!kp(t)||!gd(t)){const r=Pc(t);throw r==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+r)}}function ec(n,e,t){if((e=ye(e))instanceof Co)return e._internalPath;if(typeof e=="string")return ru(n,e);throw Wi("Field path arguments must be of type string or ",n,!1,void 0,t)}const hw=new RegExp("[~\\*/\\[\\]]");function ru(n,e,t){if(e.search(hw)>=0)throw Wi(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Co(...e.split("."))._internalPath}catch{throw Wi(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Wi(n,e,t,r,s){const i=r&&!r.isEmpty(),a=s!==void 0;let c=`Function ${e}() called with invalid data`;t&&(c+=" (via `toFirestore()`)"),c+=". ";let l="";return(i||a)&&(l+=" (found",i&&(l+=` in field ${r}`),a&&(l+=` in document ${s}`),l+=")"),new F(N.INVALID_ARGUMENT,c+n+l)}function Np(n,e){return n.some((t=>t.isEqual(e)))}class Dp{constructor(e,t,r,s,i){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new we(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new fw(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Vp("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class fw extends Dp{data(){return super.data()}}function Vp(n,e){return typeof e=="string"?ru(n,e):e instanceof Co?e._internalPath:e._delegate._internalPath}function dw(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new F(N.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class pw{convertValue(e,t="none"){switch(En(e)){case 0:return null;case 1:return e.booleanValue;case 2:return pe(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(vn(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw B(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return bn(e,((s,i)=>{r[s]=this.convertValue(i,t)})),r}convertVectorValue(e){const t=e.fields?.[xi].arrayValue?.values?.map((r=>pe(r.doubleValue)));return new St(t)}convertGeoPoint(e){return new bt(pe(e.latitude),pe(e.longitude))}convertArray(e,t){return(e.values||[]).map((r=>this.convertValue(r,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const r=_o(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Ns(e));default:return null}}convertTimestamp(e){const t=yn(e);return new ue(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=ce.fromString(e);te(ep(r),9688,{name:e});const s=new Ds(r.get(1),r.get(3)),i=new U(r.popFirst(5));return s.isEqual(t)||$t(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}function mw(n,e,t){let r;return r=n?n.toFirestore(e):e,r}class gs{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class jn extends Dp{constructor(e,t,r,s,i,a){super(e,t,r,s,a),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new bi(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(Vp("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new F(N.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=jn._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}jn._jsonSchemaVersion="firestore/documentSnapshot/1.0",jn._jsonSchema={type:ge("string",jn._jsonSchemaVersion),bundleSource:ge("string","DocumentSnapshot"),bundleName:ge("string"),bundle:ge("string")};class bi extends jn{data(e={}){return super.data(e)}}class wr{constructor(e,t,r,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new gs(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((r=>{e.call(t,new bi(this._firestore,this._userDataWriter,r.key,r,new gs(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new F(N.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(s,i){if(s._snapshot.oldDocs.isEmpty()){let a=0;return s._snapshot.docChanges.map((c=>{const l=new bi(s._firestore,s._userDataWriter,c.doc.key,c.doc,new gs(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);return c.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}}))}{let a=s._snapshot.oldDocs;return s._snapshot.docChanges.filter((c=>i||c.type!==3)).map((c=>{const l=new bi(s._firestore,s._userDataWriter,c.doc.key,c.doc,new gs(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);let h=-1,d=-1;return c.type!==0&&(h=a.indexOf(c.doc.key),a=a.delete(c.doc.key)),c.type!==1&&(a=a.add(c.doc),d=a.indexOf(c.doc.key)),{type:gw(c.type),doc:l,oldIndex:h,newIndex:d}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new F(N.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=wr._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Rc.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],s=[];return this.docs.forEach((i=>{i._document!==null&&(t.push(i._document),r.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),s.push(i.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function gw(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return B(61501,{type:n})}}wr._jsonSchemaVersion="firestore/querySnapshot/1.0",wr._jsonSchema={type:ge("string",wr._jsonSchemaVersion),bundleSource:ge("string","QuerySnapshot"),bundleName:ge("string"),bundle:ge("string")};class Op extends pw{constructor(e){super(),this.firestore=e}convertBytes(e){return new ot(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new we(this.firestore,null,t)}}function _w(n,e,t,...r){n=dn(n,we);const s=dn(n.firestore,Lr),i=Pp(s);let a;return a=typeof(e=ye(e))=="string"||e instanceof Co?lw(i,"updateDoc",n._key,e,t,r):uw(i,"updateDoc",n._key,e),su(s,[a.toMutation(n._key,ht.exists(!0))])}function yw(n){return su(dn(n.firestore,Lr),[new Lc(n._key,ht.none())])}function vw(n,e){const t=dn(n.firestore,Lr),r=Zc(n),s=mw(n.converter,e);return su(t,[cw(Pp(n.firestore),"addDoc",r._key,s,n.converter!==null,{}).toMutation(r._key,ht.exists(!1))]).then((()=>r))}function Ew(n,...e){n=ye(n);let t={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||Lh(e[r])||(t=e[r++]);const s={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(Lh(e[r])){const l=e[r];e[r]=l.next?.bind(l),e[r+1]=l.error?.bind(l),e[r+2]=l.complete?.bind(l)}let i,a,c;if(n instanceof we)a=dn(n.firestore,Lr),c=Oc(n._key.path),i={next:l=>{e[r]&&e[r](Tw(a,n,l))},error:e[r+1],complete:e[r+2]};else{const l=dn(n,Po);a=dn(l.firestore,Lr),c=l._query;const h=new Op(a);i={next:d=>{e[r]&&e[r](new wr(a,h,l,d))},error:e[r+1],complete:e[r+2]},dw(n._query)}return(function(h,d,m,g){const T=new YT(g),S=new VT(d,T,m);return h.asyncQueue.enqueueAndForget((async()=>CT(await Ch(h),S))),()=>{T.Nu(),h.asyncQueue.enqueueAndForget((async()=>kT(await Ch(h),S)))}})(bp(a),c,s,i)}function su(n,e){return(function(r,s){const i=new $n;return r.asyncQueue.enqueueAndForget((async()=>qT(await tw(r),s,i))),i.promise})(bp(n),e)}function Tw(n,e,t){const r=t.docs.get(e._key),s=new Op(n);return new jn(n,s,e._key,r,new gs(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(s){Hr=s})(zr),Kn(new gn("firestore",((r,{instanceIdentifier:s,options:i})=>{const a=r.getProvider("app").getImmediate(),c=new Lr(new ov(r.getProvider("auth-internal")),new uv(a,r.getProvider("app-check-internal")),(function(h,d){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new F(N.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ds(h.options.projectId,d)})(a,s),a);return i={useFetchStreams:t,...i},c._setSettings(i),c}),"PUBLIC").setMultipleInstances(!0)),wt(Bl,$l,e),wt(Bl,$l,"esm2020")})();function Mp(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const ww=Mp,Lp=new js("auth","Firebase",Mp());const Gi=new Ic("@firebase/auth");function Iw(n,...e){Gi.logLevel<=G.WARN&&Gi.warn(`Auth (${zr}): ${n}`,...e)}function Si(n,...e){Gi.logLevel<=G.ERROR&&Gi.error(`Auth (${zr}): ${n}`,...e)}function Nt(n,...e){throw ou(n,...e)}function ft(n,...e){return ou(n,...e)}function iu(n,e,t){const r={...ww(),[e]:t};return new js("auth","Firebase",r).create(e,{appName:n.name})}function qn(n){return iu(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Aw(n,e,t){const r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&Nt(n,"argument-error"),iu(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function ou(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return Lp.create(n,...e)}function $(n,e,...t){if(!n)throw ou(e,...t)}function Lt(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Si(e),new Error(e)}function qt(n,e){n||Lt(e)}function tc(){return typeof self<"u"&&self.location?.href||""}function bw(){return xh()==="http:"||xh()==="https:"}function xh(){return typeof self<"u"&&self.location?.protocol||null}function Sw(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(bw()||M_()||"connection"in navigator)?navigator.onLine:!0}function Rw(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class Qs{constructor(e,t){this.shortDelay=e,this.longDelay=t,qt(t>e,"Short delay should be less than long delay!"),this.isMobile=D_()||L_()}get(){return Sw()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function au(n,e){qt(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class xp{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Lt("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Lt("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Lt("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Pw={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const Cw=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],kw=new Qs(3e4,6e4);function cu(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Qr(n,e,t,r,s={}){return Fp(n,s,async()=>{let i={},a={};r&&(e==="GET"?a=r:i={body:JSON.stringify(r)});const c=qs({key:n.config.apiKey,...a}).slice(1),l=await n._getAdditionalHeaders();l["Content-Type"]="application/json",n.languageCode&&(l["X-Firebase-Locale"]=n.languageCode);const h={method:e,headers:l,...i};return O_()||(h.referrerPolicy="no-referrer"),n.emulatorConfig&&An(n.emulatorConfig.host)&&(h.credentials="include"),xp.fetch()(await Up(n,n.config.apiHost,t,c),h)})}async function Fp(n,e,t){n._canInitEmulator=!1;const r={...Pw,...e};try{const s=new Dw(n),i=await Promise.race([t(),s.promise]);s.clearNetworkTimeout();const a=await i.json();if("needConfirmation"in a)throw yi(n,"account-exists-with-different-credential",a);if(i.ok&&!("errorMessage"in a))return a;{const c=i.ok?a.errorMessage:a.error.message,[l,h]=c.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw yi(n,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw yi(n,"email-already-in-use",a);if(l==="USER_DISABLED")throw yi(n,"user-disabled",a);const d=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw iu(n,d,h);Nt(n,d)}}catch(s){if(s instanceof Vt)throw s;Nt(n,"network-request-failed",{message:String(s)})}}async function Nw(n,e,t,r,s={}){const i=await Qr(n,e,t,r,s);return"mfaPendingCredential"in i&&Nt(n,"multi-factor-auth-required",{_serverResponse:i}),i}async function Up(n,e,t,r){const s=`${e}${t}?${r}`,i=n,a=i.config.emulator?au(n.config,s):`${n.config.apiScheme}://${s}`;return Cw.includes(t)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(a).toString():a}class Dw{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(ft(this.auth,"network-request-failed")),kw.get())})}}function yi(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const s=ft(n,e,r);return s.customData._tokenResponse=t,s}async function Vw(n,e){return Qr(n,"POST","/v1/accounts:delete",e)}async function Ki(n,e){return Qr(n,"POST","/v1/accounts:lookup",e)}function As(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Ow(n,e=!1){const t=ye(n),r=await t.getIdToken(e),s=uu(r);$(s&&s.exp&&s.auth_time&&s.iat,t.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,a=i?.sign_in_provider;return{claims:s,token:r,authTime:As(Ea(s.auth_time)),issuedAtTime:As(Ea(s.iat)),expirationTime:As(Ea(s.exp)),signInProvider:a||null,signInSecondFactor:i?.sign_in_second_factor||null}}function Ea(n){return Number(n)*1e3}function uu(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Si("JWT malformed, contained fewer than 3 sections"),null;try{const s=Jf(t);return s?JSON.parse(s):(Si("Failed to decode base64 JWT payload"),null)}catch(s){return Si("Caught error parsing JWT payload as JSON",s?.toString()),null}}function Fh(n){const e=uu(n);return $(e,"internal-error"),$(typeof e.exp<"u","internal-error"),$(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Ls(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof Vt&&Mw(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function Mw({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class Lw{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class nc{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=As(this.lastLoginAt),this.creationTime=As(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Qi(n){const e=n.auth,t=await n.getIdToken(),r=await Ls(n,Ki(e,{idToken:t}));$(r?.users.length,e,"internal-error");const s=r.users[0];n._notifyReloadListener(s);const i=s.providerUserInfo?.length?Bp(s.providerUserInfo):[],a=Fw(n.providerData,i),c=n.isAnonymous,l=!(n.email&&s.passwordHash)&&!a?.length,h=c?l:!1,d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new nc(s.createdAt,s.lastLoginAt),isAnonymous:h};Object.assign(n,d)}async function xw(n){const e=ye(n);await Qi(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Fw(n,e){return[...n.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function Bp(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function Uw(n,e){const t=await Fp(n,{},async()=>{const r=qs({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=n.config,a=await Up(n,s,"/v1/token",`key=${i}`),c=await n._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:c,body:r};return n.emulatorConfig&&An(n.emulatorConfig.host)&&(l.credentials="include"),xp.fetch()(a,l)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function Bw(n,e){return Qr(n,"POST","/v2/accounts:revokeToken",cu(n,e))}class Ir{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){$(e.idToken,"internal-error"),$(typeof e.idToken<"u","internal-error"),$(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Fh(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){$(e.length!==0,"internal-error");const t=Fh(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:($(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:s,expiresIn:i}=await Uw(e,t);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:s,expirationTime:i}=t,a=new Ir;return r&&($(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),s&&($(typeof s=="string","internal-error",{appName:e}),a.accessToken=s),i&&($(typeof i=="number","internal-error",{appName:e}),a.expirationTime=i),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Ir,this.toJSON())}_performRefresh(){return Lt("not implemented")}}function tn(n,e){$(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class ut{constructor({uid:e,auth:t,stsTokenManager:r,...s}){this.providerId="firebase",this.proactiveRefresh=new Lw(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new nc(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await Ls(this,this.stsTokenManager.getToken(this.auth,e));return $(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return Ow(this,e)}reload(){return xw(this)}_assign(e){this!==e&&($(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new ut({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){$(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await Qi(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(it(this.auth.app))return Promise.reject(qn(this.auth));const e=await this.getIdToken();return await Ls(this,Vw(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const r=t.displayName??void 0,s=t.email??void 0,i=t.phoneNumber??void 0,a=t.photoURL??void 0,c=t.tenantId??void 0,l=t._redirectEventId??void 0,h=t.createdAt??void 0,d=t.lastLoginAt??void 0,{uid:m,emailVerified:g,isAnonymous:T,providerData:S,stsTokenManager:C}=t;$(m&&C,e,"internal-error");const R=Ir.fromJSON(this.name,C);$(typeof m=="string",e,"internal-error"),tn(r,e.name),tn(s,e.name),$(typeof g=="boolean",e,"internal-error"),$(typeof T=="boolean",e,"internal-error"),tn(i,e.name),tn(a,e.name),tn(c,e.name),tn(l,e.name),tn(h,e.name),tn(d,e.name);const L=new ut({uid:m,auth:e,email:s,emailVerified:g,displayName:r,isAnonymous:T,photoURL:a,phoneNumber:i,tenantId:c,stsTokenManager:R,createdAt:h,lastLoginAt:d});return S&&Array.isArray(S)&&(L.providerData=S.map(O=>({...O}))),l&&(L._redirectEventId=l),L}static async _fromIdTokenResponse(e,t,r=!1){const s=new Ir;s.updateFromServerResponse(t);const i=new ut({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await Qi(i),i}static async _fromGetAccountInfoResponse(e,t,r){const s=t.users[0];$(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?Bp(s.providerUserInfo):[],a=!(s.email&&s.passwordHash)&&!i?.length,c=new Ir;c.updateFromIdToken(r);const l=new ut({uid:s.localId,auth:e,stsTokenManager:c,isAnonymous:a}),h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new nc(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!i?.length};return Object.assign(l,h),l}}const Uh=new Map;function xt(n){qt(n instanceof Function,"Expected a class definition");let e=Uh.get(n);return e?(qt(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Uh.set(n,e),e)}class $p{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}$p.type="NONE";const Bh=$p;function Ri(n,e,t){return`firebase:${n}:${e}:${t}`}class Ar{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=Ri(this.userKey,s.apiKey,i),this.fullPersistenceKey=Ri("persistence",s.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Ki(this.auth,{idToken:e}).catch(()=>{});return t?ut._fromGetAccountInfoResponse(this.auth,t,e):null}return ut._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new Ar(xt(Bh),e,r);const s=(await Promise.all(t.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let i=s[0]||xt(Bh);const a=Ri(r,e.config.apiKey,e.name);let c=null;for(const h of t)try{const d=await h._get(a);if(d){let m;if(typeof d=="string"){const g=await Ki(e,{idToken:d}).catch(()=>{});if(!g)break;m=await ut._fromGetAccountInfoResponse(e,g,d)}else m=ut._fromJSON(e,d);h!==i&&(c=m),i=h;break}}catch{}const l=s.filter(h=>h._shouldAllowMigration);return!i._shouldAllowMigration||!l.length?new Ar(i,e,r):(i=l[0],c&&await i._set(a,c.toJSON()),await Promise.all(t.map(async h=>{if(h!==i)try{await h._remove(a)}catch{}})),new Ar(i,e,r))}}function $h(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Hp(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(jp(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Gp(e))return"Blackberry";if(Kp(e))return"Webos";if(qp(e))return"Safari";if((e.includes("chrome/")||zp(e))&&!e.includes("edge/"))return"Chrome";if(Wp(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function jp(n=Fe()){return/firefox\//i.test(n)}function qp(n=Fe()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function zp(n=Fe()){return/crios\//i.test(n)}function Hp(n=Fe()){return/iemobile/i.test(n)}function Wp(n=Fe()){return/android/i.test(n)}function Gp(n=Fe()){return/blackberry/i.test(n)}function Kp(n=Fe()){return/webos/i.test(n)}function lu(n=Fe()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function $w(n=Fe()){return lu(n)&&!!window.navigator?.standalone}function jw(){return x_()&&document.documentMode===10}function Qp(n=Fe()){return lu(n)||Wp(n)||Kp(n)||Gp(n)||/windows phone/i.test(n)||Hp(n)}function Xp(n,e=[]){let t;switch(n){case"Browser":t=$h(Fe());break;case"Worker":t=`${$h(Fe())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${zr}/${r}`}class qw{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=i=>new Promise((a,c)=>{try{const l=e(i);a(l)}catch(l){c(l)}});r.onAbort=t,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const s of t)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}}async function zw(n,e={}){return Qr(n,"GET","/v2/passwordPolicy",cu(n,e))}const Hw=6;class Ww{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??Hw,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),s&&(t.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}class Gw{constructor(e,t,r,s){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new jh(this),this.idTokenSubscription=new jh(this),this.beforeStateQueue=new qw(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Lp,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=xt(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Ar.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Ki(this,{idToken:e}),r=await ut._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(it(this.app)){const i=this.app.settings.authIdToken;return i?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(i).then(a,a))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let r=t,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const i=this.redirectUser?._redirectEventId,a=r?._redirectEventId,c=await this.tryRedirectSignIn(e);(!i||i===a)&&c?.user&&(r=c.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(i){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(i))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return $(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Qi(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=Rw()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(it(this.app))return Promise.reject(qn(this));const t=e?ye(e):null;return t&&$(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&$(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return it(this.app)?Promise.reject(qn(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return it(this.app)?Promise.reject(qn(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(xt(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await zw(this),t=new Ww(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new js("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await Bw(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&xt(e)||this._popupRedirectResolver;$(t,this,"argument-error"),this.redirectPersistenceManager=await Ar.create(this,[xt(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,s){if(this._deleted)return()=>{};const i=typeof t=="function"?t:t.next.bind(t);let a=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if($(c,this,"internal-error"),c.then(()=>{a||i(this.currentUser)}),typeof t=="function"){const l=e.addObserver(t,r,s);return()=>{a=!0,l()}}else{const l=e.addObserver(t);return()=>{a=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return $(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Xp(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(it(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&Iw(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Do(n){return ye(n)}class jh{constructor(e){this.auth=e,this.observer=null,this.addObserver=H_(t=>this.observer=t)}get next(){return $(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let hu={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Kw(n){hu=n}function Qw(n){return hu.loadJS(n)}function Xw(){return hu.gapiScript}function Jw(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function Yw(n,e){const t=po(n,"auth");if(t.isInitialized()){const s=t.getImmediate(),i=t.getOptions();if(Gn(i,e??{}))return s;Nt(s,"already-initialized")}return t.initialize({options:e})}function Zw(n,e){const t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(xt);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function eI(n,e,t){const r=Do(n);$(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=Jp(e),{host:a,port:c}=tI(e),l=c===null?"":`:${c}`,h={url:`${i}//${a}${l}/`},d=Object.freeze({host:a,port:c,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){$(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),$(Gn(h,r.config.emulator)&&Gn(d,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=h,r.emulatorConfig=d,r.settings.appVerificationDisabledForTesting=!0,An(a)?(Tc(`${i}//${a}${l}`),wc("Auth",!0)):nI()}function Jp(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function tI(n){const e=Jp(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:qh(r.substr(i.length+1))}}else{const[i,a]=r.split(":");return{host:i,port:qh(a)}}}function qh(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function nI(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class Yp{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Lt("not implemented")}_getIdTokenResponse(e){return Lt("not implemented")}_linkToIdToken(e,t){return Lt("not implemented")}_getReauthenticationResolver(e){return Lt("not implemented")}}async function br(n,e){return Nw(n,"POST","/v1/accounts:signInWithIdp",cu(n,e))}const rI="http://localhost";class Jn extends Yp{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Jn(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Nt("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,...i}=t;if(!r||!s)return null;const a=new Jn(r,s);return a.idToken=i.idToken||void 0,a.accessToken=i.accessToken||void 0,a.secret=i.secret,a.nonce=i.nonce,a.pendingToken=i.pendingToken||null,a}_getIdTokenResponse(e){const t=this.buildRequest();return br(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,br(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,br(e,t)}buildRequest(){const e={requestUri:rI,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=qs(t)}return e}}class fu{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Xs extends fu{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class nn extends Xs{constructor(){super("facebook.com")}static credential(e){return Jn._fromParams({providerId:nn.PROVIDER_ID,signInMethod:nn.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return nn.credentialFromTaggedObject(e)}static credentialFromError(e){return nn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return nn.credential(e.oauthAccessToken)}catch{return null}}}nn.FACEBOOK_SIGN_IN_METHOD="facebook.com";nn.PROVIDER_ID="facebook.com";class Mt extends Xs{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Jn._fromParams({providerId:Mt.PROVIDER_ID,signInMethod:Mt.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Mt.credentialFromTaggedObject(e)}static credentialFromError(e){return Mt.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return Mt.credential(t,r)}catch{return null}}}Mt.GOOGLE_SIGN_IN_METHOD="google.com";Mt.PROVIDER_ID="google.com";class rn extends Xs{constructor(){super("github.com")}static credential(e){return Jn._fromParams({providerId:rn.PROVIDER_ID,signInMethod:rn.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return rn.credentialFromTaggedObject(e)}static credentialFromError(e){return rn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return rn.credential(e.oauthAccessToken)}catch{return null}}}rn.GITHUB_SIGN_IN_METHOD="github.com";rn.PROVIDER_ID="github.com";class sn extends Xs{constructor(){super("twitter.com")}static credential(e,t){return Jn._fromParams({providerId:sn.PROVIDER_ID,signInMethod:sn.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return sn.credentialFromTaggedObject(e)}static credentialFromError(e){return sn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return sn.credential(t,r)}catch{return null}}}sn.TWITTER_SIGN_IN_METHOD="twitter.com";sn.PROVIDER_ID="twitter.com";class xr{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,s=!1){const i=await ut._fromIdTokenResponse(e,r,s),a=zh(r);return new xr({user:i,providerId:a,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const s=zh(r);return new xr({user:e,providerId:s,_tokenResponse:r,operationType:t})}}function zh(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class Xi extends Vt{constructor(e,t,r,s){super(t.code,t.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,Xi.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,s){return new Xi(e,t,r,s)}}function Zp(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Xi._fromErrorAndOperation(n,i,e,r):i})}async function sI(n,e,t=!1){const r=await Ls(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return xr._forOperation(n,"link",r)}async function iI(n,e,t=!1){const{auth:r}=n;if(it(r.app))return Promise.reject(qn(r));const s="reauthenticate";try{const i=await Ls(n,Zp(r,s,e,n),t);$(i.idToken,r,"internal-error");const a=uu(i.idToken);$(a,r,"internal-error");const{sub:c}=a;return $(n.uid===c,r,"user-mismatch"),xr._forOperation(n,s,i)}catch(i){throw i?.code==="auth/user-not-found"&&Nt(r,"user-mismatch"),i}}async function oI(n,e,t=!1){if(it(n.app))return Promise.reject(qn(n));const r="signIn",s=await Zp(n,r,e),i=await xr._fromIdTokenResponse(n,r,s);return t||await n._updateCurrentUser(i.user),i}function aI(n,e,t,r){return ye(n).onIdTokenChanged(e,t,r)}function cI(n,e,t){return ye(n).beforeAuthStateChanged(e,t)}function uI(n,e,t,r){return ye(n).onAuthStateChanged(e,t,r)}function lI(n){return ye(n).signOut()}const Ji="__sak";class em{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Ji,"1"),this.storage.removeItem(Ji),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const hI=1e3,fI=10;class tm extends em{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Qp(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),s=this.localCache[t];r!==s&&e(t,s,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((a,c,l)=>{this.notifyListeners(a,l)});return}const r=e.key;t?this.detachListener():this.stopPolling();const s=()=>{const a=this.storage.getItem(r);!t&&this.localCache[r]===a||this.notifyListeners(r,a)},i=this.storage.getItem(r);jw()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,fI):s()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},hI)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}tm.type="LOCAL";const dI=tm;class nm extends em{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}nm.type="SESSION";const rm=nm;function pI(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class Vo{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(s=>s.isListeningto(e));if(t)return t;const r=new Vo(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:s,data:i}=t.data,a=this.handlersMap[s];if(!a?.size)return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const c=Array.from(a).map(async h=>h(t.origin,i)),l=await pI(c);t.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:l})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Vo.receivers=[];function du(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}class mI{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,a;return new Promise((c,l)=>{const h=du("",20);s.port1.start();const d=setTimeout(()=>{l(new Error("unsupported_event"))},r);a={messageChannel:s,onMessage(m){const g=m;if(g.data.eventId===h)switch(g.data.status){case"ack":clearTimeout(d),i=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),c(g.data.response);break;default:clearTimeout(d),clearTimeout(i),l(new Error("invalid_response"));break}}},this.handlers.add(a),s.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:h,data:t},[s.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}function Rt(){return window}function gI(n){Rt().location.href=n}function sm(){return typeof Rt().WorkerGlobalScope<"u"&&typeof Rt().importScripts=="function"}async function _I(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function yI(){return navigator?.serviceWorker?.controller||null}function vI(){return sm()?self:null}const im="firebaseLocalStorageDb",EI=1,Yi="firebaseLocalStorage",om="fbase_key";class Js{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Oo(n,e){return n.transaction([Yi],e?"readwrite":"readonly").objectStore(Yi)}function TI(){const n=indexedDB.deleteDatabase(im);return new Js(n).toPromise()}function rc(){const n=indexedDB.open(im,EI);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(Yi,{keyPath:om})}catch(s){t(s)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(Yi)?e(r):(r.close(),await TI(),e(await rc()))})})}async function Hh(n,e,t){const r=Oo(n,!0).put({[om]:e,value:t});return new Js(r).toPromise()}async function wI(n,e){const t=Oo(n,!1).get(e),r=await new Js(t).toPromise();return r===void 0?null:r.value}function Wh(n,e){const t=Oo(n,!0).delete(e);return new Js(t).toPromise()}const II=800,AI=3;class am{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await rc(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>AI)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return sm()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Vo._getInstance(vI()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await _I(),!this.activeServiceWorker)return;this.sender=new mI(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||yI()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await rc();return await Hh(e,Ji,"1"),await Wh(e,Ji),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>Hh(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>wI(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Wh(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=Oo(s,!1).getAll();return new Js(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),t.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),t.push(s));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),II)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}am.type="LOCAL";const bI=am;new Qs(3e4,6e4);function cm(n,e){return e?xt(e):($(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class pu extends Yp{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return br(e,this._buildIdpRequest())}_linkToIdToken(e,t){return br(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return br(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function SI(n){return oI(n.auth,new pu(n),n.bypassAuthState)}function RI(n){const{auth:e,user:t}=n;return $(t,e,"internal-error"),iI(t,new pu(n),n.bypassAuthState)}async function PI(n){const{auth:e,user:t}=n;return $(t,e,"internal-error"),sI(t,new pu(n),n.bypassAuthState)}class um{constructor(e,t,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:s,tenantId:i,error:a,type:c}=e;if(a){this.reject(a);return}const l={auth:this.auth,requestUri:t,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(l))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return SI;case"linkViaPopup":case"linkViaRedirect":return PI;case"reauthViaPopup":case"reauthViaRedirect":return RI;default:Nt(this.auth,"internal-error")}}resolve(e){qt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){qt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const CI=new Qs(2e3,1e4);async function kI(n,e,t){if(it(n.app))return Promise.reject(ft(n,"operation-not-supported-in-this-environment"));const r=Do(n);Aw(n,e,fu);const s=cm(r,t);return new xn(r,"signInViaPopup",e,s).executeNotNull()}class xn extends um{constructor(e,t,r,s,i){super(e,t,s,i),this.provider=r,this.authWindow=null,this.pollId=null,xn.currentPopupAction&&xn.currentPopupAction.cancel(),xn.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return $(e,this.auth,"internal-error"),e}async onExecution(){qt(this.filter.length===1,"Popup operations only handle one event");const e=du();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(ft(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(ft(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,xn.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ft(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,CI.get())};e()}}xn.currentPopupAction=null;const NI="pendingRedirect",Pi=new Map;class DI extends um{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=Pi.get(this.auth._key());if(!e){try{const r=await VI(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Pi.set(this.auth._key(),e)}return this.bypassAuthState||Pi.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function VI(n,e){const t=LI(e),r=MI(n);if(!await r._isAvailable())return!1;const s=await r._get(t)==="true";return await r._remove(t),s}function OI(n,e){Pi.set(n._key(),e)}function MI(n){return xt(n._redirectPersistence)}function LI(n){return Ri(NI,n.config.apiKey,n.name)}async function xI(n,e,t=!1){if(it(n.app))return Promise.reject(qn(n));const r=Do(n),s=cm(r,e),a=await new DI(r,s,t).execute();return a&&!t&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,e)),a}const FI=600*1e3;class UI{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!BI(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!lm(e)){const r=e.error.code?.split("auth/")[1]||"internal-error";t.onError(ft(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=FI&&this.cachedEventUids.clear(),this.cachedEventUids.has(Gh(e))}saveEventToCache(e){this.cachedEventUids.add(Gh(e)),this.lastProcessedEventTime=Date.now()}}function Gh(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function lm({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function BI(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return lm(n);default:return!1}}async function $I(n,e={}){return Qr(n,"GET","/v1/projects",e)}const jI=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,qI=/^https?/;async function zI(n){if(n.config.emulator)return;const{authorizedDomains:e}=await $I(n);for(const t of e)try{if(HI(t))return}catch{}Nt(n,"unauthorized-domain")}function HI(n){const e=tc(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const a=new URL(n);return a.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&a.hostname===r}if(!qI.test(t))return!1;if(jI.test(n))return r===n;const s=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}const WI=new Qs(3e4,6e4);function Kh(){const n=Rt().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function GI(n){return new Promise((e,t)=>{function r(){Kh(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Kh(),t(ft(n,"network-request-failed"))},timeout:WI.get()})}if(Rt().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Rt().gapi?.load)r();else{const s=Jw("iframefcb");return Rt()[s]=()=>{gapi.load?r():t(ft(n,"network-request-failed"))},Qw(`${Xw()}?onload=${s}`).catch(i=>t(i))}}).catch(e=>{throw Ci=null,e})}let Ci=null;function KI(n){return Ci=Ci||GI(n),Ci}const QI=new Qs(5e3,15e3),XI="__/auth/iframe",JI="emulator/auth/iframe",YI={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},ZI=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function eA(n){const e=n.config;$(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?au(e,JI):`https://${n.config.authDomain}/${XI}`,r={apiKey:e.apiKey,appName:n.name,v:zr},s=ZI.get(n.config.apiHost);s&&(r.eid=s);const i=n._getFrameworks();return i.length&&(r.fw=i.join(",")),`${t}?${qs(r).slice(1)}`}async function tA(n){const e=await KI(n),t=Rt().gapi;return $(t,n,"internal-error"),e.open({where:document.body,url:eA(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:YI,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const a=ft(n,"network-request-failed"),c=Rt().setTimeout(()=>{i(a)},QI.get());function l(){Rt().clearTimeout(c),s(r)}r.ping(l).then(l,()=>{i(a)})}))}const nA={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},rA=500,sA=600,iA="_blank",oA="http://localhost";class Qh{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function aA(n,e,t,r=rA,s=sA){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let c="";const l={...nA,width:r.toString(),height:s.toString(),top:i,left:a},h=Fe().toLowerCase();t&&(c=zp(h)?iA:t),jp(h)&&(e=e||oA,l.scrollbars="yes");const d=Object.entries(l).reduce((g,[T,S])=>`${g}${T}=${S},`,"");if($w(h)&&c!=="_self")return cA(e||"",c),new Qh(null);const m=window.open(e||"",c,d);$(m,n,"popup-blocked");try{m.focus()}catch{}return new Qh(m)}function cA(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}const uA="__/auth/handler",lA="emulator/auth/handler",hA=encodeURIComponent("fac");async function Xh(n,e,t,r,s,i){$(n.config.authDomain,n,"auth-domain-config-required"),$(n.config.apiKey,n,"invalid-api-key");const a={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:zr,eventId:s};if(e instanceof fu){e.setDefaultLanguage(n.languageCode),a.providerId=e.providerId||"",z_(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,m]of Object.entries({}))a[d]=m}if(e instanceof Xs){const d=e.getScopes().filter(m=>m!=="");d.length>0&&(a.scopes=d.join(","))}n.tenantId&&(a.tid=n.tenantId);const c=a;for(const d of Object.keys(c))c[d]===void 0&&delete c[d];const l=await n._getAppCheckToken(),h=l?`#${hA}=${encodeURIComponent(l)}`:"";return`${fA(n)}?${qs(c).slice(1)}${h}`}function fA({config:n}){return n.emulator?au(n,lA):`https://${n.authDomain}/${uA}`}const Ta="webStorageSupport";class dA{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=rm,this._completeRedirectFn=xI,this._overrideRedirectResult=OI}async _openPopup(e,t,r,s){qt(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const i=await Xh(e,t,r,tc(),s);return aA(e,i,du())}async _openRedirect(e,t,r,s){await this._originValidation(e);const i=await Xh(e,t,r,tc(),s);return gI(i),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:s,promise:i}=this.eventManagers[t];return s?Promise.resolve(s):(qt(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await tA(e),r=new UI(e);return t.register("authEvent",s=>($(s?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Ta,{type:Ta},s=>{const i=s?.[0]?.[Ta];i!==void 0&&t(!!i),Nt(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=zI(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Qp()||qp()||lu()}}const pA=dA;var Jh="@firebase/auth",Yh="1.11.1";class mA{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){$(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function gA(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function _A(n){Kn(new gn("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:a,authDomain:c}=r.options;$(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:a,authDomain:c,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Xp(n)},h=new Gw(r,s,i,l);return Zw(h,t),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Kn(new gn("auth-internal",e=>{const t=Do(e.getProvider("auth").getImmediate());return(r=>new mA(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),wt(Jh,Yh,gA(n)),wt(Jh,Yh,"esm2020")}const yA=300,vA=td("authIdTokenMaxAge")||yA;let Zh=null;const EA=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>vA)return;const s=t?.token;Zh!==s&&(Zh=s,await fetch(n,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function TA(n=bc()){const e=po(n,"auth");if(e.isInitialized())return e.getImmediate();const t=Yw(n,{popupRedirectResolver:pA,persistence:[bI,dI,rm]}),r=td("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const a=EA(i.toString());cI(t,a,()=>a(t.currentUser)),aI(t,c=>a(c))}}const s=Yf("auth");return s&&eI(t,`http://${s}`),t}function wA(){return document.getElementsByTagName("head")?.[0]??document}Kw({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=s=>{const i=ft("internal-error");i.customData=s,t(i)},r.type="text/javascript",r.charset="UTF-8",wA().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});_A("Browser");const IA={apiKey:"AIzaSyBC5VHNEcVL9KP8M0d64ZajF6P4Hzqzafc",authDomain:"bbnme-58716.firebaseapp.com",projectId:"bbnme-58716",storageBucket:"bbnme-58716.appspot.com",messagingSenderId:"155088179379",appId:"1:155088179379:web:5d98445c178b7513f520c6"},mu=sd(IA),Zi=rw(mu),gu=TA(mu),AA=new Mt,Mo=ho(null),hm=ho(!0);uI(gu,n=>{Mo.set(n),hm.set(!1)});var bA=he('<button class="svelte-18sv61c"> </button>');function xs(n,e){let t=Ge(e,"label",8,"Button"),r=Ge(e,"onClick",8,()=>{});var s=bA(),i=re(s);mn(()=>lo(i,t())),In("click",s,function(...a){r()?.apply(this,a)}),se(n,s)}var SA=he('<div class="login-container svelte-8ukb9p"><h2 class="svelte-8ukb9p">Please sign in to continue</h2> <!></div>');function RA(n,e){tt(e,!1),at();var t=SA(),r=le(re(t),2);xs(r,{label:"Sign in with Google",onClick:()=>kI(gu,AA)}),se(n,t),nt()}var PA=he('<button class="hamburger-button svelte-p9dp8"><div class="bar svelte-p9dp8"></div> <div class="bar svelte-p9dp8"></div> <div class="bar svelte-p9dp8"></div></button>');function CA(n,e){tt(e,!1);const t=$s();function r(){t("toggle")}at();var s=PA();In("click",s,r),se(n,s),nt()}var kA=he('<span class="not-authorized-message svelte-rfuq4y">Unauthorized user</span>'),NA=he(`<nav class="svelte-rfuq4y"><!> <div class="navbar-title svelte-rfuq4y"><h1 class="svelte-rfuq4y">bb'n'me</h1></div> <div class="user-status svelte-rfuq4y"><!></div></nav>`);function DA(n,e){tt(e,!1);const t=()=>Ut(l,"$isAuthorizedToWriteStore",s),r=()=>Ut(Mo,"$user",s),[s,i]=Bs(),a=_e(),c=$s(),l=Ss("isAuthorizedToWrite");function h(){c("toggle")}$r(()=>t(),()=>{W(a,t())}),jr(),at();var d=NA(),m=re(d);CA(m,{$$events:{toggle:h}});var g=le(m,4),T=re(g);{var S=C=>{var R=kA();se(C,R)};lt(T,C=>{r()&&!x(a)&&C(S)})}se(n,d),nt(),i()}var VA=he('<span class="not-authorized-message svelte-12buoxc">Unauthorized user</span>'),OA=he('<div class="user-profile svelte-12buoxc"><img alt="Profile" class="svelte-12buoxc"/> <span class="svelte-12buoxc"> </span> <!></div> <div class="nav-links-wrapper svelte-12buoxc"><div class="nav-links svelte-12buoxc"><a href="/" class="svelte-12buoxc">Home</a></div></div> <div class="sidenav-footer svelte-12buoxc"><!></div>',1),MA=he('<div><button class="close-button svelte-12buoxc">&times;</button> <!></div>');function LA(n,e){tt(e,!1);const t=()=>Ut(h,"$isAuthorizedToWriteStore",s),r=()=>Ut(Mo,"$user",s),[s,i]=Bs(),a=_e();let c=Ge(e,"isOpen",8,!1);const l=$s(),h=Ss("isAuthorizedToWrite");function d(){l("close")}$r(()=>t(),()=>{W(a,t())}),jr(),at();var m=MA();let g;var T=re(m),S=le(T,2);{var C=R=>{var L=OA(),O=Fn(L),D=re(O),z=le(D,2),J=re(z),ee=le(z,2);{var E=I=>{var w=VA();se(I,w)};lt(ee,I=>{x(a)||I(E)})}var _=le(O,4),y=re(_);xs(y,{label:"Sign out",onClick:()=>lI(gu)}),mn(()=>{vr(D,"src",(r(),je(()=>r().photoURL))),lo(J,(r(),je(()=>r().displayName)))}),se(R,L)};lt(S,R=>{r()&&R(C)})}mn(()=>g=Ec(m,1,"sidenav svelte-12buoxc",null,g,{open:c()})),In("click",T,d),se(n,m),nt(),i()}var xA=he('<form class="svelte-7mtrh0"><h2 class="svelte-7mtrh0">Add a new place</h2> <input type="text" placeholder="Place name" required class="svelte-7mtrh0"/> <input type="url" placeholder="Website" class="svelte-7mtrh0"/> <input type="url" placeholder="Image URL" class="svelte-7mtrh0"/> <!></form>');function FA(n,e){tt(e,!1);let t=_e(""),r=_e(""),s=_e("");async function i(){try{const m=await vw(Ap(Zi,"places"),{name:x(t),website:x(r),image:x(s)});console.log("Document written with ID: ",m.id),W(t,""),W(r,""),W(s,"")}catch(m){console.error("Error adding document: ",m)}}at();var a=xA(),c=le(re(a),2),l=le(c,2),h=le(l,2),d=le(h,2);xs(d,{label:"Add Place",type:"submit"}),Er(c,()=>x(t),m=>W(t,m)),Er(l,()=>x(r),m=>W(r,m)),Er(h,()=>x(s),m=>W(s,m)),In("submit",a,Gf(i)),se(n,a),nt()}var UA=he('<div class="card svelte-1udyrqm"><!></div>');function fm(n,e){var t=UA(),r=re(t);vc(r,e,"default",{}),se(n,t)}var BA=he('<button class="icon-button svelte-11linj7"><img class="svelte-11linj7"/></button>');function wa(n,e){tt(e,!1),$s();let t=Ge(e,"iconSrc",8),r=Ge(e,"altText",8,"Icon Button"),s=Ge(e,"onClick",8,()=>{}),i=Ge(e,"size",8,"md"),a=_e();$r(()=>jf(i()),()=>{switch(i()){case"sm":W(a,"var(--spacing-lg)");break;case"lg":W(a,"var(--spacing-xl)");break;case"md":default:W(a,"33px");break}}),jr(),at();var c=BA(),l=re(c);mn(()=>{vr(l,"src",t()),vr(l,"alt",r()),u_(l,`width: ${x(a)??""}; height: ${x(a)??""};`)}),In("click",c,function(...h){s()?.apply(this,h)}),se(n,c),nt()}var $A=he('<div class="dropdown-menu svelte-1222uzl"><!> <!></div>'),jA=he('<div class="see-more-menu svelte-1222uzl"><!> <!></div>');function qA(n,e){tt(e,!1);let t=Ge(e,"place",8),r=Ge(e,"isAuthorizedToWrite",8,!1);const s=$s();let i=_e(!1);function a(S){S.stopPropagation(),W(i,!x(i))}function c(){s("edit",t()),W(i,!1)}function l(){s("delete",t().id),W(i,!1)}function h(S){x(i)&&!S.target.closest(".see-more-menu")&&W(i,!1)}at();var d=jA();In("click",Pa,h);var m=re(d);wa(m,{iconSrc:"./assets/see_more.png",altText:"See More Options",onClick:a,size:"md"});var g=le(m,2);{var T=S=>{var C=$A(),R=re(C);wa(R,{iconSrc:"./assets/edit.png",altText:"Edit",onClick:c,size:"sm"});var L=le(R,2);wa(L,{iconSrc:"./assets/delete.png",altText:"Delete",onClick:l,size:"sm"}),se(S,C)};lt(g,S=>{x(i)&&r()&&S(T)})}se(n,d),nt()}var zA=he('<form class="svelte-136zmjt"><h2 class="svelte-136zmjt">Edit Place</h2> <input type="text" placeholder="Place name" required class="svelte-136zmjt"/> <input type="url" placeholder="Website" class="svelte-136zmjt"/> <input type="url" placeholder="Image URL" class="svelte-136zmjt"/> <div class="actions svelte-136zmjt"><!> <!></div></form>');function HA(n,e){tt(e,!1);let t=Ge(e,"place",8),r=Ge(e,"onSave",8,()=>{}),s=Ge(e,"onCancel",8,()=>{}),i=_e(t().name),a=_e(t().website),c=_e(t().image);async function l(){try{const R=Zc(Zi,"places",t().id);await _w(R,{name:x(i),website:x(a),image:x(c)}),console.log("Document successfully updated!"),r()()}catch(R){console.error("Error updating document: ",R)}}at();var h=zA(),d=le(re(h),2),m=le(d,2),g=le(m,2),T=le(g,2),S=re(T);xs(S,{label:"Save",type:"submit"});var C=le(S,2);xs(C,{label:"Cancel",get onClick(){return s()}}),Er(d,()=>x(i),R=>W(i,R)),Er(m,()=>x(a),R=>W(a,R)),Er(g,()=>x(c),R=>W(c,R)),In("submit",h,Gf(l)),se(n,h),nt()}var WA=he('<div class="image-container svelte-13geuu4"><a target="_blank" rel="noreferrer" class="image-wrapper svelte-13geuu4"><img class="svelte-13geuu4"/> <!></a></div>'),GA=he('<div class="place-header svelte-13geuu4"><h3 class="svelte-13geuu4"><b> </b></h3></div> <!>',1),KA=he('<div class="places-list-container svelte-13geuu4"><h2 class="svelte-13geuu4">Travel Wishlist</h2> <div class="places-grid svelte-13geuu4"></div></div>');function QA(n,e){tt(e,!1);const t=()=>Ut(a,"$isAuthorizedToWriteStore",r),[r,s]=Bs(),i=_e(),a=Ss("isAuthorizedToWrite");let c=_e([]),l=_e(null);g_(()=>{const C=Ew(Ap(Zi,"places"),R=>{W(c,R.docs.map(L=>({id:L.id,...L.data()})))});return()=>C()});async function h(C){try{await yw(Zc(Zi,"places",C)),console.log("Document successfully deleted!")}catch(R){console.error("Error removing document: ",R)}}function d(C){W(l,C)}function m(){W(l,null)}function g(){W(l,null)}$r(()=>t(),()=>{W(i,t())}),jr(),at();var T=KA(),S=le(re(T),2);zf(S,5,()=>x(c),qf,(C,R)=>{fm(C,{children:(L,O)=>{var D=yc(),z=Fn(D);{var J=E=>{HA(E,{get place(){return x(l)},onSave:m,onCancel:g})},ee=E=>{var _=GA(),y=Fn(_),I=re(y),w=re(I),A=re(w),v=le(y,2);{var ve=Ne=>{var Rn=WA(),nr=re(Rn),pt=re(nr),rt=le(pt,2);{var rr=Pn=>{qA(Pn,{get place(){return x(R)},get isAuthorizedToWrite(){return x(i)},$$events:{edit:Gt=>d(Gt.detail),delete:Gt=>h(Gt.detail)}})};lt(rt,Pn=>{x(i)&&Pn(rr)})}mn(()=>{vr(nr,"href",(x(R),je(()=>x(R).website))),vr(pt,"src",(x(R),je(()=>x(R).image))),vr(pt,"alt",(x(R),je(()=>x(R).name)))}),se(Ne,Rn)};lt(v,Ne=>{x(R),je(()=>x(R).image)&&Ne(ve)})}mn(()=>lo(A,(x(R),je(()=>x(R).name)))),se(E,_)};lt(z,E=>{x(l),x(R),je(()=>x(l)&&x(l).id===x(R).id)?E(J):E(ee,!1)})}se(L,D)},$$slots:{default:!0}})}),se(n,T),nt(),s()}var XA=he("<button> </button>"),JA=he('<div class="tabs-container svelte-126ak3w"><div class="tab-headers svelte-126ak3w"></div> <div class="tab-content svelte-126ak3w"><!></div></div>');function YA(n,e){tt(e,!1);let t=Ge(e,"activeTab",12,1);const r=ho(t());ba("activeTab",r);let s=[],i=_e([]);function a(g){return s=[...s,g],W(i,[...x(i),g]),s.length-1}ba("registerTab",a);function c(g){t(g),r.set(t())}at();var l=JA(),h=re(l);zf(h,5,()=>x(i),qf,(g,T,S)=>{var C=XA();let R;var L=re(C);mn(()=>{R=Ec(C,1,"tab-header svelte-126ak3w",null,R,{active:t()===S}),lo(L,x(T))}),In("click",C,()=>c(S)),se(g,C)});var d=le(h,2),m=re(d);vc(m,e,"default",{}),se(n,l),nt()}var ZA=he('<div class="tab-panel svelte-1vjnlah"><!></div>');function ef(n,e){tt(e,!1);const t=()=>Ut(c,"$activeTabStore",r),[r,s]=Bs(),i=_e();let a=Ge(e,"title",8);const c=Ss("activeTab"),l=Ss("registerTab");let h=_e();W(h,l(a())),$r(()=>(t(),x(h)),()=>{W(i,t()===x(h))}),jr(),at();var d=yc(),m=Fn(d);{var g=T=>{var S=ZA(),C=re(S);vc(C,e,"default",{}),se(T,S)};lt(m,T=>{x(i)&&T(g)})}se(n,d),nt(),s()}const eb="type.googleapis.com/google.protobuf.Int64Value",tb="type.googleapis.com/google.protobuf.UInt64Value";function dm(n,e){const t={};for(const r in n)n.hasOwnProperty(r)&&(t[r]=e(n[r]));return t}function eo(n){if(n==null)return null;if(n instanceof Number&&(n=n.valueOf()),typeof n=="number"&&isFinite(n)||n===!0||n===!1||Object.prototype.toString.call(n)==="[object String]")return n;if(n instanceof Date)return n.toISOString();if(Array.isArray(n))return n.map(e=>eo(e));if(typeof n=="function"||typeof n=="object")return dm(n,e=>eo(e));throw new Error("Data cannot be encoded in JSON: "+n)}function Fr(n){if(n==null)return n;if(n["@type"])switch(n["@type"]){case eb:case tb:{const e=Number(n.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+n);return e}default:throw new Error("Data cannot be decoded from JSON: "+n)}return Array.isArray(n)?n.map(e=>Fr(e)):typeof n=="function"||typeof n=="object"?dm(n,e=>Fr(e)):n}const _u="functions";const tf={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ke extends Vt{constructor(e,t,r){super(`${_u}/${e}`,t||""),this.details=r,Object.setPrototypeOf(this,Ke.prototype)}}function nb(n){if(n>=200&&n<300)return"ok";switch(n){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function to(n,e){let t=nb(n),r=t,s;try{const i=e&&e.error;if(i){const a=i.status;if(typeof a=="string"){if(!tf[a])return new Ke("internal","internal");t=tf[a],r=a}const c=i.message;typeof c=="string"&&(r=c),s=i.details,s!==void 0&&(s=Fr(s))}}catch{}return t==="ok"?null:new Ke(t,r,s)}class rb{constructor(e,t,r,s){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,it(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=t.getImmediate({optional:!0}),this.messaging=r.getImmediate({optional:!0}),this.auth||t.get().then(i=>this.auth=i,()=>{}),this.messaging||r.get().then(i=>this.messaging=i,()=>{}),this.appCheck||s?.get().then(i=>this.appCheck=i,()=>{})}async getAuthToken(){if(this.auth)try{return(await this.auth.getToken())?.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){const t=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return t.error?null:t.token}return null}async getContext(e){const t=await this.getAuthToken(),r=await this.getMessagingToken(),s=await this.getAppCheckToken(e);return{authToken:t,messagingToken:r,appCheckToken:s}}}const sc="us-central1",sb=/^data: (.*?)(?:\n|$)/;function ib(n){let e=null;return{promise:new Promise((t,r)=>{e=setTimeout(()=>{r(new Ke("deadline-exceeded","deadline-exceeded"))},n)}),cancel:()=>{e&&clearTimeout(e)}}}class ob{constructor(e,t,r,s,i=sc,a=(...c)=>fetch(...c)){this.app=e,this.fetchImpl=a,this.emulatorOrigin=null,this.contextProvider=new rb(e,t,r,s),this.cancelAllRequests=new Promise(c=>{this.deleteService=()=>Promise.resolve(c())});try{const c=new URL(i);this.customDomain=c.origin+(c.pathname==="/"?"":c.pathname),this.region=sc}catch{this.customDomain=null,this.region=i}}_delete(){return this.deleteService()}_url(e){const t=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${t}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${t}.cloudfunctions.net/${e}`}}function ab(n,e,t){const r=An(e);n.emulatorOrigin=`http${r?"s":""}://${e}:${t}`,r&&(Tc(n.emulatorOrigin+"/backends"),wc("Functions",!0))}function cb(n,e,t){const r=s=>lb(n,e,s,{});return r.stream=(s,i)=>fb(n,e,s,i),r}function pm(n){return n.emulatorOrigin&&An(n.emulatorOrigin)?"include":void 0}async function ub(n,e,t,r,s){t["Content-Type"]="application/json";let i;try{i=await r(n,{method:"POST",body:JSON.stringify(e),headers:t,credentials:pm(s)})}catch{return{status:0,json:null}}let a=null;try{a=await i.json()}catch{}return{status:i.status,json:a}}async function mm(n,e){const t={},r=await n.contextProvider.getContext(e.limitedUseAppCheckTokens);return r.authToken&&(t.Authorization="Bearer "+r.authToken),r.messagingToken&&(t["Firebase-Instance-ID-Token"]=r.messagingToken),r.appCheckToken!==null&&(t["X-Firebase-AppCheck"]=r.appCheckToken),t}function lb(n,e,t,r){const s=n._url(e);return hb(n,s,t,r)}async function hb(n,e,t,r){t=eo(t);const s={data:t},i=await mm(n,r),a=r.timeout||7e4,c=ib(a),l=await Promise.race([ub(e,s,i,n.fetchImpl,n),c.promise,n.cancelAllRequests]);if(c.cancel(),!l)throw new Ke("cancelled","Firebase Functions instance was deleted.");const h=to(l.status,l.json);if(h)throw h;if(!l.json)throw new Ke("internal","Response is not valid JSON object.");let d=l.json.data;if(typeof d>"u"&&(d=l.json.result),typeof d>"u")throw new Ke("internal","Response is missing data field.");return{data:Fr(d)}}function fb(n,e,t,r){const s=n._url(e);return db(n,s,t,r||{})}async function db(n,e,t,r){t=eo(t);const s={data:t},i=await mm(n,r);i["Content-Type"]="application/json",i.Accept="text/event-stream";let a;try{a=await n.fetchImpl(e,{method:"POST",body:JSON.stringify(s),headers:i,signal:r?.signal,credentials:pm(n)})}catch(g){if(g instanceof Error&&g.name==="AbortError"){const S=new Ke("cancelled","Request was cancelled.");return{data:Promise.reject(S),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(S)}}}}}}const T=to(0,null);return{data:Promise.reject(T),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(T)}}}}}}let c,l;const h=new Promise((g,T)=>{c=g,l=T});r?.signal?.addEventListener("abort",()=>{const g=new Ke("cancelled","Request was cancelled.");l(g)});const d=a.body.getReader(),m=pb(d,c,l,r?.signal);return{stream:{[Symbol.asyncIterator](){const g=m.getReader();return{async next(){const{value:T,done:S}=await g.read();return{value:T,done:S}},async return(){return await g.cancel(),{done:!0,value:void 0}}}}},data:h}}function pb(n,e,t,r){const s=(a,c)=>{const l=a.match(sb);if(!l)return;const h=l[1];try{const d=JSON.parse(h);if("result"in d){e(Fr(d.result));return}if("message"in d){c.enqueue(Fr(d.message));return}if("error"in d){const m=to(0,d);c.error(m),t(m);return}}catch(d){if(d instanceof Ke){c.error(d),t(d);return}}},i=new TextDecoder;return new ReadableStream({start(a){let c="";return l();async function l(){if(r?.aborted){const h=new Ke("cancelled","Request was cancelled");return a.error(h),t(h),Promise.resolve()}try{const{value:h,done:d}=await n.read();if(d){c.trim()&&s(c.trim(),a),a.close();return}if(r?.aborted){const g=new Ke("cancelled","Request was cancelled");a.error(g),t(g),await n.cancel();return}c+=i.decode(h,{stream:!0});const m=c.split(`
`);c=m.pop()||"";for(const g of m)g.trim()&&s(g.trim(),a);return l()}catch(h){const d=h instanceof Ke?h:to(0,null);a.error(d),t(d)}}},cancel(){return n.cancel()}})}const nf="@firebase/functions",rf="0.13.1";const mb="auth-internal",gb="app-check-internal",_b="messaging-internal";function yb(n){const e=(t,{instanceIdentifier:r})=>{const s=t.getProvider("app").getImmediate(),i=t.getProvider(mb),a=t.getProvider(_b),c=t.getProvider(gb);return new ob(s,i,a,c,r)};Kn(new gn(_u,e,"PUBLIC").setMultipleInstances(!0)),wt(nf,rf,n),wt(nf,rf,"esm2020")}function vb(n=bc(),e=sc){const r=po(ye(n),_u).getImmediate({identifier:e}),s=Zf("functions");return s&&Eb(r,...s),r}function Eb(n,e,t){ab(ye(n),e,t)}function Tb(n,e,t){return cb(ye(n),e)}yb();var wb=he('<div class="loading-screen svelte-1n46o8q"><img src="./assets/loading_image.png" alt="Loading..." class="loading-image svelte-1n46o8q"/></div>'),Ib=he("<!> <!>",1),Ab=he('<!> <!> <div class="container svelte-1n46o8q"><!></div>',1),bb=he("<main><!></main>");function Sb(n,e){tt(e,!1);const t=()=>Ut(hm,"$authLoading",i),r=()=>Ut(Mo,"$user",i),s=()=>Ut(h,"$isAuthorizedToWriteStore",i),[i,a]=Bs(),c=vb(mu),l=Tb(c,"checkAuthorization"),h=ho(!1);let d=_e(!1),m=_e(!1);ba("isAuthorizedToWrite",h);function g(){W(m,!x(m))}$r(()=>(t(),r()),()=>{!t()&&r()?l().then(O=>{h.set(O.data.status==="authorized"),W(d,!0)}).catch(O=>{console.error("Error checking authorization:",O),h.set(!1),W(d,!0)}):!t()&&!r()?(h.set(!1),W(d,!0)):(h.set(!1),W(d,!1))}),jr(),at();var T=bb();let S;var C=re(T);{var R=O=>{var D=wb();se(O,D)},L=O=>{var D=yc(),z=Fn(D);{var J=E=>{var _=Ab(),y=Fn(_);DA(y,{$$events:{toggle:g}});var I=le(y,2);LA(I,{get isOpen(){return x(m)},$$events:{close:g}});var w=le(I,2),A=re(w);YA(A,{children:(v,ve)=>{var Ne=Ib(),Rn=Fn(Ne);{var nr=rt=>{ef(rt,{title:"Add Place",children:(rr,Pn)=>{fm(rr,{children:(Gt,Lo)=>{FA(Gt,{})},$$slots:{default:!0}})},$$slots:{default:!0}})};lt(Rn,rt=>{x(d)&&s()&&rt(nr)})}var pt=le(Rn,2);ef(pt,{title:"Travel Wishlist",children:(rt,rr)=>{QA(rt,{})},$$slots:{default:!0}}),se(v,Ne)},$$slots:{default:!0}}),se(E,_)},ee=E=>{RA(E,{})};lt(z,E=>{r()?E(J):E(ee,!1)},!0)}se(O,D)};lt(C,O=>{t()||!x(d)?O(R):O(L,!1)})}mn(()=>S=Ec(T,1,"svelte-1n46o8q",null,S,{"fullscreen-main":t()||!x(d)})),se(n,T),nt(),a()}t_(Sb,{target:document.getElementById("app")});
