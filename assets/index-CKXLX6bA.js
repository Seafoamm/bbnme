(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();const Zh=!1;var Ya=Array.isArray,Um=Array.prototype.indexOf,Za=Array.from,ef=Object.defineProperty,ar=Object.getOwnPropertyDescriptor,tf=Object.getOwnPropertyDescriptors,Bm=Object.prototype,jm=Array.prototype,ec=Object.getPrototypeOf,hl=Object.isExtensible;const cr=()=>{};function $m(n){return n()}function ga(n){for(var e=0;e<n.length;e++)n[e]()}function nf(){var n,e,t=new Promise((r,s)=>{n=r,e=s});return{promise:t,resolve:n,reject:e}}const xe=2,tc=4,Ji=8,Ft=16,Ut=32,Hn=64,Yi=128,at=512,Pe=1024,Ke=2048,Rt=4096,Ze=8192,nn=16384,nc=32768,vr=65536,fl=1<<17,rf=1<<18,Or=1<<19,sf=1<<20,Es=32768,_a=1<<21,rc=1<<22,rn=1<<23,ur=Symbol("$state"),qm=Symbol("legacy props"),zm=Symbol(""),ir=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function sc(n){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function Hm(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function Wm(n){throw new Error("https://svelte.dev/e/effect_in_teardown")}function Gm(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Km(n){throw new Error("https://svelte.dev/e/effect_orphan")}function Qm(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Xm(n){throw new Error("https://svelte.dev/e/props_invalid_value")}function Jm(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Ym(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Zm(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function eg(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const tg=1,ng=2,rg=16,sg=2,ig=4,og=8,ag=1,cg=2,Oe=Symbol(),ug="http://www.w3.org/1999/xhtml";function lg(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}let hg=!1;function of(n){return n===this.v}function af(n,e){return n!=n?e==e:n!==e||n!==null&&typeof n=="object"||typeof n=="function"}function cf(n){return!af(n,this.v)}let Mr=!1,fg=!1;function dg(){Mr=!0}let re=null;function Er(n){re=n}function ic(n){return uf().get(n)}function pg(n,e){return uf().set(n,e),e}function Bt(n,e=!1,t){re={p:re,i:!1,c:null,e:null,s:n,x:null,l:Mr&&!e?{s:null,u:null,$:[]}:null}}function jt(n){var e=re,t=e.e;if(t!==null){e.e=null;for(var r of t)Af(r)}return e.i=!0,re=e.p,{}}function Ns(){return!Mr||re!==null&&re.l===null}function uf(n){return re===null&&sc(),re.c??=new Map(mg(re)||void 0)}function mg(n){let e=n.p;for(;e!==null;){const t=e.c;if(t!==null)return t;e=e.p}return null}let Cn=[];function lf(){var n=Cn;Cn=[],ga(n)}function Zi(n){if(Cn.length===0&&!fs){var e=Cn;queueMicrotask(()=>{e===Cn&&lf()})}Cn.push(n)}function gg(){for(;Cn.length>0;)lf()}function hf(n){var e=ee;if(e===null)return J.f|=rn,n;if((e.f&nc)===0){if((e.f&Yi)===0)throw n;e.b.error(n)}else Tr(n,e)}function Tr(n,e){for(;e!==null;){if((e.f&Yi)!==0)try{e.b.error(n);return}catch(t){n=t}e=e.parent}throw n}const si=new Set;let oe=null,fi=null,Je=null,ft=[],eo=null,ya=!1,fs=!1;class dt{committed=!1;current=new Map;previous=new Map;#e=new Set;#t=new Set;#n=0;#r=0;#c=null;#o=[];#a=[];skipped_effects=new Set;is_fork=!1;process(e){ft=[],fi=null,this.apply();var t={parent:null,effect:null,effects:[],render_effects:[],block_effects:[]};for(const r of e)this.#s(r,t);this.is_fork||this.#u(),this.#r>0||this.is_fork?(this.#i(t.effects),this.#i(t.render_effects),this.#i(t.block_effects)):(fi=this,oe=null,dl(t.render_effects),dl(t.effects),fi=null,this.#c?.resolve()),Je=null}#s(e,t){e.f^=Pe;for(var r=e.first;r!==null;){var s=r.f,i=(s&(Ut|Hn))!==0,a=i&&(s&Pe)!==0,c=a||(s&Ze)!==0||this.skipped_effects.has(r);if((r.f&Yi)!==0&&r.b?.is_pending()&&(t={parent:t,effect:r,effects:[],render_effects:[],block_effects:[]}),!c&&r.fn!==null){i?r.f^=Pe:(s&tc)!==0?t.effects.push(r):Lr(r)&&((r.f&Ft)!==0&&t.block_effects.push(r),Ar(r));var l=r.first;if(l!==null){r=l;continue}}var h=r.parent;for(r=r.next;r===null&&h!==null;)h===t.effect&&(this.#i(t.effects),this.#i(t.render_effects),this.#i(t.block_effects),t=t.parent),r=h.next,h=h.parent}}#i(e){for(const t of e)((t.f&Ke)!==0?this.#o:this.#a).push(t),ke(t,Pe)}capture(e,t){this.previous.has(e)||this.previous.set(e,t),(e.f&rn)===0&&(this.current.set(e,e.v),Je?.set(e,e.v))}activate(){oe=this,this.apply()}deactivate(){oe=null,Je=null}flush(){if(this.activate(),ft.length>0){if(ff(),oe!==null&&oe!==this)return}else this.#n===0&&this.process([]);this.deactivate()}discard(){for(const e of this.#t)e(this);this.#t.clear()}#u(){if(this.#r===0){for(const e of this.#e)e();this.#e.clear()}this.#n===0&&this.#l()}#l(){if(si.size>1){this.previous.clear();var e=Je,t=!0,r={parent:null,effect:null,effects:[],render_effects:[],block_effects:[]};for(const s of si){if(s===this){t=!1;continue}const i=[];for(const[c,l]of this.current){if(s.current.has(c))if(t&&l!==s.current.get(c))s.current.set(c,l);else continue;i.push(c)}if(i.length===0)continue;const a=[...s.current.keys()].filter(c=>!this.current.has(c));if(a.length>0){const c=new Set,l=new Map;for(const h of i)df(h,a,c,l);if(ft.length>0){oe=s,s.apply();for(const h of ft)s.#s(h,r);ft=[],s.deactivate()}}}oe=null,Je=e}this.committed=!0,si.delete(this)}increment(e){this.#n+=1,e&&(this.#r+=1)}decrement(e){this.#n-=1,e&&(this.#r-=1),this.revive()}revive(){for(const e of this.#o)ke(e,Ke),xn(e);for(const e of this.#a)ke(e,Rt),xn(e);this.#o=[],this.#a=[],this.flush()}oncommit(e){this.#e.add(e)}ondiscard(e){this.#t.add(e)}settled(){return(this.#c??=nf()).promise}static ensure(){if(oe===null){const e=oe=new dt;si.add(oe),fs||dt.enqueue(()=>{oe===e&&e.flush()})}return oe}static enqueue(e){Zi(e)}apply(){}}function _g(n){var e=fs;fs=!0;try{for(var t;;){if(gg(),ft.length===0&&(oe?.flush(),ft.length===0))return eo=null,t;ff()}}finally{fs=e}}function ff(){var n=Dn;ya=!0;try{var e=0;for(gl(!0);ft.length>0;){var t=dt.ensure();if(e++>1e3){var r,s;yg()}t.process(ft),sn.clear()}}finally{ya=!1,gl(n),eo=null}}function yg(){try{Qm()}catch(n){Tr(n,eo)}}let Ct=null;function dl(n){var e=n.length;if(e!==0){for(var t=0;t<e;){var r=n[t++];if((r.f&(nn|Ze))===0&&Lr(r)&&(Ct=new Set,Ar(r),r.deps===null&&r.first===null&&r.nodes_start===null&&(r.teardown===null&&r.ac===null?Sf(r):r.fn=null),Ct?.size>0)){sn.clear();for(const s of Ct){if((s.f&(nn|Ze))!==0)continue;const i=[s];let a=s.parent;for(;a!==null;)Ct.has(a)&&(Ct.delete(a),i.push(a)),a=a.parent;for(let c=i.length-1;c>=0;c--){const l=i[c];(l.f&(nn|Ze))===0&&Ar(l)}}Ct.clear()}}Ct=null}}function df(n,e,t,r){if(!t.has(n)&&(t.add(n),n.reactions!==null))for(const s of n.reactions){const i=s.f;(i&xe)!==0?df(s,e,t,r):(i&(rc|Ft))!==0&&(i&Ke)===0&&pf(s,e,r)&&(ke(s,Ke),xn(s))}}function pf(n,e,t){const r=t.get(n);if(r!==void 0)return r;if(n.deps!==null)for(const s of n.deps){if(e.includes(s))return!0;if((s.f&xe)!==0&&pf(s,e,t))return t.set(s,!0),!0}return t.set(n,!1),!1}function xn(n){for(var e=eo=n;e.parent!==null;){e=e.parent;var t=e.f;if(ya&&e===ee&&(t&Ft)!==0&&(t&rf)===0)return;if((t&(Hn|Ut))!==0){if((t&Pe)===0)return;e.f^=Pe}}ft.push(e)}function vg(n){let e=0,t=Fn(0),r;return()=>{no()&&(F(t),io(()=>(e===0&&(r=ze(()=>n(()=>ds(t)))),e+=1,()=>{Zi(()=>{e-=1,e===0&&(r?.(),r=void 0,ds(t))})})))}}var Eg=vr|Or|Yi;function Tg(n,e,t){new Ig(n,e,t)}class Ig{parent;#e=!1;#t;#n=null;#r;#c;#o;#a=null;#s=null;#i=null;#u=null;#l=null;#d=0;#h=0;#p=!1;#f=null;#v=vg(()=>(this.#f=Fn(this.#d),()=>{this.#f=null}));constructor(e,t,r){this.#t=e,this.#r=t,this.#c=r,this.parent=ee.b,this.#e=!!this.#r.pending,this.#o=lc(()=>{ee.b=this;{var s=this.#_();try{this.#a=rt(()=>r(s))}catch(i){this.error(i)}this.#h>0?this.#g():this.#e=!1}return()=>{this.#l?.remove()}},Eg)}#E(){try{this.#a=rt(()=>this.#c(this.#t))}catch(e){this.error(e)}this.#e=!1}#T(){const e=this.#r.pending;e&&(this.#s=rt(()=>e(this.#t)),dt.enqueue(()=>{var t=this.#_();this.#a=this.#m(()=>(dt.ensure(),rt(()=>this.#c(t)))),this.#h>0?this.#g():(hr(this.#s,()=>{this.#s=null}),this.#e=!1)}))}#_(){var e=this.#t;return this.#e&&(this.#l=Ir(),this.#t.before(this.#l),e=this.#l),e}is_pending(){return this.#e||!!this.parent&&this.parent.is_pending()}has_pending_snippet(){return!!this.#r.pending}#m(e){var t=ee,r=J,s=re;It(this.#o),We(this.#o),Er(this.#o.ctx);try{return e()}catch(i){return hf(i),null}finally{It(t),We(r),Er(s)}}#g(){const e=this.#r.pending;this.#a!==null&&(this.#u=document.createDocumentFragment(),this.#u.append(this.#l),kf(this.#a,this.#u)),this.#s===null&&(this.#s=rt(()=>e(this.#t)))}#y(e){if(!this.has_pending_snippet()){this.parent&&this.parent.#y(e);return}this.#h+=e,this.#h===0&&(this.#e=!1,this.#s&&hr(this.#s,()=>{this.#s=null}),this.#u&&(this.#t.before(this.#u),this.#u=null))}update_pending_count(e){this.#y(e),this.#d+=e,this.#f&&Ts(this.#f,this.#d)}get_effect_pending(){return this.#v(),F(this.#f)}error(e){var t=this.#r.onerror;let r=this.#r.failed;if(this.#p||!t&&!r)throw e;this.#a&&($e(this.#a),this.#a=null),this.#s&&($e(this.#s),this.#s=null),this.#i&&($e(this.#i),this.#i=null);var s=!1,i=!1;const a=()=>{if(s){lg();return}s=!0,i&&eg(),dt.ensure(),this.#d=0,this.#i!==null&&hr(this.#i,()=>{this.#i=null}),this.#e=this.has_pending_snippet(),this.#a=this.#m(()=>(this.#p=!1,rt(()=>this.#c(this.#t)))),this.#h>0?this.#g():this.#e=!1};var c=J;try{We(null),i=!0,t?.(e,a),i=!1}catch(l){Tr(l,this.#o&&this.#o.parent)}finally{We(c)}r&&Zi(()=>{this.#i=this.#m(()=>{dt.ensure(),this.#p=!0;try{return rt(()=>{r(this.#t,()=>e,()=>a)})}catch(l){return Tr(l,this.#o.parent),null}finally{this.#p=!1}})})}}function wg(n,e,t,r){const s=Ns()?oc:ac;if(t.length===0&&n.length===0){r(e.map(s));return}var i=oe,a=ee,c=Ag();function l(){Promise.all(t.map(h=>bg(h))).then(h=>{c();try{r([...e.map(s),...h])}catch(d){(a.f&nn)===0&&Tr(d,a)}i?.deactivate(),Ai()}).catch(h=>{Tr(h,a)})}n.length>0?Promise.all(n).then(()=>{c();try{return l()}finally{i?.deactivate(),Ai()}}):l()}function Ag(){var n=ee,e=J,t=re,r=oe;return function(i=!0){It(n),We(e),Er(t),i&&r?.activate()}}function Ai(){It(null),We(null),Er(null)}function oc(n){var e=xe|Ke,t=J!==null&&(J.f&xe)!==0?J:null;return ee!==null&&(ee.f|=Or),{ctx:re,deps:null,effects:null,equals:of,f:e,fn:n,reactions:null,rv:0,v:Oe,wv:0,parent:t??ee,ac:null}}function bg(n,e){let t=ee;t===null&&Hm();var r=t.b,s=void 0,i=Fn(Oe),a=!J,c=new Map;return Mg(()=>{var l=nf();s=l.promise;try{Promise.resolve(n()).then(l.resolve,l.reject).then(()=>{h===oe&&h.committed&&h.deactivate(),Ai()})}catch(m){l.reject(m),Ai()}var h=oe;if(a){var d=!r.is_pending();r.update_pending_count(1),h.increment(d),c.get(h)?.reject(ir),c.delete(h),c.set(h,l)}const g=(m,E=void 0)=>{if(h.activate(),E)E!==ir&&(i.f|=rn,Ts(i,E));else{(i.f&rn)!==0&&(i.f^=rn),Ts(i,m);for(const[S,C]of c){if(c.delete(S),S===h)break;C.reject(ir)}}a&&(r.update_pending_count(-1),h.decrement(d))};l.promise.then(g,m=>g(null,m||"unknown"))}),uc(()=>{for(const l of c.values())l.reject(ir)}),new Promise(l=>{function h(d){function g(){d===s?l(i):h(s)}d.then(g,g)}h(s)})}function ac(n){const e=oc(n);return e.equals=cf,e}function mf(n){var e=n.effects;if(e!==null){n.effects=null;for(var t=0;t<e.length;t+=1)$e(e[t])}}function Rg(n){for(var e=n.parent;e!==null;){if((e.f&xe)===0)return e;e=e.parent}return null}function cc(n){var e,t=ee;It(Rg(n));try{n.f&=~Es,mf(n),e=Of(n)}finally{It(t)}return e}function gf(n){var e=cc(n);if(n.equals(e)||(n.v=e,n.wv=Df()),!Wn)if(Je!==null)no()&&Je.set(n,n.v);else{var t=(n.f&at)===0?Rt:Pe;ke(n,t)}}let va=new Set;const sn=new Map;let _f=!1;function Fn(n,e){var t={f:0,v:n,reactions:null,equals:of,rv:0,wv:0};return t}function Xt(n,e){const t=Fn(n);return Fg(t),t}function Ce(n,e=!1,t=!0){const r=Fn(n);return e||(r.equals=cf),Mr&&t&&re!==null&&re.l!==null&&(re.l.s??=[]).push(r),r}function Q(n,e,t=!1){J!==null&&(!pt||(J.f&fl)!==0)&&Ns()&&(J.f&(xe|Ft|rc|fl))!==0&&!Vt?.includes(n)&&Zm();let r=t?or(e):e;return Ts(n,r)}function Ts(n,e){if(!n.equals(e)){var t=n.v;Wn?sn.set(n,e):sn.set(n,t),n.v=e;var r=dt.ensure();r.capture(n,t),(n.f&xe)!==0&&((n.f&Ke)!==0&&cc(n),ke(n,(n.f&at)!==0?Pe:Rt)),n.wv=Df(),yf(n,Ke),Ns()&&ee!==null&&(ee.f&Pe)!==0&&(ee.f&(Ut|Hn))===0&&(et===null?Ug([n]):et.push(n)),!r.is_fork&&va.size>0&&!_f&&Sg()}return e}function Sg(){_f=!1;const n=Array.from(va);for(const e of n)(e.f&Pe)!==0&&ke(e,Rt),Lr(e)&&Ar(e);va.clear()}function ds(n){Q(n,n.v+1)}function yf(n,e){var t=n.reactions;if(t!==null)for(var r=Ns(),s=t.length,i=0;i<s;i++){var a=t[i],c=a.f;if(!(!r&&a===ee)){var l=(c&Ke)===0;if(l&&ke(a,e),(c&xe)!==0){var h=a;Je?.delete(h),(c&Es)===0&&(c&at&&(a.f|=Es),yf(h,Rt))}else l&&((c&Ft)!==0&&Ct!==null&&Ct.add(a),xn(a))}}}function or(n){if(typeof n!="object"||n===null||ur in n)return n;const e=ec(n);if(e!==Bm&&e!==jm)return n;var t=new Map,r=Ya(n),s=Xt(0),i=Vn,a=c=>{if(Vn===i)return c();var l=J,h=Vn;We(null),yl(i);var d=c();return We(l),yl(h),d};return r&&t.set("length",Xt(n.length)),new Proxy(n,{defineProperty(c,l,h){(!("value"in h)||h.configurable===!1||h.enumerable===!1||h.writable===!1)&&Jm();var d=t.get(l);return d===void 0?d=a(()=>{var g=Xt(h.value);return t.set(l,g),g}):Q(d,h.value,!0),!0},deleteProperty(c,l){var h=t.get(l);if(h===void 0){if(l in c){const d=a(()=>Xt(Oe));t.set(l,d),ds(s)}}else Q(h,Oe),ds(s);return!0},get(c,l,h){if(l===ur)return n;var d=t.get(l),g=l in c;if(d===void 0&&(!g||ar(c,l)?.writable)&&(d=a(()=>{var E=or(g?c[l]:Oe),S=Xt(E);return S}),t.set(l,d)),d!==void 0){var m=F(d);return m===Oe?void 0:m}return Reflect.get(c,l,h)},getOwnPropertyDescriptor(c,l){var h=Reflect.getOwnPropertyDescriptor(c,l);if(h&&"value"in h){var d=t.get(l);d&&(h.value=F(d))}else if(h===void 0){var g=t.get(l),m=g?.v;if(g!==void 0&&m!==Oe)return{enumerable:!0,configurable:!0,value:m,writable:!0}}return h},has(c,l){if(l===ur)return!0;var h=t.get(l),d=h!==void 0&&h.v!==Oe||Reflect.has(c,l);if(h!==void 0||ee!==null&&(!d||ar(c,l)?.writable)){h===void 0&&(h=a(()=>{var m=d?or(c[l]):Oe,E=Xt(m);return E}),t.set(l,h));var g=F(h);if(g===Oe)return!1}return d},set(c,l,h,d){var g=t.get(l),m=l in c;if(r&&l==="length")for(var E=h;E<g.v;E+=1){var S=t.get(E+"");S!==void 0?Q(S,Oe):E in c&&(S=a(()=>Xt(Oe)),t.set(E+"",S))}if(g===void 0)(!m||ar(c,l)?.writable)&&(g=a(()=>Xt(void 0)),Q(g,or(h)),t.set(l,g));else{m=g.v!==Oe;var C=a(()=>or(h));Q(g,C)}var P=Reflect.getOwnPropertyDescriptor(c,l);if(P?.set&&P.set.call(d,h),!m){if(r&&typeof l=="string"){var L=t.get("length"),O=Number(l);Number.isInteger(O)&&O>=L.v&&Q(L,O+1)}ds(s)}return!0},ownKeys(c){F(s);var l=Reflect.ownKeys(c).filter(g=>{var m=t.get(g);return m===void 0||m.v!==Oe});for(var[h,d]of t)d.v!==Oe&&!(h in c)&&l.push(h);return l},setPrototypeOf(){Ym()}})}var pl,vf,Ef,Tf;function Pg(){if(pl===void 0){pl=window,vf=/Firefox/.test(navigator.userAgent);var n=Element.prototype,e=Node.prototype,t=Text.prototype;Ef=ar(e,"firstChild").get,Tf=ar(e,"nextSibling").get,hl(n)&&(n.__click=void 0,n.__className=void 0,n.__attributes=null,n.__style=void 0,n.__e=void 0),hl(t)&&(t.__t=void 0)}}function Ir(n=""){return document.createTextNode(n)}function bi(n){return Ef.call(n)}function Ds(n){return Tf.call(n)}function ye(n,e){return bi(n)}function lr(n,e=!1){{var t=bi(n);return t instanceof Comment&&t.data===""?Ds(t):t}}function fe(n,e=1,t=!1){let r=n;for(;e--;)r=Ds(r);return r}function Cg(n){n.textContent=""}function If(){return!1}let ml=!1;function kg(){ml||(ml=!0,document.addEventListener("reset",n=>{Promise.resolve().then(()=>{if(!n.defaultPrevented)for(const e of n.target.elements)e.__on_r?.()})},{capture:!0}))}function to(n){var e=J,t=ee;We(null),It(null);try{return n()}finally{We(e),It(t)}}function Ng(n,e,t,r=t){n.addEventListener(e,()=>to(t));const s=n.__on_r;s?n.__on_r=()=>{s(),r(!0)}:n.__on_r=()=>r(!0),kg()}function wf(n){ee===null&&(J===null&&Km(),Gm()),Wn&&Wm()}function Dg(n,e){var t=e.last;t===null?e.last=e.first=n:(t.next=n,n.prev=t,e.last=n)}function $t(n,e,t,r=!0){var s=ee;s!==null&&(s.f&Ze)!==0&&(n|=Ze);var i={ctx:re,deps:null,nodes_start:null,nodes_end:null,f:n|Ke|at,first:null,fn:e,last:null,next:null,parent:s,b:s&&s.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(t)try{Ar(i),i.f|=nc}catch(l){throw $e(i),l}else e!==null&&xn(i);if(r){var a=i;if(t&&a.deps===null&&a.teardown===null&&a.nodes_start===null&&a.first===a.last&&(a.f&Or)===0&&(a=a.first,(n&Ft)!==0&&(n&vr)!==0&&a!==null&&(a.f|=vr)),a!==null&&(a.parent=s,s!==null&&Dg(a,s),J!==null&&(J.f&xe)!==0&&(n&Hn)===0)){var c=J;(c.effects??=[]).push(a)}}return i}function no(){return J!==null&&!pt}function uc(n){const e=$t(Ji,null,!1);return ke(e,Pe),e.teardown=n,e}function Ea(n){wf();var e=ee.f,t=!J&&(e&Ut)!==0&&(e&nc)===0;if(t){var r=re;(r.e??=[]).push(n)}else return Af(n)}function Af(n){return $t(tc|sf,n,!1)}function Vg(n){return wf(),$t(Ji|sf,n,!0)}function Og(n){dt.ensure();const e=$t(Hn|Or,n,!0);return(t={})=>new Promise(r=>{t.outro?hr(e,()=>{$e(e),r(void 0)}):($e(e),r(void 0))})}function ro(n,e){var t=re,r={effect:null,ran:!1,deps:n};t.l.$.push(r),r.effect=io(()=>{n(),!r.ran&&(r.ran=!0,ze(e))})}function so(){var n=re;io(()=>{for(var e of n.l.$){e.deps();var t=e.effect;(t.f&Pe)!==0&&ke(t,Rt),Lr(t)&&Ar(t),e.ran=!1}})}function Mg(n){return $t(rc|Or,n,!0)}function io(n,e=0){return $t(Ji|e,n,!0)}function wr(n,e=[],t=[],r=[],s=!1){wg(r,e,t,i=>{$t(s?tc:Ji,()=>n(...i.map(F)),!0)})}function lc(n,e=0){var t=$t(Ft|e,n,!0);return t}function rt(n,e=!0){return $t(Ut|Or,n,!0,e)}function bf(n){var e=n.teardown;if(e!==null){const t=Wn,r=J;_l(!0),We(null);try{e.call(null)}finally{_l(t),We(r)}}}function Rf(n,e=!1){var t=n.first;for(n.first=n.last=null;t!==null;){const s=t.ac;s!==null&&to(()=>{s.abort(ir)});var r=t.next;(t.f&Hn)!==0?t.parent=null:$e(t,e),t=r}}function Lg(n){for(var e=n.first;e!==null;){var t=e.next;(e.f&Ut)===0&&$e(e),e=t}}function $e(n,e=!0){var t=!1;(e||(n.f&rf)!==0)&&n.nodes_start!==null&&n.nodes_end!==null&&(xg(n.nodes_start,n.nodes_end),t=!0),Rf(n,e&&!t),Ri(n,0),ke(n,nn);var r=n.transitions;if(r!==null)for(const i of r)i.stop();bf(n);var s=n.parent;s!==null&&s.first!==null&&Sf(n),n.next=n.prev=n.teardown=n.ctx=n.deps=n.fn=n.nodes_start=n.nodes_end=n.ac=null}function xg(n,e){for(;n!==null;){var t=n===e?null:Ds(n);n.remove(),n=t}}function Sf(n){var e=n.parent,t=n.prev,r=n.next;t!==null&&(t.next=r),r!==null&&(r.prev=t),e!==null&&(e.first===n&&(e.first=r),e.last===n&&(e.last=t))}function hr(n,e,t=!0){var r=[];hc(n,r,!0),Pf(r,()=>{t&&$e(n),e&&e()})}function Pf(n,e){var t=n.length;if(t>0){var r=()=>--t||e();for(var s of n)s.out(r)}else e()}function hc(n,e,t){if((n.f&Ze)===0){if(n.f^=Ze,n.transitions!==null)for(const a of n.transitions)(a.is_global||t)&&e.push(a);for(var r=n.first;r!==null;){var s=r.next,i=(r.f&vr)!==0||(r.f&Ut)!==0&&(n.f&Ft)!==0;hc(r,e,i?t:!1),r=s}}}function fc(n){Cf(n,!0)}function Cf(n,e){if((n.f&Ze)!==0){n.f^=Ze,(n.f&Pe)===0&&(ke(n,Ke),xn(n));for(var t=n.first;t!==null;){var r=t.next,s=(t.f&vr)!==0||(t.f&Ut)!==0;Cf(t,s?e:!1),t=r}if(n.transitions!==null)for(const i of n.transitions)(i.is_global||e)&&i.in()}}function kf(n,e){for(var t=n.nodes_start,r=n.nodes_end;t!==null;){var s=t===r?null:Ds(t);e.append(t),t=s}}let Dn=!1;function gl(n){Dn=n}let Wn=!1;function _l(n){Wn=n}let J=null,pt=!1;function We(n){J=n}let ee=null;function It(n){ee=n}let Vt=null;function Fg(n){J!==null&&(Vt===null?Vt=[n]:Vt.push(n))}let je=null,Xe=0,et=null;function Ug(n){et=n}let Nf=1,Is=0,Vn=Is;function yl(n){Vn=n}function Df(){return++Nf}function Lr(n){var e=n.f;if((e&Ke)!==0)return!0;if(e&xe&&(n.f&=~Es),(e&Rt)!==0){var t=n.deps;if(t!==null)for(var r=t.length,s=0;s<r;s++){var i=t[s];if(Lr(i)&&gf(i),i.wv>n.wv)return!0}(e&at)!==0&&Je===null&&ke(n,Pe)}return!1}function Vf(n,e,t=!0){var r=n.reactions;if(r!==null&&!Vt?.includes(n))for(var s=0;s<r.length;s++){var i=r[s];(i.f&xe)!==0?Vf(i,e,!1):e===i&&(t?ke(i,Ke):(i.f&Pe)!==0&&ke(i,Rt),xn(i))}}function Of(n){var e=je,t=Xe,r=et,s=J,i=Vt,a=re,c=pt,l=Vn,h=n.f;je=null,Xe=0,et=null,J=(h&(Ut|Hn))===0?n:null,Vt=null,Er(n.ctx),pt=!1,Vn=++Is,n.ac!==null&&(to(()=>{n.ac.abort(ir)}),n.ac=null);try{n.f|=_a;var d=n.fn,g=d(),m=n.deps;if(je!==null){var E;if(Ri(n,Xe),m!==null&&Xe>0)for(m.length=Xe+je.length,E=0;E<je.length;E++)m[Xe+E]=je[E];else n.deps=m=je;if(Dn&&no()&&(n.f&at)!==0)for(E=Xe;E<m.length;E++)(m[E].reactions??=[]).push(n)}else m!==null&&Xe<m.length&&(Ri(n,Xe),m.length=Xe);if(Ns()&&et!==null&&!pt&&m!==null&&(n.f&(xe|Rt|Ke))===0)for(E=0;E<et.length;E++)Vf(et[E],n);return s!==null&&s!==n&&(Is++,et!==null&&(r===null?r=et:r.push(...et))),(n.f&rn)!==0&&(n.f^=rn),g}catch(S){return hf(S)}finally{n.f^=_a,je=e,Xe=t,et=r,J=s,Vt=i,Er(a),pt=c,Vn=l}}function Bg(n,e){let t=e.reactions;if(t!==null){var r=Um.call(t,n);if(r!==-1){var s=t.length-1;s===0?t=e.reactions=null:(t[r]=t[s],t.pop())}}t===null&&(e.f&xe)!==0&&(je===null||!je.includes(e))&&(ke(e,Rt),(e.f&at)!==0&&(e.f^=at,e.f&=~Es),mf(e),Ri(e,0))}function Ri(n,e){var t=n.deps;if(t!==null)for(var r=e;r<t.length;r++)Bg(n,t[r])}function Ar(n){var e=n.f;if((e&nn)===0){ke(n,Pe);var t=ee,r=Dn;ee=n,Dn=!0;try{(e&Ft)!==0?Lg(n):Rf(n),bf(n);var s=Of(n);n.teardown=typeof s=="function"?s:null,n.wv=Nf;var i;Zh&&fg&&(n.f&Ke)!==0&&n.deps}finally{Dn=r,ee=t}}}async function jg(){await Promise.resolve(),_g()}function F(n){var e=n.f,t=(e&xe)!==0;if(J!==null&&!pt){var r=ee!==null&&(ee.f&nn)!==0;if(!r&&!Vt?.includes(n)){var s=J.deps;if((J.f&_a)!==0)n.rv<Is&&(n.rv=Is,je===null&&s!==null&&s[Xe]===n?Xe++:je===null?je=[n]:je.includes(n)||je.push(n));else{(J.deps??=[]).push(n);var i=n.reactions;i===null?n.reactions=[J]:i.includes(J)||i.push(J)}}}if(Wn){if(sn.has(n))return sn.get(n);if(t){var a=n,c=a.v;return((a.f&Pe)===0&&a.reactions!==null||Lf(a))&&(c=cc(a)),sn.set(a,c),c}}else if(t){if(a=n,Je?.has(a))return Je.get(a);Lr(a)&&gf(a),Dn&&no()&&(a.f&at)===0&&Mf(a)}else if(Je?.has(n))return Je.get(n);if((n.f&rn)!==0)throw n.v;return n.v}function Mf(n){if(n.deps!==null){n.f^=at;for(const e of n.deps)(e.reactions??=[]).push(n),(e.f&xe)!==0&&(e.f&at)===0&&Mf(e)}}function Lf(n){if(n.v===Oe)return!0;if(n.deps===null)return!1;for(const e of n.deps)if(sn.has(e)||(e.f&xe)!==0&&Lf(e))return!0;return!1}function ze(n){var e=pt;try{return pt=!0,n()}finally{pt=e}}const $g=-7169;function ke(n,e){n.f=n.f&$g|e}function qg(n){if(!(typeof n!="object"||!n||n instanceof EventTarget)){if(ur in n)Ta(n);else if(!Array.isArray(n))for(let e in n){const t=n[e];typeof t=="object"&&t&&ur in t&&Ta(t)}}}function Ta(n,e=new Set){if(typeof n=="object"&&n!==null&&!(n instanceof EventTarget)&&!e.has(n)){e.add(n),n instanceof Date&&n.getTime();for(let r in n)try{Ta(n[r],e)}catch{}const t=ec(n);if(t!==Object.prototype&&t!==Array.prototype&&t!==Map.prototype&&t!==Set.prototype&&t!==Date.prototype){const r=tf(t);for(let s in r){const i=r[s].get;if(i)try{i.call(n)}catch{}}}}}const zg=["touchstart","touchmove"];function Hg(n){return zg.includes(n)}const Wg=new Set,vl=new Set;function Gg(n,e,t,r={}){function s(i){if(r.capture||as.call(e,i),!i.cancelBubble)return to(()=>t?.call(this,i))}return n.startsWith("pointer")||n.startsWith("touch")||n==="wheel"?Zi(()=>{e.addEventListener(n,s,r)}):e.addEventListener(n,s,r),s}function Vs(n,e,t,r,s){var i={capture:r,passive:s},a=Gg(n,e,t,i);(e===document.body||e===window||e===document||e instanceof HTMLMediaElement)&&uc(()=>{e.removeEventListener(n,a,i)})}let El=null;function as(n){var e=this,t=e.ownerDocument,r=n.type,s=n.composedPath?.()||[],i=s[0]||n.target;El=n;var a=0,c=El===n&&n.__root;if(c){var l=s.indexOf(c);if(l!==-1&&(e===document||e===window)){n.__root=e;return}var h=s.indexOf(e);if(h===-1)return;l<=h&&(a=l)}if(i=s[a]||n.target,i!==e){ef(n,"currentTarget",{configurable:!0,get(){return i||t}});var d=J,g=ee;We(null),It(null);try{for(var m,E=[];i!==null;){var S=i.assignedSlot||i.parentNode||i.host||null;try{var C=i["__"+r];C!=null&&(!i.disabled||n.target===i)&&C.call(i,n)}catch(P){m?E.push(P):m=P}if(n.cancelBubble||S===e||S===null)break;i=S}if(m){for(let P of E)queueMicrotask(()=>{throw P});throw m}}finally{n.__root=e,delete n.currentTarget,We(d),It(g)}}}function Kg(n){var e=document.createElement("template");return e.innerHTML=n.replaceAll("<!>","<!---->"),e.content}function Ia(n,e){var t=ee;t.nodes_start===null&&(t.nodes_start=n,t.nodes_end=e)}function Ie(n,e){var t=(e&ag)!==0,r=(e&cg)!==0,s,i=!n.startsWith("<!>");return()=>{s===void 0&&(s=Kg(i?n:"<!>"+n),t||(s=bi(s)));var a=r||vf?document.importNode(s,!0):s.cloneNode(!0);if(t){var c=bi(a),l=a.lastChild;Ia(c,l)}else Ia(a,a);return a}}function wa(){var n=document.createDocumentFragment(),e=document.createComment(""),t=Ir();return n.append(e,t),Ia(e,t),n}function he(n,e){n!==null&&n.before(e)}function dc(n,e){var t=e==null?"":typeof e=="object"?e+"":e;t!==(n.__t??=n.nodeValue)&&(n.__t=t,n.nodeValue=t+"")}function Qg(n,e){return Xg(n,e)}const Zn=new Map;function Xg(n,{target:e,anchor:t,props:r={},events:s,context:i,intro:a=!0}){Pg();var c=new Set,l=g=>{for(var m=0;m<g.length;m++){var E=g[m];if(!c.has(E)){c.add(E);var S=Hg(E);e.addEventListener(E,as,{passive:S});var C=Zn.get(E);C===void 0?(document.addEventListener(E,as,{passive:S}),Zn.set(E,1)):Zn.set(E,C+1)}}};l(Za(Wg)),vl.add(l);var h=void 0,d=Og(()=>{var g=t??e.appendChild(Ir());return Tg(g,{pending:()=>{}},m=>{if(i){Bt({});var E=re;E.c=i}s&&(r.$$events=s),h=n(m,r)||{},i&&jt()}),()=>{for(var m of c){e.removeEventListener(m,as);var E=Zn.get(m);--E===0?(document.removeEventListener(m,as),Zn.delete(m)):Zn.set(m,E)}vl.delete(l),g!==t&&g.parentNode?.removeChild(g)}});return Jg.set(h,d),h}let Jg=new WeakMap;class Yg{anchor;#e=new Map;#t=new Map;#n=new Map;#r=!0;constructor(e,t=!0){this.anchor=e,this.#r=t}#c=()=>{var e=oe;if(this.#e.has(e)){var t=this.#e.get(e),r=this.#t.get(t);if(r)fc(r);else{var s=this.#n.get(t);s&&(this.#t.set(t,s.effect),this.#n.delete(t),s.fragment.lastChild.remove(),this.anchor.before(s.fragment),r=s.effect)}for(const[i,a]of this.#e){if(this.#e.delete(i),i===e)break;const c=this.#n.get(a);c&&($e(c.effect),this.#n.delete(a))}for(const[i,a]of this.#t){if(i===t)continue;const c=()=>{if(Array.from(this.#e.values()).includes(i)){var h=document.createDocumentFragment();kf(a,h),h.append(Ir()),this.#n.set(i,{effect:a,fragment:h})}else $e(a);this.#t.delete(i)};this.#r||!r?hr(a,c,!1):c()}}};#o=e=>{this.#e.delete(e);const t=Array.from(this.#e.values());for(const[r,s]of this.#n)t.includes(r)||($e(s.effect),this.#n.delete(r))};ensure(e,t){var r=oe,s=If();if(t&&!this.#t.has(e)&&!this.#n.has(e))if(s){var i=document.createDocumentFragment(),a=Ir();i.append(a),this.#n.set(e,{effect:rt(()=>t(a)),fragment:i})}else this.#t.set(e,rt(()=>t(this.anchor)));if(this.#e.set(r,e),s){for(const[c,l]of this.#t)c===e?r.skipped_effects.delete(l):r.skipped_effects.add(l);for(const[c,l]of this.#n)c===e?r.skipped_effects.delete(l.effect):r.skipped_effects.add(l.effect);r.oncommit(this.#c),r.ondiscard(this.#o)}else this.#c()}}function mt(n,e,t=!1){var r=new Yg(n),s=t?vr:0;function i(a,c){r.ensure(a,c)}lc(()=>{var a=!1;e((c,l=!0)=>{a=!0,i(l,c)}),a||i(!1,null)},s)}function Zg(n,e){return e}function e_(n,e,t){for(var r=n.items,s=[],i=e.length,a=0;a<i;a++)hc(e[a].e,s,!0);var c=i>0&&s.length===0&&t!==null;if(c){var l=t.parentNode;Cg(l),l.append(t),r.clear(),lt(n,e[0].prev,e[i-1].next)}Pf(s,()=>{for(var h=0;h<i;h++){var d=e[h];c||(r.delete(d.k),lt(n,d.prev,d.next)),$e(d.e,!c)}})}function t_(n,e,t,r,s,i=null){var a=n,c={flags:e,items:new Map,first:null},l=null,h=!1,d=new Map,g=ac(()=>{var C=t();return Ya(C)?C:C==null?[]:Za(C)}),m,E;function S(){n_(E,m,c,d,a,s,e,r,t),i!==null&&(m.length===0?l?fc(l):l=rt(()=>i(a)):l!==null&&hr(l,()=>{l=null}))}lc(()=>{E??=ee,m=F(g);var C=m.length;if(!(h&&C===0)){h=C===0;var P,L,O,V;if(If()){var q=new Set,Y=oe;for(L=0;L<C;L+=1){O=m[L],V=r(O,L);var Z=c.items.get(V)??d.get(V);Z?xf(Z,O,L):(P=Ff(null,c,null,null,O,V,L,s,e,t,!0),d.set(V,P)),q.add(V)}for(const[I,_]of c.items)q.has(I)||Y.skipped_effects.add(_.e);Y.oncommit(S)}else S();F(g)}})}function n_(n,e,t,r,s,i,a,c,l){var h=e.length,d=t.items,g=t.first,m=g,E,S=null,C=[],P=[],L,O,V,q;for(q=0;q<h;q+=1){if(L=e[q],O=c(L,q),V=d.get(O),V===void 0){var Y=r.get(O);if(Y!==void 0){r.delete(O),d.set(O,Y);var Z=S?S.next:m;lt(t,S,Y),lt(t,Y,Z),ta(Y,Z,s),S=Y}else{var I=m?m.e.nodes_start:s;S=Ff(I,t,S,S===null?t.first:S.next,L,O,q,i,a,l)}d.set(O,S),C=[],P=[],m=S.next;continue}if(xf(V,L,q),(V.e.f&Ze)!==0&&fc(V.e),V!==m){if(E!==void 0&&E.has(V)){if(C.length<P.length){var _=P[0],v;S=_.prev;var w=C[0],T=C[C.length-1];for(v=0;v<C.length;v+=1)ta(C[v],_,s);for(v=0;v<P.length;v+=1)E.delete(P[v]);lt(t,w.prev,T.next),lt(t,S,w),lt(t,T,_),m=_,S=T,q-=1,C=[],P=[]}else E.delete(V),ta(V,m,s),lt(t,V.prev,V.next),lt(t,V,S===null?t.first:S.next),lt(t,S,V),S=V;continue}for(C=[],P=[];m!==null&&m.k!==O;)(m.e.f&Ze)===0&&(E??=new Set).add(m),P.push(m),m=m.next;if(m===null)continue;V=m}C.push(V),S=V,m=V.next}if(m!==null||E!==void 0){for(var A=E===void 0?[]:Za(E);m!==null;)(m.e.f&Ze)===0&&A.push(m),m=m.next;var y=A.length;if(y>0){var se=null;e_(t,A,se)}}n.first=t.first&&t.first.e,n.last=S&&S.e;for(var be of r.values())$e(be.e);r.clear()}function xf(n,e,t,r){Ts(n.v,e),n.i=t}function Ff(n,e,t,r,s,i,a,c,l,h,d){var g=(l&tg)!==0,m=(l&rg)===0,E=g?m?Ce(s,!1,!1):Fn(s):s,S=(l&ng)===0?a:Fn(a),C={i:S,v:E,k:i,a:null,e:null,prev:t,next:r};try{if(n===null){var P=document.createDocumentFragment();P.append(n=Ir())}return C.e=rt(()=>c(n,E,S,h),hg),C.e.prev=t&&t.e,C.e.next=r&&r.e,t===null?d||(e.first=C):(t.next=C,t.e.next=C.e),r!==null&&(r.prev=C,r.e.prev=C.e),C}finally{}}function ta(n,e,t){for(var r=n.next?n.next.e.nodes_start:t,s=e?e.e.nodes_start:t,i=n.e.nodes_start;i!==null&&i!==r;){var a=Ds(i);s.before(i),i=a}}function lt(n,e,t){e===null?n.first=t:(e.next=t,e.e.next=t&&t.e),t!==null&&(t.prev=e,t.e.prev=e&&e.e)}function r_(n,e,t,r,s){var i=e.$$slots?.[t],a=!1;i===!0&&(i=e.children,a=!0),i===void 0||i(n,a?()=>r:r)}const Tl=[...` 	
\r\fÂ \v\uFEFF`];function s_(n,e,t){var r=n==null?"":""+n;if(t){for(var s in t)if(t[s])r=r?r+" "+s:s;else if(r.length)for(var i=s.length,a=0;(a=r.indexOf(s,a))>=0;){var c=a+i;(a===0||Tl.includes(r[a-1]))&&(c===r.length||Tl.includes(r[c]))?r=(a===0?"":r.substring(0,a))+r.substring(c+1):a=c}}return r===""?null:r}function Uf(n,e,t,r,s,i){var a=n.__className;if(a!==t||a===void 0){var c=s_(t,r,i);c==null?n.removeAttribute("class"):n.className=c,n.__className=t}else if(i&&s!==i)for(var l in i){var h=!!i[l];(s==null||h!==!!s[l])&&n.classList.toggle(l,h)}return i}const i_=Symbol("is custom element"),o_=Symbol("is html");function di(n,e,t,r){var s=a_(n);s[e]!==(s[e]=t)&&(e==="loading"&&(n[zm]=t),t==null?n.removeAttribute(e):typeof t!="string"&&c_(n).includes(e)?n[e]=t:n.setAttribute(e,t))}function a_(n){return n.__attributes??={[i_]:n.nodeName.includes("-"),[o_]:n.namespaceURI===ug}}var Il=new Map;function c_(n){var e=n.getAttribute("is")||n.nodeName,t=Il.get(e);if(t)return t;Il.set(e,t=[]);for(var r,s=n,i=Element.prototype;i!==s;){r=tf(s);for(var a in r)r[a].set&&t.push(a);s=ec(s)}return t}function fr(n,e,t=e){var r=new WeakSet;Ng(n,"input",async s=>{var i=s?n.defaultValue:n.value;if(i=na(n)?ra(i):i,t(i),oe!==null&&r.add(oe),await jg(),i!==(i=e())){var a=n.selectionStart,c=n.selectionEnd,l=n.value.length;if(n.value=i??"",c!==null){var h=n.value.length;a===c&&c===l&&h>l?(n.selectionStart=h,n.selectionEnd=h):(n.selectionStart=a,n.selectionEnd=Math.min(c,h))}}}),ze(e)==null&&n.value&&(t(na(n)?ra(n.value):n.value),oe!==null&&r.add(oe)),io(()=>{var s=e();if(n===document.activeElement){var i=fi??oe;if(r.has(i))return}na(n)&&s===ra(n.value)||n.type==="date"&&!s&&!n.value||s!==n.value&&(n.value=s??"")})}function na(n){var e=n.type;return e==="number"||e==="range"}function ra(n){return n===""?null:+n}function Bf(n){return function(...e){var t=e[0];return t.preventDefault(),n?.apply(this,e)}}function yn(n=!1){const e=re,t=e.l.u;if(!t)return;let r=()=>qg(e.s);if(n){let s=0,i={};const a=oc(()=>{let c=!1;const l=e.s;for(const h in l)l[h]!==i[h]&&(i[h]=l[h],c=!0);return c&&s++,s});r=()=>F(a)}t.b.length&&Vg(()=>{wl(e,r),ga(t.b)}),Ea(()=>{const s=ze(()=>t.m.map($m));return()=>{for(const i of s)typeof i=="function"&&i()}}),t.a.length&&Ea(()=>{wl(e,r),ga(t.a)})}function wl(n,e){if(n.l.s)for(const t of n.l.s)F(t);e()}function jf(n,e,t){if(n==null)return e(void 0),cr;const r=ze(()=>n.subscribe(e,t));return r.unsubscribe?()=>r.unsubscribe():r}const er=[];function $f(n,e=cr){let t=null;const r=new Set;function s(c){if(af(n,c)&&(n=c,t)){const l=!er.length;for(const h of r)h[1](),er.push(h,n);if(l){for(let h=0;h<er.length;h+=2)er[h][0](er[h+1]);er.length=0}}}function i(c){s(c(n))}function a(c,l=cr){const h=[c,l];return r.add(h),r.size===1&&(t=e(s,i)||cr),c(n),()=>{r.delete(h),r.size===0&&t&&(t(),t=null)}}return{set:s,update:i,subscribe:a}}function u_(n){let e;return jf(n,t=>e=t)(),e}let ii=!1,Aa=Symbol();function Si(n,e,t){const r=t[e]??={store:null,source:Ce(void 0),unsubscribe:cr};if(r.store!==n&&!(Aa in t))if(r.unsubscribe(),r.store=n??null,n==null)r.source.v=void 0,r.unsubscribe=cr;else{var s=!0;r.unsubscribe=jf(n,i=>{s?r.source.v=i:Q(r.source,i)}),s=!1}return n&&Aa in t?u_(n):F(r.source)}function pc(){const n={};function e(){uc(()=>{for(var t in n)n[t].unsubscribe();ef(n,Aa,{enumerable:!1,value:!0})})}return[n,e]}function l_(n){var e=ii;try{return ii=!1,[n(),ii]}finally{ii=e}}function dr(n,e,t,r){var s=!Mr||(t&sg)!==0,i=(t&og)!==0,a=r,c=!0,l=()=>(c&&(c=!1,a=r),a),h;{var d=ur in n||qm in n;h=ar(n,e)?.set??(d&&e in n?O=>n[e]=O:void 0)}var g,m=!1;[g,m]=l_(()=>n[e]),g===void 0&&r!==void 0&&(g=l(),h&&(s&&Xm(),h(g)));var E;if(s?E=()=>{var O=n[e];return O===void 0?l():(c=!0,O)}:E=()=>{var O=n[e];return O!==void 0&&(a=void 0),O===void 0?a:O},s&&(t&ig)===0)return E;if(h){var S=n.$$legacy;return(function(O,V){return arguments.length>0?((!s||!V||S||m)&&h(V?E():O),O):E()})}var C=!1,P=ac(()=>(C=!1,E()));F(P);var L=ee;return(function(O,V){if(arguments.length>0){const q=V?F(P):s&&i?or(O):O;return Q(P,q),C=!0,a!==void 0&&(a=q),O}return Wn&&C||(L.f&nn)!==0?P.v:F(P)})}function qf(n){re===null&&sc(),Mr&&re.l!==null?f_(re).m.push(n):Ea(()=>{const e=ze(n);if(typeof e=="function")return e})}function h_(n,e,{bubbles:t=!1,cancelable:r=!1}={}){return new CustomEvent(n,{detail:e,bubbles:t,cancelable:r})}function mc(){const n=re;return n===null&&sc(),(e,t,r)=>{const s=n.s.$$events?.[e];if(s){const i=Ya(s)?s.slice():[s],a=h_(e,t,r);for(const c of i)c.call(n.x,a);return!a.defaultPrevented}return!0}}function f_(n){var e=n.l;return e.u??={a:[],b:[],m:[]}}const d_="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(d_);dg();const p_=()=>{};var Al={};const zf=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let s=n.charCodeAt(r);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},m_=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const s=n[t++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=n[t++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=n[t++],a=n[t++],c=n[t++],l=((s&7)<<18|(i&63)<<12|(a&63)<<6|c&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const i=n[t++],a=n[t++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|a&63)}}return e.join("")},Hf={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<n.length;s+=3){const i=n[s],a=s+1<n.length,c=a?n[s+1]:0,l=s+2<n.length,h=l?n[s+2]:0,d=i>>2,g=(i&3)<<4|c>>4;let m=(c&15)<<2|h>>6,E=h&63;l||(E=64,a||(m=64)),r.push(t[d],t[g],t[m],t[E])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(zf(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):m_(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<n.length;){const i=t[n.charAt(s++)],c=s<n.length?t[n.charAt(s)]:0;++s;const h=s<n.length?t[n.charAt(s)]:64;++s;const g=s<n.length?t[n.charAt(s)]:64;if(++s,i==null||c==null||h==null||g==null)throw new g_;const m=i<<2|c>>4;if(r.push(m),h!==64){const E=c<<4&240|h>>2;if(r.push(E),g!==64){const S=h<<6&192|g;r.push(S)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class g_ extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const __=function(n){const e=zf(n);return Hf.encodeByteArray(e,!0)},Pi=function(n){return __(n).replace(/\./g,"")},Wf=function(n){try{return Hf.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function y_(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const v_=()=>y_().__FIREBASE_DEFAULTS__,E_=()=>{if(typeof process>"u"||typeof Al>"u")return;const n=Al.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},T_=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&Wf(n[1]);return e&&JSON.parse(e)},oo=()=>{try{return p_()||v_()||E_()||T_()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Gf=n=>oo()?.emulatorHosts?.[n],Kf=n=>{const e=Gf(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},Qf=()=>oo()?.config,Xf=n=>oo()?.[`_${n}`];class I_{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}function vn(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function gc(n){return(await fetch(n,{credentials:"include"})).ok}function w_(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",s=n.iat||0,i=n.sub||n.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a={iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...n};return[Pi(JSON.stringify(t)),Pi(JSON.stringify(a)),""].join(".")}const ps={};function A_(){const n={prod:[],emulator:[]};for(const e of Object.keys(ps))ps[e]?n.emulator.push(e):n.prod.push(e);return n}function b_(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let bl=!1;function _c(n,e){if(typeof window>"u"||typeof document>"u"||!vn(window.location.host)||ps[n]===e||ps[n]||bl)return;ps[n]=e;function t(m){return`__firebase__banner__${m}`}const r="__firebase__banner",i=A_().prod.length>0;function a(){const m=document.getElementById(r);m&&m.remove()}function c(m){m.style.display="flex",m.style.background="#7faaf0",m.style.position="fixed",m.style.bottom="5px",m.style.left="5px",m.style.padding=".5em",m.style.borderRadius="5px",m.style.alignItems="center"}function l(m,E){m.setAttribute("width","24"),m.setAttribute("id",E),m.setAttribute("height","24"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.style.marginLeft="-6px"}function h(){const m=document.createElement("span");return m.style.cursor="pointer",m.style.marginLeft="16px",m.style.fontSize="24px",m.innerHTML=" &times;",m.onclick=()=>{bl=!0,a()},m}function d(m,E){m.setAttribute("id",E),m.innerText="Learn more",m.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",m.setAttribute("target","__blank"),m.style.paddingLeft="5px",m.style.textDecoration="underline"}function g(){const m=b_(r),E=t("text"),S=document.getElementById(E)||document.createElement("span"),C=t("learnmore"),P=document.getElementById(C)||document.createElement("a"),L=t("preprendIcon"),O=document.getElementById(L)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.created){const V=m.element;c(V),d(P,C);const q=h();l(O,L),V.append(O,S,P,q),document.body.appendChild(V)}i?(S.innerText="Preview backend disconnected.",O.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(O.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,S.innerText="Preview backend running in this workspace."),S.setAttribute("id",E)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",g):g()}function Fe(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function R_(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Fe())}function S_(){const n=oo()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function P_(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function C_(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function k_(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function N_(){const n=Fe();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function D_(){return!S_()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function V_(){try{return typeof indexedDB=="object"}catch{return!1}}function O_(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{e(s.error?.message||"")}}catch(t){e(t)}})}const M_="FirebaseError";class St extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=M_,Object.setPrototypeOf(this,St.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Os.prototype.create)}}class Os{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},s=`${this.service}/${e}`,i=this.errors[e],a=i?L_(i,r):"Error",c=`${this.serviceName}: ${a} (${s}).`;return new St(s,c,r)}}function L_(n,e){return n.replace(x_,(t,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const x_=/\{\$([^}]+)}/g;function F_(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Un(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const s of t){if(!r.includes(s))return!1;const i=n[s],a=e[s];if(Rl(i)&&Rl(a)){if(!Un(i,a))return!1}else if(i!==a)return!1}for(const s of r)if(!t.includes(s))return!1;return!0}function Rl(n){return n!==null&&typeof n=="object"}function Ms(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function U_(n,e){const t=new B_(n,e);return t.subscribe.bind(t)}class B_{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let s;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");j_(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:r},s.next===void 0&&(s.next=sa),s.error===void 0&&(s.error=sa),s.complete===void 0&&(s.complete=sa);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function j_(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function sa(){}function ge(n){return n&&n._delegate?n._delegate:n}class hn{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Pn="[DEFAULT]";class $_{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new I_;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(z_(e))try{this.getOrInitializeService({instanceIdentifier:Pn})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=Pn){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Pn){return this.instances.has(e)}getOptions(e=Pn){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[i,a]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(i);r===c&&a.resolve(s)}return s}onInit(e,t){const r=this.normalizeInstanceIdentifier(t),s=this.onInitCallbacks.get(r)??new Set;s.add(e),this.onInitCallbacks.set(r,s);const i=this.instances.get(r);return i&&e(i,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const s of r)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:q_(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Pn){return this.component?this.component.multipleInstances?e:Pn:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function q_(n){return n===Pn?void 0:n}function z_(n){return n.instantiationMode==="EAGER"}class H_{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new $_(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var W;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(W||(W={}));const W_={debug:W.DEBUG,verbose:W.VERBOSE,info:W.INFO,warn:W.WARN,error:W.ERROR,silent:W.SILENT},G_=W.INFO,K_={[W.DEBUG]:"log",[W.VERBOSE]:"log",[W.INFO]:"info",[W.WARN]:"warn",[W.ERROR]:"error"},Q_=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),s=K_[e];if(s)console[s](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class yc{constructor(e){this.name=e,this._logLevel=G_,this._logHandler=Q_,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in W))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?W_[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,W.DEBUG,...e),this._logHandler(this,W.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,W.VERBOSE,...e),this._logHandler(this,W.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,W.INFO,...e),this._logHandler(this,W.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,W.WARN,...e),this._logHandler(this,W.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,W.ERROR,...e),this._logHandler(this,W.ERROR,...e)}}const X_=(n,e)=>e.some(t=>n instanceof t);let Sl,Pl;function J_(){return Sl||(Sl=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Y_(){return Pl||(Pl=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Jf=new WeakMap,ba=new WeakMap,Yf=new WeakMap,ia=new WeakMap,vc=new WeakMap;function Z_(n){const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("success",i),n.removeEventListener("error",a)},i=()=>{t(on(n.result)),s()},a=()=>{r(n.error),s()};n.addEventListener("success",i),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&Jf.set(t,n)}).catch(()=>{}),vc.set(e,n),e}function ey(n){if(ba.has(n))return;const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("complete",i),n.removeEventListener("error",a),n.removeEventListener("abort",a)},i=()=>{t(),s()},a=()=>{r(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",i),n.addEventListener("error",a),n.addEventListener("abort",a)});ba.set(n,e)}let Ra={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return ba.get(n);if(e==="objectStoreNames")return n.objectStoreNames||Yf.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return on(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function ty(n){Ra=n(Ra)}function ny(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(oa(this),e,...t);return Yf.set(r,e.sort?e.sort():[e]),on(r)}:Y_().includes(n)?function(...e){return n.apply(oa(this),e),on(Jf.get(this))}:function(...e){return on(n.apply(oa(this),e))}}function ry(n){return typeof n=="function"?ny(n):(n instanceof IDBTransaction&&ey(n),X_(n,J_())?new Proxy(n,Ra):n)}function on(n){if(n instanceof IDBRequest)return Z_(n);if(ia.has(n))return ia.get(n);const e=ry(n);return e!==n&&(ia.set(n,e),vc.set(e,n)),e}const oa=n=>vc.get(n);function sy(n,e,{blocked:t,upgrade:r,blocking:s,terminated:i}={}){const a=indexedDB.open(n,e),c=on(a);return r&&a.addEventListener("upgradeneeded",l=>{r(on(a.result),l.oldVersion,l.newVersion,on(a.transaction),l)}),t&&a.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),c.then(l=>{i&&l.addEventListener("close",()=>i()),s&&l.addEventListener("versionchange",h=>s(h.oldVersion,h.newVersion,h))}).catch(()=>{}),c}const iy=["get","getKey","getAll","getAllKeys","count"],oy=["put","add","delete","clear"],aa=new Map;function Cl(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(aa.get(e))return aa.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,s=oy.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(s||iy.includes(t)))return;const i=async function(a,...c){const l=this.transaction(a,s?"readwrite":"readonly");let h=l.store;return r&&(h=h.index(c.shift())),(await Promise.all([h[t](...c),s&&l.done]))[0]};return aa.set(e,i),i}ty(n=>({...n,get:(e,t,r)=>Cl(e,t)||n.get(e,t,r),has:(e,t)=>!!Cl(e,t)||n.has(e,t)}));class ay{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(cy(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function cy(n){return n.getComponent()?.type==="VERSION"}const Sa="@firebase/app",kl="0.14.5";const Ot=new yc("@firebase/app"),uy="@firebase/app-compat",ly="@firebase/analytics-compat",hy="@firebase/analytics",fy="@firebase/app-check-compat",dy="@firebase/app-check",py="@firebase/auth",my="@firebase/auth-compat",gy="@firebase/database",_y="@firebase/data-connect",yy="@firebase/database-compat",vy="@firebase/functions",Ey="@firebase/functions-compat",Ty="@firebase/installations",Iy="@firebase/installations-compat",wy="@firebase/messaging",Ay="@firebase/messaging-compat",by="@firebase/performance",Ry="@firebase/performance-compat",Sy="@firebase/remote-config",Py="@firebase/remote-config-compat",Cy="@firebase/storage",ky="@firebase/storage-compat",Ny="@firebase/firestore",Dy="@firebase/ai",Vy="@firebase/firestore-compat",Oy="firebase",My="12.5.0";const Pa="[DEFAULT]",Ly={[Sa]:"fire-core",[uy]:"fire-core-compat",[hy]:"fire-analytics",[ly]:"fire-analytics-compat",[dy]:"fire-app-check",[fy]:"fire-app-check-compat",[py]:"fire-auth",[my]:"fire-auth-compat",[gy]:"fire-rtdb",[_y]:"fire-data-connect",[yy]:"fire-rtdb-compat",[vy]:"fire-fn",[Ey]:"fire-fn-compat",[Ty]:"fire-iid",[Iy]:"fire-iid-compat",[wy]:"fire-fcm",[Ay]:"fire-fcm-compat",[by]:"fire-perf",[Ry]:"fire-perf-compat",[Sy]:"fire-rc",[Py]:"fire-rc-compat",[Cy]:"fire-gcs",[ky]:"fire-gcs-compat",[Ny]:"fire-fst",[Vy]:"fire-fst-compat",[Dy]:"fire-vertex","fire-js":"fire-js",[Oy]:"fire-js-all"};const Ci=new Map,xy=new Map,Ca=new Map;function Nl(n,e){try{n.container.addComponent(e)}catch(t){Ot.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Bn(n){const e=n.name;if(Ca.has(e))return Ot.debug(`There were multiple attempts to register component ${e}.`),!1;Ca.set(e,n);for(const t of Ci.values())Nl(t,n);for(const t of xy.values())Nl(t,n);return!0}function ao(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function tt(n){return n==null?!1:n.settings!==void 0}const Fy={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},an=new Os("app","Firebase",Fy);class Uy{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new hn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw an.create("app-deleted",{appName:this._name})}}const xr=My;function Zf(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r={name:Pa,automaticDataCollectionEnabled:!0,...e},s=r.name;if(typeof s!="string"||!s)throw an.create("bad-app-name",{appName:String(s)});if(t||(t=Qf()),!t)throw an.create("no-options");const i=Ci.get(s);if(i){if(Un(t,i.options)&&Un(r,i.config))return i;throw an.create("duplicate-app",{appName:s})}const a=new H_(s);for(const l of Ca.values())a.addComponent(l);const c=new Uy(t,r,a);return Ci.set(s,c),c}function Ec(n=Pa){const e=Ci.get(n);if(!e&&n===Pa&&Qf())return Zf();if(!e)throw an.create("no-app",{appName:n});return e}function gt(n,e,t){let r=Ly[n]??n;t&&(r+=`-${t}`);const s=r.match(/\s|\//),i=e.match(/\s|\//);if(s||i){const a=[`Unable to register library "${r}" with version "${e}":`];s&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&i&&a.push("and"),i&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ot.warn(a.join(" "));return}Bn(new hn(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}const By="firebase-heartbeat-database",jy=1,ws="firebase-heartbeat-store";let ca=null;function ed(){return ca||(ca=sy(By,jy,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(ws)}catch(t){console.warn(t)}}}}).catch(n=>{throw an.create("idb-open",{originalErrorMessage:n.message})})),ca}async function $y(n){try{const t=(await ed()).transaction(ws),r=await t.objectStore(ws).get(td(n));return await t.done,r}catch(e){if(e instanceof St)Ot.warn(e.message);else{const t=an.create("idb-get",{originalErrorMessage:e?.message});Ot.warn(t.message)}}}async function Dl(n,e){try{const r=(await ed()).transaction(ws,"readwrite");await r.objectStore(ws).put(e,td(n)),await r.done}catch(t){if(t instanceof St)Ot.warn(t.message);else{const r=an.create("idb-set",{originalErrorMessage:t?.message});Ot.warn(r.message)}}}function td(n){return`${n.name}!${n.options.appId}`}const qy=1024,zy=30;class Hy{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Gy(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=Vl();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(s=>s.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:t}),this._heartbeatsCache.heartbeats.length>zy){const s=Ky(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(s,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Ot.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Vl(),{heartbeatsToSend:t,unsentEntries:r}=Wy(this._heartbeatsCache.heartbeats),s=Pi(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(e){return Ot.warn(e),""}}}function Vl(){return new Date().toISOString().substring(0,10)}function Wy(n,e=qy){const t=[];let r=n.slice();for(const s of n){const i=t.find(a=>a.agent===s.agent);if(i){if(i.dates.push(s.date),Ol(t)>e){i.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),Ol(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class Gy{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return V_()?O_().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await $y(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Dl(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Dl(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function Ol(n){return Pi(JSON.stringify({version:2,heartbeats:n})).length}function Ky(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function Qy(n){Bn(new hn("platform-logger",e=>new ay(e),"PRIVATE")),Bn(new hn("heartbeat",e=>new Hy(e),"PRIVATE")),gt(Sa,kl,n),gt(Sa,kl,"esm2020"),gt("fire-js","")}Qy("");var Xy="firebase",Jy="12.5.0";gt(Xy,Jy,"app");var Ml=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var cn,nd;(function(){var n;function e(I,_){function v(){}v.prototype=_.prototype,I.F=_.prototype,I.prototype=new v,I.prototype.constructor=I,I.D=function(w,T,A){for(var y=Array(arguments.length-2),se=2;se<arguments.length;se++)y[se-2]=arguments[se];return _.prototype[T].apply(w,y)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(I,_,v){v||(v=0);const w=Array(16);if(typeof _=="string")for(var T=0;T<16;++T)w[T]=_.charCodeAt(v++)|_.charCodeAt(v++)<<8|_.charCodeAt(v++)<<16|_.charCodeAt(v++)<<24;else for(T=0;T<16;++T)w[T]=_[v++]|_[v++]<<8|_[v++]<<16|_[v++]<<24;_=I.g[0],v=I.g[1],T=I.g[2];let A=I.g[3],y;y=_+(A^v&(T^A))+w[0]+3614090360&4294967295,_=v+(y<<7&4294967295|y>>>25),y=A+(T^_&(v^T))+w[1]+3905402710&4294967295,A=_+(y<<12&4294967295|y>>>20),y=T+(v^A&(_^v))+w[2]+606105819&4294967295,T=A+(y<<17&4294967295|y>>>15),y=v+(_^T&(A^_))+w[3]+3250441966&4294967295,v=T+(y<<22&4294967295|y>>>10),y=_+(A^v&(T^A))+w[4]+4118548399&4294967295,_=v+(y<<7&4294967295|y>>>25),y=A+(T^_&(v^T))+w[5]+1200080426&4294967295,A=_+(y<<12&4294967295|y>>>20),y=T+(v^A&(_^v))+w[6]+2821735955&4294967295,T=A+(y<<17&4294967295|y>>>15),y=v+(_^T&(A^_))+w[7]+4249261313&4294967295,v=T+(y<<22&4294967295|y>>>10),y=_+(A^v&(T^A))+w[8]+1770035416&4294967295,_=v+(y<<7&4294967295|y>>>25),y=A+(T^_&(v^T))+w[9]+2336552879&4294967295,A=_+(y<<12&4294967295|y>>>20),y=T+(v^A&(_^v))+w[10]+4294925233&4294967295,T=A+(y<<17&4294967295|y>>>15),y=v+(_^T&(A^_))+w[11]+2304563134&4294967295,v=T+(y<<22&4294967295|y>>>10),y=_+(A^v&(T^A))+w[12]+1804603682&4294967295,_=v+(y<<7&4294967295|y>>>25),y=A+(T^_&(v^T))+w[13]+4254626195&4294967295,A=_+(y<<12&4294967295|y>>>20),y=T+(v^A&(_^v))+w[14]+2792965006&4294967295,T=A+(y<<17&4294967295|y>>>15),y=v+(_^T&(A^_))+w[15]+1236535329&4294967295,v=T+(y<<22&4294967295|y>>>10),y=_+(T^A&(v^T))+w[1]+4129170786&4294967295,_=v+(y<<5&4294967295|y>>>27),y=A+(v^T&(_^v))+w[6]+3225465664&4294967295,A=_+(y<<9&4294967295|y>>>23),y=T+(_^v&(A^_))+w[11]+643717713&4294967295,T=A+(y<<14&4294967295|y>>>18),y=v+(A^_&(T^A))+w[0]+3921069994&4294967295,v=T+(y<<20&4294967295|y>>>12),y=_+(T^A&(v^T))+w[5]+3593408605&4294967295,_=v+(y<<5&4294967295|y>>>27),y=A+(v^T&(_^v))+w[10]+38016083&4294967295,A=_+(y<<9&4294967295|y>>>23),y=T+(_^v&(A^_))+w[15]+3634488961&4294967295,T=A+(y<<14&4294967295|y>>>18),y=v+(A^_&(T^A))+w[4]+3889429448&4294967295,v=T+(y<<20&4294967295|y>>>12),y=_+(T^A&(v^T))+w[9]+568446438&4294967295,_=v+(y<<5&4294967295|y>>>27),y=A+(v^T&(_^v))+w[14]+3275163606&4294967295,A=_+(y<<9&4294967295|y>>>23),y=T+(_^v&(A^_))+w[3]+4107603335&4294967295,T=A+(y<<14&4294967295|y>>>18),y=v+(A^_&(T^A))+w[8]+1163531501&4294967295,v=T+(y<<20&4294967295|y>>>12),y=_+(T^A&(v^T))+w[13]+2850285829&4294967295,_=v+(y<<5&4294967295|y>>>27),y=A+(v^T&(_^v))+w[2]+4243563512&4294967295,A=_+(y<<9&4294967295|y>>>23),y=T+(_^v&(A^_))+w[7]+1735328473&4294967295,T=A+(y<<14&4294967295|y>>>18),y=v+(A^_&(T^A))+w[12]+2368359562&4294967295,v=T+(y<<20&4294967295|y>>>12),y=_+(v^T^A)+w[5]+4294588738&4294967295,_=v+(y<<4&4294967295|y>>>28),y=A+(_^v^T)+w[8]+2272392833&4294967295,A=_+(y<<11&4294967295|y>>>21),y=T+(A^_^v)+w[11]+1839030562&4294967295,T=A+(y<<16&4294967295|y>>>16),y=v+(T^A^_)+w[14]+4259657740&4294967295,v=T+(y<<23&4294967295|y>>>9),y=_+(v^T^A)+w[1]+2763975236&4294967295,_=v+(y<<4&4294967295|y>>>28),y=A+(_^v^T)+w[4]+1272893353&4294967295,A=_+(y<<11&4294967295|y>>>21),y=T+(A^_^v)+w[7]+4139469664&4294967295,T=A+(y<<16&4294967295|y>>>16),y=v+(T^A^_)+w[10]+3200236656&4294967295,v=T+(y<<23&4294967295|y>>>9),y=_+(v^T^A)+w[13]+681279174&4294967295,_=v+(y<<4&4294967295|y>>>28),y=A+(_^v^T)+w[0]+3936430074&4294967295,A=_+(y<<11&4294967295|y>>>21),y=T+(A^_^v)+w[3]+3572445317&4294967295,T=A+(y<<16&4294967295|y>>>16),y=v+(T^A^_)+w[6]+76029189&4294967295,v=T+(y<<23&4294967295|y>>>9),y=_+(v^T^A)+w[9]+3654602809&4294967295,_=v+(y<<4&4294967295|y>>>28),y=A+(_^v^T)+w[12]+3873151461&4294967295,A=_+(y<<11&4294967295|y>>>21),y=T+(A^_^v)+w[15]+530742520&4294967295,T=A+(y<<16&4294967295|y>>>16),y=v+(T^A^_)+w[2]+3299628645&4294967295,v=T+(y<<23&4294967295|y>>>9),y=_+(T^(v|~A))+w[0]+4096336452&4294967295,_=v+(y<<6&4294967295|y>>>26),y=A+(v^(_|~T))+w[7]+1126891415&4294967295,A=_+(y<<10&4294967295|y>>>22),y=T+(_^(A|~v))+w[14]+2878612391&4294967295,T=A+(y<<15&4294967295|y>>>17),y=v+(A^(T|~_))+w[5]+4237533241&4294967295,v=T+(y<<21&4294967295|y>>>11),y=_+(T^(v|~A))+w[12]+1700485571&4294967295,_=v+(y<<6&4294967295|y>>>26),y=A+(v^(_|~T))+w[3]+2399980690&4294967295,A=_+(y<<10&4294967295|y>>>22),y=T+(_^(A|~v))+w[10]+4293915773&4294967295,T=A+(y<<15&4294967295|y>>>17),y=v+(A^(T|~_))+w[1]+2240044497&4294967295,v=T+(y<<21&4294967295|y>>>11),y=_+(T^(v|~A))+w[8]+1873313359&4294967295,_=v+(y<<6&4294967295|y>>>26),y=A+(v^(_|~T))+w[15]+4264355552&4294967295,A=_+(y<<10&4294967295|y>>>22),y=T+(_^(A|~v))+w[6]+2734768916&4294967295,T=A+(y<<15&4294967295|y>>>17),y=v+(A^(T|~_))+w[13]+1309151649&4294967295,v=T+(y<<21&4294967295|y>>>11),y=_+(T^(v|~A))+w[4]+4149444226&4294967295,_=v+(y<<6&4294967295|y>>>26),y=A+(v^(_|~T))+w[11]+3174756917&4294967295,A=_+(y<<10&4294967295|y>>>22),y=T+(_^(A|~v))+w[2]+718787259&4294967295,T=A+(y<<15&4294967295|y>>>17),y=v+(A^(T|~_))+w[9]+3951481745&4294967295,I.g[0]=I.g[0]+_&4294967295,I.g[1]=I.g[1]+(T+(y<<21&4294967295|y>>>11))&4294967295,I.g[2]=I.g[2]+T&4294967295,I.g[3]=I.g[3]+A&4294967295}r.prototype.v=function(I,_){_===void 0&&(_=I.length);const v=_-this.blockSize,w=this.C;let T=this.h,A=0;for(;A<_;){if(T==0)for(;A<=v;)s(this,I,A),A+=this.blockSize;if(typeof I=="string"){for(;A<_;)if(w[T++]=I.charCodeAt(A++),T==this.blockSize){s(this,w),T=0;break}}else for(;A<_;)if(w[T++]=I[A++],T==this.blockSize){s(this,w),T=0;break}}this.h=T,this.o+=_},r.prototype.A=function(){var I=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);I[0]=128;for(var _=1;_<I.length-8;++_)I[_]=0;_=this.o*8;for(var v=I.length-8;v<I.length;++v)I[v]=_&255,_/=256;for(this.v(I),I=Array(16),_=0,v=0;v<4;++v)for(let w=0;w<32;w+=8)I[_++]=this.g[v]>>>w&255;return I};function i(I,_){var v=c;return Object.prototype.hasOwnProperty.call(v,I)?v[I]:v[I]=_(I)}function a(I,_){this.h=_;const v=[];let w=!0;for(let T=I.length-1;T>=0;T--){const A=I[T]|0;w&&A==_||(v[T]=A,w=!1)}this.g=v}var c={};function l(I){return-128<=I&&I<128?i(I,function(_){return new a([_|0],_<0?-1:0)}):new a([I|0],I<0?-1:0)}function h(I){if(isNaN(I)||!isFinite(I))return g;if(I<0)return P(h(-I));const _=[];let v=1;for(let w=0;I>=v;w++)_[w]=I/v|0,v*=4294967296;return new a(_,0)}function d(I,_){if(I.length==0)throw Error("number format error: empty string");if(_=_||10,_<2||36<_)throw Error("radix out of range: "+_);if(I.charAt(0)=="-")return P(d(I.substring(1),_));if(I.indexOf("-")>=0)throw Error('number format error: interior "-" character');const v=h(Math.pow(_,8));let w=g;for(let A=0;A<I.length;A+=8){var T=Math.min(8,I.length-A);const y=parseInt(I.substring(A,A+T),_);T<8?(T=h(Math.pow(_,T)),w=w.j(T).add(h(y))):(w=w.j(v),w=w.add(h(y)))}return w}var g=l(0),m=l(1),E=l(16777216);n=a.prototype,n.m=function(){if(C(this))return-P(this).m();let I=0,_=1;for(let v=0;v<this.g.length;v++){const w=this.i(v);I+=(w>=0?w:4294967296+w)*_,_*=4294967296}return I},n.toString=function(I){if(I=I||10,I<2||36<I)throw Error("radix out of range: "+I);if(S(this))return"0";if(C(this))return"-"+P(this).toString(I);const _=h(Math.pow(I,6));var v=this;let w="";for(;;){const T=q(v,_).g;v=L(v,T.j(_));let A=((v.g.length>0?v.g[0]:v.h)>>>0).toString(I);if(v=T,S(v))return A+w;for(;A.length<6;)A="0"+A;w=A+w}},n.i=function(I){return I<0?0:I<this.g.length?this.g[I]:this.h};function S(I){if(I.h!=0)return!1;for(let _=0;_<I.g.length;_++)if(I.g[_]!=0)return!1;return!0}function C(I){return I.h==-1}n.l=function(I){return I=L(this,I),C(I)?-1:S(I)?0:1};function P(I){const _=I.g.length,v=[];for(let w=0;w<_;w++)v[w]=~I.g[w];return new a(v,~I.h).add(m)}n.abs=function(){return C(this)?P(this):this},n.add=function(I){const _=Math.max(this.g.length,I.g.length),v=[];let w=0;for(let T=0;T<=_;T++){let A=w+(this.i(T)&65535)+(I.i(T)&65535),y=(A>>>16)+(this.i(T)>>>16)+(I.i(T)>>>16);w=y>>>16,A&=65535,y&=65535,v[T]=y<<16|A}return new a(v,v[v.length-1]&-2147483648?-1:0)};function L(I,_){return I.add(P(_))}n.j=function(I){if(S(this)||S(I))return g;if(C(this))return C(I)?P(this).j(P(I)):P(P(this).j(I));if(C(I))return P(this.j(P(I)));if(this.l(E)<0&&I.l(E)<0)return h(this.m()*I.m());const _=this.g.length+I.g.length,v=[];for(var w=0;w<2*_;w++)v[w]=0;for(w=0;w<this.g.length;w++)for(let T=0;T<I.g.length;T++){const A=this.i(w)>>>16,y=this.i(w)&65535,se=I.i(T)>>>16,be=I.i(T)&65535;v[2*w+2*T]+=y*be,O(v,2*w+2*T),v[2*w+2*T+1]+=A*be,O(v,2*w+2*T+1),v[2*w+2*T+1]+=y*se,O(v,2*w+2*T+1),v[2*w+2*T+2]+=A*se,O(v,2*w+2*T+2)}for(I=0;I<_;I++)v[I]=v[2*I+1]<<16|v[2*I];for(I=_;I<2*_;I++)v[I]=0;return new a(v,0)};function O(I,_){for(;(I[_]&65535)!=I[_];)I[_+1]+=I[_]>>>16,I[_]&=65535,_++}function V(I,_){this.g=I,this.h=_}function q(I,_){if(S(_))throw Error("division by zero");if(S(I))return new V(g,g);if(C(I))return _=q(P(I),_),new V(P(_.g),P(_.h));if(C(_))return _=q(I,P(_)),new V(P(_.g),_.h);if(I.g.length>30){if(C(I)||C(_))throw Error("slowDivide_ only works with positive integers.");for(var v=m,w=_;w.l(I)<=0;)v=Y(v),w=Y(w);var T=Z(v,1),A=Z(w,1);for(w=Z(w,2),v=Z(v,2);!S(w);){var y=A.add(w);y.l(I)<=0&&(T=T.add(v),A=y),w=Z(w,1),v=Z(v,1)}return _=L(I,T.j(_)),new V(T,_)}for(T=g;I.l(_)>=0;){for(v=Math.max(1,Math.floor(I.m()/_.m())),w=Math.ceil(Math.log(v)/Math.LN2),w=w<=48?1:Math.pow(2,w-48),A=h(v),y=A.j(_);C(y)||y.l(I)>0;)v-=w,A=h(v),y=A.j(_);S(A)&&(A=m),T=T.add(A),I=L(I,y)}return new V(T,I)}n.B=function(I){return q(this,I).h},n.and=function(I){const _=Math.max(this.g.length,I.g.length),v=[];for(let w=0;w<_;w++)v[w]=this.i(w)&I.i(w);return new a(v,this.h&I.h)},n.or=function(I){const _=Math.max(this.g.length,I.g.length),v=[];for(let w=0;w<_;w++)v[w]=this.i(w)|I.i(w);return new a(v,this.h|I.h)},n.xor=function(I){const _=Math.max(this.g.length,I.g.length),v=[];for(let w=0;w<_;w++)v[w]=this.i(w)^I.i(w);return new a(v,this.h^I.h)};function Y(I){const _=I.g.length+1,v=[];for(let w=0;w<_;w++)v[w]=I.i(w)<<1|I.i(w-1)>>>31;return new a(v,I.h)}function Z(I,_){const v=_>>5;_%=32;const w=I.g.length-v,T=[];for(let A=0;A<w;A++)T[A]=_>0?I.i(A+v)>>>_|I.i(A+v+1)<<32-_:I.i(A+v);return new a(T,I.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,nd=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.B,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=h,a.fromString=d,cn=a}).apply(typeof Ml<"u"?Ml:typeof self<"u"?self:typeof window<"u"?window:{});var oi=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var rd,cs,sd,pi,ka,id,od,ad;(function(){var n,e=Object.defineProperty;function t(o){o=[typeof globalThis=="object"&&globalThis,o,typeof window=="object"&&window,typeof self=="object"&&self,typeof oi=="object"&&oi];for(var u=0;u<o.length;++u){var f=o[u];if(f&&f.Math==Math)return f}throw Error("Cannot find global object")}var r=t(this);function s(o,u){if(u)e:{var f=r;o=o.split(".");for(var p=0;p<o.length-1;p++){var b=o[p];if(!(b in f))break e;f=f[b]}o=o[o.length-1],p=f[o],u=u(p),u!=p&&u!=null&&e(f,o,{configurable:!0,writable:!0,value:u})}}s("Symbol.dispose",function(o){return o||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(o){return o||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(o){return o||function(u){var f=[],p;for(p in u)Object.prototype.hasOwnProperty.call(u,p)&&f.push([p,u[p]]);return f}});var i=i||{},a=this||self;function c(o){var u=typeof o;return u=="object"&&o!=null||u=="function"}function l(o,u,f){return o.call.apply(o.bind,arguments)}function h(o,u,f){return h=l,h.apply(null,arguments)}function d(o,u){var f=Array.prototype.slice.call(arguments,1);return function(){var p=f.slice();return p.push.apply(p,arguments),o.apply(this,p)}}function g(o,u){function f(){}f.prototype=u.prototype,o.Z=u.prototype,o.prototype=new f,o.prototype.constructor=o,o.Ob=function(p,b,R){for(var D=Array(arguments.length-2),H=2;H<arguments.length;H++)D[H-2]=arguments[H];return u.prototype[b].apply(p,D)}}var m=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?o=>o&&AsyncContext.Snapshot.wrap(o):o=>o;function E(o){const u=o.length;if(u>0){const f=Array(u);for(let p=0;p<u;p++)f[p]=o[p];return f}return[]}function S(o,u){for(let p=1;p<arguments.length;p++){const b=arguments[p];var f=typeof b;if(f=f!="object"?f:b?Array.isArray(b)?"array":f:"null",f=="array"||f=="object"&&typeof b.length=="number"){f=o.length||0;const R=b.length||0;o.length=f+R;for(let D=0;D<R;D++)o[f+D]=b[D]}else o.push(b)}}class C{constructor(u,f){this.i=u,this.j=f,this.h=0,this.g=null}get(){let u;return this.h>0?(this.h--,u=this.g,this.g=u.next,u.next=null):u=this.i(),u}}function P(o){a.setTimeout(()=>{throw o},0)}function L(){var o=I;let u=null;return o.g&&(u=o.g,o.g=o.g.next,o.g||(o.h=null),u.next=null),u}class O{constructor(){this.h=this.g=null}add(u,f){const p=V.get();p.set(u,f),this.h?this.h.next=p:this.g=p,this.h=p}}var V=new C(()=>new q,o=>o.reset());class q{constructor(){this.next=this.g=this.h=null}set(u,f){this.h=u,this.g=f,this.next=null}reset(){this.next=this.g=this.h=null}}let Y,Z=!1,I=new O,_=()=>{const o=Promise.resolve(void 0);Y=()=>{o.then(v)}};function v(){for(var o;o=L();){try{o.h.call(o.g)}catch(f){P(f)}var u=V;u.j(o),u.h<100&&(u.h++,o.next=u.g,u.g=o)}Z=!1}function w(){this.u=this.u,this.C=this.C}w.prototype.u=!1,w.prototype.dispose=function(){this.u||(this.u=!0,this.N())},w.prototype[Symbol.dispose]=function(){this.dispose()},w.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function T(o,u){this.type=o,this.g=this.target=u,this.defaultPrevented=!1}T.prototype.h=function(){this.defaultPrevented=!0};var A=(function(){if(!a.addEventListener||!Object.defineProperty)return!1;var o=!1,u=Object.defineProperty({},"passive",{get:function(){o=!0}});try{const f=()=>{};a.addEventListener("test",f,u),a.removeEventListener("test",f,u)}catch{}return o})();function y(o){return/^[\s\xa0]*$/.test(o)}function se(o,u){T.call(this,o?o.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,o&&this.init(o,u)}g(se,T),se.prototype.init=function(o,u){const f=this.type=o.type,p=o.changedTouches&&o.changedTouches.length?o.changedTouches[0]:null;this.target=o.target||o.srcElement,this.g=u,u=o.relatedTarget,u||(f=="mouseover"?u=o.fromElement:f=="mouseout"&&(u=o.toElement)),this.relatedTarget=u,p?(this.clientX=p.clientX!==void 0?p.clientX:p.pageX,this.clientY=p.clientY!==void 0?p.clientY:p.pageY,this.screenX=p.screenX||0,this.screenY=p.screenY||0):(this.clientX=o.clientX!==void 0?o.clientX:o.pageX,this.clientY=o.clientY!==void 0?o.clientY:o.pageY,this.screenX=o.screenX||0,this.screenY=o.screenY||0),this.button=o.button,this.key=o.key||"",this.ctrlKey=o.ctrlKey,this.altKey=o.altKey,this.shiftKey=o.shiftKey,this.metaKey=o.metaKey,this.pointerId=o.pointerId||0,this.pointerType=o.pointerType,this.state=o.state,this.i=o,o.defaultPrevented&&se.Z.h.call(this)},se.prototype.h=function(){se.Z.h.call(this);const o=this.i;o.preventDefault?o.preventDefault():o.returnValue=!1};var be="closure_listenable_"+(Math.random()*1e6|0),qr=0;function qt(o,u,f,p,b){this.listener=o,this.proxy=null,this.src=u,this.type=f,this.capture=!!p,this.ha=b,this.key=++qr,this.da=this.fa=!1}function Pt(o){o.da=!0,o.listener=null,o.proxy=null,o.src=null,o.ha=null}function In(o,u,f){for(const p in o)u.call(f,o[p],p,o)}function zr(o,u){for(const f in o)u.call(void 0,o[f],f,o)}function Qn(o){const u={};for(const f in o)u[f]=o[f];return u}const zs="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ko(o,u){let f,p;for(let b=1;b<arguments.length;b++){p=arguments[b];for(f in p)o[f]=p[f];for(let R=0;R<zs.length;R++)f=zs[R],Object.prototype.hasOwnProperty.call(p,f)&&(o[f]=p[f])}}function Hs(o){this.src=o,this.g={},this.h=0}Hs.prototype.add=function(o,u,f,p,b){const R=o.toString();o=this.g[R],o||(o=this.g[R]=[],this.h++);const D=Do(o,u,p,b);return D>-1?(u=o[D],f||(u.fa=!1)):(u=new qt(u,this.src,R,!!p,b),u.fa=f,o.push(u)),u};function No(o,u){const f=u.type;if(f in o.g){var p=o.g[f],b=Array.prototype.indexOf.call(p,u,void 0),R;(R=b>=0)&&Array.prototype.splice.call(p,b,1),R&&(Pt(u),o.g[f].length==0&&(delete o.g[f],o.h--))}}function Do(o,u,f,p){for(let b=0;b<o.length;++b){const R=o[b];if(!R.da&&R.listener==u&&R.capture==!!f&&R.ha==p)return b}return-1}var Vo="closure_lm_"+(Math.random()*1e6|0),Oo={};function du(o,u,f,p,b){if(Array.isArray(u)){for(let R=0;R<u.length;R++)du(o,u[R],f,p,b);return null}return f=gu(f),o&&o[be]?o.J(u,f,c(p)?!!p.capture:!1,b):lm(o,u,f,!1,p,b)}function lm(o,u,f,p,b,R){if(!u)throw Error("Invalid event type");const D=c(b)?!!b.capture:!!b;let H=Lo(o);if(H||(o[Vo]=H=new Hs(o)),f=H.add(u,f,p,D,R),f.proxy)return f;if(p=hm(),f.proxy=p,p.src=o,p.listener=f,o.addEventListener)A||(b=D),b===void 0&&(b=!1),o.addEventListener(u.toString(),p,b);else if(o.attachEvent)o.attachEvent(mu(u.toString()),p);else if(o.addListener&&o.removeListener)o.addListener(p);else throw Error("addEventListener and attachEvent are unavailable.");return f}function hm(){function o(f){return u.call(o.src,o.listener,f)}const u=fm;return o}function pu(o,u,f,p,b){if(Array.isArray(u))for(var R=0;R<u.length;R++)pu(o,u[R],f,p,b);else p=c(p)?!!p.capture:!!p,f=gu(f),o&&o[be]?(o=o.i,R=String(u).toString(),R in o.g&&(u=o.g[R],f=Do(u,f,p,b),f>-1&&(Pt(u[f]),Array.prototype.splice.call(u,f,1),u.length==0&&(delete o.g[R],o.h--)))):o&&(o=Lo(o))&&(u=o.g[u.toString()],o=-1,u&&(o=Do(u,f,p,b)),(f=o>-1?u[o]:null)&&Mo(f))}function Mo(o){if(typeof o!="number"&&o&&!o.da){var u=o.src;if(u&&u[be])No(u.i,o);else{var f=o.type,p=o.proxy;u.removeEventListener?u.removeEventListener(f,p,o.capture):u.detachEvent?u.detachEvent(mu(f),p):u.addListener&&u.removeListener&&u.removeListener(p),(f=Lo(u))?(No(f,o),f.h==0&&(f.src=null,u[Vo]=null)):Pt(o)}}}function mu(o){return o in Oo?Oo[o]:Oo[o]="on"+o}function fm(o,u){if(o.da)o=!0;else{u=new se(u,this);const f=o.listener,p=o.ha||o.src;o.fa&&Mo(o),o=f.call(p,u)}return o}function Lo(o){return o=o[Vo],o instanceof Hs?o:null}var xo="__closure_events_fn_"+(Math.random()*1e9>>>0);function gu(o){return typeof o=="function"?o:(o[xo]||(o[xo]=function(u){return o.handleEvent(u)}),o[xo])}function De(){w.call(this),this.i=new Hs(this),this.M=this,this.G=null}g(De,w),De.prototype[be]=!0,De.prototype.removeEventListener=function(o,u,f,p){pu(this,o,u,f,p)};function Ue(o,u){var f,p=o.G;if(p)for(f=[];p;p=p.G)f.push(p);if(o=o.M,p=u.type||u,typeof u=="string")u=new T(u,o);else if(u instanceof T)u.target=u.target||o;else{var b=u;u=new T(p,o),ko(u,b)}b=!0;let R,D;if(f)for(D=f.length-1;D>=0;D--)R=u.g=f[D],b=Ws(R,p,!0,u)&&b;if(R=u.g=o,b=Ws(R,p,!0,u)&&b,b=Ws(R,p,!1,u)&&b,f)for(D=0;D<f.length;D++)R=u.g=f[D],b=Ws(R,p,!1,u)&&b}De.prototype.N=function(){if(De.Z.N.call(this),this.i){var o=this.i;for(const u in o.g){const f=o.g[u];for(let p=0;p<f.length;p++)Pt(f[p]);delete o.g[u],o.h--}}this.G=null},De.prototype.J=function(o,u,f,p){return this.i.add(String(o),u,!1,f,p)},De.prototype.K=function(o,u,f,p){return this.i.add(String(o),u,!0,f,p)};function Ws(o,u,f,p){if(u=o.i.g[String(u)],!u)return!0;u=u.concat();let b=!0;for(let R=0;R<u.length;++R){const D=u[R];if(D&&!D.da&&D.capture==f){const H=D.listener,_e=D.ha||D.src;D.fa&&No(o.i,D),b=H.call(_e,p)!==!1&&b}}return b&&!p.defaultPrevented}function dm(o,u){if(typeof o!="function")if(o&&typeof o.handleEvent=="function")o=h(o.handleEvent,o);else throw Error("Invalid listener argument");return Number(u)>2147483647?-1:a.setTimeout(o,u||0)}function _u(o){o.g=dm(()=>{o.g=null,o.i&&(o.i=!1,_u(o))},o.l);const u=o.h;o.h=null,o.m.apply(null,u)}class pm extends w{constructor(u,f){super(),this.m=u,this.l=f,this.h=null,this.i=!1,this.g=null}j(u){this.h=arguments,this.g?this.i=!0:_u(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Hr(o){w.call(this),this.h=o,this.g={}}g(Hr,w);var yu=[];function vu(o){In(o.g,function(u,f){this.g.hasOwnProperty(f)&&Mo(u)},o),o.g={}}Hr.prototype.N=function(){Hr.Z.N.call(this),vu(this)},Hr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Fo=a.JSON.stringify,mm=a.JSON.parse,gm=class{stringify(o){return a.JSON.stringify(o,void 0)}parse(o){return a.JSON.parse(o,void 0)}};function Eu(){}function Tu(){}var Wr={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Uo(){T.call(this,"d")}g(Uo,T);function Bo(){T.call(this,"c")}g(Bo,T);var wn={},Iu=null;function Gs(){return Iu=Iu||new De}wn.Ia="serverreachability";function wu(o){T.call(this,wn.Ia,o)}g(wu,T);function Gr(o){const u=Gs();Ue(u,new wu(u))}wn.STAT_EVENT="statevent";function Au(o,u){T.call(this,wn.STAT_EVENT,o),this.stat=u}g(Au,T);function Be(o){const u=Gs();Ue(u,new Au(u,o))}wn.Ja="timingevent";function bu(o,u){T.call(this,wn.Ja,o),this.size=u}g(bu,T);function Kr(o,u){if(typeof o!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){o()},u)}function Qr(){this.g=!0}Qr.prototype.ua=function(){this.g=!1};function _m(o,u,f,p,b,R){o.info(function(){if(o.g)if(R){var D="",H=R.split("&");for(let ne=0;ne<H.length;ne++){var _e=H[ne].split("=");if(_e.length>1){const we=_e[0];_e=_e[1];const ut=we.split("_");D=ut.length>=2&&ut[1]=="type"?D+(we+"="+_e+"&"):D+(we+"=redacted&")}}}else D=null;else D=R;return"XMLHTTP REQ ("+p+") [attempt "+b+"]: "+u+`
`+f+`
`+D})}function ym(o,u,f,p,b,R,D){o.info(function(){return"XMLHTTP RESP ("+p+") [ attempt "+b+"]: "+u+`
`+f+`
`+R+" "+D})}function Xn(o,u,f,p){o.info(function(){return"XMLHTTP TEXT ("+u+"): "+Em(o,f)+(p?" "+p:"")})}function vm(o,u){o.info(function(){return"TIMEOUT: "+u})}Qr.prototype.info=function(){};function Em(o,u){if(!o.g)return u;if(!u)return null;try{const R=JSON.parse(u);if(R){for(o=0;o<R.length;o++)if(Array.isArray(R[o])){var f=R[o];if(!(f.length<2)){var p=f[1];if(Array.isArray(p)&&!(p.length<1)){var b=p[0];if(b!="noop"&&b!="stop"&&b!="close")for(let D=1;D<p.length;D++)p[D]=""}}}}return Fo(R)}catch{return u}}var Ks={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Ru={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Su;function jo(){}g(jo,Eu),jo.prototype.g=function(){return new XMLHttpRequest},Su=new jo;function Xr(o){return encodeURIComponent(String(o))}function Tm(o){var u=1;o=o.split(":");const f=[];for(;u>0&&o.length;)f.push(o.shift()),u--;return o.length&&f.push(o.join(":")),f}function zt(o,u,f,p){this.j=o,this.i=u,this.l=f,this.S=p||1,this.V=new Hr(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Pu}function Pu(){this.i=null,this.g="",this.h=!1}var Cu={},$o={};function qo(o,u,f){o.M=1,o.A=Xs(ct(u)),o.u=f,o.R=!0,ku(o,null)}function ku(o,u){o.F=Date.now(),Qs(o),o.B=ct(o.A);var f=o.B,p=o.S;Array.isArray(p)||(p=[String(p)]),qu(f.i,"t",p),o.C=0,f=o.j.L,o.h=new Pu,o.g=al(o.j,f?u:null,!o.u),o.P>0&&(o.O=new pm(h(o.Y,o,o.g),o.P)),u=o.V,f=o.g,p=o.ba;var b="readystatechange";Array.isArray(b)||(b&&(yu[0]=b.toString()),b=yu);for(let R=0;R<b.length;R++){const D=du(f,b[R],p||u.handleEvent,!1,u.h||u);if(!D)break;u.g[D.key]=D}u=o.J?Qn(o.J):{},o.u?(o.v||(o.v="POST"),u["Content-Type"]="application/x-www-form-urlencoded",o.g.ea(o.B,o.v,o.u,u)):(o.v="GET",o.g.ea(o.B,o.v,null,u)),Gr(),_m(o.i,o.v,o.B,o.l,o.S,o.u)}zt.prototype.ba=function(o){o=o.target;const u=this.O;u&&Gt(o)==3?u.j():this.Y(o)},zt.prototype.Y=function(o){try{if(o==this.g)e:{const H=Gt(this.g),_e=this.g.ya(),ne=this.g.ca();if(!(H<3)&&(H!=3||this.g&&(this.h.h||this.g.la()||Xu(this.g)))){this.K||H!=4||_e==7||(_e==8||ne<=0?Gr(3):Gr(2)),zo(this);var u=this.g.ca();this.X=u;var f=Im(this);if(this.o=u==200,ym(this.i,this.v,this.B,this.l,this.S,H,u),this.o){if(this.U&&!this.L){t:{if(this.g){var p,b=this.g;if((p=b.g?b.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!y(p)){var R=p;break t}}R=null}if(o=R)Xn(this.i,this.l,o,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Ho(this,o);else{this.o=!1,this.m=3,Be(12),An(this),Jr(this);break e}}if(this.R){o=!0;let we;for(;!this.K&&this.C<f.length;)if(we=wm(this,f),we==$o){H==4&&(this.m=4,Be(14),o=!1),Xn(this.i,this.l,null,"[Incomplete Response]");break}else if(we==Cu){this.m=4,Be(15),Xn(this.i,this.l,f,"[Invalid Chunk]"),o=!1;break}else Xn(this.i,this.l,we,null),Ho(this,we);if(Nu(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),H!=4||f.length!=0||this.h.h||(this.m=1,Be(16),o=!1),this.o=this.o&&o,!o)Xn(this.i,this.l,f,"[Invalid Chunked Response]"),An(this),Jr(this);else if(f.length>0&&!this.W){this.W=!0;var D=this.j;D.g==this&&D.aa&&!D.P&&(D.j.info("Great, no buffering proxy detected. Bytes received: "+f.length),Zo(D),D.P=!0,Be(11))}}else Xn(this.i,this.l,f,null),Ho(this,f);H==4&&An(this),this.o&&!this.K&&(H==4?rl(this.j,this):(this.o=!1,Qs(this)))}else xm(this.g),u==400&&f.indexOf("Unknown SID")>0?(this.m=3,Be(12)):(this.m=0,Be(13)),An(this),Jr(this)}}}catch{}finally{}};function Im(o){if(!Nu(o))return o.g.la();const u=Xu(o.g);if(u==="")return"";let f="";const p=u.length,b=Gt(o.g)==4;if(!o.h.i){if(typeof TextDecoder>"u")return An(o),Jr(o),"";o.h.i=new a.TextDecoder}for(let R=0;R<p;R++)o.h.h=!0,f+=o.h.i.decode(u[R],{stream:!(b&&R==p-1)});return u.length=0,o.h.g+=f,o.C=0,o.h.g}function Nu(o){return o.g?o.v=="GET"&&o.M!=2&&o.j.Aa:!1}function wm(o,u){var f=o.C,p=u.indexOf(`
`,f);return p==-1?$o:(f=Number(u.substring(f,p)),isNaN(f)?Cu:(p+=1,p+f>u.length?$o:(u=u.slice(p,p+f),o.C=p+f,u)))}zt.prototype.cancel=function(){this.K=!0,An(this)};function Qs(o){o.T=Date.now()+o.H,Du(o,o.H)}function Du(o,u){if(o.D!=null)throw Error("WatchDog timer not null");o.D=Kr(h(o.aa,o),u)}function zo(o){o.D&&(a.clearTimeout(o.D),o.D=null)}zt.prototype.aa=function(){this.D=null;const o=Date.now();o-this.T>=0?(vm(this.i,this.B),this.M!=2&&(Gr(),Be(17)),An(this),this.m=2,Jr(this)):Du(this,this.T-o)};function Jr(o){o.j.I==0||o.K||rl(o.j,o)}function An(o){zo(o);var u=o.O;u&&typeof u.dispose=="function"&&u.dispose(),o.O=null,vu(o.V),o.g&&(u=o.g,o.g=null,u.abort(),u.dispose())}function Ho(o,u){try{var f=o.j;if(f.I!=0&&(f.g==o||Wo(f.h,o))){if(!o.L&&Wo(f.h,o)&&f.I==3){try{var p=f.Ba.g.parse(u)}catch{p=null}if(Array.isArray(p)&&p.length==3){var b=p;if(b[0]==0){e:if(!f.v){if(f.g)if(f.g.F+3e3<o.F)ti(f),Zs(f);else break e;Yo(f),Be(18)}}else f.xa=b[1],0<f.xa-f.K&&b[2]<37500&&f.F&&f.A==0&&!f.C&&(f.C=Kr(h(f.Va,f),6e3));Mu(f.h)<=1&&f.ta&&(f.ta=void 0)}else Rn(f,11)}else if((o.L||f.g==o)&&ti(f),!y(u))for(b=f.Ba.g.parse(u),u=0;u<b.length;u++){let ne=b[u];const we=ne[0];if(!(we<=f.K))if(f.K=we,ne=ne[1],f.I==2)if(ne[0]=="c"){f.M=ne[1],f.ba=ne[2];const ut=ne[3];ut!=null&&(f.ka=ut,f.j.info("VER="+f.ka));const Sn=ne[4];Sn!=null&&(f.za=Sn,f.j.info("SVER="+f.za));const Kt=ne[5];Kt!=null&&typeof Kt=="number"&&Kt>0&&(p=1.5*Kt,f.O=p,f.j.info("backChannelRequestTimeoutMs_="+p)),p=f;const Qt=o.g;if(Qt){const ri=Qt.g?Qt.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ri){var R=p.h;R.g||ri.indexOf("spdy")==-1&&ri.indexOf("quic")==-1&&ri.indexOf("h2")==-1||(R.j=R.l,R.g=new Set,R.h&&(Go(R,R.h),R.h=null))}if(p.G){const ea=Qt.g?Qt.g.getResponseHeader("X-HTTP-Session-Id"):null;ea&&(p.wa=ea,ie(p.J,p.G,ea))}}f.I=3,f.l&&f.l.ra(),f.aa&&(f.T=Date.now()-o.F,f.j.info("Handshake RTT: "+f.T+"ms")),p=f;var D=o;if(p.na=ol(p,p.L?p.ba:null,p.W),D.L){Lu(p.h,D);var H=D,_e=p.O;_e&&(H.H=_e),H.D&&(zo(H),Qs(H)),p.g=D}else tl(p);f.i.length>0&&ei(f)}else ne[0]!="stop"&&ne[0]!="close"||Rn(f,7);else f.I==3&&(ne[0]=="stop"||ne[0]=="close"?ne[0]=="stop"?Rn(f,7):Jo(f):ne[0]!="noop"&&f.l&&f.l.qa(ne),f.A=0)}}Gr(4)}catch{}}var Am=class{constructor(o,u){this.g=o,this.map=u}};function Vu(o){this.l=o||10,a.PerformanceNavigationTiming?(o=a.performance.getEntriesByType("navigation"),o=o.length>0&&(o[0].nextHopProtocol=="hq"||o[0].nextHopProtocol=="h2")):o=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=o?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Ou(o){return o.h?!0:o.g?o.g.size>=o.j:!1}function Mu(o){return o.h?1:o.g?o.g.size:0}function Wo(o,u){return o.h?o.h==u:o.g?o.g.has(u):!1}function Go(o,u){o.g?o.g.add(u):o.h=u}function Lu(o,u){o.h&&o.h==u?o.h=null:o.g&&o.g.has(u)&&o.g.delete(u)}Vu.prototype.cancel=function(){if(this.i=xu(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const o of this.g.values())o.cancel();this.g.clear()}};function xu(o){if(o.h!=null)return o.i.concat(o.h.G);if(o.g!=null&&o.g.size!==0){let u=o.i;for(const f of o.g.values())u=u.concat(f.G);return u}return E(o.i)}var Fu=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function bm(o,u){if(o){o=o.split("&");for(let f=0;f<o.length;f++){const p=o[f].indexOf("=");let b,R=null;p>=0?(b=o[f].substring(0,p),R=o[f].substring(p+1)):b=o[f],u(b,R?decodeURIComponent(R.replace(/\+/g," ")):"")}}}function Ht(o){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let u;o instanceof Ht?(this.l=o.l,Yr(this,o.j),this.o=o.o,this.g=o.g,Zr(this,o.u),this.h=o.h,Ko(this,zu(o.i)),this.m=o.m):o&&(u=String(o).match(Fu))?(this.l=!1,Yr(this,u[1]||"",!0),this.o=es(u[2]||""),this.g=es(u[3]||"",!0),Zr(this,u[4]),this.h=es(u[5]||"",!0),Ko(this,u[6]||"",!0),this.m=es(u[7]||"")):(this.l=!1,this.i=new ns(null,this.l))}Ht.prototype.toString=function(){const o=[];var u=this.j;u&&o.push(ts(u,Uu,!0),":");var f=this.g;return(f||u=="file")&&(o.push("//"),(u=this.o)&&o.push(ts(u,Uu,!0),"@"),o.push(Xr(f).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f=this.u,f!=null&&o.push(":",String(f))),(f=this.h)&&(this.g&&f.charAt(0)!="/"&&o.push("/"),o.push(ts(f,f.charAt(0)=="/"?Pm:Sm,!0))),(f=this.i.toString())&&o.push("?",f),(f=this.m)&&o.push("#",ts(f,km)),o.join("")},Ht.prototype.resolve=function(o){const u=ct(this);let f=!!o.j;f?Yr(u,o.j):f=!!o.o,f?u.o=o.o:f=!!o.g,f?u.g=o.g:f=o.u!=null;var p=o.h;if(f)Zr(u,o.u);else if(f=!!o.h){if(p.charAt(0)!="/")if(this.g&&!this.h)p="/"+p;else{var b=u.h.lastIndexOf("/");b!=-1&&(p=u.h.slice(0,b+1)+p)}if(b=p,b==".."||b==".")p="";else if(b.indexOf("./")!=-1||b.indexOf("/.")!=-1){p=b.lastIndexOf("/",0)==0,b=b.split("/");const R=[];for(let D=0;D<b.length;){const H=b[D++];H=="."?p&&D==b.length&&R.push(""):H==".."?((R.length>1||R.length==1&&R[0]!="")&&R.pop(),p&&D==b.length&&R.push("")):(R.push(H),p=!0)}p=R.join("/")}else p=b}return f?u.h=p:f=o.i.toString()!=="",f?Ko(u,zu(o.i)):f=!!o.m,f&&(u.m=o.m),u};function ct(o){return new Ht(o)}function Yr(o,u,f){o.j=f?es(u,!0):u,o.j&&(o.j=o.j.replace(/:$/,""))}function Zr(o,u){if(u){if(u=Number(u),isNaN(u)||u<0)throw Error("Bad port number "+u);o.u=u}else o.u=null}function Ko(o,u,f){u instanceof ns?(o.i=u,Nm(o.i,o.l)):(f||(u=ts(u,Cm)),o.i=new ns(u,o.l))}function ie(o,u,f){o.i.set(u,f)}function Xs(o){return ie(o,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),o}function es(o,u){return o?u?decodeURI(o.replace(/%25/g,"%2525")):decodeURIComponent(o):""}function ts(o,u,f){return typeof o=="string"?(o=encodeURI(o).replace(u,Rm),f&&(o=o.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),o):null}function Rm(o){return o=o.charCodeAt(0),"%"+(o>>4&15).toString(16)+(o&15).toString(16)}var Uu=/[#\/\?@]/g,Sm=/[#\?:]/g,Pm=/[#\?]/g,Cm=/[#\?@]/g,km=/#/g;function ns(o,u){this.h=this.g=null,this.i=o||null,this.j=!!u}function bn(o){o.g||(o.g=new Map,o.h=0,o.i&&bm(o.i,function(u,f){o.add(decodeURIComponent(u.replace(/\+/g," ")),f)}))}n=ns.prototype,n.add=function(o,u){bn(this),this.i=null,o=Jn(this,o);let f=this.g.get(o);return f||this.g.set(o,f=[]),f.push(u),this.h+=1,this};function Bu(o,u){bn(o),u=Jn(o,u),o.g.has(u)&&(o.i=null,o.h-=o.g.get(u).length,o.g.delete(u))}function ju(o,u){return bn(o),u=Jn(o,u),o.g.has(u)}n.forEach=function(o,u){bn(this),this.g.forEach(function(f,p){f.forEach(function(b){o.call(u,b,p,this)},this)},this)};function $u(o,u){bn(o);let f=[];if(typeof u=="string")ju(o,u)&&(f=f.concat(o.g.get(Jn(o,u))));else for(o=Array.from(o.g.values()),u=0;u<o.length;u++)f=f.concat(o[u]);return f}n.set=function(o,u){return bn(this),this.i=null,o=Jn(this,o),ju(this,o)&&(this.h-=this.g.get(o).length),this.g.set(o,[u]),this.h+=1,this},n.get=function(o,u){return o?(o=$u(this,o),o.length>0?String(o[0]):u):u};function qu(o,u,f){Bu(o,u),f.length>0&&(o.i=null,o.g.set(Jn(o,u),E(f)),o.h+=f.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const o=[],u=Array.from(this.g.keys());for(let p=0;p<u.length;p++){var f=u[p];const b=Xr(f);f=$u(this,f);for(let R=0;R<f.length;R++){let D=b;f[R]!==""&&(D+="="+Xr(f[R])),o.push(D)}}return this.i=o.join("&")};function zu(o){const u=new ns;return u.i=o.i,o.g&&(u.g=new Map(o.g),u.h=o.h),u}function Jn(o,u){return u=String(u),o.j&&(u=u.toLowerCase()),u}function Nm(o,u){u&&!o.j&&(bn(o),o.i=null,o.g.forEach(function(f,p){const b=p.toLowerCase();p!=b&&(Bu(this,p),qu(this,b,f))},o)),o.j=u}function Dm(o,u){const f=new Qr;if(a.Image){const p=new Image;p.onload=d(Wt,f,"TestLoadImage: loaded",!0,u,p),p.onerror=d(Wt,f,"TestLoadImage: error",!1,u,p),p.onabort=d(Wt,f,"TestLoadImage: abort",!1,u,p),p.ontimeout=d(Wt,f,"TestLoadImage: timeout",!1,u,p),a.setTimeout(function(){p.ontimeout&&p.ontimeout()},1e4),p.src=o}else u(!1)}function Vm(o,u){const f=new Qr,p=new AbortController,b=setTimeout(()=>{p.abort(),Wt(f,"TestPingServer: timeout",!1,u)},1e4);fetch(o,{signal:p.signal}).then(R=>{clearTimeout(b),R.ok?Wt(f,"TestPingServer: ok",!0,u):Wt(f,"TestPingServer: server error",!1,u)}).catch(()=>{clearTimeout(b),Wt(f,"TestPingServer: error",!1,u)})}function Wt(o,u,f,p,b){try{b&&(b.onload=null,b.onerror=null,b.onabort=null,b.ontimeout=null),p(f)}catch{}}function Om(){this.g=new gm}function Qo(o){this.i=o.Sb||null,this.h=o.ab||!1}g(Qo,Eu),Qo.prototype.g=function(){return new Js(this.i,this.h)};function Js(o,u){De.call(this),this.H=o,this.o=u,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}g(Js,De),n=Js.prototype,n.open=function(o,u){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=o,this.D=u,this.readyState=1,ss(this)},n.send=function(o){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const u={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};o&&(u.body=o),(this.H||a).fetch(new Request(this.D,u)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,rs(this)),this.readyState=0},n.Pa=function(o){if(this.g&&(this.l=o,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=o.headers,this.readyState=2,ss(this)),this.g&&(this.readyState=3,ss(this),this.g)))if(this.responseType==="arraybuffer")o.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in o){if(this.j=o.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Hu(this)}else o.text().then(this.Oa.bind(this),this.ga.bind(this))};function Hu(o){o.j.read().then(o.Ma.bind(o)).catch(o.ga.bind(o))}n.Ma=function(o){if(this.g){if(this.o&&o.value)this.response.push(o.value);else if(!this.o){var u=o.value?o.value:new Uint8Array(0);(u=this.B.decode(u,{stream:!o.done}))&&(this.response=this.responseText+=u)}o.done?rs(this):ss(this),this.readyState==3&&Hu(this)}},n.Oa=function(o){this.g&&(this.response=this.responseText=o,rs(this))},n.Na=function(o){this.g&&(this.response=o,rs(this))},n.ga=function(){this.g&&rs(this)};function rs(o){o.readyState=4,o.l=null,o.j=null,o.B=null,ss(o)}n.setRequestHeader=function(o,u){this.A.append(o,u)},n.getResponseHeader=function(o){return this.h&&this.h.get(o.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const o=[],u=this.h.entries();for(var f=u.next();!f.done;)f=f.value,o.push(f[0]+": "+f[1]),f=u.next();return o.join(`\r
`)};function ss(o){o.onreadystatechange&&o.onreadystatechange.call(o)}Object.defineProperty(Js.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(o){this.m=o?"include":"same-origin"}});function Wu(o){let u="";return In(o,function(f,p){u+=p,u+=":",u+=f,u+=`\r
`}),u}function Xo(o,u,f){e:{for(p in f){var p=!1;break e}p=!0}p||(f=Wu(f),typeof o=="string"?f!=null&&Xr(f):ie(o,u,f))}function le(o){De.call(this),this.headers=new Map,this.L=o||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}g(le,De);var Mm=/^https?$/i,Lm=["POST","PUT"];n=le.prototype,n.Fa=function(o){this.H=o},n.ea=function(o,u,f,p){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+o);u=u?u.toUpperCase():"GET",this.D=o,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Su.g(),this.g.onreadystatechange=m(h(this.Ca,this));try{this.B=!0,this.g.open(u,String(o),!0),this.B=!1}catch(R){Gu(this,R);return}if(o=f||"",f=new Map(this.headers),p)if(Object.getPrototypeOf(p)===Object.prototype)for(var b in p)f.set(b,p[b]);else if(typeof p.keys=="function"&&typeof p.get=="function")for(const R of p.keys())f.set(R,p.get(R));else throw Error("Unknown input type for opt_headers: "+String(p));p=Array.from(f.keys()).find(R=>R.toLowerCase()=="content-type"),b=a.FormData&&o instanceof a.FormData,!(Array.prototype.indexOf.call(Lm,u,void 0)>=0)||p||b||f.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[R,D]of f)this.g.setRequestHeader(R,D);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(o),this.v=!1}catch(R){Gu(this,R)}};function Gu(o,u){o.h=!1,o.g&&(o.j=!0,o.g.abort(),o.j=!1),o.l=u,o.o=5,Ku(o),Ys(o)}function Ku(o){o.A||(o.A=!0,Ue(o,"complete"),Ue(o,"error"))}n.abort=function(o){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=o||7,Ue(this,"complete"),Ue(this,"abort"),Ys(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ys(this,!0)),le.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?Qu(this):this.Xa())},n.Xa=function(){Qu(this)};function Qu(o){if(o.h&&typeof i<"u"){if(o.v&&Gt(o)==4)setTimeout(o.Ca.bind(o),0);else if(Ue(o,"readystatechange"),Gt(o)==4){o.h=!1;try{const R=o.ca();e:switch(R){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var u=!0;break e;default:u=!1}var f;if(!(f=u)){var p;if(p=R===0){let D=String(o.D).match(Fu)[1]||null;!D&&a.self&&a.self.location&&(D=a.self.location.protocol.slice(0,-1)),p=!Mm.test(D?D.toLowerCase():"")}f=p}if(f)Ue(o,"complete"),Ue(o,"success");else{o.o=6;try{var b=Gt(o)>2?o.g.statusText:""}catch{b=""}o.l=b+" ["+o.ca()+"]",Ku(o)}}finally{Ys(o)}}}}function Ys(o,u){if(o.g){o.m&&(clearTimeout(o.m),o.m=null);const f=o.g;o.g=null,u||Ue(o,"ready");try{f.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function Gt(o){return o.g?o.g.readyState:0}n.ca=function(){try{return Gt(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(o){if(this.g){var u=this.g.responseText;return o&&u.indexOf(o)==0&&(u=u.substring(o.length)),mm(u)}};function Xu(o){try{if(!o.g)return null;if("response"in o.g)return o.g.response;switch(o.F){case"":case"text":return o.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in o.g)return o.g.mozResponseArrayBuffer}return null}catch{return null}}function xm(o){const u={};o=(o.g&&Gt(o)>=2&&o.g.getAllResponseHeaders()||"").split(`\r
`);for(let p=0;p<o.length;p++){if(y(o[p]))continue;var f=Tm(o[p]);const b=f[0];if(f=f[1],typeof f!="string")continue;f=f.trim();const R=u[b]||[];u[b]=R,R.push(f)}zr(u,function(p){return p.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function is(o,u,f){return f&&f.internalChannelParams&&f.internalChannelParams[o]||u}function Ju(o){this.za=0,this.i=[],this.j=new Qr,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=is("failFast",!1,o),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=is("baseRetryDelayMs",5e3,o),this.Za=is("retryDelaySeedMs",1e4,o),this.Ta=is("forwardChannelMaxRetries",2,o),this.va=is("forwardChannelRequestTimeoutMs",2e4,o),this.ma=o&&o.xmlHttpFactory||void 0,this.Ua=o&&o.Rb||void 0,this.Aa=o&&o.useFetchStreams||!1,this.O=void 0,this.L=o&&o.supportsCrossDomainXhr||!1,this.M="",this.h=new Vu(o&&o.concurrentRequestLimit),this.Ba=new Om,this.S=o&&o.fastHandshake||!1,this.R=o&&o.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=o&&o.Pb||!1,o&&o.ua&&this.j.ua(),o&&o.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&o&&o.detectBufferingProxy||!1,this.ia=void 0,o&&o.longPollingTimeout&&o.longPollingTimeout>0&&(this.ia=o.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Ju.prototype,n.ka=8,n.I=1,n.connect=function(o,u,f,p){Be(0),this.W=o,this.H=u||{},f&&p!==void 0&&(this.H.OSID=f,this.H.OAID=p),this.F=this.X,this.J=ol(this,null,this.W),ei(this)};function Jo(o){if(Yu(o),o.I==3){var u=o.V++,f=ct(o.J);if(ie(f,"SID",o.M),ie(f,"RID",u),ie(f,"TYPE","terminate"),os(o,f),u=new zt(o,o.j,u),u.M=2,u.A=Xs(ct(f)),f=!1,a.navigator&&a.navigator.sendBeacon)try{f=a.navigator.sendBeacon(u.A.toString(),"")}catch{}!f&&a.Image&&(new Image().src=u.A,f=!0),f||(u.g=al(u.j,null),u.g.ea(u.A)),u.F=Date.now(),Qs(u)}il(o)}function Zs(o){o.g&&(Zo(o),o.g.cancel(),o.g=null)}function Yu(o){Zs(o),o.v&&(a.clearTimeout(o.v),o.v=null),ti(o),o.h.cancel(),o.m&&(typeof o.m=="number"&&a.clearTimeout(o.m),o.m=null)}function ei(o){if(!Ou(o.h)&&!o.m){o.m=!0;var u=o.Ea;Y||_(),Z||(Y(),Z=!0),I.add(u,o),o.D=0}}function Fm(o,u){return Mu(o.h)>=o.h.j-(o.m?1:0)?!1:o.m?(o.i=u.G.concat(o.i),!0):o.I==1||o.I==2||o.D>=(o.Sa?0:o.Ta)?!1:(o.m=Kr(h(o.Ea,o,u),sl(o,o.D)),o.D++,!0)}n.Ea=function(o){if(this.m)if(this.m=null,this.I==1){if(!o){this.V=Math.floor(Math.random()*1e5),o=this.V++;const b=new zt(this,this.j,o);let R=this.o;if(this.U&&(R?(R=Qn(R),ko(R,this.U)):R=this.U),this.u!==null||this.R||(b.J=R,R=null),this.S)e:{for(var u=0,f=0;f<this.i.length;f++){t:{var p=this.i[f];if("__data__"in p.map&&(p=p.map.__data__,typeof p=="string")){p=p.length;break t}p=void 0}if(p===void 0)break;if(u+=p,u>4096){u=f;break e}if(u===4096||f===this.i.length-1){u=f+1;break e}}u=1e3}else u=1e3;u=el(this,b,u),f=ct(this.J),ie(f,"RID",o),ie(f,"CVER",22),this.G&&ie(f,"X-HTTP-Session-Id",this.G),os(this,f),R&&(this.R?u="headers="+Xr(Wu(R))+"&"+u:this.u&&Xo(f,this.u,R)),Go(this.h,b),this.Ra&&ie(f,"TYPE","init"),this.S?(ie(f,"$req",u),ie(f,"SID","null"),b.U=!0,qo(b,f,null)):qo(b,f,u),this.I=2}}else this.I==3&&(o?Zu(this,o):this.i.length==0||Ou(this.h)||Zu(this))};function Zu(o,u){var f;u?f=u.l:f=o.V++;const p=ct(o.J);ie(p,"SID",o.M),ie(p,"RID",f),ie(p,"AID",o.K),os(o,p),o.u&&o.o&&Xo(p,o.u,o.o),f=new zt(o,o.j,f,o.D+1),o.u===null&&(f.J=o.o),u&&(o.i=u.G.concat(o.i)),u=el(o,f,1e3),f.H=Math.round(o.va*.5)+Math.round(o.va*.5*Math.random()),Go(o.h,f),qo(f,p,u)}function os(o,u){o.H&&In(o.H,function(f,p){ie(u,p,f)}),o.l&&In({},function(f,p){ie(u,p,f)})}function el(o,u,f){f=Math.min(o.i.length,f);const p=o.l?h(o.l.Ka,o.l,o):null;e:{var b=o.i;let H=-1;for(;;){const _e=["count="+f];H==-1?f>0?(H=b[0].g,_e.push("ofs="+H)):H=0:_e.push("ofs="+H);let ne=!0;for(let we=0;we<f;we++){var R=b[we].g;const ut=b[we].map;if(R-=H,R<0)H=Math.max(0,b[we].g-100),ne=!1;else try{R="req"+R+"_"||"";try{var D=ut instanceof Map?ut:Object.entries(ut);for(const[Sn,Kt]of D){let Qt=Kt;c(Kt)&&(Qt=Fo(Kt)),_e.push(R+Sn+"="+encodeURIComponent(Qt))}}catch(Sn){throw _e.push(R+"type="+encodeURIComponent("_badmap")),Sn}}catch{p&&p(ut)}}if(ne){D=_e.join("&");break e}}D=void 0}return o=o.i.splice(0,f),u.G=o,D}function tl(o){if(!o.g&&!o.v){o.Y=1;var u=o.Da;Y||_(),Z||(Y(),Z=!0),I.add(u,o),o.A=0}}function Yo(o){return o.g||o.v||o.A>=3?!1:(o.Y++,o.v=Kr(h(o.Da,o),sl(o,o.A)),o.A++,!0)}n.Da=function(){if(this.v=null,nl(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var o=4*this.T;this.j.info("BP detection timer enabled: "+o),this.B=Kr(h(this.Wa,this),o)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Be(10),Zs(this),nl(this))};function Zo(o){o.B!=null&&(a.clearTimeout(o.B),o.B=null)}function nl(o){o.g=new zt(o,o.j,"rpc",o.Y),o.u===null&&(o.g.J=o.o),o.g.P=0;var u=ct(o.na);ie(u,"RID","rpc"),ie(u,"SID",o.M),ie(u,"AID",o.K),ie(u,"CI",o.F?"0":"1"),!o.F&&o.ia&&ie(u,"TO",o.ia),ie(u,"TYPE","xmlhttp"),os(o,u),o.u&&o.o&&Xo(u,o.u,o.o),o.O&&(o.g.H=o.O);var f=o.g;o=o.ba,f.M=1,f.A=Xs(ct(u)),f.u=null,f.R=!0,ku(f,o)}n.Va=function(){this.C!=null&&(this.C=null,Zs(this),Yo(this),Be(19))};function ti(o){o.C!=null&&(a.clearTimeout(o.C),o.C=null)}function rl(o,u){var f=null;if(o.g==u){ti(o),Zo(o),o.g=null;var p=2}else if(Wo(o.h,u))f=u.G,Lu(o.h,u),p=1;else return;if(o.I!=0){if(u.o)if(p==1){f=u.u?u.u.length:0,u=Date.now()-u.F;var b=o.D;p=Gs(),Ue(p,new bu(p,f)),ei(o)}else tl(o);else if(b=u.m,b==3||b==0&&u.X>0||!(p==1&&Fm(o,u)||p==2&&Yo(o)))switch(f&&f.length>0&&(u=o.h,u.i=u.i.concat(f)),b){case 1:Rn(o,5);break;case 4:Rn(o,10);break;case 3:Rn(o,6);break;default:Rn(o,2)}}}function sl(o,u){let f=o.Qa+Math.floor(Math.random()*o.Za);return o.isActive()||(f*=2),f*u}function Rn(o,u){if(o.j.info("Error code "+u),u==2){var f=h(o.bb,o),p=o.Ua;const b=!p;p=new Ht(p||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Yr(p,"https"),Xs(p),b?Dm(p.toString(),f):Vm(p.toString(),f)}else Be(2);o.I=0,o.l&&o.l.pa(u),il(o),Yu(o)}n.bb=function(o){o?(this.j.info("Successfully pinged google.com"),Be(2)):(this.j.info("Failed to ping google.com"),Be(1))};function il(o){if(o.I=0,o.ja=[],o.l){const u=xu(o.h);(u.length!=0||o.i.length!=0)&&(S(o.ja,u),S(o.ja,o.i),o.h.i.length=0,E(o.i),o.i.length=0),o.l.oa()}}function ol(o,u,f){var p=f instanceof Ht?ct(f):new Ht(f);if(p.g!="")u&&(p.g=u+"."+p.g),Zr(p,p.u);else{var b=a.location;p=b.protocol,u=u?u+"."+b.hostname:b.hostname,b=+b.port;const R=new Ht(null);p&&Yr(R,p),u&&(R.g=u),b&&Zr(R,b),f&&(R.h=f),p=R}return f=o.G,u=o.wa,f&&u&&ie(p,f,u),ie(p,"VER",o.ka),os(o,p),p}function al(o,u,f){if(u&&!o.L)throw Error("Can't create secondary domain capable XhrIo object.");return u=o.Aa&&!o.ma?new le(new Qo({ab:f})):new le(o.ma),u.Fa(o.L),u}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function cl(){}n=cl.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function ni(){}ni.prototype.g=function(o,u){return new Qe(o,u)};function Qe(o,u){De.call(this),this.g=new Ju(u),this.l=o,this.h=u&&u.messageUrlParams||null,o=u&&u.messageHeaders||null,u&&u.clientProtocolHeaderRequired&&(o?o["X-Client-Protocol"]="webchannel":o={"X-Client-Protocol":"webchannel"}),this.g.o=o,o=u&&u.initMessageHeaders||null,u&&u.messageContentType&&(o?o["X-WebChannel-Content-Type"]=u.messageContentType:o={"X-WebChannel-Content-Type":u.messageContentType}),u&&u.sa&&(o?o["X-WebChannel-Client-Profile"]=u.sa:o={"X-WebChannel-Client-Profile":u.sa}),this.g.U=o,(o=u&&u.Qb)&&!y(o)&&(this.g.u=o),this.A=u&&u.supportsCrossDomainXhr||!1,this.v=u&&u.sendRawJson||!1,(u=u&&u.httpSessionIdParam)&&!y(u)&&(this.g.G=u,o=this.h,o!==null&&u in o&&(o=this.h,u in o&&delete o[u])),this.j=new Yn(this)}g(Qe,De),Qe.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Qe.prototype.close=function(){Jo(this.g)},Qe.prototype.o=function(o){var u=this.g;if(typeof o=="string"){var f={};f.__data__=o,o=f}else this.v&&(f={},f.__data__=Fo(o),o=f);u.i.push(new Am(u.Ya++,o)),u.I==3&&ei(u)},Qe.prototype.N=function(){this.g.l=null,delete this.j,Jo(this.g),delete this.g,Qe.Z.N.call(this)};function ul(o){Uo.call(this),o.__headers__&&(this.headers=o.__headers__,this.statusCode=o.__status__,delete o.__headers__,delete o.__status__);var u=o.__sm__;if(u){e:{for(const f in u){o=f;break e}o=void 0}(this.i=o)&&(o=this.i,u=u!==null&&o in u?u[o]:void 0),this.data=u}else this.data=o}g(ul,Uo);function ll(){Bo.call(this),this.status=1}g(ll,Bo);function Yn(o){this.g=o}g(Yn,cl),Yn.prototype.ra=function(){Ue(this.g,"a")},Yn.prototype.qa=function(o){Ue(this.g,new ul(o))},Yn.prototype.pa=function(o){Ue(this.g,new ll)},Yn.prototype.oa=function(){Ue(this.g,"b")},ni.prototype.createWebChannel=ni.prototype.g,Qe.prototype.send=Qe.prototype.o,Qe.prototype.open=Qe.prototype.m,Qe.prototype.close=Qe.prototype.close,ad=function(){return new ni},od=function(){return Gs()},id=wn,ka={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Ks.NO_ERROR=0,Ks.TIMEOUT=8,Ks.HTTP_ERROR=6,pi=Ks,Ru.COMPLETE="complete",sd=Ru,Tu.EventType=Wr,Wr.OPEN="a",Wr.CLOSE="b",Wr.ERROR="c",Wr.MESSAGE="d",De.prototype.listen=De.prototype.J,cs=Tu,le.prototype.listenOnce=le.prototype.K,le.prototype.getLastError=le.prototype.Ha,le.prototype.getLastErrorCode=le.prototype.ya,le.prototype.getStatus=le.prototype.ca,le.prototype.getResponseJson=le.prototype.La,le.prototype.getResponseText=le.prototype.la,le.prototype.send=le.prototype.ea,le.prototype.setWithCredentials=le.prototype.Fa,rd=le}).apply(typeof oi<"u"?oi:typeof self<"u"?self:typeof window<"u"?window:{});const Ll="@firebase/firestore",xl="4.9.2";class Me{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Me.UNAUTHENTICATED=new Me(null),Me.GOOGLE_CREDENTIALS=new Me("google-credentials-uid"),Me.FIRST_PARTY=new Me("first-party-uid"),Me.MOCK_USER=new Me("mock-user");let Fr="12.3.0";const jn=new yc("@firebase/firestore");function tr(){return jn.logLevel}function M(n,...e){if(jn.logLevel<=W.DEBUG){const t=e.map(Tc);jn.debug(`Firestore (${Fr}): ${n}`,...t)}}function Mt(n,...e){if(jn.logLevel<=W.ERROR){const t=e.map(Tc);jn.error(`Firestore (${Fr}): ${n}`,...t)}}function br(n,...e){if(jn.logLevel<=W.WARN){const t=e.map(Tc);jn.warn(`Firestore (${Fr}): ${n}`,...t)}}function Tc(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function B(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,cd(n,r,t)}function cd(n,e,t){let r=`FIRESTORE (${Fr}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw Mt(r),new Error(r)}function te(n,e,t,r){let s="Unexpected state";typeof t=="string"?s=t:r=t,n||cd(e,s,r)}function z(n,e){return n}const N={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class x extends St{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class On{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class ud{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Yy{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Me.UNAUTHENTICATED)))}shutdown(){}}class Zy{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class ev{constructor(e){this.t=e,this.currentUser=Me.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){te(this.o===void 0,42304);let r=this.i;const s=l=>this.i!==r?(r=this.i,t(l)):Promise.resolve();let i=new On;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new On,e.enqueueRetryable((()=>s(this.currentUser)))};const a=()=>{const l=i;e.enqueueRetryable((async()=>{await l.promise,await s(this.currentUser)}))},c=l=>{M("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit((l=>c(l))),setTimeout((()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?c(l):(M("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new On)}}),0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((r=>this.i!==e?(M("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(te(typeof r.accessToken=="string",31837,{l:r}),new ud(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return te(e===null||typeof e=="string",2055,{h:e}),new Me(e)}}class tv{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=Me.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class nv{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new tv(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(Me.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Fl{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class rv{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,tt(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){te(this.o===void 0,3512);const r=i=>{i.error!=null&&M("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const a=i.token!==this.m;return this.m=i.token,M("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable((()=>r(i)))};const s=i=>{M("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((i=>s(i))),setTimeout((()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):M("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new Fl(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(te(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new Fl(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function sv(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}class Ic{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=sv(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<t&&(r+=e.charAt(s[i]%62))}return r}}function G(n,e){return n<e?-1:n>e?1:0}function Na(n,e){const t=Math.min(n.length,e.length);for(let r=0;r<t;r++){const s=n.charAt(r),i=e.charAt(r);if(s!==i)return ua(s)===ua(i)?G(s,i):ua(s)?1:-1}return G(n.length,e.length)}const iv=55296,ov=57343;function ua(n){const e=n.charCodeAt(0);return e>=iv&&e<=ov}function Rr(n,e,t){return n.length===e.length&&n.every(((r,s)=>t(r,e[s])))}const Ul="__name__";class ht{constructor(e,t,r){t===void 0?t=0:t>e.length&&B(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&B(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return ht.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof ht?e.forEach((r=>{t.push(r)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let s=0;s<r;s++){const i=ht.compareSegments(e.get(s),t.get(s));if(i!==0)return i}return G(e.length,t.length)}static compareSegments(e,t){const r=ht.isNumericId(e),s=ht.isNumericId(t);return r&&!s?-1:!r&&s?1:r&&s?ht.extractNumericId(e).compare(ht.extractNumericId(t)):Na(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return cn.fromString(e.substring(4,e.length-2))}}class ae extends ht{construct(e,t,r){return new ae(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new x(N.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter((s=>s.length>0)))}return new ae(t)}static emptyPath(){return new ae([])}}const av=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Se extends ht{construct(e,t,r){return new Se(e,t,r)}static isValidIdentifier(e){return av.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Se.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Ul}static keyField(){return new Se([Ul])}static fromServerFormat(e){const t=[];let r="",s=0;const i=()=>{if(r.length===0)throw new x(N.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let a=!1;for(;s<e.length;){const c=e[s];if(c==="\\"){if(s+1===e.length)throw new x(N.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new x(N.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,s+=2}else c==="`"?(a=!a,s++):c!=="."||a?(r+=c,s++):(i(),s++)}if(i(),a)throw new x(N.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Se(t)}static emptyPath(){return new Se([])}}class U{constructor(e){this.path=e}static fromPath(e){return new U(ae.fromString(e))}static fromName(e){return new U(ae.fromString(e).popFirst(5))}static empty(){return new U(ae.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ae.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return ae.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new U(new ae(e.slice()))}}function ld(n,e,t){if(!t)throw new x(N.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function cv(n,e,t,r){if(e===!0&&r===!0)throw new x(N.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function Bl(n){if(!U.isDocumentKey(n))throw new x(N.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function jl(n){if(U.isDocumentKey(n))throw new x(N.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function hd(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function wc(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":B(12329,{type:typeof n})}function un(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new x(N.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=wc(n);throw new x(N.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function me(n,e){const t={typeString:n};return e&&(t.value=e),t}function Ls(n,e){if(!hd(n))throw new x(N.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const s=e[r].typeString,i="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}const a=n[r];if(s&&typeof a!==s){t=`JSON field '${r}' must be a ${s}.`;break}if(i!==void 0&&a!==i.value){t=`Expected '${r}' field to equal '${i.value}'`;break}}if(t)throw new x(N.INVALID_ARGUMENT,t);return!0}const $l=-62135596800,ql=1e6;class ce{static now(){return ce.fromMillis(Date.now())}static fromDate(e){return ce.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*ql);return new ce(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new x(N.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new x(N.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<$l)throw new x(N.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new x(N.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/ql}_compareTo(e){return this.seconds===e.seconds?G(this.nanoseconds,e.nanoseconds):G(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:ce._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Ls(e,ce._jsonSchema))return new ce(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-$l;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}ce._jsonSchemaVersion="firestore/timestamp/1.0",ce._jsonSchema={type:me("string",ce._jsonSchemaVersion),seconds:me("number"),nanoseconds:me("number")};class ${static fromTimestamp(e){return new $(e)}static min(){return new $(new ce(0,0))}static max(){return new $(new ce(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const As=-1;function uv(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,s=$.fromTimestamp(r===1e9?new ce(t+1,0):new ce(t,r));return new fn(s,U.empty(),e)}function lv(n){return new fn(n.readTime,n.key,As)}class fn{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new fn($.min(),U.empty(),As)}static max(){return new fn($.max(),U.empty(),As)}}function hv(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=U.comparator(n.documentKey,e.documentKey),t!==0?t:G(n.largestBatchId,e.largestBatchId))}const fv="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class dv{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Ur(n){if(n.code!==N.FAILED_PRECONDITION||n.message!==fv)throw n;M("LocalStore","Unexpectedly lost primary lease")}class k{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&B(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new k(((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(t,i).next(r,s)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof k?t:k.resolve(t)}catch(t){return k.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):k.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):k.reject(t)}static resolve(e){return new k(((t,r)=>{t(e)}))}static reject(e){return new k(((t,r)=>{r(e)}))}static waitFor(e){return new k(((t,r)=>{let s=0,i=0,a=!1;e.forEach((c=>{++s,c.next((()=>{++i,a&&i===s&&t()}),(l=>r(l)))})),a=!0,i===s&&t()}))}static or(e){let t=k.resolve(!1);for(const r of e)t=t.next((s=>s?k.resolve(s):r()));return t}static forEach(e,t){const r=[];return e.forEach(((s,i)=>{r.push(t.call(this,s,i))})),this.waitFor(r)}static mapArray(e,t){return new k(((r,s)=>{const i=e.length,a=new Array(i);let c=0;for(let l=0;l<i;l++){const h=l;t(e[h]).next((d=>{a[h]=d,++c,c===i&&r(a)}),(d=>s(d)))}}))}static doWhile(e,t){return new k(((r,s)=>{const i=()=>{e()===!0?t().next((()=>{i()}),s):r()};i()}))}}function pv(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Br(n){return n.name==="IndexedDbTransactionError"}class co{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>t.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}co.ce=-1;const Ac=-1;function uo(n){return n==null}function ki(n){return n===0&&1/n==-1/0}function mv(n){return typeof n=="number"&&Number.isInteger(n)&&!ki(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const fd="";function gv(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=zl(e)),e=_v(n.get(t),e);return zl(e)}function _v(n,e){let t=e;const r=n.length;for(let s=0;s<r;s++){const i=n.charAt(s);switch(i){case"\0":t+="";break;case fd:t+="";break;default:t+=i}}return t}function zl(n){return n+fd+""}function Hl(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function En(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function dd(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class ue{constructor(e,t){this.comparator=e,this.root=t||Re.EMPTY}insert(e,t){return new ue(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Re.BLACK,null,null))}remove(e){return new ue(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Re.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return t+r.left.size;s<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,r)=>(e(t,r),!1)))}toString(){const e=[];return this.inorderTraversal(((t,r)=>(e.push(`${t}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ai(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ai(this.root,e,this.comparator,!1)}getReverseIterator(){return new ai(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ai(this.root,e,this.comparator,!0)}}class ai{constructor(e,t,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?r(e.key,t):1,t&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Re{constructor(e,t,r,s,i){this.key=e,this.value=t,this.color=r??Re.RED,this.left=s??Re.EMPTY,this.right=i??Re.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,s,i){return new Re(e??this.key,t??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,t,r),null):i===0?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Re.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),t(e,s.key)===0){if(s.right.isEmpty())return Re.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Re.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Re.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw B(43730,{key:this.key,value:this.value});if(this.right.isRed())throw B(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw B(27949);return e+(this.isRed()?0:1)}}Re.EMPTY=null,Re.RED=!0,Re.BLACK=!1;Re.EMPTY=new class{constructor(){this.size=0}get key(){throw B(57766)}get value(){throw B(16141)}get color(){throw B(16727)}get left(){throw B(29726)}get right(){throw B(36894)}copy(e,t,r,s,i){return this}insert(e,t,r){return new Re(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Te{constructor(e){this.comparator=e,this.data=new ue(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,r)=>(e(t),!1)))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Wl(this.data.getIterator())}getIteratorFrom(e){return new Wl(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((r=>{t=t.add(r)})),t}isEqual(e){if(!(e instanceof Te)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Te(this.comparator);return t.data=e,t}}class Wl{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Ye{constructor(e){this.fields=e,e.sort(Se.comparator)}static empty(){return new Ye([])}unionWith(e){let t=new Te(Se.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Ye(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Rr(this.fields,e.fields,((t,r)=>t.isEqual(r)))}}class pd extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Ne{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new pd("Invalid base64 string: "+i):i}})(e);return new Ne(t)}static fromUint8Array(e){const t=(function(s){let i="";for(let a=0;a<s.length;++a)i+=String.fromCharCode(s[a]);return i})(e);return new Ne(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const r=new Uint8Array(t.length);for(let s=0;s<t.length;s++)r[s]=t.charCodeAt(s);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return G(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ne.EMPTY_BYTE_STRING=new Ne("");const yv=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function dn(n){if(te(!!n,39018),typeof n=="string"){let e=0;const t=yv.exec(n);if(te(!!t,46558,{timestamp:n}),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:de(n.seconds),nanos:de(n.nanos)}}function de(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function pn(n){return typeof n=="string"?Ne.fromBase64String(n):Ne.fromUint8Array(n)}const md="server_timestamp",gd="__type__",_d="__previous_value__",yd="__local_write_time__";function bc(n){return(n?.mapValue?.fields||{})[gd]?.stringValue===md}function lo(n){const e=n.mapValue.fields[_d];return bc(e)?lo(e):e}function bs(n){const e=dn(n.mapValue.fields[yd].timestampValue);return new ce(e.seconds,e.nanos)}class vv{constructor(e,t,r,s,i,a,c,l,h,d){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=a,this.autoDetectLongPolling=c,this.longPollingOptions=l,this.useFetchStreams=h,this.isUsingEmulator=d}}const Ni="(default)";class Rs{constructor(e,t){this.projectId=e,this.database=t||Ni}static empty(){return new Rs("","")}get isDefaultDatabase(){return this.database===Ni}isEqual(e){return e instanceof Rs&&e.projectId===this.projectId&&e.database===this.database}}const vd="__type__",Ev="__max__",ci={mapValue:{}},Ed="__vector__",Di="value";function mn(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?bc(n)?4:Iv(n)?9007199254740991:Tv(n)?10:11:B(28295,{value:n})}function wt(n,e){if(n===e)return!0;const t=mn(n);if(t!==mn(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return bs(n).isEqual(bs(e));case 3:return(function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const a=dn(s.timestampValue),c=dn(i.timestampValue);return a.seconds===c.seconds&&a.nanos===c.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(s,i){return pn(s.bytesValue).isEqual(pn(i.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(s,i){return de(s.geoPointValue.latitude)===de(i.geoPointValue.latitude)&&de(s.geoPointValue.longitude)===de(i.geoPointValue.longitude)})(n,e);case 2:return(function(s,i){if("integerValue"in s&&"integerValue"in i)return de(s.integerValue)===de(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const a=de(s.doubleValue),c=de(i.doubleValue);return a===c?ki(a)===ki(c):isNaN(a)&&isNaN(c)}return!1})(n,e);case 9:return Rr(n.arrayValue.values||[],e.arrayValue.values||[],wt);case 10:case 11:return(function(s,i){const a=s.mapValue.fields||{},c=i.mapValue.fields||{};if(Hl(a)!==Hl(c))return!1;for(const l in a)if(a.hasOwnProperty(l)&&(c[l]===void 0||!wt(a[l],c[l])))return!1;return!0})(n,e);default:return B(52216,{left:n})}}function Ss(n,e){return(n.values||[]).find((t=>wt(t,e)))!==void 0}function Sr(n,e){if(n===e)return 0;const t=mn(n),r=mn(e);if(t!==r)return G(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return G(n.booleanValue,e.booleanValue);case 2:return(function(i,a){const c=de(i.integerValue||i.doubleValue),l=de(a.integerValue||a.doubleValue);return c<l?-1:c>l?1:c===l?0:isNaN(c)?isNaN(l)?0:-1:1})(n,e);case 3:return Gl(n.timestampValue,e.timestampValue);case 4:return Gl(bs(n),bs(e));case 5:return Na(n.stringValue,e.stringValue);case 6:return(function(i,a){const c=pn(i),l=pn(a);return c.compareTo(l)})(n.bytesValue,e.bytesValue);case 7:return(function(i,a){const c=i.split("/"),l=a.split("/");for(let h=0;h<c.length&&h<l.length;h++){const d=G(c[h],l[h]);if(d!==0)return d}return G(c.length,l.length)})(n.referenceValue,e.referenceValue);case 8:return(function(i,a){const c=G(de(i.latitude),de(a.latitude));return c!==0?c:G(de(i.longitude),de(a.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return Kl(n.arrayValue,e.arrayValue);case 10:return(function(i,a){const c=i.fields||{},l=a.fields||{},h=c[Di]?.arrayValue,d=l[Di]?.arrayValue,g=G(h?.values?.length||0,d?.values?.length||0);return g!==0?g:Kl(h,d)})(n.mapValue,e.mapValue);case 11:return(function(i,a){if(i===ci.mapValue&&a===ci.mapValue)return 0;if(i===ci.mapValue)return 1;if(a===ci.mapValue)return-1;const c=i.fields||{},l=Object.keys(c),h=a.fields||{},d=Object.keys(h);l.sort(),d.sort();for(let g=0;g<l.length&&g<d.length;++g){const m=Na(l[g],d[g]);if(m!==0)return m;const E=Sr(c[l[g]],h[d[g]]);if(E!==0)return E}return G(l.length,d.length)})(n.mapValue,e.mapValue);default:throw B(23264,{he:t})}}function Gl(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return G(n,e);const t=dn(n),r=dn(e),s=G(t.seconds,r.seconds);return s!==0?s:G(t.nanos,r.nanos)}function Kl(n,e){const t=n.values||[],r=e.values||[];for(let s=0;s<t.length&&s<r.length;++s){const i=Sr(t[s],r[s]);if(i)return i}return G(t.length,r.length)}function Pr(n){return Da(n)}function Da(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const r=dn(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return pn(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return U.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",s=!0;for(const i of t.values||[])s?s=!1:r+=",",r+=Da(i);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){const r=Object.keys(t.fields||{}).sort();let s="{",i=!0;for(const a of r)i?i=!1:s+=",",s+=`${a}:${Da(t.fields[a])}`;return s+"}"})(n.mapValue):B(61005,{value:n})}function mi(n){switch(mn(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=lo(n);return e?16+mi(e):16;case 5:return 2*n.stringValue.length;case 6:return pn(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((s,i)=>s+mi(i)),0)})(n.arrayValue);case 10:case 11:return(function(r){let s=0;return En(r.fields,((i,a)=>{s+=i.length+mi(a)})),s})(n.mapValue);default:throw B(13486,{value:n})}}function Va(n){return!!n&&"integerValue"in n}function Rc(n){return!!n&&"arrayValue"in n}function Ql(n){return!!n&&"nullValue"in n}function Xl(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function gi(n){return!!n&&"mapValue"in n}function Tv(n){return(n?.mapValue?.fields||{})[vd]?.stringValue===Ed}function ms(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return En(n.mapValue.fields,((t,r)=>e.mapValue.fields[t]=ms(r))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=ms(n.arrayValue.values[t]);return e}return{...n}}function Iv(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===Ev}class He{constructor(e){this.value=e}static empty(){return new He({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!gi(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=ms(t)}setAll(e){let t=Se.emptyPath(),r={},s=[];e.forEach(((a,c)=>{if(!t.isImmediateParentOf(c)){const l=this.getFieldsMap(t);this.applyChanges(l,r,s),r={},s=[],t=c.popLast()}a?r[c.lastSegment()]=ms(a):s.push(c.lastSegment())}));const i=this.getFieldsMap(t);this.applyChanges(i,r,s)}delete(e){const t=this.field(e.popLast());gi(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return wt(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=t.mapValue.fields[e.get(r)];gi(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,r){En(t,((s,i)=>e[s]=i));for(const s of r)delete e[s]}clone(){return new He(ms(this.value))}}function Td(n){const e=[];return En(n.fields,((t,r)=>{const s=new Se([t]);if(gi(r)){const i=Td(r.mapValue).fields;if(i.length===0)e.push(s);else for(const a of i)e.push(s.child(a))}else e.push(s)})),new Ye(e)}class Le{constructor(e,t,r,s,i,a,c){this.key=e,this.documentType=t,this.version=r,this.readTime=s,this.createTime=i,this.data=a,this.documentState=c}static newInvalidDocument(e){return new Le(e,0,$.min(),$.min(),$.min(),He.empty(),0)}static newFoundDocument(e,t,r,s){return new Le(e,1,t,$.min(),r,s,0)}static newNoDocument(e,t){return new Le(e,2,t,$.min(),$.min(),He.empty(),0)}static newUnknownDocument(e,t){return new Le(e,3,t,$.min(),$.min(),He.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual($.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=He.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=He.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=$.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Le&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Le(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Vi{constructor(e,t){this.position=e,this.inclusive=t}}function Jl(n,e,t){let r=0;for(let s=0;s<n.position.length;s++){const i=e[s],a=n.position[s];if(i.field.isKeyField()?r=U.comparator(U.fromName(a.referenceValue),t.key):r=Sr(a,t.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function Yl(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!wt(n.position[t],e.position[t]))return!1;return!0}class Oi{constructor(e,t="asc"){this.field=e,this.dir=t}}function wv(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class Id{}class ve extends Id{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new bv(e,t,r):t==="array-contains"?new Pv(e,r):t==="in"?new Cv(e,r):t==="not-in"?new kv(e,r):t==="array-contains-any"?new Nv(e,r):new ve(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new Rv(e,r):new Sv(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Sr(t,this.value)):t!==null&&mn(this.value)===mn(t)&&this.matchesComparison(Sr(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return B(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class At extends Id{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new At(e,t)}matches(e){return wd(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function wd(n){return n.op==="and"}function Ad(n){return Av(n)&&wd(n)}function Av(n){for(const e of n.filters)if(e instanceof At)return!1;return!0}function Oa(n){if(n instanceof ve)return n.field.canonicalString()+n.op.toString()+Pr(n.value);if(Ad(n))return n.filters.map((e=>Oa(e))).join(",");{const e=n.filters.map((t=>Oa(t))).join(",");return`${n.op}(${e})`}}function bd(n,e){return n instanceof ve?(function(r,s){return s instanceof ve&&r.op===s.op&&r.field.isEqual(s.field)&&wt(r.value,s.value)})(n,e):n instanceof At?(function(r,s){return s instanceof At&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce(((i,a,c)=>i&&bd(a,s.filters[c])),!0):!1})(n,e):void B(19439)}function Rd(n){return n instanceof ve?(function(t){return`${t.field.canonicalString()} ${t.op} ${Pr(t.value)}`})(n):n instanceof At?(function(t){return t.op.toString()+" {"+t.getFilters().map(Rd).join(" ,")+"}"})(n):"Filter"}class bv extends ve{constructor(e,t,r){super(e,t,r),this.key=U.fromName(r.referenceValue)}matches(e){const t=U.comparator(e.key,this.key);return this.matchesComparison(t)}}class Rv extends ve{constructor(e,t){super(e,"in",t),this.keys=Sd("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class Sv extends ve{constructor(e,t){super(e,"not-in",t),this.keys=Sd("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function Sd(n,e){return(e.arrayValue?.values||[]).map((t=>U.fromName(t.referenceValue)))}class Pv extends ve{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Rc(t)&&Ss(t.arrayValue,this.value)}}class Cv extends ve{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Ss(this.value.arrayValue,t)}}class kv extends ve{constructor(e,t){super(e,"not-in",t)}matches(e){if(Ss(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Ss(this.value.arrayValue,t)}}class Nv extends ve{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Rc(t)||!t.arrayValue.values)&&t.arrayValue.values.some((r=>Ss(this.value.arrayValue,r)))}}class Dv{constructor(e,t=null,r=[],s=[],i=null,a=null,c=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=a,this.endAt=c,this.Te=null}}function Zl(n,e=null,t=[],r=[],s=null,i=null,a=null){return new Dv(n,e,t,r,s,i,a)}function Sc(n){const e=z(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((r=>Oa(r))).join(","),t+="|ob:",t+=e.orderBy.map((r=>(function(i){return i.field.canonicalString()+i.dir})(r))).join(","),uo(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((r=>Pr(r))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((r=>Pr(r))).join(",")),e.Te=t}return e.Te}function Pc(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!wv(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!bd(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Yl(n.startAt,e.startAt)&&Yl(n.endAt,e.endAt)}function Ma(n){return U.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}class ho{constructor(e,t=null,r=[],s=[],i=null,a="F",c=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=a,this.startAt=c,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function Vv(n,e,t,r,s,i,a,c){return new ho(n,e,t,r,s,i,a,c)}function Cc(n){return new ho(n)}function eh(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function Ov(n){return n.collectionGroup!==null}function gs(n){const e=z(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),t.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let c=new Te(Se.comparator);return a.filters.forEach((l=>{l.getFlattenedFilters().forEach((h=>{h.isInequality()&&(c=c.add(h.field))}))})),c})(e).forEach((i=>{t.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new Oi(i,r))})),t.has(Se.keyField().canonicalString())||e.Ie.push(new Oi(Se.keyField(),r))}return e.Ie}function _t(n){const e=z(n);return e.Ee||(e.Ee=Mv(e,gs(n))),e.Ee}function Mv(n,e){if(n.limitType==="F")return Zl(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((s=>{const i=s.dir==="desc"?"asc":"desc";return new Oi(s.field,i)}));const t=n.endAt?new Vi(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Vi(n.startAt.position,n.startAt.inclusive):null;return Zl(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function La(n,e,t){return new ho(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function fo(n,e){return Pc(_t(n),_t(e))&&n.limitType===e.limitType}function Pd(n){return`${Sc(_t(n))}|lt:${n.limitType}`}function nr(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map((s=>Rd(s))).join(", ")}]`),uo(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map((s=>(function(a){return`${a.field.canonicalString()} (${a.dir})`})(s))).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map((s=>Pr(s))).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map((s=>Pr(s))).join(",")),`Target(${r})`})(_t(n))}; limitType=${n.limitType})`}function po(n,e){return e.isFoundDocument()&&(function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):U.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)})(n,e)&&(function(r,s){for(const i of gs(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0})(n,e)&&(function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0})(n,e)&&(function(r,s){return!(r.startAt&&!(function(a,c,l){const h=Jl(a,c,l);return a.inclusive?h<=0:h<0})(r.startAt,gs(r),s)||r.endAt&&!(function(a,c,l){const h=Jl(a,c,l);return a.inclusive?h>=0:h>0})(r.endAt,gs(r),s))})(n,e)}function Lv(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function Cd(n){return(e,t)=>{let r=!1;for(const s of gs(n)){const i=xv(s,e,t);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function xv(n,e,t){const r=n.field.isKeyField()?U.comparator(e.key,t.key):(function(i,a,c){const l=a.data.field(i),h=c.data.field(i);return l!==null&&h!==null?Sr(l,h):B(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return B(19790,{direction:n.dir})}}class Gn{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[t]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){En(this.inner,((t,r)=>{for(const[s,i]of r)e(s,i)}))}isEmpty(){return dd(this.inner)}size(){return this.innerSize}}const Fv=new ue(U.comparator);function Lt(){return Fv}const kd=new ue(U.comparator);function us(...n){let e=kd;for(const t of n)e=e.insert(t.key,t);return e}function Nd(n){let e=kd;return n.forEach(((t,r)=>e=e.insert(t,r.overlayedDocument))),e}function kn(){return _s()}function Dd(){return _s()}function _s(){return new Gn((n=>n.toString()),((n,e)=>n.isEqual(e)))}const Uv=new ue(U.comparator),Bv=new Te(U.comparator);function K(...n){let e=Bv;for(const t of n)e=e.add(t);return e}const jv=new Te(G);function $v(){return jv}function kc(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ki(e)?"-0":e}}function Vd(n){return{integerValue:""+n}}function qv(n,e){return mv(e)?Vd(e):kc(n,e)}class mo{constructor(){this._=void 0}}function zv(n,e,t){return n instanceof Mi?(function(s,i){const a={fields:{[gd]:{stringValue:md},[yd]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&bc(i)&&(i=lo(i)),i&&(a.fields[_d]=i),{mapValue:a}})(t,e):n instanceof Ps?Md(n,e):n instanceof Cs?Ld(n,e):(function(s,i){const a=Od(s,i),c=th(a)+th(s.Ae);return Va(a)&&Va(s.Ae)?Vd(c):kc(s.serializer,c)})(n,e)}function Hv(n,e,t){return n instanceof Ps?Md(n,e):n instanceof Cs?Ld(n,e):t}function Od(n,e){return n instanceof Li?(function(r){return Va(r)||(function(i){return!!i&&"doubleValue"in i})(r)})(e)?e:{integerValue:0}:null}class Mi extends mo{}class Ps extends mo{constructor(e){super(),this.elements=e}}function Md(n,e){const t=xd(e);for(const r of n.elements)t.some((s=>wt(s,r)))||t.push(r);return{arrayValue:{values:t}}}class Cs extends mo{constructor(e){super(),this.elements=e}}function Ld(n,e){let t=xd(e);for(const r of n.elements)t=t.filter((s=>!wt(s,r)));return{arrayValue:{values:t}}}class Li extends mo{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function th(n){return de(n.integerValue||n.doubleValue)}function xd(n){return Rc(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function Wv(n,e){return n.field.isEqual(e.field)&&(function(r,s){return r instanceof Ps&&s instanceof Ps||r instanceof Cs&&s instanceof Cs?Rr(r.elements,s.elements,wt):r instanceof Li&&s instanceof Li?wt(r.Ae,s.Ae):r instanceof Mi&&s instanceof Mi})(n.transform,e.transform)}class Gv{constructor(e,t){this.version=e,this.transformResults=t}}class it{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new it}static exists(e){return new it(void 0,e)}static updateTime(e){return new it(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function _i(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class go{}function Fd(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Nc(n.key,it.none()):new xs(n.key,n.data,it.none());{const t=n.data,r=He.empty();let s=new Te(Se.comparator);for(let i of e.fields)if(!s.has(i)){let a=t.field(i);a===null&&i.length>1&&(i=i.popLast(),a=t.field(i)),a===null?r.delete(i):r.set(i,a),s=s.add(i)}return new Tn(n.key,r,new Ye(s.toArray()),it.none())}}function Kv(n,e,t){n instanceof xs?(function(s,i,a){const c=s.value.clone(),l=rh(s.fieldTransforms,i,a.transformResults);c.setAll(l),i.convertToFoundDocument(a.version,c).setHasCommittedMutations()})(n,e,t):n instanceof Tn?(function(s,i,a){if(!_i(s.precondition,i))return void i.convertToUnknownDocument(a.version);const c=rh(s.fieldTransforms,i,a.transformResults),l=i.data;l.setAll(Ud(s)),l.setAll(c),i.convertToFoundDocument(a.version,l).setHasCommittedMutations()})(n,e,t):(function(s,i,a){i.convertToNoDocument(a.version).setHasCommittedMutations()})(0,e,t)}function ys(n,e,t,r){return n instanceof xs?(function(i,a,c,l){if(!_i(i.precondition,a))return c;const h=i.value.clone(),d=sh(i.fieldTransforms,l,a);return h.setAll(d),a.convertToFoundDocument(a.version,h).setHasLocalMutations(),null})(n,e,t,r):n instanceof Tn?(function(i,a,c,l){if(!_i(i.precondition,a))return c;const h=sh(i.fieldTransforms,l,a),d=a.data;return d.setAll(Ud(i)),d.setAll(h),a.convertToFoundDocument(a.version,d).setHasLocalMutations(),c===null?null:c.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map((g=>g.field)))})(n,e,t,r):(function(i,a,c){return _i(i.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):c})(n,e,t)}function Qv(n,e){let t=null;for(const r of n.fieldTransforms){const s=e.data.field(r.field),i=Od(r.transform,s||null);i!=null&&(t===null&&(t=He.empty()),t.set(r.field,i))}return t||null}function nh(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&Rr(r,s,((i,a)=>Wv(i,a)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class xs extends go{constructor(e,t,r,s=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Tn extends go{constructor(e,t,r,s,i=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Ud(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}})),e}function rh(n,e,t){const r=new Map;te(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let s=0;s<t.length;s++){const i=n[s],a=i.transform,c=e.data.field(i.field);r.set(i.field,Hv(a,c,t[s]))}return r}function sh(n,e,t){const r=new Map;for(const s of n){const i=s.transform,a=t.data.field(s.field);r.set(s.field,zv(i,a,e))}return r}class Nc extends go{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Xv extends go{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Jv{constructor(e,t,r,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&Kv(i,e,r[s])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=ys(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=ys(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=Dd();return this.mutations.forEach((s=>{const i=e.get(s.key),a=i.overlayedDocument;let c=this.applyToLocalView(a,i.mutatedFields);c=t.has(s.key)?null:c;const l=Fd(a,c);l!==null&&r.set(s.key,l),a.isValidDocument()||a.convertToNoDocument($.min())})),r}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),K())}isEqual(e){return this.batchId===e.batchId&&Rr(this.mutations,e.mutations,((t,r)=>nh(t,r)))&&Rr(this.baseMutations,e.baseMutations,((t,r)=>nh(t,r)))}}class Dc{constructor(e,t,r,s){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=s}static from(e,t,r){te(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let s=(function(){return Uv})();const i=e.mutations;for(let a=0;a<i.length;a++)s=s.insert(i[a].key,r[a].version);return new Dc(e,t,r,s)}}class Yv{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class Zv{constructor(e,t){this.count=e,this.unchangedNames=t}}var pe,X;function eE(n){switch(n){case N.OK:return B(64938);case N.CANCELLED:case N.UNKNOWN:case N.DEADLINE_EXCEEDED:case N.RESOURCE_EXHAUSTED:case N.INTERNAL:case N.UNAVAILABLE:case N.UNAUTHENTICATED:return!1;case N.INVALID_ARGUMENT:case N.NOT_FOUND:case N.ALREADY_EXISTS:case N.PERMISSION_DENIED:case N.FAILED_PRECONDITION:case N.ABORTED:case N.OUT_OF_RANGE:case N.UNIMPLEMENTED:case N.DATA_LOSS:return!0;default:return B(15467,{code:n})}}function Bd(n){if(n===void 0)return Mt("GRPC error has no .code"),N.UNKNOWN;switch(n){case pe.OK:return N.OK;case pe.CANCELLED:return N.CANCELLED;case pe.UNKNOWN:return N.UNKNOWN;case pe.DEADLINE_EXCEEDED:return N.DEADLINE_EXCEEDED;case pe.RESOURCE_EXHAUSTED:return N.RESOURCE_EXHAUSTED;case pe.INTERNAL:return N.INTERNAL;case pe.UNAVAILABLE:return N.UNAVAILABLE;case pe.UNAUTHENTICATED:return N.UNAUTHENTICATED;case pe.INVALID_ARGUMENT:return N.INVALID_ARGUMENT;case pe.NOT_FOUND:return N.NOT_FOUND;case pe.ALREADY_EXISTS:return N.ALREADY_EXISTS;case pe.PERMISSION_DENIED:return N.PERMISSION_DENIED;case pe.FAILED_PRECONDITION:return N.FAILED_PRECONDITION;case pe.ABORTED:return N.ABORTED;case pe.OUT_OF_RANGE:return N.OUT_OF_RANGE;case pe.UNIMPLEMENTED:return N.UNIMPLEMENTED;case pe.DATA_LOSS:return N.DATA_LOSS;default:return B(39323,{code:n})}}(X=pe||(pe={}))[X.OK=0]="OK",X[X.CANCELLED=1]="CANCELLED",X[X.UNKNOWN=2]="UNKNOWN",X[X.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",X[X.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",X[X.NOT_FOUND=5]="NOT_FOUND",X[X.ALREADY_EXISTS=6]="ALREADY_EXISTS",X[X.PERMISSION_DENIED=7]="PERMISSION_DENIED",X[X.UNAUTHENTICATED=16]="UNAUTHENTICATED",X[X.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",X[X.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",X[X.ABORTED=10]="ABORTED",X[X.OUT_OF_RANGE=11]="OUT_OF_RANGE",X[X.UNIMPLEMENTED=12]="UNIMPLEMENTED",X[X.INTERNAL=13]="INTERNAL",X[X.UNAVAILABLE=14]="UNAVAILABLE",X[X.DATA_LOSS=15]="DATA_LOSS";function tE(){return new TextEncoder}const nE=new cn([4294967295,4294967295],0);function ih(n){const e=tE().encode(n),t=new nd;return t.update(e),new Uint8Array(t.digest())}function oh(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new cn([t,r],0),new cn([s,i],0)]}class Vc{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new ls(`Invalid padding: ${t}`);if(r<0)throw new ls(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new ls(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new ls(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=cn.fromNumber(this.ge)}ye(e,t,r){let s=e.add(t.multiply(cn.fromNumber(r)));return s.compare(nE)===1&&(s=new cn([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=ih(e),[r,s]=oh(t);for(let i=0;i<this.hashCount;i++){const a=this.ye(r,s,i);if(!this.we(a))return!1}return!0}static create(e,t,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),a=new Vc(i,s,t);return r.forEach((c=>a.insert(c))),a}insert(e){if(this.ge===0)return;const t=ih(e),[r,s]=oh(t);for(let i=0;i<this.hashCount;i++){const a=this.ye(r,s,i);this.Se(a)}}Se(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class ls extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class _o{constructor(e,t,r,s,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const s=new Map;return s.set(e,Fs.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new _o($.min(),s,new ue(G),Lt(),K())}}class Fs{constructor(e,t,r,s,i){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new Fs(r,t,K(),K(),K())}}class yi{constructor(e,t,r,s){this.be=e,this.removedTargetIds=t,this.key=r,this.De=s}}class jd{constructor(e,t){this.targetId=e,this.Ce=t}}class $d{constructor(e,t,r=Ne.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=s}}class ah{constructor(){this.ve=0,this.Fe=ch(),this.Me=Ne.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=K(),t=K(),r=K();return this.Fe.forEach(((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:r=r.add(s);break;default:B(38017,{changeType:i})}})),new Fs(this.Me,this.xe,e,t,r)}qe(){this.Oe=!1,this.Fe=ch()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,te(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class rE{constructor(e){this.Ge=e,this.ze=new Map,this.je=Lt(),this.Je=ui(),this.He=ui(),this.Ye=new ue(G)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:B(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((r,s)=>{this.rt(s)&&t(s)}))}st(e){const t=e.targetId,r=e.Ce.count,s=this.ot(t);if(s){const i=s.target;if(Ma(i))if(r===0){const a=new U(i.path);this.et(t,a,Le.newNoDocument(a,$.min()))}else te(r===1,20013,{expectedCount:r});else{const a=this._t(t);if(a!==r){const c=this.ut(e),l=c?this.ct(c,e,a):1;if(l!==0){this.it(t);const h=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,h)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=t;let a,c;try{a=pn(r).toUint8Array()}catch(l){if(l instanceof pd)return br("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{c=new Vc(a,s,i)}catch(l){return br(l instanceof ls?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return c.ge===0?null:c}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){const r=this.Ge.getRemoteKeysForTarget(t);let s=0;return r.forEach((i=>{const a=this.Ge.ht(),c=`projects/${a.projectId}/databases/${a.database}/documents/${i.path.canonicalString()}`;e.mightContain(c)||(this.et(t,i,null),s++)})),s}Tt(e){const t=new Map;this.ze.forEach(((i,a)=>{const c=this.ot(a);if(c){if(i.current&&Ma(c.target)){const l=new U(c.target.path);this.It(l).has(a)||this.Et(a,l)||this.et(a,l,Le.newNoDocument(l,e))}i.Be&&(t.set(a,i.ke()),i.qe())}}));let r=K();this.He.forEach(((i,a)=>{let c=!0;a.forEachWhile((l=>{const h=this.ot(l);return!h||h.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)})),c&&(r=r.add(i))})),this.je.forEach(((i,a)=>a.setReadTime(e)));const s=new _o(e,t,this.Ye,this.je,r);return this.je=Lt(),this.Je=ui(),this.He=ui(),this.Ye=new ue(G),s}Xe(e,t){if(!this.rt(e))return;const r=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,r),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,t)?s.Qe(t,1):s.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new ah,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Te(G),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Te(G),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||M("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new ah),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function ui(){return new ue(U.comparator)}function ch(){return new ue(U.comparator)}const sE={asc:"ASCENDING",desc:"DESCENDING"},iE={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},oE={and:"AND",or:"OR"};class aE{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function xa(n,e){return n.useProto3Json||uo(e)?e:{value:e}}function xi(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function qd(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function cE(n,e){return xi(n,e.toTimestamp())}function yt(n){return te(!!n,49232),$.fromTimestamp((function(t){const r=dn(t);return new ce(r.seconds,r.nanos)})(n))}function Oc(n,e){return Fa(n,e).canonicalString()}function Fa(n,e){const t=(function(s){return new ae(["projects",s.projectId,"databases",s.database])})(n).child("documents");return e===void 0?t:t.child(e)}function zd(n){const e=ae.fromString(n);return te(Qd(e),10190,{key:e.toString()}),e}function Ua(n,e){return Oc(n.databaseId,e.path)}function la(n,e){const t=zd(e);if(t.get(1)!==n.databaseId.projectId)throw new x(N.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new x(N.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new U(Wd(t))}function Hd(n,e){return Oc(n.databaseId,e)}function uE(n){const e=zd(n);return e.length===4?ae.emptyPath():Wd(e)}function Ba(n){return new ae(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Wd(n){return te(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function uh(n,e,t){return{name:Ua(n,e),fields:t.value.mapValue.fields}}function lE(n,e){let t;if("targetChange"in e){e.targetChange;const r=(function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:B(39313,{state:h})})(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=(function(h,d){return h.useProto3Json?(te(d===void 0||typeof d=="string",58123),Ne.fromBase64String(d||"")):(te(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),Ne.fromUint8Array(d||new Uint8Array))})(n,e.targetChange.resumeToken),a=e.targetChange.cause,c=a&&(function(h){const d=h.code===void 0?N.UNKNOWN:Bd(h.code);return new x(d,h.message||"")})(a);t=new $d(r,s,i,c||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=la(n,r.document.name),i=yt(r.document.updateTime),a=r.document.createTime?yt(r.document.createTime):$.min(),c=new He({mapValue:{fields:r.document.fields}}),l=Le.newFoundDocument(s,i,a,c),h=r.targetIds||[],d=r.removedTargetIds||[];t=new yi(h,d,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=la(n,r.document),i=r.readTime?yt(r.readTime):$.min(),a=Le.newNoDocument(s,i),c=r.removedTargetIds||[];t=new yi([],c,a.key,a)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=la(n,r.document),i=r.removedTargetIds||[];t=new yi([],i,s,null)}else{if(!("filter"in e))return B(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,a=new Zv(s,i),c=r.targetId;t=new jd(c,a)}}return t}function hE(n,e){let t;if(e instanceof xs)t={update:uh(n,e.key,e.value)};else if(e instanceof Nc)t={delete:Ua(n,e.key)};else if(e instanceof Tn)t={update:uh(n,e.key,e.data),updateMask:EE(e.fieldMask)};else{if(!(e instanceof Xv))return B(16599,{Vt:e.type});t={verify:Ua(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((r=>(function(i,a){const c=a.transform;if(c instanceof Mi)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof Ps)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof Cs)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof Li)return{fieldPath:a.field.canonicalString(),increment:c.Ae};throw B(20930,{transform:a.transform})})(0,r)))),e.precondition.isNone||(t.currentDocument=(function(s,i){return i.updateTime!==void 0?{updateTime:cE(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:B(27497)})(n,e.precondition)),t}function fE(n,e){return n&&n.length>0?(te(e!==void 0,14353),n.map((t=>(function(s,i){let a=s.updateTime?yt(s.updateTime):yt(i);return a.isEqual($.min())&&(a=yt(i)),new Gv(a,s.transformResults||[])})(t,e)))):[]}function dE(n,e){return{documents:[Hd(n,e.path)]}}function pE(n,e){const t={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=Hd(n,s);const i=(function(h){if(h.length!==0)return Kd(At.create(h,"and"))})(e.filters);i&&(t.structuredQuery.where=i);const a=(function(h){if(h.length!==0)return h.map((d=>(function(m){return{field:rr(m.field),direction:_E(m.dir)}})(d)))})(e.orderBy);a&&(t.structuredQuery.orderBy=a);const c=xa(n,e.limit);return c!==null&&(t.structuredQuery.limit=c),e.startAt&&(t.structuredQuery.startAt=(function(h){return{before:h.inclusive,values:h.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(h){return{before:!h.inclusive,values:h.position}})(e.endAt)),{ft:t,parent:s}}function mE(n){let e=uE(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let s=null;if(r>0){te(r===1,65062);const d=t.from[0];d.allDescendants?s=d.collectionId:e=e.child(d.collectionId)}let i=[];t.where&&(i=(function(g){const m=Gd(g);return m instanceof At&&Ad(m)?m.getFilters():[m]})(t.where));let a=[];t.orderBy&&(a=(function(g){return g.map((m=>(function(S){return new Oi(sr(S.field),(function(P){switch(P){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(S.direction))})(m)))})(t.orderBy));let c=null;t.limit&&(c=(function(g){let m;return m=typeof g=="object"?g.value:g,uo(m)?null:m})(t.limit));let l=null;t.startAt&&(l=(function(g){const m=!!g.before,E=g.values||[];return new Vi(E,m)})(t.startAt));let h=null;return t.endAt&&(h=(function(g){const m=!g.before,E=g.values||[];return new Vi(E,m)})(t.endAt)),Vv(e,s,a,i,c,"F",l,h)}function gE(n,e){const t=(function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return B(28987,{purpose:s})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Gd(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=sr(t.unaryFilter.field);return ve.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=sr(t.unaryFilter.field);return ve.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=sr(t.unaryFilter.field);return ve.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=sr(t.unaryFilter.field);return ve.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return B(61313);default:return B(60726)}})(n):n.fieldFilter!==void 0?(function(t){return ve.create(sr(t.fieldFilter.field),(function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return B(58110);default:return B(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return At.create(t.compositeFilter.filters.map((r=>Gd(r))),(function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return B(1026)}})(t.compositeFilter.op))})(n):B(30097,{filter:n})}function _E(n){return sE[n]}function yE(n){return iE[n]}function vE(n){return oE[n]}function rr(n){return{fieldPath:n.canonicalString()}}function sr(n){return Se.fromServerFormat(n.fieldPath)}function Kd(n){return n instanceof ve?(function(t){if(t.op==="=="){if(Xl(t.value))return{unaryFilter:{field:rr(t.field),op:"IS_NAN"}};if(Ql(t.value))return{unaryFilter:{field:rr(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Xl(t.value))return{unaryFilter:{field:rr(t.field),op:"IS_NOT_NAN"}};if(Ql(t.value))return{unaryFilter:{field:rr(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:rr(t.field),op:yE(t.op),value:t.value}}})(n):n instanceof At?(function(t){const r=t.getFilters().map((s=>Kd(s)));return r.length===1?r[0]:{compositeFilter:{op:vE(t.op),filters:r}}})(n):B(54877,{filter:n})}function EE(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function Qd(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}class tn{constructor(e,t,r,s,i=$.min(),a=$.min(),c=Ne.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=c,this.expectedCount=l}withSequenceNumber(e){return new tn(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new tn(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new tn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new tn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class TE{constructor(e){this.yt=e}}function IE(n){const e=mE({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?La(e,e.limit,"L"):e}class wE{constructor(){this.Cn=new AE}addToCollectionParentIndex(e,t){return this.Cn.add(t),k.resolve()}getCollectionParents(e,t){return k.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return k.resolve()}deleteFieldIndex(e,t){return k.resolve()}deleteAllFieldIndexes(e){return k.resolve()}createTargetIndexes(e,t){return k.resolve()}getDocumentsMatchingTarget(e,t){return k.resolve(null)}getIndexType(e,t){return k.resolve(0)}getFieldIndexes(e,t){return k.resolve([])}getNextCollectionGroupToUpdate(e){return k.resolve(null)}getMinOffset(e,t){return k.resolve(fn.min())}getMinOffsetFromCollectionGroup(e,t){return k.resolve(fn.min())}updateCollectionGroup(e,t,r){return k.resolve()}updateIndexEntries(e,t){return k.resolve()}}class AE{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t]||new Te(ae.comparator),i=!s.has(r);return this.index[t]=s.add(r),i}has(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t];return s&&s.has(r)}getEntries(e){return(this.index[e]||new Te(ae.comparator)).toArray()}}const lh={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Xd=41943040;class qe{static withCacheSize(e){return new qe(e,qe.DEFAULT_COLLECTION_PERCENTILE,qe.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}qe.DEFAULT_COLLECTION_PERCENTILE=10,qe.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,qe.DEFAULT=new qe(Xd,qe.DEFAULT_COLLECTION_PERCENTILE,qe.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),qe.DISABLED=new qe(-1,0,0);class Cr{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Cr(0)}static cr(){return new Cr(-1)}}const hh="LruGarbageCollector",bE=1048576;function fh([n,e],[t,r]){const s=G(n,t);return s===0?G(e,r):s}class RE{constructor(e){this.Ir=e,this.buffer=new Te(fh),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();fh(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class SE{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){M(hh,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Br(t)?M(hh,"Ignoring IndexedDB error during garbage collection: ",t):await Ur(t)}await this.Vr(3e5)}))}}class PE{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((r=>Math.floor(t/100*r)))}nthSequenceNumber(e,t){if(t===0)return k.resolve(co.ce);const r=new RE(t);return this.mr.forEachTarget(e,(s=>r.Ar(s.sequenceNumber))).next((()=>this.mr.pr(e,(s=>r.Ar(s))))).next((()=>r.maxValue))}removeTargets(e,t,r){return this.mr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(M("LruGarbageCollector","Garbage collection skipped; disabled"),k.resolve(lh)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(M("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),lh):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let r,s,i,a,c,l,h;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((g=>(g>this.params.maximumSequenceNumbersToCollect?(M("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${g}`),s=this.params.maximumSequenceNumbersToCollect):s=g,a=Date.now(),this.nthSequenceNumber(e,s)))).next((g=>(r=g,c=Date.now(),this.removeTargets(e,r,t)))).next((g=>(i=g,l=Date.now(),this.removeOrphanedDocuments(e,r)))).next((g=>(h=Date.now(),tr()<=W.DEBUG&&M("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-d}ms
	Determined least recently used ${s} in `+(c-a)+`ms
	Removed ${i} targets in `+(l-c)+`ms
	Removed ${g} documents in `+(h-l)+`ms
Total Duration: ${h-d}ms`),k.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:g}))))}}function CE(n,e){return new PE(n,e)}class kE{constructor(){this.changes=new Gn((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Le.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?k.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class NE{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class DE{constructor(e,t,r,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next((s=>(r=s,this.remoteDocumentCache.getEntry(e,t)))).next((s=>(r!==null&&ys(r.mutation,s,Ye.empty(),ce.now()),s)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.getLocalViewOfDocuments(e,r,K()).next((()=>r))))}getLocalViewOfDocuments(e,t,r=K()){const s=kn();return this.populateOverlays(e,s,t).next((()=>this.computeViews(e,t,s,r).next((i=>{let a=us();return i.forEach(((c,l)=>{a=a.insert(c,l.overlayedDocument)})),a}))))}getOverlayedDocuments(e,t){const r=kn();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,K())))}populateOverlays(e,t,r){const s=[];return r.forEach((i=>{t.has(i)||s.push(i)})),this.documentOverlayCache.getOverlays(e,s).next((i=>{i.forEach(((a,c)=>{t.set(a,c)}))}))}computeViews(e,t,r,s){let i=Lt();const a=_s(),c=(function(){return _s()})();return t.forEach(((l,h)=>{const d=r.get(h.key);s.has(h.key)&&(d===void 0||d.mutation instanceof Tn)?i=i.insert(h.key,h):d!==void 0?(a.set(h.key,d.mutation.getFieldMask()),ys(d.mutation,h,d.mutation.getFieldMask(),ce.now())):a.set(h.key,Ye.empty())})),this.recalculateAndSaveOverlays(e,i).next((l=>(l.forEach(((h,d)=>a.set(h,d))),t.forEach(((h,d)=>c.set(h,new NE(d,a.get(h)??null)))),c)))}recalculateAndSaveOverlays(e,t){const r=_s();let s=new ue(((a,c)=>a-c)),i=K();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((a=>{for(const c of a)c.keys().forEach((l=>{const h=t.get(l);if(h===null)return;let d=r.get(l)||Ye.empty();d=c.applyToLocalView(h,d),r.set(l,d);const g=(s.get(c.batchId)||K()).add(l);s=s.insert(c.batchId,g)}))})).next((()=>{const a=[],c=s.getReverseIterator();for(;c.hasNext();){const l=c.getNext(),h=l.key,d=l.value,g=Dd();d.forEach((m=>{if(!i.has(m)){const E=Fd(t.get(m),r.get(m));E!==null&&g.set(m,E),i=i.add(m)}})),a.push(this.documentOverlayCache.saveOverlays(e,h,g))}return k.waitFor(a)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,t,r,s){return(function(a){return U.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Ov(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,s):this.getDocumentsMatchingCollectionQuery(e,t,r,s)}getNextDocuments(e,t,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,s).next((i=>{const a=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,s-i.size):k.resolve(kn());let c=As,l=i;return a.next((h=>k.forEach(h,((d,g)=>(c<g.largestBatchId&&(c=g.largestBatchId),i.get(d)?k.resolve():this.remoteDocumentCache.getEntry(e,d).next((m=>{l=l.insert(d,m)}))))).next((()=>this.populateOverlays(e,h,i))).next((()=>this.computeViews(e,l,h,K()))).next((d=>({batchId:c,changes:Nd(d)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new U(t)).next((r=>{let s=us();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s}))}getDocumentsMatchingCollectionGroupQuery(e,t,r,s){const i=t.collectionGroup;let a=us();return this.indexManager.getCollectionParents(e,i).next((c=>k.forEach(c,(l=>{const h=(function(g,m){return new ho(m,null,g.explicitOrderBy.slice(),g.filters.slice(),g.limit,g.limitType,g.startAt,g.endAt)})(t,l.child(i));return this.getDocumentsMatchingCollectionQuery(e,h,r,s).next((d=>{d.forEach(((g,m)=>{a=a.insert(g,m)}))}))})).next((()=>a))))}getDocumentsMatchingCollectionQuery(e,t,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next((a=>(i=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,i,s)))).next((a=>{i.forEach(((l,h)=>{const d=h.getKey();a.get(d)===null&&(a=a.insert(d,Le.newInvalidDocument(d)))}));let c=us();return a.forEach(((l,h)=>{const d=i.get(l);d!==void 0&&ys(d.mutation,h,Ye.empty(),ce.now()),po(t,h)&&(c=c.insert(l,h))})),c}))}}class VE{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return k.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(s){return{id:s.id,version:s.version,createTime:yt(s.createTime)}})(t)),k.resolve()}getNamedQuery(e,t){return k.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(s){return{name:s.name,query:IE(s.bundledQuery),readTime:yt(s.readTime)}})(t)),k.resolve()}}class OE{constructor(){this.overlays=new ue(U.comparator),this.qr=new Map}getOverlay(e,t){return k.resolve(this.overlays.get(t))}getOverlays(e,t){const r=kn();return k.forEach(t,(s=>this.getOverlay(e,s).next((i=>{i!==null&&r.set(s,i)})))).next((()=>r))}saveOverlays(e,t,r){return r.forEach(((s,i)=>{this.St(e,t,i)})),k.resolve()}removeOverlaysForBatchId(e,t,r){const s=this.qr.get(r);return s!==void 0&&(s.forEach((i=>this.overlays=this.overlays.remove(i))),this.qr.delete(r)),k.resolve()}getOverlaysForCollection(e,t,r){const s=kn(),i=t.length+1,a=new U(t.child("")),c=this.overlays.getIteratorFrom(a);for(;c.hasNext();){const l=c.getNext().value,h=l.getKey();if(!t.isPrefixOf(h.path))break;h.path.length===i&&l.largestBatchId>r&&s.set(l.getKey(),l)}return k.resolve(s)}getOverlaysForCollectionGroup(e,t,r,s){let i=new ue(((h,d)=>h-d));const a=this.overlays.getIterator();for(;a.hasNext();){const h=a.getNext().value;if(h.getKey().getCollectionGroup()===t&&h.largestBatchId>r){let d=i.get(h.largestBatchId);d===null&&(d=kn(),i=i.insert(h.largestBatchId,d)),d.set(h.getKey(),h)}}const c=kn(),l=i.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach(((h,d)=>c.set(h,d))),!(c.size()>=s)););return k.resolve(c)}St(e,t,r){const s=this.overlays.get(r.key);if(s!==null){const a=this.qr.get(s.largestBatchId).delete(r.key);this.qr.set(s.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new Yv(t,r));let i=this.qr.get(t);i===void 0&&(i=K(),this.qr.set(t,i)),this.qr.set(t,i.add(r.key))}}class ME{constructor(){this.sessionToken=Ne.EMPTY_BYTE_STRING}getSessionToken(e){return k.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,k.resolve()}}class Mc{constructor(){this.Qr=new Te(Ae.$r),this.Ur=new Te(Ae.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const r=new Ae(e,t);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,t){e.forEach((r=>this.addReference(r,t)))}removeReference(e,t){this.Gr(new Ae(e,t))}zr(e,t){e.forEach((r=>this.removeReference(r,t)))}jr(e){const t=new U(new ae([])),r=new Ae(t,e),s=new Ae(t,e+1),i=[];return this.Ur.forEachInRange([r,s],(a=>{this.Gr(a),i.push(a.key)})),i}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new U(new ae([])),r=new Ae(t,e),s=new Ae(t,e+1);let i=K();return this.Ur.forEachInRange([r,s],(a=>{i=i.add(a.key)})),i}containsKey(e){const t=new Ae(e,0),r=this.Qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class Ae{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return U.comparator(e.key,t.key)||G(e.Yr,t.Yr)}static Kr(e,t){return G(e.Yr,t.Yr)||U.comparator(e.key,t.key)}}class LE{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Te(Ae.$r)}checkEmpty(e){return k.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,s){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new Jv(i,t,r,s);this.mutationQueue.push(a);for(const c of s)this.Zr=this.Zr.add(new Ae(c.key,i)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return k.resolve(a)}lookupMutationBatch(e,t){return k.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,s=this.ei(r),i=s<0?0:s;return k.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return k.resolve(this.mutationQueue.length===0?Ac:this.tr-1)}getAllMutationBatches(e){return k.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new Ae(t,0),s=new Ae(t,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([r,s],(a=>{const c=this.Xr(a.Yr);i.push(c)})),k.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Te(G);return t.forEach((s=>{const i=new Ae(s,0),a=new Ae(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,a],(c=>{r=r.add(c.Yr)}))})),k.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,s=r.length+1;let i=r;U.isDocumentKey(i)||(i=i.child(""));const a=new Ae(new U(i),0);let c=new Te(G);return this.Zr.forEachWhile((l=>{const h=l.key.path;return!!r.isPrefixOf(h)&&(h.length===s&&(c=c.add(l.Yr)),!0)}),a),k.resolve(this.ti(c))}ti(e){const t=[];return e.forEach((r=>{const s=this.Xr(r);s!==null&&t.push(s)})),t}removeMutationBatch(e,t){te(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return k.forEach(t.mutations,(s=>{const i=new Ae(s.key,t.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)})).next((()=>{this.Zr=r}))}ir(e){}containsKey(e,t){const r=new Ae(t,0),s=this.Zr.firstAfterOrEqual(r);return k.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,k.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class xE{constructor(e){this.ri=e,this.docs=(function(){return new ue(U.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,s=this.docs.get(r),i=s?s.size:0,a=this.ri(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return k.resolve(r?r.document.mutableCopy():Le.newInvalidDocument(t))}getEntries(e,t){let r=Lt();return t.forEach((s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():Le.newInvalidDocument(s))})),k.resolve(r)}getDocumentsMatchingQuery(e,t,r,s){let i=Lt();const a=t.path,c=new U(a.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(c);for(;l.hasNext();){const{key:h,value:{document:d}}=l.getNext();if(!a.isPrefixOf(h.path))break;h.path.length>a.length+1||hv(lv(d),r)<=0||(s.has(d.key)||po(t,d))&&(i=i.insert(d.key,d.mutableCopy()))}return k.resolve(i)}getAllFromCollectionGroup(e,t,r,s){B(9500)}ii(e,t){return k.forEach(this.docs,(r=>t(r)))}newChangeBuffer(e){return new FE(this)}getSize(e){return k.resolve(this.size)}}class FE extends kE{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((r,s)=>{s.isValidDocument()?t.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(r)})),k.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class UE{constructor(e){this.persistence=e,this.si=new Gn((t=>Sc(t)),Pc),this.lastRemoteSnapshotVersion=$.min(),this.highestTargetId=0,this.oi=0,this._i=new Mc,this.targetCount=0,this.ai=Cr.ur()}forEachTarget(e,t){return this.si.forEach(((r,s)=>t(s))),k.resolve()}getLastRemoteSnapshotVersion(e){return k.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return k.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),k.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.oi&&(this.oi=t),k.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Cr(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,k.resolve()}updateTargetData(e,t){return this.Pr(t),k.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,k.resolve()}removeTargets(e,t,r){let s=0;const i=[];return this.si.forEach(((a,c)=>{c.sequenceNumber<=t&&r.get(c.targetId)===null&&(this.si.delete(a),i.push(this.removeMatchingKeysForTargetId(e,c.targetId)),s++)})),k.waitFor(i).next((()=>s))}getTargetCount(e){return k.resolve(this.targetCount)}getTargetData(e,t){const r=this.si.get(t)||null;return k.resolve(r)}addMatchingKeys(e,t,r){return this._i.Wr(t,r),k.resolve()}removeMatchingKeys(e,t,r){this._i.zr(t,r);const s=this.persistence.referenceDelegate,i=[];return s&&t.forEach((a=>{i.push(s.markPotentiallyOrphaned(e,a))})),k.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),k.resolve()}getMatchingKeysForTargetId(e,t){const r=this._i.Hr(t);return k.resolve(r)}containsKey(e,t){return k.resolve(this._i.containsKey(t))}}class Jd{constructor(e,t){this.ui={},this.overlays={},this.ci=new co(0),this.li=!1,this.li=!0,this.hi=new ME,this.referenceDelegate=e(this),this.Pi=new UE(this),this.indexManager=new wE,this.remoteDocumentCache=(function(s){return new xE(s)})((r=>this.referenceDelegate.Ti(r))),this.serializer=new TE(t),this.Ii=new VE(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new OE,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ui[e.toKey()];return r||(r=new LE(t,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,r){M("MemoryPersistence","Starting transaction:",e);const s=new BE(this.ci.next());return this.referenceDelegate.Ei(),r(s).next((i=>this.referenceDelegate.di(s).next((()=>i)))).toPromise().then((i=>(s.raiseOnCommittedEvent(),i)))}Ai(e,t){return k.or(Object.values(this.ui).map((r=>()=>r.containsKey(e,t))))}}class BE extends dv{constructor(e){super(),this.currentSequenceNumber=e}}class Lc{constructor(e){this.persistence=e,this.Ri=new Mc,this.Vi=null}static mi(e){return new Lc(e)}get fi(){if(this.Vi)return this.Vi;throw B(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.fi.delete(r.toString()),k.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.fi.add(r.toString()),k.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),k.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((s=>this.fi.add(s.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((s=>{s.forEach((i=>this.fi.add(i.toString())))})).next((()=>r.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return k.forEach(this.fi,(r=>{const s=U.fromPath(r);return this.gi(e,s).next((i=>{i||t.removeEntry(s,$.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((r=>{r?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return k.or([()=>k.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class Fi{constructor(e,t){this.persistence=e,this.pi=new Gn((r=>gv(r.path)),((r,s)=>r.isEqual(s))),this.garbageCollector=CE(this,t)}static mi(e,t){return new Fi(e,t)}Ei(){}di(e){return k.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>t.next((s=>r+s))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}pr(e,t){return k.forEach(this.pi,((r,s)=>this.br(e,r,s).next((i=>i?k.resolve():t(s)))))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.ii(e,(a=>this.br(e,a,t).next((c=>{c||(r++,i.removeEntry(a,$.min()))})))).next((()=>i.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),k.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),k.resolve()}removeReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),k.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),k.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=mi(e.data.value)),t}br(e,t,r){return k.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const s=this.pi.get(t);return k.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class xc{constructor(e,t,r,s){this.targetId=e,this.fromCache=t,this.Es=r,this.ds=s}static As(e,t){let r=K(),s=K();for(const i of t.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new xc(e,t.fromCache,r,s)}}class jE{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class $E{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return D_()?8:pv(Fe())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,s){const i={result:null};return this.ys(e,t).next((a=>{i.result=a})).next((()=>{if(!i.result)return this.ws(e,t,s,r).next((a=>{i.result=a}))})).next((()=>{if(i.result)return;const a=new jE;return this.Ss(e,t,a).next((c=>{if(i.result=c,this.Vs)return this.bs(e,t,a,c.size)}))})).next((()=>i.result))}bs(e,t,r,s){return r.documentReadCount<this.fs?(tr()<=W.DEBUG&&M("QueryEngine","SDK will not create cache indexes for query:",nr(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),k.resolve()):(tr()<=W.DEBUG&&M("QueryEngine","Query:",nr(t),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.gs*s?(tr()<=W.DEBUG&&M("QueryEngine","The SDK decides to create cache indexes for query:",nr(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,_t(t))):k.resolve())}ys(e,t){if(eh(t))return k.resolve(null);let r=_t(t);return this.indexManager.getIndexType(e,r).next((s=>s===0?null:(t.limit!==null&&s===1&&(t=La(t,null,"F"),r=_t(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next((i=>{const a=K(...i);return this.ps.getDocuments(e,a).next((c=>this.indexManager.getMinOffset(e,r).next((l=>{const h=this.Ds(t,c);return this.Cs(t,h,a,l.readTime)?this.ys(e,La(t,null,"F")):this.vs(e,h,t,l)}))))})))))}ws(e,t,r,s){return eh(t)||s.isEqual($.min())?k.resolve(null):this.ps.getDocuments(e,r).next((i=>{const a=this.Ds(t,i);return this.Cs(t,a,r,s)?k.resolve(null):(tr()<=W.DEBUG&&M("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),nr(t)),this.vs(e,a,t,uv(s,As)).next((c=>c)))}))}Ds(e,t){let r=new Te(Cd(e));return t.forEach(((s,i)=>{po(e,i)&&(r=r.add(i))})),r}Cs(e,t,r,s){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const i=e.limitType==="F"?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Ss(e,t,r){return tr()<=W.DEBUG&&M("QueryEngine","Using full collection scan to execute query:",nr(t)),this.ps.getDocumentsMatchingQuery(e,t,fn.min(),r)}vs(e,t,r,s){return this.ps.getDocumentsMatchingQuery(e,r,s).next((i=>(t.forEach((a=>{i=i.insert(a.key,a)})),i)))}}const Fc="LocalStore",qE=3e8;class zE{constructor(e,t,r,s){this.persistence=e,this.Fs=t,this.serializer=s,this.Ms=new ue(G),this.xs=new Gn((i=>Sc(i)),Pc),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new DE(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function HE(n,e,t,r){return new zE(n,e,t,r)}async function Yd(n,e){const t=z(n);return await t.persistence.runTransaction("Handle user change","readonly",(r=>{let s;return t.mutationQueue.getAllMutationBatches(r).next((i=>(s=i,t.Bs(e),t.mutationQueue.getAllMutationBatches(r)))).next((i=>{const a=[],c=[];let l=K();for(const h of s){a.push(h.batchId);for(const d of h.mutations)l=l.add(d.key)}for(const h of i){c.push(h.batchId);for(const d of h.mutations)l=l.add(d.key)}return t.localDocuments.getDocuments(r,l).next((h=>({Ls:h,removedBatchIds:a,addedBatchIds:c})))}))}))}function WE(n,e){const t=z(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const s=e.batch.keys(),i=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(c,l,h,d){const g=h.batch,m=g.keys();let E=k.resolve();return m.forEach((S=>{E=E.next((()=>d.getEntry(l,S))).next((C=>{const P=h.docVersions.get(S);te(P!==null,48541),C.version.compareTo(P)<0&&(g.applyToRemoteDocument(C,h),C.isValidDocument()&&(C.setReadTime(h.commitVersion),d.addEntry(C)))}))})),E.next((()=>c.mutationQueue.removeMutationBatch(l,g)))})(t,r,e,i).next((()=>i.apply(r))).next((()=>t.mutationQueue.performConsistencyCheck(r))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(c){let l=K();for(let h=0;h<c.mutationResults.length;++h)c.mutationResults[h].transformResults.length>0&&(l=l.add(c.batch.mutations[h].key));return l})(e)))).next((()=>t.localDocuments.getDocuments(r,s)))}))}function Zd(n){const e=z(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function GE(n,e){const t=z(n),r=e.snapshotVersion;let s=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(i=>{const a=t.Ns.newChangeBuffer({trackRemovals:!0});s=t.Ms;const c=[];e.targetChanges.forEach(((d,g)=>{const m=s.get(g);if(!m)return;c.push(t.Pi.removeMatchingKeys(i,d.removedDocuments,g).next((()=>t.Pi.addMatchingKeys(i,d.addedDocuments,g))));let E=m.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(g)!==null?E=E.withResumeToken(Ne.EMPTY_BYTE_STRING,$.min()).withLastLimboFreeSnapshotVersion($.min()):d.resumeToken.approximateByteSize()>0&&(E=E.withResumeToken(d.resumeToken,r)),s=s.insert(g,E),(function(C,P,L){return C.resumeToken.approximateByteSize()===0||P.snapshotVersion.toMicroseconds()-C.snapshotVersion.toMicroseconds()>=qE?!0:L.addedDocuments.size+L.modifiedDocuments.size+L.removedDocuments.size>0})(m,E,d)&&c.push(t.Pi.updateTargetData(i,E))}));let l=Lt(),h=K();if(e.documentUpdates.forEach((d=>{e.resolvedLimboDocuments.has(d)&&c.push(t.persistence.referenceDelegate.updateLimboDocument(i,d))})),c.push(KE(i,a,e.documentUpdates).next((d=>{l=d.ks,h=d.qs}))),!r.isEqual($.min())){const d=t.Pi.getLastRemoteSnapshotVersion(i).next((g=>t.Pi.setTargetsMetadata(i,i.currentSequenceNumber,r)));c.push(d)}return k.waitFor(c).next((()=>a.apply(i))).next((()=>t.localDocuments.getLocalViewOfDocuments(i,l,h))).next((()=>l))})).then((i=>(t.Ms=s,i)))}function KE(n,e,t){let r=K(),s=K();return t.forEach((i=>r=r.add(i))),e.getEntries(n,r).next((i=>{let a=Lt();return t.forEach(((c,l)=>{const h=i.get(c);l.isFoundDocument()!==h.isFoundDocument()&&(s=s.add(c)),l.isNoDocument()&&l.version.isEqual($.min())?(e.removeEntry(c,l.readTime),a=a.insert(c,l)):!h.isValidDocument()||l.version.compareTo(h.version)>0||l.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(l),a=a.insert(c,l)):M(Fc,"Ignoring outdated watch update for ",c,". Current version:",h.version," Watch version:",l.version)})),{ks:a,qs:s}}))}function QE(n,e){const t=z(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=Ac),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function XE(n,e){const t=z(n);return t.persistence.runTransaction("Allocate target","readwrite",(r=>{let s;return t.Pi.getTargetData(r,e).next((i=>i?(s=i,k.resolve(s)):t.Pi.allocateTargetId(r).next((a=>(s=new tn(e,a,"TargetPurposeListen",r.currentSequenceNumber),t.Pi.addTargetData(r,s).next((()=>s)))))))})).then((r=>{const s=t.Ms.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(r.targetId,r),t.xs.set(e,r.targetId)),r}))}async function ja(n,e,t){const r=z(n),s=r.Ms.get(e),i=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",i,(a=>r.persistence.referenceDelegate.removeTarget(a,s)))}catch(a){if(!Br(a))throw a;M(Fc,`Failed to update sequence numbers for target ${e}: ${a}`)}r.Ms=r.Ms.remove(e),r.xs.delete(s.target)}function dh(n,e,t){const r=z(n);let s=$.min(),i=K();return r.persistence.runTransaction("Execute query","readwrite",(a=>(function(l,h,d){const g=z(l),m=g.xs.get(d);return m!==void 0?k.resolve(g.Ms.get(m)):g.Pi.getTargetData(h,d)})(r,a,_t(e)).next((c=>{if(c)return s=c.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(a,c.targetId).next((l=>{i=l}))})).next((()=>r.Fs.getDocumentsMatchingQuery(a,e,t?s:$.min(),t?i:K()))).next((c=>(JE(r,Lv(e),c),{documents:c,Qs:i})))))}function JE(n,e,t){let r=n.Os.get(e)||$.min();t.forEach(((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)})),n.Os.set(e,r)}class ph{constructor(){this.activeTargetIds=$v()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class YE{constructor(){this.Mo=new ph,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,r){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new ph,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class ZE{Oo(e){}shutdown(){}}const mh="ConnectivityMonitor";class gh{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){M(mh,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){M(mh,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let li=null;function $a(){return li===null?li=(function(){return 268435456+Math.round(2147483648*Math.random())})():li++,"0x"+li.toString(16)}const ha="RestConnection",eT={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class tT{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${r}/databases/${s}`,this.Wo=this.databaseId.database===Ni?`project_id=${r}`:`project_id=${r}&database_id=${s}`}Go(e,t,r,s,i){const a=$a(),c=this.zo(e,t.toUriEncodedString());M(ha,`Sending RPC '${e}' ${a}:`,c,r);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,s,i);const{host:h}=new URL(c),d=vn(h);return this.Jo(e,c,l,r,d).then((g=>(M(ha,`Received RPC '${e}' ${a}: `,g),g)),(g=>{throw br(ha,`RPC '${e}' ${a} failed with error: `,g,"url: ",c,"request:",r),g}))}Ho(e,t,r,s,i,a){return this.Go(e,t,r,s,i)}jo(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Fr})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((s,i)=>e[i]=s)),r&&r.headers.forEach(((s,i)=>e[i]=s))}zo(e,t){const r=eT[e];return`${this.Uo}/v1/${t}:${r}`}terminate(){}}class nT{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const Ve="WebChannelConnection";class rT extends tT{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,s,i){const a=$a();return new Promise(((c,l)=>{const h=new rd;h.setWithCredentials(!0),h.listenOnce(sd.COMPLETE,(()=>{try{switch(h.getLastErrorCode()){case pi.NO_ERROR:const g=h.getResponseJson();M(Ve,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(g)),c(g);break;case pi.TIMEOUT:M(Ve,`RPC '${e}' ${a} timed out`),l(new x(N.DEADLINE_EXCEEDED,"Request time out"));break;case pi.HTTP_ERROR:const m=h.getStatus();if(M(Ve,`RPC '${e}' ${a} failed with status:`,m,"response text:",h.getResponseText()),m>0){let E=h.getResponseJson();Array.isArray(E)&&(E=E[0]);const S=E?.error;if(S&&S.status&&S.message){const C=(function(L){const O=L.toLowerCase().replace(/_/g,"-");return Object.values(N).indexOf(O)>=0?O:N.UNKNOWN})(S.status);l(new x(C,S.message))}else l(new x(N.UNKNOWN,"Server responded with status "+h.getStatus()))}else l(new x(N.UNAVAILABLE,"Connection failed."));break;default:B(9055,{l_:e,streamId:a,h_:h.getLastErrorCode(),P_:h.getLastError()})}}finally{M(Ve,`RPC '${e}' ${a} completed.`)}}));const d=JSON.stringify(s);M(Ve,`RPC '${e}' ${a} sending request:`,s),h.send(t,"POST",d,r,15)}))}T_(e,t,r){const s=$a(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=ad(),c=od(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(l.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,t,r),l.encodeInitMessageHeaders=!0;const d=i.join("");M(Ve,`Creating RPC '${e}' stream ${s}: ${d}`,l);const g=a.createWebChannel(d,l);this.I_(g);let m=!1,E=!1;const S=new nT({Yo:P=>{E?M(Ve,`Not sending because RPC '${e}' stream ${s} is closed:`,P):(m||(M(Ve,`Opening RPC '${e}' stream ${s} transport.`),g.open(),m=!0),M(Ve,`RPC '${e}' stream ${s} sending:`,P),g.send(P))},Zo:()=>g.close()}),C=(P,L,O)=>{P.listen(L,(V=>{try{O(V)}catch(q){setTimeout((()=>{throw q}),0)}}))};return C(g,cs.EventType.OPEN,(()=>{E||(M(Ve,`RPC '${e}' stream ${s} transport opened.`),S.o_())})),C(g,cs.EventType.CLOSE,(()=>{E||(E=!0,M(Ve,`RPC '${e}' stream ${s} transport closed`),S.a_(),this.E_(g))})),C(g,cs.EventType.ERROR,(P=>{E||(E=!0,br(Ve,`RPC '${e}' stream ${s} transport errored. Name:`,P.name,"Message:",P.message),S.a_(new x(N.UNAVAILABLE,"The operation could not be completed")))})),C(g,cs.EventType.MESSAGE,(P=>{if(!E){const L=P.data[0];te(!!L,16349);const O=L,V=O?.error||O[0]?.error;if(V){M(Ve,`RPC '${e}' stream ${s} received error:`,V);const q=V.status;let Y=(function(_){const v=pe[_];if(v!==void 0)return Bd(v)})(q),Z=V.message;Y===void 0&&(Y=N.INTERNAL,Z="Unknown error status: "+q+" with message "+V.message),E=!0,S.a_(new x(Y,Z)),g.close()}else M(Ve,`RPC '${e}' stream ${s} received:`,L),S.u_(L)}})),C(c,id.STAT_EVENT,(P=>{P.stat===ka.PROXY?M(Ve,`RPC '${e}' stream ${s} detected buffering proxy`):P.stat===ka.NOPROXY&&M(Ve,`RPC '${e}' stream ${s} detected no buffering proxy`)})),setTimeout((()=>{S.__()}),0),S}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function fa(){return typeof document<"u"?document:null}function yo(n){return new aE(n,!0)}class ep{constructor(e,t,r=1e3,s=1.5,i=6e4){this.Mi=e,this.timerId=t,this.d_=r,this.A_=s,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),s=Math.max(0,t-r);s>0&&M("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const _h="PersistentStream";class tp{constructor(e,t,r,s,i,a,c,l){this.Mi=e,this.S_=r,this.b_=s,this.connection=i,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=c,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new ep(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===N.RESOURCE_EXHAUSTED?(Mt(t.toString()),Mt("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===N.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,s])=>{this.D_===t&&this.G_(r,s)}),(r=>{e((()=>{const s=new x(N.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(s)}))}))}G_(e,t){const r=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{r((()=>this.listener.Xo()))})),this.stream.t_((()=>{r((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((s=>{r((()=>this.z_(s)))})),this.stream.onMessage((s=>{r((()=>++this.F_==1?this.J_(s):this.onNext(s)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return M(_h,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(M(_h,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class sT extends tp{constructor(e,t,r,s,i,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,s,a),this.serializer=i}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=lE(this.serializer,e),r=(function(i){if(!("targetChange"in i))return $.min();const a=i.targetChange;return a.targetIds&&a.targetIds.length?$.min():a.readTime?yt(a.readTime):$.min()})(e);return this.listener.H_(t,r)}Y_(e){const t={};t.database=Ba(this.serializer),t.addTarget=(function(i,a){let c;const l=a.target;if(c=Ma(l)?{documents:dE(i,l)}:{query:pE(i,l).ft},c.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){c.resumeToken=qd(i,a.resumeToken);const h=xa(i,a.expectedCount);h!==null&&(c.expectedCount=h)}else if(a.snapshotVersion.compareTo($.min())>0){c.readTime=xi(i,a.snapshotVersion.toTimestamp());const h=xa(i,a.expectedCount);h!==null&&(c.expectedCount=h)}return c})(this.serializer,e);const r=gE(this.serializer,e);r&&(t.labels=r),this.q_(t)}Z_(e){const t={};t.database=Ba(this.serializer),t.removeTarget=e,this.q_(t)}}class iT extends tp{constructor(e,t,r,s,i,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,s,a),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return te(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,te(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){te(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=fE(e.writeResults,e.commitTime),r=yt(e.commitTime);return this.listener.na(r,t)}ra(){const e={};e.database=Ba(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((r=>hE(this.serializer,r)))};this.q_(t)}}class oT{}class aT extends oT{constructor(e,t,r,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new x(N.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,a])=>this.connection.Go(e,Fa(t,r),s,i,a))).catch((i=>{throw i.name==="FirebaseError"?(i.code===N.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new x(N.UNKNOWN,i.toString())}))}Ho(e,t,r,s,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,c])=>this.connection.Ho(e,Fa(t,r),s,a,c,i))).catch((a=>{throw a.name==="FirebaseError"?(a.code===N.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new x(N.UNKNOWN,a.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class cT{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Mt(t),this.aa=!1):M("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const $n="RemoteStore";class uT{constructor(e,t,r,s,i){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo((a=>{r.enqueueAndForget((async()=>{Kn(this)&&(M($n,"Restarting streams for network reachability change."),await(async function(l){const h=z(l);h.Ea.add(4),await Us(h),h.Ra.set("Unknown"),h.Ea.delete(4),await vo(h)})(this))}))})),this.Ra=new cT(r,s)}}async function vo(n){if(Kn(n))for(const e of n.da)await e(!0)}async function Us(n){for(const e of n.da)await e(!1)}function np(n,e){const t=z(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),$c(t)?jc(t):jr(t).O_()&&Bc(t,e))}function Uc(n,e){const t=z(n),r=jr(t);t.Ia.delete(e),r.O_()&&rp(t,e),t.Ia.size===0&&(r.O_()?r.L_():Kn(t)&&t.Ra.set("Unknown"))}function Bc(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo($.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}jr(n).Y_(e)}function rp(n,e){n.Va.Ue(e),jr(n).Z_(e)}function jc(n){n.Va=new rE({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),jr(n).start(),n.Ra.ua()}function $c(n){return Kn(n)&&!jr(n).x_()&&n.Ia.size>0}function Kn(n){return z(n).Ea.size===0}function sp(n){n.Va=void 0}async function lT(n){n.Ra.set("Online")}async function hT(n){n.Ia.forEach(((e,t)=>{Bc(n,e)}))}async function fT(n,e){sp(n),$c(n)?(n.Ra.ha(e),jc(n)):n.Ra.set("Unknown")}async function dT(n,e,t){if(n.Ra.set("Online"),e instanceof $d&&e.state===2&&e.cause)try{await(async function(s,i){const a=i.cause;for(const c of i.targetIds)s.Ia.has(c)&&(await s.remoteSyncer.rejectListen(c,a),s.Ia.delete(c),s.Va.removeTarget(c))})(n,e)}catch(r){M($n,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Ui(n,r)}else if(e instanceof yi?n.Va.Ze(e):e instanceof jd?n.Va.st(e):n.Va.tt(e),!t.isEqual($.min()))try{const r=await Zd(n.localStore);t.compareTo(r)>=0&&await(function(i,a){const c=i.Va.Tt(a);return c.targetChanges.forEach(((l,h)=>{if(l.resumeToken.approximateByteSize()>0){const d=i.Ia.get(h);d&&i.Ia.set(h,d.withResumeToken(l.resumeToken,a))}})),c.targetMismatches.forEach(((l,h)=>{const d=i.Ia.get(l);if(!d)return;i.Ia.set(l,d.withResumeToken(Ne.EMPTY_BYTE_STRING,d.snapshotVersion)),rp(i,l);const g=new tn(d.target,l,h,d.sequenceNumber);Bc(i,g)})),i.remoteSyncer.applyRemoteEvent(c)})(n,t)}catch(r){M($n,"Failed to raise snapshot:",r),await Ui(n,r)}}async function Ui(n,e,t){if(!Br(e))throw e;n.Ea.add(1),await Us(n),n.Ra.set("Offline"),t||(t=()=>Zd(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{M($n,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await vo(n)}))}function ip(n,e){return e().catch((t=>Ui(n,t,e)))}async function Eo(n){const e=z(n),t=gn(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Ac;for(;pT(e);)try{const s=await QE(e.localStore,r);if(s===null){e.Ta.length===0&&t.L_();break}r=s.batchId,mT(e,s)}catch(s){await Ui(e,s)}op(e)&&ap(e)}function pT(n){return Kn(n)&&n.Ta.length<10}function mT(n,e){n.Ta.push(e);const t=gn(n);t.O_()&&t.X_&&t.ea(e.mutations)}function op(n){return Kn(n)&&!gn(n).x_()&&n.Ta.length>0}function ap(n){gn(n).start()}async function gT(n){gn(n).ra()}async function _T(n){const e=gn(n);for(const t of n.Ta)e.ea(t.mutations)}async function yT(n,e,t){const r=n.Ta.shift(),s=Dc.from(r,e,t);await ip(n,(()=>n.remoteSyncer.applySuccessfulWrite(s))),await Eo(n)}async function vT(n,e){e&&gn(n).X_&&await(async function(r,s){if((function(a){return eE(a)&&a!==N.ABORTED})(s.code)){const i=r.Ta.shift();gn(r).B_(),await ip(r,(()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s))),await Eo(r)}})(n,e),op(n)&&ap(n)}async function yh(n,e){const t=z(n);t.asyncQueue.verifyOperationInProgress(),M($n,"RemoteStore received new credentials");const r=Kn(t);t.Ea.add(3),await Us(t),r&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await vo(t)}async function ET(n,e){const t=z(n);e?(t.Ea.delete(2),await vo(t)):e||(t.Ea.add(2),await Us(t),t.Ra.set("Unknown"))}function jr(n){return n.ma||(n.ma=(function(t,r,s){const i=z(t);return i.sa(),new sT(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)})(n.datastore,n.asyncQueue,{Xo:lT.bind(null,n),t_:hT.bind(null,n),r_:fT.bind(null,n),H_:dT.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),$c(n)?jc(n):n.Ra.set("Unknown")):(await n.ma.stop(),sp(n))}))),n.ma}function gn(n){return n.fa||(n.fa=(function(t,r,s){const i=z(t);return i.sa(),new iT(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:gT.bind(null,n),r_:vT.bind(null,n),ta:_T.bind(null,n),na:yT.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await Eo(n)):(await n.fa.stop(),n.Ta.length>0&&(M($n,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class qc{constructor(e,t,r,s,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new On,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((a=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,s,i){const a=Date.now()+r,c=new qc(e,t,a,s,i);return c.start(r),c}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new x(N.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function zc(n,e){if(Mt("AsyncQueue",`${e}: ${n}`),Br(n))return new x(N.UNAVAILABLE,`${e}: ${n}`);throw n}class pr{static emptySet(e){return new pr(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||U.comparator(t.key,r.key):(t,r)=>U.comparator(t.key,r.key),this.keyedMap=us(),this.sortedSet=new ue(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,r)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof pr)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new pr;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class vh{constructor(){this.ga=new ue(U.comparator)}track(e){const t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):B(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,r)=>{e.push(r)})),e}}class kr{constructor(e,t,r,s,i,a,c,l,h){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=a,this.syncStateChanged=c,this.excludesMetadataChanges=l,this.hasCachedResults=h}static fromInitialDocuments(e,t,r,s,i){const a=[];return t.forEach((c=>{a.push({type:0,doc:c})})),new kr(e,t,pr.emptySet(t),a,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&fo(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==r[s].type||!t[s].doc.isEqual(r[s].doc))return!1;return!0}}class TT{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class IT{constructor(){this.queries=Eh(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){const s=z(t),i=s.queries;s.queries=Eh(),i.forEach(((a,c)=>{for(const l of c.Sa)l.onError(r)}))})(this,new x(N.ABORTED,"Firestore shutting down"))}}function Eh(){return new Gn((n=>Pd(n)),fo)}async function wT(n,e){const t=z(n);let r=3;const s=e.query;let i=t.queries.get(s);i?!i.ba()&&e.Da()&&(r=2):(i=new TT,r=e.Da()?0:1);try{switch(r){case 0:i.wa=await t.onListen(s,!0);break;case 1:i.wa=await t.onListen(s,!1);break;case 2:await t.onFirstRemoteStoreListen(s)}}catch(a){const c=zc(a,`Initialization of query '${nr(e.query)}' failed`);return void e.onError(c)}t.queries.set(s,i),i.Sa.push(e),e.va(t.onlineState),i.wa&&e.Fa(i.wa)&&Hc(t)}async function AT(n,e){const t=z(n),r=e.query;let s=3;const i=t.queries.get(r);if(i){const a=i.Sa.indexOf(e);a>=0&&(i.Sa.splice(a,1),i.Sa.length===0?s=e.Da()?0:1:!i.ba()&&e.Da()&&(s=2))}switch(s){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function bT(n,e){const t=z(n);let r=!1;for(const s of e){const i=s.query,a=t.queries.get(i);if(a){for(const c of a.Sa)c.Fa(s)&&(r=!0);a.wa=s}}r&&Hc(t)}function RT(n,e,t){const r=z(n),s=r.queries.get(e);if(s)for(const i of s.Sa)i.onError(t);r.queries.delete(e)}function Hc(n){n.Ca.forEach((e=>{e.next()}))}var qa,Th;(Th=qa||(qa={})).Ma="default",Th.Cache="cache";class ST{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new kr(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const r=t!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=kr.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==qa.Cache}}class cp{constructor(e){this.key=e}}class up{constructor(e){this.key=e}}class PT{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=K(),this.mutatedKeys=K(),this.eu=Cd(e),this.tu=new pr(this.eu)}get nu(){return this.Ya}ru(e,t){const r=t?t.iu:new vh,s=t?t.tu:this.tu;let i=t?t.mutatedKeys:this.mutatedKeys,a=s,c=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,h=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal(((d,g)=>{const m=s.get(d),E=po(this.query,g)?g:null,S=!!m&&this.mutatedKeys.has(m.key),C=!!E&&(E.hasLocalMutations||this.mutatedKeys.has(E.key)&&E.hasCommittedMutations);let P=!1;m&&E?m.data.isEqual(E.data)?S!==C&&(r.track({type:3,doc:E}),P=!0):this.su(m,E)||(r.track({type:2,doc:E}),P=!0,(l&&this.eu(E,l)>0||h&&this.eu(E,h)<0)&&(c=!0)):!m&&E?(r.track({type:0,doc:E}),P=!0):m&&!E&&(r.track({type:1,doc:m}),P=!0,(l||h)&&(c=!0)),P&&(E?(a=a.add(E),i=C?i.add(d):i.delete(d)):(a=a.delete(d),i=i.delete(d)))})),this.query.limit!==null)for(;a.size>this.query.limit;){const d=this.query.limitType==="F"?a.last():a.first();a=a.delete(d.key),i=i.delete(d.key),r.track({type:1,doc:d})}return{tu:a,iu:r,Cs:c,mutatedKeys:i}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,s){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const a=e.iu.ya();a.sort(((d,g)=>(function(E,S){const C=P=>{switch(P){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return B(20277,{Rt:P})}};return C(E)-C(S)})(d.type,g.type)||this.eu(d.doc,g.doc))),this.ou(r),s=s??!1;const c=t&&!s?this._u():[],l=this.Xa.size===0&&this.current&&!s?1:0,h=l!==this.Za;return this.Za=l,a.length!==0||h?{snapshot:new kr(this.query,e.tu,i,a,e.mutatedKeys,l===0,h,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:c}:{au:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new vh,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=K(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))}));const t=[];return e.forEach((r=>{this.Xa.has(r)||t.push(new up(r))})),this.Xa.forEach((r=>{e.has(r)||t.push(new cp(r))})),t}cu(e){this.Ya=e.Qs,this.Xa=K();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return kr.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Wc="SyncEngine";class CT{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class kT{constructor(e){this.key=e,this.hu=!1}}class NT{constructor(e,t,r,s,i,a){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new Gn((c=>Pd(c)),fo),this.Iu=new Map,this.Eu=new Set,this.du=new ue(U.comparator),this.Au=new Map,this.Ru=new Mc,this.Vu={},this.mu=new Map,this.fu=Cr.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function DT(n,e,t=!0){const r=mp(n);let s;const i=r.Tu.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.lu()):s=await lp(r,e,t,!0),s}async function VT(n,e){const t=mp(n);await lp(t,e,!0,!1)}async function lp(n,e,t,r){const s=await XE(n.localStore,_t(e)),i=s.targetId,a=n.sharedClientState.addLocalQueryTarget(i,t);let c;return r&&(c=await OT(n,e,i,a==="current",s.resumeToken)),n.isPrimaryClient&&t&&np(n.remoteStore,s),c}async function OT(n,e,t,r,s){n.pu=(g,m,E)=>(async function(C,P,L,O){let V=P.view.ru(L);V.Cs&&(V=await dh(C.localStore,P.query,!1).then((({documents:I})=>P.view.ru(I,V))));const q=O&&O.targetChanges.get(P.targetId),Y=O&&O.targetMismatches.get(P.targetId)!=null,Z=P.view.applyChanges(V,C.isPrimaryClient,q,Y);return wh(C,P.targetId,Z.au),Z.snapshot})(n,g,m,E);const i=await dh(n.localStore,e,!0),a=new PT(e,i.Qs),c=a.ru(i.documents),l=Fs.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",s),h=a.applyChanges(c,n.isPrimaryClient,l);wh(n,t,h.au);const d=new CT(e,t,a);return n.Tu.set(e,d),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),h.snapshot}async function MT(n,e,t){const r=z(n),s=r.Tu.get(e),i=r.Iu.get(s.targetId);if(i.length>1)return r.Iu.set(s.targetId,i.filter((a=>!fo(a,e)))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await ja(r.localStore,s.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(s.targetId),t&&Uc(r.remoteStore,s.targetId),za(r,s.targetId)})).catch(Ur)):(za(r,s.targetId),await ja(r.localStore,s.targetId,!0))}async function LT(n,e){const t=z(n),r=t.Tu.get(e),s=t.Iu.get(r.targetId);t.isPrimaryClient&&s.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Uc(t.remoteStore,r.targetId))}async function xT(n,e,t){const r=zT(n);try{const s=await(function(a,c){const l=z(a),h=ce.now(),d=c.reduce(((E,S)=>E.add(S.key)),K());let g,m;return l.persistence.runTransaction("Locally write mutations","readwrite",(E=>{let S=Lt(),C=K();return l.Ns.getEntries(E,d).next((P=>{S=P,S.forEach(((L,O)=>{O.isValidDocument()||(C=C.add(L))}))})).next((()=>l.localDocuments.getOverlayedDocuments(E,S))).next((P=>{g=P;const L=[];for(const O of c){const V=Qv(O,g.get(O.key).overlayedDocument);V!=null&&L.push(new Tn(O.key,V,Td(V.value.mapValue),it.exists(!0)))}return l.mutationQueue.addMutationBatch(E,h,L,c)})).next((P=>{m=P;const L=P.applyToLocalDocumentSet(g,C);return l.documentOverlayCache.saveOverlays(E,P.batchId,L)}))})).then((()=>({batchId:m.batchId,changes:Nd(g)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),(function(a,c,l){let h=a.Vu[a.currentUser.toKey()];h||(h=new ue(G)),h=h.insert(c,l),a.Vu[a.currentUser.toKey()]=h})(r,s.batchId,t),await Bs(r,s.changes),await Eo(r.remoteStore)}catch(s){const i=zc(s,"Failed to persist write");t.reject(i)}}async function hp(n,e){const t=z(n);try{const r=await GE(t.localStore,e);e.targetChanges.forEach(((s,i)=>{const a=t.Au.get(i);a&&(te(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?a.hu=!0:s.modifiedDocuments.size>0?te(a.hu,14607):s.removedDocuments.size>0&&(te(a.hu,42227),a.hu=!1))})),await Bs(t,r,e)}catch(r){await Ur(r)}}function Ih(n,e,t){const r=z(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const s=[];r.Tu.forEach(((i,a)=>{const c=a.view.va(e);c.snapshot&&s.push(c.snapshot)})),(function(a,c){const l=z(a);l.onlineState=c;let h=!1;l.queries.forEach(((d,g)=>{for(const m of g.Sa)m.va(c)&&(h=!0)})),h&&Hc(l)})(r.eventManager,e),s.length&&r.Pu.H_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function FT(n,e,t){const r=z(n);r.sharedClientState.updateQueryState(e,"rejected",t);const s=r.Au.get(e),i=s&&s.key;if(i){let a=new ue(U.comparator);a=a.insert(i,Le.newNoDocument(i,$.min()));const c=K().add(i),l=new _o($.min(),new Map,new ue(G),a,c);await hp(r,l),r.du=r.du.remove(i),r.Au.delete(e),Gc(r)}else await ja(r.localStore,e,!1).then((()=>za(r,e,t))).catch(Ur)}async function UT(n,e){const t=z(n),r=e.batch.batchId;try{const s=await WE(t.localStore,e);dp(t,r,null),fp(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await Bs(t,s)}catch(s){await Ur(s)}}async function BT(n,e,t){const r=z(n);try{const s=await(function(a,c){const l=z(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",(h=>{let d;return l.mutationQueue.lookupMutationBatch(h,c).next((g=>(te(g!==null,37113),d=g.keys(),l.mutationQueue.removeMutationBatch(h,g)))).next((()=>l.mutationQueue.performConsistencyCheck(h))).next((()=>l.documentOverlayCache.removeOverlaysForBatchId(h,d,c))).next((()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,d))).next((()=>l.localDocuments.getDocuments(h,d)))}))})(r.localStore,e);dp(r,e,t),fp(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await Bs(r,s)}catch(s){await Ur(s)}}function fp(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function dp(n,e,t){const r=z(n);let s=r.Vu[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(t?i.reject(t):i.resolve(),s=s.remove(e)),r.Vu[r.currentUser.toKey()]=s}}function za(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Iu.get(e))n.Tu.delete(r),t&&n.Pu.yu(r,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((r=>{n.Ru.containsKey(r)||pp(n,r)}))}function pp(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(Uc(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),Gc(n))}function wh(n,e,t){for(const r of t)r instanceof cp?(n.Ru.addReference(r.key,e),jT(n,r)):r instanceof up?(M(Wc,"Document no longer in limbo: "+r.key),n.Ru.removeReference(r.key,e),n.Ru.containsKey(r.key)||pp(n,r.key)):B(19791,{wu:r})}function jT(n,e){const t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Eu.has(r)||(M(Wc,"New document in limbo: "+t),n.Eu.add(r),Gc(n))}function Gc(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new U(ae.fromString(e)),r=n.fu.next();n.Au.set(r,new kT(t)),n.du=n.du.insert(t,r),np(n.remoteStore,new tn(_t(Cc(t.path)),r,"TargetPurposeLimboResolution",co.ce))}}async function Bs(n,e,t){const r=z(n),s=[],i=[],a=[];r.Tu.isEmpty()||(r.Tu.forEach(((c,l)=>{a.push(r.pu(l,e,t).then((h=>{if((h||t)&&r.isPrimaryClient){const d=h?!h.fromCache:t?.targetChanges.get(l.targetId)?.current;r.sharedClientState.updateQueryState(l.targetId,d?"current":"not-current")}if(h){s.push(h);const d=xc.As(l.targetId,h);i.push(d)}})))})),await Promise.all(a),r.Pu.H_(s),await(async function(l,h){const d=z(l);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",(g=>k.forEach(h,(m=>k.forEach(m.Es,(E=>d.persistence.referenceDelegate.addReference(g,m.targetId,E))).next((()=>k.forEach(m.ds,(E=>d.persistence.referenceDelegate.removeReference(g,m.targetId,E)))))))))}catch(g){if(!Br(g))throw g;M(Fc,"Failed to update sequence numbers: "+g)}for(const g of h){const m=g.targetId;if(!g.fromCache){const E=d.Ms.get(m),S=E.snapshotVersion,C=E.withLastLimboFreeSnapshotVersion(S);d.Ms=d.Ms.insert(m,C)}}})(r.localStore,i))}async function $T(n,e){const t=z(n);if(!t.currentUser.isEqual(e)){M(Wc,"User change. New user:",e.toKey());const r=await Yd(t.localStore,e);t.currentUser=e,(function(i,a){i.mu.forEach((c=>{c.forEach((l=>{l.reject(new x(N.CANCELLED,a))}))})),i.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Bs(t,r.Ls)}}function qT(n,e){const t=z(n),r=t.Au.get(e);if(r&&r.hu)return K().add(r.key);{let s=K();const i=t.Iu.get(e);if(!i)return s;for(const a of i){const c=t.Tu.get(a);s=s.unionWith(c.view.nu)}return s}}function mp(n){const e=z(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=hp.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=qT.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=FT.bind(null,e),e.Pu.H_=bT.bind(null,e.eventManager),e.Pu.yu=RT.bind(null,e.eventManager),e}function zT(n){const e=z(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=UT.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=BT.bind(null,e),e}class Bi{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=yo(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return HE(this.persistence,new $E,e.initialUser,this.serializer)}Cu(e){return new Jd(Lc.mi,this.serializer)}Du(e){return new YE}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Bi.provider={build:()=>new Bi};class HT extends Bi{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){te(this.persistence.referenceDelegate instanceof Fi,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new SE(r,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?qe.withCacheSize(this.cacheSizeBytes):qe.DEFAULT;return new Jd((r=>Fi.mi(r,t)),this.serializer)}}class Ha{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Ih(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=$T.bind(null,this.syncEngine),await ET(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new IT})()}createDatastore(e){const t=yo(e.databaseInfo.databaseId),r=(function(i){return new rT(i)})(e.databaseInfo);return(function(i,a,c,l){return new aT(i,a,c,l)})(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return(function(r,s,i,a,c){return new uT(r,s,i,a,c)})(this.localStore,this.datastore,e.asyncQueue,(t=>Ih(this.syncEngine,t,0)),(function(){return gh.v()?new gh:new ZE})())}createSyncEngine(e,t){return(function(s,i,a,c,l,h,d){const g=new NT(s,i,a,c,l,h);return d&&(g.gu=!0),g})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const r=z(t);M($n,"RemoteStore shutting down."),r.Ea.add(5),await Us(r),r.Aa.shutdown(),r.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Ha.provider={build:()=>new Ha};class WT{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Mt("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const _n="FirestoreClient";class GT{constructor(e,t,r,s,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=s,this.user=Me.UNAUTHENTICATED,this.clientId=Ic.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,(async a=>{M(_n,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a})),this.appCheckCredentials.start(r,(a=>(M(_n,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new On;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=zc(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function da(n,e){n.asyncQueue.verifyOperationInProgress(),M(_n,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener((async s=>{r.isEqual(s)||(await Yd(e.localStore,s),r=s)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function Ah(n,e){n.asyncQueue.verifyOperationInProgress();const t=await KT(n);M(_n,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((r=>yh(e.remoteStore,r))),n.setAppCheckTokenChangeListener(((r,s)=>yh(e.remoteStore,s))),n._onlineComponents=e}async function KT(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){M(_n,"Using user provided OfflineComponentProvider");try{await da(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(s){return s.name==="FirebaseError"?s.code===N.FAILED_PRECONDITION||s.code===N.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11})(t))throw t;br("Error using user provided cache. Falling back to memory cache: "+t),await da(n,new Bi)}}else M(_n,"Using default OfflineComponentProvider"),await da(n,new HT(void 0));return n._offlineComponents}async function gp(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(M(_n,"Using user provided OnlineComponentProvider"),await Ah(n,n._uninitializedComponentsProvider._online)):(M(_n,"Using default OnlineComponentProvider"),await Ah(n,new Ha))),n._onlineComponents}function QT(n){return gp(n).then((e=>e.syncEngine))}async function bh(n){const e=await gp(n),t=e.eventManager;return t.onListen=DT.bind(null,e.syncEngine),t.onUnlisten=MT.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=VT.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=LT.bind(null,e.syncEngine),t}function _p(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const Rh=new Map;const yp="firestore.googleapis.com",Sh=!0;class Ph{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new x(N.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=yp,this.ssl=Sh}else this.host=e.host,this.ssl=e.ssl??Sh;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Xd;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<bE)throw new x(N.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}cv("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=_p(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new x(N.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new x(N.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new x(N.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,s){return r.timeoutSeconds===s.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class To{constructor(e,t,r,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Ph({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new x(N.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new x(N.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Ph(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new Yy;switch(r.type){case"firstParty":return new nv(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new x(N.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const r=Rh.get(t);r&&(M("ComponentProvider","Removing Datastore"),Rh.delete(t),r.terminate())})(this),Promise.resolve()}}function XT(n,e,t,r={}){n=un(n,To);const s=vn(e),i=n._getSettings(),a={...i,emulatorOptions:n._getEmulatorOptions()},c=`${e}:${t}`;s&&(gc(`https://${c}`),_c("Firestore",!0)),i.host!==yp&&i.host!==c&&br("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...i,host:c,ssl:s,emulatorOptions:r};if(!Un(l,a)&&(n._setSettings(l),r.mockUserToken)){let h,d;if(typeof r.mockUserToken=="string")h=r.mockUserToken,d=Me.MOCK_USER;else{h=w_(r.mockUserToken,n._app?.options.projectId);const g=r.mockUserToken.sub||r.mockUserToken.user_id;if(!g)throw new x(N.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new Me(g)}n._authCredentials=new Zy(new ud(h,d))}}class Io{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Io(this.firestore,e,this._query)}}class Ee{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ln(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ee(this.firestore,e,this._key)}toJSON(){return{type:Ee._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(Ls(t,Ee._jsonSchema))return new Ee(e,r||null,new U(ae.fromString(t.referencePath)))}}Ee._jsonSchemaVersion="firestore/documentReference/1.0",Ee._jsonSchema={type:me("string",Ee._jsonSchemaVersion),referencePath:me("string")};class ln extends Io{constructor(e,t,r){super(e,t,Cc(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ee(this.firestore,null,new U(e))}withConverter(e){return new ln(this.firestore,e,this._path)}}function vp(n,e,...t){if(n=ge(n),ld("collection","path",e),n instanceof To){const r=ae.fromString(e,...t);return jl(r),new ln(n,null,r)}{if(!(n instanceof Ee||n instanceof ln))throw new x(N.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(ae.fromString(e,...t));return jl(r),new ln(n.firestore,null,r)}}function Kc(n,e,...t){if(n=ge(n),arguments.length===1&&(e=Ic.newId()),ld("doc","path",e),n instanceof To){const r=ae.fromString(e,...t);return Bl(r),new Ee(n,null,new U(r))}{if(!(n instanceof Ee||n instanceof ln))throw new x(N.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(ae.fromString(e,...t));return Bl(r),new Ee(n.firestore,n instanceof ln?n.converter:null,new U(r))}}const Ch="AsyncQueue";class kh{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new ep(this,"async_queue_retry"),this._c=()=>{const r=fa();r&&M(Ch,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const t=fa();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=fa();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new On;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Br(e))throw e;M(Ch,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((r=>{throw this.nc=r,this.rc=!1,Mt("INTERNAL UNHANDLED ERROR: ",Nh(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const s=qc.createAndSchedule(this,e,t,r,(i=>this.hc(i)));return this.tc.push(s),s}uc(){this.nc&&B(47125,{Pc:Nh(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,r)=>t.targetTimeMs-r.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function Nh(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}function Dh(n){return(function(t,r){if(typeof t!="object"||t===null)return!1;const s=t;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1})(n,["next","error","complete"])}class Nr extends To{constructor(e,t,r,s){super(e,t,r,s),this.type="firestore",this._queue=new kh,this._persistenceKey=s?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new kh(e),this._firestoreClient=void 0,await e}}}function JT(n,e){const t=typeof n=="object"?n:Ec(),r=typeof n=="string"?n:Ni,s=ao(t,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=Kf("firestore");i&&XT(s,...i)}return s}function Ep(n){if(n._terminated)throw new x(N.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||YT(n),n._firestoreClient}function YT(n){const e=n._freezeSettings(),t=(function(s,i,a,c){return new vv(s,i,a,c.host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,_p(c.experimentalLongPollingOptions),c.useFetchStreams,c.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new GT(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(s){const i=s?._online.build();return{_offline:s?._offline.build(i),_online:i}})(n._componentsProvider))}class nt{constructor(e){this._byteString=e}static fromBase64String(e){try{return new nt(Ne.fromBase64String(e))}catch(t){throw new x(N.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new nt(Ne.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:nt._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Ls(e,nt._jsonSchema))return nt.fromBase64String(e.bytes)}}nt._jsonSchemaVersion="firestore/bytes/1.0",nt._jsonSchema={type:me("string",nt._jsonSchemaVersion),bytes:me("string")};class wo{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new x(N.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Se(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Qc{constructor(e){this._methodName=e}}class vt{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new x(N.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new x(N.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return G(this._lat,e._lat)||G(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:vt._jsonSchemaVersion}}static fromJSON(e){if(Ls(e,vt._jsonSchema))return new vt(e.latitude,e.longitude)}}vt._jsonSchemaVersion="firestore/geoPoint/1.0",vt._jsonSchema={type:me("string",vt._jsonSchemaVersion),latitude:me("number"),longitude:me("number")};class Et{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Et._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Ls(e,Et._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new Et(e.vectorValues);throw new x(N.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Et._jsonSchemaVersion="firestore/vectorValue/1.0",Et._jsonSchema={type:me("string",Et._jsonSchemaVersion),vectorValues:me("object")};const ZT=/^__.*__$/;class eI{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Tn(e,this.data,this.fieldMask,t,this.fieldTransforms):new xs(e,this.data,t,this.fieldTransforms)}}class Tp{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Tn(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Ip(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw B(40011,{Ac:n})}}class Xc{constructor(e,t,r,s,i,a){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Xc({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.gc(e),r}yc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return ji(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(Ip(this.Ac)&&ZT.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class tI{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||yo(e)}Cc(e,t,r,s=!1){return new Xc({Ac:e,methodName:t,Dc:r,path:Se.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function wp(n){const e=n._freezeSettings(),t=yo(n._databaseId);return new tI(n._databaseId,!!e.ignoreUndefinedProperties,t)}function nI(n,e,t,r,s,i={}){const a=n.Cc(i.merge||i.mergeFields?2:0,e,t,s);Jc("Data must be an object, but it was:",a,r);const c=Ap(r,a);let l,h;if(i.merge)l=new Ye(a.fieldMask),h=a.fieldTransforms;else if(i.mergeFields){const d=[];for(const g of i.mergeFields){const m=Wa(e,g,t);if(!a.contains(m))throw new x(N.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);Rp(d,m)||d.push(m)}l=new Ye(d),h=a.fieldTransforms.filter((g=>l.covers(g.field)))}else l=null,h=a.fieldTransforms;return new eI(new He(c),l,h)}class Ao extends Qc{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Ao}}function rI(n,e,t,r){const s=n.Cc(1,e,t);Jc("Data must be an object, but it was:",s,r);const i=[],a=He.empty();En(r,((l,h)=>{const d=Yc(e,l,t);h=ge(h);const g=s.yc(d);if(h instanceof Ao)i.push(d);else{const m=bo(h,g);m!=null&&(i.push(d),a.set(d,m))}}));const c=new Ye(i);return new Tp(a,c,s.fieldTransforms)}function sI(n,e,t,r,s,i){const a=n.Cc(1,e,t),c=[Wa(e,r,t)],l=[s];if(i.length%2!=0)throw new x(N.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<i.length;m+=2)c.push(Wa(e,i[m])),l.push(i[m+1]);const h=[],d=He.empty();for(let m=c.length-1;m>=0;--m)if(!Rp(h,c[m])){const E=c[m];let S=l[m];S=ge(S);const C=a.yc(E);if(S instanceof Ao)h.push(E);else{const P=bo(S,C);P!=null&&(h.push(E),d.set(E,P))}}const g=new Ye(h);return new Tp(d,g,a.fieldTransforms)}function bo(n,e){if(bp(n=ge(n)))return Jc("Unsupported field value:",e,n),Ap(n,e);if(n instanceof Qc)return(function(r,s){if(!Ip(s.Ac))throw s.Sc(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(r,s){const i=[];let a=0;for(const c of r){let l=bo(c,s.wc(a));l==null&&(l={nullValue:"NULL_VALUE"}),i.push(l),a++}return{arrayValue:{values:i}}})(n,e)}return(function(r,s){if((r=ge(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return qv(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=ce.fromDate(r);return{timestampValue:xi(s.serializer,i)}}if(r instanceof ce){const i=new ce(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:xi(s.serializer,i)}}if(r instanceof vt)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof nt)return{bytesValue:qd(s.serializer,r._byteString)};if(r instanceof Ee){const i=s.databaseId,a=r.firestore._databaseId;if(!a.isEqual(i))throw s.Sc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Oc(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof Et)return(function(a,c){return{mapValue:{fields:{[vd]:{stringValue:Ed},[Di]:{arrayValue:{values:a.toArray().map((h=>{if(typeof h!="number")throw c.Sc("VectorValues must only contain numeric values.");return kc(c.serializer,h)}))}}}}}})(r,s);throw s.Sc(`Unsupported field value: ${wc(r)}`)})(n,e)}function Ap(n,e){const t={};return dd(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):En(n,((r,s)=>{const i=bo(s,e.mc(r));i!=null&&(t[r]=i)})),{mapValue:{fields:t}}}function bp(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof ce||n instanceof vt||n instanceof nt||n instanceof Ee||n instanceof Qc||n instanceof Et)}function Jc(n,e,t){if(!bp(t)||!hd(t)){const r=wc(t);throw r==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+r)}}function Wa(n,e,t){if((e=ge(e))instanceof wo)return e._internalPath;if(typeof e=="string")return Yc(n,e);throw ji("Field path arguments must be of type string or ",n,!1,void 0,t)}const iI=new RegExp("[~\\*/\\[\\]]");function Yc(n,e,t){if(e.search(iI)>=0)throw ji(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new wo(...e.split("."))._internalPath}catch{throw ji(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function ji(n,e,t,r,s){const i=r&&!r.isEmpty(),a=s!==void 0;let c=`Function ${e}() called with invalid data`;t&&(c+=" (via `toFirestore()`)"),c+=". ";let l="";return(i||a)&&(l+=" (found",i&&(l+=` in field ${r}`),a&&(l+=` in document ${s}`),l+=")"),new x(N.INVALID_ARGUMENT,c+n+l)}function Rp(n,e){return n.some((t=>t.isEqual(e)))}class Sp{constructor(e,t,r,s,i){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Ee(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new oI(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Pp("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class oI extends Sp{data(){return super.data()}}function Pp(n,e){return typeof e=="string"?Yc(n,e):e instanceof wo?e._internalPath:e._delegate._internalPath}function aI(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new x(N.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class cI{convertValue(e,t="none"){switch(mn(e)){case 0:return null;case 1:return e.booleanValue;case 2:return de(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(pn(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw B(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return En(e,((s,i)=>{r[s]=this.convertValue(i,t)})),r}convertVectorValue(e){const t=e.fields?.[Di].arrayValue?.values?.map((r=>de(r.doubleValue)));return new Et(t)}convertGeoPoint(e){return new vt(de(e.latitude),de(e.longitude))}convertArray(e,t){return(e.values||[]).map((r=>this.convertValue(r,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const r=lo(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(bs(e));default:return null}}convertTimestamp(e){const t=dn(e);return new ce(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=ae.fromString(e);te(Qd(r),9688,{name:e});const s=new Rs(r.get(1),r.get(3)),i=new U(r.popFirst(5));return s.isEqual(t)||Mt(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}function uI(n,e,t){let r;return r=n?n.toFirestore(e):e,r}class hs{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Mn extends Sp{constructor(e,t,r,s,i,a){super(e,t,r,s,a),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new vi(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(Pp("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new x(N.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Mn._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Mn._jsonSchemaVersion="firestore/documentSnapshot/1.0",Mn._jsonSchema={type:me("string",Mn._jsonSchemaVersion),bundleSource:me("string","DocumentSnapshot"),bundleName:me("string"),bundle:me("string")};class vi extends Mn{data(e={}){return super.data(e)}}class mr{constructor(e,t,r,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new hs(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((r=>{e.call(t,new vi(this._firestore,this._userDataWriter,r.key,r,new hs(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new x(N.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(s,i){if(s._snapshot.oldDocs.isEmpty()){let a=0;return s._snapshot.docChanges.map((c=>{const l=new vi(s._firestore,s._userDataWriter,c.doc.key,c.doc,new hs(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);return c.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}}))}{let a=s._snapshot.oldDocs;return s._snapshot.docChanges.filter((c=>i||c.type!==3)).map((c=>{const l=new vi(s._firestore,s._userDataWriter,c.doc.key,c.doc,new hs(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);let h=-1,d=-1;return c.type!==0&&(h=a.indexOf(c.doc.key),a=a.delete(c.doc.key)),c.type!==1&&(a=a.add(c.doc),d=a.indexOf(c.doc.key)),{type:lI(c.type),doc:l,oldIndex:h,newIndex:d}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new x(N.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=mr._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Ic.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],s=[];return this.docs.forEach((i=>{i._document!==null&&(t.push(i._document),r.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),s.push(i.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function lI(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return B(61501,{type:n})}}mr._jsonSchemaVersion="firestore/querySnapshot/1.0",mr._jsonSchema={type:me("string",mr._jsonSchemaVersion),bundleSource:me("string","QuerySnapshot"),bundleName:me("string"),bundle:me("string")};class Cp extends cI{constructor(e){super(),this.firestore=e}convertBytes(e){return new nt(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Ee(this.firestore,null,t)}}function hI(n,e,t,...r){n=un(n,Ee);const s=un(n.firestore,Nr),i=wp(s);let a;return a=typeof(e=ge(e))=="string"||e instanceof wo?sI(i,"updateDoc",n._key,e,t,r):rI(i,"updateDoc",n._key,e),Zc(s,[a.toMutation(n._key,it.exists(!0))])}function fI(n){return Zc(un(n.firestore,Nr),[new Nc(n._key,it.none())])}function dI(n,e){const t=un(n.firestore,Nr),r=Kc(n),s=uI(n.converter,e);return Zc(t,[nI(wp(n.firestore),"addDoc",r._key,s,n.converter!==null,{}).toMutation(r._key,it.exists(!1))]).then((()=>r))}function pI(n,...e){n=ge(n);let t={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||Dh(e[r])||(t=e[r++]);const s={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(Dh(e[r])){const l=e[r];e[r]=l.next?.bind(l),e[r+1]=l.error?.bind(l),e[r+2]=l.complete?.bind(l)}let i,a,c;if(n instanceof Ee)a=un(n.firestore,Nr),c=Cc(n._key.path),i={next:l=>{e[r]&&e[r](mI(a,n,l))},error:e[r+1],complete:e[r+2]};else{const l=un(n,Io);a=un(l.firestore,Nr),c=l._query;const h=new Cp(a);i={next:d=>{e[r]&&e[r](new mr(a,h,l,d))},error:e[r+1],complete:e[r+2]},aI(n._query)}return(function(h,d,g,m){const E=new WT(m),S=new ST(d,E,g);return h.asyncQueue.enqueueAndForget((async()=>wT(await bh(h),S))),()=>{E.Nu(),h.asyncQueue.enqueueAndForget((async()=>AT(await bh(h),S)))}})(Ep(a),c,s,i)}function Zc(n,e){return(function(r,s){const i=new On;return r.asyncQueue.enqueueAndForget((async()=>xT(await QT(r),s,i))),i.promise})(Ep(n),e)}function mI(n,e,t){const r=t.docs.get(e._key),s=new Cp(n);return new Mn(n,s,e._key,r,new hs(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(s){Fr=s})(xr),Bn(new hn("firestore",((r,{instanceIdentifier:s,options:i})=>{const a=r.getProvider("app").getImmediate(),c=new Nr(new ev(r.getProvider("auth-internal")),new rv(a,r.getProvider("app-check-internal")),(function(h,d){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new x(N.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Rs(h.options.projectId,d)})(a,s),a);return i={useFetchStreams:t,...i},c._setSettings(i),c}),"PUBLIC").setMultipleInstances(!0)),gt(Ll,xl,e),gt(Ll,xl,"esm2020")})();function kp(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const gI=kp,Np=new Os("auth","Firebase",kp());const $i=new yc("@firebase/auth");function _I(n,...e){$i.logLevel<=W.WARN&&$i.warn(`Auth (${xr}): ${n}`,...e)}function Ei(n,...e){$i.logLevel<=W.ERROR&&$i.error(`Auth (${xr}): ${n}`,...e)}function bt(n,...e){throw tu(n,...e)}function ot(n,...e){return tu(n,...e)}function eu(n,e,t){const r={...gI(),[e]:t};return new Os("auth","Firebase",r).create(e,{appName:n.name})}function Ln(n){return eu(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function yI(n,e,t){const r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&bt(n,"argument-error"),eu(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function tu(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return Np.create(n,...e)}function j(n,e,...t){if(!n)throw tu(e,...t)}function Nt(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Ei(e),new Error(e)}function xt(n,e){n||Nt(e)}function Ga(){return typeof self<"u"&&self.location?.href||""}function vI(){return Vh()==="http:"||Vh()==="https:"}function Vh(){return typeof self<"u"&&self.location?.protocol||null}function EI(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(vI()||C_()||"connection"in navigator)?navigator.onLine:!0}function TI(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class js{constructor(e,t){this.shortDelay=e,this.longDelay=t,xt(t>e,"Short delay should be less than long delay!"),this.isMobile=R_()||k_()}get(){return EI()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function nu(n,e){xt(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class Dp{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Nt("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Nt("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Nt("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const II={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const wI=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],AI=new js(3e4,6e4);function ru(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function $r(n,e,t,r,s={}){return Vp(n,s,async()=>{let i={},a={};r&&(e==="GET"?a=r:i={body:JSON.stringify(r)});const c=Ms({key:n.config.apiKey,...a}).slice(1),l=await n._getAdditionalHeaders();l["Content-Type"]="application/json",n.languageCode&&(l["X-Firebase-Locale"]=n.languageCode);const h={method:e,headers:l,...i};return P_()||(h.referrerPolicy="no-referrer"),n.emulatorConfig&&vn(n.emulatorConfig.host)&&(h.credentials="include"),Dp.fetch()(await Op(n,n.config.apiHost,t,c),h)})}async function Vp(n,e,t){n._canInitEmulator=!1;const r={...II,...e};try{const s=new RI(n),i=await Promise.race([t(),s.promise]);s.clearNetworkTimeout();const a=await i.json();if("needConfirmation"in a)throw hi(n,"account-exists-with-different-credential",a);if(i.ok&&!("errorMessage"in a))return a;{const c=i.ok?a.errorMessage:a.error.message,[l,h]=c.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw hi(n,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw hi(n,"email-already-in-use",a);if(l==="USER_DISABLED")throw hi(n,"user-disabled",a);const d=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw eu(n,d,h);bt(n,d)}}catch(s){if(s instanceof St)throw s;bt(n,"network-request-failed",{message:String(s)})}}async function bI(n,e,t,r,s={}){const i=await $r(n,e,t,r,s);return"mfaPendingCredential"in i&&bt(n,"multi-factor-auth-required",{_serverResponse:i}),i}async function Op(n,e,t,r){const s=`${e}${t}?${r}`,i=n,a=i.config.emulator?nu(n.config,s):`${n.config.apiScheme}://${s}`;return wI.includes(t)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(a).toString():a}class RI{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(ot(this.auth,"network-request-failed")),AI.get())})}}function hi(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const s=ot(n,e,r);return s.customData._tokenResponse=t,s}async function SI(n,e){return $r(n,"POST","/v1/accounts:delete",e)}async function qi(n,e){return $r(n,"POST","/v1/accounts:lookup",e)}function vs(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function PI(n,e=!1){const t=ge(n),r=await t.getIdToken(e),s=su(r);j(s&&s.exp&&s.auth_time&&s.iat,t.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,a=i?.sign_in_provider;return{claims:s,token:r,authTime:vs(pa(s.auth_time)),issuedAtTime:vs(pa(s.iat)),expirationTime:vs(pa(s.exp)),signInProvider:a||null,signInSecondFactor:i?.sign_in_second_factor||null}}function pa(n){return Number(n)*1e3}function su(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Ei("JWT malformed, contained fewer than 3 sections"),null;try{const s=Wf(t);return s?JSON.parse(s):(Ei("Failed to decode base64 JWT payload"),null)}catch(s){return Ei("Caught error parsing JWT payload as JSON",s?.toString()),null}}function Oh(n){const e=su(n);return j(e,"internal-error"),j(typeof e.exp<"u","internal-error"),j(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function ks(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof St&&CI(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function CI({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class kI{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class Ka{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=vs(this.lastLoginAt),this.creationTime=vs(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function zi(n){const e=n.auth,t=await n.getIdToken(),r=await ks(n,qi(e,{idToken:t}));j(r?.users.length,e,"internal-error");const s=r.users[0];n._notifyReloadListener(s);const i=s.providerUserInfo?.length?Mp(s.providerUserInfo):[],a=DI(n.providerData,i),c=n.isAnonymous,l=!(n.email&&s.passwordHash)&&!a?.length,h=c?l:!1,d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new Ka(s.createdAt,s.lastLoginAt),isAnonymous:h};Object.assign(n,d)}async function NI(n){const e=ge(n);await zi(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function DI(n,e){return[...n.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function Mp(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function VI(n,e){const t=await Vp(n,{},async()=>{const r=Ms({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=n.config,a=await Op(n,s,"/v1/token",`key=${i}`),c=await n._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:c,body:r};return n.emulatorConfig&&vn(n.emulatorConfig.host)&&(l.credentials="include"),Dp.fetch()(a,l)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function OI(n,e){return $r(n,"POST","/v2/accounts:revokeToken",ru(n,e))}class gr{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){j(e.idToken,"internal-error"),j(typeof e.idToken<"u","internal-error"),j(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Oh(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){j(e.length!==0,"internal-error");const t=Oh(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(j(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:s,expiresIn:i}=await VI(e,t);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:s,expirationTime:i}=t,a=new gr;return r&&(j(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),s&&(j(typeof s=="string","internal-error",{appName:e}),a.accessToken=s),i&&(j(typeof i=="number","internal-error",{appName:e}),a.expirationTime=i),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new gr,this.toJSON())}_performRefresh(){return Nt("not implemented")}}function Jt(n,e){j(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class st{constructor({uid:e,auth:t,stsTokenManager:r,...s}){this.providerId="firebase",this.proactiveRefresh=new kI(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Ka(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await ks(this,this.stsTokenManager.getToken(this.auth,e));return j(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return PI(this,e)}reload(){return NI(this)}_assign(e){this!==e&&(j(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new st({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){j(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await zi(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(tt(this.auth.app))return Promise.reject(Ln(this.auth));const e=await this.getIdToken();return await ks(this,SI(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const r=t.displayName??void 0,s=t.email??void 0,i=t.phoneNumber??void 0,a=t.photoURL??void 0,c=t.tenantId??void 0,l=t._redirectEventId??void 0,h=t.createdAt??void 0,d=t.lastLoginAt??void 0,{uid:g,emailVerified:m,isAnonymous:E,providerData:S,stsTokenManager:C}=t;j(g&&C,e,"internal-error");const P=gr.fromJSON(this.name,C);j(typeof g=="string",e,"internal-error"),Jt(r,e.name),Jt(s,e.name),j(typeof m=="boolean",e,"internal-error"),j(typeof E=="boolean",e,"internal-error"),Jt(i,e.name),Jt(a,e.name),Jt(c,e.name),Jt(l,e.name),Jt(h,e.name),Jt(d,e.name);const L=new st({uid:g,auth:e,email:s,emailVerified:m,displayName:r,isAnonymous:E,photoURL:a,phoneNumber:i,tenantId:c,stsTokenManager:P,createdAt:h,lastLoginAt:d});return S&&Array.isArray(S)&&(L.providerData=S.map(O=>({...O}))),l&&(L._redirectEventId=l),L}static async _fromIdTokenResponse(e,t,r=!1){const s=new gr;s.updateFromServerResponse(t);const i=new st({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await zi(i),i}static async _fromGetAccountInfoResponse(e,t,r){const s=t.users[0];j(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?Mp(s.providerUserInfo):[],a=!(s.email&&s.passwordHash)&&!i?.length,c=new gr;c.updateFromIdToken(r);const l=new st({uid:s.localId,auth:e,stsTokenManager:c,isAnonymous:a}),h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new Ka(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!i?.length};return Object.assign(l,h),l}}const Mh=new Map;function Dt(n){xt(n instanceof Function,"Expected a class definition");let e=Mh.get(n);return e?(xt(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Mh.set(n,e),e)}class Lp{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Lp.type="NONE";const Lh=Lp;function Ti(n,e,t){return`firebase:${n}:${e}:${t}`}class _r{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=Ti(this.userKey,s.apiKey,i),this.fullPersistenceKey=Ti("persistence",s.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await qi(this.auth,{idToken:e}).catch(()=>{});return t?st._fromGetAccountInfoResponse(this.auth,t,e):null}return st._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new _r(Dt(Lh),e,r);const s=(await Promise.all(t.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let i=s[0]||Dt(Lh);const a=Ti(r,e.config.apiKey,e.name);let c=null;for(const h of t)try{const d=await h._get(a);if(d){let g;if(typeof d=="string"){const m=await qi(e,{idToken:d}).catch(()=>{});if(!m)break;g=await st._fromGetAccountInfoResponse(e,m,d)}else g=st._fromJSON(e,d);h!==i&&(c=g),i=h;break}}catch{}const l=s.filter(h=>h._shouldAllowMigration);return!i._shouldAllowMigration||!l.length?new _r(i,e,r):(i=l[0],c&&await i._set(a,c.toJSON()),await Promise.all(t.map(async h=>{if(h!==i)try{await h._remove(a)}catch{}})),new _r(i,e,r))}}function xh(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Bp(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(xp(e))return"Firefox";if(e.includes("silk/"))return"Silk";if($p(e))return"Blackberry";if(qp(e))return"Webos";if(Fp(e))return"Safari";if((e.includes("chrome/")||Up(e))&&!e.includes("edge/"))return"Chrome";if(jp(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function xp(n=Fe()){return/firefox\//i.test(n)}function Fp(n=Fe()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Up(n=Fe()){return/crios\//i.test(n)}function Bp(n=Fe()){return/iemobile/i.test(n)}function jp(n=Fe()){return/android/i.test(n)}function $p(n=Fe()){return/blackberry/i.test(n)}function qp(n=Fe()){return/webos/i.test(n)}function iu(n=Fe()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function MI(n=Fe()){return iu(n)&&!!window.navigator?.standalone}function LI(){return N_()&&document.documentMode===10}function zp(n=Fe()){return iu(n)||jp(n)||qp(n)||$p(n)||/windows phone/i.test(n)||Bp(n)}function Hp(n,e=[]){let t;switch(n){case"Browser":t=xh(Fe());break;case"Worker":t=`${xh(Fe())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${xr}/${r}`}class xI{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=i=>new Promise((a,c)=>{try{const l=e(i);a(l)}catch(l){c(l)}});r.onAbort=t,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const s of t)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}}async function FI(n,e={}){return $r(n,"GET","/v2/passwordPolicy",ru(n,e))}const UI=6;class BI{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??UI,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),s&&(t.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}class jI{constructor(e,t,r,s){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Fh(this),this.idTokenSubscription=new Fh(this),this.beforeStateQueue=new xI(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Np,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Dt(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await _r.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await qi(this,{idToken:e}),r=await st._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(tt(this.app)){const i=this.app.settings.authIdToken;return i?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(i).then(a,a))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let r=t,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const i=this.redirectUser?._redirectEventId,a=r?._redirectEventId,c=await this.tryRedirectSignIn(e);(!i||i===a)&&c?.user&&(r=c.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(i){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(i))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return j(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await zi(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=TI()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(tt(this.app))return Promise.reject(Ln(this));const t=e?ge(e):null;return t&&j(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&j(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return tt(this.app)?Promise.reject(Ln(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return tt(this.app)?Promise.reject(Ln(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Dt(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await FI(this),t=new BI(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Os("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await OI(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Dt(e)||this._popupRedirectResolver;j(t,this,"argument-error"),this.redirectPersistenceManager=await _r.create(this,[Dt(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,s){if(this._deleted)return()=>{};const i=typeof t=="function"?t:t.next.bind(t);let a=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(j(c,this,"internal-error"),c.then(()=>{a||i(this.currentUser)}),typeof t=="function"){const l=e.addObserver(t,r,s);return()=>{a=!0,l()}}else{const l=e.addObserver(t);return()=>{a=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return j(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Hp(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(tt(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&_I(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Ro(n){return ge(n)}class Fh{constructor(e){this.auth=e,this.observer=null,this.addObserver=U_(t=>this.observer=t)}get next(){return j(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let ou={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function $I(n){ou=n}function qI(n){return ou.loadJS(n)}function zI(){return ou.gapiScript}function HI(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function WI(n,e){const t=ao(n,"auth");if(t.isInitialized()){const s=t.getImmediate(),i=t.getOptions();if(Un(i,e??{}))return s;bt(s,"already-initialized")}return t.initialize({options:e})}function GI(n,e){const t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(Dt);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function KI(n,e,t){const r=Ro(n);j(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=Wp(e),{host:a,port:c}=QI(e),l=c===null?"":`:${c}`,h={url:`${i}//${a}${l}/`},d=Object.freeze({host:a,port:c,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){j(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),j(Un(h,r.config.emulator)&&Un(d,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=h,r.emulatorConfig=d,r.settings.appVerificationDisabledForTesting=!0,vn(a)?(gc(`${i}//${a}${l}`),_c("Auth",!0)):XI()}function Wp(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function QI(n){const e=Wp(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:Uh(r.substr(i.length+1))}}else{const[i,a]=r.split(":");return{host:i,port:Uh(a)}}}function Uh(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function XI(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class Gp{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Nt("not implemented")}_getIdTokenResponse(e){return Nt("not implemented")}_linkToIdToken(e,t){return Nt("not implemented")}_getReauthenticationResolver(e){return Nt("not implemented")}}async function yr(n,e){return bI(n,"POST","/v1/accounts:signInWithIdp",ru(n,e))}const JI="http://localhost";class qn extends Gp{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new qn(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):bt("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,...i}=t;if(!r||!s)return null;const a=new qn(r,s);return a.idToken=i.idToken||void 0,a.accessToken=i.accessToken||void 0,a.secret=i.secret,a.nonce=i.nonce,a.pendingToken=i.pendingToken||null,a}_getIdTokenResponse(e){const t=this.buildRequest();return yr(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,yr(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,yr(e,t)}buildRequest(){const e={requestUri:JI,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Ms(t)}return e}}class au{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class $s extends au{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Yt extends $s{constructor(){super("facebook.com")}static credential(e){return qn._fromParams({providerId:Yt.PROVIDER_ID,signInMethod:Yt.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Yt.credentialFromTaggedObject(e)}static credentialFromError(e){return Yt.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Yt.credential(e.oauthAccessToken)}catch{return null}}}Yt.FACEBOOK_SIGN_IN_METHOD="facebook.com";Yt.PROVIDER_ID="facebook.com";class kt extends $s{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return qn._fromParams({providerId:kt.PROVIDER_ID,signInMethod:kt.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return kt.credentialFromTaggedObject(e)}static credentialFromError(e){return kt.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return kt.credential(t,r)}catch{return null}}}kt.GOOGLE_SIGN_IN_METHOD="google.com";kt.PROVIDER_ID="google.com";class Zt extends $s{constructor(){super("github.com")}static credential(e){return qn._fromParams({providerId:Zt.PROVIDER_ID,signInMethod:Zt.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Zt.credentialFromTaggedObject(e)}static credentialFromError(e){return Zt.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Zt.credential(e.oauthAccessToken)}catch{return null}}}Zt.GITHUB_SIGN_IN_METHOD="github.com";Zt.PROVIDER_ID="github.com";class en extends $s{constructor(){super("twitter.com")}static credential(e,t){return qn._fromParams({providerId:en.PROVIDER_ID,signInMethod:en.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return en.credentialFromTaggedObject(e)}static credentialFromError(e){return en.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return en.credential(t,r)}catch{return null}}}en.TWITTER_SIGN_IN_METHOD="twitter.com";en.PROVIDER_ID="twitter.com";class Dr{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,s=!1){const i=await st._fromIdTokenResponse(e,r,s),a=Bh(r);return new Dr({user:i,providerId:a,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const s=Bh(r);return new Dr({user:e,providerId:s,_tokenResponse:r,operationType:t})}}function Bh(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class Hi extends St{constructor(e,t,r,s){super(t.code,t.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,Hi.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,s){return new Hi(e,t,r,s)}}function Kp(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Hi._fromErrorAndOperation(n,i,e,r):i})}async function YI(n,e,t=!1){const r=await ks(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Dr._forOperation(n,"link",r)}async function ZI(n,e,t=!1){const{auth:r}=n;if(tt(r.app))return Promise.reject(Ln(r));const s="reauthenticate";try{const i=await ks(n,Kp(r,s,e,n),t);j(i.idToken,r,"internal-error");const a=su(i.idToken);j(a,r,"internal-error");const{sub:c}=a;return j(n.uid===c,r,"user-mismatch"),Dr._forOperation(n,s,i)}catch(i){throw i?.code==="auth/user-not-found"&&bt(r,"user-mismatch"),i}}async function ew(n,e,t=!1){if(tt(n.app))return Promise.reject(Ln(n));const r="signIn",s=await Kp(n,r,e),i=await Dr._fromIdTokenResponse(n,r,s);return t||await n._updateCurrentUser(i.user),i}function tw(n,e,t,r){return ge(n).onIdTokenChanged(e,t,r)}function nw(n,e,t){return ge(n).beforeAuthStateChanged(e,t)}function rw(n,e,t,r){return ge(n).onAuthStateChanged(e,t,r)}function sw(n){return ge(n).signOut()}const Wi="__sak";class Qp{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Wi,"1"),this.storage.removeItem(Wi),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const iw=1e3,ow=10;class Xp extends Qp{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=zp(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),s=this.localCache[t];r!==s&&e(t,s,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((a,c,l)=>{this.notifyListeners(a,l)});return}const r=e.key;t?this.detachListener():this.stopPolling();const s=()=>{const a=this.storage.getItem(r);!t&&this.localCache[r]===a||this.notifyListeners(r,a)},i=this.storage.getItem(r);LI()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,ow):s()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},iw)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Xp.type="LOCAL";const aw=Xp;class Jp extends Qp{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Jp.type="SESSION";const Yp=Jp;function cw(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class So{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(s=>s.isListeningto(e));if(t)return t;const r=new So(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:s,data:i}=t.data,a=this.handlersMap[s];if(!a?.size)return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const c=Array.from(a).map(async h=>h(t.origin,i)),l=await cw(c);t.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:l})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}So.receivers=[];function cu(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}class uw{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,a;return new Promise((c,l)=>{const h=cu("",20);s.port1.start();const d=setTimeout(()=>{l(new Error("unsupported_event"))},r);a={messageChannel:s,onMessage(g){const m=g;if(m.data.eventId===h)switch(m.data.status){case"ack":clearTimeout(d),i=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),c(m.data.response);break;default:clearTimeout(d),clearTimeout(i),l(new Error("invalid_response"));break}}},this.handlers.add(a),s.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:h,data:t},[s.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}function Tt(){return window}function lw(n){Tt().location.href=n}function Zp(){return typeof Tt().WorkerGlobalScope<"u"&&typeof Tt().importScripts=="function"}async function hw(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function fw(){return navigator?.serviceWorker?.controller||null}function dw(){return Zp()?self:null}const em="firebaseLocalStorageDb",pw=1,Gi="firebaseLocalStorage",tm="fbase_key";class qs{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Po(n,e){return n.transaction([Gi],e?"readwrite":"readonly").objectStore(Gi)}function mw(){const n=indexedDB.deleteDatabase(em);return new qs(n).toPromise()}function Qa(){const n=indexedDB.open(em,pw);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(Gi,{keyPath:tm})}catch(s){t(s)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(Gi)?e(r):(r.close(),await mw(),e(await Qa()))})})}async function jh(n,e,t){const r=Po(n,!0).put({[tm]:e,value:t});return new qs(r).toPromise()}async function gw(n,e){const t=Po(n,!1).get(e),r=await new qs(t).toPromise();return r===void 0?null:r.value}function $h(n,e){const t=Po(n,!0).delete(e);return new qs(t).toPromise()}const _w=800,yw=3;class nm{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Qa(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>yw)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Zp()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=So._getInstance(dw()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await hw(),!this.activeServiceWorker)return;this.sender=new uw(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||fw()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Qa();return await jh(e,Wi,"1"),await $h(e,Wi),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>jh(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>gw(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>$h(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=Po(s,!1).getAll();return new qs(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),t.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),t.push(s));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),_w)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}nm.type="LOCAL";const vw=nm;new js(3e4,6e4);function rm(n,e){return e?Dt(e):(j(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class uu extends Gp{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return yr(e,this._buildIdpRequest())}_linkToIdToken(e,t){return yr(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return yr(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Ew(n){return ew(n.auth,new uu(n),n.bypassAuthState)}function Tw(n){const{auth:e,user:t}=n;return j(t,e,"internal-error"),ZI(t,new uu(n),n.bypassAuthState)}async function Iw(n){const{auth:e,user:t}=n;return j(t,e,"internal-error"),YI(t,new uu(n),n.bypassAuthState)}class sm{constructor(e,t,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:s,tenantId:i,error:a,type:c}=e;if(a){this.reject(a);return}const l={auth:this.auth,requestUri:t,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(l))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Ew;case"linkViaPopup":case"linkViaRedirect":return Iw;case"reauthViaPopup":case"reauthViaRedirect":return Tw;default:bt(this.auth,"internal-error")}}resolve(e){xt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){xt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const ww=new js(2e3,1e4);async function Aw(n,e,t){if(tt(n.app))return Promise.reject(ot(n,"operation-not-supported-in-this-environment"));const r=Ro(n);yI(n,e,au);const s=rm(r,t);return new Nn(r,"signInViaPopup",e,s).executeNotNull()}class Nn extends sm{constructor(e,t,r,s,i){super(e,t,s,i),this.provider=r,this.authWindow=null,this.pollId=null,Nn.currentPopupAction&&Nn.currentPopupAction.cancel(),Nn.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return j(e,this.auth,"internal-error"),e}async onExecution(){xt(this.filter.length===1,"Popup operations only handle one event");const e=cu();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(ot(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(ot(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Nn.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ot(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,ww.get())};e()}}Nn.currentPopupAction=null;const bw="pendingRedirect",Ii=new Map;class Rw extends sm{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=Ii.get(this.auth._key());if(!e){try{const r=await Sw(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Ii.set(this.auth._key(),e)}return this.bypassAuthState||Ii.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Sw(n,e){const t=kw(e),r=Cw(n);if(!await r._isAvailable())return!1;const s=await r._get(t)==="true";return await r._remove(t),s}function Pw(n,e){Ii.set(n._key(),e)}function Cw(n){return Dt(n._redirectPersistence)}function kw(n){return Ti(bw,n.config.apiKey,n.name)}async function Nw(n,e,t=!1){if(tt(n.app))return Promise.reject(Ln(n));const r=Ro(n),s=rm(r,e),a=await new Rw(r,s,t).execute();return a&&!t&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,e)),a}const Dw=600*1e3;class Vw{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Ow(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!im(e)){const r=e.error.code?.split("auth/")[1]||"internal-error";t.onError(ot(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Dw&&this.cachedEventUids.clear(),this.cachedEventUids.has(qh(e))}saveEventToCache(e){this.cachedEventUids.add(qh(e)),this.lastProcessedEventTime=Date.now()}}function qh(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function im({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function Ow(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return im(n);default:return!1}}async function Mw(n,e={}){return $r(n,"GET","/v1/projects",e)}const Lw=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,xw=/^https?/;async function Fw(n){if(n.config.emulator)return;const{authorizedDomains:e}=await Mw(n);for(const t of e)try{if(Uw(t))return}catch{}bt(n,"unauthorized-domain")}function Uw(n){const e=Ga(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const a=new URL(n);return a.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&a.hostname===r}if(!xw.test(t))return!1;if(Lw.test(n))return r===n;const s=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}const Bw=new js(3e4,6e4);function zh(){const n=Tt().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function jw(n){return new Promise((e,t)=>{function r(){zh(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{zh(),t(ot(n,"network-request-failed"))},timeout:Bw.get()})}if(Tt().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Tt().gapi?.load)r();else{const s=HI("iframefcb");return Tt()[s]=()=>{gapi.load?r():t(ot(n,"network-request-failed"))},qI(`${zI()}?onload=${s}`).catch(i=>t(i))}}).catch(e=>{throw wi=null,e})}let wi=null;function $w(n){return wi=wi||jw(n),wi}const qw=new js(5e3,15e3),zw="__/auth/iframe",Hw="emulator/auth/iframe",Ww={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Gw=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Kw(n){const e=n.config;j(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?nu(e,Hw):`https://${n.config.authDomain}/${zw}`,r={apiKey:e.apiKey,appName:n.name,v:xr},s=Gw.get(n.config.apiHost);s&&(r.eid=s);const i=n._getFrameworks();return i.length&&(r.fw=i.join(",")),`${t}?${Ms(r).slice(1)}`}async function Qw(n){const e=await $w(n),t=Tt().gapi;return j(t,n,"internal-error"),e.open({where:document.body,url:Kw(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Ww,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const a=ot(n,"network-request-failed"),c=Tt().setTimeout(()=>{i(a)},qw.get());function l(){Tt().clearTimeout(c),s(r)}r.ping(l).then(l,()=>{i(a)})}))}const Xw={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Jw=500,Yw=600,Zw="_blank",eA="http://localhost";class Hh{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function tA(n,e,t,r=Jw,s=Yw){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let c="";const l={...Xw,width:r.toString(),height:s.toString(),top:i,left:a},h=Fe().toLowerCase();t&&(c=Up(h)?Zw:t),xp(h)&&(e=e||eA,l.scrollbars="yes");const d=Object.entries(l).reduce((m,[E,S])=>`${m}${E}=${S},`,"");if(MI(h)&&c!=="_self")return nA(e||"",c),new Hh(null);const g=window.open(e||"",c,d);j(g,n,"popup-blocked");try{g.focus()}catch{}return new Hh(g)}function nA(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}const rA="__/auth/handler",sA="emulator/auth/handler",iA=encodeURIComponent("fac");async function Wh(n,e,t,r,s,i){j(n.config.authDomain,n,"auth-domain-config-required"),j(n.config.apiKey,n,"invalid-api-key");const a={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:xr,eventId:s};if(e instanceof au){e.setDefaultLanguage(n.languageCode),a.providerId=e.providerId||"",F_(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,g]of Object.entries({}))a[d]=g}if(e instanceof $s){const d=e.getScopes().filter(g=>g!=="");d.length>0&&(a.scopes=d.join(","))}n.tenantId&&(a.tid=n.tenantId);const c=a;for(const d of Object.keys(c))c[d]===void 0&&delete c[d];const l=await n._getAppCheckToken(),h=l?`#${iA}=${encodeURIComponent(l)}`:"";return`${oA(n)}?${Ms(c).slice(1)}${h}`}function oA({config:n}){return n.emulator?nu(n,sA):`https://${n.authDomain}/${rA}`}const ma="webStorageSupport";class aA{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Yp,this._completeRedirectFn=Nw,this._overrideRedirectResult=Pw}async _openPopup(e,t,r,s){xt(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const i=await Wh(e,t,r,Ga(),s);return tA(e,i,cu())}async _openRedirect(e,t,r,s){await this._originValidation(e);const i=await Wh(e,t,r,Ga(),s);return lw(i),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:s,promise:i}=this.eventManagers[t];return s?Promise.resolve(s):(xt(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await Qw(e),r=new Vw(e);return t.register("authEvent",s=>(j(s?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(ma,{type:ma},s=>{const i=s?.[0]?.[ma];i!==void 0&&t(!!i),bt(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=Fw(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return zp()||Fp()||iu()}}const cA=aA;var Gh="@firebase/auth",Kh="1.11.1";class uA{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){j(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function lA(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function hA(n){Bn(new hn("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:a,authDomain:c}=r.options;j(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:a,authDomain:c,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Hp(n)},h=new jI(r,s,i,l);return GI(h,t),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Bn(new hn("auth-internal",e=>{const t=Ro(e.getProvider("auth").getImmediate());return(r=>new uA(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),gt(Gh,Kh,lA(n)),gt(Gh,Kh,"esm2020")}const fA=300,dA=Xf("authIdTokenMaxAge")||fA;let Qh=null;const pA=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>dA)return;const s=t?.token;Qh!==s&&(Qh=s,await fetch(n,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function mA(n=Ec()){const e=ao(n,"auth");if(e.isInitialized())return e.getImmediate();const t=WI(n,{popupRedirectResolver:cA,persistence:[vw,aw,Yp]}),r=Xf("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const a=pA(i.toString());nw(t,a,()=>a(t.currentUser)),tw(t,c=>a(c))}}const s=Gf("auth");return s&&KI(t,`http://${s}`),t}function gA(){return document.getElementsByTagName("head")?.[0]??document}$I({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=s=>{const i=ot("internal-error");i.customData=s,t(i)},r.type="text/javascript",r.charset="UTF-8",gA().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});hA("Browser");const _A={apiKey:"AIzaSyBC5VHNEcVL9KP8M0d64ZajF6P4Hzqzafc",authDomain:"bbnme-58716.firebaseapp.com",projectId:"bbnme-58716",storageBucket:"bbnme-58716.appspot.com",messagingSenderId:"155088179379",appId:"1:155088179379:web:5d98445c178b7513f520c6"},lu=Zf(_A),Ki=JT(lu),hu=mA(lu),yA=new kt,Co=$f(null),om=$f(!0);rw(hu,n=>{Co.set(n),om.set(!1)});var vA=Ie('<button class="svelte-18sv61c"> </button>');function zn(n,e){let t=dr(e,"label",8,"Button"),r=dr(e,"onClick",8,()=>{});var s=vA(),i=ye(s);wr(()=>dc(i,t())),Vs("click",s,function(...a){r()?.apply(this,a)}),he(n,s)}var EA=Ie('<div class="login-container svelte-8ukb9p"><h2 class="svelte-8ukb9p">Please sign in to continue</h2> <!></div>');function TA(n,e){Bt(e,!1),yn();var t=EA(),r=fe(ye(t),2);zn(r,{label:"Sign in with Google",onClick:()=>Aw(hu,yA)}),he(n,t),jt()}var IA=Ie('<button class="hamburger-button svelte-p9dp8"><div class="bar svelte-p9dp8"></div> <div class="bar svelte-p9dp8"></div> <div class="bar svelte-p9dp8"></div></button>');function wA(n,e){Bt(e,!1);const t=mc();function r(){t("toggle")}yn();var s=IA();Vs("click",s,r),he(n,s),jt()}var AA=Ie('<span class="not-authorized-message svelte-rfuq4y">Unauthorized user</span>'),bA=Ie(`<nav class="svelte-rfuq4y"><!> <div class="navbar-title svelte-rfuq4y"><h1 class="svelte-rfuq4y">bb'n'me</h1></div> <div class="user-status svelte-rfuq4y"><!></div></nav>`);function RA(n,e){Bt(e,!1);const t=()=>Si(Co,"$user",r),[r,s]=pc(),i=Ce(),a=mc(),{get:c}=ic("isAuthorizedToWrite");function l(){a("toggle")}ro(()=>{},()=>{Q(i,c())}),so(),yn();var h=bA(),d=ye(h);wA(d,{$$events:{toggle:l}});var g=fe(d,4),m=ye(g);{var E=S=>{var C=AA();he(S,C)};mt(m,S=>{t()&&!F(i)&&S(E)})}he(n,h),jt(),s()}var SA=Ie('<span class="not-authorized-message svelte-12buoxc">Unauthorized user</span>'),PA=Ie('<div class="user-profile svelte-12buoxc"><img alt="Profile" class="svelte-12buoxc"/> <span class="svelte-12buoxc"> </span> <!></div> <div class="nav-links-wrapper svelte-12buoxc"><div class="nav-links svelte-12buoxc"><a href="/" class="svelte-12buoxc">Home</a></div></div> <div class="sidenav-footer svelte-12buoxc"><!></div>',1),CA=Ie('<div><button class="close-button svelte-12buoxc">&times;</button> <!></div>');function kA(n,e){Bt(e,!1);const t=()=>Si(Co,"$user",r),[r,s]=pc(),i=Ce();let a=dr(e,"isOpen",8,!1);const c=mc(),{get:l}=ic("isAuthorizedToWrite");function h(){c("close")}ro(()=>{},()=>{Q(i,l())}),so(),yn();var d=CA();let g;var m=ye(d),E=fe(m,2);{var S=C=>{var P=PA(),L=lr(P),O=ye(L),V=fe(O,2),q=ye(V),Y=fe(V,2);{var Z=v=>{var w=SA();he(v,w)};mt(Y,v=>{F(i)||v(Z)})}var I=fe(L,4),_=ye(I);zn(_,{label:"Sign out",onClick:()=>sw(hu)}),wr(()=>{di(O,"src",(t(),ze(()=>t().photoURL))),dc(q,(t(),ze(()=>t().displayName)))}),he(C,P)};mt(E,C=>{t()&&C(S)})}wr(()=>g=Uf(d,1,"sidenav svelte-12buoxc",null,g,{open:a()})),Vs("click",m,h),he(n,d),jt(),s()}var NA=Ie('<form class="svelte-7mtrh0"><h2 class="svelte-7mtrh0">Add a new place</h2> <input type="text" placeholder="Place name" required class="svelte-7mtrh0"/> <input type="url" placeholder="Website" class="svelte-7mtrh0"/> <input type="url" placeholder="Image URL" class="svelte-7mtrh0"/> <!></form>');function DA(n,e){Bt(e,!1);let t=Ce(""),r=Ce(""),s=Ce("");async function i(){try{const g=await dI(vp(Ki,"places"),{name:F(t),website:F(r),image:F(s)});console.log("Document written with ID: ",g.id),Q(t,""),Q(r,""),Q(s,"")}catch(g){console.error("Error adding document: ",g)}}yn();var a=NA(),c=fe(ye(a),2),l=fe(c,2),h=fe(l,2),d=fe(h,2);zn(d,{label:"Add Place",type:"submit"}),fr(c,()=>F(t),g=>Q(t,g)),fr(l,()=>F(r),g=>Q(r,g)),fr(h,()=>F(s),g=>Q(s,g)),Vs("submit",a,Bf(i)),he(n,a),jt()}var VA=Ie('<div class="card svelte-1udyrqm"><!></div>');function Xa(n,e){var t=VA(),r=ye(t);r_(r,e,"default",{}),he(n,t)}var OA=Ie('<form class="svelte-136zmjt"><h2 class="svelte-136zmjt">Edit Place</h2> <input type="text" placeholder="Place name" required class="svelte-136zmjt"/> <input type="url" placeholder="Website" class="svelte-136zmjt"/> <input type="url" placeholder="Image URL" class="svelte-136zmjt"/> <div class="actions svelte-136zmjt"><!> <!></div></form>');function MA(n,e){Bt(e,!1);let t=dr(e,"place",8),r=dr(e,"onSave",8,()=>{}),s=dr(e,"onCancel",8,()=>{}),i=Ce(t().name),a=Ce(t().website),c=Ce(t().image);async function l(){try{const P=Kc(Ki,"places",t().id);await hI(P,{name:F(i),website:F(a),image:F(c)}),console.log("Document successfully updated!"),r()()}catch(P){console.error("Error updating document: ",P)}}yn();var h=OA(),d=fe(ye(h),2),g=fe(d,2),m=fe(g,2),E=fe(m,2),S=ye(E);zn(S,{label:"Save",type:"submit"});var C=fe(S,2);zn(C,{label:"Cancel",get onClick(){return s()}}),fr(d,()=>F(i),P=>Q(i,P)),fr(g,()=>F(a),P=>Q(a,P)),fr(m,()=>F(c),P=>Q(c,P)),Vs("submit",h,Bf(l)),he(n,h),jt()}var LA=Ie('<a target="_blank" rel="noreferrer"><img class="svelte-13geuu4"/></a>'),xA=Ie('<div class="actions svelte-13geuu4"><!> <!></div>'),FA=Ie('<h3 class="svelte-13geuu4"><b> </b></h3> <!> <!>',1),UA=Ie('<div class="svelte-13geuu4"><h2 class="svelte-13geuu4">Travel Wishlist</h2> <!></div>');function BA(n,e){Bt(e,!1);const t=Ce(),{get:r}=ic("isAuthorizedToWrite");let s=Ce([]),i=Ce(null);qf(()=>{const m=pI(vp(Ki,"places"),E=>{Q(s,E.docs.map(S=>({id:S.id,...S.data()})))});return()=>m()});async function a(m){try{await fI(Kc(Ki,"places",m)),console.log("Document successfully deleted!")}catch(E){console.error("Error removing document: ",E)}}function c(m){Q(i,m)}function l(){Q(i,null)}function h(){Q(i,null)}ro(()=>{},()=>{Q(t,r())}),so(),yn();var d=UA(),g=fe(ye(d),2);t_(g,1,()=>F(s),Zg,(m,E)=>{Xa(m,{children:(S,C)=>{var P=wa(),L=lr(P);{var O=q=>{MA(q,{get place(){return F(i)},onSave:l,onCancel:h})},V=q=>{var Y=FA(),Z=lr(Y),I=ye(Z),_=ye(I),v=fe(Z,2);{var w=y=>{var se=LA(),be=ye(se);wr(()=>{di(se,"href",(F(E),ze(()=>F(E).website))),di(be,"src",(F(E),ze(()=>F(E).image))),di(be,"alt",(F(E),ze(()=>F(E).name)))}),he(y,se)};mt(v,y=>{F(E),ze(()=>F(E).image)&&y(w)})}var T=fe(v,2);{var A=y=>{var se=xA(),be=ye(se);zn(be,{label:"Edit",onClick:()=>c(F(E))});var qr=fe(be,2);zn(qr,{label:"Delete",onClick:()=>a(F(E).id)}),he(y,se)};mt(T,y=>{F(t)&&y(A)})}wr(()=>dc(_,(F(E),ze(()=>F(E).name)))),he(q,Y)};mt(L,q=>{F(i),F(E),ze(()=>F(i)&&F(i).id===F(E).id)?q(O):q(V,!1)})}he(S,P)},$$slots:{default:!0}})}),he(n,d),jt()}const jA="type.googleapis.com/google.protobuf.Int64Value",$A="type.googleapis.com/google.protobuf.UInt64Value";function am(n,e){const t={};for(const r in n)n.hasOwnProperty(r)&&(t[r]=e(n[r]));return t}function Qi(n){if(n==null)return null;if(n instanceof Number&&(n=n.valueOf()),typeof n=="number"&&isFinite(n)||n===!0||n===!1||Object.prototype.toString.call(n)==="[object String]")return n;if(n instanceof Date)return n.toISOString();if(Array.isArray(n))return n.map(e=>Qi(e));if(typeof n=="function"||typeof n=="object")return am(n,e=>Qi(e));throw new Error("Data cannot be encoded in JSON: "+n)}function Vr(n){if(n==null)return n;if(n["@type"])switch(n["@type"]){case jA:case $A:{const e=Number(n.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+n);return e}default:throw new Error("Data cannot be decoded from JSON: "+n)}return Array.isArray(n)?n.map(e=>Vr(e)):typeof n=="function"||typeof n=="object"?am(n,e=>Vr(e)):n}const fu="functions";const Xh={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ge extends St{constructor(e,t,r){super(`${fu}/${e}`,t||""),this.details=r,Object.setPrototypeOf(this,Ge.prototype)}}function qA(n){if(n>=200&&n<300)return"ok";switch(n){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function Xi(n,e){let t=qA(n),r=t,s;try{const i=e&&e.error;if(i){const a=i.status;if(typeof a=="string"){if(!Xh[a])return new Ge("internal","internal");t=Xh[a],r=a}const c=i.message;typeof c=="string"&&(r=c),s=i.details,s!==void 0&&(s=Vr(s))}}catch{}return t==="ok"?null:new Ge(t,r,s)}class zA{constructor(e,t,r,s){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,tt(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=t.getImmediate({optional:!0}),this.messaging=r.getImmediate({optional:!0}),this.auth||t.get().then(i=>this.auth=i,()=>{}),this.messaging||r.get().then(i=>this.messaging=i,()=>{}),this.appCheck||s?.get().then(i=>this.appCheck=i,()=>{})}async getAuthToken(){if(this.auth)try{return(await this.auth.getToken())?.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){const t=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return t.error?null:t.token}return null}async getContext(e){const t=await this.getAuthToken(),r=await this.getMessagingToken(),s=await this.getAppCheckToken(e);return{authToken:t,messagingToken:r,appCheckToken:s}}}const Ja="us-central1",HA=/^data: (.*?)(?:\n|$)/;function WA(n){let e=null;return{promise:new Promise((t,r)=>{e=setTimeout(()=>{r(new Ge("deadline-exceeded","deadline-exceeded"))},n)}),cancel:()=>{e&&clearTimeout(e)}}}class GA{constructor(e,t,r,s,i=Ja,a=(...c)=>fetch(...c)){this.app=e,this.fetchImpl=a,this.emulatorOrigin=null,this.contextProvider=new zA(e,t,r,s),this.cancelAllRequests=new Promise(c=>{this.deleteService=()=>Promise.resolve(c())});try{const c=new URL(i);this.customDomain=c.origin+(c.pathname==="/"?"":c.pathname),this.region=Ja}catch{this.customDomain=null,this.region=i}}_delete(){return this.deleteService()}_url(e){const t=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${t}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${t}.cloudfunctions.net/${e}`}}function KA(n,e,t){const r=vn(e);n.emulatorOrigin=`http${r?"s":""}://${e}:${t}`,r&&(gc(n.emulatorOrigin+"/backends"),_c("Functions",!0))}function QA(n,e,t){const r=s=>JA(n,e,s,{});return r.stream=(s,i)=>ZA(n,e,s,i),r}function cm(n){return n.emulatorOrigin&&vn(n.emulatorOrigin)?"include":void 0}async function XA(n,e,t,r,s){t["Content-Type"]="application/json";let i;try{i=await r(n,{method:"POST",body:JSON.stringify(e),headers:t,credentials:cm(s)})}catch{return{status:0,json:null}}let a=null;try{a=await i.json()}catch{}return{status:i.status,json:a}}async function um(n,e){const t={},r=await n.contextProvider.getContext(e.limitedUseAppCheckTokens);return r.authToken&&(t.Authorization="Bearer "+r.authToken),r.messagingToken&&(t["Firebase-Instance-ID-Token"]=r.messagingToken),r.appCheckToken!==null&&(t["X-Firebase-AppCheck"]=r.appCheckToken),t}function JA(n,e,t,r){const s=n._url(e);return YA(n,s,t,r)}async function YA(n,e,t,r){t=Qi(t);const s={data:t},i=await um(n,r),a=r.timeout||7e4,c=WA(a),l=await Promise.race([XA(e,s,i,n.fetchImpl,n),c.promise,n.cancelAllRequests]);if(c.cancel(),!l)throw new Ge("cancelled","Firebase Functions instance was deleted.");const h=Xi(l.status,l.json);if(h)throw h;if(!l.json)throw new Ge("internal","Response is not valid JSON object.");let d=l.json.data;if(typeof d>"u"&&(d=l.json.result),typeof d>"u")throw new Ge("internal","Response is missing data field.");return{data:Vr(d)}}function ZA(n,e,t,r){const s=n._url(e);return eb(n,s,t,r||{})}async function eb(n,e,t,r){t=Qi(t);const s={data:t},i=await um(n,r);i["Content-Type"]="application/json",i.Accept="text/event-stream";let a;try{a=await n.fetchImpl(e,{method:"POST",body:JSON.stringify(s),headers:i,signal:r?.signal,credentials:cm(n)})}catch(m){if(m instanceof Error&&m.name==="AbortError"){const S=new Ge("cancelled","Request was cancelled.");return{data:Promise.reject(S),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(S)}}}}}}const E=Xi(0,null);return{data:Promise.reject(E),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(E)}}}}}}let c,l;const h=new Promise((m,E)=>{c=m,l=E});r?.signal?.addEventListener("abort",()=>{const m=new Ge("cancelled","Request was cancelled.");l(m)});const d=a.body.getReader(),g=tb(d,c,l,r?.signal);return{stream:{[Symbol.asyncIterator](){const m=g.getReader();return{async next(){const{value:E,done:S}=await m.read();return{value:E,done:S}},async return(){return await m.cancel(),{done:!0,value:void 0}}}}},data:h}}function tb(n,e,t,r){const s=(a,c)=>{const l=a.match(HA);if(!l)return;const h=l[1];try{const d=JSON.parse(h);if("result"in d){e(Vr(d.result));return}if("message"in d){c.enqueue(Vr(d.message));return}if("error"in d){const g=Xi(0,d);c.error(g),t(g);return}}catch(d){if(d instanceof Ge){c.error(d),t(d);return}}},i=new TextDecoder;return new ReadableStream({start(a){let c="";return l();async function l(){if(r?.aborted){const h=new Ge("cancelled","Request was cancelled");return a.error(h),t(h),Promise.resolve()}try{const{value:h,done:d}=await n.read();if(d){c.trim()&&s(c.trim(),a),a.close();return}if(r?.aborted){const m=new Ge("cancelled","Request was cancelled");a.error(m),t(m),await n.cancel();return}c+=i.decode(h,{stream:!0});const g=c.split(`
`);c=g.pop()||"";for(const m of g)m.trim()&&s(m.trim(),a);return l()}catch(h){const d=h instanceof Ge?h:Xi(0,null);a.error(d),t(d)}}},cancel(){return n.cancel()}})}const Jh="@firebase/functions",Yh="0.13.1";const nb="auth-internal",rb="app-check-internal",sb="messaging-internal";function ib(n){const e=(t,{instanceIdentifier:r})=>{const s=t.getProvider("app").getImmediate(),i=t.getProvider(nb),a=t.getProvider(sb),c=t.getProvider(rb);return new GA(s,i,a,c,r)};Bn(new hn(fu,e,"PUBLIC").setMultipleInstances(!0)),gt(Jh,Yh,n),gt(Jh,Yh,"esm2020")}function ob(n=Ec(),e=Ja){const r=ao(ge(n),fu).getImmediate({identifier:e}),s=Kf("functions");return s&&ab(r,...s),r}function ab(n,e,t){KA(ge(n),e,t)}function cb(n,e,t){return QA(ge(n),e)}ib();var ub=Ie('<div class="loading-screen svelte-1n46o8q"><img src="./assets/loading_image.png" alt="Loading..." class="loading-image svelte-1n46o8q"/></div>'),lb=Ie("<p>Checking authorization...</p>"),hb=Ie('<!> <!> <div class="container svelte-1n46o8q"><!> <!></div>',1),fb=Ie("<main><!></main>");function db(n,e){Bt(e,!1);const t=()=>Si(om,"$authLoading",s),r=()=>Si(Co,"$user",s),[s,i]=pc(),a=ob(lu),c=cb(a,"checkAuthorization"),l=1e3;let h=Ce(!1),d=Ce(!1),g=Ce(!1),m=Ce(!1);pg("isAuthorizedToWrite",{get:()=>F(h)}),qf(()=>{setTimeout(()=>{Q(g,!0)},l)});function E(){Q(m,!F(m))}ro(()=>(t(),r()),()=>{!t()&&r()?c().then(V=>{Q(h,V.data.status==="authorized"),Q(d,!0)}).catch(V=>{console.error("Error checking authorization:",V),Q(h,!1),Q(d,!0)}):!t()&&!r()?(Q(h,!1),Q(d,!0)):(Q(h,!1),Q(d,!1))}),so(),yn();var S=fb();let C;var P=ye(S);{var L=V=>{var q=ub();he(V,q)},O=V=>{var q=wa(),Y=lr(q);{var Z=_=>{var v=hb(),w=lr(v);RA(w,{$$events:{toggle:E}});var T=fe(w,2);kA(T,{get isOpen(){return F(m)},$$events:{close:E}});var A=fe(T,2),y=ye(A);{var se=qt=>{var Pt=wa(),In=lr(Pt);{var zr=Qn=>{Xa(Qn,{children:(zs,ko)=>{DA(zs,{})},$$slots:{default:!0}})};mt(In,Qn=>{F(h)&&Qn(zr)})}he(qt,Pt)},be=qt=>{Xa(qt,{children:(Pt,In)=>{var zr=lb();he(Pt,zr)},$$slots:{default:!0}})};mt(y,qt=>{F(d)?qt(se):qt(be,!1)})}var qr=fe(y,2);BA(qr,{}),he(_,v)},I=_=>{TA(_,{})};mt(Y,_=>{r()?_(Z):_(I,!1)},!0)}he(V,q)};mt(P,V=>{t()||!F(g)?V(L):V(O,!1)})}wr(()=>C=Uf(S,1,"svelte-1n46o8q",null,C,{"fullscreen-main":t()||!F(g)})),he(n,S),jt(),i()}Qg(db,{target:document.getElementById("app")});
