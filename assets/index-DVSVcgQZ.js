(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function e(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(s){if(s.ep)return;s.ep=!0;const o=e(s);fetch(s.href,o)}})();const Pl=!1;var Vl=Array.isArray,Lf=Array.prototype.indexOf,go=Array.from,Ff=Object.defineProperty,ur=Object.getOwnPropertyDescriptor,Dl=Object.getOwnPropertyDescriptors,Uf=Object.prototype,Bf=Array.prototype,_o=Object.getPrototypeOf,ou=Object.isExtensible;function jf(n){return n()}function qi(n){for(var t=0;t<n.length;t++)n[t]()}function Nl(){var n,t,e=new Promise((r,s)=>{n=r,t=s});return{promise:e,resolve:n,reject:t}}const Ct=2,yo=4,Ms=8,pe=16,me=32,rn=64,Ls=128,Gt=512,St=1024,Mt=2048,ge=4096,Bt=8192,We=16384,vo=32768,In=65536,au=1<<17,kl=1<<18,kn=1<<19,xl=1<<20,vr=32768,$i=1<<21,Eo=1<<22,Se=1<<23,lr=Symbol("$state"),qf=Symbol(""),yn=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function $f(n){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function zf(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function Hf(n){throw new Error("https://svelte.dev/e/effect_in_teardown")}function Gf(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Kf(n){throw new Error("https://svelte.dev/e/effect_orphan")}function Wf(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Qf(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Xf(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Yf(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function Jf(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const Zf=1,td=2,ed=16,nd=1,rd=2,It=Symbol(),sd="http://www.w3.org/1999/xhtml";function id(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}let od=!1;function Ol(n){return n===this.v}function ad(n,t){return n!=n?t==t:n!==t||n!==null&&typeof n=="object"||typeof n=="function"}function Ml(n){return!ad(n,this.v)}let kr=!1,ud=!1;function ld(){kr=!0}let ut=null;function An(n){ut=n}function To(n,t=!1,e){ut={p:ut,i:!1,c:null,e:null,s:n,x:null,l:kr&&!t?{s:null,u:null,$:[]}:null}}function wo(n){var t=ut,e=t.e;if(e!==null){t.e=null;for(var r of e)Zl(r)}return t.i=!0,ut=t.p,{}}function xr(){return!kr||ut!==null&&ut.l===null}let He=[];function Ll(){var n=He;He=[],qi(n)}function Fs(n){if(He.length===0&&!cr){var t=He;queueMicrotask(()=>{t===He&&Ll()})}He.push(n)}function cd(){for(;He.length>0;)Ll()}function Fl(n){var t=W;if(t===null)return K.f|=Se,n;if((t.f&vo)===0){if((t.f&Ls)===0)throw n;t.b.error(n)}else Rn(n,t)}function Rn(n,t){for(;t!==null;){if((t.f&Ls)!==0)try{t.b.error(n);return}catch(e){n=e}t=t.parent}throw n}const rs=new Set;let Z=null,ls=null,Ut=null,Yt=[],Us=null,zi=!1,cr=!1;class Jt{committed=!1;current=new Map;previous=new Map;#t=new Set;#e=new Set;#n=0;#r=0;#u=null;#o=[];#a=[];skipped_effects=new Set;is_fork=!1;process(t){Yt=[],ls=null,this.apply();var e={parent:null,effect:null,effects:[],render_effects:[],block_effects:[]};for(const r of t)this.#s(r,e);this.is_fork||this.#l(),this.#r>0||this.is_fork?(this.#i(e.effects),this.#i(e.render_effects),this.#i(e.block_effects)):(ls=this,Z=null,uu(e.render_effects),uu(e.effects),ls=null,this.#u?.resolve()),Ut=null}#s(t,e){t.f^=St;for(var r=t.first;r!==null;){var s=r.f,o=(s&(me|rn))!==0,a=o&&(s&St)!==0,l=a||(s&Bt)!==0||this.skipped_effects.has(r);if((r.f&Ls)!==0&&r.b?.is_pending()&&(e={parent:e,effect:r,effects:[],render_effects:[],block_effects:[]}),!l&&r.fn!==null){o?r.f^=St:(s&yo)!==0?e.effects.push(r):Mr(r)&&((r.f&pe)!==0&&e.block_effects.push(r),Ar(r));var h=r.first;if(h!==null){r=h;continue}}var f=r.parent;for(r=r.next;r===null&&f!==null;)f===e.effect&&(this.#i(e.effects),this.#i(e.render_effects),this.#i(e.block_effects),e=e.parent),r=f.next,f=f.parent}}#i(t){for(const e of t)((e.f&Mt)!==0?this.#o:this.#a).push(e),bt(e,St)}capture(t,e){this.previous.has(t)||this.previous.set(t,e),(t.f&Se)===0&&(this.current.set(t,t.v),Ut?.set(t,t.v))}activate(){Z=this,this.apply()}deactivate(){Z=null,Ut=null}flush(){if(this.activate(),Yt.length>0){if(Ul(),Z!==null&&Z!==this)return}else this.#n===0&&this.process([]);this.deactivate()}discard(){for(const t of this.#e)t(this);this.#e.clear()}#l(){if(this.#r===0){for(const t of this.#t)t();this.#t.clear()}this.#n===0&&this.#c()}#c(){if(rs.size>1){this.previous.clear();var t=Ut,e=!0,r={parent:null,effect:null,effects:[],render_effects:[],block_effects:[]};for(const s of rs){if(s===this){e=!1;continue}const o=[];for(const[l,h]of this.current){if(s.current.has(l))if(e&&h!==s.current.get(l))s.current.set(l,h);else continue;o.push(l)}if(o.length===0)continue;const a=[...s.current.keys()].filter(l=>!this.current.has(l));if(a.length>0){const l=new Set,h=new Map;for(const f of o)Bl(f,a,l,h);if(Yt.length>0){Z=s,s.apply();for(const f of Yt)s.#s(f,r);Yt=[],s.deactivate()}}}Z=null,Ut=t}this.committed=!0,rs.delete(this)}increment(t){this.#n+=1,t&&(this.#r+=1)}decrement(t){this.#n-=1,t&&(this.#r-=1),this.revive()}revive(){for(const t of this.#o)bt(t,Mt),Ze(t);for(const t of this.#a)bt(t,ge),Ze(t);this.#o=[],this.#a=[],this.flush()}oncommit(t){this.#t.add(t)}ondiscard(t){this.#e.add(t)}settled(){return(this.#u??=Nl()).promise}static ensure(){if(Z===null){const t=Z=new Jt;rs.add(Z),cr||Jt.enqueue(()=>{Z===t&&t.flush()})}return Z}static enqueue(t){Fs(t)}apply(){}}function hd(n){var t=cr;cr=!0;try{for(var e;;){if(cd(),Yt.length===0&&(Z?.flush(),Yt.length===0))return Us=null,e;Ul()}}finally{cr=t}}function Ul(){var n=Qe;zi=!0;try{var t=0;for(hu(!0);Yt.length>0;){var e=Jt.ensure();if(t++>1e3){var r,s;fd()}e.process(Yt),be.clear()}}finally{zi=!1,hu(n),Us=null}}function fd(){try{Wf()}catch(n){Rn(n,Us)}}let ue=null;function uu(n){var t=n.length;if(t!==0){for(var e=0;e<t;){var r=n[e++];if((r.f&(We|Bt))===0&&Mr(r)&&(ue=new Set,Ar(r),r.deps===null&&r.first===null&&r.nodes_start===null&&(r.teardown===null&&r.ac===null?rc(r):r.fn=null),ue?.size>0)){be.clear();for(const s of ue){if((s.f&(We|Bt))!==0)continue;const o=[s];let a=s.parent;for(;a!==null;)ue.has(a)&&(ue.delete(a),o.push(a)),a=a.parent;for(let l=o.length-1;l>=0;l--){const h=o[l];(h.f&(We|Bt))===0&&Ar(h)}}ue.clear()}}ue=null}}function Bl(n,t,e,r){if(!e.has(n)&&(e.add(n),n.reactions!==null))for(const s of n.reactions){const o=s.f;(o&Ct)!==0?Bl(s,t,e,r):(o&(Eo|pe))!==0&&(o&Mt)===0&&jl(s,t,r)&&(bt(s,Mt),Ze(s))}}function jl(n,t,e){const r=e.get(n);if(r!==void 0)return r;if(n.deps!==null)for(const s of n.deps){if(t.includes(s))return!0;if((s.f&Ct)!==0&&jl(s,t,e))return e.set(s,!0),!0}return e.set(n,!1),!1}function Ze(n){for(var t=Us=n;t.parent!==null;){t=t.parent;var e=t.f;if(zi&&t===W&&(e&pe)!==0&&(e&kl)===0)return;if((e&(rn|me))!==0){if((e&St)===0)return;t.f^=St}}Yt.push(t)}function dd(n){let t=0,e=tn(0),r;return()=>{js()&&(st(e),tc(()=>(t===0&&(r=qs(()=>n(()=>fr(e)))),t+=1,()=>{Fs(()=>{t-=1,t===0&&(r?.(),r=void 0,fr(e))})})))}}var pd=In|kn|Ls;function md(n,t,e){new gd(n,t,e)}class gd{parent;#t=!1;#e;#n=null;#r;#u;#o;#a=null;#s=null;#i=null;#l=null;#c=null;#d=0;#h=0;#p=!1;#f=null;#v=dd(()=>(this.#f=tn(this.#d),()=>{this.#f=null}));constructor(t,e,r){this.#e=t,this.#r=e,this.#u=r,this.parent=W.b,this.#t=!!this.#r.pending,this.#o=Ro(()=>{W.b=this;{var s=this.#_();try{this.#a=zt(()=>r(s))}catch(o){this.error(o)}this.#h>0?this.#g():this.#t=!1}return()=>{this.#c?.remove()}},pd)}#E(){try{this.#a=zt(()=>this.#u(this.#e))}catch(t){this.error(t)}this.#t=!1}#T(){const t=this.#r.pending;t&&(this.#s=zt(()=>t(this.#e)),Jt.enqueue(()=>{var e=this.#_();this.#a=this.#m(()=>(Jt.ensure(),zt(()=>this.#u(e)))),this.#h>0?this.#g():(vn(this.#s,()=>{this.#s=null}),this.#t=!1)}))}#_(){var t=this.#e;return this.#t&&(this.#c=Tr(),this.#e.before(this.#c),t=this.#c),t}is_pending(){return this.#t||!!this.parent&&this.parent.is_pending()}has_pending_snippet(){return!!this.#r.pending}#m(t){var e=W,r=K,s=ut;se(this.#o),Ot(this.#o),An(this.#o.ctx);try{return t()}catch(o){return Fl(o),null}finally{se(e),Ot(r),An(s)}}#g(){const t=this.#r.pending;this.#a!==null&&(this.#l=document.createDocumentFragment(),this.#l.append(this.#c),oc(this.#a,this.#l)),this.#s===null&&(this.#s=zt(()=>t(this.#e)))}#y(t){if(!this.has_pending_snippet()){this.parent&&this.parent.#y(t);return}this.#h+=t,this.#h===0&&(this.#t=!1,this.#s&&vn(this.#s,()=>{this.#s=null}),this.#l&&(this.#e.before(this.#l),this.#l=null))}update_pending_count(t){this.#y(t),this.#d+=t,this.#f&&Er(this.#f,this.#d)}get_effect_pending(){return this.#v(),st(this.#f)}error(t){var e=this.#r.onerror;let r=this.#r.failed;if(this.#p||!e&&!r)throw t;this.#a&&(Nt(this.#a),this.#a=null),this.#s&&(Nt(this.#s),this.#s=null),this.#i&&(Nt(this.#i),this.#i=null);var s=!1,o=!1;const a=()=>{if(s){id();return}s=!0,o&&Jf(),Jt.ensure(),this.#d=0,this.#i!==null&&vn(this.#i,()=>{this.#i=null}),this.#t=this.has_pending_snippet(),this.#a=this.#m(()=>(this.#p=!1,zt(()=>this.#u(this.#e)))),this.#h>0?this.#g():this.#t=!1};var l=K;try{Ot(null),o=!0,e?.(t,a),o=!1}catch(h){Rn(h,this.#o&&this.#o.parent)}finally{Ot(l)}r&&Fs(()=>{this.#i=this.#m(()=>{Jt.ensure(),this.#p=!0;try{return zt(()=>{r(this.#e,()=>t,()=>a)})}catch(h){return Rn(h,this.#o.parent),null}finally{this.#p=!1}})})}}function _d(n,t,e,r){const s=xr()?Io:ql;if(e.length===0&&n.length===0){r(t.map(s));return}var o=Z,a=W,l=yd();function h(){Promise.all(e.map(f=>vd(f))).then(f=>{l();try{r([...t.map(s),...f])}catch(p){(a.f&We)===0&&Rn(p,a)}o?.deactivate(),gs()}).catch(f=>{Rn(f,a)})}n.length>0?Promise.all(n).then(()=>{l();try{return h()}finally{o?.deactivate(),gs()}}):h()}function yd(){var n=W,t=K,e=ut,r=Z;return function(o=!0){se(n),Ot(t),An(e),o&&r?.activate()}}function gs(){se(null),Ot(null),An(null)}function Io(n){var t=Ct|Mt,e=K!==null&&(K.f&Ct)!==0?K:null;return W!==null&&(W.f|=kn),{ctx:ut,deps:null,effects:null,equals:Ol,f:t,fn:n,reactions:null,rv:0,v:It,wv:0,parent:e??W,ac:null}}function vd(n,t){let e=W;e===null&&zf();var r=e.b,s=void 0,o=tn(It),a=!K,l=new Map;return Vd(()=>{var h=Nl();s=h.promise;try{Promise.resolve(n()).then(h.resolve,h.reject).then(()=>{f===Z&&f.committed&&f.deactivate(),gs()})}catch(v){h.reject(v),gs()}var f=Z;if(a){var p=!r.is_pending();r.update_pending_count(1),f.increment(p),l.get(f)?.reject(yn),l.delete(f),l.set(f,h)}const y=(v,R=void 0)=>{if(f.activate(),R)R!==yn&&(o.f|=Se,Er(o,R));else{(o.f&Se)!==0&&(o.f^=Se),Er(o,v);for(const[C,D]of l){if(l.delete(C),C===f)break;D.reject(yn)}}a&&(r.update_pending_count(-1),f.decrement(p))};h.promise.then(y,v=>y(null,v||"unknown"))}),Jl(()=>{for(const h of l.values())h.reject(yn)}),new Promise(h=>{function f(p){function y(){p===s?h(o):f(s)}p.then(y,y)}f(s)})}function ql(n){const t=Io(n);return t.equals=Ml,t}function $l(n){var t=n.effects;if(t!==null){n.effects=null;for(var e=0;e<t.length;e+=1)Nt(t[e])}}function Ed(n){for(var t=n.parent;t!==null;){if((t.f&Ct)===0)return t;t=t.parent}return null}function Ao(n){var t,e=W;se(Ed(n));try{n.f&=~vr,$l(n),t=cc(n)}finally{se(e)}return t}function zl(n){var t=Ao(n);if(n.equals(t)||(n.v=t,n.wv=uc()),!xn)if(Ut!==null)js()&&Ut.set(n,n.v);else{var e=(n.f&Gt)===0?ge:St;bt(n,e)}}let Hi=new Set;const be=new Map;let Hl=!1;function tn(n,t){var e={f:0,v:n,reactions:null,equals:Ol,rv:0,wv:0};return e}function Ae(n,t){const e=tn(n);return kd(e),e}function hr(n,t=!1,e=!0){const r=tn(n);return t||(r.equals=Ml),kr&&e&&ut!==null&&ut.l!==null&&(ut.l.s??=[]).push(r),r}function xt(n,t,e=!1){K!==null&&(!Zt||(K.f&au)!==0)&&xr()&&(K.f&(Ct|pe|Eo|au))!==0&&!le?.includes(n)&&Yf();let r=e?nr(t):t;return Er(n,r)}function Er(n,t){if(!n.equals(t)){var e=n.v;xn?be.set(n,t):be.set(n,e),n.v=t;var r=Jt.ensure();r.capture(n,e),(n.f&Ct)!==0&&((n.f&Mt)!==0&&Ao(n),bt(n,(n.f&Gt)!==0?St:ge)),n.wv=uc(),Gl(n,Mt),xr()&&W!==null&&(W.f&St)!==0&&(W.f&(me|rn))===0&&(jt===null?xd([n]):jt.push(n)),!r.is_fork&&Hi.size>0&&!Hl&&Td()}return t}function Td(){Hl=!1;const n=Array.from(Hi);for(const t of n)(t.f&St)!==0&&bt(t,ge),Mr(t)&&Ar(t);Hi.clear()}function fr(n){xt(n,n.v+1)}function Gl(n,t){var e=n.reactions;if(e!==null)for(var r=xr(),s=e.length,o=0;o<s;o++){var a=e[o],l=a.f;if(!(!r&&a===W)){var h=(l&Mt)===0;if(h&&bt(a,t),(l&Ct)!==0){var f=a;Ut?.delete(f),(l&vr)===0&&(l&Gt&&(a.f|=vr),Gl(f,ge))}else h&&((l&pe)!==0&&ue!==null&&ue.add(a),Ze(a))}}}function nr(n){if(typeof n!="object"||n===null||lr in n)return n;const t=_o(n);if(t!==Uf&&t!==Bf)return n;var e=new Map,r=Vl(n),s=Ae(0),o=Xe,a=l=>{if(Xe===o)return l();var h=K,f=Xe;Ot(null),du(o);var p=l();return Ot(h),du(f),p};return r&&e.set("length",Ae(n.length)),new Proxy(n,{defineProperty(l,h,f){(!("value"in f)||f.configurable===!1||f.enumerable===!1||f.writable===!1)&&Qf();var p=e.get(h);return p===void 0?p=a(()=>{var y=Ae(f.value);return e.set(h,y),y}):xt(p,f.value,!0),!0},deleteProperty(l,h){var f=e.get(h);if(f===void 0){if(h in l){const p=a(()=>Ae(It));e.set(h,p),fr(s)}}else xt(f,It),fr(s);return!0},get(l,h,f){if(h===lr)return n;var p=e.get(h),y=h in l;if(p===void 0&&(!y||ur(l,h)?.writable)&&(p=a(()=>{var R=nr(y?l[h]:It),C=Ae(R);return C}),e.set(h,p)),p!==void 0){var v=st(p);return v===It?void 0:v}return Reflect.get(l,h,f)},getOwnPropertyDescriptor(l,h){var f=Reflect.getOwnPropertyDescriptor(l,h);if(f&&"value"in f){var p=e.get(h);p&&(f.value=st(p))}else if(f===void 0){var y=e.get(h),v=y?.v;if(y!==void 0&&v!==It)return{enumerable:!0,configurable:!0,value:v,writable:!0}}return f},has(l,h){if(h===lr)return!0;var f=e.get(h),p=f!==void 0&&f.v!==It||Reflect.has(l,h);if(f!==void 0||W!==null&&(!p||ur(l,h)?.writable)){f===void 0&&(f=a(()=>{var v=p?nr(l[h]):It,R=Ae(v);return R}),e.set(h,f));var y=st(f);if(y===It)return!1}return p},set(l,h,f,p){var y=e.get(h),v=h in l;if(r&&h==="length")for(var R=f;R<y.v;R+=1){var C=e.get(R+"");C!==void 0?xt(C,It):R in l&&(C=a(()=>Ae(It)),e.set(R+"",C))}if(y===void 0)(!v||ur(l,h)?.writable)&&(y=a(()=>Ae(void 0)),xt(y,nr(f)),e.set(h,y));else{v=y.v!==It;var D=a(()=>nr(f));xt(y,D)}var V=Reflect.getOwnPropertyDescriptor(l,h);if(V?.set&&V.set.call(p,f),!v){if(r&&typeof h=="string"){var M=e.get("length"),F=Number(h);Number.isInteger(F)&&F>=M.v&&xt(M,F+1)}fr(s)}return!0},ownKeys(l){st(s);var h=Reflect.ownKeys(l).filter(y=>{var v=e.get(y);return v===void 0||v.v!==It});for(var[f,p]of e)p.v!==It&&!(f in l)&&h.push(f);return h},setPrototypeOf(){Xf()}})}var lu,Kl,Wl,Ql;function wd(){if(lu===void 0){lu=window,Kl=/Firefox/.test(navigator.userAgent);var n=Element.prototype,t=Node.prototype,e=Text.prototype;Wl=ur(t,"firstChild").get,Ql=ur(t,"nextSibling").get,ou(n)&&(n.__click=void 0,n.__className=void 0,n.__attributes=null,n.__style=void 0,n.__e=void 0),ou(e)&&(e.__t=void 0)}}function Tr(n=""){return document.createTextNode(n)}function _s(n){return Wl.call(n)}function Or(n){return Ql.call(n)}function wr(n,t){return _s(n)}function Id(n,t=!1){{var e=_s(n);return e instanceof Comment&&e.data===""?Or(e):e}}function Ce(n,t=1,e=!1){let r=n;for(;t--;)r=Or(r);return r}function Ad(n){n.textContent=""}function Xl(){return!1}let cu=!1;function Rd(){cu||(cu=!0,document.addEventListener("reset",n=>{Promise.resolve().then(()=>{if(!n.defaultPrevented)for(const t of n.target.elements)t.__on_r?.()})},{capture:!0}))}function Bs(n){var t=K,e=W;Ot(null),se(null);try{return n()}finally{Ot(t),se(e)}}function Sd(n,t,e,r=e){n.addEventListener(t,()=>Bs(e));const s=n.__on_r;s?n.__on_r=()=>{s(),r(!0)}:n.__on_r=()=>r(!0),Rd()}function Yl(n){W===null&&(K===null&&Kf(),Gf()),xn&&Hf()}function bd(n,t){var e=t.last;e===null?t.last=t.first=n:(e.next=n,n.prev=e,t.last=n)}function _e(n,t,e,r=!0){var s=W;s!==null&&(s.f&Bt)!==0&&(n|=Bt);var o={ctx:ut,deps:null,nodes_start:null,nodes_end:null,f:n|Mt|Gt,first:null,fn:t,last:null,next:null,parent:s,b:s&&s.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(e)try{Ar(o),o.f|=vo}catch(h){throw Nt(o),h}else t!==null&&Ze(o);if(r){var a=o;if(e&&a.deps===null&&a.teardown===null&&a.nodes_start===null&&a.first===a.last&&(a.f&kn)===0&&(a=a.first,(n&pe)!==0&&(n&In)!==0&&a!==null&&(a.f|=In)),a!==null&&(a.parent=s,s!==null&&bd(a,s),K!==null&&(K.f&Ct)!==0&&(n&rn)===0)){var l=K;(l.effects??=[]).push(a)}}return o}function js(){return K!==null&&!Zt}function Jl(n){const t=_e(Ms,null,!1);return bt(t,St),t.teardown=n,t}function Gi(n){Yl();var t=W.f,e=!K&&(t&me)!==0&&(t&vo)===0;if(e){var r=ut;(r.e??=[]).push(n)}else return Zl(n)}function Zl(n){return _e(yo|xl,n,!1)}function Cd(n){return Yl(),_e(Ms|xl,n,!0)}function Pd(n){Jt.ensure();const t=_e(rn|kn,n,!0);return(e={})=>new Promise(r=>{e.outro?vn(t,()=>{Nt(t),r(void 0)}):(Nt(t),r(void 0))})}function Vd(n){return _e(Eo|kn,n,!0)}function tc(n,t=0){return _e(Ms|t,n,!0)}function bi(n,t=[],e=[],r=[],s=!1){_d(r,t,e,o=>{_e(s?yo:Ms,()=>n(...o.map(st)),!0)})}function Ro(n,t=0){var e=_e(pe|t,n,!0);return e}function zt(n,t=!0){return _e(me|kn,n,!0,t)}function ec(n){var t=n.teardown;if(t!==null){const e=xn,r=K;fu(!0),Ot(null);try{t.call(null)}finally{fu(e),Ot(r)}}}function nc(n,t=!1){var e=n.first;for(n.first=n.last=null;e!==null;){const s=e.ac;s!==null&&Bs(()=>{s.abort(yn)});var r=e.next;(e.f&rn)!==0?e.parent=null:Nt(e,t),e=r}}function Dd(n){for(var t=n.first;t!==null;){var e=t.next;(t.f&me)===0&&Nt(t),t=e}}function Nt(n,t=!0){var e=!1;(t||(n.f&kl)!==0)&&n.nodes_start!==null&&n.nodes_end!==null&&(Nd(n.nodes_start,n.nodes_end),e=!0),nc(n,t&&!e),ys(n,0),bt(n,We);var r=n.transitions;if(r!==null)for(const o of r)o.stop();ec(n);var s=n.parent;s!==null&&s.first!==null&&rc(n),n.next=n.prev=n.teardown=n.ctx=n.deps=n.fn=n.nodes_start=n.nodes_end=n.ac=null}function Nd(n,t){for(;n!==null;){var e=n===t?null:Or(n);n.remove(),n=e}}function rc(n){var t=n.parent,e=n.prev,r=n.next;e!==null&&(e.next=r),r!==null&&(r.prev=e),t!==null&&(t.first===n&&(t.first=r),t.last===n&&(t.last=e))}function vn(n,t,e=!0){var r=[];So(n,r,!0),sc(r,()=>{e&&Nt(n),t&&t()})}function sc(n,t){var e=n.length;if(e>0){var r=()=>--e||t();for(var s of n)s.out(r)}else t()}function So(n,t,e){if((n.f&Bt)===0){if(n.f^=Bt,n.transitions!==null)for(const a of n.transitions)(a.is_global||e)&&t.push(a);for(var r=n.first;r!==null;){var s=r.next,o=(r.f&In)!==0||(r.f&me)!==0&&(n.f&pe)!==0;So(r,t,o?e:!1),r=s}}}function bo(n){ic(n,!0)}function ic(n,t){if((n.f&Bt)!==0){n.f^=Bt,(n.f&St)===0&&(bt(n,Mt),Ze(n));for(var e=n.first;e!==null;){var r=e.next,s=(e.f&In)!==0||(e.f&me)!==0;ic(e,s?t:!1),e=r}if(n.transitions!==null)for(const o of n.transitions)(o.is_global||t)&&o.in()}}function oc(n,t){for(var e=n.nodes_start,r=n.nodes_end;e!==null;){var s=e===r?null:Or(e);t.append(e),e=s}}let Qe=!1;function hu(n){Qe=n}let xn=!1;function fu(n){xn=n}let K=null,Zt=!1;function Ot(n){K=n}let W=null;function se(n){W=n}let le=null;function kd(n){K!==null&&(le===null?le=[n]:le.push(n))}let Dt=null,Ft=0,jt=null;function xd(n){jt=n}let ac=1,Ir=0,Xe=Ir;function du(n){Xe=n}function uc(){return++ac}function Mr(n){var t=n.f;if((t&Mt)!==0)return!0;if(t&Ct&&(n.f&=~vr),(t&ge)!==0){var e=n.deps;if(e!==null)for(var r=e.length,s=0;s<r;s++){var o=e[s];if(Mr(o)&&zl(o),o.wv>n.wv)return!0}(t&Gt)!==0&&Ut===null&&bt(n,St)}return!1}function lc(n,t,e=!0){var r=n.reactions;if(r!==null&&!le?.includes(n))for(var s=0;s<r.length;s++){var o=r[s];(o.f&Ct)!==0?lc(o,t,!1):t===o&&(e?bt(o,Mt):(o.f&St)!==0&&bt(o,ge),Ze(o))}}function cc(n){var t=Dt,e=Ft,r=jt,s=K,o=le,a=ut,l=Zt,h=Xe,f=n.f;Dt=null,Ft=0,jt=null,K=(f&(me|rn))===0?n:null,le=null,An(n.ctx),Zt=!1,Xe=++Ir,n.ac!==null&&(Bs(()=>{n.ac.abort(yn)}),n.ac=null);try{n.f|=$i;var p=n.fn,y=p(),v=n.deps;if(Dt!==null){var R;if(ys(n,Ft),v!==null&&Ft>0)for(v.length=Ft+Dt.length,R=0;R<Dt.length;R++)v[Ft+R]=Dt[R];else n.deps=v=Dt;if(Qe&&js()&&(n.f&Gt)!==0)for(R=Ft;R<v.length;R++)(v[R].reactions??=[]).push(n)}else v!==null&&Ft<v.length&&(ys(n,Ft),v.length=Ft);if(xr()&&jt!==null&&!Zt&&v!==null&&(n.f&(Ct|ge|Mt))===0)for(R=0;R<jt.length;R++)lc(jt[R],n);return s!==null&&s!==n&&(Ir++,jt!==null&&(r===null?r=jt:r.push(...jt))),(n.f&Se)!==0&&(n.f^=Se),y}catch(C){return Fl(C)}finally{n.f^=$i,Dt=t,Ft=e,jt=r,K=s,le=o,An(a),Zt=l,Xe=h}}function Od(n,t){let e=t.reactions;if(e!==null){var r=Lf.call(e,n);if(r!==-1){var s=e.length-1;s===0?e=t.reactions=null:(e[r]=e[s],e.pop())}}e===null&&(t.f&Ct)!==0&&(Dt===null||!Dt.includes(t))&&(bt(t,ge),(t.f&Gt)!==0&&(t.f^=Gt,t.f&=~vr),$l(t),ys(t,0))}function ys(n,t){var e=n.deps;if(e!==null)for(var r=t;r<e.length;r++)Od(n,e[r])}function Ar(n){var t=n.f;if((t&We)===0){bt(n,St);var e=W,r=Qe;W=n,Qe=!0;try{(t&pe)!==0?Dd(n):nc(n),ec(n);var s=cc(n);n.teardown=typeof s=="function"?s:null,n.wv=ac;var o;Pl&&ud&&(n.f&Mt)!==0&&n.deps}finally{Qe=r,W=e}}}async function Md(){await Promise.resolve(),hd()}function st(n){var t=n.f,e=(t&Ct)!==0;if(K!==null&&!Zt){var r=W!==null&&(W.f&We)!==0;if(!r&&!le?.includes(n)){var s=K.deps;if((K.f&$i)!==0)n.rv<Ir&&(n.rv=Ir,Dt===null&&s!==null&&s[Ft]===n?Ft++:Dt===null?Dt=[n]:Dt.includes(n)||Dt.push(n));else{(K.deps??=[]).push(n);var o=n.reactions;o===null?n.reactions=[K]:o.includes(K)||o.push(K)}}}if(xn){if(be.has(n))return be.get(n);if(e){var a=n,l=a.v;return((a.f&St)===0&&a.reactions!==null||fc(a))&&(l=Ao(a)),be.set(a,l),l}}else if(e){if(a=n,Ut?.has(a))return Ut.get(a);Mr(a)&&zl(a),Qe&&js()&&(a.f&Gt)===0&&hc(a)}else if(Ut?.has(n))return Ut.get(n);if((n.f&Se)!==0)throw n.v;return n.v}function hc(n){if(n.deps!==null){n.f^=Gt;for(const t of n.deps)(t.reactions??=[]).push(n),(t.f&Ct)!==0&&(t.f&Gt)===0&&hc(t)}}function fc(n){if(n.v===It)return!0;if(n.deps===null)return!1;for(const t of n.deps)if(be.has(t)||(t.f&Ct)!==0&&fc(t))return!0;return!1}function qs(n){var t=Zt;try{return Zt=!0,n()}finally{Zt=t}}const Ld=-7169;function bt(n,t){n.f=n.f&Ld|t}function Fd(n){if(!(typeof n!="object"||!n||n instanceof EventTarget)){if(lr in n)Ki(n);else if(!Array.isArray(n))for(let t in n){const e=n[t];typeof e=="object"&&e&&lr in e&&Ki(e)}}}function Ki(n,t=new Set){if(typeof n=="object"&&n!==null&&!(n instanceof EventTarget)&&!t.has(n)){t.add(n),n instanceof Date&&n.getTime();for(let r in n)try{Ki(n[r],t)}catch{}const e=_o(n);if(e!==Object.prototype&&e!==Array.prototype&&e!==Map.prototype&&e!==Set.prototype&&e!==Date.prototype){const r=Dl(e);for(let s in r){const o=r[s].get;if(o)try{o.call(n)}catch{}}}}}const Ud=["touchstart","touchmove"];function Bd(n){return Ud.includes(n)}const jd=new Set,pu=new Set;function qd(n,t,e,r={}){function s(o){if(r.capture||rr.call(t,o),!o.cancelBubble)return Bs(()=>e?.call(this,o))}return n.startsWith("pointer")||n.startsWith("touch")||n==="wheel"?Fs(()=>{t.addEventListener(n,s,r)}):t.addEventListener(n,s,r),s}function $d(n,t,e,r,s){var o={capture:r,passive:s},a=qd(n,t,e,o);(t===document.body||t===window||t===document||t instanceof HTMLMediaElement)&&Jl(()=>{t.removeEventListener(n,a,o)})}let mu=null;function rr(n){var t=this,e=t.ownerDocument,r=n.type,s=n.composedPath?.()||[],o=s[0]||n.target;mu=n;var a=0,l=mu===n&&n.__root;if(l){var h=s.indexOf(l);if(h!==-1&&(t===document||t===window)){n.__root=t;return}var f=s.indexOf(t);if(f===-1)return;h<=f&&(a=h)}if(o=s[a]||n.target,o!==t){Ff(n,"currentTarget",{configurable:!0,get(){return o||e}});var p=K,y=W;Ot(null),se(null);try{for(var v,R=[];o!==null;){var C=o.assignedSlot||o.parentNode||o.host||null;try{var D=o["__"+r];D!=null&&(!o.disabled||n.target===o)&&D.call(o,n)}catch(V){v?R.push(V):v=V}if(n.cancelBubble||C===t||C===null)break;o=C}if(v){for(let V of R)queueMicrotask(()=>{throw V});throw v}}finally{n.__root=t,delete n.currentTarget,Ot(p),se(y)}}}function zd(n){var t=document.createElement("template");return t.innerHTML=n.replaceAll("<!>","<!---->"),t.content}function gu(n,t){var e=W;e.nodes_start===null&&(e.nodes_start=n,e.nodes_end=t)}function sn(n,t){var e=(t&nd)!==0,r=(t&rd)!==0,s,o=!n.startsWith("<!>");return()=>{s===void 0&&(s=zd(o?n:"<!>"+n),e||(s=_s(s)));var a=r||Kl?document.importNode(s,!0):s.cloneNode(!0);if(e){var l=_s(a),h=a.lastChild;gu(l,h)}else gu(a,a);return a}}function Ge(n,t){n!==null&&n.before(t)}function Hd(n,t){var e=t==null?"":typeof t=="object"?t+"":t;e!==(n.__t??=n.nodeValue)&&(n.__t=e,n.nodeValue=e+"")}function Gd(n,t){return Kd(n,t)}const dn=new Map;function Kd(n,{target:t,anchor:e,props:r={},events:s,context:o,intro:a=!0}){wd();var l=new Set,h=y=>{for(var v=0;v<y.length;v++){var R=y[v];if(!l.has(R)){l.add(R);var C=Bd(R);t.addEventListener(R,rr,{passive:C});var D=dn.get(R);D===void 0?(document.addEventListener(R,rr,{passive:C}),dn.set(R,1)):dn.set(R,D+1)}}};h(go(jd)),pu.add(h);var f=void 0,p=Pd(()=>{var y=e??t.appendChild(Tr());return md(y,{pending:()=>{}},v=>{if(o){To({});var R=ut;R.c=o}s&&(r.$$events=s),f=n(v,r)||{},o&&wo()}),()=>{for(var v of l){t.removeEventListener(v,rr);var R=dn.get(v);--R===0?(document.removeEventListener(v,rr),dn.delete(v)):dn.set(v,R)}pu.delete(h),y!==e&&y.parentNode?.removeChild(y)}});return Wd.set(f,p),f}let Wd=new WeakMap;class Qd{anchor;#t=new Map;#e=new Map;#n=new Map;#r=!0;constructor(t,e=!0){this.anchor=t,this.#r=e}#u=()=>{var t=Z;if(this.#t.has(t)){var e=this.#t.get(t),r=this.#e.get(e);if(r)bo(r);else{var s=this.#n.get(e);s&&(this.#e.set(e,s.effect),this.#n.delete(e),s.fragment.lastChild.remove(),this.anchor.before(s.fragment),r=s.effect)}for(const[o,a]of this.#t){if(this.#t.delete(o),o===t)break;const l=this.#n.get(a);l&&(Nt(l.effect),this.#n.delete(a))}for(const[o,a]of this.#e){if(o===e)continue;const l=()=>{if(Array.from(this.#t.values()).includes(o)){var f=document.createDocumentFragment();oc(a,f),f.append(Tr()),this.#n.set(o,{effect:a,fragment:f})}else Nt(a);this.#e.delete(o)};this.#r||!r?vn(a,l,!1):l()}}};#o=t=>{this.#t.delete(t);const e=Array.from(this.#t.values());for(const[r,s]of this.#n)e.includes(r)||(Nt(s.effect),this.#n.delete(r))};ensure(t,e){var r=Z,s=Xl();if(e&&!this.#e.has(t)&&!this.#n.has(t))if(s){var o=document.createDocumentFragment(),a=Tr();o.append(a),this.#n.set(t,{effect:zt(()=>e(a)),fragment:o})}else this.#e.set(t,zt(()=>e(this.anchor)));if(this.#t.set(r,t),s){for(const[l,h]of this.#e)l===t?r.skipped_effects.delete(h):r.skipped_effects.add(h);for(const[l,h]of this.#n)l===t?r.skipped_effects.delete(h.effect):r.skipped_effects.add(h.effect);r.oncommit(this.#u),r.ondiscard(this.#o)}else this.#u()}}function _u(n,t,e=!1){var r=new Qd(n),s=e?In:0;function o(a,l){r.ensure(a,l)}Ro(()=>{var a=!1;t((l,h=!0)=>{a=!0,o(h,l)}),a||o(!1,null)},s)}function Xd(n,t){return t}function Yd(n,t,e){for(var r=n.items,s=[],o=t.length,a=0;a<o;a++)So(t[a].e,s,!0);var l=o>0&&s.length===0&&e!==null;if(l){var h=e.parentNode;Ad(h),h.append(e),r.clear(),Qt(n,t[0].prev,t[o-1].next)}sc(s,()=>{for(var f=0;f<o;f++){var p=t[f];l||(r.delete(p.k),Qt(n,p.prev,p.next)),Nt(p.e,!l)}})}function Jd(n,t,e,r,s,o=null){var a=n,l={flags:t,items:new Map,first:null},h=null,f=!1,p=new Map,y=ql(()=>{var D=e();return Vl(D)?D:D==null?[]:go(D)}),v,R;function C(){Zd(R,v,l,p,a,s,t,r,e),o!==null&&(v.length===0?h?bo(h):h=zt(()=>o(a)):h!==null&&vn(h,()=>{h=null}))}Ro(()=>{R??=W,v=st(y);var D=v.length;if(!(f&&D===0)){f=D===0;var V,M,F,O;if(Xl()){var X=new Set,nt=Z;for(M=0;M<D;M+=1){F=v[M],O=r(F,M);var rt=l.items.get(O)??p.get(O);rt?dc(rt,F,M):(V=pc(null,l,null,null,F,O,M,s,t,e,!0),p.set(O,V)),X.add(O)}for(const[T,m]of l.items)X.has(T)||nt.skipped_effects.add(m.e);nt.oncommit(C)}else C();st(y)}})}function Zd(n,t,e,r,s,o,a,l,h){var f=t.length,p=e.items,y=e.first,v=y,R,C=null,D=[],V=[],M,F,O,X;for(X=0;X<f;X+=1){if(M=t[X],F=l(M,X),O=p.get(F),O===void 0){var nt=r.get(F);if(nt!==void 0){r.delete(F),p.set(F,nt);var rt=C?C.next:v;Qt(e,C,nt),Qt(e,nt,rt),Ci(nt,rt,s),C=nt}else{var T=v?v.e.nodes_start:s;C=pc(T,e,C,C===null?e.first:C.next,M,F,X,o,a,h)}p.set(F,C),D=[],V=[],v=C.next;continue}if(dc(O,M,X),(O.e.f&Bt)!==0&&bo(O.e),O!==v){if(R!==void 0&&R.has(O)){if(D.length<V.length){var m=V[0],g;C=m.prev;var w=D[0],E=D[D.length-1];for(g=0;g<D.length;g+=1)Ci(D[g],m,s);for(g=0;g<V.length;g+=1)R.delete(V[g]);Qt(e,w.prev,E.next),Qt(e,C,w),Qt(e,E,m),v=m,C=E,X-=1,D=[],V=[]}else R.delete(O),Ci(O,v,s),Qt(e,O.prev,O.next),Qt(e,O,C===null?e.first:C.next),Qt(e,C,O),C=O;continue}for(D=[],V=[];v!==null&&v.k!==F;)(v.e.f&Bt)===0&&(R??=new Set).add(v),V.push(v),v=v.next;if(v===null)continue;O=v}D.push(O),C=O,v=O.next}if(v!==null||R!==void 0){for(var A=R===void 0?[]:go(R);v!==null;)(v.e.f&Bt)===0&&A.push(v),v=v.next;var _=A.length;if(_>0){var Et=null;Yd(e,A,Et)}}n.first=e.first&&e.first.e,n.last=C&&C.e;for(var ae of r.values())Nt(ae.e);r.clear()}function dc(n,t,e,r){Er(n.v,t),n.i=e}function pc(n,t,e,r,s,o,a,l,h,f,p){var y=(h&Zf)!==0,v=(h&ed)===0,R=y?v?hr(s,!1,!1):tn(s):s,C=(h&td)===0?a:tn(a),D={i:C,v:R,k:o,a:null,e:null,prev:e,next:r};try{if(n===null){var V=document.createDocumentFragment();V.append(n=Tr())}return D.e=zt(()=>l(n,R,C,f),od),D.e.prev=e&&e.e,D.e.next=r&&r.e,e===null?p||(t.first=D):(e.next=D,e.e.next=D.e),r!==null&&(r.prev=D,r.e.prev=D.e),D}finally{}}function Ci(n,t,e){for(var r=n.next?n.next.e.nodes_start:e,s=t?t.e.nodes_start:e,o=n.e.nodes_start;o!==null&&o!==r;){var a=Or(o);s.before(o),o=a}}function Qt(n,t,e){t===null?n.first=e:(t.next=e,t.e.next=e&&e.e),e!==null&&(e.prev=t,e.e.prev=t&&t.e)}function tp(n,t,e,r,s){var o=t.$$slots?.[e],a=!1;o===!0&&(o=t.children,a=!0),o===void 0||o(n,a?()=>r:r)}const ep=Symbol("is custom element"),np=Symbol("is html");function Pi(n,t,e,r){var s=rp(n);s[t]!==(s[t]=e)&&(t==="loading"&&(n[qf]=e),e==null?n.removeAttribute(t):typeof e!="string"&&sp(n).includes(t)?n[t]=e:n.setAttribute(t,e))}function rp(n){return n.__attributes??={[ep]:n.nodeName.includes("-"),[np]:n.namespaceURI===sd}}var yu=new Map;function sp(n){var t=n.getAttribute("is")||n.nodeName,e=yu.get(t);if(e)return e;yu.set(t,e=[]);for(var r,s=n,o=Element.prototype;o!==s;){r=Dl(s);for(var a in r)r[a].set&&e.push(a);s=_o(s)}return e}function Vi(n,t,e=t){var r=new WeakSet;Sd(n,"input",async s=>{var o=s?n.defaultValue:n.value;if(o=Di(n)?Ni(o):o,e(o),Z!==null&&r.add(Z),await Md(),o!==(o=t())){var a=n.selectionStart,l=n.selectionEnd,h=n.value.length;if(n.value=o??"",l!==null){var f=n.value.length;a===l&&l===h&&f>h?(n.selectionStart=f,n.selectionEnd=f):(n.selectionStart=a,n.selectionEnd=Math.min(l,f))}}}),qs(t)==null&&n.value&&(e(Di(n)?Ni(n.value):n.value),Z!==null&&r.add(Z)),tc(()=>{var s=t();if(n===document.activeElement){var o=ls??Z;if(r.has(o))return}Di(n)&&s===Ni(n.value)||n.type==="date"&&!s&&!n.value||s!==n.value&&(n.value=s??"")})}function Di(n){var t=n.type;return t==="number"||t==="range"}function Ni(n){return n===""?null:+n}function ip(n){return function(...t){var e=t[0];return e.preventDefault(),n?.apply(this,t)}}function mc(n=!1){const t=ut,e=t.l.u;if(!e)return;let r=()=>Fd(t.s);if(n){let s=0,o={};const a=Io(()=>{let l=!1;const h=t.s;for(const f in h)h[f]!==o[f]&&(o[f]=h[f],l=!0);return l&&s++,s});r=()=>st(a)}e.b.length&&Cd(()=>{vu(t,r),qi(e.b)}),Gi(()=>{const s=qs(()=>e.m.map(jf));return()=>{for(const o of s)typeof o=="function"&&o()}}),e.a.length&&Gi(()=>{vu(t,r),qi(e.a)})}function vu(n,t){if(n.l.s)for(const e of n.l.s)st(e);t()}function op(n){ut===null&&$f(),kr&&ut.l!==null?ap(ut).m.push(n):Gi(()=>{const t=qs(n);if(typeof t=="function")return t})}function ap(n){var t=n.l;return t.u??={a:[],b:[],m:[]}}const up="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(up);ld();const lp=()=>{};var Eu={};const gc=function(n){const t=[];let e=0;for(let r=0;r<n.length;r++){let s=n.charCodeAt(r);s<128?t[e++]=s:s<2048?(t[e++]=s>>6|192,t[e++]=s&63|128):(s&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++r)&1023),t[e++]=s>>18|240,t[e++]=s>>12&63|128,t[e++]=s>>6&63|128,t[e++]=s&63|128):(t[e++]=s>>12|224,t[e++]=s>>6&63|128,t[e++]=s&63|128)}return t},cp=function(n){const t=[];let e=0,r=0;for(;e<n.length;){const s=n[e++];if(s<128)t[r++]=String.fromCharCode(s);else if(s>191&&s<224){const o=n[e++];t[r++]=String.fromCharCode((s&31)<<6|o&63)}else if(s>239&&s<365){const o=n[e++],a=n[e++],l=n[e++],h=((s&7)<<18|(o&63)<<12|(a&63)<<6|l&63)-65536;t[r++]=String.fromCharCode(55296+(h>>10)),t[r++]=String.fromCharCode(56320+(h&1023))}else{const o=n[e++],a=n[e++];t[r++]=String.fromCharCode((s&15)<<12|(o&63)<<6|a&63)}}return t.join("")},_c={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,t){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const e=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<n.length;s+=3){const o=n[s],a=s+1<n.length,l=a?n[s+1]:0,h=s+2<n.length,f=h?n[s+2]:0,p=o>>2,y=(o&3)<<4|l>>4;let v=(l&15)<<2|f>>6,R=f&63;h||(R=64,a||(v=64)),r.push(e[p],e[y],e[v],e[R])}return r.join("")},encodeString(n,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(n):this.encodeByteArray(gc(n),t)},decodeString(n,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(n):cp(this.decodeStringToByteArray(n,t))},decodeStringToByteArray(n,t){this.init_();const e=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<n.length;){const o=e[n.charAt(s++)],l=s<n.length?e[n.charAt(s)]:0;++s;const f=s<n.length?e[n.charAt(s)]:64;++s;const y=s<n.length?e[n.charAt(s)]:64;if(++s,o==null||l==null||f==null||y==null)throw new hp;const v=o<<2|l>>4;if(r.push(v),f!==64){const R=l<<4&240|f>>2;if(r.push(R),y!==64){const C=f<<6&192|y;r.push(C)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class hp extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const fp=function(n){const t=gc(n);return _c.encodeByteArray(t,!0)},vs=function(n){return fp(n).replace(/\./g,"")},dp=function(n){try{return _c.decodeString(n,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function pp(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const mp=()=>pp().__FIREBASE_DEFAULTS__,gp=()=>{if(typeof process>"u"||typeof Eu>"u")return;const n=Eu.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},_p=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=n&&dp(n[1]);return t&&JSON.parse(t)},Co=()=>{try{return lp()||mp()||gp()||_p()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},yp=n=>Co()?.emulatorHosts?.[n],vp=n=>{const t=yp(n);if(!t)return;const e=t.lastIndexOf(":");if(e<=0||e+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const r=parseInt(t.substring(e+1),10);return t[0]==="["?[t.substring(1,e-1),r]:[t.substring(0,e),r]},yc=()=>Co()?.config;class Ep{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}wrapCallback(t){return(e,r)=>{e?this.reject(e):this.resolve(r),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(e):t(e,r))}}}function Po(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Tp(n){return(await fetch(n,{credentials:"include"})).ok}function wp(n,t){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const e={alg:"none",type:"JWT"},r=t||"demo-project",s=n.iat||0,o=n.sub||n.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a={iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}},...n};return[vs(JSON.stringify(e)),vs(JSON.stringify(a)),""].join(".")}const dr={};function Ip(){const n={prod:[],emulator:[]};for(const t of Object.keys(dr))dr[t]?n.emulator.push(t):n.prod.push(t);return n}function Ap(n){let t=document.getElementById(n),e=!1;return t||(t=document.createElement("div"),t.setAttribute("id",n),e=!0),{created:e,element:t}}let Tu=!1;function Rp(n,t){if(typeof window>"u"||typeof document>"u"||!Po(window.location.host)||dr[n]===t||dr[n]||Tu)return;dr[n]=t;function e(v){return`__firebase__banner__${v}`}const r="__firebase__banner",o=Ip().prod.length>0;function a(){const v=document.getElementById(r);v&&v.remove()}function l(v){v.style.display="flex",v.style.background="#7faaf0",v.style.position="fixed",v.style.bottom="5px",v.style.left="5px",v.style.padding=".5em",v.style.borderRadius="5px",v.style.alignItems="center"}function h(v,R){v.setAttribute("width","24"),v.setAttribute("id",R),v.setAttribute("height","24"),v.setAttribute("viewBox","0 0 24 24"),v.setAttribute("fill","none"),v.style.marginLeft="-6px"}function f(){const v=document.createElement("span");return v.style.cursor="pointer",v.style.marginLeft="16px",v.style.fontSize="24px",v.innerHTML=" &times;",v.onclick=()=>{Tu=!0,a()},v}function p(v,R){v.setAttribute("id",R),v.innerText="Learn more",v.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",v.setAttribute("target","__blank"),v.style.paddingLeft="5px",v.style.textDecoration="underline"}function y(){const v=Ap(r),R=e("text"),C=document.getElementById(R)||document.createElement("span"),D=e("learnmore"),V=document.getElementById(D)||document.createElement("a"),M=e("preprendIcon"),F=document.getElementById(M)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(v.created){const O=v.element;l(O),p(V,D);const X=f();h(F,M),O.append(F,C,V,X),document.body.appendChild(O)}o?(C.innerText="Preview backend disconnected.",F.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(F.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,C.innerText="Preview backend running in this workspace."),C.setAttribute("id",R)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",y):y()}function Sp(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function bp(){const n=Co()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Cp(){return!bp()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Pp(){try{return typeof indexedDB=="object"}catch{return!1}}function Vp(){return new Promise((n,t)=>{try{let e=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),e||self.indexedDB.deleteDatabase(r),n(!0)},s.onupgradeneeded=()=>{e=!1},s.onerror=()=>{t(s.error?.message||"")}}catch(e){t(e)}})}const Dp="FirebaseError";class On extends Error{constructor(t,e,r){super(e),this.code=t,this.customData=r,this.name=Dp,Object.setPrototypeOf(this,On.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,vc.prototype.create)}}class vc{constructor(t,e,r){this.service=t,this.serviceName=e,this.errors=r}create(t,...e){const r=e[0]||{},s=`${this.service}/${t}`,o=this.errors[t],a=o?Np(o,r):"Error",l=`${this.serviceName}: ${a} (${s}).`;return new On(s,l,r)}}function Np(n,t){return n.replace(kp,(e,r)=>{const s=t[r];return s!=null?String(s):`<${r}?>`})}const kp=/\{\$([^}]+)}/g;function Es(n,t){if(n===t)return!0;const e=Object.keys(n),r=Object.keys(t);for(const s of e){if(!r.includes(s))return!1;const o=n[s],a=t[s];if(wu(o)&&wu(a)){if(!Es(o,a))return!1}else if(o!==a)return!1}for(const s of r)if(!e.includes(s))return!1;return!0}function wu(n){return n!==null&&typeof n=="object"}function Sn(n){return n&&n._delegate?n._delegate:n}class Rr{constructor(t,e,r){this.name=t,this.instanceFactory=e,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}const ze="[DEFAULT]";class xp{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const r=new Ep;if(this.instancesDeferred.set(e,r),this.isInitialized(e)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:e});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(e).promise}getImmediate(t){const e=this.normalizeInstanceIdentifier(t?.identifier),r=t?.optional??!1;if(this.isInitialized(e)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:e})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(Mp(t))try{this.getOrInitializeService({instanceIdentifier:ze})}catch{}for(const[e,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(e);try{const o=this.getOrInitializeService({instanceIdentifier:s});r.resolve(o)}catch{}}}}clearInstance(t=ze){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...t.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=ze){return this.instances.has(t)}getOptions(t=ze){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,r=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:e});for(const[o,a]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(o);r===l&&a.resolve(s)}return s}onInit(t,e){const r=this.normalizeInstanceIdentifier(e),s=this.onInitCallbacks.get(r)??new Set;s.add(t),this.onInitCallbacks.set(r,s);const o=this.instances.get(r);return o&&t(o,r),()=>{s.delete(t)}}invokeOnInitCallbacks(t,e){const r=this.onInitCallbacks.get(e);if(r)for(const s of r)try{s(t,e)}catch{}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Op(t),options:e}),this.instances.set(t,r),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch{}return r||null}normalizeInstanceIdentifier(t=ze){return this.component?this.component.multipleInstances?t:ze:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Op(n){return n===ze?void 0:n}function Mp(n){return n.instantiationMode==="EAGER"}class Lp{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new xp(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}var G;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(G||(G={}));const Fp={debug:G.DEBUG,verbose:G.VERBOSE,info:G.INFO,warn:G.WARN,error:G.ERROR,silent:G.SILENT},Up=G.INFO,Bp={[G.DEBUG]:"log",[G.VERBOSE]:"log",[G.INFO]:"info",[G.WARN]:"warn",[G.ERROR]:"error"},jp=(n,t,...e)=>{if(t<n.logLevel)return;const r=new Date().toISOString(),s=Bp[t];if(s)console[s](`[${r}]  ${n.name}:`,...e);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class Ec{constructor(t){this.name=t,this._logLevel=Up,this._logHandler=jp,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in G))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?Fp[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,G.DEBUG,...t),this._logHandler(this,G.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,G.VERBOSE,...t),this._logHandler(this,G.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,G.INFO,...t),this._logHandler(this,G.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,G.WARN,...t),this._logHandler(this,G.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,G.ERROR,...t),this._logHandler(this,G.ERROR,...t)}}const qp=(n,t)=>t.some(e=>n instanceof e);let Iu,Au;function $p(){return Iu||(Iu=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function zp(){return Au||(Au=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Tc=new WeakMap,Wi=new WeakMap,wc=new WeakMap,ki=new WeakMap,Vo=new WeakMap;function Hp(n){const t=new Promise((e,r)=>{const s=()=>{n.removeEventListener("success",o),n.removeEventListener("error",a)},o=()=>{e(Pe(n.result)),s()},a=()=>{r(n.error),s()};n.addEventListener("success",o),n.addEventListener("error",a)});return t.then(e=>{e instanceof IDBCursor&&Tc.set(e,n)}).catch(()=>{}),Vo.set(t,n),t}function Gp(n){if(Wi.has(n))return;const t=new Promise((e,r)=>{const s=()=>{n.removeEventListener("complete",o),n.removeEventListener("error",a),n.removeEventListener("abort",a)},o=()=>{e(),s()},a=()=>{r(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",o),n.addEventListener("error",a),n.addEventListener("abort",a)});Wi.set(n,t)}let Qi={get(n,t,e){if(n instanceof IDBTransaction){if(t==="done")return Wi.get(n);if(t==="objectStoreNames")return n.objectStoreNames||wc.get(n);if(t==="store")return e.objectStoreNames[1]?void 0:e.objectStore(e.objectStoreNames[0])}return Pe(n[t])},set(n,t,e){return n[t]=e,!0},has(n,t){return n instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in n}};function Kp(n){Qi=n(Qi)}function Wp(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...e){const r=n.call(xi(this),t,...e);return wc.set(r,t.sort?t.sort():[t]),Pe(r)}:zp().includes(n)?function(...t){return n.apply(xi(this),t),Pe(Tc.get(this))}:function(...t){return Pe(n.apply(xi(this),t))}}function Qp(n){return typeof n=="function"?Wp(n):(n instanceof IDBTransaction&&Gp(n),qp(n,$p())?new Proxy(n,Qi):n)}function Pe(n){if(n instanceof IDBRequest)return Hp(n);if(ki.has(n))return ki.get(n);const t=Qp(n);return t!==n&&(ki.set(n,t),Vo.set(t,n)),t}const xi=n=>Vo.get(n);function Xp(n,t,{blocked:e,upgrade:r,blocking:s,terminated:o}={}){const a=indexedDB.open(n,t),l=Pe(a);return r&&a.addEventListener("upgradeneeded",h=>{r(Pe(a.result),h.oldVersion,h.newVersion,Pe(a.transaction),h)}),e&&a.addEventListener("blocked",h=>e(h.oldVersion,h.newVersion,h)),l.then(h=>{o&&h.addEventListener("close",()=>o()),s&&h.addEventListener("versionchange",f=>s(f.oldVersion,f.newVersion,f))}).catch(()=>{}),l}const Yp=["get","getKey","getAll","getAllKeys","count"],Jp=["put","add","delete","clear"],Oi=new Map;function Ru(n,t){if(!(n instanceof IDBDatabase&&!(t in n)&&typeof t=="string"))return;if(Oi.get(t))return Oi.get(t);const e=t.replace(/FromIndex$/,""),r=t!==e,s=Jp.includes(e);if(!(e in(r?IDBIndex:IDBObjectStore).prototype)||!(s||Yp.includes(e)))return;const o=async function(a,...l){const h=this.transaction(a,s?"readwrite":"readonly");let f=h.store;return r&&(f=f.index(l.shift())),(await Promise.all([f[e](...l),s&&h.done]))[0]};return Oi.set(t,o),o}Kp(n=>({...n,get:(t,e,r)=>Ru(t,e)||n.get(t,e,r),has:(t,e)=>!!Ru(t,e)||n.has(t,e)}));class Zp{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(tm(e)){const r=e.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(e=>e).join(" ")}}function tm(n){return n.getComponent()?.type==="VERSION"}const Xi="@firebase/app",Su="0.14.5";const he=new Ec("@firebase/app"),em="@firebase/app-compat",nm="@firebase/analytics-compat",rm="@firebase/analytics",sm="@firebase/app-check-compat",im="@firebase/app-check",om="@firebase/auth",am="@firebase/auth-compat",um="@firebase/database",lm="@firebase/data-connect",cm="@firebase/database-compat",hm="@firebase/functions",fm="@firebase/functions-compat",dm="@firebase/installations",pm="@firebase/installations-compat",mm="@firebase/messaging",gm="@firebase/messaging-compat",_m="@firebase/performance",ym="@firebase/performance-compat",vm="@firebase/remote-config",Em="@firebase/remote-config-compat",Tm="@firebase/storage",wm="@firebase/storage-compat",Im="@firebase/firestore",Am="@firebase/ai",Rm="@firebase/firestore-compat",Sm="firebase",bm="12.5.0";const Yi="[DEFAULT]",Cm={[Xi]:"fire-core",[em]:"fire-core-compat",[rm]:"fire-analytics",[nm]:"fire-analytics-compat",[im]:"fire-app-check",[sm]:"fire-app-check-compat",[om]:"fire-auth",[am]:"fire-auth-compat",[um]:"fire-rtdb",[lm]:"fire-data-connect",[cm]:"fire-rtdb-compat",[hm]:"fire-fn",[fm]:"fire-fn-compat",[dm]:"fire-iid",[pm]:"fire-iid-compat",[mm]:"fire-fcm",[gm]:"fire-fcm-compat",[_m]:"fire-perf",[ym]:"fire-perf-compat",[vm]:"fire-rc",[Em]:"fire-rc-compat",[Tm]:"fire-gcs",[wm]:"fire-gcs-compat",[Im]:"fire-fst",[Rm]:"fire-fst-compat",[Am]:"fire-vertex","fire-js":"fire-js",[Sm]:"fire-js-all"};const Ts=new Map,Pm=new Map,Ji=new Map;function bu(n,t){try{n.container.addComponent(t)}catch(e){he.debug(`Component ${t.name} failed to register with FirebaseApp ${n.name}`,e)}}function ws(n){const t=n.name;if(Ji.has(t))return he.debug(`There were multiple attempts to register component ${t}.`),!1;Ji.set(t,n);for(const e of Ts.values())bu(e,n);for(const e of Pm.values())bu(e,n);return!0}function Vm(n,t){const e=n.container.getProvider("heartbeat").getImmediate({optional:!0});return e&&e.triggerHeartbeat(),n.container.getProvider(t)}function Dm(n){return n==null?!1:n.settings!==void 0}const Nm={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ve=new vc("app","Firebase",Nm);class km{constructor(t,e,r){this._isDeleted=!1,this._options={...t},this._config={...e},this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Rr("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw Ve.create("app-deleted",{appName:this._name})}}const xm=bm;function Ic(n,t={}){let e=n;typeof t!="object"&&(t={name:t});const r={name:Yi,automaticDataCollectionEnabled:!0,...t},s=r.name;if(typeof s!="string"||!s)throw Ve.create("bad-app-name",{appName:String(s)});if(e||(e=yc()),!e)throw Ve.create("no-options");const o=Ts.get(s);if(o){if(Es(e,o.options)&&Es(r,o.config))return o;throw Ve.create("duplicate-app",{appName:s})}const a=new Lp(s);for(const h of Ji.values())a.addComponent(h);const l=new km(e,r,a);return Ts.set(s,l),l}function Om(n=Yi){const t=Ts.get(n);if(!t&&n===Yi&&yc())return Ic();if(!t)throw Ve.create("no-app",{appName:n});return t}function En(n,t,e){let r=Cm[n]??n;e&&(r+=`-${e}`);const s=r.match(/\s|\//),o=t.match(/\s|\//);if(s||o){const a=[`Unable to register library "${r}" with version "${t}":`];s&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${t}" contains illegal characters (whitespace or "/")`),he.warn(a.join(" "));return}ws(new Rr(`${r}-version`,()=>({library:r,version:t}),"VERSION"))}const Mm="firebase-heartbeat-database",Lm=1,Sr="firebase-heartbeat-store";let Mi=null;function Ac(){return Mi||(Mi=Xp(Mm,Lm,{upgrade:(n,t)=>{switch(t){case 0:try{n.createObjectStore(Sr)}catch(e){console.warn(e)}}}}).catch(n=>{throw Ve.create("idb-open",{originalErrorMessage:n.message})})),Mi}async function Fm(n){try{const e=(await Ac()).transaction(Sr),r=await e.objectStore(Sr).get(Rc(n));return await e.done,r}catch(t){if(t instanceof On)he.warn(t.message);else{const e=Ve.create("idb-get",{originalErrorMessage:t?.message});he.warn(e.message)}}}async function Cu(n,t){try{const r=(await Ac()).transaction(Sr,"readwrite");await r.objectStore(Sr).put(t,Rc(n)),await r.done}catch(e){if(e instanceof On)he.warn(e.message);else{const r=Ve.create("idb-set",{originalErrorMessage:e?.message});he.warn(r.message)}}}function Rc(n){return`${n.name}!${n.options.appId}`}const Um=1024,Bm=30;class jm{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new $m(e),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{const e=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=Pu();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(s=>s.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:e}),this._heartbeatsCache.heartbeats.length>Bm){const s=zm(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(s,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(t){he.warn(t)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=Pu(),{heartbeatsToSend:e,unsentEntries:r}=qm(this._heartbeatsCache.heartbeats),s=vs(JSON.stringify({version:2,heartbeats:e}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return he.warn(t),""}}}function Pu(){return new Date().toISOString().substring(0,10)}function qm(n,t=Um){const e=[];let r=n.slice();for(const s of n){const o=e.find(a=>a.agent===s.agent);if(o){if(o.dates.push(s.date),Vu(e)>t){o.dates.pop();break}}else if(e.push({agent:s.agent,dates:[s.date]}),Vu(e)>t){e.pop();break}r=r.slice(1)}return{heartbeatsToSend:e,unsentEntries:r}}class $m{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Pp()?Vp().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const e=await Fm(this.app);return e?.heartbeats?e:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){if(await this._canUseIndexedDBPromise){const r=await this.read();return Cu(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){if(await this._canUseIndexedDBPromise){const r=await this.read();return Cu(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...t.heartbeats]})}else return}}function Vu(n){return vs(JSON.stringify({version:2,heartbeats:n})).length}function zm(n){if(n.length===0)return-1;let t=0,e=n[0].date;for(let r=1;r<n.length;r++)n[r].date<e&&(e=n[r].date,t=r);return t}function Hm(n){ws(new Rr("platform-logger",t=>new Zp(t),"PRIVATE")),ws(new Rr("heartbeat",t=>new jm(t),"PRIVATE")),En(Xi,Su,n),En(Xi,Su,"esm2020"),En("fire-js","")}Hm("");var Du=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var De,Sc;(function(){var n;function t(T,m){function g(){}g.prototype=m.prototype,T.F=m.prototype,T.prototype=new g,T.prototype.constructor=T,T.D=function(w,E,A){for(var _=Array(arguments.length-2),Et=2;Et<arguments.length;Et++)_[Et-2]=arguments[Et];return m.prototype[E].apply(w,_)}}function e(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}t(r,e),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(T,m,g){g||(g=0);const w=Array(16);if(typeof m=="string")for(var E=0;E<16;++E)w[E]=m.charCodeAt(g++)|m.charCodeAt(g++)<<8|m.charCodeAt(g++)<<16|m.charCodeAt(g++)<<24;else for(E=0;E<16;++E)w[E]=m[g++]|m[g++]<<8|m[g++]<<16|m[g++]<<24;m=T.g[0],g=T.g[1],E=T.g[2];let A=T.g[3],_;_=m+(A^g&(E^A))+w[0]+3614090360&4294967295,m=g+(_<<7&4294967295|_>>>25),_=A+(E^m&(g^E))+w[1]+3905402710&4294967295,A=m+(_<<12&4294967295|_>>>20),_=E+(g^A&(m^g))+w[2]+606105819&4294967295,E=A+(_<<17&4294967295|_>>>15),_=g+(m^E&(A^m))+w[3]+3250441966&4294967295,g=E+(_<<22&4294967295|_>>>10),_=m+(A^g&(E^A))+w[4]+4118548399&4294967295,m=g+(_<<7&4294967295|_>>>25),_=A+(E^m&(g^E))+w[5]+1200080426&4294967295,A=m+(_<<12&4294967295|_>>>20),_=E+(g^A&(m^g))+w[6]+2821735955&4294967295,E=A+(_<<17&4294967295|_>>>15),_=g+(m^E&(A^m))+w[7]+4249261313&4294967295,g=E+(_<<22&4294967295|_>>>10),_=m+(A^g&(E^A))+w[8]+1770035416&4294967295,m=g+(_<<7&4294967295|_>>>25),_=A+(E^m&(g^E))+w[9]+2336552879&4294967295,A=m+(_<<12&4294967295|_>>>20),_=E+(g^A&(m^g))+w[10]+4294925233&4294967295,E=A+(_<<17&4294967295|_>>>15),_=g+(m^E&(A^m))+w[11]+2304563134&4294967295,g=E+(_<<22&4294967295|_>>>10),_=m+(A^g&(E^A))+w[12]+1804603682&4294967295,m=g+(_<<7&4294967295|_>>>25),_=A+(E^m&(g^E))+w[13]+4254626195&4294967295,A=m+(_<<12&4294967295|_>>>20),_=E+(g^A&(m^g))+w[14]+2792965006&4294967295,E=A+(_<<17&4294967295|_>>>15),_=g+(m^E&(A^m))+w[15]+1236535329&4294967295,g=E+(_<<22&4294967295|_>>>10),_=m+(E^A&(g^E))+w[1]+4129170786&4294967295,m=g+(_<<5&4294967295|_>>>27),_=A+(g^E&(m^g))+w[6]+3225465664&4294967295,A=m+(_<<9&4294967295|_>>>23),_=E+(m^g&(A^m))+w[11]+643717713&4294967295,E=A+(_<<14&4294967295|_>>>18),_=g+(A^m&(E^A))+w[0]+3921069994&4294967295,g=E+(_<<20&4294967295|_>>>12),_=m+(E^A&(g^E))+w[5]+3593408605&4294967295,m=g+(_<<5&4294967295|_>>>27),_=A+(g^E&(m^g))+w[10]+38016083&4294967295,A=m+(_<<9&4294967295|_>>>23),_=E+(m^g&(A^m))+w[15]+3634488961&4294967295,E=A+(_<<14&4294967295|_>>>18),_=g+(A^m&(E^A))+w[4]+3889429448&4294967295,g=E+(_<<20&4294967295|_>>>12),_=m+(E^A&(g^E))+w[9]+568446438&4294967295,m=g+(_<<5&4294967295|_>>>27),_=A+(g^E&(m^g))+w[14]+3275163606&4294967295,A=m+(_<<9&4294967295|_>>>23),_=E+(m^g&(A^m))+w[3]+4107603335&4294967295,E=A+(_<<14&4294967295|_>>>18),_=g+(A^m&(E^A))+w[8]+1163531501&4294967295,g=E+(_<<20&4294967295|_>>>12),_=m+(E^A&(g^E))+w[13]+2850285829&4294967295,m=g+(_<<5&4294967295|_>>>27),_=A+(g^E&(m^g))+w[2]+4243563512&4294967295,A=m+(_<<9&4294967295|_>>>23),_=E+(m^g&(A^m))+w[7]+1735328473&4294967295,E=A+(_<<14&4294967295|_>>>18),_=g+(A^m&(E^A))+w[12]+2368359562&4294967295,g=E+(_<<20&4294967295|_>>>12),_=m+(g^E^A)+w[5]+4294588738&4294967295,m=g+(_<<4&4294967295|_>>>28),_=A+(m^g^E)+w[8]+2272392833&4294967295,A=m+(_<<11&4294967295|_>>>21),_=E+(A^m^g)+w[11]+1839030562&4294967295,E=A+(_<<16&4294967295|_>>>16),_=g+(E^A^m)+w[14]+4259657740&4294967295,g=E+(_<<23&4294967295|_>>>9),_=m+(g^E^A)+w[1]+2763975236&4294967295,m=g+(_<<4&4294967295|_>>>28),_=A+(m^g^E)+w[4]+1272893353&4294967295,A=m+(_<<11&4294967295|_>>>21),_=E+(A^m^g)+w[7]+4139469664&4294967295,E=A+(_<<16&4294967295|_>>>16),_=g+(E^A^m)+w[10]+3200236656&4294967295,g=E+(_<<23&4294967295|_>>>9),_=m+(g^E^A)+w[13]+681279174&4294967295,m=g+(_<<4&4294967295|_>>>28),_=A+(m^g^E)+w[0]+3936430074&4294967295,A=m+(_<<11&4294967295|_>>>21),_=E+(A^m^g)+w[3]+3572445317&4294967295,E=A+(_<<16&4294967295|_>>>16),_=g+(E^A^m)+w[6]+76029189&4294967295,g=E+(_<<23&4294967295|_>>>9),_=m+(g^E^A)+w[9]+3654602809&4294967295,m=g+(_<<4&4294967295|_>>>28),_=A+(m^g^E)+w[12]+3873151461&4294967295,A=m+(_<<11&4294967295|_>>>21),_=E+(A^m^g)+w[15]+530742520&4294967295,E=A+(_<<16&4294967295|_>>>16),_=g+(E^A^m)+w[2]+3299628645&4294967295,g=E+(_<<23&4294967295|_>>>9),_=m+(E^(g|~A))+w[0]+4096336452&4294967295,m=g+(_<<6&4294967295|_>>>26),_=A+(g^(m|~E))+w[7]+1126891415&4294967295,A=m+(_<<10&4294967295|_>>>22),_=E+(m^(A|~g))+w[14]+2878612391&4294967295,E=A+(_<<15&4294967295|_>>>17),_=g+(A^(E|~m))+w[5]+4237533241&4294967295,g=E+(_<<21&4294967295|_>>>11),_=m+(E^(g|~A))+w[12]+1700485571&4294967295,m=g+(_<<6&4294967295|_>>>26),_=A+(g^(m|~E))+w[3]+2399980690&4294967295,A=m+(_<<10&4294967295|_>>>22),_=E+(m^(A|~g))+w[10]+4293915773&4294967295,E=A+(_<<15&4294967295|_>>>17),_=g+(A^(E|~m))+w[1]+2240044497&4294967295,g=E+(_<<21&4294967295|_>>>11),_=m+(E^(g|~A))+w[8]+1873313359&4294967295,m=g+(_<<6&4294967295|_>>>26),_=A+(g^(m|~E))+w[15]+4264355552&4294967295,A=m+(_<<10&4294967295|_>>>22),_=E+(m^(A|~g))+w[6]+2734768916&4294967295,E=A+(_<<15&4294967295|_>>>17),_=g+(A^(E|~m))+w[13]+1309151649&4294967295,g=E+(_<<21&4294967295|_>>>11),_=m+(E^(g|~A))+w[4]+4149444226&4294967295,m=g+(_<<6&4294967295|_>>>26),_=A+(g^(m|~E))+w[11]+3174756917&4294967295,A=m+(_<<10&4294967295|_>>>22),_=E+(m^(A|~g))+w[2]+718787259&4294967295,E=A+(_<<15&4294967295|_>>>17),_=g+(A^(E|~m))+w[9]+3951481745&4294967295,T.g[0]=T.g[0]+m&4294967295,T.g[1]=T.g[1]+(E+(_<<21&4294967295|_>>>11))&4294967295,T.g[2]=T.g[2]+E&4294967295,T.g[3]=T.g[3]+A&4294967295}r.prototype.v=function(T,m){m===void 0&&(m=T.length);const g=m-this.blockSize,w=this.C;let E=this.h,A=0;for(;A<m;){if(E==0)for(;A<=g;)s(this,T,A),A+=this.blockSize;if(typeof T=="string"){for(;A<m;)if(w[E++]=T.charCodeAt(A++),E==this.blockSize){s(this,w),E=0;break}}else for(;A<m;)if(w[E++]=T[A++],E==this.blockSize){s(this,w),E=0;break}}this.h=E,this.o+=m},r.prototype.A=function(){var T=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);T[0]=128;for(var m=1;m<T.length-8;++m)T[m]=0;m=this.o*8;for(var g=T.length-8;g<T.length;++g)T[g]=m&255,m/=256;for(this.v(T),T=Array(16),m=0,g=0;g<4;++g)for(let w=0;w<32;w+=8)T[m++]=this.g[g]>>>w&255;return T};function o(T,m){var g=l;return Object.prototype.hasOwnProperty.call(g,T)?g[T]:g[T]=m(T)}function a(T,m){this.h=m;const g=[];let w=!0;for(let E=T.length-1;E>=0;E--){const A=T[E]|0;w&&A==m||(g[E]=A,w=!1)}this.g=g}var l={};function h(T){return-128<=T&&T<128?o(T,function(m){return new a([m|0],m<0?-1:0)}):new a([T|0],T<0?-1:0)}function f(T){if(isNaN(T)||!isFinite(T))return y;if(T<0)return V(f(-T));const m=[];let g=1;for(let w=0;T>=g;w++)m[w]=T/g|0,g*=4294967296;return new a(m,0)}function p(T,m){if(T.length==0)throw Error("number format error: empty string");if(m=m||10,m<2||36<m)throw Error("radix out of range: "+m);if(T.charAt(0)=="-")return V(p(T.substring(1),m));if(T.indexOf("-")>=0)throw Error('number format error: interior "-" character');const g=f(Math.pow(m,8));let w=y;for(let A=0;A<T.length;A+=8){var E=Math.min(8,T.length-A);const _=parseInt(T.substring(A,A+E),m);E<8?(E=f(Math.pow(m,E)),w=w.j(E).add(f(_))):(w=w.j(g),w=w.add(f(_)))}return w}var y=h(0),v=h(1),R=h(16777216);n=a.prototype,n.m=function(){if(D(this))return-V(this).m();let T=0,m=1;for(let g=0;g<this.g.length;g++){const w=this.i(g);T+=(w>=0?w:4294967296+w)*m,m*=4294967296}return T},n.toString=function(T){if(T=T||10,T<2||36<T)throw Error("radix out of range: "+T);if(C(this))return"0";if(D(this))return"-"+V(this).toString(T);const m=f(Math.pow(T,6));var g=this;let w="";for(;;){const E=X(g,m).g;g=M(g,E.j(m));let A=((g.g.length>0?g.g[0]:g.h)>>>0).toString(T);if(g=E,C(g))return A+w;for(;A.length<6;)A="0"+A;w=A+w}},n.i=function(T){return T<0?0:T<this.g.length?this.g[T]:this.h};function C(T){if(T.h!=0)return!1;for(let m=0;m<T.g.length;m++)if(T.g[m]!=0)return!1;return!0}function D(T){return T.h==-1}n.l=function(T){return T=M(this,T),D(T)?-1:C(T)?0:1};function V(T){const m=T.g.length,g=[];for(let w=0;w<m;w++)g[w]=~T.g[w];return new a(g,~T.h).add(v)}n.abs=function(){return D(this)?V(this):this},n.add=function(T){const m=Math.max(this.g.length,T.g.length),g=[];let w=0;for(let E=0;E<=m;E++){let A=w+(this.i(E)&65535)+(T.i(E)&65535),_=(A>>>16)+(this.i(E)>>>16)+(T.i(E)>>>16);w=_>>>16,A&=65535,_&=65535,g[E]=_<<16|A}return new a(g,g[g.length-1]&-2147483648?-1:0)};function M(T,m){return T.add(V(m))}n.j=function(T){if(C(this)||C(T))return y;if(D(this))return D(T)?V(this).j(V(T)):V(V(this).j(T));if(D(T))return V(this.j(V(T)));if(this.l(R)<0&&T.l(R)<0)return f(this.m()*T.m());const m=this.g.length+T.g.length,g=[];for(var w=0;w<2*m;w++)g[w]=0;for(w=0;w<this.g.length;w++)for(let E=0;E<T.g.length;E++){const A=this.i(w)>>>16,_=this.i(w)&65535,Et=T.i(E)>>>16,ae=T.i(E)&65535;g[2*w+2*E]+=_*ae,F(g,2*w+2*E),g[2*w+2*E+1]+=A*ae,F(g,2*w+2*E+1),g[2*w+2*E+1]+=_*Et,F(g,2*w+2*E+1),g[2*w+2*E+2]+=A*Et,F(g,2*w+2*E+2)}for(T=0;T<m;T++)g[T]=g[2*T+1]<<16|g[2*T];for(T=m;T<2*m;T++)g[T]=0;return new a(g,0)};function F(T,m){for(;(T[m]&65535)!=T[m];)T[m+1]+=T[m]>>>16,T[m]&=65535,m++}function O(T,m){this.g=T,this.h=m}function X(T,m){if(C(m))throw Error("division by zero");if(C(T))return new O(y,y);if(D(T))return m=X(V(T),m),new O(V(m.g),V(m.h));if(D(m))return m=X(T,V(m)),new O(V(m.g),m.h);if(T.g.length>30){if(D(T)||D(m))throw Error("slowDivide_ only works with positive integers.");for(var g=v,w=m;w.l(T)<=0;)g=nt(g),w=nt(w);var E=rt(g,1),A=rt(w,1);for(w=rt(w,2),g=rt(g,2);!C(w);){var _=A.add(w);_.l(T)<=0&&(E=E.add(g),A=_),w=rt(w,1),g=rt(g,1)}return m=M(T,E.j(m)),new O(E,m)}for(E=y;T.l(m)>=0;){for(g=Math.max(1,Math.floor(T.m()/m.m())),w=Math.ceil(Math.log(g)/Math.LN2),w=w<=48?1:Math.pow(2,w-48),A=f(g),_=A.j(m);D(_)||_.l(T)>0;)g-=w,A=f(g),_=A.j(m);C(A)&&(A=v),E=E.add(A),T=M(T,_)}return new O(E,T)}n.B=function(T){return X(this,T).h},n.and=function(T){const m=Math.max(this.g.length,T.g.length),g=[];for(let w=0;w<m;w++)g[w]=this.i(w)&T.i(w);return new a(g,this.h&T.h)},n.or=function(T){const m=Math.max(this.g.length,T.g.length),g=[];for(let w=0;w<m;w++)g[w]=this.i(w)|T.i(w);return new a(g,this.h|T.h)},n.xor=function(T){const m=Math.max(this.g.length,T.g.length),g=[];for(let w=0;w<m;w++)g[w]=this.i(w)^T.i(w);return new a(g,this.h^T.h)};function nt(T){const m=T.g.length+1,g=[];for(let w=0;w<m;w++)g[w]=T.i(w)<<1|T.i(w-1)>>>31;return new a(g,T.h)}function rt(T,m){const g=m>>5;m%=32;const w=T.g.length-g,E=[];for(let A=0;A<w;A++)E[A]=m>0?T.i(A+g)>>>m|T.i(A+g+1)<<32-m:T.i(A+g);return new a(E,T.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,Sc=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.B,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=f,a.fromString=p,De=a}).apply(typeof Du<"u"?Du:typeof self<"u"?self:typeof window<"u"?window:{});var ss=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var bc,sr,Cc,cs,Zi,Pc,Vc,Dc;(function(){var n,t=Object.defineProperty;function e(i){i=[typeof globalThis=="object"&&globalThis,i,typeof window=="object"&&window,typeof self=="object"&&self,typeof ss=="object"&&ss];for(var u=0;u<i.length;++u){var c=i[u];if(c&&c.Math==Math)return c}throw Error("Cannot find global object")}var r=e(this);function s(i,u){if(u)t:{var c=r;i=i.split(".");for(var d=0;d<i.length-1;d++){var I=i[d];if(!(I in c))break t;c=c[I]}i=i[i.length-1],d=c[i],u=u(d),u!=d&&u!=null&&t(c,i,{configurable:!0,writable:!0,value:u})}}s("Symbol.dispose",function(i){return i||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(i){return i||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(i){return i||function(u){var c=[],d;for(d in u)Object.prototype.hasOwnProperty.call(u,d)&&c.push([d,u[d]]);return c}});var o=o||{},a=this||self;function l(i){var u=typeof i;return u=="object"&&i!=null||u=="function"}function h(i,u,c){return i.call.apply(i.bind,arguments)}function f(i,u,c){return f=h,f.apply(null,arguments)}function p(i,u){var c=Array.prototype.slice.call(arguments,1);return function(){var d=c.slice();return d.push.apply(d,arguments),i.apply(this,d)}}function y(i,u){function c(){}c.prototype=u.prototype,i.Z=u.prototype,i.prototype=new c,i.prototype.constructor=i,i.Ob=function(d,I,S){for(var N=Array(arguments.length-2),q=2;q<arguments.length;q++)N[q-2]=arguments[q];return u.prototype[I].apply(d,N)}}var v=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?i=>i&&AsyncContext.Snapshot.wrap(i):i=>i;function R(i){const u=i.length;if(u>0){const c=Array(u);for(let d=0;d<u;d++)c[d]=i[d];return c}return[]}function C(i,u){for(let d=1;d<arguments.length;d++){const I=arguments[d];var c=typeof I;if(c=c!="object"?c:I?Array.isArray(I)?"array":c:"null",c=="array"||c=="object"&&typeof I.length=="number"){c=i.length||0;const S=I.length||0;i.length=c+S;for(let N=0;N<S;N++)i[c+N]=I[N]}else i.push(I)}}class D{constructor(u,c){this.i=u,this.j=c,this.h=0,this.g=null}get(){let u;return this.h>0?(this.h--,u=this.g,this.g=u.next,u.next=null):u=this.i(),u}}function V(i){a.setTimeout(()=>{throw i},0)}function M(){var i=T;let u=null;return i.g&&(u=i.g,i.g=i.g.next,i.g||(i.h=null),u.next=null),u}class F{constructor(){this.h=this.g=null}add(u,c){const d=O.get();d.set(u,c),this.h?this.h.next=d:this.g=d,this.h=d}}var O=new D(()=>new X,i=>i.reset());class X{constructor(){this.next=this.g=this.h=null}set(u,c){this.h=u,this.g=c,this.next=null}reset(){this.next=this.g=this.h=null}}let nt,rt=!1,T=new F,m=()=>{const i=Promise.resolve(void 0);nt=()=>{i.then(g)}};function g(){for(var i;i=M();){try{i.h.call(i.g)}catch(c){V(c)}var u=O;u.j(i),u.h<100&&(u.h++,i.next=u.g,u.g=i)}rt=!1}function w(){this.u=this.u,this.C=this.C}w.prototype.u=!1,w.prototype.dispose=function(){this.u||(this.u=!0,this.N())},w.prototype[Symbol.dispose]=function(){this.dispose()},w.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function E(i,u){this.type=i,this.g=this.target=u,this.defaultPrevented=!1}E.prototype.h=function(){this.defaultPrevented=!0};var A=(function(){if(!a.addEventListener||!Object.defineProperty)return!1;var i=!1,u=Object.defineProperty({},"passive",{get:function(){i=!0}});try{const c=()=>{};a.addEventListener("test",c,u),a.removeEventListener("test",c,u)}catch{}return i})();function _(i){return/^[\s\xa0]*$/.test(i)}function Et(i,u){E.call(this,i?i.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,i&&this.init(i,u)}y(Et,E),Et.prototype.init=function(i,u){const c=this.type=i.type,d=i.changedTouches&&i.changedTouches.length?i.changedTouches[0]:null;this.target=i.target||i.srcElement,this.g=u,u=i.relatedTarget,u||(c=="mouseover"?u=i.fromElement:c=="mouseout"&&(u=i.toElement)),this.relatedTarget=u,d?(this.clientX=d.clientX!==void 0?d.clientX:d.pageX,this.clientY=d.clientY!==void 0?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0):(this.clientX=i.clientX!==void 0?i.clientX:i.pageX,this.clientY=i.clientY!==void 0?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0),this.button=i.button,this.key=i.key||"",this.ctrlKey=i.ctrlKey,this.altKey=i.altKey,this.shiftKey=i.shiftKey,this.metaKey=i.metaKey,this.pointerId=i.pointerId||0,this.pointerType=i.pointerType,this.state=i.state,this.i=i,i.defaultPrevented&&Et.Z.h.call(this)},Et.prototype.h=function(){Et.Z.h.call(this);const i=this.i;i.preventDefault?i.preventDefault():i.returnValue=!1};var ae="closure_listenable_"+(Math.random()*1e6|0),sf=0;function of(i,u,c,d,I){this.listener=i,this.proxy=null,this.src=u,this.type=c,this.capture=!!d,this.ha=I,this.key=++sf,this.da=this.fa=!1}function qr(i){i.da=!0,i.listener=null,i.proxy=null,i.src=null,i.ha=null}function $r(i,u,c){for(const d in i)u.call(c,i[d],d,i)}function af(i,u){for(const c in i)u.call(void 0,i[c],c,i)}function ia(i){const u={};for(const c in i)u[c]=i[c];return u}const oa="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function aa(i,u){let c,d;for(let I=1;I<arguments.length;I++){d=arguments[I];for(c in d)i[c]=d[c];for(let S=0;S<oa.length;S++)c=oa[S],Object.prototype.hasOwnProperty.call(d,c)&&(i[c]=d[c])}}function zr(i){this.src=i,this.g={},this.h=0}zr.prototype.add=function(i,u,c,d,I){const S=i.toString();i=this.g[S],i||(i=this.g[S]=[],this.h++);const N=si(i,u,d,I);return N>-1?(u=i[N],c||(u.fa=!1)):(u=new of(u,this.src,S,!!d,I),u.fa=c,i.push(u)),u};function ri(i,u){const c=u.type;if(c in i.g){var d=i.g[c],I=Array.prototype.indexOf.call(d,u,void 0),S;(S=I>=0)&&Array.prototype.splice.call(d,I,1),S&&(qr(u),i.g[c].length==0&&(delete i.g[c],i.h--))}}function si(i,u,c,d){for(let I=0;I<i.length;++I){const S=i[I];if(!S.da&&S.listener==u&&S.capture==!!c&&S.ha==d)return I}return-1}var ii="closure_lm_"+(Math.random()*1e6|0),oi={};function ua(i,u,c,d,I){if(Array.isArray(u)){for(let S=0;S<u.length;S++)ua(i,u[S],c,d,I);return null}return c=ha(c),i&&i[ae]?i.J(u,c,l(d)?!!d.capture:!1,I):uf(i,u,c,!1,d,I)}function uf(i,u,c,d,I,S){if(!u)throw Error("Invalid event type");const N=l(I)?!!I.capture:!!I;let q=ui(i);if(q||(i[ii]=q=new zr(i)),c=q.add(u,c,d,N,S),c.proxy)return c;if(d=lf(),c.proxy=d,d.src=i,d.listener=c,i.addEventListener)A||(I=N),I===void 0&&(I=!1),i.addEventListener(u.toString(),d,I);else if(i.attachEvent)i.attachEvent(ca(u.toString()),d);else if(i.addListener&&i.removeListener)i.addListener(d);else throw Error("addEventListener and attachEvent are unavailable.");return c}function lf(){function i(c){return u.call(i.src,i.listener,c)}const u=cf;return i}function la(i,u,c,d,I){if(Array.isArray(u))for(var S=0;S<u.length;S++)la(i,u[S],c,d,I);else d=l(d)?!!d.capture:!!d,c=ha(c),i&&i[ae]?(i=i.i,S=String(u).toString(),S in i.g&&(u=i.g[S],c=si(u,c,d,I),c>-1&&(qr(u[c]),Array.prototype.splice.call(u,c,1),u.length==0&&(delete i.g[S],i.h--)))):i&&(i=ui(i))&&(u=i.g[u.toString()],i=-1,u&&(i=si(u,c,d,I)),(c=i>-1?u[i]:null)&&ai(c))}function ai(i){if(typeof i!="number"&&i&&!i.da){var u=i.src;if(u&&u[ae])ri(u.i,i);else{var c=i.type,d=i.proxy;u.removeEventListener?u.removeEventListener(c,d,i.capture):u.detachEvent?u.detachEvent(ca(c),d):u.addListener&&u.removeListener&&u.removeListener(d),(c=ui(u))?(ri(c,i),c.h==0&&(c.src=null,u[ii]=null)):qr(i)}}}function ca(i){return i in oi?oi[i]:oi[i]="on"+i}function cf(i,u){if(i.da)i=!0;else{u=new Et(u,this);const c=i.listener,d=i.ha||i.src;i.fa&&ai(i),i=c.call(d,u)}return i}function ui(i){return i=i[ii],i instanceof zr?i:null}var li="__closure_events_fn_"+(Math.random()*1e9>>>0);function ha(i){return typeof i=="function"?i:(i[li]||(i[li]=function(u){return i.handleEvent(u)}),i[li])}function Tt(){w.call(this),this.i=new zr(this),this.M=this,this.G=null}y(Tt,w),Tt.prototype[ae]=!0,Tt.prototype.removeEventListener=function(i,u,c,d){la(this,i,u,c,d)};function Pt(i,u){var c,d=i.G;if(d)for(c=[];d;d=d.G)c.push(d);if(i=i.M,d=u.type||u,typeof u=="string")u=new E(u,i);else if(u instanceof E)u.target=u.target||i;else{var I=u;u=new E(d,i),aa(u,I)}I=!0;let S,N;if(c)for(N=c.length-1;N>=0;N--)S=u.g=c[N],I=Hr(S,d,!0,u)&&I;if(S=u.g=i,I=Hr(S,d,!0,u)&&I,I=Hr(S,d,!1,u)&&I,c)for(N=0;N<c.length;N++)S=u.g=c[N],I=Hr(S,d,!1,u)&&I}Tt.prototype.N=function(){if(Tt.Z.N.call(this),this.i){var i=this.i;for(const u in i.g){const c=i.g[u];for(let d=0;d<c.length;d++)qr(c[d]);delete i.g[u],i.h--}}this.G=null},Tt.prototype.J=function(i,u,c,d){return this.i.add(String(i),u,!1,c,d)},Tt.prototype.K=function(i,u,c,d){return this.i.add(String(i),u,!0,c,d)};function Hr(i,u,c,d){if(u=i.i.g[String(u)],!u)return!0;u=u.concat();let I=!0;for(let S=0;S<u.length;++S){const N=u[S];if(N&&!N.da&&N.capture==c){const q=N.listener,ht=N.ha||N.src;N.fa&&ri(i.i,N),I=q.call(ht,d)!==!1&&I}}return I&&!d.defaultPrevented}function hf(i,u){if(typeof i!="function")if(i&&typeof i.handleEvent=="function")i=f(i.handleEvent,i);else throw Error("Invalid listener argument");return Number(u)>2147483647?-1:a.setTimeout(i,u||0)}function fa(i){i.g=hf(()=>{i.g=null,i.i&&(i.i=!1,fa(i))},i.l);const u=i.h;i.h=null,i.m.apply(null,u)}class ff extends w{constructor(u,c){super(),this.m=u,this.l=c,this.h=null,this.i=!1,this.g=null}j(u){this.h=arguments,this.g?this.i=!0:fa(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Bn(i){w.call(this),this.h=i,this.g={}}y(Bn,w);var da=[];function pa(i){$r(i.g,function(u,c){this.g.hasOwnProperty(c)&&ai(u)},i),i.g={}}Bn.prototype.N=function(){Bn.Z.N.call(this),pa(this)},Bn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ci=a.JSON.stringify,df=a.JSON.parse,pf=class{stringify(i){return a.JSON.stringify(i,void 0)}parse(i){return a.JSON.parse(i,void 0)}};function ma(){}function ga(){}var jn={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function hi(){E.call(this,"d")}y(hi,E);function fi(){E.call(this,"c")}y(fi,E);var Ue={},_a=null;function Gr(){return _a=_a||new Tt}Ue.Ia="serverreachability";function ya(i){E.call(this,Ue.Ia,i)}y(ya,E);function qn(i){const u=Gr();Pt(u,new ya(u))}Ue.STAT_EVENT="statevent";function va(i,u){E.call(this,Ue.STAT_EVENT,i),this.stat=u}y(va,E);function Vt(i){const u=Gr();Pt(u,new va(u,i))}Ue.Ja="timingevent";function Ea(i,u){E.call(this,Ue.Ja,i),this.size=u}y(Ea,E);function $n(i,u){if(typeof i!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){i()},u)}function zn(){this.g=!0}zn.prototype.ua=function(){this.g=!1};function mf(i,u,c,d,I,S){i.info(function(){if(i.g)if(S){var N="",q=S.split("&");for(let Y=0;Y<q.length;Y++){var ht=q[Y].split("=");if(ht.length>1){const pt=ht[0];ht=ht[1];const Wt=pt.split("_");N=Wt.length>=2&&Wt[1]=="type"?N+(pt+"="+ht+"&"):N+(pt+"=redacted&")}}}else N=null;else N=S;return"XMLHTTP REQ ("+d+") [attempt "+I+"]: "+u+`
`+c+`
`+N})}function gf(i,u,c,d,I,S,N){i.info(function(){return"XMLHTTP RESP ("+d+") [ attempt "+I+"]: "+u+`
`+c+`
`+S+" "+N})}function cn(i,u,c,d){i.info(function(){return"XMLHTTP TEXT ("+u+"): "+yf(i,c)+(d?" "+d:"")})}function _f(i,u){i.info(function(){return"TIMEOUT: "+u})}zn.prototype.info=function(){};function yf(i,u){if(!i.g)return u;if(!u)return null;try{const S=JSON.parse(u);if(S){for(i=0;i<S.length;i++)if(Array.isArray(S[i])){var c=S[i];if(!(c.length<2)){var d=c[1];if(Array.isArray(d)&&!(d.length<1)){var I=d[0];if(I!="noop"&&I!="stop"&&I!="close")for(let N=1;N<d.length;N++)d[N]=""}}}}return ci(S)}catch{return u}}var Kr={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Ta={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},wa;function di(){}y(di,ma),di.prototype.g=function(){return new XMLHttpRequest},wa=new di;function Hn(i){return encodeURIComponent(String(i))}function vf(i){var u=1;i=i.split(":");const c=[];for(;u>0&&i.length;)c.push(i.shift()),u--;return i.length&&c.push(i.join(":")),c}function ye(i,u,c,d){this.j=i,this.i=u,this.l=c,this.S=d||1,this.V=new Bn(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Ia}function Ia(){this.i=null,this.g="",this.h=!1}var Aa={},pi={};function mi(i,u,c){i.M=1,i.A=Qr(Kt(u)),i.u=c,i.R=!0,Ra(i,null)}function Ra(i,u){i.F=Date.now(),Wr(i),i.B=Kt(i.A);var c=i.B,d=i.S;Array.isArray(d)||(d=[String(d)]),Fa(c.i,"t",d),i.C=0,c=i.j.L,i.h=new Ia,i.g=nu(i.j,c?u:null,!i.u),i.P>0&&(i.O=new ff(f(i.Y,i,i.g),i.P)),u=i.V,c=i.g,d=i.ba;var I="readystatechange";Array.isArray(I)||(I&&(da[0]=I.toString()),I=da);for(let S=0;S<I.length;S++){const N=ua(c,I[S],d||u.handleEvent,!1,u.h||u);if(!N)break;u.g[N.key]=N}u=i.J?ia(i.J):{},i.u?(i.v||(i.v="POST"),u["Content-Type"]="application/x-www-form-urlencoded",i.g.ea(i.B,i.v,i.u,u)):(i.v="GET",i.g.ea(i.B,i.v,null,u)),qn(),mf(i.i,i.v,i.B,i.l,i.S,i.u)}ye.prototype.ba=function(i){i=i.target;const u=this.O;u&&Te(i)==3?u.j():this.Y(i)},ye.prototype.Y=function(i){try{if(i==this.g)t:{const q=Te(this.g),ht=this.g.ya(),Y=this.g.ca();if(!(q<3)&&(q!=3||this.g&&(this.h.h||this.g.la()||Ha(this.g)))){this.K||q!=4||ht==7||(ht==8||Y<=0?qn(3):qn(2)),gi(this);var u=this.g.ca();this.X=u;var c=Ef(this);if(this.o=u==200,gf(this.i,this.v,this.B,this.l,this.S,q,u),this.o){if(this.U&&!this.L){e:{if(this.g){var d,I=this.g;if((d=I.g?I.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!_(d)){var S=d;break e}}S=null}if(i=S)cn(this.i,this.l,i,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,_i(this,i);else{this.o=!1,this.m=3,Vt(12),Be(this),Gn(this);break t}}if(this.R){i=!0;let pt;for(;!this.K&&this.C<c.length;)if(pt=Tf(this,c),pt==pi){q==4&&(this.m=4,Vt(14),i=!1),cn(this.i,this.l,null,"[Incomplete Response]");break}else if(pt==Aa){this.m=4,Vt(15),cn(this.i,this.l,c,"[Invalid Chunk]"),i=!1;break}else cn(this.i,this.l,pt,null),_i(this,pt);if(Sa(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),q!=4||c.length!=0||this.h.h||(this.m=1,Vt(16),i=!1),this.o=this.o&&i,!i)cn(this.i,this.l,c,"[Invalid Chunked Response]"),Be(this),Gn(this);else if(c.length>0&&!this.W){this.W=!0;var N=this.j;N.g==this&&N.aa&&!N.P&&(N.j.info("Great, no buffering proxy detected. Bytes received: "+c.length),Ri(N),N.P=!0,Vt(11))}}else cn(this.i,this.l,c,null),_i(this,c);q==4&&Be(this),this.o&&!this.K&&(q==4?Ja(this.j,this):(this.o=!1,Wr(this)))}else Of(this.g),u==400&&c.indexOf("Unknown SID")>0?(this.m=3,Vt(12)):(this.m=0,Vt(13)),Be(this),Gn(this)}}}catch{}finally{}};function Ef(i){if(!Sa(i))return i.g.la();const u=Ha(i.g);if(u==="")return"";let c="";const d=u.length,I=Te(i.g)==4;if(!i.h.i){if(typeof TextDecoder>"u")return Be(i),Gn(i),"";i.h.i=new a.TextDecoder}for(let S=0;S<d;S++)i.h.h=!0,c+=i.h.i.decode(u[S],{stream:!(I&&S==d-1)});return u.length=0,i.h.g+=c,i.C=0,i.h.g}function Sa(i){return i.g?i.v=="GET"&&i.M!=2&&i.j.Aa:!1}function Tf(i,u){var c=i.C,d=u.indexOf(`
`,c);return d==-1?pi:(c=Number(u.substring(c,d)),isNaN(c)?Aa:(d+=1,d+c>u.length?pi:(u=u.slice(d,d+c),i.C=d+c,u)))}ye.prototype.cancel=function(){this.K=!0,Be(this)};function Wr(i){i.T=Date.now()+i.H,ba(i,i.H)}function ba(i,u){if(i.D!=null)throw Error("WatchDog timer not null");i.D=$n(f(i.aa,i),u)}function gi(i){i.D&&(a.clearTimeout(i.D),i.D=null)}ye.prototype.aa=function(){this.D=null;const i=Date.now();i-this.T>=0?(_f(this.i,this.B),this.M!=2&&(qn(),Vt(17)),Be(this),this.m=2,Gn(this)):ba(this,this.T-i)};function Gn(i){i.j.I==0||i.K||Ja(i.j,i)}function Be(i){gi(i);var u=i.O;u&&typeof u.dispose=="function"&&u.dispose(),i.O=null,pa(i.V),i.g&&(u=i.g,i.g=null,u.abort(),u.dispose())}function _i(i,u){try{var c=i.j;if(c.I!=0&&(c.g==i||yi(c.h,i))){if(!i.L&&yi(c.h,i)&&c.I==3){try{var d=c.Ba.g.parse(u)}catch{d=null}if(Array.isArray(d)&&d.length==3){var I=d;if(I[0]==0){t:if(!c.v){if(c.g)if(c.g.F+3e3<i.F)ts(c),Jr(c);else break t;Ai(c),Vt(18)}}else c.xa=I[1],0<c.xa-c.K&&I[2]<37500&&c.F&&c.A==0&&!c.C&&(c.C=$n(f(c.Va,c),6e3));Va(c.h)<=1&&c.ta&&(c.ta=void 0)}else qe(c,11)}else if((i.L||c.g==i)&&ts(c),!_(u))for(I=c.Ba.g.parse(u),u=0;u<I.length;u++){let Y=I[u];const pt=Y[0];if(!(pt<=c.K))if(c.K=pt,Y=Y[1],c.I==2)if(Y[0]=="c"){c.M=Y[1],c.ba=Y[2];const Wt=Y[3];Wt!=null&&(c.ka=Wt,c.j.info("VER="+c.ka));const $e=Y[4];$e!=null&&(c.za=$e,c.j.info("SVER="+c.za));const we=Y[5];we!=null&&typeof we=="number"&&we>0&&(d=1.5*we,c.O=d,c.j.info("backChannelRequestTimeoutMs_="+d)),d=c;const Ie=i.g;if(Ie){const ns=Ie.g?Ie.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ns){var S=d.h;S.g||ns.indexOf("spdy")==-1&&ns.indexOf("quic")==-1&&ns.indexOf("h2")==-1||(S.j=S.l,S.g=new Set,S.h&&(vi(S,S.h),S.h=null))}if(d.G){const Si=Ie.g?Ie.g.getResponseHeader("X-HTTP-Session-Id"):null;Si&&(d.wa=Si,J(d.J,d.G,Si))}}c.I=3,c.l&&c.l.ra(),c.aa&&(c.T=Date.now()-i.F,c.j.info("Handshake RTT: "+c.T+"ms")),d=c;var N=i;if(d.na=eu(d,d.L?d.ba:null,d.W),N.L){Da(d.h,N);var q=N,ht=d.O;ht&&(q.H=ht),q.D&&(gi(q),Wr(q)),d.g=N}else Xa(d);c.i.length>0&&Zr(c)}else Y[0]!="stop"&&Y[0]!="close"||qe(c,7);else c.I==3&&(Y[0]=="stop"||Y[0]=="close"?Y[0]=="stop"?qe(c,7):Ii(c):Y[0]!="noop"&&c.l&&c.l.qa(Y),c.A=0)}}qn(4)}catch{}}var wf=class{constructor(i,u){this.g=i,this.map=u}};function Ca(i){this.l=i||10,a.PerformanceNavigationTiming?(i=a.performance.getEntriesByType("navigation"),i=i.length>0&&(i[0].nextHopProtocol=="hq"||i[0].nextHopProtocol=="h2")):i=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=i?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Pa(i){return i.h?!0:i.g?i.g.size>=i.j:!1}function Va(i){return i.h?1:i.g?i.g.size:0}function yi(i,u){return i.h?i.h==u:i.g?i.g.has(u):!1}function vi(i,u){i.g?i.g.add(u):i.h=u}function Da(i,u){i.h&&i.h==u?i.h=null:i.g&&i.g.has(u)&&i.g.delete(u)}Ca.prototype.cancel=function(){if(this.i=Na(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const i of this.g.values())i.cancel();this.g.clear()}};function Na(i){if(i.h!=null)return i.i.concat(i.h.G);if(i.g!=null&&i.g.size!==0){let u=i.i;for(const c of i.g.values())u=u.concat(c.G);return u}return R(i.i)}var ka=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function If(i,u){if(i){i=i.split("&");for(let c=0;c<i.length;c++){const d=i[c].indexOf("=");let I,S=null;d>=0?(I=i[c].substring(0,d),S=i[c].substring(d+1)):I=i[c],u(I,S?decodeURIComponent(S.replace(/\+/g," ")):"")}}}function ve(i){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let u;i instanceof ve?(this.l=i.l,Kn(this,i.j),this.o=i.o,this.g=i.g,Wn(this,i.u),this.h=i.h,Ei(this,Ua(i.i)),this.m=i.m):i&&(u=String(i).match(ka))?(this.l=!1,Kn(this,u[1]||"",!0),this.o=Qn(u[2]||""),this.g=Qn(u[3]||"",!0),Wn(this,u[4]),this.h=Qn(u[5]||"",!0),Ei(this,u[6]||"",!0),this.m=Qn(u[7]||"")):(this.l=!1,this.i=new Yn(null,this.l))}ve.prototype.toString=function(){const i=[];var u=this.j;u&&i.push(Xn(u,xa,!0),":");var c=this.g;return(c||u=="file")&&(i.push("//"),(u=this.o)&&i.push(Xn(u,xa,!0),"@"),i.push(Hn(c).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c=this.u,c!=null&&i.push(":",String(c))),(c=this.h)&&(this.g&&c.charAt(0)!="/"&&i.push("/"),i.push(Xn(c,c.charAt(0)=="/"?Sf:Rf,!0))),(c=this.i.toString())&&i.push("?",c),(c=this.m)&&i.push("#",Xn(c,Cf)),i.join("")},ve.prototype.resolve=function(i){const u=Kt(this);let c=!!i.j;c?Kn(u,i.j):c=!!i.o,c?u.o=i.o:c=!!i.g,c?u.g=i.g:c=i.u!=null;var d=i.h;if(c)Wn(u,i.u);else if(c=!!i.h){if(d.charAt(0)!="/")if(this.g&&!this.h)d="/"+d;else{var I=u.h.lastIndexOf("/");I!=-1&&(d=u.h.slice(0,I+1)+d)}if(I=d,I==".."||I==".")d="";else if(I.indexOf("./")!=-1||I.indexOf("/.")!=-1){d=I.lastIndexOf("/",0)==0,I=I.split("/");const S=[];for(let N=0;N<I.length;){const q=I[N++];q=="."?d&&N==I.length&&S.push(""):q==".."?((S.length>1||S.length==1&&S[0]!="")&&S.pop(),d&&N==I.length&&S.push("")):(S.push(q),d=!0)}d=S.join("/")}else d=I}return c?u.h=d:c=i.i.toString()!=="",c?Ei(u,Ua(i.i)):c=!!i.m,c&&(u.m=i.m),u};function Kt(i){return new ve(i)}function Kn(i,u,c){i.j=c?Qn(u,!0):u,i.j&&(i.j=i.j.replace(/:$/,""))}function Wn(i,u){if(u){if(u=Number(u),isNaN(u)||u<0)throw Error("Bad port number "+u);i.u=u}else i.u=null}function Ei(i,u,c){u instanceof Yn?(i.i=u,Pf(i.i,i.l)):(c||(u=Xn(u,bf)),i.i=new Yn(u,i.l))}function J(i,u,c){i.i.set(u,c)}function Qr(i){return J(i,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),i}function Qn(i,u){return i?u?decodeURI(i.replace(/%25/g,"%2525")):decodeURIComponent(i):""}function Xn(i,u,c){return typeof i=="string"?(i=encodeURI(i).replace(u,Af),c&&(i=i.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),i):null}function Af(i){return i=i.charCodeAt(0),"%"+(i>>4&15).toString(16)+(i&15).toString(16)}var xa=/[#\/\?@]/g,Rf=/[#\?:]/g,Sf=/[#\?]/g,bf=/[#\?@]/g,Cf=/#/g;function Yn(i,u){this.h=this.g=null,this.i=i||null,this.j=!!u}function je(i){i.g||(i.g=new Map,i.h=0,i.i&&If(i.i,function(u,c){i.add(decodeURIComponent(u.replace(/\+/g," ")),c)}))}n=Yn.prototype,n.add=function(i,u){je(this),this.i=null,i=hn(this,i);let c=this.g.get(i);return c||this.g.set(i,c=[]),c.push(u),this.h+=1,this};function Oa(i,u){je(i),u=hn(i,u),i.g.has(u)&&(i.i=null,i.h-=i.g.get(u).length,i.g.delete(u))}function Ma(i,u){return je(i),u=hn(i,u),i.g.has(u)}n.forEach=function(i,u){je(this),this.g.forEach(function(c,d){c.forEach(function(I){i.call(u,I,d,this)},this)},this)};function La(i,u){je(i);let c=[];if(typeof u=="string")Ma(i,u)&&(c=c.concat(i.g.get(hn(i,u))));else for(i=Array.from(i.g.values()),u=0;u<i.length;u++)c=c.concat(i[u]);return c}n.set=function(i,u){return je(this),this.i=null,i=hn(this,i),Ma(this,i)&&(this.h-=this.g.get(i).length),this.g.set(i,[u]),this.h+=1,this},n.get=function(i,u){return i?(i=La(this,i),i.length>0?String(i[0]):u):u};function Fa(i,u,c){Oa(i,u),c.length>0&&(i.i=null,i.g.set(hn(i,u),R(c)),i.h+=c.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const i=[],u=Array.from(this.g.keys());for(let d=0;d<u.length;d++){var c=u[d];const I=Hn(c);c=La(this,c);for(let S=0;S<c.length;S++){let N=I;c[S]!==""&&(N+="="+Hn(c[S])),i.push(N)}}return this.i=i.join("&")};function Ua(i){const u=new Yn;return u.i=i.i,i.g&&(u.g=new Map(i.g),u.h=i.h),u}function hn(i,u){return u=String(u),i.j&&(u=u.toLowerCase()),u}function Pf(i,u){u&&!i.j&&(je(i),i.i=null,i.g.forEach(function(c,d){const I=d.toLowerCase();d!=I&&(Oa(this,d),Fa(this,I,c))},i)),i.j=u}function Vf(i,u){const c=new zn;if(a.Image){const d=new Image;d.onload=p(Ee,c,"TestLoadImage: loaded",!0,u,d),d.onerror=p(Ee,c,"TestLoadImage: error",!1,u,d),d.onabort=p(Ee,c,"TestLoadImage: abort",!1,u,d),d.ontimeout=p(Ee,c,"TestLoadImage: timeout",!1,u,d),a.setTimeout(function(){d.ontimeout&&d.ontimeout()},1e4),d.src=i}else u(!1)}function Df(i,u){const c=new zn,d=new AbortController,I=setTimeout(()=>{d.abort(),Ee(c,"TestPingServer: timeout",!1,u)},1e4);fetch(i,{signal:d.signal}).then(S=>{clearTimeout(I),S.ok?Ee(c,"TestPingServer: ok",!0,u):Ee(c,"TestPingServer: server error",!1,u)}).catch(()=>{clearTimeout(I),Ee(c,"TestPingServer: error",!1,u)})}function Ee(i,u,c,d,I){try{I&&(I.onload=null,I.onerror=null,I.onabort=null,I.ontimeout=null),d(c)}catch{}}function Nf(){this.g=new pf}function Ti(i){this.i=i.Sb||null,this.h=i.ab||!1}y(Ti,ma),Ti.prototype.g=function(){return new Xr(this.i,this.h)};function Xr(i,u){Tt.call(this),this.H=i,this.o=u,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}y(Xr,Tt),n=Xr.prototype,n.open=function(i,u){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=i,this.D=u,this.readyState=1,Zn(this)},n.send=function(i){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const u={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};i&&(u.body=i),(this.H||a).fetch(new Request(this.D,u)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Jn(this)),this.readyState=0},n.Pa=function(i){if(this.g&&(this.l=i,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=i.headers,this.readyState=2,Zn(this)),this.g&&(this.readyState=3,Zn(this),this.g)))if(this.responseType==="arraybuffer")i.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in i){if(this.j=i.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Ba(this)}else i.text().then(this.Oa.bind(this),this.ga.bind(this))};function Ba(i){i.j.read().then(i.Ma.bind(i)).catch(i.ga.bind(i))}n.Ma=function(i){if(this.g){if(this.o&&i.value)this.response.push(i.value);else if(!this.o){var u=i.value?i.value:new Uint8Array(0);(u=this.B.decode(u,{stream:!i.done}))&&(this.response=this.responseText+=u)}i.done?Jn(this):Zn(this),this.readyState==3&&Ba(this)}},n.Oa=function(i){this.g&&(this.response=this.responseText=i,Jn(this))},n.Na=function(i){this.g&&(this.response=i,Jn(this))},n.ga=function(){this.g&&Jn(this)};function Jn(i){i.readyState=4,i.l=null,i.j=null,i.B=null,Zn(i)}n.setRequestHeader=function(i,u){this.A.append(i,u)},n.getResponseHeader=function(i){return this.h&&this.h.get(i.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const i=[],u=this.h.entries();for(var c=u.next();!c.done;)c=c.value,i.push(c[0]+": "+c[1]),c=u.next();return i.join(`\r
`)};function Zn(i){i.onreadystatechange&&i.onreadystatechange.call(i)}Object.defineProperty(Xr.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(i){this.m=i?"include":"same-origin"}});function ja(i){let u="";return $r(i,function(c,d){u+=d,u+=":",u+=c,u+=`\r
`}),u}function wi(i,u,c){t:{for(d in c){var d=!1;break t}d=!0}d||(c=ja(c),typeof i=="string"?c!=null&&Hn(c):J(i,u,c))}function ot(i){Tt.call(this),this.headers=new Map,this.L=i||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}y(ot,Tt);var kf=/^https?$/i,xf=["POST","PUT"];n=ot.prototype,n.Fa=function(i){this.H=i},n.ea=function(i,u,c,d){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+i);u=u?u.toUpperCase():"GET",this.D=i,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():wa.g(),this.g.onreadystatechange=v(f(this.Ca,this));try{this.B=!0,this.g.open(u,String(i),!0),this.B=!1}catch(S){qa(this,S);return}if(i=c||"",c=new Map(this.headers),d)if(Object.getPrototypeOf(d)===Object.prototype)for(var I in d)c.set(I,d[I]);else if(typeof d.keys=="function"&&typeof d.get=="function")for(const S of d.keys())c.set(S,d.get(S));else throw Error("Unknown input type for opt_headers: "+String(d));d=Array.from(c.keys()).find(S=>S.toLowerCase()=="content-type"),I=a.FormData&&i instanceof a.FormData,!(Array.prototype.indexOf.call(xf,u,void 0)>=0)||d||I||c.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[S,N]of c)this.g.setRequestHeader(S,N);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(i),this.v=!1}catch(S){qa(this,S)}};function qa(i,u){i.h=!1,i.g&&(i.j=!0,i.g.abort(),i.j=!1),i.l=u,i.o=5,$a(i),Yr(i)}function $a(i){i.A||(i.A=!0,Pt(i,"complete"),Pt(i,"error"))}n.abort=function(i){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=i||7,Pt(this,"complete"),Pt(this,"abort"),Yr(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Yr(this,!0)),ot.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?za(this):this.Xa())},n.Xa=function(){za(this)};function za(i){if(i.h&&typeof o<"u"){if(i.v&&Te(i)==4)setTimeout(i.Ca.bind(i),0);else if(Pt(i,"readystatechange"),Te(i)==4){i.h=!1;try{const S=i.ca();t:switch(S){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var u=!0;break t;default:u=!1}var c;if(!(c=u)){var d;if(d=S===0){let N=String(i.D).match(ka)[1]||null;!N&&a.self&&a.self.location&&(N=a.self.location.protocol.slice(0,-1)),d=!kf.test(N?N.toLowerCase():"")}c=d}if(c)Pt(i,"complete"),Pt(i,"success");else{i.o=6;try{var I=Te(i)>2?i.g.statusText:""}catch{I=""}i.l=I+" ["+i.ca()+"]",$a(i)}}finally{Yr(i)}}}}function Yr(i,u){if(i.g){i.m&&(clearTimeout(i.m),i.m=null);const c=i.g;i.g=null,u||Pt(i,"ready");try{c.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function Te(i){return i.g?i.g.readyState:0}n.ca=function(){try{return Te(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(i){if(this.g){var u=this.g.responseText;return i&&u.indexOf(i)==0&&(u=u.substring(i.length)),df(u)}};function Ha(i){try{if(!i.g)return null;if("response"in i.g)return i.g.response;switch(i.F){case"":case"text":return i.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in i.g)return i.g.mozResponseArrayBuffer}return null}catch{return null}}function Of(i){const u={};i=(i.g&&Te(i)>=2&&i.g.getAllResponseHeaders()||"").split(`\r
`);for(let d=0;d<i.length;d++){if(_(i[d]))continue;var c=vf(i[d]);const I=c[0];if(c=c[1],typeof c!="string")continue;c=c.trim();const S=u[I]||[];u[I]=S,S.push(c)}af(u,function(d){return d.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function tr(i,u,c){return c&&c.internalChannelParams&&c.internalChannelParams[i]||u}function Ga(i){this.za=0,this.i=[],this.j=new zn,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=tr("failFast",!1,i),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=tr("baseRetryDelayMs",5e3,i),this.Za=tr("retryDelaySeedMs",1e4,i),this.Ta=tr("forwardChannelMaxRetries",2,i),this.va=tr("forwardChannelRequestTimeoutMs",2e4,i),this.ma=i&&i.xmlHttpFactory||void 0,this.Ua=i&&i.Rb||void 0,this.Aa=i&&i.useFetchStreams||!1,this.O=void 0,this.L=i&&i.supportsCrossDomainXhr||!1,this.M="",this.h=new Ca(i&&i.concurrentRequestLimit),this.Ba=new Nf,this.S=i&&i.fastHandshake||!1,this.R=i&&i.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=i&&i.Pb||!1,i&&i.ua&&this.j.ua(),i&&i.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&i&&i.detectBufferingProxy||!1,this.ia=void 0,i&&i.longPollingTimeout&&i.longPollingTimeout>0&&(this.ia=i.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Ga.prototype,n.ka=8,n.I=1,n.connect=function(i,u,c,d){Vt(0),this.W=i,this.H=u||{},c&&d!==void 0&&(this.H.OSID=c,this.H.OAID=d),this.F=this.X,this.J=eu(this,null,this.W),Zr(this)};function Ii(i){if(Ka(i),i.I==3){var u=i.V++,c=Kt(i.J);if(J(c,"SID",i.M),J(c,"RID",u),J(c,"TYPE","terminate"),er(i,c),u=new ye(i,i.j,u),u.M=2,u.A=Qr(Kt(c)),c=!1,a.navigator&&a.navigator.sendBeacon)try{c=a.navigator.sendBeacon(u.A.toString(),"")}catch{}!c&&a.Image&&(new Image().src=u.A,c=!0),c||(u.g=nu(u.j,null),u.g.ea(u.A)),u.F=Date.now(),Wr(u)}tu(i)}function Jr(i){i.g&&(Ri(i),i.g.cancel(),i.g=null)}function Ka(i){Jr(i),i.v&&(a.clearTimeout(i.v),i.v=null),ts(i),i.h.cancel(),i.m&&(typeof i.m=="number"&&a.clearTimeout(i.m),i.m=null)}function Zr(i){if(!Pa(i.h)&&!i.m){i.m=!0;var u=i.Ea;nt||m(),rt||(nt(),rt=!0),T.add(u,i),i.D=0}}function Mf(i,u){return Va(i.h)>=i.h.j-(i.m?1:0)?!1:i.m?(i.i=u.G.concat(i.i),!0):i.I==1||i.I==2||i.D>=(i.Sa?0:i.Ta)?!1:(i.m=$n(f(i.Ea,i,u),Za(i,i.D)),i.D++,!0)}n.Ea=function(i){if(this.m)if(this.m=null,this.I==1){if(!i){this.V=Math.floor(Math.random()*1e5),i=this.V++;const I=new ye(this,this.j,i);let S=this.o;if(this.U&&(S?(S=ia(S),aa(S,this.U)):S=this.U),this.u!==null||this.R||(I.J=S,S=null),this.S)t:{for(var u=0,c=0;c<this.i.length;c++){e:{var d=this.i[c];if("__data__"in d.map&&(d=d.map.__data__,typeof d=="string")){d=d.length;break e}d=void 0}if(d===void 0)break;if(u+=d,u>4096){u=c;break t}if(u===4096||c===this.i.length-1){u=c+1;break t}}u=1e3}else u=1e3;u=Qa(this,I,u),c=Kt(this.J),J(c,"RID",i),J(c,"CVER",22),this.G&&J(c,"X-HTTP-Session-Id",this.G),er(this,c),S&&(this.R?u="headers="+Hn(ja(S))+"&"+u:this.u&&wi(c,this.u,S)),vi(this.h,I),this.Ra&&J(c,"TYPE","init"),this.S?(J(c,"$req",u),J(c,"SID","null"),I.U=!0,mi(I,c,null)):mi(I,c,u),this.I=2}}else this.I==3&&(i?Wa(this,i):this.i.length==0||Pa(this.h)||Wa(this))};function Wa(i,u){var c;u?c=u.l:c=i.V++;const d=Kt(i.J);J(d,"SID",i.M),J(d,"RID",c),J(d,"AID",i.K),er(i,d),i.u&&i.o&&wi(d,i.u,i.o),c=new ye(i,i.j,c,i.D+1),i.u===null&&(c.J=i.o),u&&(i.i=u.G.concat(i.i)),u=Qa(i,c,1e3),c.H=Math.round(i.va*.5)+Math.round(i.va*.5*Math.random()),vi(i.h,c),mi(c,d,u)}function er(i,u){i.H&&$r(i.H,function(c,d){J(u,d,c)}),i.l&&$r({},function(c,d){J(u,d,c)})}function Qa(i,u,c){c=Math.min(i.i.length,c);const d=i.l?f(i.l.Ka,i.l,i):null;t:{var I=i.i;let q=-1;for(;;){const ht=["count="+c];q==-1?c>0?(q=I[0].g,ht.push("ofs="+q)):q=0:ht.push("ofs="+q);let Y=!0;for(let pt=0;pt<c;pt++){var S=I[pt].g;const Wt=I[pt].map;if(S-=q,S<0)q=Math.max(0,I[pt].g-100),Y=!1;else try{S="req"+S+"_"||"";try{var N=Wt instanceof Map?Wt:Object.entries(Wt);for(const[$e,we]of N){let Ie=we;l(we)&&(Ie=ci(we)),ht.push(S+$e+"="+encodeURIComponent(Ie))}}catch($e){throw ht.push(S+"type="+encodeURIComponent("_badmap")),$e}}catch{d&&d(Wt)}}if(Y){N=ht.join("&");break t}}N=void 0}return i=i.i.splice(0,c),u.G=i,N}function Xa(i){if(!i.g&&!i.v){i.Y=1;var u=i.Da;nt||m(),rt||(nt(),rt=!0),T.add(u,i),i.A=0}}function Ai(i){return i.g||i.v||i.A>=3?!1:(i.Y++,i.v=$n(f(i.Da,i),Za(i,i.A)),i.A++,!0)}n.Da=function(){if(this.v=null,Ya(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var i=4*this.T;this.j.info("BP detection timer enabled: "+i),this.B=$n(f(this.Wa,this),i)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Vt(10),Jr(this),Ya(this))};function Ri(i){i.B!=null&&(a.clearTimeout(i.B),i.B=null)}function Ya(i){i.g=new ye(i,i.j,"rpc",i.Y),i.u===null&&(i.g.J=i.o),i.g.P=0;var u=Kt(i.na);J(u,"RID","rpc"),J(u,"SID",i.M),J(u,"AID",i.K),J(u,"CI",i.F?"0":"1"),!i.F&&i.ia&&J(u,"TO",i.ia),J(u,"TYPE","xmlhttp"),er(i,u),i.u&&i.o&&wi(u,i.u,i.o),i.O&&(i.g.H=i.O);var c=i.g;i=i.ba,c.M=1,c.A=Qr(Kt(u)),c.u=null,c.R=!0,Ra(c,i)}n.Va=function(){this.C!=null&&(this.C=null,Jr(this),Ai(this),Vt(19))};function ts(i){i.C!=null&&(a.clearTimeout(i.C),i.C=null)}function Ja(i,u){var c=null;if(i.g==u){ts(i),Ri(i),i.g=null;var d=2}else if(yi(i.h,u))c=u.G,Da(i.h,u),d=1;else return;if(i.I!=0){if(u.o)if(d==1){c=u.u?u.u.length:0,u=Date.now()-u.F;var I=i.D;d=Gr(),Pt(d,new Ea(d,c)),Zr(i)}else Xa(i);else if(I=u.m,I==3||I==0&&u.X>0||!(d==1&&Mf(i,u)||d==2&&Ai(i)))switch(c&&c.length>0&&(u=i.h,u.i=u.i.concat(c)),I){case 1:qe(i,5);break;case 4:qe(i,10);break;case 3:qe(i,6);break;default:qe(i,2)}}}function Za(i,u){let c=i.Qa+Math.floor(Math.random()*i.Za);return i.isActive()||(c*=2),c*u}function qe(i,u){if(i.j.info("Error code "+u),u==2){var c=f(i.bb,i),d=i.Ua;const I=!d;d=new ve(d||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Kn(d,"https"),Qr(d),I?Vf(d.toString(),c):Df(d.toString(),c)}else Vt(2);i.I=0,i.l&&i.l.pa(u),tu(i),Ka(i)}n.bb=function(i){i?(this.j.info("Successfully pinged google.com"),Vt(2)):(this.j.info("Failed to ping google.com"),Vt(1))};function tu(i){if(i.I=0,i.ja=[],i.l){const u=Na(i.h);(u.length!=0||i.i.length!=0)&&(C(i.ja,u),C(i.ja,i.i),i.h.i.length=0,R(i.i),i.i.length=0),i.l.oa()}}function eu(i,u,c){var d=c instanceof ve?Kt(c):new ve(c);if(d.g!="")u&&(d.g=u+"."+d.g),Wn(d,d.u);else{var I=a.location;d=I.protocol,u=u?u+"."+I.hostname:I.hostname,I=+I.port;const S=new ve(null);d&&Kn(S,d),u&&(S.g=u),I&&Wn(S,I),c&&(S.h=c),d=S}return c=i.G,u=i.wa,c&&u&&J(d,c,u),J(d,"VER",i.ka),er(i,d),d}function nu(i,u,c){if(u&&!i.L)throw Error("Can't create secondary domain capable XhrIo object.");return u=i.Aa&&!i.ma?new ot(new Ti({ab:c})):new ot(i.ma),u.Fa(i.L),u}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function ru(){}n=ru.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function es(){}es.prototype.g=function(i,u){return new Lt(i,u)};function Lt(i,u){Tt.call(this),this.g=new Ga(u),this.l=i,this.h=u&&u.messageUrlParams||null,i=u&&u.messageHeaders||null,u&&u.clientProtocolHeaderRequired&&(i?i["X-Client-Protocol"]="webchannel":i={"X-Client-Protocol":"webchannel"}),this.g.o=i,i=u&&u.initMessageHeaders||null,u&&u.messageContentType&&(i?i["X-WebChannel-Content-Type"]=u.messageContentType:i={"X-WebChannel-Content-Type":u.messageContentType}),u&&u.sa&&(i?i["X-WebChannel-Client-Profile"]=u.sa:i={"X-WebChannel-Client-Profile":u.sa}),this.g.U=i,(i=u&&u.Qb)&&!_(i)&&(this.g.u=i),this.A=u&&u.supportsCrossDomainXhr||!1,this.v=u&&u.sendRawJson||!1,(u=u&&u.httpSessionIdParam)&&!_(u)&&(this.g.G=u,i=this.h,i!==null&&u in i&&(i=this.h,u in i&&delete i[u])),this.j=new fn(this)}y(Lt,Tt),Lt.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Lt.prototype.close=function(){Ii(this.g)},Lt.prototype.o=function(i){var u=this.g;if(typeof i=="string"){var c={};c.__data__=i,i=c}else this.v&&(c={},c.__data__=ci(i),i=c);u.i.push(new wf(u.Ya++,i)),u.I==3&&Zr(u)},Lt.prototype.N=function(){this.g.l=null,delete this.j,Ii(this.g),delete this.g,Lt.Z.N.call(this)};function su(i){hi.call(this),i.__headers__&&(this.headers=i.__headers__,this.statusCode=i.__status__,delete i.__headers__,delete i.__status__);var u=i.__sm__;if(u){t:{for(const c in u){i=c;break t}i=void 0}(this.i=i)&&(i=this.i,u=u!==null&&i in u?u[i]:void 0),this.data=u}else this.data=i}y(su,hi);function iu(){fi.call(this),this.status=1}y(iu,fi);function fn(i){this.g=i}y(fn,ru),fn.prototype.ra=function(){Pt(this.g,"a")},fn.prototype.qa=function(i){Pt(this.g,new su(i))},fn.prototype.pa=function(i){Pt(this.g,new iu)},fn.prototype.oa=function(){Pt(this.g,"b")},es.prototype.createWebChannel=es.prototype.g,Lt.prototype.send=Lt.prototype.o,Lt.prototype.open=Lt.prototype.m,Lt.prototype.close=Lt.prototype.close,Dc=function(){return new es},Vc=function(){return Gr()},Pc=Ue,Zi={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Kr.NO_ERROR=0,Kr.TIMEOUT=8,Kr.HTTP_ERROR=6,cs=Kr,Ta.COMPLETE="complete",Cc=Ta,ga.EventType=jn,jn.OPEN="a",jn.CLOSE="b",jn.ERROR="c",jn.MESSAGE="d",Tt.prototype.listen=Tt.prototype.J,sr=ga,ot.prototype.listenOnce=ot.prototype.K,ot.prototype.getLastError=ot.prototype.Ha,ot.prototype.getLastErrorCode=ot.prototype.ya,ot.prototype.getStatus=ot.prototype.ca,ot.prototype.getResponseJson=ot.prototype.La,ot.prototype.getResponseText=ot.prototype.la,ot.prototype.send=ot.prototype.ea,ot.prototype.setWithCredentials=ot.prototype.Fa,bc=ot}).apply(typeof ss<"u"?ss:typeof self<"u"?self:typeof window<"u"?window:{});const Nu="@firebase/firestore",ku="4.9.2";class At{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}At.UNAUTHENTICATED=new At(null),At.GOOGLE_CREDENTIALS=new At("google-credentials-uid"),At.FIRST_PARTY=new At("first-party-uid"),At.MOCK_USER=new At("mock-user");let Mn="12.3.0";const en=new Ec("@firebase/firestore");function pn(){return en.logLevel}function k(n,...t){if(en.logLevel<=G.DEBUG){const e=t.map(Do);en.debug(`Firestore (${Mn}): ${n}`,...e)}}function fe(n,...t){if(en.logLevel<=G.ERROR){const e=t.map(Do);en.error(`Firestore (${Mn}): ${n}`,...e)}}function bn(n,...t){if(en.logLevel<=G.WARN){const e=t.map(Do);en.warn(`Firestore (${Mn}): ${n}`,...e)}}function Do(n){if(typeof n=="string")return n;try{return(function(e){return JSON.stringify(e)})(n)}catch{return n}}function U(n,t,e){let r="Unexpected state";typeof t=="string"?r=t:e=t,Nc(n,r,e)}function Nc(n,t,e){let r=`FIRESTORE (${Mn}) INTERNAL ASSERTION FAILED: ${t} (ID: ${n.toString(16)})`;if(e!==void 0)try{r+=" CONTEXT: "+JSON.stringify(e)}catch{r+=" CONTEXT: "+e}throw fe(r),new Error(r)}function Q(n,t,e,r){let s="Unexpected state";typeof e=="string"?s=e:r=e,n||Nc(t,s,r)}function j(n,t){return n}const P={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class x extends On{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Ye{constructor(){this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}}class kc{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class Gm{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable((()=>e(At.UNAUTHENTICATED)))}shutdown(){}}class Km{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable((()=>e(this.token.user)))}shutdown(){this.changeListener=null}}class Wm{constructor(t){this.t=t,this.currentUser=At.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){Q(this.o===void 0,42304);let r=this.i;const s=h=>this.i!==r?(r=this.i,e(h)):Promise.resolve();let o=new Ye;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new Ye,t.enqueueRetryable((()=>s(this.currentUser)))};const a=()=>{const h=o;t.enqueueRetryable((async()=>{await h.promise,await s(this.currentUser)}))},l=h=>{k("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit((h=>l(h))),setTimeout((()=>{if(!this.auth){const h=this.t.getImmediate({optional:!0});h?l(h):(k("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Ye)}}),0),a()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then((r=>this.i!==t?(k("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Q(typeof r.accessToken=="string",31837,{l:r}),new kc(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const t=this.auth&&this.auth.getUid();return Q(t===null||typeof t=="string",2055,{h:t}),new At(t)}}class Qm{constructor(t,e,r){this.P=t,this.T=e,this.I=r,this.type="FirstParty",this.user=At.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const t=this.R();return t&&this.A.set("Authorization",t),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class Xm{constructor(t,e,r){this.P=t,this.T=e,this.I=r}getToken(){return Promise.resolve(new Qm(this.P,this.T,this.I))}start(t,e){t.enqueueRetryable((()=>e(At.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class xu{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Ym{constructor(t,e){this.V=e,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Dm(t)&&t.settings.appCheckToken&&(this.p=t.settings.appCheckToken)}start(t,e){Q(this.o===void 0,3512);const r=o=>{o.error!=null&&k("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const a=o.token!==this.m;return this.m=o.token,k("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?e(o.token):Promise.resolve()};this.o=o=>{t.enqueueRetryable((()=>r(o)))};const s=o=>{k("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((o=>s(o))),setTimeout((()=>{if(!this.appCheck){const o=this.V.getImmediate({optional:!0});o?s(o):k("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new xu(this.p));const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then((e=>e?(Q(typeof e.token=="string",44558,{tokenResult:e}),this.m=e.token,new xu(e.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function Jm(n){const t=typeof self<"u"&&(self.crypto||self.msCrypto),e=new Uint8Array(n);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(e);else for(let r=0;r<n;r++)e[r]=Math.floor(256*Math.random());return e}class No{static newId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=Jm(40);for(let o=0;o<s.length;++o)r.length<20&&s[o]<e&&(r+=t.charAt(s[o]%62))}return r}}function $(n,t){return n<t?-1:n>t?1:0}function to(n,t){const e=Math.min(n.length,t.length);for(let r=0;r<e;r++){const s=n.charAt(r),o=t.charAt(r);if(s!==o)return Li(s)===Li(o)?$(s,o):Li(s)?1:-1}return $(n.length,t.length)}const Zm=55296,tg=57343;function Li(n){const t=n.charCodeAt(0);return t>=Zm&&t<=tg}function Cn(n,t,e){return n.length===t.length&&n.every(((r,s)=>e(r,t[s])))}const Ou="__name__";class Xt{constructor(t,e,r){e===void 0?e=0:e>t.length&&U(637,{offset:e,range:t.length}),r===void 0?r=t.length-e:r>t.length-e&&U(1746,{length:r,range:t.length-e}),this.segments=t,this.offset=e,this.len=r}get length(){return this.len}isEqual(t){return Xt.comparator(this,t)===0}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof Xt?t.forEach((r=>{e.push(r)})):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,r=this.limit();e<r;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const r=Math.min(t.length,e.length);for(let s=0;s<r;s++){const o=Xt.compareSegments(t.get(s),e.get(s));if(o!==0)return o}return $(t.length,e.length)}static compareSegments(t,e){const r=Xt.isNumericId(t),s=Xt.isNumericId(e);return r&&!s?-1:!r&&s?1:r&&s?Xt.extractNumericId(t).compare(Xt.extractNumericId(e)):to(t,e)}static isNumericId(t){return t.startsWith("__id")&&t.endsWith("__")}static extractNumericId(t){return De.fromString(t.substring(4,t.length-2))}}class tt extends Xt{construct(t,e,r){return new tt(t,e,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const e=[];for(const r of t){if(r.indexOf("//")>=0)throw new x(P.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);e.push(...r.split("/").filter((s=>s.length>0)))}return new tt(e)}static emptyPath(){return new tt([])}}const eg=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class yt extends Xt{construct(t,e,r){return new yt(t,e,r)}static isValidIdentifier(t){return eg.test(t)}canonicalString(){return this.toArray().map((t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),yt.isValidIdentifier(t)||(t="`"+t+"`"),t))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Ou}static keyField(){return new yt([Ou])}static fromServerFormat(t){const e=[];let r="",s=0;const o=()=>{if(r.length===0)throw new x(P.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(r),r=""};let a=!1;for(;s<t.length;){const l=t[s];if(l==="\\"){if(s+1===t.length)throw new x(P.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const h=t[s+1];if(h!=="\\"&&h!=="."&&h!=="`")throw new x(P.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=h,s+=2}else l==="`"?(a=!a,s++):l!=="."||a?(r+=l,s++):(o(),s++)}if(o(),a)throw new x(P.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new yt(e)}static emptyPath(){return new yt([])}}class L{constructor(t){this.path=t}static fromPath(t){return new L(tt.fromString(t))}static fromName(t){return new L(tt.fromString(t).popFirst(5))}static empty(){return new L(tt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return t!==null&&tt.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,e){return tt.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new L(new tt(t.slice()))}}function xc(n,t,e){if(!e)throw new x(P.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${t}.`)}function ng(n,t,e,r){if(t===!0&&r===!0)throw new x(P.INVALID_ARGUMENT,`${n} and ${e} cannot be used together.`)}function Mu(n){if(!L.isDocumentKey(n))throw new x(P.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function Lu(n){if(L.isDocumentKey(n))throw new x(P.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Oc(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function ko(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const t=(function(r){return r.constructor?r.constructor.name:null})(n);return t?`a custom ${t} object`:"an object"}}return typeof n=="function"?"a function":U(12329,{type:typeof n})}function pr(n,t){if("_delegate"in n&&(n=n._delegate),!(n instanceof t)){if(t.name===n.constructor.name)throw new x(P.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const e=ko(n);throw new x(P.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${e}`)}}return n}function ct(n,t){const e={typeString:n};return t&&(e.value=t),e}function Lr(n,t){if(!Oc(n))throw new x(P.INVALID_ARGUMENT,"JSON must be an object");let e;for(const r in t)if(t[r]){const s=t[r].typeString,o="value"in t[r]?{value:t[r].value}:void 0;if(!(r in n)){e=`JSON missing required field: '${r}'`;break}const a=n[r];if(s&&typeof a!==s){e=`JSON field '${r}' must be a ${s}.`;break}if(o!==void 0&&a!==o.value){e=`Expected '${r}' field to equal '${o.value}'`;break}}if(e)throw new x(P.INVALID_ARGUMENT,e);return!0}const Fu=-62135596800,Uu=1e6;class et{static now(){return et.fromMillis(Date.now())}static fromDate(t){return et.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),r=Math.floor((t-1e3*e)*Uu);return new et(e,r)}constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new x(P.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new x(P.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<Fu)throw new x(P.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new x(P.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Uu}_compareTo(t){return this.seconds===t.seconds?$(this.nanoseconds,t.nanoseconds):$(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:et._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(t){if(Lr(t,et._jsonSchema))return new et(t.seconds,t.nanoseconds)}valueOf(){const t=this.seconds-Fu;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}et._jsonSchemaVersion="firestore/timestamp/1.0",et._jsonSchema={type:ct("string",et._jsonSchemaVersion),seconds:ct("number"),nanoseconds:ct("number")};class B{static fromTimestamp(t){return new B(t)}static min(){return new B(new et(0,0))}static max(){return new B(new et(253402300799,999999999))}constructor(t){this.timestamp=t}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const br=-1;function rg(n,t){const e=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,s=B.fromTimestamp(r===1e9?new et(e+1,0):new et(e,r));return new ke(s,L.empty(),t)}function sg(n){return new ke(n.readTime,n.key,br)}class ke{constructor(t,e,r){this.readTime=t,this.documentKey=e,this.largestBatchId=r}static min(){return new ke(B.min(),L.empty(),br)}static max(){return new ke(B.max(),L.empty(),br)}}function ig(n,t){let e=n.readTime.compareTo(t.readTime);return e!==0?e:(e=L.comparator(n.documentKey,t.documentKey),e!==0?e:$(n.largestBatchId,t.largestBatchId))}const og="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class ag{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((t=>t()))}}async function Ln(n){if(n.code!==P.FAILED_PRECONDITION||n.message!==og)throw n;k("LocalStore","Unexpectedly lost primary lease")}class b{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&U(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new b(((r,s)=>{this.nextCallback=o=>{this.wrapSuccess(t,o).next(r,s)},this.catchCallback=o=>{this.wrapFailure(e,o).next(r,s)}}))}toPromise(){return new Promise(((t,e)=>{this.next(t,e)}))}wrapUserFunction(t){try{const e=t();return e instanceof b?e:b.resolve(e)}catch(e){return b.reject(e)}}wrapSuccess(t,e){return t?this.wrapUserFunction((()=>t(e))):b.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction((()=>t(e))):b.reject(e)}static resolve(t){return new b(((e,r)=>{e(t)}))}static reject(t){return new b(((e,r)=>{r(t)}))}static waitFor(t){return new b(((e,r)=>{let s=0,o=0,a=!1;t.forEach((l=>{++s,l.next((()=>{++o,a&&o===s&&e()}),(h=>r(h)))})),a=!0,o===s&&e()}))}static or(t){let e=b.resolve(!1);for(const r of t)e=e.next((s=>s?b.resolve(s):r()));return e}static forEach(t,e){const r=[];return t.forEach(((s,o)=>{r.push(e.call(this,s,o))})),this.waitFor(r)}static mapArray(t,e){return new b(((r,s)=>{const o=t.length,a=new Array(o);let l=0;for(let h=0;h<o;h++){const f=h;e(t[f]).next((p=>{a[f]=p,++l,l===o&&r(a)}),(p=>s(p)))}}))}static doWhile(t,e){return new b(((r,s)=>{const o=()=>{t()===!0?e().next((()=>{o()}),s):r()};o()}))}}function ug(n){const t=n.match(/Android ([\d.]+)/i),e=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(e)}function Fn(n){return n.name==="IndexedDbTransactionError"}class $s{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>e.writeSequenceNumber(r))}ae(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ue&&this.ue(t),t}}$s.ce=-1;const xo=-1;function zs(n){return n==null}function Is(n){return n===0&&1/n==-1/0}function lg(n){return typeof n=="number"&&Number.isInteger(n)&&!Is(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const Mc="";function cg(n){let t="";for(let e=0;e<n.length;e++)t.length>0&&(t=Bu(t)),t=hg(n.get(e),t);return Bu(t)}function hg(n,t){let e=t;const r=n.length;for(let s=0;s<r;s++){const o=n.charAt(s);switch(o){case"\0":e+="";break;case Mc:e+="";break;default:e+=o}}return e}function Bu(n){return n+Mc+""}function ju(n){let t=0;for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&t++;return t}function on(n,t){for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&t(e,n[e])}function Lc(n){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t))return!1;return!0}class it{constructor(t,e){this.comparator=t,this.root=e||_t.EMPTY}insert(t,e){return new it(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,_t.BLACK,null,null))}remove(t){return new it(this.comparator,this.root.remove(t,this.comparator).copy(null,null,_t.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const r=this.comparator(t,e.key);if(r===0)return e.value;r<0?e=e.left:r>0&&(e=e.right)}return null}indexOf(t){let e=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(t,r.key);if(s===0)return e+r.left.size;s<0?r=r.left:(e+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal(((e,r)=>(t(e,r),!1)))}toString(){const t=[];return this.inorderTraversal(((e,r)=>(t.push(`${e}:${r}`),!1))),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new is(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new is(this.root,t,this.comparator,!1)}getReverseIterator(){return new is(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new is(this.root,t,this.comparator,!0)}}class is{constructor(t,e,r,s){this.isReverse=s,this.nodeStack=[];let o=1;for(;!t.isEmpty();)if(o=e?r(t.key,e):1,e&&s&&(o*=-1),o<0)t=this.isReverse?t.left:t.right;else{if(o===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class _t{constructor(t,e,r,s,o){this.key=t,this.value=e,this.color=r??_t.RED,this.left=s??_t.EMPTY,this.right=o??_t.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,r,s,o){return new _t(t??this.key,e??this.value,r??this.color,s??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,r){let s=this;const o=r(t,s.key);return s=o<0?s.copy(null,null,null,s.left.insert(t,e,r),null):o===0?s.copy(null,e,null,null,null):s.copy(null,null,null,null,s.right.insert(t,e,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return _t.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let r,s=this;if(e(t,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(t,e),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),e(t,s.key)===0){if(s.right.isEmpty())return _t.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(t,e))}return s.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,_t.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,_t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw U(43730,{key:this.key,value:this.value});if(this.right.isRed())throw U(14113,{key:this.key,value:this.value});const t=this.left.check();if(t!==this.right.check())throw U(27949);return t+(this.isRed()?0:1)}}_t.EMPTY=null,_t.RED=!0,_t.BLACK=!1;_t.EMPTY=new class{constructor(){this.size=0}get key(){throw U(57766)}get value(){throw U(16141)}get color(){throw U(16727)}get left(){throw U(29726)}get right(){throw U(36894)}copy(t,e,r,s,o){return this}insert(t,e,r){return new _t(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class dt{constructor(t){this.comparator=t,this.data=new it(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal(((e,r)=>(t(e),!1)))}forEachInRange(t,e){const r=this.data.getIteratorFrom(t[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,t[1])>=0)return;e(s.key)}}forEachWhile(t,e){let r;for(r=e!==void 0?this.data.getIteratorFrom(e):this.data.getIterator();r.hasNext();)if(!t(r.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new qu(this.data.getIterator())}getIteratorFrom(t){return new qu(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach((r=>{e=e.add(r)})),e}isEqual(t){if(!(t instanceof dt)||this.size!==t.size)return!1;const e=this.data.getIterator(),r=t.data.getIterator();for(;e.hasNext();){const s=e.getNext().key,o=r.getNext().key;if(this.comparator(s,o)!==0)return!1}return!0}toArray(){const t=[];return this.forEach((e=>{t.push(e)})),t}toString(){const t=[];return this.forEach((e=>t.push(e))),"SortedSet("+t.toString()+")"}copy(t){const e=new dt(this.comparator);return e.data=t,e}}class qu{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Ht{constructor(t){this.fields=t,t.sort(yt.comparator)}static empty(){return new Ht([])}unionWith(t){let e=new dt(yt.comparator);for(const r of this.fields)e=e.add(r);for(const r of t)e=e.add(r);return new Ht(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return Cn(this.fields,t.fields,((e,r)=>e.isEqual(r)))}}class Fc extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class vt{constructor(t){this.binaryString=t}static fromBase64String(t){const e=(function(s){try{return atob(s)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new Fc("Invalid base64 string: "+o):o}})(t);return new vt(e)}static fromUint8Array(t){const e=(function(s){let o="";for(let a=0;a<s.length;++a)o+=String.fromCharCode(s[a]);return o})(t);return new vt(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(e){return btoa(e)})(this.binaryString)}toUint8Array(){return(function(e){const r=new Uint8Array(e.length);for(let s=0;s<e.length;s++)r[s]=e.charCodeAt(s);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return $(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}vt.EMPTY_BYTE_STRING=new vt("");const fg=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function xe(n){if(Q(!!n,39018),typeof n=="string"){let t=0;const e=fg.exec(n);if(Q(!!e,46558,{timestamp:n}),e[1]){let s=e[1];s=(s+"000000000").substr(0,9),t=Number(s)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:at(n.seconds),nanos:at(n.nanos)}}function at(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Oe(n){return typeof n=="string"?vt.fromBase64String(n):vt.fromUint8Array(n)}const Uc="server_timestamp",Bc="__type__",jc="__previous_value__",qc="__local_write_time__";function Oo(n){return(n?.mapValue?.fields||{})[Bc]?.stringValue===Uc}function Hs(n){const t=n.mapValue.fields[jc];return Oo(t)?Hs(t):t}function Cr(n){const t=xe(n.mapValue.fields[qc].timestampValue);return new et(t.seconds,t.nanos)}class dg{constructor(t,e,r,s,o,a,l,h,f,p){this.databaseId=t,this.appId=e,this.persistenceKey=r,this.host=s,this.ssl=o,this.forceLongPolling=a,this.autoDetectLongPolling=l,this.longPollingOptions=h,this.useFetchStreams=f,this.isUsingEmulator=p}}const As="(default)";class Pr{constructor(t,e){this.projectId=t,this.database=e||As}static empty(){return new Pr("","")}get isDefaultDatabase(){return this.database===As}isEqual(t){return t instanceof Pr&&t.projectId===this.projectId&&t.database===this.database}}const $c="__type__",pg="__max__",os={mapValue:{}},zc="__vector__",Rs="value";function Me(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Oo(n)?4:gg(n)?9007199254740991:mg(n)?10:11:U(28295,{value:n})}function ie(n,t){if(n===t)return!0;const e=Me(n);if(e!==Me(t))return!1;switch(e){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===t.booleanValue;case 4:return Cr(n).isEqual(Cr(t));case 3:return(function(s,o){if(typeof s.timestampValue=="string"&&typeof o.timestampValue=="string"&&s.timestampValue.length===o.timestampValue.length)return s.timestampValue===o.timestampValue;const a=xe(s.timestampValue),l=xe(o.timestampValue);return a.seconds===l.seconds&&a.nanos===l.nanos})(n,t);case 5:return n.stringValue===t.stringValue;case 6:return(function(s,o){return Oe(s.bytesValue).isEqual(Oe(o.bytesValue))})(n,t);case 7:return n.referenceValue===t.referenceValue;case 8:return(function(s,o){return at(s.geoPointValue.latitude)===at(o.geoPointValue.latitude)&&at(s.geoPointValue.longitude)===at(o.geoPointValue.longitude)})(n,t);case 2:return(function(s,o){if("integerValue"in s&&"integerValue"in o)return at(s.integerValue)===at(o.integerValue);if("doubleValue"in s&&"doubleValue"in o){const a=at(s.doubleValue),l=at(o.doubleValue);return a===l?Is(a)===Is(l):isNaN(a)&&isNaN(l)}return!1})(n,t);case 9:return Cn(n.arrayValue.values||[],t.arrayValue.values||[],ie);case 10:case 11:return(function(s,o){const a=s.mapValue.fields||{},l=o.mapValue.fields||{};if(ju(a)!==ju(l))return!1;for(const h in a)if(a.hasOwnProperty(h)&&(l[h]===void 0||!ie(a[h],l[h])))return!1;return!0})(n,t);default:return U(52216,{left:n})}}function Vr(n,t){return(n.values||[]).find((e=>ie(e,t)))!==void 0}function Pn(n,t){if(n===t)return 0;const e=Me(n),r=Me(t);if(e!==r)return $(e,r);switch(e){case 0:case 9007199254740991:return 0;case 1:return $(n.booleanValue,t.booleanValue);case 2:return(function(o,a){const l=at(o.integerValue||o.doubleValue),h=at(a.integerValue||a.doubleValue);return l<h?-1:l>h?1:l===h?0:isNaN(l)?isNaN(h)?0:-1:1})(n,t);case 3:return $u(n.timestampValue,t.timestampValue);case 4:return $u(Cr(n),Cr(t));case 5:return to(n.stringValue,t.stringValue);case 6:return(function(o,a){const l=Oe(o),h=Oe(a);return l.compareTo(h)})(n.bytesValue,t.bytesValue);case 7:return(function(o,a){const l=o.split("/"),h=a.split("/");for(let f=0;f<l.length&&f<h.length;f++){const p=$(l[f],h[f]);if(p!==0)return p}return $(l.length,h.length)})(n.referenceValue,t.referenceValue);case 8:return(function(o,a){const l=$(at(o.latitude),at(a.latitude));return l!==0?l:$(at(o.longitude),at(a.longitude))})(n.geoPointValue,t.geoPointValue);case 9:return zu(n.arrayValue,t.arrayValue);case 10:return(function(o,a){const l=o.fields||{},h=a.fields||{},f=l[Rs]?.arrayValue,p=h[Rs]?.arrayValue,y=$(f?.values?.length||0,p?.values?.length||0);return y!==0?y:zu(f,p)})(n.mapValue,t.mapValue);case 11:return(function(o,a){if(o===os.mapValue&&a===os.mapValue)return 0;if(o===os.mapValue)return 1;if(a===os.mapValue)return-1;const l=o.fields||{},h=Object.keys(l),f=a.fields||{},p=Object.keys(f);h.sort(),p.sort();for(let y=0;y<h.length&&y<p.length;++y){const v=to(h[y],p[y]);if(v!==0)return v;const R=Pn(l[h[y]],f[p[y]]);if(R!==0)return R}return $(h.length,p.length)})(n.mapValue,t.mapValue);default:throw U(23264,{he:e})}}function $u(n,t){if(typeof n=="string"&&typeof t=="string"&&n.length===t.length)return $(n,t);const e=xe(n),r=xe(t),s=$(e.seconds,r.seconds);return s!==0?s:$(e.nanos,r.nanos)}function zu(n,t){const e=n.values||[],r=t.values||[];for(let s=0;s<e.length&&s<r.length;++s){const o=Pn(e[s],r[s]);if(o)return o}return $(e.length,r.length)}function Vn(n){return eo(n)}function eo(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(e){const r=xe(e);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(e){return Oe(e).toBase64()})(n.bytesValue):"referenceValue"in n?(function(e){return L.fromName(e).toString()})(n.referenceValue):"geoPointValue"in n?(function(e){return`geo(${e.latitude},${e.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(e){let r="[",s=!0;for(const o of e.values||[])s?s=!1:r+=",",r+=eo(o);return r+"]"})(n.arrayValue):"mapValue"in n?(function(e){const r=Object.keys(e.fields||{}).sort();let s="{",o=!0;for(const a of r)o?o=!1:s+=",",s+=`${a}:${eo(e.fields[a])}`;return s+"}"})(n.mapValue):U(61005,{value:n})}function hs(n){switch(Me(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=Hs(n);return t?16+hs(t):16;case 5:return 2*n.stringValue.length;case 6:return Oe(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((s,o)=>s+hs(o)),0)})(n.arrayValue);case 10:case 11:return(function(r){let s=0;return on(r.fields,((o,a)=>{s+=o.length+hs(a)})),s})(n.mapValue);default:throw U(13486,{value:n})}}function no(n){return!!n&&"integerValue"in n}function Mo(n){return!!n&&"arrayValue"in n}function Hu(n){return!!n&&"nullValue"in n}function Gu(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function fs(n){return!!n&&"mapValue"in n}function mg(n){return(n?.mapValue?.fields||{})[$c]?.stringValue===zc}function mr(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const t={mapValue:{fields:{}}};return on(n.mapValue.fields,((e,r)=>t.mapValue.fields[e]=mr(r))),t}if(n.arrayValue){const t={arrayValue:{values:[]}};for(let e=0;e<(n.arrayValue.values||[]).length;++e)t.arrayValue.values[e]=mr(n.arrayValue.values[e]);return t}return{...n}}function gg(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===pg}class qt{constructor(t){this.value=t}static empty(){return new qt({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let r=0;r<t.length-1;++r)if(e=(e.mapValue.fields||{})[t.get(r)],!fs(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=mr(e)}setAll(t){let e=yt.emptyPath(),r={},s=[];t.forEach(((a,l)=>{if(!e.isImmediateParentOf(l)){const h=this.getFieldsMap(e);this.applyChanges(h,r,s),r={},s=[],e=l.popLast()}a?r[l.lastSegment()]=mr(a):s.push(l.lastSegment())}));const o=this.getFieldsMap(e);this.applyChanges(o,r,s)}delete(t){const e=this.field(t.popLast());fs(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return ie(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let r=0;r<t.length;++r){let s=e.mapValue.fields[t.get(r)];fs(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},e.mapValue.fields[t.get(r)]=s),e=s}return e.mapValue.fields}applyChanges(t,e,r){on(e,((s,o)=>t[s]=o));for(const s of r)delete t[s]}clone(){return new qt(mr(this.value))}}function Hc(n){const t=[];return on(n.fields,((e,r)=>{const s=new yt([e]);if(fs(r)){const o=Hc(r.mapValue).fields;if(o.length===0)t.push(s);else for(const a of o)t.push(s.child(a))}else t.push(s)})),new Ht(t)}class Rt{constructor(t,e,r,s,o,a,l){this.key=t,this.documentType=e,this.version=r,this.readTime=s,this.createTime=o,this.data=a,this.documentState=l}static newInvalidDocument(t){return new Rt(t,0,B.min(),B.min(),B.min(),qt.empty(),0)}static newFoundDocument(t,e,r,s){return new Rt(t,1,e,B.min(),r,s,0)}static newNoDocument(t,e){return new Rt(t,2,e,B.min(),B.min(),qt.empty(),0)}static newUnknownDocument(t,e){return new Rt(t,3,e,B.min(),B.min(),qt.empty(),2)}convertToFoundDocument(t,e){return!this.createTime.isEqual(B.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=t),this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=qt.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=qt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=B.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof Rt&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new Rt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Ss{constructor(t,e){this.position=t,this.inclusive=e}}function Ku(n,t,e){let r=0;for(let s=0;s<n.position.length;s++){const o=t[s],a=n.position[s];if(o.field.isKeyField()?r=L.comparator(L.fromName(a.referenceValue),e.key):r=Pn(a,e.data.field(o.field)),o.dir==="desc"&&(r*=-1),r!==0)break}return r}function Wu(n,t){if(n===null)return t===null;if(t===null||n.inclusive!==t.inclusive||n.position.length!==t.position.length)return!1;for(let e=0;e<n.position.length;e++)if(!ie(n.position[e],t.position[e]))return!1;return!0}class bs{constructor(t,e="asc"){this.field=t,this.dir=e}}function _g(n,t){return n.dir===t.dir&&n.field.isEqual(t.field)}class Gc{}class ft extends Gc{constructor(t,e,r){super(),this.field=t,this.op=e,this.value=r}static create(t,e,r){return t.isKeyField()?e==="in"||e==="not-in"?this.createKeyFieldInFilter(t,e,r):new vg(t,e,r):e==="array-contains"?new wg(t,r):e==="in"?new Ig(t,r):e==="not-in"?new Ag(t,r):e==="array-contains-any"?new Rg(t,r):new ft(t,e,r)}static createKeyFieldInFilter(t,e,r){return e==="in"?new Eg(t,r):new Tg(t,r)}matches(t){const e=t.data.field(this.field);return this.op==="!="?e!==null&&e.nullValue===void 0&&this.matchesComparison(Pn(e,this.value)):e!==null&&Me(this.value)===Me(e)&&this.matchesComparison(Pn(e,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return t===0;case"!=":return t!==0;case">":return t>0;case">=":return t>=0;default:return U(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class oe extends Gc{constructor(t,e){super(),this.filters=t,this.op=e,this.Pe=null}static create(t,e){return new oe(t,e)}matches(t){return Kc(this)?this.filters.find((e=>!e.matches(t)))===void 0:this.filters.find((e=>e.matches(t)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((t,e)=>t.concat(e.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Kc(n){return n.op==="and"}function Wc(n){return yg(n)&&Kc(n)}function yg(n){for(const t of n.filters)if(t instanceof oe)return!1;return!0}function ro(n){if(n instanceof ft)return n.field.canonicalString()+n.op.toString()+Vn(n.value);if(Wc(n))return n.filters.map((t=>ro(t))).join(",");{const t=n.filters.map((e=>ro(e))).join(",");return`${n.op}(${t})`}}function Qc(n,t){return n instanceof ft?(function(r,s){return s instanceof ft&&r.op===s.op&&r.field.isEqual(s.field)&&ie(r.value,s.value)})(n,t):n instanceof oe?(function(r,s){return s instanceof oe&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce(((o,a,l)=>o&&Qc(a,s.filters[l])),!0):!1})(n,t):void U(19439)}function Xc(n){return n instanceof ft?(function(e){return`${e.field.canonicalString()} ${e.op} ${Vn(e.value)}`})(n):n instanceof oe?(function(e){return e.op.toString()+" {"+e.getFilters().map(Xc).join(" ,")+"}"})(n):"Filter"}class vg extends ft{constructor(t,e,r){super(t,e,r),this.key=L.fromName(r.referenceValue)}matches(t){const e=L.comparator(t.key,this.key);return this.matchesComparison(e)}}class Eg extends ft{constructor(t,e){super(t,"in",e),this.keys=Yc("in",e)}matches(t){return this.keys.some((e=>e.isEqual(t.key)))}}class Tg extends ft{constructor(t,e){super(t,"not-in",e),this.keys=Yc("not-in",e)}matches(t){return!this.keys.some((e=>e.isEqual(t.key)))}}function Yc(n,t){return(t.arrayValue?.values||[]).map((e=>L.fromName(e.referenceValue)))}class wg extends ft{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return Mo(e)&&Vr(e.arrayValue,this.value)}}class Ig extends ft{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return e!==null&&Vr(this.value.arrayValue,e)}}class Ag extends ft{constructor(t,e){super(t,"not-in",e)}matches(t){if(Vr(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return e!==null&&e.nullValue===void 0&&!Vr(this.value.arrayValue,e)}}class Rg extends ft{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!Mo(e)||!e.arrayValue.values)&&e.arrayValue.values.some((r=>Vr(this.value.arrayValue,r)))}}class Sg{constructor(t,e=null,r=[],s=[],o=null,a=null,l=null){this.path=t,this.collectionGroup=e,this.orderBy=r,this.filters=s,this.limit=o,this.startAt=a,this.endAt=l,this.Te=null}}function Qu(n,t=null,e=[],r=[],s=null,o=null,a=null){return new Sg(n,t,e,r,s,o,a)}function Lo(n){const t=j(n);if(t.Te===null){let e=t.path.canonicalString();t.collectionGroup!==null&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map((r=>ro(r))).join(","),e+="|ob:",e+=t.orderBy.map((r=>(function(o){return o.field.canonicalString()+o.dir})(r))).join(","),zs(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((r=>Vn(r))).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((r=>Vn(r))).join(",")),t.Te=e}return t.Te}function Fo(n,t){if(n.limit!==t.limit||n.orderBy.length!==t.orderBy.length)return!1;for(let e=0;e<n.orderBy.length;e++)if(!_g(n.orderBy[e],t.orderBy[e]))return!1;if(n.filters.length!==t.filters.length)return!1;for(let e=0;e<n.filters.length;e++)if(!Qc(n.filters[e],t.filters[e]))return!1;return n.collectionGroup===t.collectionGroup&&!!n.path.isEqual(t.path)&&!!Wu(n.startAt,t.startAt)&&Wu(n.endAt,t.endAt)}function so(n){return L.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}class Gs{constructor(t,e=null,r=[],s=[],o=null,a="F",l=null,h=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=r,this.filters=s,this.limit=o,this.limitType=a,this.startAt=l,this.endAt=h,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function bg(n,t,e,r,s,o,a,l){return new Gs(n,t,e,r,s,o,a,l)}function Uo(n){return new Gs(n)}function Xu(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function Cg(n){return n.collectionGroup!==null}function gr(n){const t=j(n);if(t.Ie===null){t.Ie=[];const e=new Set;for(const o of t.explicitOrderBy)t.Ie.push(o),e.add(o.field.canonicalString());const r=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(a){let l=new dt(yt.comparator);return a.filters.forEach((h=>{h.getFlattenedFilters().forEach((f=>{f.isInequality()&&(l=l.add(f.field))}))})),l})(t).forEach((o=>{e.has(o.canonicalString())||o.isKeyField()||t.Ie.push(new bs(o,r))})),e.has(yt.keyField().canonicalString())||t.Ie.push(new bs(yt.keyField(),r))}return t.Ie}function te(n){const t=j(n);return t.Ee||(t.Ee=Pg(t,gr(n))),t.Ee}function Pg(n,t){if(n.limitType==="F")return Qu(n.path,n.collectionGroup,t,n.filters,n.limit,n.startAt,n.endAt);{t=t.map((s=>{const o=s.dir==="desc"?"asc":"desc";return new bs(s.field,o)}));const e=n.endAt?new Ss(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Ss(n.startAt.position,n.startAt.inclusive):null;return Qu(n.path,n.collectionGroup,t,n.filters,n.limit,e,r)}}function io(n,t,e){return new Gs(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),t,e,n.startAt,n.endAt)}function Ks(n,t){return Fo(te(n),te(t))&&n.limitType===t.limitType}function Jc(n){return`${Lo(te(n))}|lt:${n.limitType}`}function mn(n){return`Query(target=${(function(e){let r=e.path.canonicalString();return e.collectionGroup!==null&&(r+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(r+=`, filters: [${e.filters.map((s=>Xc(s))).join(", ")}]`),zs(e.limit)||(r+=", limit: "+e.limit),e.orderBy.length>0&&(r+=`, orderBy: [${e.orderBy.map((s=>(function(a){return`${a.field.canonicalString()} (${a.dir})`})(s))).join(", ")}]`),e.startAt&&(r+=", startAt: ",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map((s=>Vn(s))).join(",")),e.endAt&&(r+=", endAt: ",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map((s=>Vn(s))).join(",")),`Target(${r})`})(te(n))}; limitType=${n.limitType})`}function Ws(n,t){return t.isFoundDocument()&&(function(r,s){const o=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(o):L.isDocumentKey(r.path)?r.path.isEqual(o):r.path.isImmediateParentOf(o)})(n,t)&&(function(r,s){for(const o of gr(r))if(!o.field.isKeyField()&&s.data.field(o.field)===null)return!1;return!0})(n,t)&&(function(r,s){for(const o of r.filters)if(!o.matches(s))return!1;return!0})(n,t)&&(function(r,s){return!(r.startAt&&!(function(a,l,h){const f=Ku(a,l,h);return a.inclusive?f<=0:f<0})(r.startAt,gr(r),s)||r.endAt&&!(function(a,l,h){const f=Ku(a,l,h);return a.inclusive?f>=0:f>0})(r.endAt,gr(r),s))})(n,t)}function Vg(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function Zc(n){return(t,e)=>{let r=!1;for(const s of gr(n)){const o=Dg(s,t,e);if(o!==0)return o;r=r||s.field.isKeyField()}return 0}}function Dg(n,t,e){const r=n.field.isKeyField()?L.comparator(t.key,e.key):(function(o,a,l){const h=a.data.field(o),f=l.data.field(o);return h!==null&&f!==null?Pn(h,f):U(42886)})(n.field,t,e);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return U(19790,{direction:n.dir})}}class an{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){const e=this.mapKeyFn(t),r=this.inner[e];if(r!==void 0){for(const[s,o]of r)if(this.equalsFn(s,t))return o}}has(t){return this.get(t)!==void 0}set(t,e){const r=this.mapKeyFn(t),s=this.inner[r];if(s===void 0)return this.inner[r]=[[t,e]],void this.innerSize++;for(let o=0;o<s.length;o++)if(this.equalsFn(s[o][0],t))return void(s[o]=[t,e]);s.push([t,e]),this.innerSize++}delete(t){const e=this.mapKeyFn(t),r=this.inner[e];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],t))return r.length===1?delete this.inner[e]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(t){on(this.inner,((e,r)=>{for(const[s,o]of r)t(s,o)}))}isEmpty(){return Lc(this.inner)}size(){return this.innerSize}}const Ng=new it(L.comparator);function de(){return Ng}const th=new it(L.comparator);function ir(...n){let t=th;for(const e of n)t=t.insert(e.key,e);return t}function eh(n){let t=th;return n.forEach(((e,r)=>t=t.insert(e,r.overlayedDocument))),t}function Ke(){return _r()}function nh(){return _r()}function _r(){return new an((n=>n.toString()),((n,t)=>n.isEqual(t)))}const kg=new it(L.comparator),xg=new dt(L.comparator);function z(...n){let t=xg;for(const e of n)t=t.add(e);return t}const Og=new dt($);function Mg(){return Og}function Bo(n,t){if(n.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Is(t)?"-0":t}}function rh(n){return{integerValue:""+n}}function Lg(n,t){return lg(t)?rh(t):Bo(n,t)}class Qs{constructor(){this._=void 0}}function Fg(n,t,e){return n instanceof Cs?(function(s,o){const a={fields:{[Bc]:{stringValue:Uc},[qc]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return o&&Oo(o)&&(o=Hs(o)),o&&(a.fields[jc]=o),{mapValue:a}})(e,t):n instanceof Dr?ih(n,t):n instanceof Nr?oh(n,t):(function(s,o){const a=sh(s,o),l=Yu(a)+Yu(s.Ae);return no(a)&&no(s.Ae)?rh(l):Bo(s.serializer,l)})(n,t)}function Ug(n,t,e){return n instanceof Dr?ih(n,t):n instanceof Nr?oh(n,t):e}function sh(n,t){return n instanceof Ps?(function(r){return no(r)||(function(o){return!!o&&"doubleValue"in o})(r)})(t)?t:{integerValue:0}:null}class Cs extends Qs{}class Dr extends Qs{constructor(t){super(),this.elements=t}}function ih(n,t){const e=ah(t);for(const r of n.elements)e.some((s=>ie(s,r)))||e.push(r);return{arrayValue:{values:e}}}class Nr extends Qs{constructor(t){super(),this.elements=t}}function oh(n,t){let e=ah(t);for(const r of n.elements)e=e.filter((s=>!ie(s,r)));return{arrayValue:{values:e}}}class Ps extends Qs{constructor(t,e){super(),this.serializer=t,this.Ae=e}}function Yu(n){return at(n.integerValue||n.doubleValue)}function ah(n){return Mo(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function Bg(n,t){return n.field.isEqual(t.field)&&(function(r,s){return r instanceof Dr&&s instanceof Dr||r instanceof Nr&&s instanceof Nr?Cn(r.elements,s.elements,ie):r instanceof Ps&&s instanceof Ps?ie(r.Ae,s.Ae):r instanceof Cs&&s instanceof Cs})(n.transform,t.transform)}class jg{constructor(t,e){this.version=t,this.transformResults=e}}class ce{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new ce}static exists(t){return new ce(void 0,t)}static updateTime(t){return new ce(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function ds(n,t){return n.updateTime!==void 0?t.isFoundDocument()&&t.version.isEqual(n.updateTime):n.exists===void 0||n.exists===t.isFoundDocument()}class Xs{}function uh(n,t){if(!n.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return n.isNoDocument()?new ch(n.key,ce.none()):new Fr(n.key,n.data,ce.none());{const e=n.data,r=qt.empty();let s=new dt(yt.comparator);for(let o of t.fields)if(!s.has(o)){let a=e.field(o);a===null&&o.length>1&&(o=o.popLast(),a=e.field(o)),a===null?r.delete(o):r.set(o,a),s=s.add(o)}return new un(n.key,r,new Ht(s.toArray()),ce.none())}}function qg(n,t,e){n instanceof Fr?(function(s,o,a){const l=s.value.clone(),h=Zu(s.fieldTransforms,o,a.transformResults);l.setAll(h),o.convertToFoundDocument(a.version,l).setHasCommittedMutations()})(n,t,e):n instanceof un?(function(s,o,a){if(!ds(s.precondition,o))return void o.convertToUnknownDocument(a.version);const l=Zu(s.fieldTransforms,o,a.transformResults),h=o.data;h.setAll(lh(s)),h.setAll(l),o.convertToFoundDocument(a.version,h).setHasCommittedMutations()})(n,t,e):(function(s,o,a){o.convertToNoDocument(a.version).setHasCommittedMutations()})(0,t,e)}function yr(n,t,e,r){return n instanceof Fr?(function(o,a,l,h){if(!ds(o.precondition,a))return l;const f=o.value.clone(),p=tl(o.fieldTransforms,h,a);return f.setAll(p),a.convertToFoundDocument(a.version,f).setHasLocalMutations(),null})(n,t,e,r):n instanceof un?(function(o,a,l,h){if(!ds(o.precondition,a))return l;const f=tl(o.fieldTransforms,h,a),p=a.data;return p.setAll(lh(o)),p.setAll(f),a.convertToFoundDocument(a.version,p).setHasLocalMutations(),l===null?null:l.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map((y=>y.field)))})(n,t,e,r):(function(o,a,l){return ds(o.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):l})(n,t,e)}function $g(n,t){let e=null;for(const r of n.fieldTransforms){const s=t.data.field(r.field),o=sh(r.transform,s||null);o!=null&&(e===null&&(e=qt.empty()),e.set(r.field,o))}return e||null}function Ju(n,t){return n.type===t.type&&!!n.key.isEqual(t.key)&&!!n.precondition.isEqual(t.precondition)&&!!(function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&Cn(r,s,((o,a)=>Bg(o,a)))})(n.fieldTransforms,t.fieldTransforms)&&(n.type===0?n.value.isEqual(t.value):n.type!==1||n.data.isEqual(t.data)&&n.fieldMask.isEqual(t.fieldMask))}class Fr extends Xs{constructor(t,e,r,s=[]){super(),this.key=t,this.value=e,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class un extends Xs{constructor(t,e,r,s,o=[]){super(),this.key=t,this.data=e,this.fieldMask=r,this.precondition=s,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function lh(n){const t=new Map;return n.fieldMask.fields.forEach((e=>{if(!e.isEmpty()){const r=n.data.field(e);t.set(e,r)}})),t}function Zu(n,t,e){const r=new Map;Q(n.length===e.length,32656,{Re:e.length,Ve:n.length});for(let s=0;s<e.length;s++){const o=n[s],a=o.transform,l=t.data.field(o.field);r.set(o.field,Ug(a,l,e[s]))}return r}function tl(n,t,e){const r=new Map;for(const s of n){const o=s.transform,a=e.data.field(s.field);r.set(s.field,Fg(o,a,t))}return r}class ch extends Xs{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class zg extends Xs{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Hg{constructor(t,e,r,s){this.batchId=t,this.localWriteTime=e,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(t,e){const r=e.mutationResults;for(let s=0;s<this.mutations.length;s++){const o=this.mutations[s];o.key.isEqual(t.key)&&qg(o,t,r[s])}}applyToLocalView(t,e){for(const r of this.baseMutations)r.key.isEqual(t.key)&&(e=yr(r,t,e,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(t.key)&&(e=yr(r,t,e,this.localWriteTime));return e}applyToLocalDocumentSet(t,e){const r=nh();return this.mutations.forEach((s=>{const o=t.get(s.key),a=o.overlayedDocument;let l=this.applyToLocalView(a,o.mutatedFields);l=e.has(s.key)?null:l;const h=uh(a,l);h!==null&&r.set(s.key,h),a.isValidDocument()||a.convertToNoDocument(B.min())})),r}keys(){return this.mutations.reduce(((t,e)=>t.add(e.key)),z())}isEqual(t){return this.batchId===t.batchId&&Cn(this.mutations,t.mutations,((e,r)=>Ju(e,r)))&&Cn(this.baseMutations,t.baseMutations,((e,r)=>Ju(e,r)))}}class jo{constructor(t,e,r,s){this.batch=t,this.commitVersion=e,this.mutationResults=r,this.docVersions=s}static from(t,e,r){Q(t.mutations.length===r.length,58842,{me:t.mutations.length,fe:r.length});let s=(function(){return kg})();const o=t.mutations;for(let a=0;a<o.length;a++)s=s.insert(o[a].key,r[a].version);return new jo(t,e,r,s)}}class Gg{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return t!==null&&this.mutation===t.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class Kg{constructor(t,e){this.count=t,this.unchangedNames=e}}var lt,H;function Wg(n){switch(n){case P.OK:return U(64938);case P.CANCELLED:case P.UNKNOWN:case P.DEADLINE_EXCEEDED:case P.RESOURCE_EXHAUSTED:case P.INTERNAL:case P.UNAVAILABLE:case P.UNAUTHENTICATED:return!1;case P.INVALID_ARGUMENT:case P.NOT_FOUND:case P.ALREADY_EXISTS:case P.PERMISSION_DENIED:case P.FAILED_PRECONDITION:case P.ABORTED:case P.OUT_OF_RANGE:case P.UNIMPLEMENTED:case P.DATA_LOSS:return!0;default:return U(15467,{code:n})}}function hh(n){if(n===void 0)return fe("GRPC error has no .code"),P.UNKNOWN;switch(n){case lt.OK:return P.OK;case lt.CANCELLED:return P.CANCELLED;case lt.UNKNOWN:return P.UNKNOWN;case lt.DEADLINE_EXCEEDED:return P.DEADLINE_EXCEEDED;case lt.RESOURCE_EXHAUSTED:return P.RESOURCE_EXHAUSTED;case lt.INTERNAL:return P.INTERNAL;case lt.UNAVAILABLE:return P.UNAVAILABLE;case lt.UNAUTHENTICATED:return P.UNAUTHENTICATED;case lt.INVALID_ARGUMENT:return P.INVALID_ARGUMENT;case lt.NOT_FOUND:return P.NOT_FOUND;case lt.ALREADY_EXISTS:return P.ALREADY_EXISTS;case lt.PERMISSION_DENIED:return P.PERMISSION_DENIED;case lt.FAILED_PRECONDITION:return P.FAILED_PRECONDITION;case lt.ABORTED:return P.ABORTED;case lt.OUT_OF_RANGE:return P.OUT_OF_RANGE;case lt.UNIMPLEMENTED:return P.UNIMPLEMENTED;case lt.DATA_LOSS:return P.DATA_LOSS;default:return U(39323,{code:n})}}(H=lt||(lt={}))[H.OK=0]="OK",H[H.CANCELLED=1]="CANCELLED",H[H.UNKNOWN=2]="UNKNOWN",H[H.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",H[H.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",H[H.NOT_FOUND=5]="NOT_FOUND",H[H.ALREADY_EXISTS=6]="ALREADY_EXISTS",H[H.PERMISSION_DENIED=7]="PERMISSION_DENIED",H[H.UNAUTHENTICATED=16]="UNAUTHENTICATED",H[H.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",H[H.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",H[H.ABORTED=10]="ABORTED",H[H.OUT_OF_RANGE=11]="OUT_OF_RANGE",H[H.UNIMPLEMENTED=12]="UNIMPLEMENTED",H[H.INTERNAL=13]="INTERNAL",H[H.UNAVAILABLE=14]="UNAVAILABLE",H[H.DATA_LOSS=15]="DATA_LOSS";function Qg(){return new TextEncoder}const Xg=new De([4294967295,4294967295],0);function el(n){const t=Qg().encode(n),e=new Sc;return e.update(t),new Uint8Array(e.digest())}function nl(n){const t=new DataView(n.buffer),e=t.getUint32(0,!0),r=t.getUint32(4,!0),s=t.getUint32(8,!0),o=t.getUint32(12,!0);return[new De([e,r],0),new De([s,o],0)]}class qo{constructor(t,e,r){if(this.bitmap=t,this.padding=e,this.hashCount=r,e<0||e>=8)throw new or(`Invalid padding: ${e}`);if(r<0)throw new or(`Invalid hash count: ${r}`);if(t.length>0&&this.hashCount===0)throw new or(`Invalid hash count: ${r}`);if(t.length===0&&e!==0)throw new or(`Invalid padding when bitmap length is 0: ${e}`);this.ge=8*t.length-e,this.pe=De.fromNumber(this.ge)}ye(t,e,r){let s=t.add(e.multiply(De.fromNumber(r)));return s.compare(Xg)===1&&(s=new De([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(t){return!!(this.bitmap[Math.floor(t/8)]&1<<t%8)}mightContain(t){if(this.ge===0)return!1;const e=el(t),[r,s]=nl(e);for(let o=0;o<this.hashCount;o++){const a=this.ye(r,s,o);if(!this.we(a))return!1}return!0}static create(t,e,r){const s=t%8==0?0:8-t%8,o=new Uint8Array(Math.ceil(t/8)),a=new qo(o,s,e);return r.forEach((l=>a.insert(l))),a}insert(t){if(this.ge===0)return;const e=el(t),[r,s]=nl(e);for(let o=0;o<this.hashCount;o++){const a=this.ye(r,s,o);this.Se(a)}}Se(t){const e=Math.floor(t/8),r=t%8;this.bitmap[e]|=1<<r}}class or extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Ys{constructor(t,e,r,s,o){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(t,e,r){const s=new Map;return s.set(t,Ur.createSynthesizedTargetChangeForCurrentChange(t,e,r)),new Ys(B.min(),s,new it($),de(),z())}}class Ur{constructor(t,e,r,s,o){this.resumeToken=t,this.current=e,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(t,e,r){return new Ur(r,e,z(),z(),z())}}class ps{constructor(t,e,r,s){this.be=t,this.removedTargetIds=e,this.key=r,this.De=s}}class fh{constructor(t,e){this.targetId=t,this.Ce=e}}class dh{constructor(t,e,r=vt.EMPTY_BYTE_STRING,s=null){this.state=t,this.targetIds=e,this.resumeToken=r,this.cause=s}}class rl{constructor(){this.ve=0,this.Fe=sl(),this.Me=vt.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(t){t.approximateByteSize()>0&&(this.Oe=!0,this.Me=t)}ke(){let t=z(),e=z(),r=z();return this.Fe.forEach(((s,o)=>{switch(o){case 0:t=t.add(s);break;case 2:e=e.add(s);break;case 1:r=r.add(s);break;default:U(38017,{changeType:o})}})),new Ur(this.Me,this.xe,t,e,r)}qe(){this.Oe=!1,this.Fe=sl()}Qe(t,e){this.Oe=!0,this.Fe=this.Fe.insert(t,e)}$e(t){this.Oe=!0,this.Fe=this.Fe.remove(t)}Ue(){this.ve+=1}Ke(){this.ve-=1,Q(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class Yg{constructor(t){this.Ge=t,this.ze=new Map,this.je=de(),this.Je=as(),this.He=as(),this.Ye=new it($)}Ze(t){for(const e of t.be)t.De&&t.De.isFoundDocument()?this.Xe(e,t.De):this.et(e,t.key,t.De);for(const e of t.removedTargetIds)this.et(e,t.key,t.De)}tt(t){this.forEachTarget(t,(e=>{const r=this.nt(e);switch(t.state){case 0:this.rt(e)&&r.Le(t.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(t.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(e);break;case 3:this.rt(e)&&(r.We(),r.Le(t.resumeToken));break;case 4:this.rt(e)&&(this.it(e),r.Le(t.resumeToken));break;default:U(56790,{state:t.state})}}))}forEachTarget(t,e){t.targetIds.length>0?t.targetIds.forEach(e):this.ze.forEach(((r,s)=>{this.rt(s)&&e(s)}))}st(t){const e=t.targetId,r=t.Ce.count,s=this.ot(e);if(s){const o=s.target;if(so(o))if(r===0){const a=new L(o.path);this.et(e,a,Rt.newNoDocument(a,B.min()))}else Q(r===1,20013,{expectedCount:r});else{const a=this._t(e);if(a!==r){const l=this.ut(t),h=l?this.ct(l,t,a):1;if(h!==0){this.it(e);const f=h===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(e,f)}}}}}ut(t){const e=t.Ce.unchangedNames;if(!e||!e.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:o=0}=e;let a,l;try{a=Oe(r).toUint8Array()}catch(h){if(h instanceof Fc)return bn("Decoding the base64 bloom filter in existence filter failed ("+h.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw h}try{l=new qo(a,s,o)}catch(h){return bn(h instanceof or?"BloomFilter error: ":"Applying bloom filter failed: ",h),null}return l.ge===0?null:l}ct(t,e,r){return e.Ce.count===r-this.Pt(t,e.targetId)?0:2}Pt(t,e){const r=this.Ge.getRemoteKeysForTarget(e);let s=0;return r.forEach((o=>{const a=this.Ge.ht(),l=`projects/${a.projectId}/databases/${a.database}/documents/${o.path.canonicalString()}`;t.mightContain(l)||(this.et(e,o,null),s++)})),s}Tt(t){const e=new Map;this.ze.forEach(((o,a)=>{const l=this.ot(a);if(l){if(o.current&&so(l.target)){const h=new L(l.target.path);this.It(h).has(a)||this.Et(a,h)||this.et(a,h,Rt.newNoDocument(h,t))}o.Be&&(e.set(a,o.ke()),o.qe())}}));let r=z();this.He.forEach(((o,a)=>{let l=!0;a.forEachWhile((h=>{const f=this.ot(h);return!f||f.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)})),l&&(r=r.add(o))})),this.je.forEach(((o,a)=>a.setReadTime(t)));const s=new Ys(t,e,this.Ye,this.je,r);return this.je=de(),this.Je=as(),this.He=as(),this.Ye=new it($),s}Xe(t,e){if(!this.rt(t))return;const r=this.Et(t,e.key)?2:0;this.nt(t).Qe(e.key,r),this.je=this.je.insert(e.key,e),this.Je=this.Je.insert(e.key,this.It(e.key).add(t)),this.He=this.He.insert(e.key,this.dt(e.key).add(t))}et(t,e,r){if(!this.rt(t))return;const s=this.nt(t);this.Et(t,e)?s.Qe(e,1):s.$e(e),this.He=this.He.insert(e,this.dt(e).delete(t)),this.He=this.He.insert(e,this.dt(e).add(t)),r&&(this.je=this.je.insert(e,r))}removeTarget(t){this.ze.delete(t)}_t(t){const e=this.nt(t).ke();return this.Ge.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size}Ue(t){this.nt(t).Ue()}nt(t){let e=this.ze.get(t);return e||(e=new rl,this.ze.set(t,e)),e}dt(t){let e=this.He.get(t);return e||(e=new dt($),this.He=this.He.insert(t,e)),e}It(t){let e=this.Je.get(t);return e||(e=new dt($),this.Je=this.Je.insert(t,e)),e}rt(t){const e=this.ot(t)!==null;return e||k("WatchChangeAggregator","Detected inactive target",t),e}ot(t){const e=this.ze.get(t);return e&&e.Ne?null:this.Ge.At(t)}it(t){this.ze.set(t,new rl),this.Ge.getRemoteKeysForTarget(t).forEach((e=>{this.et(t,e,null)}))}Et(t,e){return this.Ge.getRemoteKeysForTarget(t).has(e)}}function as(){return new it(L.comparator)}function sl(){return new it(L.comparator)}const Jg={asc:"ASCENDING",desc:"DESCENDING"},Zg={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},t_={and:"AND",or:"OR"};class e_{constructor(t,e){this.databaseId=t,this.useProto3Json=e}}function oo(n,t){return n.useProto3Json||zs(t)?t:{value:t}}function Vs(n,t){return n.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function ph(n,t){return n.useProto3Json?t.toBase64():t.toUint8Array()}function n_(n,t){return Vs(n,t.toTimestamp())}function ee(n){return Q(!!n,49232),B.fromTimestamp((function(e){const r=xe(e);return new et(r.seconds,r.nanos)})(n))}function $o(n,t){return ao(n,t).canonicalString()}function ao(n,t){const e=(function(s){return new tt(["projects",s.projectId,"databases",s.database])})(n).child("documents");return t===void 0?e:e.child(t)}function mh(n){const t=tt.fromString(n);return Q(Eh(t),10190,{key:t.toString()}),t}function uo(n,t){return $o(n.databaseId,t.path)}function Fi(n,t){const e=mh(t);if(e.get(1)!==n.databaseId.projectId)throw new x(P.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+n.databaseId.projectId);if(e.get(3)!==n.databaseId.database)throw new x(P.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+n.databaseId.database);return new L(_h(e))}function gh(n,t){return $o(n.databaseId,t)}function r_(n){const t=mh(n);return t.length===4?tt.emptyPath():_h(t)}function lo(n){return new tt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function _h(n){return Q(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function il(n,t,e){return{name:uo(n,t),fields:e.value.mapValue.fields}}function s_(n,t){let e;if("targetChange"in t){t.targetChange;const r=(function(f){return f==="NO_CHANGE"?0:f==="ADD"?1:f==="REMOVE"?2:f==="CURRENT"?3:f==="RESET"?4:U(39313,{state:f})})(t.targetChange.targetChangeType||"NO_CHANGE"),s=t.targetChange.targetIds||[],o=(function(f,p){return f.useProto3Json?(Q(p===void 0||typeof p=="string",58123),vt.fromBase64String(p||"")):(Q(p===void 0||p instanceof Buffer||p instanceof Uint8Array,16193),vt.fromUint8Array(p||new Uint8Array))})(n,t.targetChange.resumeToken),a=t.targetChange.cause,l=a&&(function(f){const p=f.code===void 0?P.UNKNOWN:hh(f.code);return new x(p,f.message||"")})(a);e=new dh(r,s,o,l||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const s=Fi(n,r.document.name),o=ee(r.document.updateTime),a=r.document.createTime?ee(r.document.createTime):B.min(),l=new qt({mapValue:{fields:r.document.fields}}),h=Rt.newFoundDocument(s,o,a,l),f=r.targetIds||[],p=r.removedTargetIds||[];e=new ps(f,p,h.key,h)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const s=Fi(n,r.document),o=r.readTime?ee(r.readTime):B.min(),a=Rt.newNoDocument(s,o),l=r.removedTargetIds||[];e=new ps([],l,a.key,a)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const s=Fi(n,r.document),o=r.removedTargetIds||[];e=new ps([],o,s,null)}else{if(!("filter"in t))return U(11601,{Rt:t});{t.filter;const r=t.filter;r.targetId;const{count:s=0,unchangedNames:o}=r,a=new Kg(s,o),l=r.targetId;e=new fh(l,a)}}return e}function i_(n,t){let e;if(t instanceof Fr)e={update:il(n,t.key,t.value)};else if(t instanceof ch)e={delete:uo(n,t.key)};else if(t instanceof un)e={update:il(n,t.key,t.data),updateMask:p_(t.fieldMask)};else{if(!(t instanceof zg))return U(16599,{Vt:t.type});e={verify:uo(n,t.key)}}return t.fieldTransforms.length>0&&(e.updateTransforms=t.fieldTransforms.map((r=>(function(o,a){const l=a.transform;if(l instanceof Cs)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof Dr)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Nr)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Ps)return{fieldPath:a.field.canonicalString(),increment:l.Ae};throw U(20930,{transform:a.transform})})(0,r)))),t.precondition.isNone||(e.currentDocument=(function(s,o){return o.updateTime!==void 0?{updateTime:n_(s,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:U(27497)})(n,t.precondition)),e}function o_(n,t){return n&&n.length>0?(Q(t!==void 0,14353),n.map((e=>(function(s,o){let a=s.updateTime?ee(s.updateTime):ee(o);return a.isEqual(B.min())&&(a=ee(o)),new jg(a,s.transformResults||[])})(e,t)))):[]}function a_(n,t){return{documents:[gh(n,t.path)]}}function u_(n,t){const e={structuredQuery:{}},r=t.path;let s;t.collectionGroup!==null?(s=r,e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(s=r.popLast(),e.structuredQuery.from=[{collectionId:r.lastSegment()}]),e.parent=gh(n,s);const o=(function(f){if(f.length!==0)return vh(oe.create(f,"and"))})(t.filters);o&&(e.structuredQuery.where=o);const a=(function(f){if(f.length!==0)return f.map((p=>(function(v){return{field:gn(v.field),direction:h_(v.dir)}})(p)))})(t.orderBy);a&&(e.structuredQuery.orderBy=a);const l=oo(n,t.limit);return l!==null&&(e.structuredQuery.limit=l),t.startAt&&(e.structuredQuery.startAt=(function(f){return{before:f.inclusive,values:f.position}})(t.startAt)),t.endAt&&(e.structuredQuery.endAt=(function(f){return{before:!f.inclusive,values:f.position}})(t.endAt)),{ft:e,parent:s}}function l_(n){let t=r_(n.parent);const e=n.structuredQuery,r=e.from?e.from.length:0;let s=null;if(r>0){Q(r===1,65062);const p=e.from[0];p.allDescendants?s=p.collectionId:t=t.child(p.collectionId)}let o=[];e.where&&(o=(function(y){const v=yh(y);return v instanceof oe&&Wc(v)?v.getFilters():[v]})(e.where));let a=[];e.orderBy&&(a=(function(y){return y.map((v=>(function(C){return new bs(_n(C.field),(function(V){switch(V){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(C.direction))})(v)))})(e.orderBy));let l=null;e.limit&&(l=(function(y){let v;return v=typeof y=="object"?y.value:y,zs(v)?null:v})(e.limit));let h=null;e.startAt&&(h=(function(y){const v=!!y.before,R=y.values||[];return new Ss(R,v)})(e.startAt));let f=null;return e.endAt&&(f=(function(y){const v=!y.before,R=y.values||[];return new Ss(R,v)})(e.endAt)),bg(t,s,a,o,l,"F",h,f)}function c_(n,t){const e=(function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return U(28987,{purpose:s})}})(t.purpose);return e==null?null:{"goog-listen-tags":e}}function yh(n){return n.unaryFilter!==void 0?(function(e){switch(e.unaryFilter.op){case"IS_NAN":const r=_n(e.unaryFilter.field);return ft.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=_n(e.unaryFilter.field);return ft.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=_n(e.unaryFilter.field);return ft.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=_n(e.unaryFilter.field);return ft.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return U(61313);default:return U(60726)}})(n):n.fieldFilter!==void 0?(function(e){return ft.create(_n(e.fieldFilter.field),(function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return U(58110);default:return U(50506)}})(e.fieldFilter.op),e.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(e){return oe.create(e.compositeFilter.filters.map((r=>yh(r))),(function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return U(1026)}})(e.compositeFilter.op))})(n):U(30097,{filter:n})}function h_(n){return Jg[n]}function f_(n){return Zg[n]}function d_(n){return t_[n]}function gn(n){return{fieldPath:n.canonicalString()}}function _n(n){return yt.fromServerFormat(n.fieldPath)}function vh(n){return n instanceof ft?(function(e){if(e.op==="=="){if(Gu(e.value))return{unaryFilter:{field:gn(e.field),op:"IS_NAN"}};if(Hu(e.value))return{unaryFilter:{field:gn(e.field),op:"IS_NULL"}}}else if(e.op==="!="){if(Gu(e.value))return{unaryFilter:{field:gn(e.field),op:"IS_NOT_NAN"}};if(Hu(e.value))return{unaryFilter:{field:gn(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:gn(e.field),op:f_(e.op),value:e.value}}})(n):n instanceof oe?(function(e){const r=e.getFilters().map((s=>vh(s)));return r.length===1?r[0]:{compositeFilter:{op:d_(e.op),filters:r}}})(n):U(54877,{filter:n})}function p_(n){const t=[];return n.fields.forEach((e=>t.push(e.canonicalString()))),{fieldPaths:t}}function Eh(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}class Re{constructor(t,e,r,s,o=B.min(),a=B.min(),l=vt.EMPTY_BYTE_STRING,h=null){this.target=t,this.targetId=e,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=l,this.expectedCount=h}withSequenceNumber(t){return new Re(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,e){return new Re(this.target,this.targetId,this.purpose,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new Re(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new Re(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}class m_{constructor(t){this.yt=t}}function g_(n){const t=l_({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?io(t,t.limit,"L"):t}class __{constructor(){this.Cn=new y_}addToCollectionParentIndex(t,e){return this.Cn.add(e),b.resolve()}getCollectionParents(t,e){return b.resolve(this.Cn.getEntries(e))}addFieldIndex(t,e){return b.resolve()}deleteFieldIndex(t,e){return b.resolve()}deleteAllFieldIndexes(t){return b.resolve()}createTargetIndexes(t,e){return b.resolve()}getDocumentsMatchingTarget(t,e){return b.resolve(null)}getIndexType(t,e){return b.resolve(0)}getFieldIndexes(t,e){return b.resolve([])}getNextCollectionGroupToUpdate(t){return b.resolve(null)}getMinOffset(t,e){return b.resolve(ke.min())}getMinOffsetFromCollectionGroup(t,e){return b.resolve(ke.min())}updateCollectionGroup(t,e,r){return b.resolve()}updateIndexEntries(t,e){return b.resolve()}}class y_{constructor(){this.index={}}add(t){const e=t.lastSegment(),r=t.popLast(),s=this.index[e]||new dt(tt.comparator),o=!s.has(r);return this.index[e]=s.add(r),o}has(t){const e=t.lastSegment(),r=t.popLast(),s=this.index[e];return s&&s.has(r)}getEntries(t){return(this.index[t]||new dt(tt.comparator)).toArray()}}const ol={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Th=41943040;class kt{static withCacheSize(t){return new kt(t,kt.DEFAULT_COLLECTION_PERCENTILE,kt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(t,e,r){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=r}}kt.DEFAULT_COLLECTION_PERCENTILE=10,kt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,kt.DEFAULT=new kt(Th,kt.DEFAULT_COLLECTION_PERCENTILE,kt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),kt.DISABLED=new kt(-1,0,0);class Dn{constructor(t){this.ar=t}next(){return this.ar+=2,this.ar}static ur(){return new Dn(0)}static cr(){return new Dn(-1)}}const al="LruGarbageCollector",v_=1048576;function ul([n,t],[e,r]){const s=$(n,e);return s===0?$(t,r):s}class E_{constructor(t){this.Ir=t,this.buffer=new dt(ul),this.Er=0}dr(){return++this.Er}Ar(t){const e=[t,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(e);else{const r=this.buffer.last();ul(e,r)<0&&(this.buffer=this.buffer.delete(r).add(e))}}get maxValue(){return this.buffer.last()[0]}}class T_{constructor(t,e,r){this.garbageCollector=t,this.asyncQueue=e,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(t){k(al,`Garbage collection scheduled in ${t}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",t,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){Fn(e)?k(al,"Ignoring IndexedDB error during garbage collection: ",e):await Ln(e)}await this.Vr(3e5)}))}}class w_{constructor(t,e){this.mr=t,this.params=e}calculateTargetCount(t,e){return this.mr.gr(t).next((r=>Math.floor(e/100*r)))}nthSequenceNumber(t,e){if(e===0)return b.resolve($s.ce);const r=new E_(e);return this.mr.forEachTarget(t,(s=>r.Ar(s.sequenceNumber))).next((()=>this.mr.pr(t,(s=>r.Ar(s))))).next((()=>r.maxValue))}removeTargets(t,e,r){return this.mr.removeTargets(t,e,r)}removeOrphanedDocuments(t,e){return this.mr.removeOrphanedDocuments(t,e)}collect(t,e){return this.params.cacheSizeCollectionThreshold===-1?(k("LruGarbageCollector","Garbage collection skipped; disabled"),b.resolve(ol)):this.getCacheSize(t).next((r=>r<this.params.cacheSizeCollectionThreshold?(k("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),ol):this.yr(t,e)))}getCacheSize(t){return this.mr.getCacheSize(t)}yr(t,e){let r,s,o,a,l,h,f;const p=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next((y=>(y>this.params.maximumSequenceNumbersToCollect?(k("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${y}`),s=this.params.maximumSequenceNumbersToCollect):s=y,a=Date.now(),this.nthSequenceNumber(t,s)))).next((y=>(r=y,l=Date.now(),this.removeTargets(t,r,e)))).next((y=>(o=y,h=Date.now(),this.removeOrphanedDocuments(t,r)))).next((y=>(f=Date.now(),pn()<=G.DEBUG&&k("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-p}ms
	Determined least recently used ${s} in `+(l-a)+`ms
	Removed ${o} targets in `+(h-l)+`ms
	Removed ${y} documents in `+(f-h)+`ms
Total Duration: ${f-p}ms`),b.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:o,documentsRemoved:y}))))}}function I_(n,t){return new w_(n,t)}class A_{constructor(){this.changes=new an((t=>t.toString()),((t,e)=>t.isEqual(e))),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,Rt.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const r=this.changes.get(e);return r!==void 0?b.resolve(r):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}class R_{constructor(t,e){this.overlayedDocument=t,this.mutatedFields=e}}class S_{constructor(t,e,r,s){this.remoteDocumentCache=t,this.mutationQueue=e,this.documentOverlayCache=r,this.indexManager=s}getDocument(t,e){let r=null;return this.documentOverlayCache.getOverlay(t,e).next((s=>(r=s,this.remoteDocumentCache.getEntry(t,e)))).next((s=>(r!==null&&yr(r.mutation,s,Ht.empty(),et.now()),s)))}getDocuments(t,e){return this.remoteDocumentCache.getEntries(t,e).next((r=>this.getLocalViewOfDocuments(t,r,z()).next((()=>r))))}getLocalViewOfDocuments(t,e,r=z()){const s=Ke();return this.populateOverlays(t,s,e).next((()=>this.computeViews(t,e,s,r).next((o=>{let a=ir();return o.forEach(((l,h)=>{a=a.insert(l,h.overlayedDocument)})),a}))))}getOverlayedDocuments(t,e){const r=Ke();return this.populateOverlays(t,r,e).next((()=>this.computeViews(t,e,r,z())))}populateOverlays(t,e,r){const s=[];return r.forEach((o=>{e.has(o)||s.push(o)})),this.documentOverlayCache.getOverlays(t,s).next((o=>{o.forEach(((a,l)=>{e.set(a,l)}))}))}computeViews(t,e,r,s){let o=de();const a=_r(),l=(function(){return _r()})();return e.forEach(((h,f)=>{const p=r.get(f.key);s.has(f.key)&&(p===void 0||p.mutation instanceof un)?o=o.insert(f.key,f):p!==void 0?(a.set(f.key,p.mutation.getFieldMask()),yr(p.mutation,f,p.mutation.getFieldMask(),et.now())):a.set(f.key,Ht.empty())})),this.recalculateAndSaveOverlays(t,o).next((h=>(h.forEach(((f,p)=>a.set(f,p))),e.forEach(((f,p)=>l.set(f,new R_(p,a.get(f)??null)))),l)))}recalculateAndSaveOverlays(t,e){const r=_r();let s=new it(((a,l)=>a-l)),o=z();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next((a=>{for(const l of a)l.keys().forEach((h=>{const f=e.get(h);if(f===null)return;let p=r.get(h)||Ht.empty();p=l.applyToLocalView(f,p),r.set(h,p);const y=(s.get(l.batchId)||z()).add(h);s=s.insert(l.batchId,y)}))})).next((()=>{const a=[],l=s.getReverseIterator();for(;l.hasNext();){const h=l.getNext(),f=h.key,p=h.value,y=nh();p.forEach((v=>{if(!o.has(v)){const R=uh(e.get(v),r.get(v));R!==null&&y.set(v,R),o=o.add(v)}})),a.push(this.documentOverlayCache.saveOverlays(t,f,y))}return b.waitFor(a)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(t,e){return this.remoteDocumentCache.getEntries(t,e).next((r=>this.recalculateAndSaveOverlays(t,r)))}getDocumentsMatchingQuery(t,e,r,s){return(function(a){return L.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0})(e)?this.getDocumentsMatchingDocumentQuery(t,e.path):Cg(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,r,s):this.getDocumentsMatchingCollectionQuery(t,e,r,s)}getNextDocuments(t,e,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,r,s).next((o=>{const a=s-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,e,r.largestBatchId,s-o.size):b.resolve(Ke());let l=br,h=o;return a.next((f=>b.forEach(f,((p,y)=>(l<y.largestBatchId&&(l=y.largestBatchId),o.get(p)?b.resolve():this.remoteDocumentCache.getEntry(t,p).next((v=>{h=h.insert(p,v)}))))).next((()=>this.populateOverlays(t,f,o))).next((()=>this.computeViews(t,h,f,z()))).next((p=>({batchId:l,changes:eh(p)})))))}))}getDocumentsMatchingDocumentQuery(t,e){return this.getDocument(t,new L(e)).next((r=>{let s=ir();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s}))}getDocumentsMatchingCollectionGroupQuery(t,e,r,s){const o=e.collectionGroup;let a=ir();return this.indexManager.getCollectionParents(t,o).next((l=>b.forEach(l,(h=>{const f=(function(y,v){return new Gs(v,null,y.explicitOrderBy.slice(),y.filters.slice(),y.limit,y.limitType,y.startAt,y.endAt)})(e,h.child(o));return this.getDocumentsMatchingCollectionQuery(t,f,r,s).next((p=>{p.forEach(((y,v)=>{a=a.insert(y,v)}))}))})).next((()=>a))))}getDocumentsMatchingCollectionQuery(t,e,r,s){let o;return this.documentOverlayCache.getOverlaysForCollection(t,e.path,r.largestBatchId).next((a=>(o=a,this.remoteDocumentCache.getDocumentsMatchingQuery(t,e,r,o,s)))).next((a=>{o.forEach(((h,f)=>{const p=f.getKey();a.get(p)===null&&(a=a.insert(p,Rt.newInvalidDocument(p)))}));let l=ir();return a.forEach(((h,f)=>{const p=o.get(h);p!==void 0&&yr(p.mutation,f,Ht.empty(),et.now()),Ws(e,f)&&(l=l.insert(h,f))})),l}))}}class b_{constructor(t){this.serializer=t,this.Lr=new Map,this.kr=new Map}getBundleMetadata(t,e){return b.resolve(this.Lr.get(e))}saveBundleMetadata(t,e){return this.Lr.set(e.id,(function(s){return{id:s.id,version:s.version,createTime:ee(s.createTime)}})(e)),b.resolve()}getNamedQuery(t,e){return b.resolve(this.kr.get(e))}saveNamedQuery(t,e){return this.kr.set(e.name,(function(s){return{name:s.name,query:g_(s.bundledQuery),readTime:ee(s.readTime)}})(e)),b.resolve()}}class C_{constructor(){this.overlays=new it(L.comparator),this.qr=new Map}getOverlay(t,e){return b.resolve(this.overlays.get(e))}getOverlays(t,e){const r=Ke();return b.forEach(e,(s=>this.getOverlay(t,s).next((o=>{o!==null&&r.set(s,o)})))).next((()=>r))}saveOverlays(t,e,r){return r.forEach(((s,o)=>{this.St(t,e,o)})),b.resolve()}removeOverlaysForBatchId(t,e,r){const s=this.qr.get(r);return s!==void 0&&(s.forEach((o=>this.overlays=this.overlays.remove(o))),this.qr.delete(r)),b.resolve()}getOverlaysForCollection(t,e,r){const s=Ke(),o=e.length+1,a=new L(e.child("")),l=this.overlays.getIteratorFrom(a);for(;l.hasNext();){const h=l.getNext().value,f=h.getKey();if(!e.isPrefixOf(f.path))break;f.path.length===o&&h.largestBatchId>r&&s.set(h.getKey(),h)}return b.resolve(s)}getOverlaysForCollectionGroup(t,e,r,s){let o=new it(((f,p)=>f-p));const a=this.overlays.getIterator();for(;a.hasNext();){const f=a.getNext().value;if(f.getKey().getCollectionGroup()===e&&f.largestBatchId>r){let p=o.get(f.largestBatchId);p===null&&(p=Ke(),o=o.insert(f.largestBatchId,p)),p.set(f.getKey(),f)}}const l=Ke(),h=o.getIterator();for(;h.hasNext()&&(h.getNext().value.forEach(((f,p)=>l.set(f,p))),!(l.size()>=s)););return b.resolve(l)}St(t,e,r){const s=this.overlays.get(r.key);if(s!==null){const a=this.qr.get(s.largestBatchId).delete(r.key);this.qr.set(s.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new Gg(e,r));let o=this.qr.get(e);o===void 0&&(o=z(),this.qr.set(e,o)),this.qr.set(e,o.add(r.key))}}class P_{constructor(){this.sessionToken=vt.EMPTY_BYTE_STRING}getSessionToken(t){return b.resolve(this.sessionToken)}setSessionToken(t,e){return this.sessionToken=e,b.resolve()}}class zo{constructor(){this.Qr=new dt(mt.$r),this.Ur=new dt(mt.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(t,e){const r=new mt(t,e);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(t,e){t.forEach((r=>this.addReference(r,e)))}removeReference(t,e){this.Gr(new mt(t,e))}zr(t,e){t.forEach((r=>this.removeReference(r,e)))}jr(t){const e=new L(new tt([])),r=new mt(e,t),s=new mt(e,t+1),o=[];return this.Ur.forEachInRange([r,s],(a=>{this.Gr(a),o.push(a.key)})),o}Jr(){this.Qr.forEach((t=>this.Gr(t)))}Gr(t){this.Qr=this.Qr.delete(t),this.Ur=this.Ur.delete(t)}Hr(t){const e=new L(new tt([])),r=new mt(e,t),s=new mt(e,t+1);let o=z();return this.Ur.forEachInRange([r,s],(a=>{o=o.add(a.key)})),o}containsKey(t){const e=new mt(t,0),r=this.Qr.firstAfterOrEqual(e);return r!==null&&t.isEqual(r.key)}}class mt{constructor(t,e){this.key=t,this.Yr=e}static $r(t,e){return L.comparator(t.key,e.key)||$(t.Yr,e.Yr)}static Kr(t,e){return $(t.Yr,e.Yr)||L.comparator(t.key,e.key)}}class V_{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.tr=1,this.Zr=new dt(mt.$r)}checkEmpty(t){return b.resolve(this.mutationQueue.length===0)}addMutationBatch(t,e,r,s){const o=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new Hg(o,e,r,s);this.mutationQueue.push(a);for(const l of s)this.Zr=this.Zr.add(new mt(l.key,o)),this.indexManager.addToCollectionParentIndex(t,l.key.path.popLast());return b.resolve(a)}lookupMutationBatch(t,e){return b.resolve(this.Xr(e))}getNextMutationBatchAfterBatchId(t,e){const r=e+1,s=this.ei(r),o=s<0?0:s;return b.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return b.resolve(this.mutationQueue.length===0?xo:this.tr-1)}getAllMutationBatches(t){return b.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const r=new mt(e,0),s=new mt(e,Number.POSITIVE_INFINITY),o=[];return this.Zr.forEachInRange([r,s],(a=>{const l=this.Xr(a.Yr);o.push(l)})),b.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(t,e){let r=new dt($);return e.forEach((s=>{const o=new mt(s,0),a=new mt(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([o,a],(l=>{r=r.add(l.Yr)}))})),b.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(t,e){const r=e.path,s=r.length+1;let o=r;L.isDocumentKey(o)||(o=o.child(""));const a=new mt(new L(o),0);let l=new dt($);return this.Zr.forEachWhile((h=>{const f=h.key.path;return!!r.isPrefixOf(f)&&(f.length===s&&(l=l.add(h.Yr)),!0)}),a),b.resolve(this.ti(l))}ti(t){const e=[];return t.forEach((r=>{const s=this.Xr(r);s!==null&&e.push(s)})),e}removeMutationBatch(t,e){Q(this.ni(e.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return b.forEach(e.mutations,(s=>{const o=new mt(s.key,e.batchId);return r=r.delete(o),this.referenceDelegate.markPotentiallyOrphaned(t,s.key)})).next((()=>{this.Zr=r}))}ir(t){}containsKey(t,e){const r=new mt(e,0),s=this.Zr.firstAfterOrEqual(r);return b.resolve(e.isEqual(s&&s.key))}performConsistencyCheck(t){return this.mutationQueue.length,b.resolve()}ni(t,e){return this.ei(t)}ei(t){return this.mutationQueue.length===0?0:t-this.mutationQueue[0].batchId}Xr(t){const e=this.ei(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}class D_{constructor(t){this.ri=t,this.docs=(function(){return new it(L.comparator)})(),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const r=e.key,s=this.docs.get(r),o=s?s.size:0,a=this.ri(e);return this.docs=this.docs.insert(r,{document:e.mutableCopy(),size:a}),this.size+=a-o,this.indexManager.addToCollectionParentIndex(t,r.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const r=this.docs.get(e);return b.resolve(r?r.document.mutableCopy():Rt.newInvalidDocument(e))}getEntries(t,e){let r=de();return e.forEach((s=>{const o=this.docs.get(s);r=r.insert(s,o?o.document.mutableCopy():Rt.newInvalidDocument(s))})),b.resolve(r)}getDocumentsMatchingQuery(t,e,r,s){let o=de();const a=e.path,l=new L(a.child("__id-9223372036854775808__")),h=this.docs.getIteratorFrom(l);for(;h.hasNext();){const{key:f,value:{document:p}}=h.getNext();if(!a.isPrefixOf(f.path))break;f.path.length>a.length+1||ig(sg(p),r)<=0||(s.has(p.key)||Ws(e,p))&&(o=o.insert(p.key,p.mutableCopy()))}return b.resolve(o)}getAllFromCollectionGroup(t,e,r,s){U(9500)}ii(t,e){return b.forEach(this.docs,(r=>e(r)))}newChangeBuffer(t){return new N_(this)}getSize(t){return b.resolve(this.size)}}class N_ extends A_{constructor(t){super(),this.Nr=t}applyChanges(t){const e=[];return this.changes.forEach(((r,s)=>{s.isValidDocument()?e.push(this.Nr.addEntry(t,s)):this.Nr.removeEntry(r)})),b.waitFor(e)}getFromCache(t,e){return this.Nr.getEntry(t,e)}getAllFromCache(t,e){return this.Nr.getEntries(t,e)}}class k_{constructor(t){this.persistence=t,this.si=new an((e=>Lo(e)),Fo),this.lastRemoteSnapshotVersion=B.min(),this.highestTargetId=0,this.oi=0,this._i=new zo,this.targetCount=0,this.ai=Dn.ur()}forEachTarget(t,e){return this.si.forEach(((r,s)=>e(s))),b.resolve()}getLastRemoteSnapshotVersion(t){return b.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return b.resolve(this.oi)}allocateTargetId(t){return this.highestTargetId=this.ai.next(),b.resolve(this.highestTargetId)}setTargetsMetadata(t,e,r){return r&&(this.lastRemoteSnapshotVersion=r),e>this.oi&&(this.oi=e),b.resolve()}Pr(t){this.si.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.ai=new Dn(e),this.highestTargetId=e),t.sequenceNumber>this.oi&&(this.oi=t.sequenceNumber)}addTargetData(t,e){return this.Pr(e),this.targetCount+=1,b.resolve()}updateTargetData(t,e){return this.Pr(e),b.resolve()}removeTargetData(t,e){return this.si.delete(e.target),this._i.jr(e.targetId),this.targetCount-=1,b.resolve()}removeTargets(t,e,r){let s=0;const o=[];return this.si.forEach(((a,l)=>{l.sequenceNumber<=e&&r.get(l.targetId)===null&&(this.si.delete(a),o.push(this.removeMatchingKeysForTargetId(t,l.targetId)),s++)})),b.waitFor(o).next((()=>s))}getTargetCount(t){return b.resolve(this.targetCount)}getTargetData(t,e){const r=this.si.get(e)||null;return b.resolve(r)}addMatchingKeys(t,e,r){return this._i.Wr(e,r),b.resolve()}removeMatchingKeys(t,e,r){this._i.zr(e,r);const s=this.persistence.referenceDelegate,o=[];return s&&e.forEach((a=>{o.push(s.markPotentiallyOrphaned(t,a))})),b.waitFor(o)}removeMatchingKeysForTargetId(t,e){return this._i.jr(e),b.resolve()}getMatchingKeysForTargetId(t,e){const r=this._i.Hr(e);return b.resolve(r)}containsKey(t,e){return b.resolve(this._i.containsKey(e))}}class wh{constructor(t,e){this.ui={},this.overlays={},this.ci=new $s(0),this.li=!1,this.li=!0,this.hi=new P_,this.referenceDelegate=t(this),this.Pi=new k_(this),this.indexManager=new __,this.remoteDocumentCache=(function(s){return new D_(s)})((r=>this.referenceDelegate.Ti(r))),this.serializer=new m_(e),this.Ii=new b_(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new C_,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let r=this.ui[t.toKey()];return r||(r=new V_(e,this.referenceDelegate),this.ui[t.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(t,e,r){k("MemoryPersistence","Starting transaction:",t);const s=new x_(this.ci.next());return this.referenceDelegate.Ei(),r(s).next((o=>this.referenceDelegate.di(s).next((()=>o)))).toPromise().then((o=>(s.raiseOnCommittedEvent(),o)))}Ai(t,e){return b.or(Object.values(this.ui).map((r=>()=>r.containsKey(t,e))))}}class x_ extends ag{constructor(t){super(),this.currentSequenceNumber=t}}class Ho{constructor(t){this.persistence=t,this.Ri=new zo,this.Vi=null}static mi(t){return new Ho(t)}get fi(){if(this.Vi)return this.Vi;throw U(60996)}addReference(t,e,r){return this.Ri.addReference(r,e),this.fi.delete(r.toString()),b.resolve()}removeReference(t,e,r){return this.Ri.removeReference(r,e),this.fi.add(r.toString()),b.resolve()}markPotentiallyOrphaned(t,e){return this.fi.add(e.toString()),b.resolve()}removeTarget(t,e){this.Ri.jr(e.targetId).forEach((s=>this.fi.add(s.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,e.targetId).next((s=>{s.forEach((o=>this.fi.add(o.toString())))})).next((()=>r.removeTargetData(t,e)))}Ei(){this.Vi=new Set}di(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return b.forEach(this.fi,(r=>{const s=L.fromPath(r);return this.gi(t,s).next((o=>{o||e.removeEntry(s,B.min())}))})).next((()=>(this.Vi=null,e.apply(t))))}updateLimboDocument(t,e){return this.gi(t,e).next((r=>{r?this.fi.delete(e.toString()):this.fi.add(e.toString())}))}Ti(t){return 0}gi(t,e){return b.or([()=>b.resolve(this.Ri.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Ai(t,e)])}}class Ds{constructor(t,e){this.persistence=t,this.pi=new an((r=>cg(r.path)),((r,s)=>r.isEqual(s))),this.garbageCollector=I_(this,e)}static mi(t,e){return new Ds(t,e)}Ei(){}di(t){return b.resolve()}forEachTarget(t,e){return this.persistence.getTargetCache().forEachTarget(t,e)}gr(t){const e=this.wr(t);return this.persistence.getTargetCache().getTargetCount(t).next((r=>e.next((s=>r+s))))}wr(t){let e=0;return this.pr(t,(r=>{e++})).next((()=>e))}pr(t,e){return b.forEach(this.pi,((r,s)=>this.br(t,r,s).next((o=>o?b.resolve():e(s)))))}removeTargets(t,e,r){return this.persistence.getTargetCache().removeTargets(t,e,r)}removeOrphanedDocuments(t,e){let r=0;const s=this.persistence.getRemoteDocumentCache(),o=s.newChangeBuffer();return s.ii(t,(a=>this.br(t,a,e).next((l=>{l||(r++,o.removeEntry(a,B.min()))})))).next((()=>o.apply(t))).next((()=>r))}markPotentiallyOrphaned(t,e){return this.pi.set(e,t.currentSequenceNumber),b.resolve()}removeTarget(t,e){const r=e.withSequenceNumber(t.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(t,r)}addReference(t,e,r){return this.pi.set(r,t.currentSequenceNumber),b.resolve()}removeReference(t,e,r){return this.pi.set(r,t.currentSequenceNumber),b.resolve()}updateLimboDocument(t,e){return this.pi.set(e,t.currentSequenceNumber),b.resolve()}Ti(t){let e=t.key.toString().length;return t.isFoundDocument()&&(e+=hs(t.data.value)),e}br(t,e,r){return b.or([()=>this.persistence.Ai(t,e),()=>this.persistence.getTargetCache().containsKey(t,e),()=>{const s=this.pi.get(e);return b.resolve(s!==void 0&&s>r)}])}getCacheSize(t){return this.persistence.getRemoteDocumentCache().getSize(t)}}class Go{constructor(t,e,r,s){this.targetId=t,this.fromCache=e,this.Es=r,this.ds=s}static As(t,e){let r=z(),s=z();for(const o of e.docChanges)switch(o.type){case 0:r=r.add(o.doc.key);break;case 1:s=s.add(o.doc.key)}return new Go(t,e.fromCache,r,s)}}class O_{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}class M_{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return Cp()?8:ug(Sp())>0?6:4})()}initialize(t,e){this.ps=t,this.indexManager=e,this.Rs=!0}getDocumentsMatchingQuery(t,e,r,s){const o={result:null};return this.ys(t,e).next((a=>{o.result=a})).next((()=>{if(!o.result)return this.ws(t,e,s,r).next((a=>{o.result=a}))})).next((()=>{if(o.result)return;const a=new O_;return this.Ss(t,e,a).next((l=>{if(o.result=l,this.Vs)return this.bs(t,e,a,l.size)}))})).next((()=>o.result))}bs(t,e,r,s){return r.documentReadCount<this.fs?(pn()<=G.DEBUG&&k("QueryEngine","SDK will not create cache indexes for query:",mn(e),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),b.resolve()):(pn()<=G.DEBUG&&k("QueryEngine","Query:",mn(e),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.gs*s?(pn()<=G.DEBUG&&k("QueryEngine","The SDK decides to create cache indexes for query:",mn(e),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,te(e))):b.resolve())}ys(t,e){if(Xu(e))return b.resolve(null);let r=te(e);return this.indexManager.getIndexType(t,r).next((s=>s===0?null:(e.limit!==null&&s===1&&(e=io(e,null,"F"),r=te(e)),this.indexManager.getDocumentsMatchingTarget(t,r).next((o=>{const a=z(...o);return this.ps.getDocuments(t,a).next((l=>this.indexManager.getMinOffset(t,r).next((h=>{const f=this.Ds(e,l);return this.Cs(e,f,a,h.readTime)?this.ys(t,io(e,null,"F")):this.vs(t,f,e,h)}))))})))))}ws(t,e,r,s){return Xu(e)||s.isEqual(B.min())?b.resolve(null):this.ps.getDocuments(t,r).next((o=>{const a=this.Ds(e,o);return this.Cs(e,a,r,s)?b.resolve(null):(pn()<=G.DEBUG&&k("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),mn(e)),this.vs(t,a,e,rg(s,br)).next((l=>l)))}))}Ds(t,e){let r=new dt(Zc(t));return e.forEach(((s,o)=>{Ws(t,o)&&(r=r.add(o))})),r}Cs(t,e,r,s){if(t.limit===null)return!1;if(r.size!==e.size)return!0;const o=t.limitType==="F"?e.last():e.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(s)>0)}Ss(t,e,r){return pn()<=G.DEBUG&&k("QueryEngine","Using full collection scan to execute query:",mn(e)),this.ps.getDocumentsMatchingQuery(t,e,ke.min(),r)}vs(t,e,r,s){return this.ps.getDocumentsMatchingQuery(t,r,s).next((o=>(e.forEach((a=>{o=o.insert(a.key,a)})),o)))}}const Ko="LocalStore",L_=3e8;class F_{constructor(t,e,r,s){this.persistence=t,this.Fs=e,this.serializer=s,this.Ms=new it($),this.xs=new an((o=>Lo(o)),Fo),this.Os=new Map,this.Ns=t.getRemoteDocumentCache(),this.Pi=t.getTargetCache(),this.Ii=t.getBundleCache(),this.Bs(r)}Bs(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new S_(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(e=>t.collect(e,this.Ms)))}}function U_(n,t,e,r){return new F_(n,t,e,r)}async function Ih(n,t){const e=j(n);return await e.persistence.runTransaction("Handle user change","readonly",(r=>{let s;return e.mutationQueue.getAllMutationBatches(r).next((o=>(s=o,e.Bs(t),e.mutationQueue.getAllMutationBatches(r)))).next((o=>{const a=[],l=[];let h=z();for(const f of s){a.push(f.batchId);for(const p of f.mutations)h=h.add(p.key)}for(const f of o){l.push(f.batchId);for(const p of f.mutations)h=h.add(p.key)}return e.localDocuments.getDocuments(r,h).next((f=>({Ls:f,removedBatchIds:a,addedBatchIds:l})))}))}))}function B_(n,t){const e=j(n);return e.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const s=t.batch.keys(),o=e.Ns.newChangeBuffer({trackRemovals:!0});return(function(l,h,f,p){const y=f.batch,v=y.keys();let R=b.resolve();return v.forEach((C=>{R=R.next((()=>p.getEntry(h,C))).next((D=>{const V=f.docVersions.get(C);Q(V!==null,48541),D.version.compareTo(V)<0&&(y.applyToRemoteDocument(D,f),D.isValidDocument()&&(D.setReadTime(f.commitVersion),p.addEntry(D)))}))})),R.next((()=>l.mutationQueue.removeMutationBatch(h,y)))})(e,r,t,o).next((()=>o.apply(r))).next((()=>e.mutationQueue.performConsistencyCheck(r))).next((()=>e.documentOverlayCache.removeOverlaysForBatchId(r,s,t.batch.batchId))).next((()=>e.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(l){let h=z();for(let f=0;f<l.mutationResults.length;++f)l.mutationResults[f].transformResults.length>0&&(h=h.add(l.batch.mutations[f].key));return h})(t)))).next((()=>e.localDocuments.getDocuments(r,s)))}))}function Ah(n){const t=j(n);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(e=>t.Pi.getLastRemoteSnapshotVersion(e)))}function j_(n,t){const e=j(n),r=t.snapshotVersion;let s=e.Ms;return e.persistence.runTransaction("Apply remote event","readwrite-primary",(o=>{const a=e.Ns.newChangeBuffer({trackRemovals:!0});s=e.Ms;const l=[];t.targetChanges.forEach(((p,y)=>{const v=s.get(y);if(!v)return;l.push(e.Pi.removeMatchingKeys(o,p.removedDocuments,y).next((()=>e.Pi.addMatchingKeys(o,p.addedDocuments,y))));let R=v.withSequenceNumber(o.currentSequenceNumber);t.targetMismatches.get(y)!==null?R=R.withResumeToken(vt.EMPTY_BYTE_STRING,B.min()).withLastLimboFreeSnapshotVersion(B.min()):p.resumeToken.approximateByteSize()>0&&(R=R.withResumeToken(p.resumeToken,r)),s=s.insert(y,R),(function(D,V,M){return D.resumeToken.approximateByteSize()===0||V.snapshotVersion.toMicroseconds()-D.snapshotVersion.toMicroseconds()>=L_?!0:M.addedDocuments.size+M.modifiedDocuments.size+M.removedDocuments.size>0})(v,R,p)&&l.push(e.Pi.updateTargetData(o,R))}));let h=de(),f=z();if(t.documentUpdates.forEach((p=>{t.resolvedLimboDocuments.has(p)&&l.push(e.persistence.referenceDelegate.updateLimboDocument(o,p))})),l.push(q_(o,a,t.documentUpdates).next((p=>{h=p.ks,f=p.qs}))),!r.isEqual(B.min())){const p=e.Pi.getLastRemoteSnapshotVersion(o).next((y=>e.Pi.setTargetsMetadata(o,o.currentSequenceNumber,r)));l.push(p)}return b.waitFor(l).next((()=>a.apply(o))).next((()=>e.localDocuments.getLocalViewOfDocuments(o,h,f))).next((()=>h))})).then((o=>(e.Ms=s,o)))}function q_(n,t,e){let r=z(),s=z();return e.forEach((o=>r=r.add(o))),t.getEntries(n,r).next((o=>{let a=de();return e.forEach(((l,h)=>{const f=o.get(l);h.isFoundDocument()!==f.isFoundDocument()&&(s=s.add(l)),h.isNoDocument()&&h.version.isEqual(B.min())?(t.removeEntry(l,h.readTime),a=a.insert(l,h)):!f.isValidDocument()||h.version.compareTo(f.version)>0||h.version.compareTo(f.version)===0&&f.hasPendingWrites?(t.addEntry(h),a=a.insert(l,h)):k(Ko,"Ignoring outdated watch update for ",l,". Current version:",f.version," Watch version:",h.version)})),{ks:a,qs:s}}))}function $_(n,t){const e=j(n);return e.persistence.runTransaction("Get next mutation batch","readonly",(r=>(t===void 0&&(t=xo),e.mutationQueue.getNextMutationBatchAfterBatchId(r,t))))}function z_(n,t){const e=j(n);return e.persistence.runTransaction("Allocate target","readwrite",(r=>{let s;return e.Pi.getTargetData(r,t).next((o=>o?(s=o,b.resolve(s)):e.Pi.allocateTargetId(r).next((a=>(s=new Re(t,a,"TargetPurposeListen",r.currentSequenceNumber),e.Pi.addTargetData(r,s).next((()=>s)))))))})).then((r=>{const s=e.Ms.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(e.Ms=e.Ms.insert(r.targetId,r),e.xs.set(t,r.targetId)),r}))}async function co(n,t,e){const r=j(n),s=r.Ms.get(t),o=e?"readwrite":"readwrite-primary";try{e||await r.persistence.runTransaction("Release target",o,(a=>r.persistence.referenceDelegate.removeTarget(a,s)))}catch(a){if(!Fn(a))throw a;k(Ko,`Failed to update sequence numbers for target ${t}: ${a}`)}r.Ms=r.Ms.remove(t),r.xs.delete(s.target)}function ll(n,t,e){const r=j(n);let s=B.min(),o=z();return r.persistence.runTransaction("Execute query","readwrite",(a=>(function(h,f,p){const y=j(h),v=y.xs.get(p);return v!==void 0?b.resolve(y.Ms.get(v)):y.Pi.getTargetData(f,p)})(r,a,te(t)).next((l=>{if(l)return s=l.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(a,l.targetId).next((h=>{o=h}))})).next((()=>r.Fs.getDocumentsMatchingQuery(a,t,e?s:B.min(),e?o:z()))).next((l=>(H_(r,Vg(t),l),{documents:l,Qs:o})))))}function H_(n,t,e){let r=n.Os.get(t)||B.min();e.forEach(((s,o)=>{o.readTime.compareTo(r)>0&&(r=o.readTime)})),n.Os.set(t,r)}class cl{constructor(){this.activeTargetIds=Mg()}zs(t){this.activeTargetIds=this.activeTargetIds.add(t)}js(t){this.activeTargetIds=this.activeTargetIds.delete(t)}Gs(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class G_{constructor(){this.Mo=new cl,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,r){}addLocalQueryTarget(t,e=!0){return e&&this.Mo.zs(t),this.xo[t]||"not-current"}updateQueryState(t,e,r){this.xo[t]=e}removeLocalQueryTarget(t){this.Mo.js(t)}isLocalQueryTarget(t){return this.Mo.activeTargetIds.has(t)}clearQueryState(t){delete this.xo[t]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(t){return this.Mo.activeTargetIds.has(t)}start(){return this.Mo=new cl,Promise.resolve()}handleUserChange(t,e,r){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}class K_{Oo(t){}shutdown(){}}const hl="ConnectivityMonitor";class fl{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(t){this.qo.push(t)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){k(hl,"Network connectivity changed: AVAILABLE");for(const t of this.qo)t(0)}ko(){k(hl,"Network connectivity changed: UNAVAILABLE");for(const t of this.qo)t(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let us=null;function ho(){return us===null?us=(function(){return 268435456+Math.round(2147483648*Math.random())})():us++,"0x"+us.toString(16)}const Ui="RestConnection",W_={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Q_{get $o(){return!1}constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const e=t.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=e+"://"+t.host,this.Ko=`projects/${r}/databases/${s}`,this.Wo=this.databaseId.database===As?`project_id=${r}`:`project_id=${r}&database_id=${s}`}Go(t,e,r,s,o){const a=ho(),l=this.zo(t,e.toUriEncodedString());k(Ui,`Sending RPC '${t}' ${a}:`,l,r);const h={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(h,s,o);const{host:f}=new URL(l),p=Po(f);return this.Jo(t,l,h,r,p).then((y=>(k(Ui,`Received RPC '${t}' ${a}: `,y),y)),(y=>{throw bn(Ui,`RPC '${t}' ${a} failed with error: `,y,"url: ",l,"request:",r),y}))}Ho(t,e,r,s,o,a){return this.Go(t,e,r,s,o)}jo(t,e,r){t["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Mn})(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach(((s,o)=>t[o]=s)),r&&r.headers.forEach(((s,o)=>t[o]=s))}zo(t,e){const r=W_[t];return`${this.Uo}/v1/${e}:${r}`}terminate(){}}class X_{constructor(t){this.Yo=t.Yo,this.Zo=t.Zo}Xo(t){this.e_=t}t_(t){this.n_=t}r_(t){this.i_=t}onMessage(t){this.s_=t}close(){this.Zo()}send(t){this.Yo(t)}o_(){this.e_()}__(){this.n_()}a_(t){this.i_(t)}u_(t){this.s_(t)}}const wt="WebChannelConnection";class Y_ extends Q_{constructor(t){super(t),this.c_=[],this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}Jo(t,e,r,s,o){const a=ho();return new Promise(((l,h)=>{const f=new bc;f.setWithCredentials(!0),f.listenOnce(Cc.COMPLETE,(()=>{try{switch(f.getLastErrorCode()){case cs.NO_ERROR:const y=f.getResponseJson();k(wt,`XHR for RPC '${t}' ${a} received:`,JSON.stringify(y)),l(y);break;case cs.TIMEOUT:k(wt,`RPC '${t}' ${a} timed out`),h(new x(P.DEADLINE_EXCEEDED,"Request time out"));break;case cs.HTTP_ERROR:const v=f.getStatus();if(k(wt,`RPC '${t}' ${a} failed with status:`,v,"response text:",f.getResponseText()),v>0){let R=f.getResponseJson();Array.isArray(R)&&(R=R[0]);const C=R?.error;if(C&&C.status&&C.message){const D=(function(M){const F=M.toLowerCase().replace(/_/g,"-");return Object.values(P).indexOf(F)>=0?F:P.UNKNOWN})(C.status);h(new x(D,C.message))}else h(new x(P.UNKNOWN,"Server responded with status "+f.getStatus()))}else h(new x(P.UNAVAILABLE,"Connection failed."));break;default:U(9055,{l_:t,streamId:a,h_:f.getLastErrorCode(),P_:f.getLastError()})}}finally{k(wt,`RPC '${t}' ${a} completed.`)}}));const p=JSON.stringify(s);k(wt,`RPC '${t}' ${a} sending request:`,s),f.send(e,"POST",p,r,15)}))}T_(t,e,r){const s=ho(),o=[this.Uo,"/","google.firestore.v1.Firestore","/",t,"/channel"],a=Dc(),l=Vc(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},f=this.longPollingOptions.timeoutSeconds;f!==void 0&&(h.longPollingTimeout=Math.round(1e3*f)),this.useFetchStreams&&(h.useFetchStreams=!0),this.jo(h.initMessageHeaders,e,r),h.encodeInitMessageHeaders=!0;const p=o.join("");k(wt,`Creating RPC '${t}' stream ${s}: ${p}`,h);const y=a.createWebChannel(p,h);this.I_(y);let v=!1,R=!1;const C=new X_({Yo:V=>{R?k(wt,`Not sending because RPC '${t}' stream ${s} is closed:`,V):(v||(k(wt,`Opening RPC '${t}' stream ${s} transport.`),y.open(),v=!0),k(wt,`RPC '${t}' stream ${s} sending:`,V),y.send(V))},Zo:()=>y.close()}),D=(V,M,F)=>{V.listen(M,(O=>{try{F(O)}catch(X){setTimeout((()=>{throw X}),0)}}))};return D(y,sr.EventType.OPEN,(()=>{R||(k(wt,`RPC '${t}' stream ${s} transport opened.`),C.o_())})),D(y,sr.EventType.CLOSE,(()=>{R||(R=!0,k(wt,`RPC '${t}' stream ${s} transport closed`),C.a_(),this.E_(y))})),D(y,sr.EventType.ERROR,(V=>{R||(R=!0,bn(wt,`RPC '${t}' stream ${s} transport errored. Name:`,V.name,"Message:",V.message),C.a_(new x(P.UNAVAILABLE,"The operation could not be completed")))})),D(y,sr.EventType.MESSAGE,(V=>{if(!R){const M=V.data[0];Q(!!M,16349);const F=M,O=F?.error||F[0]?.error;if(O){k(wt,`RPC '${t}' stream ${s} received error:`,O);const X=O.status;let nt=(function(m){const g=lt[m];if(g!==void 0)return hh(g)})(X),rt=O.message;nt===void 0&&(nt=P.INTERNAL,rt="Unknown error status: "+X+" with message "+O.message),R=!0,C.a_(new x(nt,rt)),y.close()}else k(wt,`RPC '${t}' stream ${s} received:`,M),C.u_(M)}})),D(l,Pc.STAT_EVENT,(V=>{V.stat===Zi.PROXY?k(wt,`RPC '${t}' stream ${s} detected buffering proxy`):V.stat===Zi.NOPROXY&&k(wt,`RPC '${t}' stream ${s} detected no buffering proxy`)})),setTimeout((()=>{C.__()}),0),C}terminate(){this.c_.forEach((t=>t.close())),this.c_=[]}I_(t){this.c_.push(t)}E_(t){this.c_=this.c_.filter((e=>e===t))}}function Bi(){return typeof document<"u"?document:null}function Js(n){return new e_(n,!0)}class Rh{constructor(t,e,r=1e3,s=1.5,o=6e4){this.Mi=t,this.timerId=e,this.d_=r,this.A_=s,this.R_=o,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(t){this.cancel();const e=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),s=Math.max(0,e-r);s>0&&k("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${e} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,(()=>(this.f_=Date.now(),t()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const dl="PersistentStream";class Sh{constructor(t,e,r,s,o,a,l,h){this.Mi=t,this.S_=r,this.b_=s,this.connection=o,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=l,this.listener=h,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Rh(t,e)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(t){this.Q_(),this.stream.send(t)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(t,e){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,t!==4?this.M_.reset():e&&e.code===P.RESOURCE_EXHAUSTED?(fe(e.toString()),fe("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):e&&e.code===P.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.r_(e)}K_(){}auth(){this.state=1;const t=this.W_(this.D_),e=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,s])=>{this.D_===e&&this.G_(r,s)}),(r=>{t((()=>{const s=new x(P.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(s)}))}))}G_(t,e){const r=this.W_(this.D_);this.stream=this.j_(t,e),this.stream.Xo((()=>{r((()=>this.listener.Xo()))})),this.stream.t_((()=>{r((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((s=>{r((()=>this.z_(s)))})),this.stream.onMessage((s=>{r((()=>++this.F_==1?this.J_(s):this.onNext(s)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(t){return k(dl,`close with error: ${t}`),this.stream=null,this.close(4,t)}W_(t){return e=>{this.Mi.enqueueAndForget((()=>this.D_===t?e():(k(dl,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class J_ extends Sh{constructor(t,e,r,s,o,a){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",e,r,s,a),this.serializer=o}j_(t,e){return this.connection.T_("Listen",t,e)}J_(t){return this.onNext(t)}onNext(t){this.M_.reset();const e=s_(this.serializer,t),r=(function(o){if(!("targetChange"in o))return B.min();const a=o.targetChange;return a.targetIds&&a.targetIds.length?B.min():a.readTime?ee(a.readTime):B.min()})(t);return this.listener.H_(e,r)}Y_(t){const e={};e.database=lo(this.serializer),e.addTarget=(function(o,a){let l;const h=a.target;if(l=so(h)?{documents:a_(o,h)}:{query:u_(o,h).ft},l.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){l.resumeToken=ph(o,a.resumeToken);const f=oo(o,a.expectedCount);f!==null&&(l.expectedCount=f)}else if(a.snapshotVersion.compareTo(B.min())>0){l.readTime=Vs(o,a.snapshotVersion.toTimestamp());const f=oo(o,a.expectedCount);f!==null&&(l.expectedCount=f)}return l})(this.serializer,t);const r=c_(this.serializer,t);r&&(e.labels=r),this.q_(e)}Z_(t){const e={};e.database=lo(this.serializer),e.removeTarget=t,this.q_(e)}}class Z_ extends Sh{constructor(t,e,r,s,o,a){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",e,r,s,a),this.serializer=o}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(t,e){return this.connection.T_("Write",t,e)}J_(t){return Q(!!t.streamToken,31322),this.lastStreamToken=t.streamToken,Q(!t.writeResults||t.writeResults.length===0,55816),this.listener.ta()}onNext(t){Q(!!t.streamToken,12678),this.lastStreamToken=t.streamToken,this.M_.reset();const e=o_(t.writeResults,t.commitTime),r=ee(t.commitTime);return this.listener.na(r,e)}ra(){const t={};t.database=lo(this.serializer),this.q_(t)}ea(t){const e={streamToken:this.lastStreamToken,writes:t.map((r=>i_(this.serializer,r)))};this.q_(e)}}class ty{}class ey extends ty{constructor(t,e,r,s){super(),this.authCredentials=t,this.appCheckCredentials=e,this.connection=r,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new x(P.FAILED_PRECONDITION,"The client has already been terminated.")}Go(t,e,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,a])=>this.connection.Go(t,ao(e,r),s,o,a))).catch((o=>{throw o.name==="FirebaseError"?(o.code===P.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new x(P.UNKNOWN,o.toString())}))}Ho(t,e,r,s,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,l])=>this.connection.Ho(t,ao(e,r),s,a,l,o))).catch((a=>{throw a.name==="FirebaseError"?(a.code===P.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new x(P.UNKNOWN,a.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class ny{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(t){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.ca("Offline")))}set(t){this.Pa(),this.oa=0,t==="Online"&&(this.aa=!1),this.ca(t)}ca(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}la(t){const e=`Could not reach Cloud Firestore backend. ${t}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(fe(e),this.aa=!1):k("OnlineStateTracker",e)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const nn="RemoteStore";class ry{constructor(t,e,r,s,o){this.localStore=t,this.datastore=e,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=o,this.Aa.Oo((a=>{r.enqueueAndForget((async()=>{ln(this)&&(k(nn,"Restarting streams for network reachability change."),await(async function(h){const f=j(h);f.Ea.add(4),await Br(f),f.Ra.set("Unknown"),f.Ea.delete(4),await Zs(f)})(this))}))})),this.Ra=new ny(r,s)}}async function Zs(n){if(ln(n))for(const t of n.da)await t(!0)}async function Br(n){for(const t of n.da)await t(!1)}function bh(n,t){const e=j(n);e.Ia.has(t.targetId)||(e.Ia.set(t.targetId,t),Yo(e)?Xo(e):Un(e).O_()&&Qo(e,t))}function Wo(n,t){const e=j(n),r=Un(e);e.Ia.delete(t),r.O_()&&Ch(e,t),e.Ia.size===0&&(r.O_()?r.L_():ln(e)&&e.Ra.set("Unknown"))}function Qo(n,t){if(n.Va.Ue(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(B.min())>0){const e=n.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(e)}Un(n).Y_(t)}function Ch(n,t){n.Va.Ue(t),Un(n).Z_(t)}function Xo(n){n.Va=new Yg({getRemoteKeysForTarget:t=>n.remoteSyncer.getRemoteKeysForTarget(t),At:t=>n.Ia.get(t)||null,ht:()=>n.datastore.serializer.databaseId}),Un(n).start(),n.Ra.ua()}function Yo(n){return ln(n)&&!Un(n).x_()&&n.Ia.size>0}function ln(n){return j(n).Ea.size===0}function Ph(n){n.Va=void 0}async function sy(n){n.Ra.set("Online")}async function iy(n){n.Ia.forEach(((t,e)=>{Qo(n,t)}))}async function oy(n,t){Ph(n),Yo(n)?(n.Ra.ha(t),Xo(n)):n.Ra.set("Unknown")}async function ay(n,t,e){if(n.Ra.set("Online"),t instanceof dh&&t.state===2&&t.cause)try{await(async function(s,o){const a=o.cause;for(const l of o.targetIds)s.Ia.has(l)&&(await s.remoteSyncer.rejectListen(l,a),s.Ia.delete(l),s.Va.removeTarget(l))})(n,t)}catch(r){k(nn,"Failed to remove targets %s: %s ",t.targetIds.join(","),r),await Ns(n,r)}else if(t instanceof ps?n.Va.Ze(t):t instanceof fh?n.Va.st(t):n.Va.tt(t),!e.isEqual(B.min()))try{const r=await Ah(n.localStore);e.compareTo(r)>=0&&await(function(o,a){const l=o.Va.Tt(a);return l.targetChanges.forEach(((h,f)=>{if(h.resumeToken.approximateByteSize()>0){const p=o.Ia.get(f);p&&o.Ia.set(f,p.withResumeToken(h.resumeToken,a))}})),l.targetMismatches.forEach(((h,f)=>{const p=o.Ia.get(h);if(!p)return;o.Ia.set(h,p.withResumeToken(vt.EMPTY_BYTE_STRING,p.snapshotVersion)),Ch(o,h);const y=new Re(p.target,h,f,p.sequenceNumber);Qo(o,y)})),o.remoteSyncer.applyRemoteEvent(l)})(n,e)}catch(r){k(nn,"Failed to raise snapshot:",r),await Ns(n,r)}}async function Ns(n,t,e){if(!Fn(t))throw t;n.Ea.add(1),await Br(n),n.Ra.set("Offline"),e||(e=()=>Ah(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{k(nn,"Retrying IndexedDB access"),await e(),n.Ea.delete(1),await Zs(n)}))}function Vh(n,t){return t().catch((e=>Ns(n,e,t)))}async function ti(n){const t=j(n),e=Le(t);let r=t.Ta.length>0?t.Ta[t.Ta.length-1].batchId:xo;for(;uy(t);)try{const s=await $_(t.localStore,r);if(s===null){t.Ta.length===0&&e.L_();break}r=s.batchId,ly(t,s)}catch(s){await Ns(t,s)}Dh(t)&&Nh(t)}function uy(n){return ln(n)&&n.Ta.length<10}function ly(n,t){n.Ta.push(t);const e=Le(n);e.O_()&&e.X_&&e.ea(t.mutations)}function Dh(n){return ln(n)&&!Le(n).x_()&&n.Ta.length>0}function Nh(n){Le(n).start()}async function cy(n){Le(n).ra()}async function hy(n){const t=Le(n);for(const e of n.Ta)t.ea(e.mutations)}async function fy(n,t,e){const r=n.Ta.shift(),s=jo.from(r,t,e);await Vh(n,(()=>n.remoteSyncer.applySuccessfulWrite(s))),await ti(n)}async function dy(n,t){t&&Le(n).X_&&await(async function(r,s){if((function(a){return Wg(a)&&a!==P.ABORTED})(s.code)){const o=r.Ta.shift();Le(r).B_(),await Vh(r,(()=>r.remoteSyncer.rejectFailedWrite(o.batchId,s))),await ti(r)}})(n,t),Dh(n)&&Nh(n)}async function pl(n,t){const e=j(n);e.asyncQueue.verifyOperationInProgress(),k(nn,"RemoteStore received new credentials");const r=ln(e);e.Ea.add(3),await Br(e),r&&e.Ra.set("Unknown"),await e.remoteSyncer.handleCredentialChange(t),e.Ea.delete(3),await Zs(e)}async function py(n,t){const e=j(n);t?(e.Ea.delete(2),await Zs(e)):t||(e.Ea.add(2),await Br(e),e.Ra.set("Unknown"))}function Un(n){return n.ma||(n.ma=(function(e,r,s){const o=j(e);return o.sa(),new J_(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,s)})(n.datastore,n.asyncQueue,{Xo:sy.bind(null,n),t_:iy.bind(null,n),r_:oy.bind(null,n),H_:ay.bind(null,n)}),n.da.push((async t=>{t?(n.ma.B_(),Yo(n)?Xo(n):n.Ra.set("Unknown")):(await n.ma.stop(),Ph(n))}))),n.ma}function Le(n){return n.fa||(n.fa=(function(e,r,s){const o=j(e);return o.sa(),new Z_(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,s)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:cy.bind(null,n),r_:dy.bind(null,n),ta:hy.bind(null,n),na:fy.bind(null,n)}),n.da.push((async t=>{t?(n.fa.B_(),await ti(n)):(await n.fa.stop(),n.Ta.length>0&&(k(nn,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class Jo{constructor(t,e,r,s,o){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=r,this.op=s,this.removalCallback=o,this.deferred=new Ye,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((a=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(t,e,r,s,o){const a=Date.now()+r,l=new Jo(t,e,a,s,o);return l.start(r),l}start(t){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new x(P.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((t=>this.deferred.resolve(t)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Zo(n,t){if(fe("AsyncQueue",`${t}: ${n}`),Fn(n))return new x(P.UNAVAILABLE,`${t}: ${n}`);throw n}class Tn{static emptySet(t){return new Tn(t.comparator)}constructor(t){this.comparator=t?(e,r)=>t(e,r)||L.comparator(e.key,r.key):(e,r)=>L.comparator(e.key,r.key),this.keyedMap=ir(),this.sortedSet=new it(this.comparator)}has(t){return this.keyedMap.get(t)!=null}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal(((e,r)=>(t(e),!1)))}add(t){const e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))}delete(t){const e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this}isEqual(t){if(!(t instanceof Tn)||this.size!==t.size)return!1;const e=this.sortedSet.getIterator(),r=t.sortedSet.getIterator();for(;e.hasNext();){const s=e.getNext().key,o=r.getNext().key;if(!s.isEqual(o))return!1}return!0}toString(){const t=[];return this.forEach((e=>{t.push(e.toString())})),t.length===0?"DocumentSet ()":`DocumentSet (
  `+t.join(`  
`)+`
)`}copy(t,e){const r=new Tn;return r.comparator=this.comparator,r.keyedMap=t,r.sortedSet=e,r}}class ml{constructor(){this.ga=new it(L.comparator)}track(t){const e=t.doc.key,r=this.ga.get(e);r?t.type!==0&&r.type===3?this.ga=this.ga.insert(e,t):t.type===3&&r.type!==1?this.ga=this.ga.insert(e,{type:r.type,doc:t.doc}):t.type===2&&r.type===2?this.ga=this.ga.insert(e,{type:2,doc:t.doc}):t.type===2&&r.type===0?this.ga=this.ga.insert(e,{type:0,doc:t.doc}):t.type===1&&r.type===0?this.ga=this.ga.remove(e):t.type===1&&r.type===2?this.ga=this.ga.insert(e,{type:1,doc:r.doc}):t.type===0&&r.type===1?this.ga=this.ga.insert(e,{type:2,doc:t.doc}):U(63341,{Rt:t,pa:r}):this.ga=this.ga.insert(e,t)}ya(){const t=[];return this.ga.inorderTraversal(((e,r)=>{t.push(r)})),t}}class Nn{constructor(t,e,r,s,o,a,l,h,f){this.query=t,this.docs=e,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=o,this.fromCache=a,this.syncStateChanged=l,this.excludesMetadataChanges=h,this.hasCachedResults=f}static fromInitialDocuments(t,e,r,s,o){const a=[];return e.forEach((l=>{a.push({type:0,doc:l})})),new Nn(t,e,Tn.emptySet(e),a,r,s,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&Ks(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const e=this.docChanges,r=t.docChanges;if(e.length!==r.length)return!1;for(let s=0;s<e.length;s++)if(e[s].type!==r[s].type||!e[s].doc.isEqual(r[s].doc))return!1;return!0}}class my{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((t=>t.Da()))}}class gy{constructor(){this.queries=gl(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(e,r){const s=j(e),o=s.queries;s.queries=gl(),o.forEach(((a,l)=>{for(const h of l.Sa)h.onError(r)}))})(this,new x(P.ABORTED,"Firestore shutting down"))}}function gl(){return new an((n=>Jc(n)),Ks)}async function _y(n,t){const e=j(n);let r=3;const s=t.query;let o=e.queries.get(s);o?!o.ba()&&t.Da()&&(r=2):(o=new my,r=t.Da()?0:1);try{switch(r){case 0:o.wa=await e.onListen(s,!0);break;case 1:o.wa=await e.onListen(s,!1);break;case 2:await e.onFirstRemoteStoreListen(s)}}catch(a){const l=Zo(a,`Initialization of query '${mn(t.query)}' failed`);return void t.onError(l)}e.queries.set(s,o),o.Sa.push(t),t.va(e.onlineState),o.wa&&t.Fa(o.wa)&&ta(e)}async function yy(n,t){const e=j(n),r=t.query;let s=3;const o=e.queries.get(r);if(o){const a=o.Sa.indexOf(t);a>=0&&(o.Sa.splice(a,1),o.Sa.length===0?s=t.Da()?0:1:!o.ba()&&t.Da()&&(s=2))}switch(s){case 0:return e.queries.delete(r),e.onUnlisten(r,!0);case 1:return e.queries.delete(r),e.onUnlisten(r,!1);case 2:return e.onLastRemoteStoreUnlisten(r);default:return}}function vy(n,t){const e=j(n);let r=!1;for(const s of t){const o=s.query,a=e.queries.get(o);if(a){for(const l of a.Sa)l.Fa(s)&&(r=!0);a.wa=s}}r&&ta(e)}function Ey(n,t,e){const r=j(n),s=r.queries.get(t);if(s)for(const o of s.Sa)o.onError(e);r.queries.delete(t)}function ta(n){n.Ca.forEach((t=>{t.next()}))}var fo,_l;(_l=fo||(fo={})).Ma="default",_l.Cache="cache";class Ty{constructor(t,e,r){this.query=t,this.xa=e,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(t){if(!this.options.includeMetadataChanges){const r=[];for(const s of t.docChanges)s.type!==3&&r.push(s);t=new Nn(t.query,t.docs,t.oldDocs,r,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let e=!1;return this.Oa?this.Ba(t)&&(this.xa.next(t),e=!0):this.La(t,this.onlineState)&&(this.ka(t),e=!0),this.Na=t,e}onError(t){this.xa.error(t)}va(t){this.onlineState=t;let e=!1;return this.Na&&!this.Oa&&this.La(this.Na,t)&&(this.ka(this.Na),e=!0),e}La(t,e){if(!t.fromCache||!this.Da())return!0;const r=e!=="Offline";return(!this.options.qa||!r)&&(!t.docs.isEmpty()||t.hasCachedResults||e==="Offline")}Ba(t){if(t.docChanges.length>0)return!0;const e=this.Na&&this.Na.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&this.options.includeMetadataChanges===!0}ka(t){t=Nn.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.Oa=!0,this.xa.next(t)}Da(){return this.options.source!==fo.Cache}}class kh{constructor(t){this.key=t}}class xh{constructor(t){this.key=t}}class wy{constructor(t,e){this.query=t,this.Ya=e,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=z(),this.mutatedKeys=z(),this.eu=Zc(t),this.tu=new Tn(this.eu)}get nu(){return this.Ya}ru(t,e){const r=e?e.iu:new ml,s=e?e.tu:this.tu;let o=e?e.mutatedKeys:this.mutatedKeys,a=s,l=!1;const h=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,f=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(t.inorderTraversal(((p,y)=>{const v=s.get(p),R=Ws(this.query,y)?y:null,C=!!v&&this.mutatedKeys.has(v.key),D=!!R&&(R.hasLocalMutations||this.mutatedKeys.has(R.key)&&R.hasCommittedMutations);let V=!1;v&&R?v.data.isEqual(R.data)?C!==D&&(r.track({type:3,doc:R}),V=!0):this.su(v,R)||(r.track({type:2,doc:R}),V=!0,(h&&this.eu(R,h)>0||f&&this.eu(R,f)<0)&&(l=!0)):!v&&R?(r.track({type:0,doc:R}),V=!0):v&&!R&&(r.track({type:1,doc:v}),V=!0,(h||f)&&(l=!0)),V&&(R?(a=a.add(R),o=D?o.add(p):o.delete(p)):(a=a.delete(p),o=o.delete(p)))})),this.query.limit!==null)for(;a.size>this.query.limit;){const p=this.query.limitType==="F"?a.last():a.first();a=a.delete(p.key),o=o.delete(p.key),r.track({type:1,doc:p})}return{tu:a,iu:r,Cs:l,mutatedKeys:o}}su(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations}applyChanges(t,e,r,s){const o=this.tu;this.tu=t.tu,this.mutatedKeys=t.mutatedKeys;const a=t.iu.ya();a.sort(((p,y)=>(function(R,C){const D=V=>{switch(V){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return U(20277,{Rt:V})}};return D(R)-D(C)})(p.type,y.type)||this.eu(p.doc,y.doc))),this.ou(r),s=s??!1;const l=e&&!s?this._u():[],h=this.Xa.size===0&&this.current&&!s?1:0,f=h!==this.Za;return this.Za=h,a.length!==0||f?{snapshot:new Nn(this.query,t.tu,o,a,t.mutatedKeys,h===0,f,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:l}:{au:l}}va(t){return this.current&&t==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new ml,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(t){return!this.Ya.has(t)&&!!this.tu.has(t)&&!this.tu.get(t).hasLocalMutations}ou(t){t&&(t.addedDocuments.forEach((e=>this.Ya=this.Ya.add(e))),t.modifiedDocuments.forEach((e=>{})),t.removedDocuments.forEach((e=>this.Ya=this.Ya.delete(e))),this.current=t.current)}_u(){if(!this.current)return[];const t=this.Xa;this.Xa=z(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))}));const e=[];return t.forEach((r=>{this.Xa.has(r)||e.push(new xh(r))})),this.Xa.forEach((r=>{t.has(r)||e.push(new kh(r))})),e}cu(t){this.Ya=t.Qs,this.Xa=z();const e=this.ru(t.documents);return this.applyChanges(e,!0)}lu(){return Nn.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const ea="SyncEngine";class Iy{constructor(t,e,r){this.query=t,this.targetId=e,this.view=r}}class Ay{constructor(t){this.key=t,this.hu=!1}}class Ry{constructor(t,e,r,s,o,a){this.localStore=t,this.remoteStore=e,this.eventManager=r,this.sharedClientState=s,this.currentUser=o,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new an((l=>Jc(l)),Ks),this.Iu=new Map,this.Eu=new Set,this.du=new it(L.comparator),this.Au=new Map,this.Ru=new zo,this.Vu={},this.mu=new Map,this.fu=Dn.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function Sy(n,t,e=!0){const r=Bh(n);let s;const o=r.Tu.get(t);return o?(r.sharedClientState.addLocalQueryTarget(o.targetId),s=o.view.lu()):s=await Oh(r,t,e,!0),s}async function by(n,t){const e=Bh(n);await Oh(e,t,!0,!1)}async function Oh(n,t,e,r){const s=await z_(n.localStore,te(t)),o=s.targetId,a=n.sharedClientState.addLocalQueryTarget(o,e);let l;return r&&(l=await Cy(n,t,o,a==="current",s.resumeToken)),n.isPrimaryClient&&e&&bh(n.remoteStore,s),l}async function Cy(n,t,e,r,s){n.pu=(y,v,R)=>(async function(D,V,M,F){let O=V.view.ru(M);O.Cs&&(O=await ll(D.localStore,V.query,!1).then((({documents:T})=>V.view.ru(T,O))));const X=F&&F.targetChanges.get(V.targetId),nt=F&&F.targetMismatches.get(V.targetId)!=null,rt=V.view.applyChanges(O,D.isPrimaryClient,X,nt);return vl(D,V.targetId,rt.au),rt.snapshot})(n,y,v,R);const o=await ll(n.localStore,t,!0),a=new wy(t,o.Qs),l=a.ru(o.documents),h=Ur.createSynthesizedTargetChangeForCurrentChange(e,r&&n.onlineState!=="Offline",s),f=a.applyChanges(l,n.isPrimaryClient,h);vl(n,e,f.au);const p=new Iy(t,e,a);return n.Tu.set(t,p),n.Iu.has(e)?n.Iu.get(e).push(t):n.Iu.set(e,[t]),f.snapshot}async function Py(n,t,e){const r=j(n),s=r.Tu.get(t),o=r.Iu.get(s.targetId);if(o.length>1)return r.Iu.set(s.targetId,o.filter((a=>!Ks(a,t)))),void r.Tu.delete(t);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await co(r.localStore,s.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(s.targetId),e&&Wo(r.remoteStore,s.targetId),po(r,s.targetId)})).catch(Ln)):(po(r,s.targetId),await co(r.localStore,s.targetId,!0))}async function Vy(n,t){const e=j(n),r=e.Tu.get(t),s=e.Iu.get(r.targetId);e.isPrimaryClient&&s.length===1&&(e.sharedClientState.removeLocalQueryTarget(r.targetId),Wo(e.remoteStore,r.targetId))}async function Dy(n,t,e){const r=Fy(n);try{const s=await(function(a,l){const h=j(a),f=et.now(),p=l.reduce(((R,C)=>R.add(C.key)),z());let y,v;return h.persistence.runTransaction("Locally write mutations","readwrite",(R=>{let C=de(),D=z();return h.Ns.getEntries(R,p).next((V=>{C=V,C.forEach(((M,F)=>{F.isValidDocument()||(D=D.add(M))}))})).next((()=>h.localDocuments.getOverlayedDocuments(R,C))).next((V=>{y=V;const M=[];for(const F of l){const O=$g(F,y.get(F.key).overlayedDocument);O!=null&&M.push(new un(F.key,O,Hc(O.value.mapValue),ce.exists(!0)))}return h.mutationQueue.addMutationBatch(R,f,M,l)})).next((V=>{v=V;const M=V.applyToLocalDocumentSet(y,D);return h.documentOverlayCache.saveOverlays(R,V.batchId,M)}))})).then((()=>({batchId:v.batchId,changes:eh(y)})))})(r.localStore,t);r.sharedClientState.addPendingMutation(s.batchId),(function(a,l,h){let f=a.Vu[a.currentUser.toKey()];f||(f=new it($)),f=f.insert(l,h),a.Vu[a.currentUser.toKey()]=f})(r,s.batchId,e),await jr(r,s.changes),await ti(r.remoteStore)}catch(s){const o=Zo(s,"Failed to persist write");e.reject(o)}}async function Mh(n,t){const e=j(n);try{const r=await j_(e.localStore,t);t.targetChanges.forEach(((s,o)=>{const a=e.Au.get(o);a&&(Q(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?a.hu=!0:s.modifiedDocuments.size>0?Q(a.hu,14607):s.removedDocuments.size>0&&(Q(a.hu,42227),a.hu=!1))})),await jr(e,r,t)}catch(r){await Ln(r)}}function yl(n,t,e){const r=j(n);if(r.isPrimaryClient&&e===0||!r.isPrimaryClient&&e===1){const s=[];r.Tu.forEach(((o,a)=>{const l=a.view.va(t);l.snapshot&&s.push(l.snapshot)})),(function(a,l){const h=j(a);h.onlineState=l;let f=!1;h.queries.forEach(((p,y)=>{for(const v of y.Sa)v.va(l)&&(f=!0)})),f&&ta(h)})(r.eventManager,t),s.length&&r.Pu.H_(s),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function Ny(n,t,e){const r=j(n);r.sharedClientState.updateQueryState(t,"rejected",e);const s=r.Au.get(t),o=s&&s.key;if(o){let a=new it(L.comparator);a=a.insert(o,Rt.newNoDocument(o,B.min()));const l=z().add(o),h=new Ys(B.min(),new Map,new it($),a,l);await Mh(r,h),r.du=r.du.remove(o),r.Au.delete(t),na(r)}else await co(r.localStore,t,!1).then((()=>po(r,t,e))).catch(Ln)}async function ky(n,t){const e=j(n),r=t.batch.batchId;try{const s=await B_(e.localStore,t);Fh(e,r,null),Lh(e,r),e.sharedClientState.updateMutationState(r,"acknowledged"),await jr(e,s)}catch(s){await Ln(s)}}async function xy(n,t,e){const r=j(n);try{const s=await(function(a,l){const h=j(a);return h.persistence.runTransaction("Reject batch","readwrite-primary",(f=>{let p;return h.mutationQueue.lookupMutationBatch(f,l).next((y=>(Q(y!==null,37113),p=y.keys(),h.mutationQueue.removeMutationBatch(f,y)))).next((()=>h.mutationQueue.performConsistencyCheck(f))).next((()=>h.documentOverlayCache.removeOverlaysForBatchId(f,p,l))).next((()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(f,p))).next((()=>h.localDocuments.getDocuments(f,p)))}))})(r.localStore,t);Fh(r,t,e),Lh(r,t),r.sharedClientState.updateMutationState(t,"rejected",e),await jr(r,s)}catch(s){await Ln(s)}}function Lh(n,t){(n.mu.get(t)||[]).forEach((e=>{e.resolve()})),n.mu.delete(t)}function Fh(n,t,e){const r=j(n);let s=r.Vu[r.currentUser.toKey()];if(s){const o=s.get(t);o&&(e?o.reject(e):o.resolve(),s=s.remove(t)),r.Vu[r.currentUser.toKey()]=s}}function po(n,t,e=null){n.sharedClientState.removeLocalQueryTarget(t);for(const r of n.Iu.get(t))n.Tu.delete(r),e&&n.Pu.yu(r,e);n.Iu.delete(t),n.isPrimaryClient&&n.Ru.jr(t).forEach((r=>{n.Ru.containsKey(r)||Uh(n,r)}))}function Uh(n,t){n.Eu.delete(t.path.canonicalString());const e=n.du.get(t);e!==null&&(Wo(n.remoteStore,e),n.du=n.du.remove(t),n.Au.delete(e),na(n))}function vl(n,t,e){for(const r of e)r instanceof kh?(n.Ru.addReference(r.key,t),Oy(n,r)):r instanceof xh?(k(ea,"Document no longer in limbo: "+r.key),n.Ru.removeReference(r.key,t),n.Ru.containsKey(r.key)||Uh(n,r.key)):U(19791,{wu:r})}function Oy(n,t){const e=t.key,r=e.path.canonicalString();n.du.get(e)||n.Eu.has(r)||(k(ea,"New document in limbo: "+e),n.Eu.add(r),na(n))}function na(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const t=n.Eu.values().next().value;n.Eu.delete(t);const e=new L(tt.fromString(t)),r=n.fu.next();n.Au.set(r,new Ay(e)),n.du=n.du.insert(e,r),bh(n.remoteStore,new Re(te(Uo(e.path)),r,"TargetPurposeLimboResolution",$s.ce))}}async function jr(n,t,e){const r=j(n),s=[],o=[],a=[];r.Tu.isEmpty()||(r.Tu.forEach(((l,h)=>{a.push(r.pu(h,t,e).then((f=>{if((f||e)&&r.isPrimaryClient){const p=f?!f.fromCache:e?.targetChanges.get(h.targetId)?.current;r.sharedClientState.updateQueryState(h.targetId,p?"current":"not-current")}if(f){s.push(f);const p=Go.As(h.targetId,f);o.push(p)}})))})),await Promise.all(a),r.Pu.H_(s),await(async function(h,f){const p=j(h);try{await p.persistence.runTransaction("notifyLocalViewChanges","readwrite",(y=>b.forEach(f,(v=>b.forEach(v.Es,(R=>p.persistence.referenceDelegate.addReference(y,v.targetId,R))).next((()=>b.forEach(v.ds,(R=>p.persistence.referenceDelegate.removeReference(y,v.targetId,R)))))))))}catch(y){if(!Fn(y))throw y;k(Ko,"Failed to update sequence numbers: "+y)}for(const y of f){const v=y.targetId;if(!y.fromCache){const R=p.Ms.get(v),C=R.snapshotVersion,D=R.withLastLimboFreeSnapshotVersion(C);p.Ms=p.Ms.insert(v,D)}}})(r.localStore,o))}async function My(n,t){const e=j(n);if(!e.currentUser.isEqual(t)){k(ea,"User change. New user:",t.toKey());const r=await Ih(e.localStore,t);e.currentUser=t,(function(o,a){o.mu.forEach((l=>{l.forEach((h=>{h.reject(new x(P.CANCELLED,a))}))})),o.mu.clear()})(e,"'waitForPendingWrites' promise is rejected due to a user change."),e.sharedClientState.handleUserChange(t,r.removedBatchIds,r.addedBatchIds),await jr(e,r.Ls)}}function Ly(n,t){const e=j(n),r=e.Au.get(t);if(r&&r.hu)return z().add(r.key);{let s=z();const o=e.Iu.get(t);if(!o)return s;for(const a of o){const l=e.Tu.get(a);s=s.unionWith(l.view.nu)}return s}}function Bh(n){const t=j(n);return t.remoteStore.remoteSyncer.applyRemoteEvent=Mh.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=Ly.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Ny.bind(null,t),t.Pu.H_=vy.bind(null,t.eventManager),t.Pu.yu=Ey.bind(null,t.eventManager),t}function Fy(n){const t=j(n);return t.remoteStore.remoteSyncer.applySuccessfulWrite=ky.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=xy.bind(null,t),t}class ks{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=Js(t.databaseInfo.databaseId),this.sharedClientState=this.Du(t),this.persistence=this.Cu(t),await this.persistence.start(),this.localStore=this.vu(t),this.gcScheduler=this.Fu(t,this.localStore),this.indexBackfillerScheduler=this.Mu(t,this.localStore)}Fu(t,e){return null}Mu(t,e){return null}vu(t){return U_(this.persistence,new M_,t.initialUser,this.serializer)}Cu(t){return new wh(Ho.mi,this.serializer)}Du(t){return new G_}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}ks.provider={build:()=>new ks};class Uy extends ks{constructor(t){super(),this.cacheSizeBytes=t}Fu(t,e){Q(this.persistence.referenceDelegate instanceof Ds,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new T_(r,t.asyncQueue,e)}Cu(t){const e=this.cacheSizeBytes!==void 0?kt.withCacheSize(this.cacheSizeBytes):kt.DEFAULT;return new wh((r=>Ds.mi(r,e)),this.serializer)}}class mo{async initialize(t,e){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>yl(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=My.bind(null,this.syncEngine),await py(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return(function(){return new gy})()}createDatastore(t){const e=Js(t.databaseInfo.databaseId),r=(function(o){return new Y_(o)})(t.databaseInfo);return(function(o,a,l,h){return new ey(o,a,l,h)})(t.authCredentials,t.appCheckCredentials,r,e)}createRemoteStore(t){return(function(r,s,o,a,l){return new ry(r,s,o,a,l)})(this.localStore,this.datastore,t.asyncQueue,(e=>yl(this.syncEngine,e,0)),(function(){return fl.v()?new fl:new K_})())}createSyncEngine(t,e){return(function(s,o,a,l,h,f,p){const y=new Ry(s,o,a,l,h,f);return p&&(y.gu=!0),y})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}async terminate(){await(async function(e){const r=j(e);k(nn,"RemoteStore shutting down."),r.Ea.add(5),await Br(r),r.Aa.shutdown(),r.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}mo.provider={build:()=>new mo};class By{constructor(t){this.observer=t,this.muted=!1}next(t){this.muted||this.observer.next&&this.Ou(this.observer.next,t)}error(t){this.muted||(this.observer.error?this.Ou(this.observer.error,t):fe("Uncaught Error in snapshot listener:",t.toString()))}Nu(){this.muted=!0}Ou(t,e){setTimeout((()=>{this.muted||t(e)}),0)}}const Fe="FirestoreClient";class jy{constructor(t,e,r,s,o){this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=r,this.databaseInfo=s,this.user=At.UNAUTHENTICATED,this.clientId=No.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(r,(async a=>{k(Fe,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a})),this.appCheckCredentials.start(r,(a=>(k(Fe,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}terminate(){this.asyncQueue.enterRestrictedMode();const t=new Ye;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(e){const r=Zo(e,"Failed to shutdown persistence");t.reject(r)}})),t.promise}}async function ji(n,t){n.asyncQueue.verifyOperationInProgress(),k(Fe,"Initializing OfflineComponentProvider");const e=n.configuration;await t.initialize(e);let r=e.initialUser;n.setCredentialChangeListener((async s=>{r.isEqual(s)||(await Ih(t.localStore,s),r=s)})),t.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=t}async function El(n,t){n.asyncQueue.verifyOperationInProgress();const e=await qy(n);k(Fe,"Initializing OnlineComponentProvider"),await t.initialize(e,n.configuration),n.setCredentialChangeListener((r=>pl(t.remoteStore,r))),n.setAppCheckTokenChangeListener(((r,s)=>pl(t.remoteStore,s))),n._onlineComponents=t}async function qy(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){k(Fe,"Using user provided OfflineComponentProvider");try{await ji(n,n._uninitializedComponentsProvider._offline)}catch(t){const e=t;if(!(function(s){return s.name==="FirebaseError"?s.code===P.FAILED_PRECONDITION||s.code===P.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11})(e))throw e;bn("Error using user provided cache. Falling back to memory cache: "+e),await ji(n,new ks)}}else k(Fe,"Using default OfflineComponentProvider"),await ji(n,new Uy(void 0));return n._offlineComponents}async function jh(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(k(Fe,"Using user provided OnlineComponentProvider"),await El(n,n._uninitializedComponentsProvider._online)):(k(Fe,"Using default OnlineComponentProvider"),await El(n,new mo))),n._onlineComponents}function $y(n){return jh(n).then((t=>t.syncEngine))}async function Tl(n){const t=await jh(n),e=t.eventManager;return e.onListen=Sy.bind(null,t.syncEngine),e.onUnlisten=Py.bind(null,t.syncEngine),e.onFirstRemoteStoreListen=by.bind(null,t.syncEngine),e.onLastRemoteStoreUnlisten=Vy.bind(null,t.syncEngine),e}function qh(n){const t={};return n.timeoutSeconds!==void 0&&(t.timeoutSeconds=n.timeoutSeconds),t}const wl=new Map;const $h="firestore.googleapis.com",Il=!0;class Al{constructor(t){if(t.host===void 0){if(t.ssl!==void 0)throw new x(P.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=$h,this.ssl=Il}else this.host=t.host,this.ssl=t.ssl??Il;if(this.isUsingEmulator=t.emulatorOptions!==void 0,this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=Th;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<v_)throw new x(P.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}ng("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=qh(t.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new x(P.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new x(P.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new x(P.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&(function(r,s){return r.timeoutSeconds===s.timeoutSeconds})(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class ei{constructor(t,e,r,s){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Al({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new x(P.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(t){if(this._settingsFrozen)throw new x(P.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Al(t),this._emulatorOptions=t.emulatorOptions||{},t.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new Gm;switch(r.type){case"firstParty":return new Xm(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new x(P.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(t.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(e){const r=wl.get(e);r&&(k("ComponentProvider","Removing Datastore"),wl.delete(e),r.terminate())})(this),Promise.resolve()}}function zy(n,t,e,r={}){n=pr(n,ei);const s=Po(t),o=n._getSettings(),a={...o,emulatorOptions:n._getEmulatorOptions()},l=`${t}:${e}`;s&&(Tp(`https://${l}`),Rp("Firestore",!0)),o.host!==$h&&o.host!==l&&bn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const h={...o,host:l,ssl:s,emulatorOptions:r};if(!Es(h,a)&&(n._setSettings(h),r.mockUserToken)){let f,p;if(typeof r.mockUserToken=="string")f=r.mockUserToken,p=At.MOCK_USER;else{f=wp(r.mockUserToken,n._app?.options.projectId);const y=r.mockUserToken.sub||r.mockUserToken.user_id;if(!y)throw new x(P.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");p=new At(y)}n._authCredentials=new Km(new kc(f,p))}}class ni{constructor(t,e,r){this.converter=e,this._query=r,this.type="query",this.firestore=t}withConverter(t){return new ni(this.firestore,t,this._query)}}class gt{constructor(t,e,r){this.converter=e,this._key=r,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ne(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new gt(this.firestore,t,this._key)}toJSON(){return{type:gt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(t,e,r){if(Lr(e,gt._jsonSchema))return new gt(t,r||null,new L(tt.fromString(e.referencePath)))}}gt._jsonSchemaVersion="firestore/documentReference/1.0",gt._jsonSchema={type:ct("string",gt._jsonSchemaVersion),referencePath:ct("string")};class Ne extends ni{constructor(t,e,r){super(t,e,Uo(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new gt(this.firestore,null,new L(t))}withConverter(t){return new Ne(this.firestore,t,this._path)}}function zh(n,t,...e){if(n=Sn(n),xc("collection","path",t),n instanceof ei){const r=tt.fromString(t,...e);return Lu(r),new Ne(n,null,r)}{if(!(n instanceof gt||n instanceof Ne))throw new x(P.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(tt.fromString(t,...e));return Lu(r),new Ne(n.firestore,null,r)}}function Hy(n,t,...e){if(n=Sn(n),arguments.length===1&&(t=No.newId()),xc("doc","path",t),n instanceof ei){const r=tt.fromString(t,...e);return Mu(r),new gt(n,null,new L(r))}{if(!(n instanceof gt||n instanceof Ne))throw new x(P.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(tt.fromString(t,...e));return Mu(r),new gt(n.firestore,n instanceof Ne?n.converter:null,new L(r))}}const Rl="AsyncQueue";class Sl{constructor(t=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Rh(this,"async_queue_retry"),this._c=()=>{const r=Bi();r&&k(Rl,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=t;const e=Bi();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.uc(),this.cc(t)}enterRestrictedMode(t){if(!this.ec){this.ec=!0,this.sc=t||!1;const e=Bi();e&&typeof e.removeEventListener=="function"&&e.removeEventListener("visibilitychange",this._c)}}enqueue(t){if(this.uc(),this.ec)return new Promise((()=>{}));const e=new Ye;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(t().then(e.resolve,e.reject),e.promise))).then((()=>e.promise))}enqueueRetryable(t){this.enqueueAndForget((()=>(this.Xu.push(t),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(t){if(!Fn(t))throw t;k(Rl,"Operation failed with retryable error: "+t)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(t){const e=this.ac.then((()=>(this.rc=!0,t().catch((r=>{throw this.nc=r,this.rc=!1,fe("INTERNAL UNHANDLED ERROR: ",bl(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=e,e}enqueueAfterDelay(t,e,r){this.uc(),this.oc.indexOf(t)>-1&&(e=0);const s=Jo.createAndSchedule(this,t,e,r,(o=>this.hc(o)));return this.tc.push(s),s}uc(){this.nc&&U(47125,{Pc:bl(this.nc)})}verifyOperationInProgress(){}async Tc(){let t;do t=this.ac,await t;while(t!==this.ac)}Ic(t){for(const e of this.tc)if(e.timerId===t)return!0;return!1}Ec(t){return this.Tc().then((()=>{this.tc.sort(((e,r)=>e.targetTimeMs-r.targetTimeMs));for(const e of this.tc)if(e.skipDelay(),t!=="all"&&e.timerId===t)break;return this.Tc()}))}dc(t){this.oc.push(t)}hc(t){const e=this.tc.indexOf(t);this.tc.splice(e,1)}}function bl(n){let t=n.message||"";return n.stack&&(t=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),t}function Cl(n){return(function(e,r){if(typeof e!="object"||e===null)return!1;const s=e;for(const o of r)if(o in s&&typeof s[o]=="function")return!0;return!1})(n,["next","error","complete"])}class xs extends ei{constructor(t,e,r,s){super(t,e,r,s),this.type="firestore",this._queue=new Sl,this._persistenceKey=s?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const t=this._firestoreClient.terminate();this._queue=new Sl(t),this._firestoreClient=void 0,await t}}}function Gy(n,t){const e=typeof n=="object"?n:Om(),r=typeof n=="string"?n:As,s=Vm(e,"firestore").getImmediate({identifier:r});if(!s._initialized){const o=vp("firestore");o&&zy(s,...o)}return s}function Hh(n){if(n._terminated)throw new x(P.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||Ky(n),n._firestoreClient}function Ky(n){const t=n._freezeSettings(),e=(function(s,o,a,l){return new dg(s,o,a,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,qh(l.experimentalLongPollingOptions),l.useFetchStreams,l.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,t);n._componentsProvider||t.localCache?._offlineComponentProvider&&t.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:t.localCache._offlineComponentProvider,_online:t.localCache._onlineComponentProvider}),n._firestoreClient=new jy(n._authCredentials,n._appCheckCredentials,n._queue,e,n._componentsProvider&&(function(s){const o=s?._online.build();return{_offline:s?._offline.build(o),_online:o}})(n._componentsProvider))}class $t{constructor(t){this._byteString=t}static fromBase64String(t){try{return new $t(vt.fromBase64String(t))}catch(e){throw new x(P.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(t){return new $t(vt.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}toJSON(){return{type:$t._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(t){if(Lr(t,$t._jsonSchema))return $t.fromBase64String(t.bytes)}}$t._jsonSchemaVersion="firestore/bytes/1.0",$t._jsonSchema={type:ct("string",$t._jsonSchemaVersion),bytes:ct("string")};class ra{constructor(...t){for(let e=0;e<t.length;++e)if(t[e].length===0)throw new x(P.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new yt(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}class Gh{constructor(t){this._methodName=t}}class ne{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new x(P.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new x(P.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}_compareTo(t){return $(this._lat,t._lat)||$(this._long,t._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:ne._jsonSchemaVersion}}static fromJSON(t){if(Lr(t,ne._jsonSchema))return new ne(t.latitude,t.longitude)}}ne._jsonSchemaVersion="firestore/geoPoint/1.0",ne._jsonSchema={type:ct("string",ne._jsonSchemaVersion),latitude:ct("number"),longitude:ct("number")};class re{constructor(t){this._values=(t||[]).map((e=>e))}toArray(){return this._values.map((t=>t))}isEqual(t){return(function(r,s){if(r.length!==s.length)return!1;for(let o=0;o<r.length;++o)if(r[o]!==s[o])return!1;return!0})(this._values,t._values)}toJSON(){return{type:re._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(t){if(Lr(t,re._jsonSchema)){if(Array.isArray(t.vectorValues)&&t.vectorValues.every((e=>typeof e=="number")))return new re(t.vectorValues);throw new x(P.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}re._jsonSchemaVersion="firestore/vectorValue/1.0",re._jsonSchema={type:ct("string",re._jsonSchemaVersion),vectorValues:ct("object")};const Wy=/^__.*__$/;class Qy{constructor(t,e,r){this.data=t,this.fieldMask=e,this.fieldTransforms=r}toMutation(t,e){return this.fieldMask!==null?new un(t,this.data,this.fieldMask,e,this.fieldTransforms):new Fr(t,this.data,e,this.fieldTransforms)}}function Kh(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw U(40011,{Ac:n})}}class sa{constructor(t,e,r,s,o,a){this.settings=t,this.databaseId=e,this.serializer=r,this.ignoreUndefinedProperties=s,o===void 0&&this.Rc(),this.fieldTransforms=o||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(t){return new sa({...this.settings,...t},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(t){const e=this.path?.child(t),r=this.Vc({path:e,fc:!1});return r.gc(t),r}yc(t){const e=this.path?.child(t),r=this.Vc({path:e,fc:!1});return r.Rc(),r}wc(t){return this.Vc({path:void 0,fc:!0})}Sc(t){return Os(t,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(t){return this.fieldMask.find((e=>t.isPrefixOf(e)))!==void 0||this.fieldTransforms.find((e=>t.isPrefixOf(e.field)))!==void 0}Rc(){if(this.path)for(let t=0;t<this.path.length;t++)this.gc(this.path.get(t))}gc(t){if(t.length===0)throw this.Sc("Document fields must not be empty");if(Kh(this.Ac)&&Wy.test(t))throw this.Sc('Document fields cannot begin and end with "__"')}}class Xy{constructor(t,e,r){this.databaseId=t,this.ignoreUndefinedProperties=e,this.serializer=r||Js(t)}Cc(t,e,r,s=!1){return new sa({Ac:t,methodName:e,Dc:r,path:yt.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Yy(n){const t=n._freezeSettings(),e=Js(n._databaseId);return new Xy(n._databaseId,!!t.ignoreUndefinedProperties,e)}function Jy(n,t,e,r,s,o={}){const a=n.Cc(o.merge||o.mergeFields?2:0,t,e,s);Yh("Data must be an object, but it was:",a,r);const l=Qh(r,a);let h,f;if(o.merge)h=new Ht(a.fieldMask),f=a.fieldTransforms;else if(o.mergeFields){const p=[];for(const y of o.mergeFields){const v=Zy(t,y,e);if(!a.contains(v))throw new x(P.INVALID_ARGUMENT,`Field '${v}' is specified in your field mask but missing from your input data.`);ev(p,v)||p.push(v)}h=new Ht(p),f=a.fieldTransforms.filter((y=>h.covers(y.field)))}else h=null,f=a.fieldTransforms;return new Qy(new qt(l),h,f)}function Wh(n,t){if(Xh(n=Sn(n)))return Yh("Unsupported field value:",t,n),Qh(n,t);if(n instanceof Gh)return(function(r,s){if(!Kh(s.Ac))throw s.Sc(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${r._methodName}() is not currently supported inside arrays`);const o=r._toFieldTransform(s);o&&s.fieldTransforms.push(o)})(n,t),null;if(n===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),n instanceof Array){if(t.settings.fc&&t.Ac!==4)throw t.Sc("Nested arrays are not supported");return(function(r,s){const o=[];let a=0;for(const l of r){let h=Wh(l,s.wc(a));h==null&&(h={nullValue:"NULL_VALUE"}),o.push(h),a++}return{arrayValue:{values:o}}})(n,t)}return(function(r,s){if((r=Sn(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return Lg(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const o=et.fromDate(r);return{timestampValue:Vs(s.serializer,o)}}if(r instanceof et){const o=new et(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Vs(s.serializer,o)}}if(r instanceof ne)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof $t)return{bytesValue:ph(s.serializer,r._byteString)};if(r instanceof gt){const o=s.databaseId,a=r.firestore._databaseId;if(!a.isEqual(o))throw s.Sc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:$o(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof re)return(function(a,l){return{mapValue:{fields:{[$c]:{stringValue:zc},[Rs]:{arrayValue:{values:a.toArray().map((f=>{if(typeof f!="number")throw l.Sc("VectorValues must only contain numeric values.");return Bo(l.serializer,f)}))}}}}}})(r,s);throw s.Sc(`Unsupported field value: ${ko(r)}`)})(n,t)}function Qh(n,t){const e={};return Lc(n)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):on(n,((r,s)=>{const o=Wh(s,t.mc(r));o!=null&&(e[r]=o)})),{mapValue:{fields:e}}}function Xh(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof et||n instanceof ne||n instanceof $t||n instanceof gt||n instanceof Gh||n instanceof re)}function Yh(n,t,e){if(!Xh(e)||!Oc(e)){const r=ko(e);throw r==="an object"?t.Sc(n+" a custom object"):t.Sc(n+" "+r)}}function Zy(n,t,e){if((t=Sn(t))instanceof ra)return t._internalPath;if(typeof t=="string")return Jh(n,t);throw Os("Field path arguments must be of type string or ",n,!1,void 0,e)}const tv=new RegExp("[~\\*/\\[\\]]");function Jh(n,t,e){if(t.search(tv)>=0)throw Os(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,e);try{return new ra(...t.split("."))._internalPath}catch{throw Os(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,e)}}function Os(n,t,e,r,s){const o=r&&!r.isEmpty(),a=s!==void 0;let l=`Function ${t}() called with invalid data`;e&&(l+=" (via `toFirestore()`)"),l+=". ";let h="";return(o||a)&&(h+=" (found",o&&(h+=` in field ${r}`),a&&(h+=` in document ${s}`),h+=")"),new x(P.INVALID_ARGUMENT,l+n+h)}function ev(n,t){return n.some((e=>e.isEqual(t)))}class Zh{constructor(t,e,r,s,o){this._firestore=t,this._userDataWriter=e,this._key=r,this._document=s,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new gt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const t=new nv(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const e=this._document.data.field(tf("DocumentSnapshot.get",t));if(e!==null)return this._userDataWriter.convertValue(e)}}}class nv extends Zh{data(){return super.data()}}function tf(n,t){return typeof t=="string"?Jh(n,t):t instanceof ra?t._internalPath:t._delegate._internalPath}function rv(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new x(P.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class sv{convertValue(t,e="none"){switch(Me(t)){case 0:return null;case 1:return t.booleanValue;case 2:return at(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(Oe(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 11:return this.convertObject(t.mapValue,e);case 10:return this.convertVectorValue(t.mapValue);default:throw U(62114,{value:t})}}convertObject(t,e){return this.convertObjectMap(t.fields,e)}convertObjectMap(t,e="none"){const r={};return on(t,((s,o)=>{r[s]=this.convertValue(o,e)})),r}convertVectorValue(t){const e=t.fields?.[Rs].arrayValue?.values?.map((r=>at(r.doubleValue)));return new re(e)}convertGeoPoint(t){return new ne(at(t.latitude),at(t.longitude))}convertArray(t,e){return(t.values||[]).map((r=>this.convertValue(r,e)))}convertServerTimestamp(t,e){switch(e){case"previous":const r=Hs(t);return r==null?null:this.convertValue(r,e);case"estimate":return this.convertTimestamp(Cr(t));default:return null}}convertTimestamp(t){const e=xe(t);return new et(e.seconds,e.nanos)}convertDocumentKey(t,e){const r=tt.fromString(t);Q(Eh(r),9688,{name:t});const s=new Pr(r.get(1),r.get(3)),o=new L(r.popFirst(5));return s.isEqual(e)||fe(`Document ${o} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${e.projectId}/${e.database}) instead.`),o}}function iv(n,t,e){let r;return r=n?n.toFirestore(t):t,r}class ar{constructor(t,e){this.hasPendingWrites=t,this.fromCache=e}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class Je extends Zh{constructor(t,e,r,s,o,a){super(t,e,r,s,a),this._firestore=t,this._firestoreImpl=t,this.metadata=o}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const e=new ms(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,e={}){if(this._document){const r=this._document.data.field(tf("DocumentSnapshot.get",t));if(r!==null)return this._userDataWriter.convertValue(r,e.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new x(P.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t=this._document,e={};return e.type=Je._jsonSchemaVersion,e.bundle="",e.bundleSource="DocumentSnapshot",e.bundleName=this._key.toString(),!t||!t.isValidDocument()||!t.isFoundDocument()?e:(this._userDataWriter.convertObjectMap(t.data.value.mapValue.fields,"previous"),e.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),e)}}Je._jsonSchemaVersion="firestore/documentSnapshot/1.0",Je._jsonSchema={type:ct("string",Je._jsonSchemaVersion),bundleSource:ct("string","DocumentSnapshot"),bundleName:ct("string"),bundle:ct("string")};class ms extends Je{data(t={}){return super.data(t)}}class wn{constructor(t,e,r,s){this._firestore=t,this._userDataWriter=e,this._snapshot=s,this.metadata=new ar(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const t=[];return this.forEach((e=>t.push(e))),t}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(t,e){this._snapshot.docs.forEach((r=>{t.call(e,new ms(this._firestore,this._userDataWriter,r.key,r,new ar(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(t={}){const e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new x(P.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=(function(s,o){if(s._snapshot.oldDocs.isEmpty()){let a=0;return s._snapshot.docChanges.map((l=>{const h=new ms(s._firestore,s._userDataWriter,l.doc.key,l.doc,new ar(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);return l.doc,{type:"added",doc:h,oldIndex:-1,newIndex:a++}}))}{let a=s._snapshot.oldDocs;return s._snapshot.docChanges.filter((l=>o||l.type!==3)).map((l=>{const h=new ms(s._firestore,s._userDataWriter,l.doc.key,l.doc,new ar(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);let f=-1,p=-1;return l.type!==0&&(f=a.indexOf(l.doc.key),a=a.delete(l.doc.key)),l.type!==1&&(a=a.add(l.doc),p=a.indexOf(l.doc.key)),{type:ov(l.type),doc:h,oldIndex:f,newIndex:p}}))}})(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new x(P.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t={};t.type=wn._jsonSchemaVersion,t.bundleSource="QuerySnapshot",t.bundleName=No.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const e=[],r=[],s=[];return this.docs.forEach((o=>{o._document!==null&&(e.push(o._document),r.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),s.push(o.ref.path))})),t.bundle=(this._firestore,this.query._query,t.bundleName,"NOT SUPPORTED"),t}}function ov(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return U(61501,{type:n})}}wn._jsonSchemaVersion="firestore/querySnapshot/1.0",wn._jsonSchema={type:ct("string",wn._jsonSchemaVersion),bundleSource:ct("string","QuerySnapshot"),bundleName:ct("string"),bundle:ct("string")};class ef extends sv{constructor(t){super(),this.firestore=t}convertBytes(t){return new $t(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new gt(this.firestore,null,e)}}function av(n,t){const e=pr(n.firestore,xs),r=Hy(n),s=iv(n.converter,t);return lv(e,[Jy(Yy(n.firestore),"addDoc",r._key,s,n.converter!==null,{}).toMutation(r._key,ce.exists(!1))]).then((()=>r))}function uv(n,...t){n=Sn(n);let e={includeMetadataChanges:!1,source:"default"},r=0;typeof t[r]!="object"||Cl(t[r])||(e=t[r++]);const s={includeMetadataChanges:e.includeMetadataChanges,source:e.source};if(Cl(t[r])){const h=t[r];t[r]=h.next?.bind(h),t[r+1]=h.error?.bind(h),t[r+2]=h.complete?.bind(h)}let o,a,l;if(n instanceof gt)a=pr(n.firestore,xs),l=Uo(n._key.path),o={next:h=>{t[r]&&t[r](cv(a,n,h))},error:t[r+1],complete:t[r+2]};else{const h=pr(n,ni);a=pr(h.firestore,xs),l=h._query;const f=new ef(a);o={next:p=>{t[r]&&t[r](new wn(a,f,h,p))},error:t[r+1],complete:t[r+2]},rv(n._query)}return(function(f,p,y,v){const R=new By(v),C=new Ty(p,R,y);return f.asyncQueue.enqueueAndForget((async()=>_y(await Tl(f),C))),()=>{R.Nu(),f.asyncQueue.enqueueAndForget((async()=>yy(await Tl(f),C)))}})(Hh(a),l,s,o)}function lv(n,t){return(function(r,s){const o=new Ye;return r.asyncQueue.enqueueAndForget((async()=>Dy(await $y(r),s,o))),o.promise})(Hh(n),t)}function cv(n,t,e){const r=e.docs.get(t._key),s=new ef(n);return new Je(n,s,t._key,r,new ar(e.hasPendingWrites,e.fromCache),t.converter)}(function(t,e=!0){(function(s){Mn=s})(xm),ws(new Rr("firestore",((r,{instanceIdentifier:s,options:o})=>{const a=r.getProvider("app").getImmediate(),l=new xs(new Wm(r.getProvider("auth-internal")),new Ym(a,r.getProvider("app-check-internal")),(function(f,p){if(!Object.prototype.hasOwnProperty.apply(f.options,["projectId"]))throw new x(P.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Pr(f.options.projectId,p)})(a,s),a);return o={useFetchStreams:e,...o},l._setSettings(o),l}),"PUBLIC").setMultipleInstances(!0)),En(Nu,ku,t),En(Nu,ku,"esm2020")})();var hv="firebase",fv="12.5.0";En(hv,fv,"app");const dv={apiKey:"AIzaSyBC5VHNEcVL9KP8M0d64ZajF6P4Hzqzafc",authDomain:"bbnme-58716.firebaseapp.com",projectId:"bbnme-58716",storageBucket:"bbnme-58716.appspot.com",messagingSenderId:"155088179379",appId:"1:155088179379:web:5d98445c178b7513f520c6"},pv=Ic(dv),nf=Gy(pv);var mv=sn('<form class="svelte-7mtrh0"><h2>Add a new place</h2> <input type="text" placeholder="Place name" required class="svelte-7mtrh0"/> <input type="url" placeholder="Website" class="svelte-7mtrh0"/> <input type="url" placeholder="Image URL" class="svelte-7mtrh0"/> <button type="submit" class="svelte-7mtrh0">Add Place</button></form>');function gv(n,t){To(t,!1);let e=hr(""),r=hr(""),s=hr("");async function o(){try{const p=await av(zh(nf,"places"),{name:st(e),website:st(r),image:st(s)});console.log("Document written with ID: ",p.id),xt(e,""),xt(r,""),xt(s,"")}catch(p){console.error("Error adding document: ",p)}}mc();var a=mv(),l=Ce(wr(a),2),h=Ce(l,2),f=Ce(h,2);Vi(l,()=>st(e),p=>xt(e,p)),Vi(h,()=>st(r),p=>xt(r,p)),Vi(f,()=>st(s),p=>xt(s,p)),$d("submit",a,ip(o)),Ge(n,a),wo()}var _v=sn('<div class="card svelte-1udyrqm"><!></div>');function rf(n,t){var e=_v(),r=wr(e);tp(r,t,"default",{}),Ge(n,e)}var yv=sn('<a target="_blank" rel="noreferrer">Website</a>'),vv=sn('<img class="svelte-13geuu4"/>'),Ev=sn("<h3> </h3> <!> <!>",1),Tv=sn('<div class="svelte-13geuu4"><h2>Travel Wishlist</h2> <!></div>');function wv(n,t){To(t,!1);let e=hr([]);op(()=>{const o=uv(zh(nf,"places"),a=>{xt(e,a.docs.map(l=>({id:l.id,...l.data()})))});return()=>o()}),mc();var r=Tv(),s=Ce(wr(r),2);Jd(s,1,()=>st(e),Xd,(o,a)=>{rf(o,{children:(l,h)=>{var f=Ev(),p=Id(f),y=wr(p),v=Ce(p,2);{var R=V=>{var M=yv();bi(()=>Pi(M,"href",st(a).website)),Ge(V,M)};_u(v,V=>{st(a).website&&V(R)})}var C=Ce(v,2);{var D=V=>{var M=vv();bi(()=>{Pi(M,"src",st(a).image),Pi(M,"alt",st(a).name)}),Ge(V,M)};_u(C,V=>{st(a).image&&V(D)})}bi(()=>Hd(y,st(a).name)),Ge(l,f)},$$slots:{default:!0}})}),Ge(n,r),wo()}var Iv=sn('<main class="svelte-1n46o8q"><h1>Clean Girl Travel Wishlist</h1> <!> <!></main>');function Av(n){var t=Iv(),e=Ce(wr(t),2);rf(e,{children:(s,o)=>{gv(s,{})},$$slots:{default:!0}});var r=Ce(e,2);wv(r,{}),Ge(n,t)}Gd(Av,{target:document.getElementById("app")});
