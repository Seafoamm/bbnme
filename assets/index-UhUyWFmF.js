(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();const Bh=!1;var jh=Array.isArray,Pm=Array.prototype.indexOf,Ba=Array.from,$h=Object.defineProperty,er=Object.getOwnPropertyDescriptor,qh=Object.getOwnPropertyDescriptors,Cm=Object.prototype,km=Array.prototype,ja=Object.getPrototypeOf,Zu=Object.isExtensible;const tr=()=>{};function Nm(n){return n()}function oa(n){for(var e=0;e<n.length;e++)n[e]()}function zh(){var n,e,t=new Promise((r,s)=>{n=r,e=s});return{promise:t,resolve:n,reject:e}}const Ve=2,$a=4,Hi=8,Mt=16,Lt=32,xn=64,Gi=128,it=512,be=1024,He=2048,wt=4096,Xe=8192,Xt=16384,qa=32768,lr=65536,el=1<<17,Hh=1<<18,br=1<<19,Gh=1<<20,ds=32768,aa=1<<21,za=1<<22,Jt=1<<23,nr=Symbol("$state"),Dm=Symbol("legacy props"),Vm=Symbol(""),Yn=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function Om(n){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function Mm(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function Lm(n){throw new Error("https://svelte.dev/e/effect_in_teardown")}function xm(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Fm(n){throw new Error("https://svelte.dev/e/effect_orphan")}function Um(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Bm(n){throw new Error("https://svelte.dev/e/props_invalid_value")}function jm(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function $m(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function qm(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function zm(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const Hm=1,Gm=2,Wm=16,Km=2,Qm=4,Xm=8,Jm=1,Ym=2,ke=Symbol(),Zm="http://www.w3.org/1999/xhtml";function eg(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}let tg=!1;function Wh(n){return n===this.v}function Kh(n,e){return n!=n?e==e:n!==e||n!==null&&typeof n=="object"||typeof n=="function"}function Qh(n){return!Kh(n,this.v)}let Rr=!1,ng=!1;function rg(){Rr=!0}let ce=null;function hr(n){ce=n}function Fn(n,e=!1,t){ce={p:ce,i:!1,c:null,e:null,s:n,x:null,l:Rr&&!e?{s:null,u:null,$:[]}:null}}function Un(n){var e=ce,t=e.e;if(t!==null){e.e=null;for(var r of t)hf(r)}return e.i=!0,ce=e.p,{}}function bs(){return!Rr||ce!==null&&ce.l===null}let Tn=[];function Xh(){var n=Tn;Tn=[],oa(n)}function Wi(n){if(Tn.length===0&&!rs){var e=Tn;queueMicrotask(()=>{e===Tn&&Xh()})}Tn.push(n)}function sg(){for(;Tn.length>0;)Xh()}function Jh(n){var e=Z;if(e===null)return J.f|=Jt,n;if((e.f&qa)===0){if((e.f&Gi)===0)throw n;e.b.error(n)}else fr(n,e)}function fr(n,e){for(;e!==null;){if((e.f&Gi)!==0)try{e.b.error(n);return}catch(t){n=t}e=e.parent}throw n}const Ys=new Set;let se=null,oi=null,Ke=null,lt=[],Ki=null,ca=!1,rs=!1;class ht{committed=!1;current=new Map;previous=new Map;#e=new Set;#t=new Set;#n=0;#r=0;#c=null;#o=[];#a=[];skipped_effects=new Set;is_fork=!1;process(e){lt=[],oi=null,this.apply();var t={parent:null,effect:null,effects:[],render_effects:[],block_effects:[]};for(const r of e)this.#s(r,t);this.is_fork||this.#u(),this.#r>0||this.is_fork?(this.#i(t.effects),this.#i(t.render_effects),this.#i(t.block_effects)):(oi=this,se=null,tl(t.render_effects),tl(t.effects),oi=null,this.#c?.resolve()),Ke=null}#s(e,t){e.f^=be;for(var r=e.first;r!==null;){var s=r.f,i=(s&(Lt|xn))!==0,a=i&&(s&be)!==0,c=a||(s&Xe)!==0||this.skipped_effects.has(r);if((r.f&Gi)!==0&&r.b?.is_pending()&&(t={parent:t,effect:r,effects:[],render_effects:[],block_effects:[]}),!c&&r.fn!==null){i?r.f^=be:(s&$a)!==0?t.effects.push(r):Sr(r)&&((r.f&Mt)!==0&&t.block_effects.push(r),pr(r));var l=r.first;if(l!==null){r=l;continue}}var h=r.parent;for(r=r.next;r===null&&h!==null;)h===t.effect&&(this.#i(t.effects),this.#i(t.render_effects),this.#i(t.block_effects),t=t.parent),r=h.next,h=h.parent}}#i(e){for(const t of e)((t.f&He)!==0?this.#o:this.#a).push(t),Re(t,be)}capture(e,t){this.previous.has(e)||this.previous.set(e,t),(e.f&Jt)===0&&(this.current.set(e,e.v),Ke?.set(e,e.v))}activate(){se=this,this.apply()}deactivate(){se=null,Ke=null}flush(){if(this.activate(),lt.length>0){if(Yh(),se!==null&&se!==this)return}else this.#n===0&&this.process([]);this.deactivate()}discard(){for(const e of this.#t)e(this);this.#t.clear()}#u(){if(this.#r===0){for(const e of this.#e)e();this.#e.clear()}this.#n===0&&this.#l()}#l(){if(Ys.size>1){this.previous.clear();var e=Ke,t=!0,r={parent:null,effect:null,effects:[],render_effects:[],block_effects:[]};for(const s of Ys){if(s===this){t=!1;continue}const i=[];for(const[c,l]of this.current){if(s.current.has(c))if(t&&l!==s.current.get(c))s.current.set(c,l);else continue;i.push(c)}if(i.length===0)continue;const a=[...s.current.keys()].filter(c=>!this.current.has(c));if(a.length>0){const c=new Set,l=new Map;for(const h of i)Zh(h,a,c,l);if(lt.length>0){se=s,s.apply();for(const h of lt)s.#s(h,r);lt=[],s.deactivate()}}}se=null,Ke=e}this.committed=!0,Ys.delete(this)}increment(e){this.#n+=1,e&&(this.#r+=1)}decrement(e){this.#n-=1,e&&(this.#r-=1),this.revive()}revive(){for(const e of this.#o)Re(e,He),kn(e);for(const e of this.#a)Re(e,wt),kn(e);this.#o=[],this.#a=[],this.flush()}oncommit(e){this.#e.add(e)}ondiscard(e){this.#t.add(e)}settled(){return(this.#c??=zh()).promise}static ensure(){if(se===null){const e=se=new ht;Ys.add(se),rs||ht.enqueue(()=>{se===e&&e.flush()})}return se}static enqueue(e){Wi(e)}apply(){}}function ig(n){var e=rs;rs=!0;try{for(var t;;){if(sg(),lt.length===0&&(se?.flush(),lt.length===0))return Ki=null,t;Yh()}}finally{rs=e}}function Yh(){var n=An;ca=!0;try{var e=0;for(sl(!0);lt.length>0;){var t=ht.ensure();if(e++>1e3){var r,s;og()}t.process(lt),Yt.clear()}}finally{ca=!1,sl(n),Ki=null}}function og(){try{Um()}catch(n){fr(n,Ki)}}let Rt=null;function tl(n){var e=n.length;if(e!==0){for(var t=0;t<e;){var r=n[t++];if((r.f&(Xt|Xe))===0&&Sr(r)&&(Rt=new Set,pr(r),r.deps===null&&r.first===null&&r.nodes_start===null&&(r.teardown===null&&r.ac===null?pf(r):r.fn=null),Rt?.size>0)){Yt.clear();for(const s of Rt){if((s.f&(Xt|Xe))!==0)continue;const i=[s];let a=s.parent;for(;a!==null;)Rt.has(a)&&(Rt.delete(a),i.push(a)),a=a.parent;for(let c=i.length-1;c>=0;c--){const l=i[c];(l.f&(Xt|Xe))===0&&pr(l)}}Rt.clear()}}Rt=null}}function Zh(n,e,t,r){if(!t.has(n)&&(t.add(n),n.reactions!==null))for(const s of n.reactions){const i=s.f;(i&Ve)!==0?Zh(s,e,t,r):(i&(za|Mt))!==0&&(i&He)===0&&ef(s,e,r)&&(Re(s,He),kn(s))}}function ef(n,e,t){const r=t.get(n);if(r!==void 0)return r;if(n.deps!==null)for(const s of n.deps){if(e.includes(s))return!0;if((s.f&Ve)!==0&&ef(s,e,t))return t.set(s,!0),!0}return t.set(n,!1),!1}function kn(n){for(var e=Ki=n;e.parent!==null;){e=e.parent;var t=e.f;if(ca&&e===Z&&(t&Mt)!==0&&(t&Hh)===0)return;if((t&(xn|Lt))!==0){if((t&be)===0)return;e.f^=be}}lt.push(e)}function ag(n){let e=0,t=Nn(0),r;return()=>{Xi()&&(q(t),Ji(()=>(e===0&&(r=Pr(()=>n(()=>ss(t)))),e+=1,()=>{Wi(()=>{e-=1,e===0&&(r?.(),r=void 0,ss(t))})})))}}var cg=lr|br|Gi;function ug(n,e,t){new lg(n,e,t)}class lg{parent;#e=!1;#t;#n=null;#r;#c;#o;#a=null;#s=null;#i=null;#u=null;#l=null;#d=0;#h=0;#p=!1;#f=null;#v=ag(()=>(this.#f=Nn(this.#d),()=>{this.#f=null}));constructor(e,t,r){this.#t=e,this.#r=t,this.#c=r,this.parent=Z.b,this.#e=!!this.#r.pending,this.#o=Qa(()=>{Z.b=this;{var s=this.#_();try{this.#a=tt(()=>r(s))}catch(i){this.error(i)}this.#h>0?this.#g():this.#e=!1}return()=>{this.#l?.remove()}},cg)}#E(){try{this.#a=tt(()=>this.#c(this.#t))}catch(e){this.error(e)}this.#e=!1}#T(){const e=this.#r.pending;e&&(this.#s=tt(()=>e(this.#t)),ht.enqueue(()=>{var t=this.#_();this.#a=this.#m(()=>(ht.ensure(),tt(()=>this.#c(t)))),this.#h>0?this.#g():(rr(this.#s,()=>{this.#s=null}),this.#e=!1)}))}#_(){var e=this.#t;return this.#e&&(this.#l=dr(),this.#t.before(this.#l),e=this.#l),e}is_pending(){return this.#e||!!this.parent&&this.parent.is_pending()}has_pending_snippet(){return!!this.#r.pending}#m(e){var t=Z,r=J,s=ce;vt(this.#o),$e(this.#o),hr(this.#o.ctx);try{return e()}catch(i){return Jh(i),null}finally{vt(t),$e(r),hr(s)}}#g(){const e=this.#r.pending;this.#a!==null&&(this.#u=document.createDocumentFragment(),this.#u.append(this.#l),_f(this.#a,this.#u)),this.#s===null&&(this.#s=tt(()=>e(this.#t)))}#y(e){if(!this.has_pending_snippet()){this.parent&&this.parent.#y(e);return}this.#h+=e,this.#h===0&&(this.#e=!1,this.#s&&rr(this.#s,()=>{this.#s=null}),this.#u&&(this.#t.before(this.#u),this.#u=null))}update_pending_count(e){this.#y(e),this.#d+=e,this.#f&&ps(this.#f,this.#d)}get_effect_pending(){return this.#v(),q(this.#f)}error(e){var t=this.#r.onerror;let r=this.#r.failed;if(this.#p||!t&&!r)throw e;this.#a&&(Fe(this.#a),this.#a=null),this.#s&&(Fe(this.#s),this.#s=null),this.#i&&(Fe(this.#i),this.#i=null);var s=!1,i=!1;const a=()=>{if(s){eg();return}s=!0,i&&zm(),ht.ensure(),this.#d=0,this.#i!==null&&rr(this.#i,()=>{this.#i=null}),this.#e=this.has_pending_snippet(),this.#a=this.#m(()=>(this.#p=!1,tt(()=>this.#c(this.#t)))),this.#h>0?this.#g():this.#e=!1};var c=J;try{$e(null),i=!0,t?.(e,a),i=!1}catch(l){fr(l,this.#o&&this.#o.parent)}finally{$e(c)}r&&Wi(()=>{this.#i=this.#m(()=>{ht.ensure(),this.#p=!0;try{return tt(()=>{r(this.#t,()=>e,()=>a)})}catch(l){return fr(l,this.#o.parent),null}finally{this.#p=!1}})})}}function hg(n,e,t,r){const s=bs()?Ha:Ga;if(t.length===0&&n.length===0){r(e.map(s));return}var i=se,a=Z,c=fg();function l(){Promise.all(t.map(h=>dg(h))).then(h=>{c();try{r([...e.map(s),...h])}catch(d){(a.f&Xt)===0&&fr(d,a)}i?.deactivate(),vi()}).catch(h=>{fr(h,a)})}n.length>0?Promise.all(n).then(()=>{c();try{return l()}finally{i?.deactivate(),vi()}}):l()}function fg(){var n=Z,e=J,t=ce,r=se;return function(i=!0){vt(n),$e(e),hr(t),i&&r?.activate()}}function vi(){vt(null),$e(null),hr(null)}function Ha(n){var e=Ve|He,t=J!==null&&(J.f&Ve)!==0?J:null;return Z!==null&&(Z.f|=br),{ctx:ce,deps:null,effects:null,equals:Wh,f:e,fn:n,reactions:null,rv:0,v:ke,wv:0,parent:t??Z,ac:null}}function dg(n,e){let t=Z;t===null&&Mm();var r=t.b,s=void 0,i=Nn(ke),a=!J,c=new Map;return bg(()=>{var l=zh();s=l.promise;try{Promise.resolve(n()).then(l.resolve,l.reject).then(()=>{h===se&&h.committed&&h.deactivate(),vi()})}catch(g){l.reject(g),vi()}var h=se;if(a){var d=!r.is_pending();r.update_pending_count(1),h.increment(d),c.get(h)?.reject(Yn),c.delete(h),c.set(h,l)}const m=(g,T=void 0)=>{if(h.activate(),T)T!==Yn&&(i.f|=Jt,ps(i,T));else{(i.f&Jt)!==0&&(i.f^=Jt),ps(i,g);for(const[S,k]of c){if(c.delete(S),S===h)break;k.reject(Yn)}}a&&(r.update_pending_count(-1),h.decrement(d))};l.promise.then(m,g=>m(null,g||"unknown"))}),Ka(()=>{for(const l of c.values())l.reject(Yn)}),new Promise(l=>{function h(d){function m(){d===s?l(i):h(s)}d.then(m,m)}h(s)})}function Ga(n){const e=Ha(n);return e.equals=Qh,e}function tf(n){var e=n.effects;if(e!==null){n.effects=null;for(var t=0;t<e.length;t+=1)Fe(e[t])}}function pg(n){for(var e=n.parent;e!==null;){if((e.f&Ve)===0)return e;e=e.parent}return null}function Wa(n){var e,t=Z;vt(pg(n));try{n.f&=~ds,tf(n),e=Tf(n)}finally{vt(t)}return e}function nf(n){var e=Wa(n);if(n.equals(e)||(n.v=e,n.wv=vf()),!Bn)if(Ke!==null)Xi()&&Ke.set(n,n.v);else{var t=(n.f&it)===0?wt:be;Re(n,t)}}let ua=new Set;const Yt=new Map;let rf=!1;function Nn(n,e){var t={f:0,v:n,reactions:null,equals:Wh,rv:0,wv:0};return t}function zt(n,e){const t=Nn(n);return Pg(t),t}function et(n,e=!1,t=!0){const r=Nn(n);return e||(r.equals=Qh),Rr&&t&&ce!==null&&ce.l!==null&&(ce.l.s??=[]).push(r),r}function te(n,e,t=!1){J!==null&&(!ft||(J.f&el)!==0)&&bs()&&(J.f&(Ve|Mt|za|el))!==0&&!kt?.includes(n)&&qm();let r=t?Zn(e):e;return ps(n,r)}function ps(n,e){if(!n.equals(e)){var t=n.v;Bn?Yt.set(n,e):Yt.set(n,t),n.v=e;var r=ht.ensure();r.capture(n,t),(n.f&Ve)!==0&&((n.f&He)!==0&&Wa(n),Re(n,(n.f&it)!==0?be:wt)),n.wv=vf(),sf(n,He),bs()&&Z!==null&&(Z.f&be)!==0&&(Z.f&(Lt|xn))===0&&(Je===null?Cg([n]):Je.push(n)),!r.is_fork&&ua.size>0&&!rf&&mg()}return e}function mg(){rf=!1;const n=Array.from(ua);for(const e of n)(e.f&be)!==0&&Re(e,wt),Sr(e)&&pr(e);ua.clear()}function ss(n){te(n,n.v+1)}function sf(n,e){var t=n.reactions;if(t!==null)for(var r=bs(),s=t.length,i=0;i<s;i++){var a=t[i],c=a.f;if(!(!r&&a===Z)){var l=(c&He)===0;if(l&&Re(a,e),(c&Ve)!==0){var h=a;Ke?.delete(h),(c&ds)===0&&(c&it&&(a.f|=ds),sf(h,wt))}else l&&((c&Mt)!==0&&Rt!==null&&Rt.add(a),kn(a))}}}function Zn(n){if(typeof n!="object"||n===null||nr in n)return n;const e=ja(n);if(e!==Cm&&e!==km)return n;var t=new Map,r=jh(n),s=zt(0),i=bn,a=c=>{if(bn===i)return c();var l=J,h=bn;$e(null),ol(i);var d=c();return $e(l),ol(h),d};return r&&t.set("length",zt(n.length)),new Proxy(n,{defineProperty(c,l,h){(!("value"in h)||h.configurable===!1||h.enumerable===!1||h.writable===!1)&&jm();var d=t.get(l);return d===void 0?d=a(()=>{var m=zt(h.value);return t.set(l,m),m}):te(d,h.value,!0),!0},deleteProperty(c,l){var h=t.get(l);if(h===void 0){if(l in c){const d=a(()=>zt(ke));t.set(l,d),ss(s)}}else te(h,ke),ss(s);return!0},get(c,l,h){if(l===nr)return n;var d=t.get(l),m=l in c;if(d===void 0&&(!m||er(c,l)?.writable)&&(d=a(()=>{var T=Zn(m?c[l]:ke),S=zt(T);return S}),t.set(l,d)),d!==void 0){var g=q(d);return g===ke?void 0:g}return Reflect.get(c,l,h)},getOwnPropertyDescriptor(c,l){var h=Reflect.getOwnPropertyDescriptor(c,l);if(h&&"value"in h){var d=t.get(l);d&&(h.value=q(d))}else if(h===void 0){var m=t.get(l),g=m?.v;if(m!==void 0&&g!==ke)return{enumerable:!0,configurable:!0,value:g,writable:!0}}return h},has(c,l){if(l===nr)return!0;var h=t.get(l),d=h!==void 0&&h.v!==ke||Reflect.has(c,l);if(h!==void 0||Z!==null&&(!d||er(c,l)?.writable)){h===void 0&&(h=a(()=>{var g=d?Zn(c[l]):ke,T=zt(g);return T}),t.set(l,h));var m=q(h);if(m===ke)return!1}return d},set(c,l,h,d){var m=t.get(l),g=l in c;if(r&&l==="length")for(var T=h;T<m.v;T+=1){var S=t.get(T+"");S!==void 0?te(S,ke):T in c&&(S=a(()=>zt(ke)),t.set(T+"",S))}if(m===void 0)(!g||er(c,l)?.writable)&&(m=a(()=>zt(void 0)),te(m,Zn(h)),t.set(l,m));else{g=m.v!==ke;var k=a(()=>Zn(h));te(m,k)}var P=Reflect.getOwnPropertyDescriptor(c,l);if(P?.set&&P.set.call(d,h),!g){if(r&&typeof l=="string"){var x=t.get("length"),V=Number(l);Number.isInteger(V)&&V>=x.v&&te(x,V+1)}ss(s)}return!0},ownKeys(c){q(s);var l=Reflect.ownKeys(c).filter(m=>{var g=t.get(m);return g===void 0||g.v!==ke});for(var[h,d]of t)d.v!==ke&&!(h in c)&&l.push(h);return l},setPrototypeOf(){$m()}})}var nl,of,af,cf;function gg(){if(nl===void 0){nl=window,of=/Firefox/.test(navigator.userAgent);var n=Element.prototype,e=Node.prototype,t=Text.prototype;af=er(e,"firstChild").get,cf=er(e,"nextSibling").get,Zu(n)&&(n.__click=void 0,n.__className=void 0,n.__attributes=null,n.__style=void 0,n.__e=void 0),Zu(t)&&(t.__t=void 0)}}function dr(n=""){return document.createTextNode(n)}function Ei(n){return af.call(n)}function Rs(n){return cf.call(n)}function ze(n,e){return Ei(n)}function ms(n,e=!1){{var t=Ei(n);return t instanceof Comment&&t.data===""?Rs(t):t}}function ge(n,e=1,t=!1){let r=n;for(;e--;)r=Rs(r);return r}function _g(n){n.textContent=""}function uf(){return!1}let rl=!1;function yg(){rl||(rl=!0,document.addEventListener("reset",n=>{Promise.resolve().then(()=>{if(!n.defaultPrevented)for(const e of n.target.elements)e.__on_r?.()})},{capture:!0}))}function Qi(n){var e=J,t=Z;$e(null),vt(null);try{return n()}finally{$e(e),vt(t)}}function vg(n,e,t,r=t){n.addEventListener(e,()=>Qi(t));const s=n.__on_r;s?n.__on_r=()=>{s(),r(!0)}:n.__on_r=()=>r(!0),yg()}function lf(n){Z===null&&(J===null&&Fm(),xm()),Bn&&Lm()}function Eg(n,e){var t=e.last;t===null?e.last=e.first=n:(t.next=n,n.prev=t,e.last=n)}function xt(n,e,t,r=!0){var s=Z;s!==null&&(s.f&Xe)!==0&&(n|=Xe);var i={ctx:ce,deps:null,nodes_start:null,nodes_end:null,f:n|He|it,first:null,fn:e,last:null,next:null,parent:s,b:s&&s.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(t)try{pr(i),i.f|=qa}catch(l){throw Fe(i),l}else e!==null&&kn(i);if(r){var a=i;if(t&&a.deps===null&&a.teardown===null&&a.nodes_start===null&&a.first===a.last&&(a.f&br)===0&&(a=a.first,(n&Mt)!==0&&(n&lr)!==0&&a!==null&&(a.f|=lr)),a!==null&&(a.parent=s,s!==null&&Eg(a,s),J!==null&&(J.f&Ve)!==0&&(n&xn)===0)){var c=J;(c.effects??=[]).push(a)}}return i}function Xi(){return J!==null&&!ft}function Ka(n){const e=xt(Hi,null,!1);return Re(e,be),e.teardown=n,e}function la(n){lf();var e=Z.f,t=!J&&(e&Lt)!==0&&(e&qa)===0;if(t){var r=ce;(r.e??=[]).push(n)}else return hf(n)}function hf(n){return xt($a|Gh,n,!1)}function Tg(n){return lf(),xt(Hi|Gh,n,!0)}function Ig(n){ht.ensure();const e=xt(xn|br,n,!0);return(t={})=>new Promise(r=>{t.outro?rr(e,()=>{Fe(e),r(void 0)}):(Fe(e),r(void 0))})}function wg(n,e){var t=ce,r={effect:null,ran:!1,deps:n};t.l.$.push(r),r.effect=Ji(()=>{n(),!r.ran&&(r.ran=!0,Pr(e))})}function Ag(){var n=ce;Ji(()=>{for(var e of n.l.$){e.deps();var t=e.effect;(t.f&be)!==0&&Re(t,wt),Sr(t)&&pr(t),e.ran=!1}})}function bg(n){return xt(za|br,n,!0)}function Ji(n,e=0){return xt(Hi|e,n,!0)}function is(n,e=[],t=[],r=[],s=!1){hg(r,e,t,i=>{xt(s?$a:Hi,()=>n(...i.map(q)),!0)})}function Qa(n,e=0){var t=xt(Mt|e,n,!0);return t}function tt(n,e=!0){return xt(Lt|br,n,!0,e)}function ff(n){var e=n.teardown;if(e!==null){const t=Bn,r=J;il(!0),$e(null);try{e.call(null)}finally{il(t),$e(r)}}}function df(n,e=!1){var t=n.first;for(n.first=n.last=null;t!==null;){const s=t.ac;s!==null&&Qi(()=>{s.abort(Yn)});var r=t.next;(t.f&xn)!==0?t.parent=null:Fe(t,e),t=r}}function Rg(n){for(var e=n.first;e!==null;){var t=e.next;(e.f&Lt)===0&&Fe(e),e=t}}function Fe(n,e=!0){var t=!1;(e||(n.f&Hh)!==0)&&n.nodes_start!==null&&n.nodes_end!==null&&(Sg(n.nodes_start,n.nodes_end),t=!0),df(n,e&&!t),Ti(n,0),Re(n,Xt);var r=n.transitions;if(r!==null)for(const i of r)i.stop();ff(n);var s=n.parent;s!==null&&s.first!==null&&pf(n),n.next=n.prev=n.teardown=n.ctx=n.deps=n.fn=n.nodes_start=n.nodes_end=n.ac=null}function Sg(n,e){for(;n!==null;){var t=n===e?null:Rs(n);n.remove(),n=t}}function pf(n){var e=n.parent,t=n.prev,r=n.next;t!==null&&(t.next=r),r!==null&&(r.prev=t),e!==null&&(e.first===n&&(e.first=r),e.last===n&&(e.last=t))}function rr(n,e,t=!0){var r=[];Xa(n,r,!0),mf(r,()=>{t&&Fe(n),e&&e()})}function mf(n,e){var t=n.length;if(t>0){var r=()=>--t||e();for(var s of n)s.out(r)}else e()}function Xa(n,e,t){if((n.f&Xe)===0){if(n.f^=Xe,n.transitions!==null)for(const a of n.transitions)(a.is_global||t)&&e.push(a);for(var r=n.first;r!==null;){var s=r.next,i=(r.f&lr)!==0||(r.f&Lt)!==0&&(n.f&Mt)!==0;Xa(r,e,i?t:!1),r=s}}}function Ja(n){gf(n,!0)}function gf(n,e){if((n.f&Xe)!==0){n.f^=Xe,(n.f&be)===0&&(Re(n,He),kn(n));for(var t=n.first;t!==null;){var r=t.next,s=(t.f&lr)!==0||(t.f&Lt)!==0;gf(t,s?e:!1),t=r}if(n.transitions!==null)for(const i of n.transitions)(i.is_global||e)&&i.in()}}function _f(n,e){for(var t=n.nodes_start,r=n.nodes_end;t!==null;){var s=t===r?null:Rs(t);e.append(t),t=s}}let An=!1;function sl(n){An=n}let Bn=!1;function il(n){Bn=n}let J=null,ft=!1;function $e(n){J=n}let Z=null;function vt(n){Z=n}let kt=null;function Pg(n){J!==null&&(kt===null?kt=[n]:kt.push(n))}let xe=null,We=0,Je=null;function Cg(n){Je=n}let yf=1,gs=0,bn=gs;function ol(n){bn=n}function vf(){return++yf}function Sr(n){var e=n.f;if((e&He)!==0)return!0;if(e&Ve&&(n.f&=~ds),(e&wt)!==0){var t=n.deps;if(t!==null)for(var r=t.length,s=0;s<r;s++){var i=t[s];if(Sr(i)&&nf(i),i.wv>n.wv)return!0}(e&it)!==0&&Ke===null&&Re(n,be)}return!1}function Ef(n,e,t=!0){var r=n.reactions;if(r!==null&&!kt?.includes(n))for(var s=0;s<r.length;s++){var i=r[s];(i.f&Ve)!==0?Ef(i,e,!1):e===i&&(t?Re(i,He):(i.f&be)!==0&&Re(i,wt),kn(i))}}function Tf(n){var e=xe,t=We,r=Je,s=J,i=kt,a=ce,c=ft,l=bn,h=n.f;xe=null,We=0,Je=null,J=(h&(Lt|xn))===0?n:null,kt=null,hr(n.ctx),ft=!1,bn=++gs,n.ac!==null&&(Qi(()=>{n.ac.abort(Yn)}),n.ac=null);try{n.f|=aa;var d=n.fn,m=d(),g=n.deps;if(xe!==null){var T;if(Ti(n,We),g!==null&&We>0)for(g.length=We+xe.length,T=0;T<xe.length;T++)g[We+T]=xe[T];else n.deps=g=xe;if(An&&Xi()&&(n.f&it)!==0)for(T=We;T<g.length;T++)(g[T].reactions??=[]).push(n)}else g!==null&&We<g.length&&(Ti(n,We),g.length=We);if(bs()&&Je!==null&&!ft&&g!==null&&(n.f&(Ve|wt|He))===0)for(T=0;T<Je.length;T++)Ef(Je[T],n);return s!==null&&s!==n&&(gs++,Je!==null&&(r===null?r=Je:r.push(...Je))),(n.f&Jt)!==0&&(n.f^=Jt),m}catch(S){return Jh(S)}finally{n.f^=aa,xe=e,We=t,Je=r,J=s,kt=i,hr(a),ft=c,bn=l}}function kg(n,e){let t=e.reactions;if(t!==null){var r=Pm.call(t,n);if(r!==-1){var s=t.length-1;s===0?t=e.reactions=null:(t[r]=t[s],t.pop())}}t===null&&(e.f&Ve)!==0&&(xe===null||!xe.includes(e))&&(Re(e,wt),(e.f&it)!==0&&(e.f^=it,e.f&=~ds),tf(e),Ti(e,0))}function Ti(n,e){var t=n.deps;if(t!==null)for(var r=e;r<t.length;r++)kg(n,t[r])}function pr(n){var e=n.f;if((e&Xt)===0){Re(n,be);var t=Z,r=An;Z=n,An=!0;try{(e&Mt)!==0?Rg(n):df(n),ff(n);var s=Tf(n);n.teardown=typeof s=="function"?s:null,n.wv=yf;var i;Bh&&ng&&(n.f&He)!==0&&n.deps}finally{An=r,Z=t}}}async function Ng(){await Promise.resolve(),ig()}function q(n){var e=n.f,t=(e&Ve)!==0;if(J!==null&&!ft){var r=Z!==null&&(Z.f&Xt)!==0;if(!r&&!kt?.includes(n)){var s=J.deps;if((J.f&aa)!==0)n.rv<gs&&(n.rv=gs,xe===null&&s!==null&&s[We]===n?We++:xe===null?xe=[n]:xe.includes(n)||xe.push(n));else{(J.deps??=[]).push(n);var i=n.reactions;i===null?n.reactions=[J]:i.includes(J)||i.push(J)}}}if(Bn){if(Yt.has(n))return Yt.get(n);if(t){var a=n,c=a.v;return((a.f&be)===0&&a.reactions!==null||wf(a))&&(c=Wa(a)),Yt.set(a,c),c}}else if(t){if(a=n,Ke?.has(a))return Ke.get(a);Sr(a)&&nf(a),An&&Xi()&&(a.f&it)===0&&If(a)}else if(Ke?.has(n))return Ke.get(n);if((n.f&Jt)!==0)throw n.v;return n.v}function If(n){if(n.deps!==null){n.f^=it;for(const e of n.deps)(e.reactions??=[]).push(n),(e.f&Ve)!==0&&(e.f&it)===0&&If(e)}}function wf(n){if(n.v===ke)return!0;if(n.deps===null)return!1;for(const e of n.deps)if(Yt.has(e)||(e.f&Ve)!==0&&wf(e))return!0;return!1}function Pr(n){var e=ft;try{return ft=!0,n()}finally{ft=e}}const Dg=-7169;function Re(n,e){n.f=n.f&Dg|e}function Vg(n){if(!(typeof n!="object"||!n||n instanceof EventTarget)){if(nr in n)ha(n);else if(!Array.isArray(n))for(let e in n){const t=n[e];typeof t=="object"&&t&&nr in t&&ha(t)}}}function ha(n,e=new Set){if(typeof n=="object"&&n!==null&&!(n instanceof EventTarget)&&!e.has(n)){e.add(n),n instanceof Date&&n.getTime();for(let r in n)try{ha(n[r],e)}catch{}const t=ja(n);if(t!==Object.prototype&&t!==Array.prototype&&t!==Map.prototype&&t!==Set.prototype&&t!==Date.prototype){const r=qh(t);for(let s in r){const i=r[s].get;if(i)try{i.call(n)}catch{}}}}}const Og=["touchstart","touchmove"];function Mg(n){return Og.includes(n)}const Lg=new Set,al=new Set;function xg(n,e,t,r={}){function s(i){if(r.capture||Yr.call(e,i),!i.cancelBubble)return Qi(()=>t?.call(this,i))}return n.startsWith("pointer")||n.startsWith("touch")||n==="wheel"?Wi(()=>{e.addEventListener(n,s,r)}):e.addEventListener(n,s,r),s}function Ya(n,e,t,r,s){var i={capture:r,passive:s},a=xg(n,e,t,i);(e===document.body||e===window||e===document||e instanceof HTMLMediaElement)&&Ka(()=>{e.removeEventListener(n,a,i)})}let cl=null;function Yr(n){var e=this,t=e.ownerDocument,r=n.type,s=n.composedPath?.()||[],i=s[0]||n.target;cl=n;var a=0,c=cl===n&&n.__root;if(c){var l=s.indexOf(c);if(l!==-1&&(e===document||e===window)){n.__root=e;return}var h=s.indexOf(e);if(h===-1)return;l<=h&&(a=l)}if(i=s[a]||n.target,i!==e){$h(n,"currentTarget",{configurable:!0,get(){return i||t}});var d=J,m=Z;$e(null),vt(null);try{for(var g,T=[];i!==null;){var S=i.assignedSlot||i.parentNode||i.host||null;try{var k=i["__"+r];k!=null&&(!i.disabled||n.target===i)&&k.call(i,n)}catch(P){g?T.push(P):g=P}if(n.cancelBubble||S===e||S===null)break;i=S}if(g){for(let P of T)queueMicrotask(()=>{throw P});throw g}}finally{n.__root=e,delete n.currentTarget,$e(d),vt(m)}}}function Fg(n){var e=document.createElement("template");return e.innerHTML=n.replaceAll("<!>","<!---->"),e.content}function fa(n,e){var t=Z;t.nodes_start===null&&(t.nodes_start=n,t.nodes_end=e)}function Ue(n,e){var t=(e&Jm)!==0,r=(e&Ym)!==0,s,i=!n.startsWith("<!>");return()=>{s===void 0&&(s=Fg(i?n:"<!>"+n),t||(s=Ei(s)));var a=r||of?document.importNode(s,!0):s.cloneNode(!0);if(t){var c=Ei(a),l=a.lastChild;fa(c,l)}else fa(a,a);return a}}function Af(){var n=document.createDocumentFragment(),e=document.createComment(""),t=dr();return n.append(e,t),fa(e,t),n}function we(n,e){n!==null&&n.before(e)}function Za(n,e){var t=e==null?"":typeof e=="object"?e+"":e;t!==(n.__t??=n.nodeValue)&&(n.__t=t,n.nodeValue=t+"")}function Ug(n,e){return Bg(n,e)}const Gn=new Map;function Bg(n,{target:e,anchor:t,props:r={},events:s,context:i,intro:a=!0}){gg();var c=new Set,l=m=>{for(var g=0;g<m.length;g++){var T=m[g];if(!c.has(T)){c.add(T);var S=Mg(T);e.addEventListener(T,Yr,{passive:S});var k=Gn.get(T);k===void 0?(document.addEventListener(T,Yr,{passive:S}),Gn.set(T,1)):Gn.set(T,k+1)}}};l(Ba(Lg)),al.add(l);var h=void 0,d=Ig(()=>{var m=t??e.appendChild(dr());return ug(m,{pending:()=>{}},g=>{if(i){Fn({});var T=ce;T.c=i}s&&(r.$$events=s),h=n(g,r)||{},i&&Un()}),()=>{for(var g of c){e.removeEventListener(g,Yr);var T=Gn.get(g);--T===0?(document.removeEventListener(g,Yr),Gn.delete(g)):Gn.set(g,T)}al.delete(l),m!==t&&m.parentNode?.removeChild(m)}});return jg.set(h,d),h}let jg=new WeakMap;class $g{anchor;#e=new Map;#t=new Map;#n=new Map;#r=!0;constructor(e,t=!0){this.anchor=e,this.#r=t}#c=()=>{var e=se;if(this.#e.has(e)){var t=this.#e.get(e),r=this.#t.get(t);if(r)Ja(r);else{var s=this.#n.get(t);s&&(this.#t.set(t,s.effect),this.#n.delete(t),s.fragment.lastChild.remove(),this.anchor.before(s.fragment),r=s.effect)}for(const[i,a]of this.#e){if(this.#e.delete(i),i===e)break;const c=this.#n.get(a);c&&(Fe(c.effect),this.#n.delete(a))}for(const[i,a]of this.#t){if(i===t)continue;const c=()=>{if(Array.from(this.#e.values()).includes(i)){var h=document.createDocumentFragment();_f(a,h),h.append(dr()),this.#n.set(i,{effect:a,fragment:h})}else Fe(a);this.#t.delete(i)};this.#r||!r?rr(a,c,!1):c()}}};#o=e=>{this.#e.delete(e);const t=Array.from(this.#e.values());for(const[r,s]of this.#n)t.includes(r)||(Fe(s.effect),this.#n.delete(r))};ensure(e,t){var r=se,s=uf();if(t&&!this.#t.has(e)&&!this.#n.has(e))if(s){var i=document.createDocumentFragment(),a=dr();i.append(a),this.#n.set(e,{effect:tt(()=>t(a)),fragment:i})}else this.#t.set(e,tt(()=>t(this.anchor)));if(this.#e.set(r,e),s){for(const[c,l]of this.#t)c===e?r.skipped_effects.delete(l):r.skipped_effects.add(l);for(const[c,l]of this.#n)c===e?r.skipped_effects.delete(l.effect):r.skipped_effects.add(l.effect);r.oncommit(this.#c),r.ondiscard(this.#o)}else this.#c()}}function Rn(n,e,t=!1){var r=new $g(n),s=t?lr:0;function i(a,c){r.ensure(a,c)}Qa(()=>{var a=!1;e((c,l=!0)=>{a=!0,i(l,c)}),a||i(!1,null)},s)}function qg(n,e){return e}function zg(n,e,t){for(var r=n.items,s=[],i=e.length,a=0;a<i;a++)Xa(e[a].e,s,!0);var c=i>0&&s.length===0&&t!==null;if(c){var l=t.parentNode;_g(l),l.append(t),r.clear(),ct(n,e[0].prev,e[i-1].next)}mf(s,()=>{for(var h=0;h<i;h++){var d=e[h];c||(r.delete(d.k),ct(n,d.prev,d.next)),Fe(d.e,!c)}})}function Hg(n,e,t,r,s,i=null){var a=n,c={flags:e,items:new Map,first:null},l=null,h=!1,d=new Map,m=Ga(()=>{var k=t();return jh(k)?k:k==null?[]:Ba(k)}),g,T;function S(){Gg(T,g,c,d,a,s,e,r,t),i!==null&&(g.length===0?l?Ja(l):l=tt(()=>i(a)):l!==null&&rr(l,()=>{l=null}))}Qa(()=>{T??=Z,g=q(m);var k=g.length;if(!(h&&k===0)){h=k===0;var P,x,V,M;if(uf()){var K=new Set,X=se;for(x=0;x<k;x+=1){V=g[x],M=r(V,x);var Y=c.items.get(M)??d.get(M);Y?bf(Y,V,x):(P=Rf(null,c,null,null,V,M,x,s,e,t,!0),d.set(M,P)),K.add(M)}for(const[I,_]of c.items)K.has(I)||X.skipped_effects.add(_.e);X.oncommit(S)}else S();q(m)}})}function Gg(n,e,t,r,s,i,a,c,l){var h=e.length,d=t.items,m=t.first,g=m,T,S=null,k=[],P=[],x,V,M,K;for(K=0;K<h;K+=1){if(x=e[K],V=c(x,K),M=d.get(V),M===void 0){var X=r.get(V);if(X!==void 0){r.delete(V),d.set(V,X);var Y=S?S.next:g;ct(t,S,X),ct(t,X,Y),Ho(X,Y,s),S=X}else{var I=g?g.e.nodes_start:s;S=Rf(I,t,S,S===null?t.first:S.next,x,V,K,i,a,l)}d.set(V,S),k=[],P=[],g=S.next;continue}if(bf(M,x,K),(M.e.f&Xe)!==0&&Ja(M.e),M!==g){if(T!==void 0&&T.has(M)){if(k.length<P.length){var _=P[0],v;S=_.prev;var w=k[0],E=k[k.length-1];for(v=0;v<k.length;v+=1)Ho(k[v],_,s);for(v=0;v<P.length;v+=1)T.delete(P[v]);ct(t,w.prev,E.next),ct(t,S,w),ct(t,E,_),g=_,S=E,K-=1,k=[],P=[]}else T.delete(M),Ho(M,g,s),ct(t,M.prev,M.next),ct(t,M,S===null?t.first:S.next),ct(t,S,M),S=M;continue}for(k=[],P=[];g!==null&&g.k!==V;)(g.e.f&Xe)===0&&(T??=new Set).add(g),P.push(g),g=g.next;if(g===null)continue;M=g}k.push(M),S=M,g=M.next}if(g!==null||T!==void 0){for(var A=T===void 0?[]:Ba(T);g!==null;)(g.e.f&Xe)===0&&A.push(g),g=g.next;var y=A.length;if(y>0){var ae=null;zg(t,A,ae)}}n.first=t.first&&t.first.e,n.last=S&&S.e;for(var bt of r.values())Fe(bt.e);r.clear()}function bf(n,e,t,r){ps(n.v,e),n.i=t}function Rf(n,e,t,r,s,i,a,c,l,h,d){var m=(l&Hm)!==0,g=(l&Wm)===0,T=m?g?et(s,!1,!1):Nn(s):s,S=(l&Gm)===0?a:Nn(a),k={i:S,v:T,k:i,a:null,e:null,prev:t,next:r};try{if(n===null){var P=document.createDocumentFragment();P.append(n=dr())}return k.e=tt(()=>c(n,T,S,h),tg),k.e.prev=t&&t.e,k.e.next=r&&r.e,t===null?d||(e.first=k):(t.next=k,t.e.next=k.e),r!==null&&(r.prev=k,r.e.prev=k.e),k}finally{}}function Ho(n,e,t){for(var r=n.next?n.next.e.nodes_start:t,s=e?e.e.nodes_start:t,i=n.e.nodes_start;i!==null&&i!==r;){var a=Rs(i);s.before(i),i=a}}function ct(n,e,t){e===null?n.first=t:(e.next=t,e.e.next=t&&t.e),t!==null&&(t.prev=e,t.e.prev=e&&e.e)}function Wg(n,e,t,r,s){var i=e.$$slots?.[t],a=!1;i===!0&&(i=e.children,a=!0),i===void 0||i(n,a?()=>r:r)}const Kg=Symbol("is custom element"),Qg=Symbol("is html");function ai(n,e,t,r){var s=Xg(n);s[e]!==(s[e]=t)&&(e==="loading"&&(n[Vm]=t),t==null?n.removeAttribute(e):typeof t!="string"&&Jg(n).includes(e)?n[e]=t:n.setAttribute(e,t))}function Xg(n){return n.__attributes??={[Kg]:n.nodeName.includes("-"),[Qg]:n.namespaceURI===Zm}}var ul=new Map;function Jg(n){var e=n.getAttribute("is")||n.nodeName,t=ul.get(e);if(t)return t;ul.set(e,t=[]);for(var r,s=n,i=Element.prototype;i!==s;){r=qh(s);for(var a in r)r[a].set&&t.push(a);s=ja(s)}return t}function sr(n,e,t=e){var r=new WeakSet;vg(n,"input",async s=>{var i=s?n.defaultValue:n.value;if(i=Go(n)?Wo(i):i,t(i),se!==null&&r.add(se),await Ng(),i!==(i=e())){var a=n.selectionStart,c=n.selectionEnd,l=n.value.length;if(n.value=i??"",c!==null){var h=n.value.length;a===c&&c===l&&h>l?(n.selectionStart=h,n.selectionEnd=h):(n.selectionStart=a,n.selectionEnd=Math.min(c,h))}}}),Pr(e)==null&&n.value&&(t(Go(n)?Wo(n.value):n.value),se!==null&&r.add(se)),Ji(()=>{var s=e();if(n===document.activeElement){var i=oi??se;if(r.has(i))return}Go(n)&&s===Wo(n.value)||n.type==="date"&&!s&&!n.value||s!==n.value&&(n.value=s??"")})}function Go(n){var e=n.type;return e==="number"||e==="range"}function Wo(n){return n===""?null:+n}function Sf(n){return function(...e){var t=e[0];return t.preventDefault(),n?.apply(this,e)}}function Cr(n=!1){const e=ce,t=e.l.u;if(!t)return;let r=()=>Vg(e.s);if(n){let s=0,i={};const a=Ha(()=>{let c=!1;const l=e.s;for(const h in l)l[h]!==i[h]&&(i[h]=l[h],c=!0);return c&&s++,s});r=()=>q(a)}t.b.length&&Tg(()=>{ll(e,r),oa(t.b)}),la(()=>{const s=Pr(()=>t.m.map(Nm));return()=>{for(const i of s)typeof i=="function"&&i()}}),t.a.length&&la(()=>{ll(e,r),oa(t.a)})}function ll(n,e){if(n.l.s)for(const t of n.l.s)q(t);e()}function Pf(n,e,t){if(n==null)return e(void 0),tr;const r=Pr(()=>n.subscribe(e,t));return r.unsubscribe?()=>r.unsubscribe():r}const Wn=[];function Yg(n,e=tr){let t=null;const r=new Set;function s(c){if(Kh(n,c)&&(n=c,t)){const l=!Wn.length;for(const h of r)h[1](),Wn.push(h,n);if(l){for(let h=0;h<Wn.length;h+=2)Wn[h][0](Wn[h+1]);Wn.length=0}}}function i(c){s(c(n))}function a(c,l=tr){const h=[c,l];return r.add(h),r.size===1&&(t=e(s,i)||tr),c(n),()=>{r.delete(h),r.size===0&&t&&(t(),t=null)}}return{set:s,update:i,subscribe:a}}function Zg(n){let e;return Pf(n,t=>e=t)(),e}let Zs=!1,da=Symbol();function Cf(n,e,t){const r=t[e]??={store:null,source:et(void 0),unsubscribe:tr};if(r.store!==n&&!(da in t))if(r.unsubscribe(),r.store=n??null,n==null)r.source.v=void 0,r.unsubscribe=tr;else{var s=!0;r.unsubscribe=Pf(n,i=>{s?r.source.v=i:te(r.source,i)}),s=!1}return n&&da in t?Zg(n):q(r.source)}function kf(){const n={};function e(){Ka(()=>{for(var t in n)n[t].unsubscribe();$h(n,da,{enumerable:!1,value:!0})})}return[n,e]}function e_(n){var e=Zs;try{return Zs=!1,[n(),Zs]}finally{Zs=e}}function os(n,e,t,r){var s=!Rr||(t&Km)!==0,i=(t&Xm)!==0,a=r,c=!0,l=()=>(c&&(c=!1,a=r),a),h;{var d=nr in n||Dm in n;h=er(n,e)?.set??(d&&e in n?V=>n[e]=V:void 0)}var m,g=!1;[m,g]=e_(()=>n[e]),m===void 0&&r!==void 0&&(m=l(),h&&(s&&Bm(),h(m)));var T;if(s?T=()=>{var V=n[e];return V===void 0?l():(c=!0,V)}:T=()=>{var V=n[e];return V!==void 0&&(a=void 0),V===void 0?a:V},s&&(t&Qm)===0)return T;if(h){var S=n.$$legacy;return(function(V,M){return arguments.length>0?((!s||!M||S||g)&&h(M?T():V),V):T()})}var k=!1,P=Ga(()=>(k=!1,T()));q(P);var x=Z;return(function(V,M){if(arguments.length>0){const K=M?q(P):s&&i?Zn(V):V;return te(P,K),k=!0,a!==void 0&&(a=K),V}return Bn&&k||(x.f&Xt)!==0?P.v:q(P)})}function t_(n){ce===null&&Om(),Rr&&ce.l!==null?n_(ce).m.push(n):la(()=>{const e=Pr(n);if(typeof e=="function")return e})}function n_(n){var e=n.l;return e.u??={a:[],b:[],m:[]}}const r_="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(r_);rg();const s_=()=>{};var hl={};const Nf=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let s=n.charCodeAt(r);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},i_=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const s=n[t++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=n[t++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=n[t++],a=n[t++],c=n[t++],l=((s&7)<<18|(i&63)<<12|(a&63)<<6|c&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const i=n[t++],a=n[t++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|a&63)}}return e.join("")},Df={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<n.length;s+=3){const i=n[s],a=s+1<n.length,c=a?n[s+1]:0,l=s+2<n.length,h=l?n[s+2]:0,d=i>>2,m=(i&3)<<4|c>>4;let g=(c&15)<<2|h>>6,T=h&63;l||(T=64,a||(g=64)),r.push(t[d],t[m],t[g],t[T])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(Nf(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):i_(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<n.length;){const i=t[n.charAt(s++)],c=s<n.length?t[n.charAt(s)]:0;++s;const h=s<n.length?t[n.charAt(s)]:64;++s;const m=s<n.length?t[n.charAt(s)]:64;if(++s,i==null||c==null||h==null||m==null)throw new o_;const g=i<<2|c>>4;if(r.push(g),h!==64){const T=c<<4&240|h>>2;if(r.push(T),m!==64){const S=h<<6&192|m;r.push(S)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class o_ extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const a_=function(n){const e=Nf(n);return Df.encodeByteArray(e,!0)},Ii=function(n){return a_(n).replace(/\./g,"")},Vf=function(n){try{return Df.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function c_(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const u_=()=>c_().__FIREBASE_DEFAULTS__,l_=()=>{if(typeof process>"u"||typeof hl>"u")return;const n=hl.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},h_=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&Vf(n[1]);return e&&JSON.parse(e)},Yi=()=>{try{return s_()||u_()||l_()||h_()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Of=n=>Yi()?.emulatorHosts?.[n],Mf=n=>{const e=Of(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},Lf=()=>Yi()?.config,xf=n=>Yi()?.[`_${n}`];class f_{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}function fn(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function ec(n){return(await fetch(n,{credentials:"include"})).ok}function d_(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",s=n.iat||0,i=n.sub||n.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a={iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...n};return[Ii(JSON.stringify(t)),Ii(JSON.stringify(a)),""].join(".")}const as={};function p_(){const n={prod:[],emulator:[]};for(const e of Object.keys(as))as[e]?n.emulator.push(e):n.prod.push(e);return n}function m_(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let fl=!1;function tc(n,e){if(typeof window>"u"||typeof document>"u"||!fn(window.location.host)||as[n]===e||as[n]||fl)return;as[n]=e;function t(g){return`__firebase__banner__${g}`}const r="__firebase__banner",i=p_().prod.length>0;function a(){const g=document.getElementById(r);g&&g.remove()}function c(g){g.style.display="flex",g.style.background="#7faaf0",g.style.position="fixed",g.style.bottom="5px",g.style.left="5px",g.style.padding=".5em",g.style.borderRadius="5px",g.style.alignItems="center"}function l(g,T){g.setAttribute("width","24"),g.setAttribute("id",T),g.setAttribute("height","24"),g.setAttribute("viewBox","0 0 24 24"),g.setAttribute("fill","none"),g.style.marginLeft="-6px"}function h(){const g=document.createElement("span");return g.style.cursor="pointer",g.style.marginLeft="16px",g.style.fontSize="24px",g.innerHTML=" &times;",g.onclick=()=>{fl=!0,a()},g}function d(g,T){g.setAttribute("id",T),g.innerText="Learn more",g.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",g.setAttribute("target","__blank"),g.style.paddingLeft="5px",g.style.textDecoration="underline"}function m(){const g=m_(r),T=t("text"),S=document.getElementById(T)||document.createElement("span"),k=t("learnmore"),P=document.getElementById(k)||document.createElement("a"),x=t("preprendIcon"),V=document.getElementById(x)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(g.created){const M=g.element;c(M),d(P,k);const K=h();l(V,x),M.append(V,S,P,K),document.body.appendChild(M)}i?(S.innerText="Preview backend disconnected.",V.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(V.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,S.innerText="Preview backend running in this workspace."),S.setAttribute("id",T)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",m):m()}function Oe(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function g_(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Oe())}function __(){const n=Yi()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function y_(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function v_(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function E_(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function T_(){const n=Oe();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function I_(){return!__()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function w_(){try{return typeof indexedDB=="object"}catch{return!1}}function A_(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{e(s.error?.message||"")}}catch(t){e(t)}})}const b_="FirebaseError";class At extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=b_,Object.setPrototypeOf(this,At.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ss.prototype.create)}}class Ss{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},s=`${this.service}/${e}`,i=this.errors[e],a=i?R_(i,r):"Error",c=`${this.serviceName}: ${a} (${s}).`;return new At(s,c,r)}}function R_(n,e){return n.replace(S_,(t,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const S_=/\{\$([^}]+)}/g;function P_(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Dn(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const s of t){if(!r.includes(s))return!1;const i=n[s],a=e[s];if(dl(i)&&dl(a)){if(!Dn(i,a))return!1}else if(i!==a)return!1}for(const s of r)if(!t.includes(s))return!1;return!0}function dl(n){return n!==null&&typeof n=="object"}function Ps(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function C_(n,e){const t=new k_(n,e);return t.subscribe.bind(t)}class k_{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let s;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");N_(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:r},s.next===void 0&&(s.next=Ko),s.error===void 0&&(s.error=Ko),s.complete===void 0&&(s.complete=Ko);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function N_(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Ko(){}function pe(n){return n&&n._delegate?n._delegate:n}class sn{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const En="[DEFAULT]";class D_{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new f_;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(O_(e))try{this.getOrInitializeService({instanceIdentifier:En})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=En){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=En){return this.instances.has(e)}getOptions(e=En){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[i,a]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(i);r===c&&a.resolve(s)}return s}onInit(e,t){const r=this.normalizeInstanceIdentifier(t),s=this.onInitCallbacks.get(r)??new Set;s.add(e),this.onInitCallbacks.set(r,s);const i=this.instances.get(r);return i&&e(i,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const s of r)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:V_(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=En){return this.component?this.component.multipleInstances?e:En:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function V_(n){return n===En?void 0:n}function O_(n){return n.instantiationMode==="EAGER"}class M_{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new D_(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var H;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(H||(H={}));const L_={debug:H.DEBUG,verbose:H.VERBOSE,info:H.INFO,warn:H.WARN,error:H.ERROR,silent:H.SILENT},x_=H.INFO,F_={[H.DEBUG]:"log",[H.VERBOSE]:"log",[H.INFO]:"info",[H.WARN]:"warn",[H.ERROR]:"error"},U_=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),s=F_[e];if(s)console[s](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class nc{constructor(e){this.name=e,this._logLevel=x_,this._logHandler=U_,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in H))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?L_[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,H.DEBUG,...e),this._logHandler(this,H.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,H.VERBOSE,...e),this._logHandler(this,H.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,H.INFO,...e),this._logHandler(this,H.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,H.WARN,...e),this._logHandler(this,H.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,H.ERROR,...e),this._logHandler(this,H.ERROR,...e)}}const B_=(n,e)=>e.some(t=>n instanceof t);let pl,ml;function j_(){return pl||(pl=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function $_(){return ml||(ml=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Ff=new WeakMap,pa=new WeakMap,Uf=new WeakMap,Qo=new WeakMap,rc=new WeakMap;function q_(n){const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("success",i),n.removeEventListener("error",a)},i=()=>{t(Zt(n.result)),s()},a=()=>{r(n.error),s()};n.addEventListener("success",i),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&Ff.set(t,n)}).catch(()=>{}),rc.set(e,n),e}function z_(n){if(pa.has(n))return;const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("complete",i),n.removeEventListener("error",a),n.removeEventListener("abort",a)},i=()=>{t(),s()},a=()=>{r(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",i),n.addEventListener("error",a),n.addEventListener("abort",a)});pa.set(n,e)}let ma={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return pa.get(n);if(e==="objectStoreNames")return n.objectStoreNames||Uf.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Zt(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function H_(n){ma=n(ma)}function G_(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(Xo(this),e,...t);return Uf.set(r,e.sort?e.sort():[e]),Zt(r)}:$_().includes(n)?function(...e){return n.apply(Xo(this),e),Zt(Ff.get(this))}:function(...e){return Zt(n.apply(Xo(this),e))}}function W_(n){return typeof n=="function"?G_(n):(n instanceof IDBTransaction&&z_(n),B_(n,j_())?new Proxy(n,ma):n)}function Zt(n){if(n instanceof IDBRequest)return q_(n);if(Qo.has(n))return Qo.get(n);const e=W_(n);return e!==n&&(Qo.set(n,e),rc.set(e,n)),e}const Xo=n=>rc.get(n);function K_(n,e,{blocked:t,upgrade:r,blocking:s,terminated:i}={}){const a=indexedDB.open(n,e),c=Zt(a);return r&&a.addEventListener("upgradeneeded",l=>{r(Zt(a.result),l.oldVersion,l.newVersion,Zt(a.transaction),l)}),t&&a.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),c.then(l=>{i&&l.addEventListener("close",()=>i()),s&&l.addEventListener("versionchange",h=>s(h.oldVersion,h.newVersion,h))}).catch(()=>{}),c}const Q_=["get","getKey","getAll","getAllKeys","count"],X_=["put","add","delete","clear"],Jo=new Map;function gl(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Jo.get(e))return Jo.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,s=X_.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(s||Q_.includes(t)))return;const i=async function(a,...c){const l=this.transaction(a,s?"readwrite":"readonly");let h=l.store;return r&&(h=h.index(c.shift())),(await Promise.all([h[t](...c),s&&l.done]))[0]};return Jo.set(e,i),i}H_(n=>({...n,get:(e,t,r)=>gl(e,t)||n.get(e,t,r),has:(e,t)=>!!gl(e,t)||n.has(e,t)}));class J_{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(Y_(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function Y_(n){return n.getComponent()?.type==="VERSION"}const ga="@firebase/app",_l="0.14.5";const Nt=new nc("@firebase/app"),Z_="@firebase/app-compat",ey="@firebase/analytics-compat",ty="@firebase/analytics",ny="@firebase/app-check-compat",ry="@firebase/app-check",sy="@firebase/auth",iy="@firebase/auth-compat",oy="@firebase/database",ay="@firebase/data-connect",cy="@firebase/database-compat",uy="@firebase/functions",ly="@firebase/functions-compat",hy="@firebase/installations",fy="@firebase/installations-compat",dy="@firebase/messaging",py="@firebase/messaging-compat",my="@firebase/performance",gy="@firebase/performance-compat",_y="@firebase/remote-config",yy="@firebase/remote-config-compat",vy="@firebase/storage",Ey="@firebase/storage-compat",Ty="@firebase/firestore",Iy="@firebase/ai",wy="@firebase/firestore-compat",Ay="firebase",by="12.5.0";const _a="[DEFAULT]",Ry={[ga]:"fire-core",[Z_]:"fire-core-compat",[ty]:"fire-analytics",[ey]:"fire-analytics-compat",[ry]:"fire-app-check",[ny]:"fire-app-check-compat",[sy]:"fire-auth",[iy]:"fire-auth-compat",[oy]:"fire-rtdb",[ay]:"fire-data-connect",[cy]:"fire-rtdb-compat",[uy]:"fire-fn",[ly]:"fire-fn-compat",[hy]:"fire-iid",[fy]:"fire-iid-compat",[dy]:"fire-fcm",[py]:"fire-fcm-compat",[my]:"fire-perf",[gy]:"fire-perf-compat",[_y]:"fire-rc",[yy]:"fire-rc-compat",[vy]:"fire-gcs",[Ey]:"fire-gcs-compat",[Ty]:"fire-fst",[wy]:"fire-fst-compat",[Iy]:"fire-vertex","fire-js":"fire-js",[Ay]:"fire-js-all"};const wi=new Map,Sy=new Map,ya=new Map;function yl(n,e){try{n.container.addComponent(e)}catch(t){Nt.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Vn(n){const e=n.name;if(ya.has(e))return Nt.debug(`There were multiple attempts to register component ${e}.`),!1;ya.set(e,n);for(const t of wi.values())yl(t,n);for(const t of Sy.values())yl(t,n);return!0}function Zi(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Ye(n){return n==null?!1:n.settings!==void 0}const Py={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},en=new Ss("app","Firebase",Py);class Cy{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new sn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw en.create("app-deleted",{appName:this._name})}}const kr=by;function Bf(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r={name:_a,automaticDataCollectionEnabled:!0,...e},s=r.name;if(typeof s!="string"||!s)throw en.create("bad-app-name",{appName:String(s)});if(t||(t=Lf()),!t)throw en.create("no-options");const i=wi.get(s);if(i){if(Dn(t,i.options)&&Dn(r,i.config))return i;throw en.create("duplicate-app",{appName:s})}const a=new M_(s);for(const l of ya.values())a.addComponent(l);const c=new Cy(t,r,a);return wi.set(s,c),c}function sc(n=_a){const e=wi.get(n);if(!e&&n===_a&&Lf())return Bf();if(!e)throw en.create("no-app",{appName:n});return e}function dt(n,e,t){let r=Ry[n]??n;t&&(r+=`-${t}`);const s=r.match(/\s|\//),i=e.match(/\s|\//);if(s||i){const a=[`Unable to register library "${r}" with version "${e}":`];s&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&i&&a.push("and"),i&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Nt.warn(a.join(" "));return}Vn(new sn(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}const ky="firebase-heartbeat-database",Ny=1,_s="firebase-heartbeat-store";let Yo=null;function jf(){return Yo||(Yo=K_(ky,Ny,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(_s)}catch(t){console.warn(t)}}}}).catch(n=>{throw en.create("idb-open",{originalErrorMessage:n.message})})),Yo}async function Dy(n){try{const t=(await jf()).transaction(_s),r=await t.objectStore(_s).get($f(n));return await t.done,r}catch(e){if(e instanceof At)Nt.warn(e.message);else{const t=en.create("idb-get",{originalErrorMessage:e?.message});Nt.warn(t.message)}}}async function vl(n,e){try{const r=(await jf()).transaction(_s,"readwrite");await r.objectStore(_s).put(e,$f(n)),await r.done}catch(t){if(t instanceof At)Nt.warn(t.message);else{const r=en.create("idb-set",{originalErrorMessage:t?.message});Nt.warn(r.message)}}}function $f(n){return`${n.name}!${n.options.appId}`}const Vy=1024,Oy=30;class My{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new xy(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=El();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(s=>s.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:t}),this._heartbeatsCache.heartbeats.length>Oy){const s=Fy(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(s,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Nt.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=El(),{heartbeatsToSend:t,unsentEntries:r}=Ly(this._heartbeatsCache.heartbeats),s=Ii(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(e){return Nt.warn(e),""}}}function El(){return new Date().toISOString().substring(0,10)}function Ly(n,e=Vy){const t=[];let r=n.slice();for(const s of n){const i=t.find(a=>a.agent===s.agent);if(i){if(i.dates.push(s.date),Tl(t)>e){i.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),Tl(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class xy{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return w_()?A_().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await Dy(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return vl(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return vl(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function Tl(n){return Ii(JSON.stringify({version:2,heartbeats:n})).length}function Fy(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function Uy(n){Vn(new sn("platform-logger",e=>new J_(e),"PRIVATE")),Vn(new sn("heartbeat",e=>new My(e),"PRIVATE")),dt(ga,_l,n),dt(ga,_l,"esm2020"),dt("fire-js","")}Uy("");var By="firebase",jy="12.5.0";dt(By,jy,"app");var Il=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var tn,qf;(function(){var n;function e(I,_){function v(){}v.prototype=_.prototype,I.F=_.prototype,I.prototype=new v,I.prototype.constructor=I,I.D=function(w,E,A){for(var y=Array(arguments.length-2),ae=2;ae<arguments.length;ae++)y[ae-2]=arguments[ae];return _.prototype[E].apply(w,y)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(I,_,v){v||(v=0);const w=Array(16);if(typeof _=="string")for(var E=0;E<16;++E)w[E]=_.charCodeAt(v++)|_.charCodeAt(v++)<<8|_.charCodeAt(v++)<<16|_.charCodeAt(v++)<<24;else for(E=0;E<16;++E)w[E]=_[v++]|_[v++]<<8|_[v++]<<16|_[v++]<<24;_=I.g[0],v=I.g[1],E=I.g[2];let A=I.g[3],y;y=_+(A^v&(E^A))+w[0]+3614090360&4294967295,_=v+(y<<7&4294967295|y>>>25),y=A+(E^_&(v^E))+w[1]+3905402710&4294967295,A=_+(y<<12&4294967295|y>>>20),y=E+(v^A&(_^v))+w[2]+606105819&4294967295,E=A+(y<<17&4294967295|y>>>15),y=v+(_^E&(A^_))+w[3]+3250441966&4294967295,v=E+(y<<22&4294967295|y>>>10),y=_+(A^v&(E^A))+w[4]+4118548399&4294967295,_=v+(y<<7&4294967295|y>>>25),y=A+(E^_&(v^E))+w[5]+1200080426&4294967295,A=_+(y<<12&4294967295|y>>>20),y=E+(v^A&(_^v))+w[6]+2821735955&4294967295,E=A+(y<<17&4294967295|y>>>15),y=v+(_^E&(A^_))+w[7]+4249261313&4294967295,v=E+(y<<22&4294967295|y>>>10),y=_+(A^v&(E^A))+w[8]+1770035416&4294967295,_=v+(y<<7&4294967295|y>>>25),y=A+(E^_&(v^E))+w[9]+2336552879&4294967295,A=_+(y<<12&4294967295|y>>>20),y=E+(v^A&(_^v))+w[10]+4294925233&4294967295,E=A+(y<<17&4294967295|y>>>15),y=v+(_^E&(A^_))+w[11]+2304563134&4294967295,v=E+(y<<22&4294967295|y>>>10),y=_+(A^v&(E^A))+w[12]+1804603682&4294967295,_=v+(y<<7&4294967295|y>>>25),y=A+(E^_&(v^E))+w[13]+4254626195&4294967295,A=_+(y<<12&4294967295|y>>>20),y=E+(v^A&(_^v))+w[14]+2792965006&4294967295,E=A+(y<<17&4294967295|y>>>15),y=v+(_^E&(A^_))+w[15]+1236535329&4294967295,v=E+(y<<22&4294967295|y>>>10),y=_+(E^A&(v^E))+w[1]+4129170786&4294967295,_=v+(y<<5&4294967295|y>>>27),y=A+(v^E&(_^v))+w[6]+3225465664&4294967295,A=_+(y<<9&4294967295|y>>>23),y=E+(_^v&(A^_))+w[11]+643717713&4294967295,E=A+(y<<14&4294967295|y>>>18),y=v+(A^_&(E^A))+w[0]+3921069994&4294967295,v=E+(y<<20&4294967295|y>>>12),y=_+(E^A&(v^E))+w[5]+3593408605&4294967295,_=v+(y<<5&4294967295|y>>>27),y=A+(v^E&(_^v))+w[10]+38016083&4294967295,A=_+(y<<9&4294967295|y>>>23),y=E+(_^v&(A^_))+w[15]+3634488961&4294967295,E=A+(y<<14&4294967295|y>>>18),y=v+(A^_&(E^A))+w[4]+3889429448&4294967295,v=E+(y<<20&4294967295|y>>>12),y=_+(E^A&(v^E))+w[9]+568446438&4294967295,_=v+(y<<5&4294967295|y>>>27),y=A+(v^E&(_^v))+w[14]+3275163606&4294967295,A=_+(y<<9&4294967295|y>>>23),y=E+(_^v&(A^_))+w[3]+4107603335&4294967295,E=A+(y<<14&4294967295|y>>>18),y=v+(A^_&(E^A))+w[8]+1163531501&4294967295,v=E+(y<<20&4294967295|y>>>12),y=_+(E^A&(v^E))+w[13]+2850285829&4294967295,_=v+(y<<5&4294967295|y>>>27),y=A+(v^E&(_^v))+w[2]+4243563512&4294967295,A=_+(y<<9&4294967295|y>>>23),y=E+(_^v&(A^_))+w[7]+1735328473&4294967295,E=A+(y<<14&4294967295|y>>>18),y=v+(A^_&(E^A))+w[12]+2368359562&4294967295,v=E+(y<<20&4294967295|y>>>12),y=_+(v^E^A)+w[5]+4294588738&4294967295,_=v+(y<<4&4294967295|y>>>28),y=A+(_^v^E)+w[8]+2272392833&4294967295,A=_+(y<<11&4294967295|y>>>21),y=E+(A^_^v)+w[11]+1839030562&4294967295,E=A+(y<<16&4294967295|y>>>16),y=v+(E^A^_)+w[14]+4259657740&4294967295,v=E+(y<<23&4294967295|y>>>9),y=_+(v^E^A)+w[1]+2763975236&4294967295,_=v+(y<<4&4294967295|y>>>28),y=A+(_^v^E)+w[4]+1272893353&4294967295,A=_+(y<<11&4294967295|y>>>21),y=E+(A^_^v)+w[7]+4139469664&4294967295,E=A+(y<<16&4294967295|y>>>16),y=v+(E^A^_)+w[10]+3200236656&4294967295,v=E+(y<<23&4294967295|y>>>9),y=_+(v^E^A)+w[13]+681279174&4294967295,_=v+(y<<4&4294967295|y>>>28),y=A+(_^v^E)+w[0]+3936430074&4294967295,A=_+(y<<11&4294967295|y>>>21),y=E+(A^_^v)+w[3]+3572445317&4294967295,E=A+(y<<16&4294967295|y>>>16),y=v+(E^A^_)+w[6]+76029189&4294967295,v=E+(y<<23&4294967295|y>>>9),y=_+(v^E^A)+w[9]+3654602809&4294967295,_=v+(y<<4&4294967295|y>>>28),y=A+(_^v^E)+w[12]+3873151461&4294967295,A=_+(y<<11&4294967295|y>>>21),y=E+(A^_^v)+w[15]+530742520&4294967295,E=A+(y<<16&4294967295|y>>>16),y=v+(E^A^_)+w[2]+3299628645&4294967295,v=E+(y<<23&4294967295|y>>>9),y=_+(E^(v|~A))+w[0]+4096336452&4294967295,_=v+(y<<6&4294967295|y>>>26),y=A+(v^(_|~E))+w[7]+1126891415&4294967295,A=_+(y<<10&4294967295|y>>>22),y=E+(_^(A|~v))+w[14]+2878612391&4294967295,E=A+(y<<15&4294967295|y>>>17),y=v+(A^(E|~_))+w[5]+4237533241&4294967295,v=E+(y<<21&4294967295|y>>>11),y=_+(E^(v|~A))+w[12]+1700485571&4294967295,_=v+(y<<6&4294967295|y>>>26),y=A+(v^(_|~E))+w[3]+2399980690&4294967295,A=_+(y<<10&4294967295|y>>>22),y=E+(_^(A|~v))+w[10]+4293915773&4294967295,E=A+(y<<15&4294967295|y>>>17),y=v+(A^(E|~_))+w[1]+2240044497&4294967295,v=E+(y<<21&4294967295|y>>>11),y=_+(E^(v|~A))+w[8]+1873313359&4294967295,_=v+(y<<6&4294967295|y>>>26),y=A+(v^(_|~E))+w[15]+4264355552&4294967295,A=_+(y<<10&4294967295|y>>>22),y=E+(_^(A|~v))+w[6]+2734768916&4294967295,E=A+(y<<15&4294967295|y>>>17),y=v+(A^(E|~_))+w[13]+1309151649&4294967295,v=E+(y<<21&4294967295|y>>>11),y=_+(E^(v|~A))+w[4]+4149444226&4294967295,_=v+(y<<6&4294967295|y>>>26),y=A+(v^(_|~E))+w[11]+3174756917&4294967295,A=_+(y<<10&4294967295|y>>>22),y=E+(_^(A|~v))+w[2]+718787259&4294967295,E=A+(y<<15&4294967295|y>>>17),y=v+(A^(E|~_))+w[9]+3951481745&4294967295,I.g[0]=I.g[0]+_&4294967295,I.g[1]=I.g[1]+(E+(y<<21&4294967295|y>>>11))&4294967295,I.g[2]=I.g[2]+E&4294967295,I.g[3]=I.g[3]+A&4294967295}r.prototype.v=function(I,_){_===void 0&&(_=I.length);const v=_-this.blockSize,w=this.C;let E=this.h,A=0;for(;A<_;){if(E==0)for(;A<=v;)s(this,I,A),A+=this.blockSize;if(typeof I=="string"){for(;A<_;)if(w[E++]=I.charCodeAt(A++),E==this.blockSize){s(this,w),E=0;break}}else for(;A<_;)if(w[E++]=I[A++],E==this.blockSize){s(this,w),E=0;break}}this.h=E,this.o+=_},r.prototype.A=function(){var I=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);I[0]=128;for(var _=1;_<I.length-8;++_)I[_]=0;_=this.o*8;for(var v=I.length-8;v<I.length;++v)I[v]=_&255,_/=256;for(this.v(I),I=Array(16),_=0,v=0;v<4;++v)for(let w=0;w<32;w+=8)I[_++]=this.g[v]>>>w&255;return I};function i(I,_){var v=c;return Object.prototype.hasOwnProperty.call(v,I)?v[I]:v[I]=_(I)}function a(I,_){this.h=_;const v=[];let w=!0;for(let E=I.length-1;E>=0;E--){const A=I[E]|0;w&&A==_||(v[E]=A,w=!1)}this.g=v}var c={};function l(I){return-128<=I&&I<128?i(I,function(_){return new a([_|0],_<0?-1:0)}):new a([I|0],I<0?-1:0)}function h(I){if(isNaN(I)||!isFinite(I))return m;if(I<0)return P(h(-I));const _=[];let v=1;for(let w=0;I>=v;w++)_[w]=I/v|0,v*=4294967296;return new a(_,0)}function d(I,_){if(I.length==0)throw Error("number format error: empty string");if(_=_||10,_<2||36<_)throw Error("radix out of range: "+_);if(I.charAt(0)=="-")return P(d(I.substring(1),_));if(I.indexOf("-")>=0)throw Error('number format error: interior "-" character');const v=h(Math.pow(_,8));let w=m;for(let A=0;A<I.length;A+=8){var E=Math.min(8,I.length-A);const y=parseInt(I.substring(A,A+E),_);E<8?(E=h(Math.pow(_,E)),w=w.j(E).add(h(y))):(w=w.j(v),w=w.add(h(y)))}return w}var m=l(0),g=l(1),T=l(16777216);n=a.prototype,n.m=function(){if(k(this))return-P(this).m();let I=0,_=1;for(let v=0;v<this.g.length;v++){const w=this.i(v);I+=(w>=0?w:4294967296+w)*_,_*=4294967296}return I},n.toString=function(I){if(I=I||10,I<2||36<I)throw Error("radix out of range: "+I);if(S(this))return"0";if(k(this))return"-"+P(this).toString(I);const _=h(Math.pow(I,6));var v=this;let w="";for(;;){const E=K(v,_).g;v=x(v,E.j(_));let A=((v.g.length>0?v.g[0]:v.h)>>>0).toString(I);if(v=E,S(v))return A+w;for(;A.length<6;)A="0"+A;w=A+w}},n.i=function(I){return I<0?0:I<this.g.length?this.g[I]:this.h};function S(I){if(I.h!=0)return!1;for(let _=0;_<I.g.length;_++)if(I.g[_]!=0)return!1;return!0}function k(I){return I.h==-1}n.l=function(I){return I=x(this,I),k(I)?-1:S(I)?0:1};function P(I){const _=I.g.length,v=[];for(let w=0;w<_;w++)v[w]=~I.g[w];return new a(v,~I.h).add(g)}n.abs=function(){return k(this)?P(this):this},n.add=function(I){const _=Math.max(this.g.length,I.g.length),v=[];let w=0;for(let E=0;E<=_;E++){let A=w+(this.i(E)&65535)+(I.i(E)&65535),y=(A>>>16)+(this.i(E)>>>16)+(I.i(E)>>>16);w=y>>>16,A&=65535,y&=65535,v[E]=y<<16|A}return new a(v,v[v.length-1]&-2147483648?-1:0)};function x(I,_){return I.add(P(_))}n.j=function(I){if(S(this)||S(I))return m;if(k(this))return k(I)?P(this).j(P(I)):P(P(this).j(I));if(k(I))return P(this.j(P(I)));if(this.l(T)<0&&I.l(T)<0)return h(this.m()*I.m());const _=this.g.length+I.g.length,v=[];for(var w=0;w<2*_;w++)v[w]=0;for(w=0;w<this.g.length;w++)for(let E=0;E<I.g.length;E++){const A=this.i(w)>>>16,y=this.i(w)&65535,ae=I.i(E)>>>16,bt=I.i(E)&65535;v[2*w+2*E]+=y*bt,V(v,2*w+2*E),v[2*w+2*E+1]+=A*bt,V(v,2*w+2*E+1),v[2*w+2*E+1]+=y*ae,V(v,2*w+2*E+1),v[2*w+2*E+2]+=A*ae,V(v,2*w+2*E+2)}for(I=0;I<_;I++)v[I]=v[2*I+1]<<16|v[2*I];for(I=_;I<2*_;I++)v[I]=0;return new a(v,0)};function V(I,_){for(;(I[_]&65535)!=I[_];)I[_+1]+=I[_]>>>16,I[_]&=65535,_++}function M(I,_){this.g=I,this.h=_}function K(I,_){if(S(_))throw Error("division by zero");if(S(I))return new M(m,m);if(k(I))return _=K(P(I),_),new M(P(_.g),P(_.h));if(k(_))return _=K(I,P(_)),new M(P(_.g),_.h);if(I.g.length>30){if(k(I)||k(_))throw Error("slowDivide_ only works with positive integers.");for(var v=g,w=_;w.l(I)<=0;)v=X(v),w=X(w);var E=Y(v,1),A=Y(w,1);for(w=Y(w,2),v=Y(v,2);!S(w);){var y=A.add(w);y.l(I)<=0&&(E=E.add(v),A=y),w=Y(w,1),v=Y(v,1)}return _=x(I,E.j(_)),new M(E,_)}for(E=m;I.l(_)>=0;){for(v=Math.max(1,Math.floor(I.m()/_.m())),w=Math.ceil(Math.log(v)/Math.LN2),w=w<=48?1:Math.pow(2,w-48),A=h(v),y=A.j(_);k(y)||y.l(I)>0;)v-=w,A=h(v),y=A.j(_);S(A)&&(A=g),E=E.add(A),I=x(I,y)}return new M(E,I)}n.B=function(I){return K(this,I).h},n.and=function(I){const _=Math.max(this.g.length,I.g.length),v=[];for(let w=0;w<_;w++)v[w]=this.i(w)&I.i(w);return new a(v,this.h&I.h)},n.or=function(I){const _=Math.max(this.g.length,I.g.length),v=[];for(let w=0;w<_;w++)v[w]=this.i(w)|I.i(w);return new a(v,this.h|I.h)},n.xor=function(I){const _=Math.max(this.g.length,I.g.length),v=[];for(let w=0;w<_;w++)v[w]=this.i(w)^I.i(w);return new a(v,this.h^I.h)};function X(I){const _=I.g.length+1,v=[];for(let w=0;w<_;w++)v[w]=I.i(w)<<1|I.i(w-1)>>>31;return new a(v,I.h)}function Y(I,_){const v=_>>5;_%=32;const w=I.g.length-v,E=[];for(let A=0;A<w;A++)E[A]=_>0?I.i(A+v)>>>_|I.i(A+v+1)<<32-_:I.i(A+v);return new a(E,I.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,qf=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.B,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=h,a.fromString=d,tn=a}).apply(typeof Il<"u"?Il:typeof self<"u"?self:typeof window<"u"?window:{});var ei=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var zf,Zr,Hf,ci,va,Gf,Wf,Kf;(function(){var n,e=Object.defineProperty;function t(o){o=[typeof globalThis=="object"&&globalThis,o,typeof window=="object"&&window,typeof self=="object"&&self,typeof ei=="object"&&ei];for(var u=0;u<o.length;++u){var f=o[u];if(f&&f.Math==Math)return f}throw Error("Cannot find global object")}var r=t(this);function s(o,u){if(u)e:{var f=r;o=o.split(".");for(var p=0;p<o.length-1;p++){var b=o[p];if(!(b in f))break e;f=f[b]}o=o[o.length-1],p=f[o],u=u(p),u!=p&&u!=null&&e(f,o,{configurable:!0,writable:!0,value:u})}}s("Symbol.dispose",function(o){return o||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(o){return o||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(o){return o||function(u){var f=[],p;for(p in u)Object.prototype.hasOwnProperty.call(u,p)&&f.push([p,u[p]]);return f}});var i=i||{},a=this||self;function c(o){var u=typeof o;return u=="object"&&o!=null||u=="function"}function l(o,u,f){return o.call.apply(o.bind,arguments)}function h(o,u,f){return h=l,h.apply(null,arguments)}function d(o,u){var f=Array.prototype.slice.call(arguments,1);return function(){var p=f.slice();return p.push.apply(p,arguments),o.apply(this,p)}}function m(o,u){function f(){}f.prototype=u.prototype,o.Z=u.prototype,o.prototype=new f,o.prototype.constructor=o,o.Ob=function(p,b,R){for(var D=Array(arguments.length-2),z=2;z<arguments.length;z++)D[z-2]=arguments[z];return u.prototype[b].apply(p,D)}}var g=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?o=>o&&AsyncContext.Snapshot.wrap(o):o=>o;function T(o){const u=o.length;if(u>0){const f=Array(u);for(let p=0;p<u;p++)f[p]=o[p];return f}return[]}function S(o,u){for(let p=1;p<arguments.length;p++){const b=arguments[p];var f=typeof b;if(f=f!="object"?f:b?Array.isArray(b)?"array":f:"null",f=="array"||f=="object"&&typeof b.length=="number"){f=o.length||0;const R=b.length||0;o.length=f+R;for(let D=0;D<R;D++)o[f+D]=b[D]}else o.push(b)}}class k{constructor(u,f){this.i=u,this.j=f,this.h=0,this.g=null}get(){let u;return this.h>0?(this.h--,u=this.g,this.g=u.next,u.next=null):u=this.i(),u}}function P(o){a.setTimeout(()=>{throw o},0)}function x(){var o=I;let u=null;return o.g&&(u=o.g,o.g=o.g.next,o.g||(o.h=null),u.next=null),u}class V{constructor(){this.h=this.g=null}add(u,f){const p=M.get();p.set(u,f),this.h?this.h.next=p:this.g=p,this.h=p}}var M=new k(()=>new K,o=>o.reset());class K{constructor(){this.next=this.g=this.h=null}set(u,f){this.h=u,this.g=f,this.next=null}reset(){this.next=this.g=this.h=null}}let X,Y=!1,I=new V,_=()=>{const o=Promise.resolve(void 0);X=()=>{o.then(v)}};function v(){for(var o;o=x();){try{o.h.call(o.g)}catch(f){P(f)}var u=M;u.j(o),u.h<100&&(u.h++,o.next=u.g,u.g=o)}Y=!1}function w(){this.u=this.u,this.C=this.C}w.prototype.u=!1,w.prototype.dispose=function(){this.u||(this.u=!0,this.N())},w.prototype[Symbol.dispose]=function(){this.dispose()},w.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function E(o,u){this.type=o,this.g=this.target=u,this.defaultPrevented=!1}E.prototype.h=function(){this.defaultPrevented=!0};var A=(function(){if(!a.addEventListener||!Object.defineProperty)return!1;var o=!1,u=Object.defineProperty({},"passive",{get:function(){o=!0}});try{const f=()=>{};a.addEventListener("test",f,u),a.removeEventListener("test",f,u)}catch{}return o})();function y(o){return/^[\s\xa0]*$/.test(o)}function ae(o,u){E.call(this,o?o.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,o&&this.init(o,u)}m(ae,E),ae.prototype.init=function(o,u){const f=this.type=o.type,p=o.changedTouches&&o.changedTouches.length?o.changedTouches[0]:null;this.target=o.target||o.srcElement,this.g=u,u=o.relatedTarget,u||(f=="mouseover"?u=o.fromElement:f=="mouseout"&&(u=o.toElement)),this.relatedTarget=u,p?(this.clientX=p.clientX!==void 0?p.clientX:p.pageX,this.clientY=p.clientY!==void 0?p.clientY:p.pageY,this.screenX=p.screenX||0,this.screenY=p.screenY||0):(this.clientX=o.clientX!==void 0?o.clientX:o.pageX,this.clientY=o.clientY!==void 0?o.clientY:o.pageY,this.screenX=o.screenX||0,this.screenY=o.screenY||0),this.button=o.button,this.key=o.key||"",this.ctrlKey=o.ctrlKey,this.altKey=o.altKey,this.shiftKey=o.shiftKey,this.metaKey=o.metaKey,this.pointerId=o.pointerId||0,this.pointerType=o.pointerType,this.state=o.state,this.i=o,o.defaultPrevented&&ae.Z.h.call(this)},ae.prototype.h=function(){ae.Z.h.call(this);const o=this.i;o.preventDefault?o.preventDefault():o.returnValue=!1};var bt="closure_listenable_"+(Math.random()*1e6|0),Xp=0;function Jp(o,u,f,p,b){this.listener=o,this.proxy=null,this.src=u,this.type=f,this.capture=!!p,this.ha=b,this.key=++Xp,this.da=this.fa=!1}function xs(o){o.da=!0,o.listener=null,o.proxy=null,o.src=null,o.ha=null}function Fs(o,u,f){for(const p in o)u.call(f,o[p],p,o)}function Yp(o,u){for(const f in o)u.call(void 0,o[f],f,o)}function Yc(o){const u={};for(const f in o)u[f]=o[f];return u}const Zc="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function eu(o,u){let f,p;for(let b=1;b<arguments.length;b++){p=arguments[b];for(f in p)o[f]=p[f];for(let R=0;R<Zc.length;R++)f=Zc[R],Object.prototype.hasOwnProperty.call(p,f)&&(o[f]=p[f])}}function Us(o){this.src=o,this.g={},this.h=0}Us.prototype.add=function(o,u,f,p,b){const R=o.toString();o=this.g[R],o||(o=this.g[R]=[],this.h++);const D=Io(o,u,p,b);return D>-1?(u=o[D],f||(u.fa=!1)):(u=new Jp(u,this.src,R,!!p,b),u.fa=f,o.push(u)),u};function To(o,u){const f=u.type;if(f in o.g){var p=o.g[f],b=Array.prototype.indexOf.call(p,u,void 0),R;(R=b>=0)&&Array.prototype.splice.call(p,b,1),R&&(xs(u),o.g[f].length==0&&(delete o.g[f],o.h--))}}function Io(o,u,f,p){for(let b=0;b<o.length;++b){const R=o[b];if(!R.da&&R.listener==u&&R.capture==!!f&&R.ha==p)return b}return-1}var wo="closure_lm_"+(Math.random()*1e6|0),Ao={};function tu(o,u,f,p,b){if(Array.isArray(u)){for(let R=0;R<u.length;R++)tu(o,u[R],f,p,b);return null}return f=su(f),o&&o[bt]?o.J(u,f,c(p)?!!p.capture:!1,b):Zp(o,u,f,!1,p,b)}function Zp(o,u,f,p,b,R){if(!u)throw Error("Invalid event type");const D=c(b)?!!b.capture:!!b;let z=Ro(o);if(z||(o[wo]=z=new Us(o)),f=z.add(u,f,p,D,R),f.proxy)return f;if(p=em(),f.proxy=p,p.src=o,p.listener=f,o.addEventListener)A||(b=D),b===void 0&&(b=!1),o.addEventListener(u.toString(),p,b);else if(o.attachEvent)o.attachEvent(ru(u.toString()),p);else if(o.addListener&&o.removeListener)o.addListener(p);else throw Error("addEventListener and attachEvent are unavailable.");return f}function em(){function o(f){return u.call(o.src,o.listener,f)}const u=tm;return o}function nu(o,u,f,p,b){if(Array.isArray(u))for(var R=0;R<u.length;R++)nu(o,u[R],f,p,b);else p=c(p)?!!p.capture:!!p,f=su(f),o&&o[bt]?(o=o.i,R=String(u).toString(),R in o.g&&(u=o.g[R],f=Io(u,f,p,b),f>-1&&(xs(u[f]),Array.prototype.splice.call(u,f,1),u.length==0&&(delete o.g[R],o.h--)))):o&&(o=Ro(o))&&(u=o.g[u.toString()],o=-1,u&&(o=Io(u,f,p,b)),(f=o>-1?u[o]:null)&&bo(f))}function bo(o){if(typeof o!="number"&&o&&!o.da){var u=o.src;if(u&&u[bt])To(u.i,o);else{var f=o.type,p=o.proxy;u.removeEventListener?u.removeEventListener(f,p,o.capture):u.detachEvent?u.detachEvent(ru(f),p):u.addListener&&u.removeListener&&u.removeListener(p),(f=Ro(u))?(To(f,o),f.h==0&&(f.src=null,u[wo]=null)):xs(o)}}}function ru(o){return o in Ao?Ao[o]:Ao[o]="on"+o}function tm(o,u){if(o.da)o=!0;else{u=new ae(u,this);const f=o.listener,p=o.ha||o.src;o.fa&&bo(o),o=f.call(p,u)}return o}function Ro(o){return o=o[wo],o instanceof Us?o:null}var So="__closure_events_fn_"+(Math.random()*1e9>>>0);function su(o){return typeof o=="function"?o:(o[So]||(o[So]=function(u){return o.handleEvent(u)}),o[So])}function Pe(){w.call(this),this.i=new Us(this),this.M=this,this.G=null}m(Pe,w),Pe.prototype[bt]=!0,Pe.prototype.removeEventListener=function(o,u,f,p){nu(this,o,u,f,p)};function Me(o,u){var f,p=o.G;if(p)for(f=[];p;p=p.G)f.push(p);if(o=o.M,p=u.type||u,typeof u=="string")u=new E(u,o);else if(u instanceof E)u.target=u.target||o;else{var b=u;u=new E(p,o),eu(u,b)}b=!0;let R,D;if(f)for(D=f.length-1;D>=0;D--)R=u.g=f[D],b=Bs(R,p,!0,u)&&b;if(R=u.g=o,b=Bs(R,p,!0,u)&&b,b=Bs(R,p,!1,u)&&b,f)for(D=0;D<f.length;D++)R=u.g=f[D],b=Bs(R,p,!1,u)&&b}Pe.prototype.N=function(){if(Pe.Z.N.call(this),this.i){var o=this.i;for(const u in o.g){const f=o.g[u];for(let p=0;p<f.length;p++)xs(f[p]);delete o.g[u],o.h--}}this.G=null},Pe.prototype.J=function(o,u,f,p){return this.i.add(String(o),u,!1,f,p)},Pe.prototype.K=function(o,u,f,p){return this.i.add(String(o),u,!0,f,p)};function Bs(o,u,f,p){if(u=o.i.g[String(u)],!u)return!0;u=u.concat();let b=!0;for(let R=0;R<u.length;++R){const D=u[R];if(D&&!D.da&&D.capture==f){const z=D.listener,me=D.ha||D.src;D.fa&&To(o.i,D),b=z.call(me,p)!==!1&&b}}return b&&!p.defaultPrevented}function nm(o,u){if(typeof o!="function")if(o&&typeof o.handleEvent=="function")o=h(o.handleEvent,o);else throw Error("Invalid listener argument");return Number(u)>2147483647?-1:a.setTimeout(o,u||0)}function iu(o){o.g=nm(()=>{o.g=null,o.i&&(o.i=!1,iu(o))},o.l);const u=o.h;o.h=null,o.m.apply(null,u)}class rm extends w{constructor(u,f){super(),this.m=u,this.l=f,this.h=null,this.i=!1,this.g=null}j(u){this.h=arguments,this.g?this.i=!0:iu(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Lr(o){w.call(this),this.h=o,this.g={}}m(Lr,w);var ou=[];function au(o){Fs(o.g,function(u,f){this.g.hasOwnProperty(f)&&bo(u)},o),o.g={}}Lr.prototype.N=function(){Lr.Z.N.call(this),au(this)},Lr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Po=a.JSON.stringify,sm=a.JSON.parse,im=class{stringify(o){return a.JSON.stringify(o,void 0)}parse(o){return a.JSON.parse(o,void 0)}};function cu(){}function uu(){}var xr={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Co(){E.call(this,"d")}m(Co,E);function ko(){E.call(this,"c")}m(ko,E);var mn={},lu=null;function js(){return lu=lu||new Pe}mn.Ia="serverreachability";function hu(o){E.call(this,mn.Ia,o)}m(hu,E);function Fr(o){const u=js();Me(u,new hu(u))}mn.STAT_EVENT="statevent";function fu(o,u){E.call(this,mn.STAT_EVENT,o),this.stat=u}m(fu,E);function Le(o){const u=js();Me(u,new fu(u,o))}mn.Ja="timingevent";function du(o,u){E.call(this,mn.Ja,o),this.size=u}m(du,E);function Ur(o,u){if(typeof o!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){o()},u)}function Br(){this.g=!0}Br.prototype.ua=function(){this.g=!1};function om(o,u,f,p,b,R){o.info(function(){if(o.g)if(R){var D="",z=R.split("&");for(let ne=0;ne<z.length;ne++){var me=z[ne].split("=");if(me.length>1){const Ee=me[0];me=me[1];const at=Ee.split("_");D=at.length>=2&&at[1]=="type"?D+(Ee+"="+me+"&"):D+(Ee+"=redacted&")}}}else D=null;else D=R;return"XMLHTTP REQ ("+p+") [attempt "+b+"]: "+u+`
`+f+`
`+D})}function am(o,u,f,p,b,R,D){o.info(function(){return"XMLHTTP RESP ("+p+") [ attempt "+b+"]: "+u+`
`+f+`
`+R+" "+D})}function qn(o,u,f,p){o.info(function(){return"XMLHTTP TEXT ("+u+"): "+um(o,f)+(p?" "+p:"")})}function cm(o,u){o.info(function(){return"TIMEOUT: "+u})}Br.prototype.info=function(){};function um(o,u){if(!o.g)return u;if(!u)return null;try{const R=JSON.parse(u);if(R){for(o=0;o<R.length;o++)if(Array.isArray(R[o])){var f=R[o];if(!(f.length<2)){var p=f[1];if(Array.isArray(p)&&!(p.length<1)){var b=p[0];if(b!="noop"&&b!="stop"&&b!="close")for(let D=1;D<p.length;D++)p[D]=""}}}}return Po(R)}catch{return u}}var $s={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},pu={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},mu;function No(){}m(No,cu),No.prototype.g=function(){return new XMLHttpRequest},mu=new No;function jr(o){return encodeURIComponent(String(o))}function lm(o){var u=1;o=o.split(":");const f=[];for(;u>0&&o.length;)f.push(o.shift()),u--;return o.length&&f.push(o.join(":")),f}function Ft(o,u,f,p){this.j=o,this.i=u,this.l=f,this.S=p||1,this.V=new Lr(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new gu}function gu(){this.i=null,this.g="",this.h=!1}var _u={},Do={};function Vo(o,u,f){o.M=1,o.A=zs(ot(u)),o.u=f,o.R=!0,yu(o,null)}function yu(o,u){o.F=Date.now(),qs(o),o.B=ot(o.A);var f=o.B,p=o.S;Array.isArray(p)||(p=[String(p)]),Nu(f.i,"t",p),o.C=0,f=o.j.L,o.h=new gu,o.g=Qu(o.j,f?u:null,!o.u),o.P>0&&(o.O=new rm(h(o.Y,o,o.g),o.P)),u=o.V,f=o.g,p=o.ba;var b="readystatechange";Array.isArray(b)||(b&&(ou[0]=b.toString()),b=ou);for(let R=0;R<b.length;R++){const D=tu(f,b[R],p||u.handleEvent,!1,u.h||u);if(!D)break;u.g[D.key]=D}u=o.J?Yc(o.J):{},o.u?(o.v||(o.v="POST"),u["Content-Type"]="application/x-www-form-urlencoded",o.g.ea(o.B,o.v,o.u,u)):(o.v="GET",o.g.ea(o.B,o.v,null,u)),Fr(),om(o.i,o.v,o.B,o.l,o.S,o.u)}Ft.prototype.ba=function(o){o=o.target;const u=this.O;u&&jt(o)==3?u.j():this.Y(o)},Ft.prototype.Y=function(o){try{if(o==this.g)e:{const z=jt(this.g),me=this.g.ya(),ne=this.g.ca();if(!(z<3)&&(z!=3||this.g&&(this.h.h||this.g.la()||Fu(this.g)))){this.K||z!=4||me==7||(me==8||ne<=0?Fr(3):Fr(2)),Oo(this);var u=this.g.ca();this.X=u;var f=hm(this);if(this.o=u==200,am(this.i,this.v,this.B,this.l,this.S,z,u),this.o){if(this.U&&!this.L){t:{if(this.g){var p,b=this.g;if((p=b.g?b.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!y(p)){var R=p;break t}}R=null}if(o=R)qn(this.i,this.l,o,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Mo(this,o);else{this.o=!1,this.m=3,Le(12),gn(this),$r(this);break e}}if(this.R){o=!0;let Ee;for(;!this.K&&this.C<f.length;)if(Ee=fm(this,f),Ee==Do){z==4&&(this.m=4,Le(14),o=!1),qn(this.i,this.l,null,"[Incomplete Response]");break}else if(Ee==_u){this.m=4,Le(15),qn(this.i,this.l,f,"[Invalid Chunk]"),o=!1;break}else qn(this.i,this.l,Ee,null),Mo(this,Ee);if(vu(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),z!=4||f.length!=0||this.h.h||(this.m=1,Le(16),o=!1),this.o=this.o&&o,!o)qn(this.i,this.l,f,"[Invalid Chunked Response]"),gn(this),$r(this);else if(f.length>0&&!this.W){this.W=!0;var D=this.j;D.g==this&&D.aa&&!D.P&&(D.j.info("Great, no buffering proxy detected. Bytes received: "+f.length),qo(D),D.P=!0,Le(11))}}else qn(this.i,this.l,f,null),Mo(this,f);z==4&&gn(this),this.o&&!this.K&&(z==4?Hu(this.j,this):(this.o=!1,qs(this)))}else Rm(this.g),u==400&&f.indexOf("Unknown SID")>0?(this.m=3,Le(12)):(this.m=0,Le(13)),gn(this),$r(this)}}}catch{}finally{}};function hm(o){if(!vu(o))return o.g.la();const u=Fu(o.g);if(u==="")return"";let f="";const p=u.length,b=jt(o.g)==4;if(!o.h.i){if(typeof TextDecoder>"u")return gn(o),$r(o),"";o.h.i=new a.TextDecoder}for(let R=0;R<p;R++)o.h.h=!0,f+=o.h.i.decode(u[R],{stream:!(b&&R==p-1)});return u.length=0,o.h.g+=f,o.C=0,o.h.g}function vu(o){return o.g?o.v=="GET"&&o.M!=2&&o.j.Aa:!1}function fm(o,u){var f=o.C,p=u.indexOf(`
`,f);return p==-1?Do:(f=Number(u.substring(f,p)),isNaN(f)?_u:(p+=1,p+f>u.length?Do:(u=u.slice(p,p+f),o.C=p+f,u)))}Ft.prototype.cancel=function(){this.K=!0,gn(this)};function qs(o){o.T=Date.now()+o.H,Eu(o,o.H)}function Eu(o,u){if(o.D!=null)throw Error("WatchDog timer not null");o.D=Ur(h(o.aa,o),u)}function Oo(o){o.D&&(a.clearTimeout(o.D),o.D=null)}Ft.prototype.aa=function(){this.D=null;const o=Date.now();o-this.T>=0?(cm(this.i,this.B),this.M!=2&&(Fr(),Le(17)),gn(this),this.m=2,$r(this)):Eu(this,this.T-o)};function $r(o){o.j.I==0||o.K||Hu(o.j,o)}function gn(o){Oo(o);var u=o.O;u&&typeof u.dispose=="function"&&u.dispose(),o.O=null,au(o.V),o.g&&(u=o.g,o.g=null,u.abort(),u.dispose())}function Mo(o,u){try{var f=o.j;if(f.I!=0&&(f.g==o||Lo(f.h,o))){if(!o.L&&Lo(f.h,o)&&f.I==3){try{var p=f.Ba.g.parse(u)}catch{p=null}if(Array.isArray(p)&&p.length==3){var b=p;if(b[0]==0){e:if(!f.v){if(f.g)if(f.g.F+3e3<o.F)Qs(f),Ws(f);else break e;$o(f),Le(18)}}else f.xa=b[1],0<f.xa-f.K&&b[2]<37500&&f.F&&f.A==0&&!f.C&&(f.C=Ur(h(f.Va,f),6e3));wu(f.h)<=1&&f.ta&&(f.ta=void 0)}else yn(f,11)}else if((o.L||f.g==o)&&Qs(f),!y(u))for(b=f.Ba.g.parse(u),u=0;u<b.length;u++){let ne=b[u];const Ee=ne[0];if(!(Ee<=f.K))if(f.K=Ee,ne=ne[1],f.I==2)if(ne[0]=="c"){f.M=ne[1],f.ba=ne[2];const at=ne[3];at!=null&&(f.ka=at,f.j.info("VER="+f.ka));const vn=ne[4];vn!=null&&(f.za=vn,f.j.info("SVER="+f.za));const $t=ne[5];$t!=null&&typeof $t=="number"&&$t>0&&(p=1.5*$t,f.O=p,f.j.info("backChannelRequestTimeoutMs_="+p)),p=f;const qt=o.g;if(qt){const Js=qt.g?qt.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Js){var R=p.h;R.g||Js.indexOf("spdy")==-1&&Js.indexOf("quic")==-1&&Js.indexOf("h2")==-1||(R.j=R.l,R.g=new Set,R.h&&(xo(R,R.h),R.h=null))}if(p.G){const zo=qt.g?qt.g.getResponseHeader("X-HTTP-Session-Id"):null;zo&&(p.wa=zo,re(p.J,p.G,zo))}}f.I=3,f.l&&f.l.ra(),f.aa&&(f.T=Date.now()-o.F,f.j.info("Handshake RTT: "+f.T+"ms")),p=f;var D=o;if(p.na=Ku(p,p.L?p.ba:null,p.W),D.L){Au(p.h,D);var z=D,me=p.O;me&&(z.H=me),z.D&&(Oo(z),qs(z)),p.g=D}else qu(p);f.i.length>0&&Ks(f)}else ne[0]!="stop"&&ne[0]!="close"||yn(f,7);else f.I==3&&(ne[0]=="stop"||ne[0]=="close"?ne[0]=="stop"?yn(f,7):jo(f):ne[0]!="noop"&&f.l&&f.l.qa(ne),f.A=0)}}Fr(4)}catch{}}var dm=class{constructor(o,u){this.g=o,this.map=u}};function Tu(o){this.l=o||10,a.PerformanceNavigationTiming?(o=a.performance.getEntriesByType("navigation"),o=o.length>0&&(o[0].nextHopProtocol=="hq"||o[0].nextHopProtocol=="h2")):o=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=o?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Iu(o){return o.h?!0:o.g?o.g.size>=o.j:!1}function wu(o){return o.h?1:o.g?o.g.size:0}function Lo(o,u){return o.h?o.h==u:o.g?o.g.has(u):!1}function xo(o,u){o.g?o.g.add(u):o.h=u}function Au(o,u){o.h&&o.h==u?o.h=null:o.g&&o.g.has(u)&&o.g.delete(u)}Tu.prototype.cancel=function(){if(this.i=bu(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const o of this.g.values())o.cancel();this.g.clear()}};function bu(o){if(o.h!=null)return o.i.concat(o.h.G);if(o.g!=null&&o.g.size!==0){let u=o.i;for(const f of o.g.values())u=u.concat(f.G);return u}return T(o.i)}var Ru=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function pm(o,u){if(o){o=o.split("&");for(let f=0;f<o.length;f++){const p=o[f].indexOf("=");let b,R=null;p>=0?(b=o[f].substring(0,p),R=o[f].substring(p+1)):b=o[f],u(b,R?decodeURIComponent(R.replace(/\+/g," ")):"")}}}function Ut(o){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let u;o instanceof Ut?(this.l=o.l,qr(this,o.j),this.o=o.o,this.g=o.g,zr(this,o.u),this.h=o.h,Fo(this,Du(o.i)),this.m=o.m):o&&(u=String(o).match(Ru))?(this.l=!1,qr(this,u[1]||"",!0),this.o=Hr(u[2]||""),this.g=Hr(u[3]||"",!0),zr(this,u[4]),this.h=Hr(u[5]||"",!0),Fo(this,u[6]||"",!0),this.m=Hr(u[7]||"")):(this.l=!1,this.i=new Wr(null,this.l))}Ut.prototype.toString=function(){const o=[];var u=this.j;u&&o.push(Gr(u,Su,!0),":");var f=this.g;return(f||u=="file")&&(o.push("//"),(u=this.o)&&o.push(Gr(u,Su,!0),"@"),o.push(jr(f).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f=this.u,f!=null&&o.push(":",String(f))),(f=this.h)&&(this.g&&f.charAt(0)!="/"&&o.push("/"),o.push(Gr(f,f.charAt(0)=="/"?_m:gm,!0))),(f=this.i.toString())&&o.push("?",f),(f=this.m)&&o.push("#",Gr(f,vm)),o.join("")},Ut.prototype.resolve=function(o){const u=ot(this);let f=!!o.j;f?qr(u,o.j):f=!!o.o,f?u.o=o.o:f=!!o.g,f?u.g=o.g:f=o.u!=null;var p=o.h;if(f)zr(u,o.u);else if(f=!!o.h){if(p.charAt(0)!="/")if(this.g&&!this.h)p="/"+p;else{var b=u.h.lastIndexOf("/");b!=-1&&(p=u.h.slice(0,b+1)+p)}if(b=p,b==".."||b==".")p="";else if(b.indexOf("./")!=-1||b.indexOf("/.")!=-1){p=b.lastIndexOf("/",0)==0,b=b.split("/");const R=[];for(let D=0;D<b.length;){const z=b[D++];z=="."?p&&D==b.length&&R.push(""):z==".."?((R.length>1||R.length==1&&R[0]!="")&&R.pop(),p&&D==b.length&&R.push("")):(R.push(z),p=!0)}p=R.join("/")}else p=b}return f?u.h=p:f=o.i.toString()!=="",f?Fo(u,Du(o.i)):f=!!o.m,f&&(u.m=o.m),u};function ot(o){return new Ut(o)}function qr(o,u,f){o.j=f?Hr(u,!0):u,o.j&&(o.j=o.j.replace(/:$/,""))}function zr(o,u){if(u){if(u=Number(u),isNaN(u)||u<0)throw Error("Bad port number "+u);o.u=u}else o.u=null}function Fo(o,u,f){u instanceof Wr?(o.i=u,Em(o.i,o.l)):(f||(u=Gr(u,ym)),o.i=new Wr(u,o.l))}function re(o,u,f){o.i.set(u,f)}function zs(o){return re(o,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),o}function Hr(o,u){return o?u?decodeURI(o.replace(/%25/g,"%2525")):decodeURIComponent(o):""}function Gr(o,u,f){return typeof o=="string"?(o=encodeURI(o).replace(u,mm),f&&(o=o.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),o):null}function mm(o){return o=o.charCodeAt(0),"%"+(o>>4&15).toString(16)+(o&15).toString(16)}var Su=/[#\/\?@]/g,gm=/[#\?:]/g,_m=/[#\?]/g,ym=/[#\?@]/g,vm=/#/g;function Wr(o,u){this.h=this.g=null,this.i=o||null,this.j=!!u}function _n(o){o.g||(o.g=new Map,o.h=0,o.i&&pm(o.i,function(u,f){o.add(decodeURIComponent(u.replace(/\+/g," ")),f)}))}n=Wr.prototype,n.add=function(o,u){_n(this),this.i=null,o=zn(this,o);let f=this.g.get(o);return f||this.g.set(o,f=[]),f.push(u),this.h+=1,this};function Pu(o,u){_n(o),u=zn(o,u),o.g.has(u)&&(o.i=null,o.h-=o.g.get(u).length,o.g.delete(u))}function Cu(o,u){return _n(o),u=zn(o,u),o.g.has(u)}n.forEach=function(o,u){_n(this),this.g.forEach(function(f,p){f.forEach(function(b){o.call(u,b,p,this)},this)},this)};function ku(o,u){_n(o);let f=[];if(typeof u=="string")Cu(o,u)&&(f=f.concat(o.g.get(zn(o,u))));else for(o=Array.from(o.g.values()),u=0;u<o.length;u++)f=f.concat(o[u]);return f}n.set=function(o,u){return _n(this),this.i=null,o=zn(this,o),Cu(this,o)&&(this.h-=this.g.get(o).length),this.g.set(o,[u]),this.h+=1,this},n.get=function(o,u){return o?(o=ku(this,o),o.length>0?String(o[0]):u):u};function Nu(o,u,f){Pu(o,u),f.length>0&&(o.i=null,o.g.set(zn(o,u),T(f)),o.h+=f.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const o=[],u=Array.from(this.g.keys());for(let p=0;p<u.length;p++){var f=u[p];const b=jr(f);f=ku(this,f);for(let R=0;R<f.length;R++){let D=b;f[R]!==""&&(D+="="+jr(f[R])),o.push(D)}}return this.i=o.join("&")};function Du(o){const u=new Wr;return u.i=o.i,o.g&&(u.g=new Map(o.g),u.h=o.h),u}function zn(o,u){return u=String(u),o.j&&(u=u.toLowerCase()),u}function Em(o,u){u&&!o.j&&(_n(o),o.i=null,o.g.forEach(function(f,p){const b=p.toLowerCase();p!=b&&(Pu(this,p),Nu(this,b,f))},o)),o.j=u}function Tm(o,u){const f=new Br;if(a.Image){const p=new Image;p.onload=d(Bt,f,"TestLoadImage: loaded",!0,u,p),p.onerror=d(Bt,f,"TestLoadImage: error",!1,u,p),p.onabort=d(Bt,f,"TestLoadImage: abort",!1,u,p),p.ontimeout=d(Bt,f,"TestLoadImage: timeout",!1,u,p),a.setTimeout(function(){p.ontimeout&&p.ontimeout()},1e4),p.src=o}else u(!1)}function Im(o,u){const f=new Br,p=new AbortController,b=setTimeout(()=>{p.abort(),Bt(f,"TestPingServer: timeout",!1,u)},1e4);fetch(o,{signal:p.signal}).then(R=>{clearTimeout(b),R.ok?Bt(f,"TestPingServer: ok",!0,u):Bt(f,"TestPingServer: server error",!1,u)}).catch(()=>{clearTimeout(b),Bt(f,"TestPingServer: error",!1,u)})}function Bt(o,u,f,p,b){try{b&&(b.onload=null,b.onerror=null,b.onabort=null,b.ontimeout=null),p(f)}catch{}}function wm(){this.g=new im}function Uo(o){this.i=o.Sb||null,this.h=o.ab||!1}m(Uo,cu),Uo.prototype.g=function(){return new Hs(this.i,this.h)};function Hs(o,u){Pe.call(this),this.H=o,this.o=u,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}m(Hs,Pe),n=Hs.prototype,n.open=function(o,u){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=o,this.D=u,this.readyState=1,Qr(this)},n.send=function(o){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const u={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};o&&(u.body=o),(this.H||a).fetch(new Request(this.D,u)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Kr(this)),this.readyState=0},n.Pa=function(o){if(this.g&&(this.l=o,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=o.headers,this.readyState=2,Qr(this)),this.g&&(this.readyState=3,Qr(this),this.g)))if(this.responseType==="arraybuffer")o.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in o){if(this.j=o.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Vu(this)}else o.text().then(this.Oa.bind(this),this.ga.bind(this))};function Vu(o){o.j.read().then(o.Ma.bind(o)).catch(o.ga.bind(o))}n.Ma=function(o){if(this.g){if(this.o&&o.value)this.response.push(o.value);else if(!this.o){var u=o.value?o.value:new Uint8Array(0);(u=this.B.decode(u,{stream:!o.done}))&&(this.response=this.responseText+=u)}o.done?Kr(this):Qr(this),this.readyState==3&&Vu(this)}},n.Oa=function(o){this.g&&(this.response=this.responseText=o,Kr(this))},n.Na=function(o){this.g&&(this.response=o,Kr(this))},n.ga=function(){this.g&&Kr(this)};function Kr(o){o.readyState=4,o.l=null,o.j=null,o.B=null,Qr(o)}n.setRequestHeader=function(o,u){this.A.append(o,u)},n.getResponseHeader=function(o){return this.h&&this.h.get(o.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const o=[],u=this.h.entries();for(var f=u.next();!f.done;)f=f.value,o.push(f[0]+": "+f[1]),f=u.next();return o.join(`\r
`)};function Qr(o){o.onreadystatechange&&o.onreadystatechange.call(o)}Object.defineProperty(Hs.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(o){this.m=o?"include":"same-origin"}});function Ou(o){let u="";return Fs(o,function(f,p){u+=p,u+=":",u+=f,u+=`\r
`}),u}function Bo(o,u,f){e:{for(p in f){var p=!1;break e}p=!0}p||(f=Ou(f),typeof o=="string"?f!=null&&jr(f):re(o,u,f))}function le(o){Pe.call(this),this.headers=new Map,this.L=o||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}m(le,Pe);var Am=/^https?$/i,bm=["POST","PUT"];n=le.prototype,n.Fa=function(o){this.H=o},n.ea=function(o,u,f,p){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+o);u=u?u.toUpperCase():"GET",this.D=o,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():mu.g(),this.g.onreadystatechange=g(h(this.Ca,this));try{this.B=!0,this.g.open(u,String(o),!0),this.B=!1}catch(R){Mu(this,R);return}if(o=f||"",f=new Map(this.headers),p)if(Object.getPrototypeOf(p)===Object.prototype)for(var b in p)f.set(b,p[b]);else if(typeof p.keys=="function"&&typeof p.get=="function")for(const R of p.keys())f.set(R,p.get(R));else throw Error("Unknown input type for opt_headers: "+String(p));p=Array.from(f.keys()).find(R=>R.toLowerCase()=="content-type"),b=a.FormData&&o instanceof a.FormData,!(Array.prototype.indexOf.call(bm,u,void 0)>=0)||p||b||f.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[R,D]of f)this.g.setRequestHeader(R,D);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(o),this.v=!1}catch(R){Mu(this,R)}};function Mu(o,u){o.h=!1,o.g&&(o.j=!0,o.g.abort(),o.j=!1),o.l=u,o.o=5,Lu(o),Gs(o)}function Lu(o){o.A||(o.A=!0,Me(o,"complete"),Me(o,"error"))}n.abort=function(o){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=o||7,Me(this,"complete"),Me(this,"abort"),Gs(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Gs(this,!0)),le.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?xu(this):this.Xa())},n.Xa=function(){xu(this)};function xu(o){if(o.h&&typeof i<"u"){if(o.v&&jt(o)==4)setTimeout(o.Ca.bind(o),0);else if(Me(o,"readystatechange"),jt(o)==4){o.h=!1;try{const R=o.ca();e:switch(R){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var u=!0;break e;default:u=!1}var f;if(!(f=u)){var p;if(p=R===0){let D=String(o.D).match(Ru)[1]||null;!D&&a.self&&a.self.location&&(D=a.self.location.protocol.slice(0,-1)),p=!Am.test(D?D.toLowerCase():"")}f=p}if(f)Me(o,"complete"),Me(o,"success");else{o.o=6;try{var b=jt(o)>2?o.g.statusText:""}catch{b=""}o.l=b+" ["+o.ca()+"]",Lu(o)}}finally{Gs(o)}}}}function Gs(o,u){if(o.g){o.m&&(clearTimeout(o.m),o.m=null);const f=o.g;o.g=null,u||Me(o,"ready");try{f.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function jt(o){return o.g?o.g.readyState:0}n.ca=function(){try{return jt(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(o){if(this.g){var u=this.g.responseText;return o&&u.indexOf(o)==0&&(u=u.substring(o.length)),sm(u)}};function Fu(o){try{if(!o.g)return null;if("response"in o.g)return o.g.response;switch(o.F){case"":case"text":return o.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in o.g)return o.g.mozResponseArrayBuffer}return null}catch{return null}}function Rm(o){const u={};o=(o.g&&jt(o)>=2&&o.g.getAllResponseHeaders()||"").split(`\r
`);for(let p=0;p<o.length;p++){if(y(o[p]))continue;var f=lm(o[p]);const b=f[0];if(f=f[1],typeof f!="string")continue;f=f.trim();const R=u[b]||[];u[b]=R,R.push(f)}Yp(u,function(p){return p.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Xr(o,u,f){return f&&f.internalChannelParams&&f.internalChannelParams[o]||u}function Uu(o){this.za=0,this.i=[],this.j=new Br,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Xr("failFast",!1,o),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Xr("baseRetryDelayMs",5e3,o),this.Za=Xr("retryDelaySeedMs",1e4,o),this.Ta=Xr("forwardChannelMaxRetries",2,o),this.va=Xr("forwardChannelRequestTimeoutMs",2e4,o),this.ma=o&&o.xmlHttpFactory||void 0,this.Ua=o&&o.Rb||void 0,this.Aa=o&&o.useFetchStreams||!1,this.O=void 0,this.L=o&&o.supportsCrossDomainXhr||!1,this.M="",this.h=new Tu(o&&o.concurrentRequestLimit),this.Ba=new wm,this.S=o&&o.fastHandshake||!1,this.R=o&&o.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=o&&o.Pb||!1,o&&o.ua&&this.j.ua(),o&&o.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&o&&o.detectBufferingProxy||!1,this.ia=void 0,o&&o.longPollingTimeout&&o.longPollingTimeout>0&&(this.ia=o.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Uu.prototype,n.ka=8,n.I=1,n.connect=function(o,u,f,p){Le(0),this.W=o,this.H=u||{},f&&p!==void 0&&(this.H.OSID=f,this.H.OAID=p),this.F=this.X,this.J=Ku(this,null,this.W),Ks(this)};function jo(o){if(Bu(o),o.I==3){var u=o.V++,f=ot(o.J);if(re(f,"SID",o.M),re(f,"RID",u),re(f,"TYPE","terminate"),Jr(o,f),u=new Ft(o,o.j,u),u.M=2,u.A=zs(ot(f)),f=!1,a.navigator&&a.navigator.sendBeacon)try{f=a.navigator.sendBeacon(u.A.toString(),"")}catch{}!f&&a.Image&&(new Image().src=u.A,f=!0),f||(u.g=Qu(u.j,null),u.g.ea(u.A)),u.F=Date.now(),qs(u)}Wu(o)}function Ws(o){o.g&&(qo(o),o.g.cancel(),o.g=null)}function Bu(o){Ws(o),o.v&&(a.clearTimeout(o.v),o.v=null),Qs(o),o.h.cancel(),o.m&&(typeof o.m=="number"&&a.clearTimeout(o.m),o.m=null)}function Ks(o){if(!Iu(o.h)&&!o.m){o.m=!0;var u=o.Ea;X||_(),Y||(X(),Y=!0),I.add(u,o),o.D=0}}function Sm(o,u){return wu(o.h)>=o.h.j-(o.m?1:0)?!1:o.m?(o.i=u.G.concat(o.i),!0):o.I==1||o.I==2||o.D>=(o.Sa?0:o.Ta)?!1:(o.m=Ur(h(o.Ea,o,u),Gu(o,o.D)),o.D++,!0)}n.Ea=function(o){if(this.m)if(this.m=null,this.I==1){if(!o){this.V=Math.floor(Math.random()*1e5),o=this.V++;const b=new Ft(this,this.j,o);let R=this.o;if(this.U&&(R?(R=Yc(R),eu(R,this.U)):R=this.U),this.u!==null||this.R||(b.J=R,R=null),this.S)e:{for(var u=0,f=0;f<this.i.length;f++){t:{var p=this.i[f];if("__data__"in p.map&&(p=p.map.__data__,typeof p=="string")){p=p.length;break t}p=void 0}if(p===void 0)break;if(u+=p,u>4096){u=f;break e}if(u===4096||f===this.i.length-1){u=f+1;break e}}u=1e3}else u=1e3;u=$u(this,b,u),f=ot(this.J),re(f,"RID",o),re(f,"CVER",22),this.G&&re(f,"X-HTTP-Session-Id",this.G),Jr(this,f),R&&(this.R?u="headers="+jr(Ou(R))+"&"+u:this.u&&Bo(f,this.u,R)),xo(this.h,b),this.Ra&&re(f,"TYPE","init"),this.S?(re(f,"$req",u),re(f,"SID","null"),b.U=!0,Vo(b,f,null)):Vo(b,f,u),this.I=2}}else this.I==3&&(o?ju(this,o):this.i.length==0||Iu(this.h)||ju(this))};function ju(o,u){var f;u?f=u.l:f=o.V++;const p=ot(o.J);re(p,"SID",o.M),re(p,"RID",f),re(p,"AID",o.K),Jr(o,p),o.u&&o.o&&Bo(p,o.u,o.o),f=new Ft(o,o.j,f,o.D+1),o.u===null&&(f.J=o.o),u&&(o.i=u.G.concat(o.i)),u=$u(o,f,1e3),f.H=Math.round(o.va*.5)+Math.round(o.va*.5*Math.random()),xo(o.h,f),Vo(f,p,u)}function Jr(o,u){o.H&&Fs(o.H,function(f,p){re(u,p,f)}),o.l&&Fs({},function(f,p){re(u,p,f)})}function $u(o,u,f){f=Math.min(o.i.length,f);const p=o.l?h(o.l.Ka,o.l,o):null;e:{var b=o.i;let z=-1;for(;;){const me=["count="+f];z==-1?f>0?(z=b[0].g,me.push("ofs="+z)):z=0:me.push("ofs="+z);let ne=!0;for(let Ee=0;Ee<f;Ee++){var R=b[Ee].g;const at=b[Ee].map;if(R-=z,R<0)z=Math.max(0,b[Ee].g-100),ne=!1;else try{R="req"+R+"_"||"";try{var D=at instanceof Map?at:Object.entries(at);for(const[vn,$t]of D){let qt=$t;c($t)&&(qt=Po($t)),me.push(R+vn+"="+encodeURIComponent(qt))}}catch(vn){throw me.push(R+"type="+encodeURIComponent("_badmap")),vn}}catch{p&&p(at)}}if(ne){D=me.join("&");break e}}D=void 0}return o=o.i.splice(0,f),u.G=o,D}function qu(o){if(!o.g&&!o.v){o.Y=1;var u=o.Da;X||_(),Y||(X(),Y=!0),I.add(u,o),o.A=0}}function $o(o){return o.g||o.v||o.A>=3?!1:(o.Y++,o.v=Ur(h(o.Da,o),Gu(o,o.A)),o.A++,!0)}n.Da=function(){if(this.v=null,zu(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var o=4*this.T;this.j.info("BP detection timer enabled: "+o),this.B=Ur(h(this.Wa,this),o)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Le(10),Ws(this),zu(this))};function qo(o){o.B!=null&&(a.clearTimeout(o.B),o.B=null)}function zu(o){o.g=new Ft(o,o.j,"rpc",o.Y),o.u===null&&(o.g.J=o.o),o.g.P=0;var u=ot(o.na);re(u,"RID","rpc"),re(u,"SID",o.M),re(u,"AID",o.K),re(u,"CI",o.F?"0":"1"),!o.F&&o.ia&&re(u,"TO",o.ia),re(u,"TYPE","xmlhttp"),Jr(o,u),o.u&&o.o&&Bo(u,o.u,o.o),o.O&&(o.g.H=o.O);var f=o.g;o=o.ba,f.M=1,f.A=zs(ot(u)),f.u=null,f.R=!0,yu(f,o)}n.Va=function(){this.C!=null&&(this.C=null,Ws(this),$o(this),Le(19))};function Qs(o){o.C!=null&&(a.clearTimeout(o.C),o.C=null)}function Hu(o,u){var f=null;if(o.g==u){Qs(o),qo(o),o.g=null;var p=2}else if(Lo(o.h,u))f=u.G,Au(o.h,u),p=1;else return;if(o.I!=0){if(u.o)if(p==1){f=u.u?u.u.length:0,u=Date.now()-u.F;var b=o.D;p=js(),Me(p,new du(p,f)),Ks(o)}else qu(o);else if(b=u.m,b==3||b==0&&u.X>0||!(p==1&&Sm(o,u)||p==2&&$o(o)))switch(f&&f.length>0&&(u=o.h,u.i=u.i.concat(f)),b){case 1:yn(o,5);break;case 4:yn(o,10);break;case 3:yn(o,6);break;default:yn(o,2)}}}function Gu(o,u){let f=o.Qa+Math.floor(Math.random()*o.Za);return o.isActive()||(f*=2),f*u}function yn(o,u){if(o.j.info("Error code "+u),u==2){var f=h(o.bb,o),p=o.Ua;const b=!p;p=new Ut(p||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||qr(p,"https"),zs(p),b?Tm(p.toString(),f):Im(p.toString(),f)}else Le(2);o.I=0,o.l&&o.l.pa(u),Wu(o),Bu(o)}n.bb=function(o){o?(this.j.info("Successfully pinged google.com"),Le(2)):(this.j.info("Failed to ping google.com"),Le(1))};function Wu(o){if(o.I=0,o.ja=[],o.l){const u=bu(o.h);(u.length!=0||o.i.length!=0)&&(S(o.ja,u),S(o.ja,o.i),o.h.i.length=0,T(o.i),o.i.length=0),o.l.oa()}}function Ku(o,u,f){var p=f instanceof Ut?ot(f):new Ut(f);if(p.g!="")u&&(p.g=u+"."+p.g),zr(p,p.u);else{var b=a.location;p=b.protocol,u=u?u+"."+b.hostname:b.hostname,b=+b.port;const R=new Ut(null);p&&qr(R,p),u&&(R.g=u),b&&zr(R,b),f&&(R.h=f),p=R}return f=o.G,u=o.wa,f&&u&&re(p,f,u),re(p,"VER",o.ka),Jr(o,p),p}function Qu(o,u,f){if(u&&!o.L)throw Error("Can't create secondary domain capable XhrIo object.");return u=o.Aa&&!o.ma?new le(new Uo({ab:f})):new le(o.ma),u.Fa(o.L),u}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Xu(){}n=Xu.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Xs(){}Xs.prototype.g=function(o,u){return new Ge(o,u)};function Ge(o,u){Pe.call(this),this.g=new Uu(u),this.l=o,this.h=u&&u.messageUrlParams||null,o=u&&u.messageHeaders||null,u&&u.clientProtocolHeaderRequired&&(o?o["X-Client-Protocol"]="webchannel":o={"X-Client-Protocol":"webchannel"}),this.g.o=o,o=u&&u.initMessageHeaders||null,u&&u.messageContentType&&(o?o["X-WebChannel-Content-Type"]=u.messageContentType:o={"X-WebChannel-Content-Type":u.messageContentType}),u&&u.sa&&(o?o["X-WebChannel-Client-Profile"]=u.sa:o={"X-WebChannel-Client-Profile":u.sa}),this.g.U=o,(o=u&&u.Qb)&&!y(o)&&(this.g.u=o),this.A=u&&u.supportsCrossDomainXhr||!1,this.v=u&&u.sendRawJson||!1,(u=u&&u.httpSessionIdParam)&&!y(u)&&(this.g.G=u,o=this.h,o!==null&&u in o&&(o=this.h,u in o&&delete o[u])),this.j=new Hn(this)}m(Ge,Pe),Ge.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Ge.prototype.close=function(){jo(this.g)},Ge.prototype.o=function(o){var u=this.g;if(typeof o=="string"){var f={};f.__data__=o,o=f}else this.v&&(f={},f.__data__=Po(o),o=f);u.i.push(new dm(u.Ya++,o)),u.I==3&&Ks(u)},Ge.prototype.N=function(){this.g.l=null,delete this.j,jo(this.g),delete this.g,Ge.Z.N.call(this)};function Ju(o){Co.call(this),o.__headers__&&(this.headers=o.__headers__,this.statusCode=o.__status__,delete o.__headers__,delete o.__status__);var u=o.__sm__;if(u){e:{for(const f in u){o=f;break e}o=void 0}(this.i=o)&&(o=this.i,u=u!==null&&o in u?u[o]:void 0),this.data=u}else this.data=o}m(Ju,Co);function Yu(){ko.call(this),this.status=1}m(Yu,ko);function Hn(o){this.g=o}m(Hn,Xu),Hn.prototype.ra=function(){Me(this.g,"a")},Hn.prototype.qa=function(o){Me(this.g,new Ju(o))},Hn.prototype.pa=function(o){Me(this.g,new Yu)},Hn.prototype.oa=function(){Me(this.g,"b")},Xs.prototype.createWebChannel=Xs.prototype.g,Ge.prototype.send=Ge.prototype.o,Ge.prototype.open=Ge.prototype.m,Ge.prototype.close=Ge.prototype.close,Kf=function(){return new Xs},Wf=function(){return js()},Gf=mn,va={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},$s.NO_ERROR=0,$s.TIMEOUT=8,$s.HTTP_ERROR=6,ci=$s,pu.COMPLETE="complete",Hf=pu,uu.EventType=xr,xr.OPEN="a",xr.CLOSE="b",xr.ERROR="c",xr.MESSAGE="d",Pe.prototype.listen=Pe.prototype.J,Zr=uu,le.prototype.listenOnce=le.prototype.K,le.prototype.getLastError=le.prototype.Ha,le.prototype.getLastErrorCode=le.prototype.ya,le.prototype.getStatus=le.prototype.ca,le.prototype.getResponseJson=le.prototype.La,le.prototype.getResponseText=le.prototype.la,le.prototype.send=le.prototype.ea,le.prototype.setWithCredentials=le.prototype.Fa,zf=le}).apply(typeof ei<"u"?ei:typeof self<"u"?self:typeof window<"u"?window:{});const wl="@firebase/firestore",Al="4.9.2";class Ne{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Ne.UNAUTHENTICATED=new Ne(null),Ne.GOOGLE_CREDENTIALS=new Ne("google-credentials-uid"),Ne.FIRST_PARTY=new Ne("first-party-uid"),Ne.MOCK_USER=new Ne("mock-user");let Nr="12.3.0";const On=new nc("@firebase/firestore");function Kn(){return On.logLevel}function O(n,...e){if(On.logLevel<=H.DEBUG){const t=e.map(ic);On.debug(`Firestore (${Nr}): ${n}`,...t)}}function Dt(n,...e){if(On.logLevel<=H.ERROR){const t=e.map(ic);On.error(`Firestore (${Nr}): ${n}`,...t)}}function mr(n,...e){if(On.logLevel<=H.WARN){const t=e.map(ic);On.warn(`Firestore (${Nr}): ${n}`,...t)}}function ic(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function U(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,Qf(n,r,t)}function Qf(n,e,t){let r=`FIRESTORE (${Nr}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw Dt(r),new Error(r)}function ee(n,e,t,r){let s="Unexpected state";typeof t=="string"?s=t:r=t,n||Qf(e,s,r)}function $(n,e){return n}const N={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class L extends At{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Sn{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class Xf{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class $y{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Ne.UNAUTHENTICATED)))}shutdown(){}}class qy{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class zy{constructor(e){this.t=e,this.currentUser=Ne.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){ee(this.o===void 0,42304);let r=this.i;const s=l=>this.i!==r?(r=this.i,t(l)):Promise.resolve();let i=new Sn;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Sn,e.enqueueRetryable((()=>s(this.currentUser)))};const a=()=>{const l=i;e.enqueueRetryable((async()=>{await l.promise,await s(this.currentUser)}))},c=l=>{O("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit((l=>c(l))),setTimeout((()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?c(l):(O("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Sn)}}),0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((r=>this.i!==e?(O("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ee(typeof r.accessToken=="string",31837,{l:r}),new Xf(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ee(e===null||typeof e=="string",2055,{h:e}),new Ne(e)}}class Hy{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=Ne.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class Gy{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new Hy(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(Ne.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class bl{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Wy{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Ye(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){ee(this.o===void 0,3512);const r=i=>{i.error!=null&&O("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const a=i.token!==this.m;return this.m=i.token,O("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable((()=>r(i)))};const s=i=>{O("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((i=>s(i))),setTimeout((()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):O("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new bl(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(ee(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new bl(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function Ky(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}class oc{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=Ky(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<t&&(r+=e.charAt(s[i]%62))}return r}}function G(n,e){return n<e?-1:n>e?1:0}function Ea(n,e){const t=Math.min(n.length,e.length);for(let r=0;r<t;r++){const s=n.charAt(r),i=e.charAt(r);if(s!==i)return Zo(s)===Zo(i)?G(s,i):Zo(s)?1:-1}return G(n.length,e.length)}const Qy=55296,Xy=57343;function Zo(n){const e=n.charCodeAt(0);return e>=Qy&&e<=Xy}function gr(n,e,t){return n.length===e.length&&n.every(((r,s)=>t(r,e[s])))}const Rl="__name__";class ut{constructor(e,t,r){t===void 0?t=0:t>e.length&&U(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&U(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return ut.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof ut?e.forEach((r=>{t.push(r)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let s=0;s<r;s++){const i=ut.compareSegments(e.get(s),t.get(s));if(i!==0)return i}return G(e.length,t.length)}static compareSegments(e,t){const r=ut.isNumericId(e),s=ut.isNumericId(t);return r&&!s?-1:!r&&s?1:r&&s?ut.extractNumericId(e).compare(ut.extractNumericId(t)):Ea(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return tn.fromString(e.substring(4,e.length-2))}}class ie extends ut{construct(e,t,r){return new ie(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new L(N.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter((s=>s.length>0)))}return new ie(t)}static emptyPath(){return new ie([])}}const Jy=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ae extends ut{construct(e,t,r){return new Ae(e,t,r)}static isValidIdentifier(e){return Jy.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ae.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Rl}static keyField(){return new Ae([Rl])}static fromServerFormat(e){const t=[];let r="",s=0;const i=()=>{if(r.length===0)throw new L(N.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let a=!1;for(;s<e.length;){const c=e[s];if(c==="\\"){if(s+1===e.length)throw new L(N.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new L(N.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,s+=2}else c==="`"?(a=!a,s++):c!=="."||a?(r+=c,s++):(i(),s++)}if(i(),a)throw new L(N.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ae(t)}static emptyPath(){return new Ae([])}}class F{constructor(e){this.path=e}static fromPath(e){return new F(ie.fromString(e))}static fromName(e){return new F(ie.fromString(e).popFirst(5))}static empty(){return new F(ie.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ie.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return ie.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new F(new ie(e.slice()))}}function Jf(n,e,t){if(!t)throw new L(N.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function Yy(n,e,t,r){if(e===!0&&r===!0)throw new L(N.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function Sl(n){if(!F.isDocumentKey(n))throw new L(N.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function Pl(n){if(F.isDocumentKey(n))throw new L(N.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Yf(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function ac(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":U(12329,{type:typeof n})}function nn(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new L(N.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=ac(n);throw new L(N.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function de(n,e){const t={typeString:n};return e&&(t.value=e),t}function Cs(n,e){if(!Yf(n))throw new L(N.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const s=e[r].typeString,i="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}const a=n[r];if(s&&typeof a!==s){t=`JSON field '${r}' must be a ${s}.`;break}if(i!==void 0&&a!==i.value){t=`Expected '${r}' field to equal '${i.value}'`;break}}if(t)throw new L(N.INVALID_ARGUMENT,t);return!0}const Cl=-62135596800,kl=1e6;class oe{static now(){return oe.fromMillis(Date.now())}static fromDate(e){return oe.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*kl);return new oe(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new L(N.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new L(N.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<Cl)throw new L(N.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new L(N.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/kl}_compareTo(e){return this.seconds===e.seconds?G(this.nanoseconds,e.nanoseconds):G(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:oe._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Cs(e,oe._jsonSchema))return new oe(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Cl;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}oe._jsonSchemaVersion="firestore/timestamp/1.0",oe._jsonSchema={type:de("string",oe._jsonSchemaVersion),seconds:de("number"),nanoseconds:de("number")};class j{static fromTimestamp(e){return new j(e)}static min(){return new j(new oe(0,0))}static max(){return new j(new oe(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const ys=-1;function Zy(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,s=j.fromTimestamp(r===1e9?new oe(t+1,0):new oe(t,r));return new on(s,F.empty(),e)}function ev(n){return new on(n.readTime,n.key,ys)}class on{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new on(j.min(),F.empty(),ys)}static max(){return new on(j.max(),F.empty(),ys)}}function tv(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=F.comparator(n.documentKey,e.documentKey),t!==0?t:G(n.largestBatchId,e.largestBatchId))}const nv="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class rv{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Dr(n){if(n.code!==N.FAILED_PRECONDITION||n.message!==nv)throw n;O("LocalStore","Unexpectedly lost primary lease")}class C{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&U(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new C(((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(t,i).next(r,s)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof C?t:C.resolve(t)}catch(t){return C.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):C.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):C.reject(t)}static resolve(e){return new C(((t,r)=>{t(e)}))}static reject(e){return new C(((t,r)=>{r(e)}))}static waitFor(e){return new C(((t,r)=>{let s=0,i=0,a=!1;e.forEach((c=>{++s,c.next((()=>{++i,a&&i===s&&t()}),(l=>r(l)))})),a=!0,i===s&&t()}))}static or(e){let t=C.resolve(!1);for(const r of e)t=t.next((s=>s?C.resolve(s):r()));return t}static forEach(e,t){const r=[];return e.forEach(((s,i)=>{r.push(t.call(this,s,i))})),this.waitFor(r)}static mapArray(e,t){return new C(((r,s)=>{const i=e.length,a=new Array(i);let c=0;for(let l=0;l<i;l++){const h=l;t(e[h]).next((d=>{a[h]=d,++c,c===i&&r(a)}),(d=>s(d)))}}))}static doWhile(e,t){return new C(((r,s)=>{const i=()=>{e()===!0?t().next((()=>{i()}),s):r()};i()}))}}function sv(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Vr(n){return n.name==="IndexedDbTransactionError"}class eo{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>t.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}eo.ce=-1;const cc=-1;function to(n){return n==null}function Ai(n){return n===0&&1/n==-1/0}function iv(n){return typeof n=="number"&&Number.isInteger(n)&&!Ai(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const Zf="";function ov(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=Nl(e)),e=av(n.get(t),e);return Nl(e)}function av(n,e){let t=e;const r=n.length;for(let s=0;s<r;s++){const i=n.charAt(s);switch(i){case"\0":t+="";break;case Zf:t+="";break;default:t+=i}}return t}function Nl(n){return n+Zf+""}function Dl(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function dn(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function ed(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class ue{constructor(e,t){this.comparator=e,this.root=t||Ie.EMPTY}insert(e,t){return new ue(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Ie.BLACK,null,null))}remove(e){return new ue(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ie.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return t+r.left.size;s<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,r)=>(e(t,r),!1)))}toString(){const e=[];return this.inorderTraversal(((t,r)=>(e.push(`${t}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ti(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ti(this.root,e,this.comparator,!1)}getReverseIterator(){return new ti(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ti(this.root,e,this.comparator,!0)}}class ti{constructor(e,t,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?r(e.key,t):1,t&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ie{constructor(e,t,r,s,i){this.key=e,this.value=t,this.color=r??Ie.RED,this.left=s??Ie.EMPTY,this.right=i??Ie.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,s,i){return new Ie(e??this.key,t??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,t,r),null):i===0?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Ie.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),t(e,s.key)===0){if(s.right.isEmpty())return Ie.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ie.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ie.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw U(43730,{key:this.key,value:this.value});if(this.right.isRed())throw U(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw U(27949);return e+(this.isRed()?0:1)}}Ie.EMPTY=null,Ie.RED=!0,Ie.BLACK=!1;Ie.EMPTY=new class{constructor(){this.size=0}get key(){throw U(57766)}get value(){throw U(16141)}get color(){throw U(16727)}get left(){throw U(29726)}get right(){throw U(36894)}copy(e,t,r,s,i){return this}insert(e,t,r){return new Ie(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class ve{constructor(e){this.comparator=e,this.data=new ue(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,r)=>(e(t),!1)))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Vl(this.data.getIterator())}getIteratorFrom(e){return new Vl(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((r=>{t=t.add(r)})),t}isEqual(e){if(!(e instanceof ve)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new ve(this.comparator);return t.data=e,t}}class Vl{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Qe{constructor(e){this.fields=e,e.sort(Ae.comparator)}static empty(){return new Qe([])}unionWith(e){let t=new ve(Ae.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Qe(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return gr(this.fields,e.fields,((t,r)=>t.isEqual(r)))}}class td extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Se{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new td("Invalid base64 string: "+i):i}})(e);return new Se(t)}static fromUint8Array(e){const t=(function(s){let i="";for(let a=0;a<s.length;++a)i+=String.fromCharCode(s[a]);return i})(e);return new Se(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const r=new Uint8Array(t.length);for(let s=0;s<t.length;s++)r[s]=t.charCodeAt(s);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return G(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Se.EMPTY_BYTE_STRING=new Se("");const cv=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function an(n){if(ee(!!n,39018),typeof n=="string"){let e=0;const t=cv.exec(n);if(ee(!!t,46558,{timestamp:n}),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:he(n.seconds),nanos:he(n.nanos)}}function he(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function cn(n){return typeof n=="string"?Se.fromBase64String(n):Se.fromUint8Array(n)}const nd="server_timestamp",rd="__type__",sd="__previous_value__",id="__local_write_time__";function uc(n){return(n?.mapValue?.fields||{})[rd]?.stringValue===nd}function no(n){const e=n.mapValue.fields[sd];return uc(e)?no(e):e}function vs(n){const e=an(n.mapValue.fields[id].timestampValue);return new oe(e.seconds,e.nanos)}class uv{constructor(e,t,r,s,i,a,c,l,h,d){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=a,this.autoDetectLongPolling=c,this.longPollingOptions=l,this.useFetchStreams=h,this.isUsingEmulator=d}}const bi="(default)";class Es{constructor(e,t){this.projectId=e,this.database=t||bi}static empty(){return new Es("","")}get isDefaultDatabase(){return this.database===bi}isEqual(e){return e instanceof Es&&e.projectId===this.projectId&&e.database===this.database}}const od="__type__",lv="__max__",ni={mapValue:{}},ad="__vector__",Ri="value";function un(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?uc(n)?4:fv(n)?9007199254740991:hv(n)?10:11:U(28295,{value:n})}function Et(n,e){if(n===e)return!0;const t=un(n);if(t!==un(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return vs(n).isEqual(vs(e));case 3:return(function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const a=an(s.timestampValue),c=an(i.timestampValue);return a.seconds===c.seconds&&a.nanos===c.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(s,i){return cn(s.bytesValue).isEqual(cn(i.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(s,i){return he(s.geoPointValue.latitude)===he(i.geoPointValue.latitude)&&he(s.geoPointValue.longitude)===he(i.geoPointValue.longitude)})(n,e);case 2:return(function(s,i){if("integerValue"in s&&"integerValue"in i)return he(s.integerValue)===he(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const a=he(s.doubleValue),c=he(i.doubleValue);return a===c?Ai(a)===Ai(c):isNaN(a)&&isNaN(c)}return!1})(n,e);case 9:return gr(n.arrayValue.values||[],e.arrayValue.values||[],Et);case 10:case 11:return(function(s,i){const a=s.mapValue.fields||{},c=i.mapValue.fields||{};if(Dl(a)!==Dl(c))return!1;for(const l in a)if(a.hasOwnProperty(l)&&(c[l]===void 0||!Et(a[l],c[l])))return!1;return!0})(n,e);default:return U(52216,{left:n})}}function Ts(n,e){return(n.values||[]).find((t=>Et(t,e)))!==void 0}function _r(n,e){if(n===e)return 0;const t=un(n),r=un(e);if(t!==r)return G(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return G(n.booleanValue,e.booleanValue);case 2:return(function(i,a){const c=he(i.integerValue||i.doubleValue),l=he(a.integerValue||a.doubleValue);return c<l?-1:c>l?1:c===l?0:isNaN(c)?isNaN(l)?0:-1:1})(n,e);case 3:return Ol(n.timestampValue,e.timestampValue);case 4:return Ol(vs(n),vs(e));case 5:return Ea(n.stringValue,e.stringValue);case 6:return(function(i,a){const c=cn(i),l=cn(a);return c.compareTo(l)})(n.bytesValue,e.bytesValue);case 7:return(function(i,a){const c=i.split("/"),l=a.split("/");for(let h=0;h<c.length&&h<l.length;h++){const d=G(c[h],l[h]);if(d!==0)return d}return G(c.length,l.length)})(n.referenceValue,e.referenceValue);case 8:return(function(i,a){const c=G(he(i.latitude),he(a.latitude));return c!==0?c:G(he(i.longitude),he(a.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return Ml(n.arrayValue,e.arrayValue);case 10:return(function(i,a){const c=i.fields||{},l=a.fields||{},h=c[Ri]?.arrayValue,d=l[Ri]?.arrayValue,m=G(h?.values?.length||0,d?.values?.length||0);return m!==0?m:Ml(h,d)})(n.mapValue,e.mapValue);case 11:return(function(i,a){if(i===ni.mapValue&&a===ni.mapValue)return 0;if(i===ni.mapValue)return 1;if(a===ni.mapValue)return-1;const c=i.fields||{},l=Object.keys(c),h=a.fields||{},d=Object.keys(h);l.sort(),d.sort();for(let m=0;m<l.length&&m<d.length;++m){const g=Ea(l[m],d[m]);if(g!==0)return g;const T=_r(c[l[m]],h[d[m]]);if(T!==0)return T}return G(l.length,d.length)})(n.mapValue,e.mapValue);default:throw U(23264,{he:t})}}function Ol(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return G(n,e);const t=an(n),r=an(e),s=G(t.seconds,r.seconds);return s!==0?s:G(t.nanos,r.nanos)}function Ml(n,e){const t=n.values||[],r=e.values||[];for(let s=0;s<t.length&&s<r.length;++s){const i=_r(t[s],r[s]);if(i)return i}return G(t.length,r.length)}function yr(n){return Ta(n)}function Ta(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const r=an(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return cn(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return F.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",s=!0;for(const i of t.values||[])s?s=!1:r+=",",r+=Ta(i);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){const r=Object.keys(t.fields||{}).sort();let s="{",i=!0;for(const a of r)i?i=!1:s+=",",s+=`${a}:${Ta(t.fields[a])}`;return s+"}"})(n.mapValue):U(61005,{value:n})}function ui(n){switch(un(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=no(n);return e?16+ui(e):16;case 5:return 2*n.stringValue.length;case 6:return cn(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((s,i)=>s+ui(i)),0)})(n.arrayValue);case 10:case 11:return(function(r){let s=0;return dn(r.fields,((i,a)=>{s+=i.length+ui(a)})),s})(n.mapValue);default:throw U(13486,{value:n})}}function Ia(n){return!!n&&"integerValue"in n}function lc(n){return!!n&&"arrayValue"in n}function Ll(n){return!!n&&"nullValue"in n}function xl(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function li(n){return!!n&&"mapValue"in n}function hv(n){return(n?.mapValue?.fields||{})[od]?.stringValue===ad}function cs(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return dn(n.mapValue.fields,((t,r)=>e.mapValue.fields[t]=cs(r))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=cs(n.arrayValue.values[t]);return e}return{...n}}function fv(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===lv}class je{constructor(e){this.value=e}static empty(){return new je({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!li(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=cs(t)}setAll(e){let t=Ae.emptyPath(),r={},s=[];e.forEach(((a,c)=>{if(!t.isImmediateParentOf(c)){const l=this.getFieldsMap(t);this.applyChanges(l,r,s),r={},s=[],t=c.popLast()}a?r[c.lastSegment()]=cs(a):s.push(c.lastSegment())}));const i=this.getFieldsMap(t);this.applyChanges(i,r,s)}delete(e){const t=this.field(e.popLast());li(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Et(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=t.mapValue.fields[e.get(r)];li(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,r){dn(t,((s,i)=>e[s]=i));for(const s of r)delete e[s]}clone(){return new je(cs(this.value))}}function cd(n){const e=[];return dn(n.fields,((t,r)=>{const s=new Ae([t]);if(li(r)){const i=cd(r.mapValue).fields;if(i.length===0)e.push(s);else for(const a of i)e.push(s.child(a))}else e.push(s)})),new Qe(e)}class De{constructor(e,t,r,s,i,a,c){this.key=e,this.documentType=t,this.version=r,this.readTime=s,this.createTime=i,this.data=a,this.documentState=c}static newInvalidDocument(e){return new De(e,0,j.min(),j.min(),j.min(),je.empty(),0)}static newFoundDocument(e,t,r,s){return new De(e,1,t,j.min(),r,s,0)}static newNoDocument(e,t){return new De(e,2,t,j.min(),j.min(),je.empty(),0)}static newUnknownDocument(e,t){return new De(e,3,t,j.min(),j.min(),je.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(j.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=je.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=je.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=j.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof De&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new De(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Si{constructor(e,t){this.position=e,this.inclusive=t}}function Fl(n,e,t){let r=0;for(let s=0;s<n.position.length;s++){const i=e[s],a=n.position[s];if(i.field.isKeyField()?r=F.comparator(F.fromName(a.referenceValue),t.key):r=_r(a,t.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function Ul(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Et(n.position[t],e.position[t]))return!1;return!0}class Pi{constructor(e,t="asc"){this.field=e,this.dir=t}}function dv(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class ud{}class _e extends ud{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new mv(e,t,r):t==="array-contains"?new yv(e,r):t==="in"?new vv(e,r):t==="not-in"?new Ev(e,r):t==="array-contains-any"?new Tv(e,r):new _e(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new gv(e,r):new _v(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(_r(t,this.value)):t!==null&&un(this.value)===un(t)&&this.matchesComparison(_r(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return U(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Tt extends ud{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Tt(e,t)}matches(e){return ld(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function ld(n){return n.op==="and"}function hd(n){return pv(n)&&ld(n)}function pv(n){for(const e of n.filters)if(e instanceof Tt)return!1;return!0}function wa(n){if(n instanceof _e)return n.field.canonicalString()+n.op.toString()+yr(n.value);if(hd(n))return n.filters.map((e=>wa(e))).join(",");{const e=n.filters.map((t=>wa(t))).join(",");return`${n.op}(${e})`}}function fd(n,e){return n instanceof _e?(function(r,s){return s instanceof _e&&r.op===s.op&&r.field.isEqual(s.field)&&Et(r.value,s.value)})(n,e):n instanceof Tt?(function(r,s){return s instanceof Tt&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce(((i,a,c)=>i&&fd(a,s.filters[c])),!0):!1})(n,e):void U(19439)}function dd(n){return n instanceof _e?(function(t){return`${t.field.canonicalString()} ${t.op} ${yr(t.value)}`})(n):n instanceof Tt?(function(t){return t.op.toString()+" {"+t.getFilters().map(dd).join(" ,")+"}"})(n):"Filter"}class mv extends _e{constructor(e,t,r){super(e,t,r),this.key=F.fromName(r.referenceValue)}matches(e){const t=F.comparator(e.key,this.key);return this.matchesComparison(t)}}class gv extends _e{constructor(e,t){super(e,"in",t),this.keys=pd("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class _v extends _e{constructor(e,t){super(e,"not-in",t),this.keys=pd("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function pd(n,e){return(e.arrayValue?.values||[]).map((t=>F.fromName(t.referenceValue)))}class yv extends _e{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return lc(t)&&Ts(t.arrayValue,this.value)}}class vv extends _e{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Ts(this.value.arrayValue,t)}}class Ev extends _e{constructor(e,t){super(e,"not-in",t)}matches(e){if(Ts(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Ts(this.value.arrayValue,t)}}class Tv extends _e{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!lc(t)||!t.arrayValue.values)&&t.arrayValue.values.some((r=>Ts(this.value.arrayValue,r)))}}class Iv{constructor(e,t=null,r=[],s=[],i=null,a=null,c=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=a,this.endAt=c,this.Te=null}}function Bl(n,e=null,t=[],r=[],s=null,i=null,a=null){return new Iv(n,e,t,r,s,i,a)}function hc(n){const e=$(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((r=>wa(r))).join(","),t+="|ob:",t+=e.orderBy.map((r=>(function(i){return i.field.canonicalString()+i.dir})(r))).join(","),to(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((r=>yr(r))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((r=>yr(r))).join(",")),e.Te=t}return e.Te}function fc(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!dv(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!fd(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Ul(n.startAt,e.startAt)&&Ul(n.endAt,e.endAt)}function Aa(n){return F.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}class ro{constructor(e,t=null,r=[],s=[],i=null,a="F",c=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=a,this.startAt=c,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function wv(n,e,t,r,s,i,a,c){return new ro(n,e,t,r,s,i,a,c)}function dc(n){return new ro(n)}function jl(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function Av(n){return n.collectionGroup!==null}function us(n){const e=$(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),t.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let c=new ve(Ae.comparator);return a.filters.forEach((l=>{l.getFlattenedFilters().forEach((h=>{h.isInequality()&&(c=c.add(h.field))}))})),c})(e).forEach((i=>{t.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new Pi(i,r))})),t.has(Ae.keyField().canonicalString())||e.Ie.push(new Pi(Ae.keyField(),r))}return e.Ie}function pt(n){const e=$(n);return e.Ee||(e.Ee=bv(e,us(n))),e.Ee}function bv(n,e){if(n.limitType==="F")return Bl(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((s=>{const i=s.dir==="desc"?"asc":"desc";return new Pi(s.field,i)}));const t=n.endAt?new Si(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Si(n.startAt.position,n.startAt.inclusive):null;return Bl(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function ba(n,e,t){return new ro(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function so(n,e){return fc(pt(n),pt(e))&&n.limitType===e.limitType}function md(n){return`${hc(pt(n))}|lt:${n.limitType}`}function Qn(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map((s=>dd(s))).join(", ")}]`),to(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map((s=>(function(a){return`${a.field.canonicalString()} (${a.dir})`})(s))).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map((s=>yr(s))).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map((s=>yr(s))).join(",")),`Target(${r})`})(pt(n))}; limitType=${n.limitType})`}function io(n,e){return e.isFoundDocument()&&(function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):F.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)})(n,e)&&(function(r,s){for(const i of us(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0})(n,e)&&(function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0})(n,e)&&(function(r,s){return!(r.startAt&&!(function(a,c,l){const h=Fl(a,c,l);return a.inclusive?h<=0:h<0})(r.startAt,us(r),s)||r.endAt&&!(function(a,c,l){const h=Fl(a,c,l);return a.inclusive?h>=0:h>0})(r.endAt,us(r),s))})(n,e)}function Rv(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function gd(n){return(e,t)=>{let r=!1;for(const s of us(n)){const i=Sv(s,e,t);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function Sv(n,e,t){const r=n.field.isKeyField()?F.comparator(e.key,t.key):(function(i,a,c){const l=a.data.field(i),h=c.data.field(i);return l!==null&&h!==null?_r(l,h):U(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return U(19790,{direction:n.dir})}}class jn{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[t]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){dn(this.inner,((t,r)=>{for(const[s,i]of r)e(s,i)}))}isEmpty(){return ed(this.inner)}size(){return this.innerSize}}const Pv=new ue(F.comparator);function Vt(){return Pv}const _d=new ue(F.comparator);function es(...n){let e=_d;for(const t of n)e=e.insert(t.key,t);return e}function yd(n){let e=_d;return n.forEach(((t,r)=>e=e.insert(t,r.overlayedDocument))),e}function In(){return ls()}function vd(){return ls()}function ls(){return new jn((n=>n.toString()),((n,e)=>n.isEqual(e)))}const Cv=new ue(F.comparator),kv=new ve(F.comparator);function W(...n){let e=kv;for(const t of n)e=e.add(t);return e}const Nv=new ve(G);function Dv(){return Nv}function pc(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ai(e)?"-0":e}}function Ed(n){return{integerValue:""+n}}function Vv(n,e){return iv(e)?Ed(e):pc(n,e)}class oo{constructor(){this._=void 0}}function Ov(n,e,t){return n instanceof Ci?(function(s,i){const a={fields:{[rd]:{stringValue:nd},[id]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&uc(i)&&(i=no(i)),i&&(a.fields[sd]=i),{mapValue:a}})(t,e):n instanceof Is?Id(n,e):n instanceof ws?wd(n,e):(function(s,i){const a=Td(s,i),c=$l(a)+$l(s.Ae);return Ia(a)&&Ia(s.Ae)?Ed(c):pc(s.serializer,c)})(n,e)}function Mv(n,e,t){return n instanceof Is?Id(n,e):n instanceof ws?wd(n,e):t}function Td(n,e){return n instanceof ki?(function(r){return Ia(r)||(function(i){return!!i&&"doubleValue"in i})(r)})(e)?e:{integerValue:0}:null}class Ci extends oo{}class Is extends oo{constructor(e){super(),this.elements=e}}function Id(n,e){const t=Ad(e);for(const r of n.elements)t.some((s=>Et(s,r)))||t.push(r);return{arrayValue:{values:t}}}class ws extends oo{constructor(e){super(),this.elements=e}}function wd(n,e){let t=Ad(e);for(const r of n.elements)t=t.filter((s=>!Et(s,r)));return{arrayValue:{values:t}}}class ki extends oo{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function $l(n){return he(n.integerValue||n.doubleValue)}function Ad(n){return lc(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function Lv(n,e){return n.field.isEqual(e.field)&&(function(r,s){return r instanceof Is&&s instanceof Is||r instanceof ws&&s instanceof ws?gr(r.elements,s.elements,Et):r instanceof ki&&s instanceof ki?Et(r.Ae,s.Ae):r instanceof Ci&&s instanceof Ci})(n.transform,e.transform)}class xv{constructor(e,t){this.version=e,this.transformResults=t}}class rt{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new rt}static exists(e){return new rt(void 0,e)}static updateTime(e){return new rt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function hi(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class ao{}function bd(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new mc(n.key,rt.none()):new ks(n.key,n.data,rt.none());{const t=n.data,r=je.empty();let s=new ve(Ae.comparator);for(let i of e.fields)if(!s.has(i)){let a=t.field(i);a===null&&i.length>1&&(i=i.popLast(),a=t.field(i)),a===null?r.delete(i):r.set(i,a),s=s.add(i)}return new pn(n.key,r,new Qe(s.toArray()),rt.none())}}function Fv(n,e,t){n instanceof ks?(function(s,i,a){const c=s.value.clone(),l=zl(s.fieldTransforms,i,a.transformResults);c.setAll(l),i.convertToFoundDocument(a.version,c).setHasCommittedMutations()})(n,e,t):n instanceof pn?(function(s,i,a){if(!hi(s.precondition,i))return void i.convertToUnknownDocument(a.version);const c=zl(s.fieldTransforms,i,a.transformResults),l=i.data;l.setAll(Rd(s)),l.setAll(c),i.convertToFoundDocument(a.version,l).setHasCommittedMutations()})(n,e,t):(function(s,i,a){i.convertToNoDocument(a.version).setHasCommittedMutations()})(0,e,t)}function hs(n,e,t,r){return n instanceof ks?(function(i,a,c,l){if(!hi(i.precondition,a))return c;const h=i.value.clone(),d=Hl(i.fieldTransforms,l,a);return h.setAll(d),a.convertToFoundDocument(a.version,h).setHasLocalMutations(),null})(n,e,t,r):n instanceof pn?(function(i,a,c,l){if(!hi(i.precondition,a))return c;const h=Hl(i.fieldTransforms,l,a),d=a.data;return d.setAll(Rd(i)),d.setAll(h),a.convertToFoundDocument(a.version,d).setHasLocalMutations(),c===null?null:c.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map((m=>m.field)))})(n,e,t,r):(function(i,a,c){return hi(i.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):c})(n,e,t)}function Uv(n,e){let t=null;for(const r of n.fieldTransforms){const s=e.data.field(r.field),i=Td(r.transform,s||null);i!=null&&(t===null&&(t=je.empty()),t.set(r.field,i))}return t||null}function ql(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&gr(r,s,((i,a)=>Lv(i,a)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class ks extends ao{constructor(e,t,r,s=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class pn extends ao{constructor(e,t,r,s,i=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Rd(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}})),e}function zl(n,e,t){const r=new Map;ee(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let s=0;s<t.length;s++){const i=n[s],a=i.transform,c=e.data.field(i.field);r.set(i.field,Mv(a,c,t[s]))}return r}function Hl(n,e,t){const r=new Map;for(const s of n){const i=s.transform,a=t.data.field(s.field);r.set(s.field,Ov(i,a,e))}return r}class mc extends ao{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Bv extends ao{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class jv{constructor(e,t,r,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&Fv(i,e,r[s])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=hs(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=hs(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=vd();return this.mutations.forEach((s=>{const i=e.get(s.key),a=i.overlayedDocument;let c=this.applyToLocalView(a,i.mutatedFields);c=t.has(s.key)?null:c;const l=bd(a,c);l!==null&&r.set(s.key,l),a.isValidDocument()||a.convertToNoDocument(j.min())})),r}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),W())}isEqual(e){return this.batchId===e.batchId&&gr(this.mutations,e.mutations,((t,r)=>ql(t,r)))&&gr(this.baseMutations,e.baseMutations,((t,r)=>ql(t,r)))}}class gc{constructor(e,t,r,s){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=s}static from(e,t,r){ee(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let s=(function(){return Cv})();const i=e.mutations;for(let a=0;a<i.length;a++)s=s.insert(i[a].key,r[a].version);return new gc(e,t,r,s)}}class $v{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class qv{constructor(e,t){this.count=e,this.unchangedNames=t}}var fe,Q;function zv(n){switch(n){case N.OK:return U(64938);case N.CANCELLED:case N.UNKNOWN:case N.DEADLINE_EXCEEDED:case N.RESOURCE_EXHAUSTED:case N.INTERNAL:case N.UNAVAILABLE:case N.UNAUTHENTICATED:return!1;case N.INVALID_ARGUMENT:case N.NOT_FOUND:case N.ALREADY_EXISTS:case N.PERMISSION_DENIED:case N.FAILED_PRECONDITION:case N.ABORTED:case N.OUT_OF_RANGE:case N.UNIMPLEMENTED:case N.DATA_LOSS:return!0;default:return U(15467,{code:n})}}function Sd(n){if(n===void 0)return Dt("GRPC error has no .code"),N.UNKNOWN;switch(n){case fe.OK:return N.OK;case fe.CANCELLED:return N.CANCELLED;case fe.UNKNOWN:return N.UNKNOWN;case fe.DEADLINE_EXCEEDED:return N.DEADLINE_EXCEEDED;case fe.RESOURCE_EXHAUSTED:return N.RESOURCE_EXHAUSTED;case fe.INTERNAL:return N.INTERNAL;case fe.UNAVAILABLE:return N.UNAVAILABLE;case fe.UNAUTHENTICATED:return N.UNAUTHENTICATED;case fe.INVALID_ARGUMENT:return N.INVALID_ARGUMENT;case fe.NOT_FOUND:return N.NOT_FOUND;case fe.ALREADY_EXISTS:return N.ALREADY_EXISTS;case fe.PERMISSION_DENIED:return N.PERMISSION_DENIED;case fe.FAILED_PRECONDITION:return N.FAILED_PRECONDITION;case fe.ABORTED:return N.ABORTED;case fe.OUT_OF_RANGE:return N.OUT_OF_RANGE;case fe.UNIMPLEMENTED:return N.UNIMPLEMENTED;case fe.DATA_LOSS:return N.DATA_LOSS;default:return U(39323,{code:n})}}(Q=fe||(fe={}))[Q.OK=0]="OK",Q[Q.CANCELLED=1]="CANCELLED",Q[Q.UNKNOWN=2]="UNKNOWN",Q[Q.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Q[Q.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Q[Q.NOT_FOUND=5]="NOT_FOUND",Q[Q.ALREADY_EXISTS=6]="ALREADY_EXISTS",Q[Q.PERMISSION_DENIED=7]="PERMISSION_DENIED",Q[Q.UNAUTHENTICATED=16]="UNAUTHENTICATED",Q[Q.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Q[Q.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Q[Q.ABORTED=10]="ABORTED",Q[Q.OUT_OF_RANGE=11]="OUT_OF_RANGE",Q[Q.UNIMPLEMENTED=12]="UNIMPLEMENTED",Q[Q.INTERNAL=13]="INTERNAL",Q[Q.UNAVAILABLE=14]="UNAVAILABLE",Q[Q.DATA_LOSS=15]="DATA_LOSS";function Hv(){return new TextEncoder}const Gv=new tn([4294967295,4294967295],0);function Gl(n){const e=Hv().encode(n),t=new qf;return t.update(e),new Uint8Array(t.digest())}function Wl(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new tn([t,r],0),new tn([s,i],0)]}class _c{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new ts(`Invalid padding: ${t}`);if(r<0)throw new ts(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new ts(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new ts(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=tn.fromNumber(this.ge)}ye(e,t,r){let s=e.add(t.multiply(tn.fromNumber(r)));return s.compare(Gv)===1&&(s=new tn([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=Gl(e),[r,s]=Wl(t);for(let i=0;i<this.hashCount;i++){const a=this.ye(r,s,i);if(!this.we(a))return!1}return!0}static create(e,t,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),a=new _c(i,s,t);return r.forEach((c=>a.insert(c))),a}insert(e){if(this.ge===0)return;const t=Gl(e),[r,s]=Wl(t);for(let i=0;i<this.hashCount;i++){const a=this.ye(r,s,i);this.Se(a)}}Se(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class ts extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class co{constructor(e,t,r,s,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const s=new Map;return s.set(e,Ns.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new co(j.min(),s,new ue(G),Vt(),W())}}class Ns{constructor(e,t,r,s,i){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new Ns(r,t,W(),W(),W())}}class fi{constructor(e,t,r,s){this.be=e,this.removedTargetIds=t,this.key=r,this.De=s}}class Pd{constructor(e,t){this.targetId=e,this.Ce=t}}class Cd{constructor(e,t,r=Se.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=s}}class Kl{constructor(){this.ve=0,this.Fe=Ql(),this.Me=Se.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=W(),t=W(),r=W();return this.Fe.forEach(((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:r=r.add(s);break;default:U(38017,{changeType:i})}})),new Ns(this.Me,this.xe,e,t,r)}qe(){this.Oe=!1,this.Fe=Ql()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,ee(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class Wv{constructor(e){this.Ge=e,this.ze=new Map,this.je=Vt(),this.Je=ri(),this.He=ri(),this.Ye=new ue(G)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:U(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((r,s)=>{this.rt(s)&&t(s)}))}st(e){const t=e.targetId,r=e.Ce.count,s=this.ot(t);if(s){const i=s.target;if(Aa(i))if(r===0){const a=new F(i.path);this.et(t,a,De.newNoDocument(a,j.min()))}else ee(r===1,20013,{expectedCount:r});else{const a=this._t(t);if(a!==r){const c=this.ut(e),l=c?this.ct(c,e,a):1;if(l!==0){this.it(t);const h=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,h)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=t;let a,c;try{a=cn(r).toUint8Array()}catch(l){if(l instanceof td)return mr("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{c=new _c(a,s,i)}catch(l){return mr(l instanceof ts?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return c.ge===0?null:c}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){const r=this.Ge.getRemoteKeysForTarget(t);let s=0;return r.forEach((i=>{const a=this.Ge.ht(),c=`projects/${a.projectId}/databases/${a.database}/documents/${i.path.canonicalString()}`;e.mightContain(c)||(this.et(t,i,null),s++)})),s}Tt(e){const t=new Map;this.ze.forEach(((i,a)=>{const c=this.ot(a);if(c){if(i.current&&Aa(c.target)){const l=new F(c.target.path);this.It(l).has(a)||this.Et(a,l)||this.et(a,l,De.newNoDocument(l,e))}i.Be&&(t.set(a,i.ke()),i.qe())}}));let r=W();this.He.forEach(((i,a)=>{let c=!0;a.forEachWhile((l=>{const h=this.ot(l);return!h||h.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)})),c&&(r=r.add(i))})),this.je.forEach(((i,a)=>a.setReadTime(e)));const s=new co(e,t,this.Ye,this.je,r);return this.je=Vt(),this.Je=ri(),this.He=ri(),this.Ye=new ue(G),s}Xe(e,t){if(!this.rt(e))return;const r=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,r),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,t)?s.Qe(t,1):s.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new Kl,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new ve(G),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new ve(G),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||O("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Kl),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function ri(){return new ue(F.comparator)}function Ql(){return new ue(F.comparator)}const Kv={asc:"ASCENDING",desc:"DESCENDING"},Qv={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Xv={and:"AND",or:"OR"};class Jv{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Ra(n,e){return n.useProto3Json||to(e)?e:{value:e}}function Ni(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function kd(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function Yv(n,e){return Ni(n,e.toTimestamp())}function mt(n){return ee(!!n,49232),j.fromTimestamp((function(t){const r=an(t);return new oe(r.seconds,r.nanos)})(n))}function yc(n,e){return Sa(n,e).canonicalString()}function Sa(n,e){const t=(function(s){return new ie(["projects",s.projectId,"databases",s.database])})(n).child("documents");return e===void 0?t:t.child(e)}function Nd(n){const e=ie.fromString(n);return ee(Ld(e),10190,{key:e.toString()}),e}function Pa(n,e){return yc(n.databaseId,e.path)}function ea(n,e){const t=Nd(e);if(t.get(1)!==n.databaseId.projectId)throw new L(N.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new L(N.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new F(Vd(t))}function Dd(n,e){return yc(n.databaseId,e)}function Zv(n){const e=Nd(n);return e.length===4?ie.emptyPath():Vd(e)}function Ca(n){return new ie(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Vd(n){return ee(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function Xl(n,e,t){return{name:Pa(n,e),fields:t.value.mapValue.fields}}function eE(n,e){let t;if("targetChange"in e){e.targetChange;const r=(function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:U(39313,{state:h})})(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=(function(h,d){return h.useProto3Json?(ee(d===void 0||typeof d=="string",58123),Se.fromBase64String(d||"")):(ee(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),Se.fromUint8Array(d||new Uint8Array))})(n,e.targetChange.resumeToken),a=e.targetChange.cause,c=a&&(function(h){const d=h.code===void 0?N.UNKNOWN:Sd(h.code);return new L(d,h.message||"")})(a);t=new Cd(r,s,i,c||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=ea(n,r.document.name),i=mt(r.document.updateTime),a=r.document.createTime?mt(r.document.createTime):j.min(),c=new je({mapValue:{fields:r.document.fields}}),l=De.newFoundDocument(s,i,a,c),h=r.targetIds||[],d=r.removedTargetIds||[];t=new fi(h,d,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=ea(n,r.document),i=r.readTime?mt(r.readTime):j.min(),a=De.newNoDocument(s,i),c=r.removedTargetIds||[];t=new fi([],c,a.key,a)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=ea(n,r.document),i=r.removedTargetIds||[];t=new fi([],i,s,null)}else{if(!("filter"in e))return U(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,a=new qv(s,i),c=r.targetId;t=new Pd(c,a)}}return t}function tE(n,e){let t;if(e instanceof ks)t={update:Xl(n,e.key,e.value)};else if(e instanceof mc)t={delete:Pa(n,e.key)};else if(e instanceof pn)t={update:Xl(n,e.key,e.data),updateMask:lE(e.fieldMask)};else{if(!(e instanceof Bv))return U(16599,{Vt:e.type});t={verify:Pa(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((r=>(function(i,a){const c=a.transform;if(c instanceof Ci)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof Is)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof ws)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof ki)return{fieldPath:a.field.canonicalString(),increment:c.Ae};throw U(20930,{transform:a.transform})})(0,r)))),e.precondition.isNone||(t.currentDocument=(function(s,i){return i.updateTime!==void 0?{updateTime:Yv(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:U(27497)})(n,e.precondition)),t}function nE(n,e){return n&&n.length>0?(ee(e!==void 0,14353),n.map((t=>(function(s,i){let a=s.updateTime?mt(s.updateTime):mt(i);return a.isEqual(j.min())&&(a=mt(i)),new xv(a,s.transformResults||[])})(t,e)))):[]}function rE(n,e){return{documents:[Dd(n,e.path)]}}function sE(n,e){const t={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=Dd(n,s);const i=(function(h){if(h.length!==0)return Md(Tt.create(h,"and"))})(e.filters);i&&(t.structuredQuery.where=i);const a=(function(h){if(h.length!==0)return h.map((d=>(function(g){return{field:Xn(g.field),direction:aE(g.dir)}})(d)))})(e.orderBy);a&&(t.structuredQuery.orderBy=a);const c=Ra(n,e.limit);return c!==null&&(t.structuredQuery.limit=c),e.startAt&&(t.structuredQuery.startAt=(function(h){return{before:h.inclusive,values:h.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(h){return{before:!h.inclusive,values:h.position}})(e.endAt)),{ft:t,parent:s}}function iE(n){let e=Zv(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let s=null;if(r>0){ee(r===1,65062);const d=t.from[0];d.allDescendants?s=d.collectionId:e=e.child(d.collectionId)}let i=[];t.where&&(i=(function(m){const g=Od(m);return g instanceof Tt&&hd(g)?g.getFilters():[g]})(t.where));let a=[];t.orderBy&&(a=(function(m){return m.map((g=>(function(S){return new Pi(Jn(S.field),(function(P){switch(P){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(S.direction))})(g)))})(t.orderBy));let c=null;t.limit&&(c=(function(m){let g;return g=typeof m=="object"?m.value:m,to(g)?null:g})(t.limit));let l=null;t.startAt&&(l=(function(m){const g=!!m.before,T=m.values||[];return new Si(T,g)})(t.startAt));let h=null;return t.endAt&&(h=(function(m){const g=!m.before,T=m.values||[];return new Si(T,g)})(t.endAt)),wv(e,s,a,i,c,"F",l,h)}function oE(n,e){const t=(function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return U(28987,{purpose:s})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Od(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=Jn(t.unaryFilter.field);return _e.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Jn(t.unaryFilter.field);return _e.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Jn(t.unaryFilter.field);return _e.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=Jn(t.unaryFilter.field);return _e.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return U(61313);default:return U(60726)}})(n):n.fieldFilter!==void 0?(function(t){return _e.create(Jn(t.fieldFilter.field),(function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return U(58110);default:return U(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Tt.create(t.compositeFilter.filters.map((r=>Od(r))),(function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return U(1026)}})(t.compositeFilter.op))})(n):U(30097,{filter:n})}function aE(n){return Kv[n]}function cE(n){return Qv[n]}function uE(n){return Xv[n]}function Xn(n){return{fieldPath:n.canonicalString()}}function Jn(n){return Ae.fromServerFormat(n.fieldPath)}function Md(n){return n instanceof _e?(function(t){if(t.op==="=="){if(xl(t.value))return{unaryFilter:{field:Xn(t.field),op:"IS_NAN"}};if(Ll(t.value))return{unaryFilter:{field:Xn(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(xl(t.value))return{unaryFilter:{field:Xn(t.field),op:"IS_NOT_NAN"}};if(Ll(t.value))return{unaryFilter:{field:Xn(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Xn(t.field),op:cE(t.op),value:t.value}}})(n):n instanceof Tt?(function(t){const r=t.getFilters().map((s=>Md(s)));return r.length===1?r[0]:{compositeFilter:{op:uE(t.op),filters:r}}})(n):U(54877,{filter:n})}function lE(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function Ld(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}class Qt{constructor(e,t,r,s,i=j.min(),a=j.min(),c=Se.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=c,this.expectedCount=l}withSequenceNumber(e){return new Qt(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Qt(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Qt(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Qt(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class hE{constructor(e){this.yt=e}}function fE(n){const e=iE({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?ba(e,e.limit,"L"):e}class dE{constructor(){this.Cn=new pE}addToCollectionParentIndex(e,t){return this.Cn.add(t),C.resolve()}getCollectionParents(e,t){return C.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return C.resolve()}deleteFieldIndex(e,t){return C.resolve()}deleteAllFieldIndexes(e){return C.resolve()}createTargetIndexes(e,t){return C.resolve()}getDocumentsMatchingTarget(e,t){return C.resolve(null)}getIndexType(e,t){return C.resolve(0)}getFieldIndexes(e,t){return C.resolve([])}getNextCollectionGroupToUpdate(e){return C.resolve(null)}getMinOffset(e,t){return C.resolve(on.min())}getMinOffsetFromCollectionGroup(e,t){return C.resolve(on.min())}updateCollectionGroup(e,t,r){return C.resolve()}updateIndexEntries(e,t){return C.resolve()}}class pE{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t]||new ve(ie.comparator),i=!s.has(r);return this.index[t]=s.add(r),i}has(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t];return s&&s.has(r)}getEntries(e){return(this.index[e]||new ve(ie.comparator)).toArray()}}const Jl={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},xd=41943040;class Be{static withCacheSize(e){return new Be(e,Be.DEFAULT_COLLECTION_PERCENTILE,Be.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}Be.DEFAULT_COLLECTION_PERCENTILE=10,Be.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Be.DEFAULT=new Be(xd,Be.DEFAULT_COLLECTION_PERCENTILE,Be.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Be.DISABLED=new Be(-1,0,0);class vr{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new vr(0)}static cr(){return new vr(-1)}}const Yl="LruGarbageCollector",mE=1048576;function Zl([n,e],[t,r]){const s=G(n,t);return s===0?G(e,r):s}class gE{constructor(e){this.Ir=e,this.buffer=new ve(Zl),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();Zl(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class _E{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){O(Yl,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Vr(t)?O(Yl,"Ignoring IndexedDB error during garbage collection: ",t):await Dr(t)}await this.Vr(3e5)}))}}class yE{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((r=>Math.floor(t/100*r)))}nthSequenceNumber(e,t){if(t===0)return C.resolve(eo.ce);const r=new gE(t);return this.mr.forEachTarget(e,(s=>r.Ar(s.sequenceNumber))).next((()=>this.mr.pr(e,(s=>r.Ar(s))))).next((()=>r.maxValue))}removeTargets(e,t,r){return this.mr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(O("LruGarbageCollector","Garbage collection skipped; disabled"),C.resolve(Jl)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(O("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Jl):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let r,s,i,a,c,l,h;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((m=>(m>this.params.maximumSequenceNumbersToCollect?(O("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${m}`),s=this.params.maximumSequenceNumbersToCollect):s=m,a=Date.now(),this.nthSequenceNumber(e,s)))).next((m=>(r=m,c=Date.now(),this.removeTargets(e,r,t)))).next((m=>(i=m,l=Date.now(),this.removeOrphanedDocuments(e,r)))).next((m=>(h=Date.now(),Kn()<=H.DEBUG&&O("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-d}ms
	Determined least recently used ${s} in `+(c-a)+`ms
	Removed ${i} targets in `+(l-c)+`ms
	Removed ${m} documents in `+(h-l)+`ms
Total Duration: ${h-d}ms`),C.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:m}))))}}function vE(n,e){return new yE(n,e)}class EE{constructor(){this.changes=new jn((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,De.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?C.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class TE{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class IE{constructor(e,t,r,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next((s=>(r=s,this.remoteDocumentCache.getEntry(e,t)))).next((s=>(r!==null&&hs(r.mutation,s,Qe.empty(),oe.now()),s)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.getLocalViewOfDocuments(e,r,W()).next((()=>r))))}getLocalViewOfDocuments(e,t,r=W()){const s=In();return this.populateOverlays(e,s,t).next((()=>this.computeViews(e,t,s,r).next((i=>{let a=es();return i.forEach(((c,l)=>{a=a.insert(c,l.overlayedDocument)})),a}))))}getOverlayedDocuments(e,t){const r=In();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,W())))}populateOverlays(e,t,r){const s=[];return r.forEach((i=>{t.has(i)||s.push(i)})),this.documentOverlayCache.getOverlays(e,s).next((i=>{i.forEach(((a,c)=>{t.set(a,c)}))}))}computeViews(e,t,r,s){let i=Vt();const a=ls(),c=(function(){return ls()})();return t.forEach(((l,h)=>{const d=r.get(h.key);s.has(h.key)&&(d===void 0||d.mutation instanceof pn)?i=i.insert(h.key,h):d!==void 0?(a.set(h.key,d.mutation.getFieldMask()),hs(d.mutation,h,d.mutation.getFieldMask(),oe.now())):a.set(h.key,Qe.empty())})),this.recalculateAndSaveOverlays(e,i).next((l=>(l.forEach(((h,d)=>a.set(h,d))),t.forEach(((h,d)=>c.set(h,new TE(d,a.get(h)??null)))),c)))}recalculateAndSaveOverlays(e,t){const r=ls();let s=new ue(((a,c)=>a-c)),i=W();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((a=>{for(const c of a)c.keys().forEach((l=>{const h=t.get(l);if(h===null)return;let d=r.get(l)||Qe.empty();d=c.applyToLocalView(h,d),r.set(l,d);const m=(s.get(c.batchId)||W()).add(l);s=s.insert(c.batchId,m)}))})).next((()=>{const a=[],c=s.getReverseIterator();for(;c.hasNext();){const l=c.getNext(),h=l.key,d=l.value,m=vd();d.forEach((g=>{if(!i.has(g)){const T=bd(t.get(g),r.get(g));T!==null&&m.set(g,T),i=i.add(g)}})),a.push(this.documentOverlayCache.saveOverlays(e,h,m))}return C.waitFor(a)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,t,r,s){return(function(a){return F.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Av(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,s):this.getDocumentsMatchingCollectionQuery(e,t,r,s)}getNextDocuments(e,t,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,s).next((i=>{const a=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,s-i.size):C.resolve(In());let c=ys,l=i;return a.next((h=>C.forEach(h,((d,m)=>(c<m.largestBatchId&&(c=m.largestBatchId),i.get(d)?C.resolve():this.remoteDocumentCache.getEntry(e,d).next((g=>{l=l.insert(d,g)}))))).next((()=>this.populateOverlays(e,h,i))).next((()=>this.computeViews(e,l,h,W()))).next((d=>({batchId:c,changes:yd(d)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new F(t)).next((r=>{let s=es();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s}))}getDocumentsMatchingCollectionGroupQuery(e,t,r,s){const i=t.collectionGroup;let a=es();return this.indexManager.getCollectionParents(e,i).next((c=>C.forEach(c,(l=>{const h=(function(m,g){return new ro(g,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)})(t,l.child(i));return this.getDocumentsMatchingCollectionQuery(e,h,r,s).next((d=>{d.forEach(((m,g)=>{a=a.insert(m,g)}))}))})).next((()=>a))))}getDocumentsMatchingCollectionQuery(e,t,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next((a=>(i=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,i,s)))).next((a=>{i.forEach(((l,h)=>{const d=h.getKey();a.get(d)===null&&(a=a.insert(d,De.newInvalidDocument(d)))}));let c=es();return a.forEach(((l,h)=>{const d=i.get(l);d!==void 0&&hs(d.mutation,h,Qe.empty(),oe.now()),io(t,h)&&(c=c.insert(l,h))})),c}))}}class wE{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return C.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(s){return{id:s.id,version:s.version,createTime:mt(s.createTime)}})(t)),C.resolve()}getNamedQuery(e,t){return C.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(s){return{name:s.name,query:fE(s.bundledQuery),readTime:mt(s.readTime)}})(t)),C.resolve()}}class AE{constructor(){this.overlays=new ue(F.comparator),this.qr=new Map}getOverlay(e,t){return C.resolve(this.overlays.get(t))}getOverlays(e,t){const r=In();return C.forEach(t,(s=>this.getOverlay(e,s).next((i=>{i!==null&&r.set(s,i)})))).next((()=>r))}saveOverlays(e,t,r){return r.forEach(((s,i)=>{this.St(e,t,i)})),C.resolve()}removeOverlaysForBatchId(e,t,r){const s=this.qr.get(r);return s!==void 0&&(s.forEach((i=>this.overlays=this.overlays.remove(i))),this.qr.delete(r)),C.resolve()}getOverlaysForCollection(e,t,r){const s=In(),i=t.length+1,a=new F(t.child("")),c=this.overlays.getIteratorFrom(a);for(;c.hasNext();){const l=c.getNext().value,h=l.getKey();if(!t.isPrefixOf(h.path))break;h.path.length===i&&l.largestBatchId>r&&s.set(l.getKey(),l)}return C.resolve(s)}getOverlaysForCollectionGroup(e,t,r,s){let i=new ue(((h,d)=>h-d));const a=this.overlays.getIterator();for(;a.hasNext();){const h=a.getNext().value;if(h.getKey().getCollectionGroup()===t&&h.largestBatchId>r){let d=i.get(h.largestBatchId);d===null&&(d=In(),i=i.insert(h.largestBatchId,d)),d.set(h.getKey(),h)}}const c=In(),l=i.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach(((h,d)=>c.set(h,d))),!(c.size()>=s)););return C.resolve(c)}St(e,t,r){const s=this.overlays.get(r.key);if(s!==null){const a=this.qr.get(s.largestBatchId).delete(r.key);this.qr.set(s.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new $v(t,r));let i=this.qr.get(t);i===void 0&&(i=W(),this.qr.set(t,i)),this.qr.set(t,i.add(r.key))}}class bE{constructor(){this.sessionToken=Se.EMPTY_BYTE_STRING}getSessionToken(e){return C.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,C.resolve()}}class vc{constructor(){this.Qr=new ve(Te.$r),this.Ur=new ve(Te.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const r=new Te(e,t);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,t){e.forEach((r=>this.addReference(r,t)))}removeReference(e,t){this.Gr(new Te(e,t))}zr(e,t){e.forEach((r=>this.removeReference(r,t)))}jr(e){const t=new F(new ie([])),r=new Te(t,e),s=new Te(t,e+1),i=[];return this.Ur.forEachInRange([r,s],(a=>{this.Gr(a),i.push(a.key)})),i}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new F(new ie([])),r=new Te(t,e),s=new Te(t,e+1);let i=W();return this.Ur.forEachInRange([r,s],(a=>{i=i.add(a.key)})),i}containsKey(e){const t=new Te(e,0),r=this.Qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class Te{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return F.comparator(e.key,t.key)||G(e.Yr,t.Yr)}static Kr(e,t){return G(e.Yr,t.Yr)||F.comparator(e.key,t.key)}}class RE{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new ve(Te.$r)}checkEmpty(e){return C.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,s){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new jv(i,t,r,s);this.mutationQueue.push(a);for(const c of s)this.Zr=this.Zr.add(new Te(c.key,i)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return C.resolve(a)}lookupMutationBatch(e,t){return C.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,s=this.ei(r),i=s<0?0:s;return C.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return C.resolve(this.mutationQueue.length===0?cc:this.tr-1)}getAllMutationBatches(e){return C.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new Te(t,0),s=new Te(t,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([r,s],(a=>{const c=this.Xr(a.Yr);i.push(c)})),C.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new ve(G);return t.forEach((s=>{const i=new Te(s,0),a=new Te(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,a],(c=>{r=r.add(c.Yr)}))})),C.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,s=r.length+1;let i=r;F.isDocumentKey(i)||(i=i.child(""));const a=new Te(new F(i),0);let c=new ve(G);return this.Zr.forEachWhile((l=>{const h=l.key.path;return!!r.isPrefixOf(h)&&(h.length===s&&(c=c.add(l.Yr)),!0)}),a),C.resolve(this.ti(c))}ti(e){const t=[];return e.forEach((r=>{const s=this.Xr(r);s!==null&&t.push(s)})),t}removeMutationBatch(e,t){ee(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return C.forEach(t.mutations,(s=>{const i=new Te(s.key,t.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)})).next((()=>{this.Zr=r}))}ir(e){}containsKey(e,t){const r=new Te(t,0),s=this.Zr.firstAfterOrEqual(r);return C.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,C.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class SE{constructor(e){this.ri=e,this.docs=(function(){return new ue(F.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,s=this.docs.get(r),i=s?s.size:0,a=this.ri(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return C.resolve(r?r.document.mutableCopy():De.newInvalidDocument(t))}getEntries(e,t){let r=Vt();return t.forEach((s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():De.newInvalidDocument(s))})),C.resolve(r)}getDocumentsMatchingQuery(e,t,r,s){let i=Vt();const a=t.path,c=new F(a.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(c);for(;l.hasNext();){const{key:h,value:{document:d}}=l.getNext();if(!a.isPrefixOf(h.path))break;h.path.length>a.length+1||tv(ev(d),r)<=0||(s.has(d.key)||io(t,d))&&(i=i.insert(d.key,d.mutableCopy()))}return C.resolve(i)}getAllFromCollectionGroup(e,t,r,s){U(9500)}ii(e,t){return C.forEach(this.docs,(r=>t(r)))}newChangeBuffer(e){return new PE(this)}getSize(e){return C.resolve(this.size)}}class PE extends EE{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((r,s)=>{s.isValidDocument()?t.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(r)})),C.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class CE{constructor(e){this.persistence=e,this.si=new jn((t=>hc(t)),fc),this.lastRemoteSnapshotVersion=j.min(),this.highestTargetId=0,this.oi=0,this._i=new vc,this.targetCount=0,this.ai=vr.ur()}forEachTarget(e,t){return this.si.forEach(((r,s)=>t(s))),C.resolve()}getLastRemoteSnapshotVersion(e){return C.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return C.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),C.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.oi&&(this.oi=t),C.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new vr(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,C.resolve()}updateTargetData(e,t){return this.Pr(t),C.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,C.resolve()}removeTargets(e,t,r){let s=0;const i=[];return this.si.forEach(((a,c)=>{c.sequenceNumber<=t&&r.get(c.targetId)===null&&(this.si.delete(a),i.push(this.removeMatchingKeysForTargetId(e,c.targetId)),s++)})),C.waitFor(i).next((()=>s))}getTargetCount(e){return C.resolve(this.targetCount)}getTargetData(e,t){const r=this.si.get(t)||null;return C.resolve(r)}addMatchingKeys(e,t,r){return this._i.Wr(t,r),C.resolve()}removeMatchingKeys(e,t,r){this._i.zr(t,r);const s=this.persistence.referenceDelegate,i=[];return s&&t.forEach((a=>{i.push(s.markPotentiallyOrphaned(e,a))})),C.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),C.resolve()}getMatchingKeysForTargetId(e,t){const r=this._i.Hr(t);return C.resolve(r)}containsKey(e,t){return C.resolve(this._i.containsKey(t))}}class Fd{constructor(e,t){this.ui={},this.overlays={},this.ci=new eo(0),this.li=!1,this.li=!0,this.hi=new bE,this.referenceDelegate=e(this),this.Pi=new CE(this),this.indexManager=new dE,this.remoteDocumentCache=(function(s){return new SE(s)})((r=>this.referenceDelegate.Ti(r))),this.serializer=new hE(t),this.Ii=new wE(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new AE,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ui[e.toKey()];return r||(r=new RE(t,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,r){O("MemoryPersistence","Starting transaction:",e);const s=new kE(this.ci.next());return this.referenceDelegate.Ei(),r(s).next((i=>this.referenceDelegate.di(s).next((()=>i)))).toPromise().then((i=>(s.raiseOnCommittedEvent(),i)))}Ai(e,t){return C.or(Object.values(this.ui).map((r=>()=>r.containsKey(e,t))))}}class kE extends rv{constructor(e){super(),this.currentSequenceNumber=e}}class Ec{constructor(e){this.persistence=e,this.Ri=new vc,this.Vi=null}static mi(e){return new Ec(e)}get fi(){if(this.Vi)return this.Vi;throw U(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.fi.delete(r.toString()),C.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.fi.add(r.toString()),C.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),C.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((s=>this.fi.add(s.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((s=>{s.forEach((i=>this.fi.add(i.toString())))})).next((()=>r.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return C.forEach(this.fi,(r=>{const s=F.fromPath(r);return this.gi(e,s).next((i=>{i||t.removeEntry(s,j.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((r=>{r?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return C.or([()=>C.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class Di{constructor(e,t){this.persistence=e,this.pi=new jn((r=>ov(r.path)),((r,s)=>r.isEqual(s))),this.garbageCollector=vE(this,t)}static mi(e,t){return new Di(e,t)}Ei(){}di(e){return C.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>t.next((s=>r+s))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}pr(e,t){return C.forEach(this.pi,((r,s)=>this.br(e,r,s).next((i=>i?C.resolve():t(s)))))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.ii(e,(a=>this.br(e,a,t).next((c=>{c||(r++,i.removeEntry(a,j.min()))})))).next((()=>i.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),C.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),C.resolve()}removeReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),C.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),C.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=ui(e.data.value)),t}br(e,t,r){return C.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const s=this.pi.get(t);return C.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class Tc{constructor(e,t,r,s){this.targetId=e,this.fromCache=t,this.Es=r,this.ds=s}static As(e,t){let r=W(),s=W();for(const i of t.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new Tc(e,t.fromCache,r,s)}}class NE{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class DE{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return I_()?8:sv(Oe())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,s){const i={result:null};return this.ys(e,t).next((a=>{i.result=a})).next((()=>{if(!i.result)return this.ws(e,t,s,r).next((a=>{i.result=a}))})).next((()=>{if(i.result)return;const a=new NE;return this.Ss(e,t,a).next((c=>{if(i.result=c,this.Vs)return this.bs(e,t,a,c.size)}))})).next((()=>i.result))}bs(e,t,r,s){return r.documentReadCount<this.fs?(Kn()<=H.DEBUG&&O("QueryEngine","SDK will not create cache indexes for query:",Qn(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),C.resolve()):(Kn()<=H.DEBUG&&O("QueryEngine","Query:",Qn(t),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.gs*s?(Kn()<=H.DEBUG&&O("QueryEngine","The SDK decides to create cache indexes for query:",Qn(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,pt(t))):C.resolve())}ys(e,t){if(jl(t))return C.resolve(null);let r=pt(t);return this.indexManager.getIndexType(e,r).next((s=>s===0?null:(t.limit!==null&&s===1&&(t=ba(t,null,"F"),r=pt(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next((i=>{const a=W(...i);return this.ps.getDocuments(e,a).next((c=>this.indexManager.getMinOffset(e,r).next((l=>{const h=this.Ds(t,c);return this.Cs(t,h,a,l.readTime)?this.ys(e,ba(t,null,"F")):this.vs(e,h,t,l)}))))})))))}ws(e,t,r,s){return jl(t)||s.isEqual(j.min())?C.resolve(null):this.ps.getDocuments(e,r).next((i=>{const a=this.Ds(t,i);return this.Cs(t,a,r,s)?C.resolve(null):(Kn()<=H.DEBUG&&O("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Qn(t)),this.vs(e,a,t,Zy(s,ys)).next((c=>c)))}))}Ds(e,t){let r=new ve(gd(e));return t.forEach(((s,i)=>{io(e,i)&&(r=r.add(i))})),r}Cs(e,t,r,s){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const i=e.limitType==="F"?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Ss(e,t,r){return Kn()<=H.DEBUG&&O("QueryEngine","Using full collection scan to execute query:",Qn(t)),this.ps.getDocumentsMatchingQuery(e,t,on.min(),r)}vs(e,t,r,s){return this.ps.getDocumentsMatchingQuery(e,r,s).next((i=>(t.forEach((a=>{i=i.insert(a.key,a)})),i)))}}const Ic="LocalStore",VE=3e8;class OE{constructor(e,t,r,s){this.persistence=e,this.Fs=t,this.serializer=s,this.Ms=new ue(G),this.xs=new jn((i=>hc(i)),fc),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new IE(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function ME(n,e,t,r){return new OE(n,e,t,r)}async function Ud(n,e){const t=$(n);return await t.persistence.runTransaction("Handle user change","readonly",(r=>{let s;return t.mutationQueue.getAllMutationBatches(r).next((i=>(s=i,t.Bs(e),t.mutationQueue.getAllMutationBatches(r)))).next((i=>{const a=[],c=[];let l=W();for(const h of s){a.push(h.batchId);for(const d of h.mutations)l=l.add(d.key)}for(const h of i){c.push(h.batchId);for(const d of h.mutations)l=l.add(d.key)}return t.localDocuments.getDocuments(r,l).next((h=>({Ls:h,removedBatchIds:a,addedBatchIds:c})))}))}))}function LE(n,e){const t=$(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const s=e.batch.keys(),i=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(c,l,h,d){const m=h.batch,g=m.keys();let T=C.resolve();return g.forEach((S=>{T=T.next((()=>d.getEntry(l,S))).next((k=>{const P=h.docVersions.get(S);ee(P!==null,48541),k.version.compareTo(P)<0&&(m.applyToRemoteDocument(k,h),k.isValidDocument()&&(k.setReadTime(h.commitVersion),d.addEntry(k)))}))})),T.next((()=>c.mutationQueue.removeMutationBatch(l,m)))})(t,r,e,i).next((()=>i.apply(r))).next((()=>t.mutationQueue.performConsistencyCheck(r))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(c){let l=W();for(let h=0;h<c.mutationResults.length;++h)c.mutationResults[h].transformResults.length>0&&(l=l.add(c.batch.mutations[h].key));return l})(e)))).next((()=>t.localDocuments.getDocuments(r,s)))}))}function Bd(n){const e=$(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function xE(n,e){const t=$(n),r=e.snapshotVersion;let s=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(i=>{const a=t.Ns.newChangeBuffer({trackRemovals:!0});s=t.Ms;const c=[];e.targetChanges.forEach(((d,m)=>{const g=s.get(m);if(!g)return;c.push(t.Pi.removeMatchingKeys(i,d.removedDocuments,m).next((()=>t.Pi.addMatchingKeys(i,d.addedDocuments,m))));let T=g.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(m)!==null?T=T.withResumeToken(Se.EMPTY_BYTE_STRING,j.min()).withLastLimboFreeSnapshotVersion(j.min()):d.resumeToken.approximateByteSize()>0&&(T=T.withResumeToken(d.resumeToken,r)),s=s.insert(m,T),(function(k,P,x){return k.resumeToken.approximateByteSize()===0||P.snapshotVersion.toMicroseconds()-k.snapshotVersion.toMicroseconds()>=VE?!0:x.addedDocuments.size+x.modifiedDocuments.size+x.removedDocuments.size>0})(g,T,d)&&c.push(t.Pi.updateTargetData(i,T))}));let l=Vt(),h=W();if(e.documentUpdates.forEach((d=>{e.resolvedLimboDocuments.has(d)&&c.push(t.persistence.referenceDelegate.updateLimboDocument(i,d))})),c.push(FE(i,a,e.documentUpdates).next((d=>{l=d.ks,h=d.qs}))),!r.isEqual(j.min())){const d=t.Pi.getLastRemoteSnapshotVersion(i).next((m=>t.Pi.setTargetsMetadata(i,i.currentSequenceNumber,r)));c.push(d)}return C.waitFor(c).next((()=>a.apply(i))).next((()=>t.localDocuments.getLocalViewOfDocuments(i,l,h))).next((()=>l))})).then((i=>(t.Ms=s,i)))}function FE(n,e,t){let r=W(),s=W();return t.forEach((i=>r=r.add(i))),e.getEntries(n,r).next((i=>{let a=Vt();return t.forEach(((c,l)=>{const h=i.get(c);l.isFoundDocument()!==h.isFoundDocument()&&(s=s.add(c)),l.isNoDocument()&&l.version.isEqual(j.min())?(e.removeEntry(c,l.readTime),a=a.insert(c,l)):!h.isValidDocument()||l.version.compareTo(h.version)>0||l.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(l),a=a.insert(c,l)):O(Ic,"Ignoring outdated watch update for ",c,". Current version:",h.version," Watch version:",l.version)})),{ks:a,qs:s}}))}function UE(n,e){const t=$(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=cc),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function BE(n,e){const t=$(n);return t.persistence.runTransaction("Allocate target","readwrite",(r=>{let s;return t.Pi.getTargetData(r,e).next((i=>i?(s=i,C.resolve(s)):t.Pi.allocateTargetId(r).next((a=>(s=new Qt(e,a,"TargetPurposeListen",r.currentSequenceNumber),t.Pi.addTargetData(r,s).next((()=>s)))))))})).then((r=>{const s=t.Ms.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(r.targetId,r),t.xs.set(e,r.targetId)),r}))}async function ka(n,e,t){const r=$(n),s=r.Ms.get(e),i=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",i,(a=>r.persistence.referenceDelegate.removeTarget(a,s)))}catch(a){if(!Vr(a))throw a;O(Ic,`Failed to update sequence numbers for target ${e}: ${a}`)}r.Ms=r.Ms.remove(e),r.xs.delete(s.target)}function eh(n,e,t){const r=$(n);let s=j.min(),i=W();return r.persistence.runTransaction("Execute query","readwrite",(a=>(function(l,h,d){const m=$(l),g=m.xs.get(d);return g!==void 0?C.resolve(m.Ms.get(g)):m.Pi.getTargetData(h,d)})(r,a,pt(e)).next((c=>{if(c)return s=c.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(a,c.targetId).next((l=>{i=l}))})).next((()=>r.Fs.getDocumentsMatchingQuery(a,e,t?s:j.min(),t?i:W()))).next((c=>(jE(r,Rv(e),c),{documents:c,Qs:i})))))}function jE(n,e,t){let r=n.Os.get(e)||j.min();t.forEach(((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)})),n.Os.set(e,r)}class th{constructor(){this.activeTargetIds=Dv()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class $E{constructor(){this.Mo=new th,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,r){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new th,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class qE{Oo(e){}shutdown(){}}const nh="ConnectivityMonitor";class rh{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){O(nh,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){O(nh,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let si=null;function Na(){return si===null?si=(function(){return 268435456+Math.round(2147483648*Math.random())})():si++,"0x"+si.toString(16)}const ta="RestConnection",zE={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class HE{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${r}/databases/${s}`,this.Wo=this.databaseId.database===bi?`project_id=${r}`:`project_id=${r}&database_id=${s}`}Go(e,t,r,s,i){const a=Na(),c=this.zo(e,t.toUriEncodedString());O(ta,`Sending RPC '${e}' ${a}:`,c,r);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,s,i);const{host:h}=new URL(c),d=fn(h);return this.Jo(e,c,l,r,d).then((m=>(O(ta,`Received RPC '${e}' ${a}: `,m),m)),(m=>{throw mr(ta,`RPC '${e}' ${a} failed with error: `,m,"url: ",c,"request:",r),m}))}Ho(e,t,r,s,i,a){return this.Go(e,t,r,s,i)}jo(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Nr})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((s,i)=>e[i]=s)),r&&r.headers.forEach(((s,i)=>e[i]=s))}zo(e,t){const r=zE[e];return`${this.Uo}/v1/${t}:${r}`}terminate(){}}class GE{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const Ce="WebChannelConnection";class WE extends HE{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,s,i){const a=Na();return new Promise(((c,l)=>{const h=new zf;h.setWithCredentials(!0),h.listenOnce(Hf.COMPLETE,(()=>{try{switch(h.getLastErrorCode()){case ci.NO_ERROR:const m=h.getResponseJson();O(Ce,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(m)),c(m);break;case ci.TIMEOUT:O(Ce,`RPC '${e}' ${a} timed out`),l(new L(N.DEADLINE_EXCEEDED,"Request time out"));break;case ci.HTTP_ERROR:const g=h.getStatus();if(O(Ce,`RPC '${e}' ${a} failed with status:`,g,"response text:",h.getResponseText()),g>0){let T=h.getResponseJson();Array.isArray(T)&&(T=T[0]);const S=T?.error;if(S&&S.status&&S.message){const k=(function(x){const V=x.toLowerCase().replace(/_/g,"-");return Object.values(N).indexOf(V)>=0?V:N.UNKNOWN})(S.status);l(new L(k,S.message))}else l(new L(N.UNKNOWN,"Server responded with status "+h.getStatus()))}else l(new L(N.UNAVAILABLE,"Connection failed."));break;default:U(9055,{l_:e,streamId:a,h_:h.getLastErrorCode(),P_:h.getLastError()})}}finally{O(Ce,`RPC '${e}' ${a} completed.`)}}));const d=JSON.stringify(s);O(Ce,`RPC '${e}' ${a} sending request:`,s),h.send(t,"POST",d,r,15)}))}T_(e,t,r){const s=Na(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=Kf(),c=Wf(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(l.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,t,r),l.encodeInitMessageHeaders=!0;const d=i.join("");O(Ce,`Creating RPC '${e}' stream ${s}: ${d}`,l);const m=a.createWebChannel(d,l);this.I_(m);let g=!1,T=!1;const S=new GE({Yo:P=>{T?O(Ce,`Not sending because RPC '${e}' stream ${s} is closed:`,P):(g||(O(Ce,`Opening RPC '${e}' stream ${s} transport.`),m.open(),g=!0),O(Ce,`RPC '${e}' stream ${s} sending:`,P),m.send(P))},Zo:()=>m.close()}),k=(P,x,V)=>{P.listen(x,(M=>{try{V(M)}catch(K){setTimeout((()=>{throw K}),0)}}))};return k(m,Zr.EventType.OPEN,(()=>{T||(O(Ce,`RPC '${e}' stream ${s} transport opened.`),S.o_())})),k(m,Zr.EventType.CLOSE,(()=>{T||(T=!0,O(Ce,`RPC '${e}' stream ${s} transport closed`),S.a_(),this.E_(m))})),k(m,Zr.EventType.ERROR,(P=>{T||(T=!0,mr(Ce,`RPC '${e}' stream ${s} transport errored. Name:`,P.name,"Message:",P.message),S.a_(new L(N.UNAVAILABLE,"The operation could not be completed")))})),k(m,Zr.EventType.MESSAGE,(P=>{if(!T){const x=P.data[0];ee(!!x,16349);const V=x,M=V?.error||V[0]?.error;if(M){O(Ce,`RPC '${e}' stream ${s} received error:`,M);const K=M.status;let X=(function(_){const v=fe[_];if(v!==void 0)return Sd(v)})(K),Y=M.message;X===void 0&&(X=N.INTERNAL,Y="Unknown error status: "+K+" with message "+M.message),T=!0,S.a_(new L(X,Y)),m.close()}else O(Ce,`RPC '${e}' stream ${s} received:`,x),S.u_(x)}})),k(c,Gf.STAT_EVENT,(P=>{P.stat===va.PROXY?O(Ce,`RPC '${e}' stream ${s} detected buffering proxy`):P.stat===va.NOPROXY&&O(Ce,`RPC '${e}' stream ${s} detected no buffering proxy`)})),setTimeout((()=>{S.__()}),0),S}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function na(){return typeof document<"u"?document:null}function uo(n){return new Jv(n,!0)}class jd{constructor(e,t,r=1e3,s=1.5,i=6e4){this.Mi=e,this.timerId=t,this.d_=r,this.A_=s,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),s=Math.max(0,t-r);s>0&&O("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const sh="PersistentStream";class $d{constructor(e,t,r,s,i,a,c,l){this.Mi=e,this.S_=r,this.b_=s,this.connection=i,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=c,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new jd(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===N.RESOURCE_EXHAUSTED?(Dt(t.toString()),Dt("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===N.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,s])=>{this.D_===t&&this.G_(r,s)}),(r=>{e((()=>{const s=new L(N.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(s)}))}))}G_(e,t){const r=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{r((()=>this.listener.Xo()))})),this.stream.t_((()=>{r((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((s=>{r((()=>this.z_(s)))})),this.stream.onMessage((s=>{r((()=>++this.F_==1?this.J_(s):this.onNext(s)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return O(sh,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(O(sh,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class KE extends $d{constructor(e,t,r,s,i,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,s,a),this.serializer=i}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=eE(this.serializer,e),r=(function(i){if(!("targetChange"in i))return j.min();const a=i.targetChange;return a.targetIds&&a.targetIds.length?j.min():a.readTime?mt(a.readTime):j.min()})(e);return this.listener.H_(t,r)}Y_(e){const t={};t.database=Ca(this.serializer),t.addTarget=(function(i,a){let c;const l=a.target;if(c=Aa(l)?{documents:rE(i,l)}:{query:sE(i,l).ft},c.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){c.resumeToken=kd(i,a.resumeToken);const h=Ra(i,a.expectedCount);h!==null&&(c.expectedCount=h)}else if(a.snapshotVersion.compareTo(j.min())>0){c.readTime=Ni(i,a.snapshotVersion.toTimestamp());const h=Ra(i,a.expectedCount);h!==null&&(c.expectedCount=h)}return c})(this.serializer,e);const r=oE(this.serializer,e);r&&(t.labels=r),this.q_(t)}Z_(e){const t={};t.database=Ca(this.serializer),t.removeTarget=e,this.q_(t)}}class QE extends $d{constructor(e,t,r,s,i,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,s,a),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return ee(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,ee(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){ee(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=nE(e.writeResults,e.commitTime),r=mt(e.commitTime);return this.listener.na(r,t)}ra(){const e={};e.database=Ca(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((r=>tE(this.serializer,r)))};this.q_(t)}}class XE{}class JE extends XE{constructor(e,t,r,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new L(N.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,a])=>this.connection.Go(e,Sa(t,r),s,i,a))).catch((i=>{throw i.name==="FirebaseError"?(i.code===N.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new L(N.UNKNOWN,i.toString())}))}Ho(e,t,r,s,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,c])=>this.connection.Ho(e,Sa(t,r),s,a,c,i))).catch((a=>{throw a.name==="FirebaseError"?(a.code===N.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new L(N.UNKNOWN,a.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class YE{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Dt(t),this.aa=!1):O("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Mn="RemoteStore";class ZE{constructor(e,t,r,s,i){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo((a=>{r.enqueueAndForget((async()=>{$n(this)&&(O(Mn,"Restarting streams for network reachability change."),await(async function(l){const h=$(l);h.Ea.add(4),await Ds(h),h.Ra.set("Unknown"),h.Ea.delete(4),await lo(h)})(this))}))})),this.Ra=new YE(r,s)}}async function lo(n){if($n(n))for(const e of n.da)await e(!0)}async function Ds(n){for(const e of n.da)await e(!1)}function qd(n,e){const t=$(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),Rc(t)?bc(t):Or(t).O_()&&Ac(t,e))}function wc(n,e){const t=$(n),r=Or(t);t.Ia.delete(e),r.O_()&&zd(t,e),t.Ia.size===0&&(r.O_()?r.L_():$n(t)&&t.Ra.set("Unknown"))}function Ac(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(j.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Or(n).Y_(e)}function zd(n,e){n.Va.Ue(e),Or(n).Z_(e)}function bc(n){n.Va=new Wv({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),Or(n).start(),n.Ra.ua()}function Rc(n){return $n(n)&&!Or(n).x_()&&n.Ia.size>0}function $n(n){return $(n).Ea.size===0}function Hd(n){n.Va=void 0}async function eT(n){n.Ra.set("Online")}async function tT(n){n.Ia.forEach(((e,t)=>{Ac(n,e)}))}async function nT(n,e){Hd(n),Rc(n)?(n.Ra.ha(e),bc(n)):n.Ra.set("Unknown")}async function rT(n,e,t){if(n.Ra.set("Online"),e instanceof Cd&&e.state===2&&e.cause)try{await(async function(s,i){const a=i.cause;for(const c of i.targetIds)s.Ia.has(c)&&(await s.remoteSyncer.rejectListen(c,a),s.Ia.delete(c),s.Va.removeTarget(c))})(n,e)}catch(r){O(Mn,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Vi(n,r)}else if(e instanceof fi?n.Va.Ze(e):e instanceof Pd?n.Va.st(e):n.Va.tt(e),!t.isEqual(j.min()))try{const r=await Bd(n.localStore);t.compareTo(r)>=0&&await(function(i,a){const c=i.Va.Tt(a);return c.targetChanges.forEach(((l,h)=>{if(l.resumeToken.approximateByteSize()>0){const d=i.Ia.get(h);d&&i.Ia.set(h,d.withResumeToken(l.resumeToken,a))}})),c.targetMismatches.forEach(((l,h)=>{const d=i.Ia.get(l);if(!d)return;i.Ia.set(l,d.withResumeToken(Se.EMPTY_BYTE_STRING,d.snapshotVersion)),zd(i,l);const m=new Qt(d.target,l,h,d.sequenceNumber);Ac(i,m)})),i.remoteSyncer.applyRemoteEvent(c)})(n,t)}catch(r){O(Mn,"Failed to raise snapshot:",r),await Vi(n,r)}}async function Vi(n,e,t){if(!Vr(e))throw e;n.Ea.add(1),await Ds(n),n.Ra.set("Offline"),t||(t=()=>Bd(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{O(Mn,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await lo(n)}))}function Gd(n,e){return e().catch((t=>Vi(n,t,e)))}async function ho(n){const e=$(n),t=ln(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:cc;for(;sT(e);)try{const s=await UE(e.localStore,r);if(s===null){e.Ta.length===0&&t.L_();break}r=s.batchId,iT(e,s)}catch(s){await Vi(e,s)}Wd(e)&&Kd(e)}function sT(n){return $n(n)&&n.Ta.length<10}function iT(n,e){n.Ta.push(e);const t=ln(n);t.O_()&&t.X_&&t.ea(e.mutations)}function Wd(n){return $n(n)&&!ln(n).x_()&&n.Ta.length>0}function Kd(n){ln(n).start()}async function oT(n){ln(n).ra()}async function aT(n){const e=ln(n);for(const t of n.Ta)e.ea(t.mutations)}async function cT(n,e,t){const r=n.Ta.shift(),s=gc.from(r,e,t);await Gd(n,(()=>n.remoteSyncer.applySuccessfulWrite(s))),await ho(n)}async function uT(n,e){e&&ln(n).X_&&await(async function(r,s){if((function(a){return zv(a)&&a!==N.ABORTED})(s.code)){const i=r.Ta.shift();ln(r).B_(),await Gd(r,(()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s))),await ho(r)}})(n,e),Wd(n)&&Kd(n)}async function ih(n,e){const t=$(n);t.asyncQueue.verifyOperationInProgress(),O(Mn,"RemoteStore received new credentials");const r=$n(t);t.Ea.add(3),await Ds(t),r&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await lo(t)}async function lT(n,e){const t=$(n);e?(t.Ea.delete(2),await lo(t)):e||(t.Ea.add(2),await Ds(t),t.Ra.set("Unknown"))}function Or(n){return n.ma||(n.ma=(function(t,r,s){const i=$(t);return i.sa(),new KE(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)})(n.datastore,n.asyncQueue,{Xo:eT.bind(null,n),t_:tT.bind(null,n),r_:nT.bind(null,n),H_:rT.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),Rc(n)?bc(n):n.Ra.set("Unknown")):(await n.ma.stop(),Hd(n))}))),n.ma}function ln(n){return n.fa||(n.fa=(function(t,r,s){const i=$(t);return i.sa(),new QE(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:oT.bind(null,n),r_:uT.bind(null,n),ta:aT.bind(null,n),na:cT.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await ho(n)):(await n.fa.stop(),n.Ta.length>0&&(O(Mn,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class Sc{constructor(e,t,r,s,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new Sn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((a=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,s,i){const a=Date.now()+r,c=new Sc(e,t,a,s,i);return c.start(r),c}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new L(N.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Pc(n,e){if(Dt("AsyncQueue",`${e}: ${n}`),Vr(n))return new L(N.UNAVAILABLE,`${e}: ${n}`);throw n}class ir{static emptySet(e){return new ir(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||F.comparator(t.key,r.key):(t,r)=>F.comparator(t.key,r.key),this.keyedMap=es(),this.sortedSet=new ue(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,r)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof ir)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new ir;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class oh{constructor(){this.ga=new ue(F.comparator)}track(e){const t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):U(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,r)=>{e.push(r)})),e}}class Er{constructor(e,t,r,s,i,a,c,l,h){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=a,this.syncStateChanged=c,this.excludesMetadataChanges=l,this.hasCachedResults=h}static fromInitialDocuments(e,t,r,s,i){const a=[];return t.forEach((c=>{a.push({type:0,doc:c})})),new Er(e,t,ir.emptySet(t),a,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&so(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==r[s].type||!t[s].doc.isEqual(r[s].doc))return!1;return!0}}class hT{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class fT{constructor(){this.queries=ah(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){const s=$(t),i=s.queries;s.queries=ah(),i.forEach(((a,c)=>{for(const l of c.Sa)l.onError(r)}))})(this,new L(N.ABORTED,"Firestore shutting down"))}}function ah(){return new jn((n=>md(n)),so)}async function dT(n,e){const t=$(n);let r=3;const s=e.query;let i=t.queries.get(s);i?!i.ba()&&e.Da()&&(r=2):(i=new hT,r=e.Da()?0:1);try{switch(r){case 0:i.wa=await t.onListen(s,!0);break;case 1:i.wa=await t.onListen(s,!1);break;case 2:await t.onFirstRemoteStoreListen(s)}}catch(a){const c=Pc(a,`Initialization of query '${Qn(e.query)}' failed`);return void e.onError(c)}t.queries.set(s,i),i.Sa.push(e),e.va(t.onlineState),i.wa&&e.Fa(i.wa)&&Cc(t)}async function pT(n,e){const t=$(n),r=e.query;let s=3;const i=t.queries.get(r);if(i){const a=i.Sa.indexOf(e);a>=0&&(i.Sa.splice(a,1),i.Sa.length===0?s=e.Da()?0:1:!i.ba()&&e.Da()&&(s=2))}switch(s){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function mT(n,e){const t=$(n);let r=!1;for(const s of e){const i=s.query,a=t.queries.get(i);if(a){for(const c of a.Sa)c.Fa(s)&&(r=!0);a.wa=s}}r&&Cc(t)}function gT(n,e,t){const r=$(n),s=r.queries.get(e);if(s)for(const i of s.Sa)i.onError(t);r.queries.delete(e)}function Cc(n){n.Ca.forEach((e=>{e.next()}))}var Da,ch;(ch=Da||(Da={})).Ma="default",ch.Cache="cache";class _T{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Er(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const r=t!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Er.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Da.Cache}}class Qd{constructor(e){this.key=e}}class Xd{constructor(e){this.key=e}}class yT{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=W(),this.mutatedKeys=W(),this.eu=gd(e),this.tu=new ir(this.eu)}get nu(){return this.Ya}ru(e,t){const r=t?t.iu:new oh,s=t?t.tu:this.tu;let i=t?t.mutatedKeys:this.mutatedKeys,a=s,c=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,h=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal(((d,m)=>{const g=s.get(d),T=io(this.query,m)?m:null,S=!!g&&this.mutatedKeys.has(g.key),k=!!T&&(T.hasLocalMutations||this.mutatedKeys.has(T.key)&&T.hasCommittedMutations);let P=!1;g&&T?g.data.isEqual(T.data)?S!==k&&(r.track({type:3,doc:T}),P=!0):this.su(g,T)||(r.track({type:2,doc:T}),P=!0,(l&&this.eu(T,l)>0||h&&this.eu(T,h)<0)&&(c=!0)):!g&&T?(r.track({type:0,doc:T}),P=!0):g&&!T&&(r.track({type:1,doc:g}),P=!0,(l||h)&&(c=!0)),P&&(T?(a=a.add(T),i=k?i.add(d):i.delete(d)):(a=a.delete(d),i=i.delete(d)))})),this.query.limit!==null)for(;a.size>this.query.limit;){const d=this.query.limitType==="F"?a.last():a.first();a=a.delete(d.key),i=i.delete(d.key),r.track({type:1,doc:d})}return{tu:a,iu:r,Cs:c,mutatedKeys:i}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,s){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const a=e.iu.ya();a.sort(((d,m)=>(function(T,S){const k=P=>{switch(P){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return U(20277,{Rt:P})}};return k(T)-k(S)})(d.type,m.type)||this.eu(d.doc,m.doc))),this.ou(r),s=s??!1;const c=t&&!s?this._u():[],l=this.Xa.size===0&&this.current&&!s?1:0,h=l!==this.Za;return this.Za=l,a.length!==0||h?{snapshot:new Er(this.query,e.tu,i,a,e.mutatedKeys,l===0,h,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:c}:{au:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new oh,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=W(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))}));const t=[];return e.forEach((r=>{this.Xa.has(r)||t.push(new Xd(r))})),this.Xa.forEach((r=>{e.has(r)||t.push(new Qd(r))})),t}cu(e){this.Ya=e.Qs,this.Xa=W();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Er.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const kc="SyncEngine";class vT{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class ET{constructor(e){this.key=e,this.hu=!1}}class TT{constructor(e,t,r,s,i,a){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new jn((c=>md(c)),so),this.Iu=new Map,this.Eu=new Set,this.du=new ue(F.comparator),this.Au=new Map,this.Ru=new vc,this.Vu={},this.mu=new Map,this.fu=vr.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function IT(n,e,t=!0){const r=np(n);let s;const i=r.Tu.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.lu()):s=await Jd(r,e,t,!0),s}async function wT(n,e){const t=np(n);await Jd(t,e,!0,!1)}async function Jd(n,e,t,r){const s=await BE(n.localStore,pt(e)),i=s.targetId,a=n.sharedClientState.addLocalQueryTarget(i,t);let c;return r&&(c=await AT(n,e,i,a==="current",s.resumeToken)),n.isPrimaryClient&&t&&qd(n.remoteStore,s),c}async function AT(n,e,t,r,s){n.pu=(m,g,T)=>(async function(k,P,x,V){let M=P.view.ru(x);M.Cs&&(M=await eh(k.localStore,P.query,!1).then((({documents:I})=>P.view.ru(I,M))));const K=V&&V.targetChanges.get(P.targetId),X=V&&V.targetMismatches.get(P.targetId)!=null,Y=P.view.applyChanges(M,k.isPrimaryClient,K,X);return lh(k,P.targetId,Y.au),Y.snapshot})(n,m,g,T);const i=await eh(n.localStore,e,!0),a=new yT(e,i.Qs),c=a.ru(i.documents),l=Ns.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",s),h=a.applyChanges(c,n.isPrimaryClient,l);lh(n,t,h.au);const d=new vT(e,t,a);return n.Tu.set(e,d),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),h.snapshot}async function bT(n,e,t){const r=$(n),s=r.Tu.get(e),i=r.Iu.get(s.targetId);if(i.length>1)return r.Iu.set(s.targetId,i.filter((a=>!so(a,e)))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await ka(r.localStore,s.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(s.targetId),t&&wc(r.remoteStore,s.targetId),Va(r,s.targetId)})).catch(Dr)):(Va(r,s.targetId),await ka(r.localStore,s.targetId,!0))}async function RT(n,e){const t=$(n),r=t.Tu.get(e),s=t.Iu.get(r.targetId);t.isPrimaryClient&&s.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),wc(t.remoteStore,r.targetId))}async function ST(n,e,t){const r=OT(n);try{const s=await(function(a,c){const l=$(a),h=oe.now(),d=c.reduce(((T,S)=>T.add(S.key)),W());let m,g;return l.persistence.runTransaction("Locally write mutations","readwrite",(T=>{let S=Vt(),k=W();return l.Ns.getEntries(T,d).next((P=>{S=P,S.forEach(((x,V)=>{V.isValidDocument()||(k=k.add(x))}))})).next((()=>l.localDocuments.getOverlayedDocuments(T,S))).next((P=>{m=P;const x=[];for(const V of c){const M=Uv(V,m.get(V.key).overlayedDocument);M!=null&&x.push(new pn(V.key,M,cd(M.value.mapValue),rt.exists(!0)))}return l.mutationQueue.addMutationBatch(T,h,x,c)})).next((P=>{g=P;const x=P.applyToLocalDocumentSet(m,k);return l.documentOverlayCache.saveOverlays(T,P.batchId,x)}))})).then((()=>({batchId:g.batchId,changes:yd(m)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),(function(a,c,l){let h=a.Vu[a.currentUser.toKey()];h||(h=new ue(G)),h=h.insert(c,l),a.Vu[a.currentUser.toKey()]=h})(r,s.batchId,t),await Vs(r,s.changes),await ho(r.remoteStore)}catch(s){const i=Pc(s,"Failed to persist write");t.reject(i)}}async function Yd(n,e){const t=$(n);try{const r=await xE(t.localStore,e);e.targetChanges.forEach(((s,i)=>{const a=t.Au.get(i);a&&(ee(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?a.hu=!0:s.modifiedDocuments.size>0?ee(a.hu,14607):s.removedDocuments.size>0&&(ee(a.hu,42227),a.hu=!1))})),await Vs(t,r,e)}catch(r){await Dr(r)}}function uh(n,e,t){const r=$(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const s=[];r.Tu.forEach(((i,a)=>{const c=a.view.va(e);c.snapshot&&s.push(c.snapshot)})),(function(a,c){const l=$(a);l.onlineState=c;let h=!1;l.queries.forEach(((d,m)=>{for(const g of m.Sa)g.va(c)&&(h=!0)})),h&&Cc(l)})(r.eventManager,e),s.length&&r.Pu.H_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function PT(n,e,t){const r=$(n);r.sharedClientState.updateQueryState(e,"rejected",t);const s=r.Au.get(e),i=s&&s.key;if(i){let a=new ue(F.comparator);a=a.insert(i,De.newNoDocument(i,j.min()));const c=W().add(i),l=new co(j.min(),new Map,new ue(G),a,c);await Yd(r,l),r.du=r.du.remove(i),r.Au.delete(e),Nc(r)}else await ka(r.localStore,e,!1).then((()=>Va(r,e,t))).catch(Dr)}async function CT(n,e){const t=$(n),r=e.batch.batchId;try{const s=await LE(t.localStore,e);ep(t,r,null),Zd(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await Vs(t,s)}catch(s){await Dr(s)}}async function kT(n,e,t){const r=$(n);try{const s=await(function(a,c){const l=$(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",(h=>{let d;return l.mutationQueue.lookupMutationBatch(h,c).next((m=>(ee(m!==null,37113),d=m.keys(),l.mutationQueue.removeMutationBatch(h,m)))).next((()=>l.mutationQueue.performConsistencyCheck(h))).next((()=>l.documentOverlayCache.removeOverlaysForBatchId(h,d,c))).next((()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,d))).next((()=>l.localDocuments.getDocuments(h,d)))}))})(r.localStore,e);ep(r,e,t),Zd(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await Vs(r,s)}catch(s){await Dr(s)}}function Zd(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function ep(n,e,t){const r=$(n);let s=r.Vu[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(t?i.reject(t):i.resolve(),s=s.remove(e)),r.Vu[r.currentUser.toKey()]=s}}function Va(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Iu.get(e))n.Tu.delete(r),t&&n.Pu.yu(r,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((r=>{n.Ru.containsKey(r)||tp(n,r)}))}function tp(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(wc(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),Nc(n))}function lh(n,e,t){for(const r of t)r instanceof Qd?(n.Ru.addReference(r.key,e),NT(n,r)):r instanceof Xd?(O(kc,"Document no longer in limbo: "+r.key),n.Ru.removeReference(r.key,e),n.Ru.containsKey(r.key)||tp(n,r.key)):U(19791,{wu:r})}function NT(n,e){const t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Eu.has(r)||(O(kc,"New document in limbo: "+t),n.Eu.add(r),Nc(n))}function Nc(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new F(ie.fromString(e)),r=n.fu.next();n.Au.set(r,new ET(t)),n.du=n.du.insert(t,r),qd(n.remoteStore,new Qt(pt(dc(t.path)),r,"TargetPurposeLimboResolution",eo.ce))}}async function Vs(n,e,t){const r=$(n),s=[],i=[],a=[];r.Tu.isEmpty()||(r.Tu.forEach(((c,l)=>{a.push(r.pu(l,e,t).then((h=>{if((h||t)&&r.isPrimaryClient){const d=h?!h.fromCache:t?.targetChanges.get(l.targetId)?.current;r.sharedClientState.updateQueryState(l.targetId,d?"current":"not-current")}if(h){s.push(h);const d=Tc.As(l.targetId,h);i.push(d)}})))})),await Promise.all(a),r.Pu.H_(s),await(async function(l,h){const d=$(l);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",(m=>C.forEach(h,(g=>C.forEach(g.Es,(T=>d.persistence.referenceDelegate.addReference(m,g.targetId,T))).next((()=>C.forEach(g.ds,(T=>d.persistence.referenceDelegate.removeReference(m,g.targetId,T)))))))))}catch(m){if(!Vr(m))throw m;O(Ic,"Failed to update sequence numbers: "+m)}for(const m of h){const g=m.targetId;if(!m.fromCache){const T=d.Ms.get(g),S=T.snapshotVersion,k=T.withLastLimboFreeSnapshotVersion(S);d.Ms=d.Ms.insert(g,k)}}})(r.localStore,i))}async function DT(n,e){const t=$(n);if(!t.currentUser.isEqual(e)){O(kc,"User change. New user:",e.toKey());const r=await Ud(t.localStore,e);t.currentUser=e,(function(i,a){i.mu.forEach((c=>{c.forEach((l=>{l.reject(new L(N.CANCELLED,a))}))})),i.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Vs(t,r.Ls)}}function VT(n,e){const t=$(n),r=t.Au.get(e);if(r&&r.hu)return W().add(r.key);{let s=W();const i=t.Iu.get(e);if(!i)return s;for(const a of i){const c=t.Tu.get(a);s=s.unionWith(c.view.nu)}return s}}function np(n){const e=$(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Yd.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=VT.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=PT.bind(null,e),e.Pu.H_=mT.bind(null,e.eventManager),e.Pu.yu=gT.bind(null,e.eventManager),e}function OT(n){const e=$(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=CT.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=kT.bind(null,e),e}class Oi{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=uo(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return ME(this.persistence,new DE,e.initialUser,this.serializer)}Cu(e){return new Fd(Ec.mi,this.serializer)}Du(e){return new $E}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Oi.provider={build:()=>new Oi};class MT extends Oi{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){ee(this.persistence.referenceDelegate instanceof Di,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new _E(r,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?Be.withCacheSize(this.cacheSizeBytes):Be.DEFAULT;return new Fd((r=>Di.mi(r,t)),this.serializer)}}class Oa{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>uh(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=DT.bind(null,this.syncEngine),await lT(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new fT})()}createDatastore(e){const t=uo(e.databaseInfo.databaseId),r=(function(i){return new WE(i)})(e.databaseInfo);return(function(i,a,c,l){return new JE(i,a,c,l)})(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return(function(r,s,i,a,c){return new ZE(r,s,i,a,c)})(this.localStore,this.datastore,e.asyncQueue,(t=>uh(this.syncEngine,t,0)),(function(){return rh.v()?new rh:new qE})())}createSyncEngine(e,t){return(function(s,i,a,c,l,h,d){const m=new TT(s,i,a,c,l,h);return d&&(m.gu=!0),m})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const r=$(t);O(Mn,"RemoteStore shutting down."),r.Ea.add(5),await Ds(r),r.Aa.shutdown(),r.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Oa.provider={build:()=>new Oa};class LT{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Dt("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const hn="FirestoreClient";class xT{constructor(e,t,r,s,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=s,this.user=Ne.UNAUTHENTICATED,this.clientId=oc.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,(async a=>{O(hn,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a})),this.appCheckCredentials.start(r,(a=>(O(hn,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Sn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=Pc(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function ra(n,e){n.asyncQueue.verifyOperationInProgress(),O(hn,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener((async s=>{r.isEqual(s)||(await Ud(e.localStore,s),r=s)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function hh(n,e){n.asyncQueue.verifyOperationInProgress();const t=await FT(n);O(hn,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((r=>ih(e.remoteStore,r))),n.setAppCheckTokenChangeListener(((r,s)=>ih(e.remoteStore,s))),n._onlineComponents=e}async function FT(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){O(hn,"Using user provided OfflineComponentProvider");try{await ra(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(s){return s.name==="FirebaseError"?s.code===N.FAILED_PRECONDITION||s.code===N.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11})(t))throw t;mr("Error using user provided cache. Falling back to memory cache: "+t),await ra(n,new Oi)}}else O(hn,"Using default OfflineComponentProvider"),await ra(n,new MT(void 0));return n._offlineComponents}async function rp(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(O(hn,"Using user provided OnlineComponentProvider"),await hh(n,n._uninitializedComponentsProvider._online)):(O(hn,"Using default OnlineComponentProvider"),await hh(n,new Oa))),n._onlineComponents}function UT(n){return rp(n).then((e=>e.syncEngine))}async function fh(n){const e=await rp(n),t=e.eventManager;return t.onListen=IT.bind(null,e.syncEngine),t.onUnlisten=bT.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=wT.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=RT.bind(null,e.syncEngine),t}function sp(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const dh=new Map;const ip="firestore.googleapis.com",ph=!0;class mh{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new L(N.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=ip,this.ssl=ph}else this.host=e.host,this.ssl=e.ssl??ph;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=xd;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<mE)throw new L(N.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Yy("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=sp(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new L(N.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new L(N.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new L(N.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,s){return r.timeoutSeconds===s.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class fo{constructor(e,t,r,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new mh({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new L(N.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new L(N.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new mh(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new $y;switch(r.type){case"firstParty":return new Gy(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new L(N.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const r=dh.get(t);r&&(O("ComponentProvider","Removing Datastore"),dh.delete(t),r.terminate())})(this),Promise.resolve()}}function BT(n,e,t,r={}){n=nn(n,fo);const s=fn(e),i=n._getSettings(),a={...i,emulatorOptions:n._getEmulatorOptions()},c=`${e}:${t}`;s&&(ec(`https://${c}`),tc("Firestore",!0)),i.host!==ip&&i.host!==c&&mr("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...i,host:c,ssl:s,emulatorOptions:r};if(!Dn(l,a)&&(n._setSettings(l),r.mockUserToken)){let h,d;if(typeof r.mockUserToken=="string")h=r.mockUserToken,d=Ne.MOCK_USER;else{h=d_(r.mockUserToken,n._app?.options.projectId);const m=r.mockUserToken.sub||r.mockUserToken.user_id;if(!m)throw new L(N.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new Ne(m)}n._authCredentials=new qy(new Xf(h,d))}}class po{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new po(this.firestore,e,this._query)}}class ye{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new rn(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ye(this.firestore,e,this._key)}toJSON(){return{type:ye._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(Cs(t,ye._jsonSchema))return new ye(e,r||null,new F(ie.fromString(t.referencePath)))}}ye._jsonSchemaVersion="firestore/documentReference/1.0",ye._jsonSchema={type:de("string",ye._jsonSchemaVersion),referencePath:de("string")};class rn extends po{constructor(e,t,r){super(e,t,dc(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ye(this.firestore,null,new F(e))}withConverter(e){return new rn(this.firestore,e,this._path)}}function op(n,e,...t){if(n=pe(n),Jf("collection","path",e),n instanceof fo){const r=ie.fromString(e,...t);return Pl(r),new rn(n,null,r)}{if(!(n instanceof ye||n instanceof rn))throw new L(N.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(ie.fromString(e,...t));return Pl(r),new rn(n.firestore,null,r)}}function Dc(n,e,...t){if(n=pe(n),arguments.length===1&&(e=oc.newId()),Jf("doc","path",e),n instanceof fo){const r=ie.fromString(e,...t);return Sl(r),new ye(n,null,new F(r))}{if(!(n instanceof ye||n instanceof rn))throw new L(N.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(ie.fromString(e,...t));return Sl(r),new ye(n.firestore,n instanceof rn?n.converter:null,new F(r))}}const gh="AsyncQueue";class _h{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new jd(this,"async_queue_retry"),this._c=()=>{const r=na();r&&O(gh,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const t=na();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=na();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new Sn;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Vr(e))throw e;O(gh,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((r=>{throw this.nc=r,this.rc=!1,Dt("INTERNAL UNHANDLED ERROR: ",yh(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const s=Sc.createAndSchedule(this,e,t,r,(i=>this.hc(i)));return this.tc.push(s),s}uc(){this.nc&&U(47125,{Pc:yh(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,r)=>t.targetTimeMs-r.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function yh(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}function vh(n){return(function(t,r){if(typeof t!="object"||t===null)return!1;const s=t;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1})(n,["next","error","complete"])}class Tr extends fo{constructor(e,t,r,s){super(e,t,r,s),this.type="firestore",this._queue=new _h,this._persistenceKey=s?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new _h(e),this._firestoreClient=void 0,await e}}}function jT(n,e){const t=typeof n=="object"?n:sc(),r=typeof n=="string"?n:bi,s=Zi(t,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=Mf("firestore");i&&BT(s,...i)}return s}function ap(n){if(n._terminated)throw new L(N.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||$T(n),n._firestoreClient}function $T(n){const e=n._freezeSettings(),t=(function(s,i,a,c){return new uv(s,i,a,c.host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,sp(c.experimentalLongPollingOptions),c.useFetchStreams,c.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new xT(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(s){const i=s?._online.build();return{_offline:s?._offline.build(i),_online:i}})(n._componentsProvider))}class Ze{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Ze(Se.fromBase64String(e))}catch(t){throw new L(N.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Ze(Se.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Ze._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Cs(e,Ze._jsonSchema))return Ze.fromBase64String(e.bytes)}}Ze._jsonSchemaVersion="firestore/bytes/1.0",Ze._jsonSchema={type:de("string",Ze._jsonSchemaVersion),bytes:de("string")};class mo{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new L(N.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ae(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Vc{constructor(e){this._methodName=e}}class gt{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new L(N.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new L(N.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return G(this._lat,e._lat)||G(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:gt._jsonSchemaVersion}}static fromJSON(e){if(Cs(e,gt._jsonSchema))return new gt(e.latitude,e.longitude)}}gt._jsonSchemaVersion="firestore/geoPoint/1.0",gt._jsonSchema={type:de("string",gt._jsonSchemaVersion),latitude:de("number"),longitude:de("number")};class _t{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0})(this._values,e._values)}toJSON(){return{type:_t._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Cs(e,_t._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new _t(e.vectorValues);throw new L(N.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}_t._jsonSchemaVersion="firestore/vectorValue/1.0",_t._jsonSchema={type:de("string",_t._jsonSchemaVersion),vectorValues:de("object")};const qT=/^__.*__$/;class zT{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new pn(e,this.data,this.fieldMask,t,this.fieldTransforms):new ks(e,this.data,t,this.fieldTransforms)}}class cp{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new pn(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function up(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw U(40011,{Ac:n})}}class Oc{constructor(e,t,r,s,i,a){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Oc({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.gc(e),r}yc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Mi(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(up(this.Ac)&&qT.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class HT{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||uo(e)}Cc(e,t,r,s=!1){return new Oc({Ac:e,methodName:t,Dc:r,path:Ae.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function lp(n){const e=n._freezeSettings(),t=uo(n._databaseId);return new HT(n._databaseId,!!e.ignoreUndefinedProperties,t)}function GT(n,e,t,r,s,i={}){const a=n.Cc(i.merge||i.mergeFields?2:0,e,t,s);Mc("Data must be an object, but it was:",a,r);const c=hp(r,a);let l,h;if(i.merge)l=new Qe(a.fieldMask),h=a.fieldTransforms;else if(i.mergeFields){const d=[];for(const m of i.mergeFields){const g=Ma(e,m,t);if(!a.contains(g))throw new L(N.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);dp(d,g)||d.push(g)}l=new Qe(d),h=a.fieldTransforms.filter((m=>l.covers(m.field)))}else l=null,h=a.fieldTransforms;return new zT(new je(c),l,h)}class go extends Vc{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof go}}function WT(n,e,t,r){const s=n.Cc(1,e,t);Mc("Data must be an object, but it was:",s,r);const i=[],a=je.empty();dn(r,((l,h)=>{const d=Lc(e,l,t);h=pe(h);const m=s.yc(d);if(h instanceof go)i.push(d);else{const g=_o(h,m);g!=null&&(i.push(d),a.set(d,g))}}));const c=new Qe(i);return new cp(a,c,s.fieldTransforms)}function KT(n,e,t,r,s,i){const a=n.Cc(1,e,t),c=[Ma(e,r,t)],l=[s];if(i.length%2!=0)throw new L(N.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<i.length;g+=2)c.push(Ma(e,i[g])),l.push(i[g+1]);const h=[],d=je.empty();for(let g=c.length-1;g>=0;--g)if(!dp(h,c[g])){const T=c[g];let S=l[g];S=pe(S);const k=a.yc(T);if(S instanceof go)h.push(T);else{const P=_o(S,k);P!=null&&(h.push(T),d.set(T,P))}}const m=new Qe(h);return new cp(d,m,a.fieldTransforms)}function _o(n,e){if(fp(n=pe(n)))return Mc("Unsupported field value:",e,n),hp(n,e);if(n instanceof Vc)return(function(r,s){if(!up(s.Ac))throw s.Sc(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(r,s){const i=[];let a=0;for(const c of r){let l=_o(c,s.wc(a));l==null&&(l={nullValue:"NULL_VALUE"}),i.push(l),a++}return{arrayValue:{values:i}}})(n,e)}return(function(r,s){if((r=pe(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return Vv(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=oe.fromDate(r);return{timestampValue:Ni(s.serializer,i)}}if(r instanceof oe){const i=new oe(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Ni(s.serializer,i)}}if(r instanceof gt)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Ze)return{bytesValue:kd(s.serializer,r._byteString)};if(r instanceof ye){const i=s.databaseId,a=r.firestore._databaseId;if(!a.isEqual(i))throw s.Sc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:yc(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof _t)return(function(a,c){return{mapValue:{fields:{[od]:{stringValue:ad},[Ri]:{arrayValue:{values:a.toArray().map((h=>{if(typeof h!="number")throw c.Sc("VectorValues must only contain numeric values.");return pc(c.serializer,h)}))}}}}}})(r,s);throw s.Sc(`Unsupported field value: ${ac(r)}`)})(n,e)}function hp(n,e){const t={};return ed(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):dn(n,((r,s)=>{const i=_o(s,e.mc(r));i!=null&&(t[r]=i)})),{mapValue:{fields:t}}}function fp(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof oe||n instanceof gt||n instanceof Ze||n instanceof ye||n instanceof Vc||n instanceof _t)}function Mc(n,e,t){if(!fp(t)||!Yf(t)){const r=ac(t);throw r==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+r)}}function Ma(n,e,t){if((e=pe(e))instanceof mo)return e._internalPath;if(typeof e=="string")return Lc(n,e);throw Mi("Field path arguments must be of type string or ",n,!1,void 0,t)}const QT=new RegExp("[~\\*/\\[\\]]");function Lc(n,e,t){if(e.search(QT)>=0)throw Mi(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new mo(...e.split("."))._internalPath}catch{throw Mi(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Mi(n,e,t,r,s){const i=r&&!r.isEmpty(),a=s!==void 0;let c=`Function ${e}() called with invalid data`;t&&(c+=" (via `toFirestore()`)"),c+=". ";let l="";return(i||a)&&(l+=" (found",i&&(l+=` in field ${r}`),a&&(l+=` in document ${s}`),l+=")"),new L(N.INVALID_ARGUMENT,c+n+l)}function dp(n,e){return n.some((t=>t.isEqual(e)))}class pp{constructor(e,t,r,s,i){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new ye(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new XT(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(mp("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class XT extends pp{data(){return super.data()}}function mp(n,e){return typeof e=="string"?Lc(n,e):e instanceof mo?e._internalPath:e._delegate._internalPath}function JT(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new L(N.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class YT{convertValue(e,t="none"){switch(un(e)){case 0:return null;case 1:return e.booleanValue;case 2:return he(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(cn(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw U(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return dn(e,((s,i)=>{r[s]=this.convertValue(i,t)})),r}convertVectorValue(e){const t=e.fields?.[Ri].arrayValue?.values?.map((r=>he(r.doubleValue)));return new _t(t)}convertGeoPoint(e){return new gt(he(e.latitude),he(e.longitude))}convertArray(e,t){return(e.values||[]).map((r=>this.convertValue(r,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const r=no(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(vs(e));default:return null}}convertTimestamp(e){const t=an(e);return new oe(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=ie.fromString(e);ee(Ld(r),9688,{name:e});const s=new Es(r.get(1),r.get(3)),i=new F(r.popFirst(5));return s.isEqual(t)||Dt(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}function ZT(n,e,t){let r;return r=n?n.toFirestore(e):e,r}class ns{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Pn extends pp{constructor(e,t,r,s,i,a){super(e,t,r,s,a),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new di(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(mp("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new L(N.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Pn._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Pn._jsonSchemaVersion="firestore/documentSnapshot/1.0",Pn._jsonSchema={type:de("string",Pn._jsonSchemaVersion),bundleSource:de("string","DocumentSnapshot"),bundleName:de("string"),bundle:de("string")};class di extends Pn{data(e={}){return super.data(e)}}class or{constructor(e,t,r,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new ns(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((r=>{e.call(t,new di(this._firestore,this._userDataWriter,r.key,r,new ns(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new L(N.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(s,i){if(s._snapshot.oldDocs.isEmpty()){let a=0;return s._snapshot.docChanges.map((c=>{const l=new di(s._firestore,s._userDataWriter,c.doc.key,c.doc,new ns(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);return c.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}}))}{let a=s._snapshot.oldDocs;return s._snapshot.docChanges.filter((c=>i||c.type!==3)).map((c=>{const l=new di(s._firestore,s._userDataWriter,c.doc.key,c.doc,new ns(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);let h=-1,d=-1;return c.type!==0&&(h=a.indexOf(c.doc.key),a=a.delete(c.doc.key)),c.type!==1&&(a=a.add(c.doc),d=a.indexOf(c.doc.key)),{type:eI(c.type),doc:l,oldIndex:h,newIndex:d}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new L(N.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=or._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=oc.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],s=[];return this.docs.forEach((i=>{i._document!==null&&(t.push(i._document),r.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),s.push(i.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function eI(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return U(61501,{type:n})}}or._jsonSchemaVersion="firestore/querySnapshot/1.0",or._jsonSchema={type:de("string",or._jsonSchemaVersion),bundleSource:de("string","QuerySnapshot"),bundleName:de("string"),bundle:de("string")};class gp extends YT{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ze(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new ye(this.firestore,null,t)}}function tI(n,e,t,...r){n=nn(n,ye);const s=nn(n.firestore,Tr),i=lp(s);let a;return a=typeof(e=pe(e))=="string"||e instanceof mo?KT(i,"updateDoc",n._key,e,t,r):WT(i,"updateDoc",n._key,e),xc(s,[a.toMutation(n._key,rt.exists(!0))])}function nI(n){return xc(nn(n.firestore,Tr),[new mc(n._key,rt.none())])}function rI(n,e){const t=nn(n.firestore,Tr),r=Dc(n),s=ZT(n.converter,e);return xc(t,[GT(lp(n.firestore),"addDoc",r._key,s,n.converter!==null,{}).toMutation(r._key,rt.exists(!1))]).then((()=>r))}function sI(n,...e){n=pe(n);let t={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||vh(e[r])||(t=e[r++]);const s={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(vh(e[r])){const l=e[r];e[r]=l.next?.bind(l),e[r+1]=l.error?.bind(l),e[r+2]=l.complete?.bind(l)}let i,a,c;if(n instanceof ye)a=nn(n.firestore,Tr),c=dc(n._key.path),i={next:l=>{e[r]&&e[r](iI(a,n,l))},error:e[r+1],complete:e[r+2]};else{const l=nn(n,po);a=nn(l.firestore,Tr),c=l._query;const h=new gp(a);i={next:d=>{e[r]&&e[r](new or(a,h,l,d))},error:e[r+1],complete:e[r+2]},JT(n._query)}return(function(h,d,m,g){const T=new LT(g),S=new _T(d,T,m);return h.asyncQueue.enqueueAndForget((async()=>dT(await fh(h),S))),()=>{T.Nu(),h.asyncQueue.enqueueAndForget((async()=>pT(await fh(h),S)))}})(ap(a),c,s,i)}function xc(n,e){return(function(r,s){const i=new Sn;return r.asyncQueue.enqueueAndForget((async()=>ST(await UT(r),s,i))),i.promise})(ap(n),e)}function iI(n,e,t){const r=t.docs.get(e._key),s=new gp(n);return new Pn(n,s,e._key,r,new ns(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(s){Nr=s})(kr),Vn(new sn("firestore",((r,{instanceIdentifier:s,options:i})=>{const a=r.getProvider("app").getImmediate(),c=new Tr(new zy(r.getProvider("auth-internal")),new Wy(a,r.getProvider("app-check-internal")),(function(h,d){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new L(N.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Es(h.options.projectId,d)})(a,s),a);return i={useFetchStreams:t,...i},c._setSettings(i),c}),"PUBLIC").setMultipleInstances(!0)),dt(wl,Al,e),dt(wl,Al,"esm2020")})();function _p(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const oI=_p,yp=new Ss("auth","Firebase",_p());const Li=new nc("@firebase/auth");function aI(n,...e){Li.logLevel<=H.WARN&&Li.warn(`Auth (${kr}): ${n}`,...e)}function pi(n,...e){Li.logLevel<=H.ERROR&&Li.error(`Auth (${kr}): ${n}`,...e)}function It(n,...e){throw Uc(n,...e)}function st(n,...e){return Uc(n,...e)}function Fc(n,e,t){const r={...oI(),[e]:t};return new Ss("auth","Firebase",r).create(e,{appName:n.name})}function Cn(n){return Fc(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function cI(n,e,t){const r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&It(n,"argument-error"),Fc(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Uc(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return yp.create(n,...e)}function B(n,e,...t){if(!n)throw Uc(e,...t)}function Pt(n){const e="INTERNAL ASSERTION FAILED: "+n;throw pi(e),new Error(e)}function Ot(n,e){n||Pt(e)}function La(){return typeof self<"u"&&self.location?.href||""}function uI(){return Eh()==="http:"||Eh()==="https:"}function Eh(){return typeof self<"u"&&self.location?.protocol||null}function lI(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(uI()||v_()||"connection"in navigator)?navigator.onLine:!0}function hI(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class Os{constructor(e,t){this.shortDelay=e,this.longDelay=t,Ot(t>e,"Short delay should be less than long delay!"),this.isMobile=g_()||E_()}get(){return lI()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Bc(n,e){Ot(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class vp{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Pt("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Pt("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Pt("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const fI={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const dI=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],pI=new Os(3e4,6e4);function jc(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Mr(n,e,t,r,s={}){return Ep(n,s,async()=>{let i={},a={};r&&(e==="GET"?a=r:i={body:JSON.stringify(r)});const c=Ps({key:n.config.apiKey,...a}).slice(1),l=await n._getAdditionalHeaders();l["Content-Type"]="application/json",n.languageCode&&(l["X-Firebase-Locale"]=n.languageCode);const h={method:e,headers:l,...i};return y_()||(h.referrerPolicy="no-referrer"),n.emulatorConfig&&fn(n.emulatorConfig.host)&&(h.credentials="include"),vp.fetch()(await Tp(n,n.config.apiHost,t,c),h)})}async function Ep(n,e,t){n._canInitEmulator=!1;const r={...fI,...e};try{const s=new gI(n),i=await Promise.race([t(),s.promise]);s.clearNetworkTimeout();const a=await i.json();if("needConfirmation"in a)throw ii(n,"account-exists-with-different-credential",a);if(i.ok&&!("errorMessage"in a))return a;{const c=i.ok?a.errorMessage:a.error.message,[l,h]=c.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw ii(n,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw ii(n,"email-already-in-use",a);if(l==="USER_DISABLED")throw ii(n,"user-disabled",a);const d=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw Fc(n,d,h);It(n,d)}}catch(s){if(s instanceof At)throw s;It(n,"network-request-failed",{message:String(s)})}}async function mI(n,e,t,r,s={}){const i=await Mr(n,e,t,r,s);return"mfaPendingCredential"in i&&It(n,"multi-factor-auth-required",{_serverResponse:i}),i}async function Tp(n,e,t,r){const s=`${e}${t}?${r}`,i=n,a=i.config.emulator?Bc(n.config,s):`${n.config.apiScheme}://${s}`;return dI.includes(t)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(a).toString():a}class gI{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(st(this.auth,"network-request-failed")),pI.get())})}}function ii(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const s=st(n,e,r);return s.customData._tokenResponse=t,s}async function _I(n,e){return Mr(n,"POST","/v1/accounts:delete",e)}async function xi(n,e){return Mr(n,"POST","/v1/accounts:lookup",e)}function fs(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function yI(n,e=!1){const t=pe(n),r=await t.getIdToken(e),s=$c(r);B(s&&s.exp&&s.auth_time&&s.iat,t.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,a=i?.sign_in_provider;return{claims:s,token:r,authTime:fs(sa(s.auth_time)),issuedAtTime:fs(sa(s.iat)),expirationTime:fs(sa(s.exp)),signInProvider:a||null,signInSecondFactor:i?.sign_in_second_factor||null}}function sa(n){return Number(n)*1e3}function $c(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return pi("JWT malformed, contained fewer than 3 sections"),null;try{const s=Vf(t);return s?JSON.parse(s):(pi("Failed to decode base64 JWT payload"),null)}catch(s){return pi("Caught error parsing JWT payload as JSON",s?.toString()),null}}function Th(n){const e=$c(n);return B(e,"internal-error"),B(typeof e.exp<"u","internal-error"),B(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function As(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof At&&vI(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function vI({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class EI{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class xa{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=fs(this.lastLoginAt),this.creationTime=fs(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Fi(n){const e=n.auth,t=await n.getIdToken(),r=await As(n,xi(e,{idToken:t}));B(r?.users.length,e,"internal-error");const s=r.users[0];n._notifyReloadListener(s);const i=s.providerUserInfo?.length?Ip(s.providerUserInfo):[],a=II(n.providerData,i),c=n.isAnonymous,l=!(n.email&&s.passwordHash)&&!a?.length,h=c?l:!1,d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new xa(s.createdAt,s.lastLoginAt),isAnonymous:h};Object.assign(n,d)}async function TI(n){const e=pe(n);await Fi(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function II(n,e){return[...n.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function Ip(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function wI(n,e){const t=await Ep(n,{},async()=>{const r=Ps({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=n.config,a=await Tp(n,s,"/v1/token",`key=${i}`),c=await n._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:c,body:r};return n.emulatorConfig&&fn(n.emulatorConfig.host)&&(l.credentials="include"),vp.fetch()(a,l)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function AI(n,e){return Mr(n,"POST","/v2/accounts:revokeToken",jc(n,e))}class ar{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){B(e.idToken,"internal-error"),B(typeof e.idToken<"u","internal-error"),B(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Th(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){B(e.length!==0,"internal-error");const t=Th(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(B(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:s,expiresIn:i}=await wI(e,t);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:s,expirationTime:i}=t,a=new ar;return r&&(B(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),s&&(B(typeof s=="string","internal-error",{appName:e}),a.accessToken=s),i&&(B(typeof i=="number","internal-error",{appName:e}),a.expirationTime=i),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ar,this.toJSON())}_performRefresh(){return Pt("not implemented")}}function Ht(n,e){B(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class nt{constructor({uid:e,auth:t,stsTokenManager:r,...s}){this.providerId="firebase",this.proactiveRefresh=new EI(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new xa(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await As(this,this.stsTokenManager.getToken(this.auth,e));return B(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return yI(this,e)}reload(){return TI(this)}_assign(e){this!==e&&(B(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new nt({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){B(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await Fi(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Ye(this.auth.app))return Promise.reject(Cn(this.auth));const e=await this.getIdToken();return await As(this,_I(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const r=t.displayName??void 0,s=t.email??void 0,i=t.phoneNumber??void 0,a=t.photoURL??void 0,c=t.tenantId??void 0,l=t._redirectEventId??void 0,h=t.createdAt??void 0,d=t.lastLoginAt??void 0,{uid:m,emailVerified:g,isAnonymous:T,providerData:S,stsTokenManager:k}=t;B(m&&k,e,"internal-error");const P=ar.fromJSON(this.name,k);B(typeof m=="string",e,"internal-error"),Ht(r,e.name),Ht(s,e.name),B(typeof g=="boolean",e,"internal-error"),B(typeof T=="boolean",e,"internal-error"),Ht(i,e.name),Ht(a,e.name),Ht(c,e.name),Ht(l,e.name),Ht(h,e.name),Ht(d,e.name);const x=new nt({uid:m,auth:e,email:s,emailVerified:g,displayName:r,isAnonymous:T,photoURL:a,phoneNumber:i,tenantId:c,stsTokenManager:P,createdAt:h,lastLoginAt:d});return S&&Array.isArray(S)&&(x.providerData=S.map(V=>({...V}))),l&&(x._redirectEventId=l),x}static async _fromIdTokenResponse(e,t,r=!1){const s=new ar;s.updateFromServerResponse(t);const i=new nt({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await Fi(i),i}static async _fromGetAccountInfoResponse(e,t,r){const s=t.users[0];B(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?Ip(s.providerUserInfo):[],a=!(s.email&&s.passwordHash)&&!i?.length,c=new ar;c.updateFromIdToken(r);const l=new nt({uid:s.localId,auth:e,stsTokenManager:c,isAnonymous:a}),h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new xa(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!i?.length};return Object.assign(l,h),l}}const Ih=new Map;function Ct(n){Ot(n instanceof Function,"Expected a class definition");let e=Ih.get(n);return e?(Ot(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Ih.set(n,e),e)}class wp{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}wp.type="NONE";const wh=wp;function mi(n,e,t){return`firebase:${n}:${e}:${t}`}class cr{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=mi(this.userKey,s.apiKey,i),this.fullPersistenceKey=mi("persistence",s.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await xi(this.auth,{idToken:e}).catch(()=>{});return t?nt._fromGetAccountInfoResponse(this.auth,t,e):null}return nt._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new cr(Ct(wh),e,r);const s=(await Promise.all(t.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let i=s[0]||Ct(wh);const a=mi(r,e.config.apiKey,e.name);let c=null;for(const h of t)try{const d=await h._get(a);if(d){let m;if(typeof d=="string"){const g=await xi(e,{idToken:d}).catch(()=>{});if(!g)break;m=await nt._fromGetAccountInfoResponse(e,g,d)}else m=nt._fromJSON(e,d);h!==i&&(c=m),i=h;break}}catch{}const l=s.filter(h=>h._shouldAllowMigration);return!i._shouldAllowMigration||!l.length?new cr(i,e,r):(i=l[0],c&&await i._set(a,c.toJSON()),await Promise.all(t.map(async h=>{if(h!==i)try{await h._remove(a)}catch{}})),new cr(i,e,r))}}function Ah(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Sp(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Ap(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Cp(e))return"Blackberry";if(kp(e))return"Webos";if(bp(e))return"Safari";if((e.includes("chrome/")||Rp(e))&&!e.includes("edge/"))return"Chrome";if(Pp(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function Ap(n=Oe()){return/firefox\//i.test(n)}function bp(n=Oe()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Rp(n=Oe()){return/crios\//i.test(n)}function Sp(n=Oe()){return/iemobile/i.test(n)}function Pp(n=Oe()){return/android/i.test(n)}function Cp(n=Oe()){return/blackberry/i.test(n)}function kp(n=Oe()){return/webos/i.test(n)}function qc(n=Oe()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function bI(n=Oe()){return qc(n)&&!!window.navigator?.standalone}function RI(){return T_()&&document.documentMode===10}function Np(n=Oe()){return qc(n)||Pp(n)||kp(n)||Cp(n)||/windows phone/i.test(n)||Sp(n)}function Dp(n,e=[]){let t;switch(n){case"Browser":t=Ah(Oe());break;case"Worker":t=`${Ah(Oe())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${kr}/${r}`}class SI{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=i=>new Promise((a,c)=>{try{const l=e(i);a(l)}catch(l){c(l)}});r.onAbort=t,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const s of t)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}}async function PI(n,e={}){return Mr(n,"GET","/v2/passwordPolicy",jc(n,e))}const CI=6;class kI{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??CI,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),s&&(t.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}class NI{constructor(e,t,r,s){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new bh(this),this.idTokenSubscription=new bh(this),this.beforeStateQueue=new SI(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=yp,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Ct(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await cr.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await xi(this,{idToken:e}),r=await nt._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Ye(this.app)){const i=this.app.settings.authIdToken;return i?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(i).then(a,a))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let r=t,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const i=this.redirectUser?._redirectEventId,a=r?._redirectEventId,c=await this.tryRedirectSignIn(e);(!i||i===a)&&c?.user&&(r=c.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(i){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(i))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return B(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Fi(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=hI()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Ye(this.app))return Promise.reject(Cn(this));const t=e?pe(e):null;return t&&B(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&B(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Ye(this.app)?Promise.reject(Cn(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Ye(this.app)?Promise.reject(Cn(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ct(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await PI(this),t=new kI(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Ss("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await AI(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Ct(e)||this._popupRedirectResolver;B(t,this,"argument-error"),this.redirectPersistenceManager=await cr.create(this,[Ct(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,s){if(this._deleted)return()=>{};const i=typeof t=="function"?t:t.next.bind(t);let a=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(B(c,this,"internal-error"),c.then(()=>{a||i(this.currentUser)}),typeof t=="function"){const l=e.addObserver(t,r,s);return()=>{a=!0,l()}}else{const l=e.addObserver(t);return()=>{a=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return B(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Dp(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(Ye(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&aI(`Error while retrieving App Check token: ${e.error}`),e?.token}}function yo(n){return pe(n)}class bh{constructor(e){this.auth=e,this.observer=null,this.addObserver=C_(t=>this.observer=t)}get next(){return B(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let zc={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function DI(n){zc=n}function VI(n){return zc.loadJS(n)}function OI(){return zc.gapiScript}function MI(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function LI(n,e){const t=Zi(n,"auth");if(t.isInitialized()){const s=t.getImmediate(),i=t.getOptions();if(Dn(i,e??{}))return s;It(s,"already-initialized")}return t.initialize({options:e})}function xI(n,e){const t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(Ct);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function FI(n,e,t){const r=yo(n);B(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=Vp(e),{host:a,port:c}=UI(e),l=c===null?"":`:${c}`,h={url:`${i}//${a}${l}/`},d=Object.freeze({host:a,port:c,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){B(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),B(Dn(h,r.config.emulator)&&Dn(d,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=h,r.emulatorConfig=d,r.settings.appVerificationDisabledForTesting=!0,fn(a)?(ec(`${i}//${a}${l}`),tc("Auth",!0)):BI()}function Vp(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function UI(n){const e=Vp(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:Rh(r.substr(i.length+1))}}else{const[i,a]=r.split(":");return{host:i,port:Rh(a)}}}function Rh(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function BI(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class Op{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Pt("not implemented")}_getIdTokenResponse(e){return Pt("not implemented")}_linkToIdToken(e,t){return Pt("not implemented")}_getReauthenticationResolver(e){return Pt("not implemented")}}async function ur(n,e){return mI(n,"POST","/v1/accounts:signInWithIdp",jc(n,e))}const jI="http://localhost";class Ln extends Op{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Ln(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):It("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,...i}=t;if(!r||!s)return null;const a=new Ln(r,s);return a.idToken=i.idToken||void 0,a.accessToken=i.accessToken||void 0,a.secret=i.secret,a.nonce=i.nonce,a.pendingToken=i.pendingToken||null,a}_getIdTokenResponse(e){const t=this.buildRequest();return ur(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,ur(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,ur(e,t)}buildRequest(){const e={requestUri:jI,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Ps(t)}return e}}class Hc{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Ms extends Hc{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Gt extends Ms{constructor(){super("facebook.com")}static credential(e){return Ln._fromParams({providerId:Gt.PROVIDER_ID,signInMethod:Gt.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Gt.credentialFromTaggedObject(e)}static credentialFromError(e){return Gt.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Gt.credential(e.oauthAccessToken)}catch{return null}}}Gt.FACEBOOK_SIGN_IN_METHOD="facebook.com";Gt.PROVIDER_ID="facebook.com";class St extends Ms{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Ln._fromParams({providerId:St.PROVIDER_ID,signInMethod:St.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return St.credentialFromTaggedObject(e)}static credentialFromError(e){return St.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return St.credential(t,r)}catch{return null}}}St.GOOGLE_SIGN_IN_METHOD="google.com";St.PROVIDER_ID="google.com";class Wt extends Ms{constructor(){super("github.com")}static credential(e){return Ln._fromParams({providerId:Wt.PROVIDER_ID,signInMethod:Wt.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Wt.credentialFromTaggedObject(e)}static credentialFromError(e){return Wt.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Wt.credential(e.oauthAccessToken)}catch{return null}}}Wt.GITHUB_SIGN_IN_METHOD="github.com";Wt.PROVIDER_ID="github.com";class Kt extends Ms{constructor(){super("twitter.com")}static credential(e,t){return Ln._fromParams({providerId:Kt.PROVIDER_ID,signInMethod:Kt.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Kt.credentialFromTaggedObject(e)}static credentialFromError(e){return Kt.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return Kt.credential(t,r)}catch{return null}}}Kt.TWITTER_SIGN_IN_METHOD="twitter.com";Kt.PROVIDER_ID="twitter.com";class Ir{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,s=!1){const i=await nt._fromIdTokenResponse(e,r,s),a=Sh(r);return new Ir({user:i,providerId:a,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const s=Sh(r);return new Ir({user:e,providerId:s,_tokenResponse:r,operationType:t})}}function Sh(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class Ui extends At{constructor(e,t,r,s){super(t.code,t.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,Ui.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,s){return new Ui(e,t,r,s)}}function Mp(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Ui._fromErrorAndOperation(n,i,e,r):i})}async function $I(n,e,t=!1){const r=await As(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Ir._forOperation(n,"link",r)}async function qI(n,e,t=!1){const{auth:r}=n;if(Ye(r.app))return Promise.reject(Cn(r));const s="reauthenticate";try{const i=await As(n,Mp(r,s,e,n),t);B(i.idToken,r,"internal-error");const a=$c(i.idToken);B(a,r,"internal-error");const{sub:c}=a;return B(n.uid===c,r,"user-mismatch"),Ir._forOperation(n,s,i)}catch(i){throw i?.code==="auth/user-not-found"&&It(r,"user-mismatch"),i}}async function zI(n,e,t=!1){if(Ye(n.app))return Promise.reject(Cn(n));const r="signIn",s=await Mp(n,r,e),i=await Ir._fromIdTokenResponse(n,r,s);return t||await n._updateCurrentUser(i.user),i}function HI(n,e,t,r){return pe(n).onIdTokenChanged(e,t,r)}function GI(n,e,t){return pe(n).beforeAuthStateChanged(e,t)}function WI(n,e,t,r){return pe(n).onAuthStateChanged(e,t,r)}function KI(n){return pe(n).signOut()}const Bi="__sak";class Lp{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Bi,"1"),this.storage.removeItem(Bi),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const QI=1e3,XI=10;class xp extends Lp{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Np(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),s=this.localCache[t];r!==s&&e(t,s,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((a,c,l)=>{this.notifyListeners(a,l)});return}const r=e.key;t?this.detachListener():this.stopPolling();const s=()=>{const a=this.storage.getItem(r);!t&&this.localCache[r]===a||this.notifyListeners(r,a)},i=this.storage.getItem(r);RI()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,XI):s()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},QI)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}xp.type="LOCAL";const JI=xp;class Fp extends Lp{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Fp.type="SESSION";const Up=Fp;function YI(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class vo{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(s=>s.isListeningto(e));if(t)return t;const r=new vo(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:s,data:i}=t.data,a=this.handlersMap[s];if(!a?.size)return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const c=Array.from(a).map(async h=>h(t.origin,i)),l=await YI(c);t.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:l})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}vo.receivers=[];function Gc(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}class ZI{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,a;return new Promise((c,l)=>{const h=Gc("",20);s.port1.start();const d=setTimeout(()=>{l(new Error("unsupported_event"))},r);a={messageChannel:s,onMessage(m){const g=m;if(g.data.eventId===h)switch(g.data.status){case"ack":clearTimeout(d),i=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),c(g.data.response);break;default:clearTimeout(d),clearTimeout(i),l(new Error("invalid_response"));break}}},this.handlers.add(a),s.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:h,data:t},[s.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}function yt(){return window}function ew(n){yt().location.href=n}function Bp(){return typeof yt().WorkerGlobalScope<"u"&&typeof yt().importScripts=="function"}async function tw(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function nw(){return navigator?.serviceWorker?.controller||null}function rw(){return Bp()?self:null}const jp="firebaseLocalStorageDb",sw=1,ji="firebaseLocalStorage",$p="fbase_key";class Ls{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Eo(n,e){return n.transaction([ji],e?"readwrite":"readonly").objectStore(ji)}function iw(){const n=indexedDB.deleteDatabase(jp);return new Ls(n).toPromise()}function Fa(){const n=indexedDB.open(jp,sw);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(ji,{keyPath:$p})}catch(s){t(s)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(ji)?e(r):(r.close(),await iw(),e(await Fa()))})})}async function Ph(n,e,t){const r=Eo(n,!0).put({[$p]:e,value:t});return new Ls(r).toPromise()}async function ow(n,e){const t=Eo(n,!1).get(e),r=await new Ls(t).toPromise();return r===void 0?null:r.value}function Ch(n,e){const t=Eo(n,!0).delete(e);return new Ls(t).toPromise()}const aw=800,cw=3;class qp{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Fa(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>cw)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Bp()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=vo._getInstance(rw()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await tw(),!this.activeServiceWorker)return;this.sender=new ZI(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||nw()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Fa();return await Ph(e,Bi,"1"),await Ch(e,Bi),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>Ph(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>ow(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Ch(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=Eo(s,!1).getAll();return new Ls(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),t.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),t.push(s));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),aw)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}qp.type="LOCAL";const uw=qp;new Os(3e4,6e4);function zp(n,e){return e?Ct(e):(B(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class Wc extends Op{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ur(e,this._buildIdpRequest())}_linkToIdToken(e,t){return ur(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return ur(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function lw(n){return zI(n.auth,new Wc(n),n.bypassAuthState)}function hw(n){const{auth:e,user:t}=n;return B(t,e,"internal-error"),qI(t,new Wc(n),n.bypassAuthState)}async function fw(n){const{auth:e,user:t}=n;return B(t,e,"internal-error"),$I(t,new Wc(n),n.bypassAuthState)}class Hp{constructor(e,t,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:s,tenantId:i,error:a,type:c}=e;if(a){this.reject(a);return}const l={auth:this.auth,requestUri:t,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(l))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return lw;case"linkViaPopup":case"linkViaRedirect":return fw;case"reauthViaPopup":case"reauthViaRedirect":return hw;default:It(this.auth,"internal-error")}}resolve(e){Ot(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ot(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const dw=new Os(2e3,1e4);async function pw(n,e,t){if(Ye(n.app))return Promise.reject(st(n,"operation-not-supported-in-this-environment"));const r=yo(n);cI(n,e,Hc);const s=zp(r,t);return new wn(r,"signInViaPopup",e,s).executeNotNull()}class wn extends Hp{constructor(e,t,r,s,i){super(e,t,s,i),this.provider=r,this.authWindow=null,this.pollId=null,wn.currentPopupAction&&wn.currentPopupAction.cancel(),wn.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return B(e,this.auth,"internal-error"),e}async onExecution(){Ot(this.filter.length===1,"Popup operations only handle one event");const e=Gc();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(st(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(st(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,wn.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(st(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,dw.get())};e()}}wn.currentPopupAction=null;const mw="pendingRedirect",gi=new Map;class gw extends Hp{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=gi.get(this.auth._key());if(!e){try{const r=await _w(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}gi.set(this.auth._key(),e)}return this.bypassAuthState||gi.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function _w(n,e){const t=Ew(e),r=vw(n);if(!await r._isAvailable())return!1;const s=await r._get(t)==="true";return await r._remove(t),s}function yw(n,e){gi.set(n._key(),e)}function vw(n){return Ct(n._redirectPersistence)}function Ew(n){return mi(mw,n.config.apiKey,n.name)}async function Tw(n,e,t=!1){if(Ye(n.app))return Promise.reject(Cn(n));const r=yo(n),s=zp(r,e),a=await new gw(r,s,t).execute();return a&&!t&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,e)),a}const Iw=600*1e3;class ww{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Aw(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!Gp(e)){const r=e.error.code?.split("auth/")[1]||"internal-error";t.onError(st(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Iw&&this.cachedEventUids.clear(),this.cachedEventUids.has(kh(e))}saveEventToCache(e){this.cachedEventUids.add(kh(e)),this.lastProcessedEventTime=Date.now()}}function kh(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function Gp({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function Aw(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Gp(n);default:return!1}}async function bw(n,e={}){return Mr(n,"GET","/v1/projects",e)}const Rw=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Sw=/^https?/;async function Pw(n){if(n.config.emulator)return;const{authorizedDomains:e}=await bw(n);for(const t of e)try{if(Cw(t))return}catch{}It(n,"unauthorized-domain")}function Cw(n){const e=La(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const a=new URL(n);return a.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&a.hostname===r}if(!Sw.test(t))return!1;if(Rw.test(n))return r===n;const s=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}const kw=new Os(3e4,6e4);function Nh(){const n=yt().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function Nw(n){return new Promise((e,t)=>{function r(){Nh(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Nh(),t(st(n,"network-request-failed"))},timeout:kw.get()})}if(yt().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(yt().gapi?.load)r();else{const s=MI("iframefcb");return yt()[s]=()=>{gapi.load?r():t(st(n,"network-request-failed"))},VI(`${OI()}?onload=${s}`).catch(i=>t(i))}}).catch(e=>{throw _i=null,e})}let _i=null;function Dw(n){return _i=_i||Nw(n),_i}const Vw=new Os(5e3,15e3),Ow="__/auth/iframe",Mw="emulator/auth/iframe",Lw={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},xw=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Fw(n){const e=n.config;B(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Bc(e,Mw):`https://${n.config.authDomain}/${Ow}`,r={apiKey:e.apiKey,appName:n.name,v:kr},s=xw.get(n.config.apiHost);s&&(r.eid=s);const i=n._getFrameworks();return i.length&&(r.fw=i.join(",")),`${t}?${Ps(r).slice(1)}`}async function Uw(n){const e=await Dw(n),t=yt().gapi;return B(t,n,"internal-error"),e.open({where:document.body,url:Fw(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Lw,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const a=st(n,"network-request-failed"),c=yt().setTimeout(()=>{i(a)},Vw.get());function l(){yt().clearTimeout(c),s(r)}r.ping(l).then(l,()=>{i(a)})}))}const Bw={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},jw=500,$w=600,qw="_blank",zw="http://localhost";class Dh{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function Hw(n,e,t,r=jw,s=$w){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let c="";const l={...Bw,width:r.toString(),height:s.toString(),top:i,left:a},h=Oe().toLowerCase();t&&(c=Rp(h)?qw:t),Ap(h)&&(e=e||zw,l.scrollbars="yes");const d=Object.entries(l).reduce((g,[T,S])=>`${g}${T}=${S},`,"");if(bI(h)&&c!=="_self")return Gw(e||"",c),new Dh(null);const m=window.open(e||"",c,d);B(m,n,"popup-blocked");try{m.focus()}catch{}return new Dh(m)}function Gw(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}const Ww="__/auth/handler",Kw="emulator/auth/handler",Qw=encodeURIComponent("fac");async function Vh(n,e,t,r,s,i){B(n.config.authDomain,n,"auth-domain-config-required"),B(n.config.apiKey,n,"invalid-api-key");const a={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:kr,eventId:s};if(e instanceof Hc){e.setDefaultLanguage(n.languageCode),a.providerId=e.providerId||"",P_(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,m]of Object.entries({}))a[d]=m}if(e instanceof Ms){const d=e.getScopes().filter(m=>m!=="");d.length>0&&(a.scopes=d.join(","))}n.tenantId&&(a.tid=n.tenantId);const c=a;for(const d of Object.keys(c))c[d]===void 0&&delete c[d];const l=await n._getAppCheckToken(),h=l?`#${Qw}=${encodeURIComponent(l)}`:"";return`${Xw(n)}?${Ps(c).slice(1)}${h}`}function Xw({config:n}){return n.emulator?Bc(n,Kw):`https://${n.authDomain}/${Ww}`}const ia="webStorageSupport";class Jw{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Up,this._completeRedirectFn=Tw,this._overrideRedirectResult=yw}async _openPopup(e,t,r,s){Ot(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const i=await Vh(e,t,r,La(),s);return Hw(e,i,Gc())}async _openRedirect(e,t,r,s){await this._originValidation(e);const i=await Vh(e,t,r,La(),s);return ew(i),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:s,promise:i}=this.eventManagers[t];return s?Promise.resolve(s):(Ot(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await Uw(e),r=new ww(e);return t.register("authEvent",s=>(B(s?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(ia,{type:ia},s=>{const i=s?.[0]?.[ia];i!==void 0&&t(!!i),It(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=Pw(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Np()||bp()||qc()}}const Yw=Jw;var Oh="@firebase/auth",Mh="1.11.1";class Zw{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){B(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function eA(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function tA(n){Vn(new sn("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:a,authDomain:c}=r.options;B(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:a,authDomain:c,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Dp(n)},h=new NI(r,s,i,l);return xI(h,t),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Vn(new sn("auth-internal",e=>{const t=yo(e.getProvider("auth").getImmediate());return(r=>new Zw(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),dt(Oh,Mh,eA(n)),dt(Oh,Mh,"esm2020")}const nA=300,rA=xf("authIdTokenMaxAge")||nA;let Lh=null;const sA=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>rA)return;const s=t?.token;Lh!==s&&(Lh=s,await fetch(n,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function iA(n=sc()){const e=Zi(n,"auth");if(e.isInitialized())return e.getImmediate();const t=LI(n,{popupRedirectResolver:Yw,persistence:[uw,JI,Up]}),r=xf("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const a=sA(i.toString());GI(t,a,()=>a(t.currentUser)),HI(t,c=>a(c))}}const s=Of("auth");return s&&FI(t,`http://${s}`),t}function oA(){return document.getElementsByTagName("head")?.[0]??document}DI({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=s=>{const i=st("internal-error");i.customData=s,t(i)},r.type="text/javascript",r.charset="UTF-8",oA().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});tA("Browser");const aA={apiKey:"AIzaSyBC5VHNEcVL9KP8M0d64ZajF6P4Hzqzafc",authDomain:"bbnme-58716.firebaseapp.com",projectId:"bbnme-58716",storageBucket:"bbnme-58716.appspot.com",messagingSenderId:"155088179379",appId:"1:155088179379:web:5d98445c178b7513f520c6"},Kc=Bf(aA),$i=jT(Kc),Qc=iA(Kc),cA=new St,Xc=Yg(null);WI(Qc,n=>{Xc.set(n)});var uA=Ue('<button class="svelte-18sv61c"> </button>');function wr(n,e){let t=os(e,"label",8,"Button"),r=os(e,"onClick",8,()=>{});var s=uA(),i=ze(s);is(()=>Za(i,t())),Ya("click",s,function(...a){r()?.apply(this,a)}),we(n,s)}var lA=Ue('<div class="login-container svelte-8ukb9p"><h2>Please sign in to continue</h2> <!></div>');function hA(n,e){Fn(e,!1),Cr();var t=lA(),r=ge(ze(t),2);wr(r,{label:"Sign in with Google",onClick:()=>pw(Qc,cA)}),we(n,t),Un()}var fA=Ue('<div class="user-info svelte-rfuq4y"><img alt="Profile" class="svelte-rfuq4y"/> <span> </span></div> <!>',1),dA=Ue('<nav class="svelte-rfuq4y"><!></nav>');function pA(n,e){Fn(e,!1);const t=()=>Cf(Xc,"$user",r),[r,s]=kf();Cr();var i=dA(),a=ze(i);{var c=l=>{var h=fA(),d=ms(h),m=ze(d),g=ge(m,2),T=ze(g),S=ge(d,2);wr(S,{label:"Sign out",onClick:()=>KI(Qc)}),is(()=>{ai(m,"src",t().photoURL),Za(T,t().displayName)}),we(l,h)};Rn(a,l=>{t()&&l(c)})}we(n,i),Un(),s()}var mA=Ue('<form class="svelte-7mtrh0"><h2>Add a new place</h2> <input type="text" placeholder="Place name" required class="svelte-7mtrh0"/> <input type="url" placeholder="Website" class="svelte-7mtrh0"/> <input type="url" placeholder="Image URL" class="svelte-7mtrh0"/> <button type="submit" class="svelte-7mtrh0">Add Place</button></form>');function gA(n,e){Fn(e,!1);let t=et(""),r=et(""),s=et("");async function i(){try{const d=await rI(op($i,"places"),{name:q(t),website:q(r),image:q(s)});console.log("Document written with ID: ",d.id),te(t,""),te(r,""),te(s,"")}catch(d){console.error("Error adding document: ",d)}}Cr();var a=mA(),c=ge(ze(a),2),l=ge(c,2),h=ge(l,2);sr(c,()=>q(t),d=>te(t,d)),sr(l,()=>q(r),d=>te(r,d)),sr(h,()=>q(s),d=>te(s,d)),Ya("submit",a,Sf(i)),we(n,a),Un()}var _A=Ue('<div class="card svelte-1udyrqm"><!></div>');function yi(n,e){var t=_A(),r=ze(t);Wg(r,e,"default",{}),we(n,t)}var yA=Ue('<form class="svelte-136zmjt"><h2>Edit Place</h2> <input type="text" placeholder="Place name" required class="svelte-136zmjt"/> <input type="url" placeholder="Website" class="svelte-136zmjt"/> <input type="url" placeholder="Image URL" class="svelte-136zmjt"/> <div class="actions svelte-136zmjt"><!> <!></div></form>');function vA(n,e){Fn(e,!1);let t=os(e,"place",8),r=os(e,"onSave",8,()=>{}),s=os(e,"onCancel",8,()=>{}),i=et(t().name),a=et(t().website),c=et(t().image);async function l(){try{const P=Dc($i,"places",t().id);await tI(P,{name:q(i),website:q(a),image:q(c)}),console.log("Document successfully updated!"),r()()}catch(P){console.error("Error updating document: ",P)}}Cr();var h=yA(),d=ge(ze(h),2),m=ge(d,2),g=ge(m,2),T=ge(g,2),S=ze(T);wr(S,{label:"Save",type:"submit"});var k=ge(S,2);wr(k,{label:"Cancel",get onClick(){return s()}}),sr(d,()=>q(i),P=>te(i,P)),sr(m,()=>q(a),P=>te(a,P)),sr(g,()=>q(c),P=>te(c,P)),Ya("submit",h,Sf(l)),we(n,h),Un()}var EA=Ue('<a target="_blank" rel="noreferrer">Website</a>'),TA=Ue('<img class="svelte-13geuu4"/>'),IA=Ue('<h3> </h3> <!> <!> <div class="actions svelte-13geuu4"><!> <!></div>',1),wA=Ue('<div class="svelte-13geuu4"><h2>Travel Wishlist</h2> <!></div>');function AA(n,e){Fn(e,!1);let t=et([]),r=et(null);t_(()=>{const d=sI(op($i,"places"),m=>{te(t,m.docs.map(g=>({id:g.id,...g.data()})))});return()=>d()});async function s(d){try{await nI(Dc($i,"places",d)),console.log("Document successfully deleted!")}catch(m){console.error("Error removing document: ",m)}}function i(d){te(r,d)}function a(){te(r,null)}function c(){te(r,null)}Cr();var l=wA(),h=ge(ze(l),2);Hg(h,1,()=>q(t),qg,(d,m)=>{yi(d,{children:(g,T)=>{var S=Af(),k=ms(S);{var P=V=>{vA(V,{get place(){return q(r)},onSave:a,onCancel:c})},x=V=>{var M=IA(),K=ms(M),X=ze(K),Y=ge(K,2);{var I=y=>{var ae=EA();is(()=>ai(ae,"href",q(m).website)),we(y,ae)};Rn(Y,y=>{q(m).website&&y(I)})}var _=ge(Y,2);{var v=y=>{var ae=TA();is(()=>{ai(ae,"src",q(m).image),ai(ae,"alt",q(m).name)}),we(y,ae)};Rn(_,y=>{q(m).image&&y(v)})}var w=ge(_,2),E=ze(w);wr(E,{label:"Edit",onClick:()=>i(q(m))});var A=ge(E,2);wr(A,{label:"Delete",onClick:()=>s(q(m).id)}),is(()=>Za(X,q(m).name)),we(V,M)};Rn(k,V=>{q(r)&&q(r).id===q(m).id?V(P):V(x,!1)})}we(g,S)},$$slots:{default:!0}})}),we(n,l),Un()}const bA="type.googleapis.com/google.protobuf.Int64Value",RA="type.googleapis.com/google.protobuf.UInt64Value";function Wp(n,e){const t={};for(const r in n)n.hasOwnProperty(r)&&(t[r]=e(n[r]));return t}function qi(n){if(n==null)return null;if(n instanceof Number&&(n=n.valueOf()),typeof n=="number"&&isFinite(n)||n===!0||n===!1||Object.prototype.toString.call(n)==="[object String]")return n;if(n instanceof Date)return n.toISOString();if(Array.isArray(n))return n.map(e=>qi(e));if(typeof n=="function"||typeof n=="object")return Wp(n,e=>qi(e));throw new Error("Data cannot be encoded in JSON: "+n)}function Ar(n){if(n==null)return n;if(n["@type"])switch(n["@type"]){case bA:case RA:{const e=Number(n.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+n);return e}default:throw new Error("Data cannot be decoded from JSON: "+n)}return Array.isArray(n)?n.map(e=>Ar(e)):typeof n=="function"||typeof n=="object"?Wp(n,e=>Ar(e)):n}const Jc="functions";const xh={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class qe extends At{constructor(e,t,r){super(`${Jc}/${e}`,t||""),this.details=r,Object.setPrototypeOf(this,qe.prototype)}}function SA(n){if(n>=200&&n<300)return"ok";switch(n){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function zi(n,e){let t=SA(n),r=t,s;try{const i=e&&e.error;if(i){const a=i.status;if(typeof a=="string"){if(!xh[a])return new qe("internal","internal");t=xh[a],r=a}const c=i.message;typeof c=="string"&&(r=c),s=i.details,s!==void 0&&(s=Ar(s))}}catch{}return t==="ok"?null:new qe(t,r,s)}class PA{constructor(e,t,r,s){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,Ye(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=t.getImmediate({optional:!0}),this.messaging=r.getImmediate({optional:!0}),this.auth||t.get().then(i=>this.auth=i,()=>{}),this.messaging||r.get().then(i=>this.messaging=i,()=>{}),this.appCheck||s?.get().then(i=>this.appCheck=i,()=>{})}async getAuthToken(){if(this.auth)try{return(await this.auth.getToken())?.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){const t=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return t.error?null:t.token}return null}async getContext(e){const t=await this.getAuthToken(),r=await this.getMessagingToken(),s=await this.getAppCheckToken(e);return{authToken:t,messagingToken:r,appCheckToken:s}}}const Ua="us-central1",CA=/^data: (.*?)(?:\n|$)/;function kA(n){let e=null;return{promise:new Promise((t,r)=>{e=setTimeout(()=>{r(new qe("deadline-exceeded","deadline-exceeded"))},n)}),cancel:()=>{e&&clearTimeout(e)}}}class NA{constructor(e,t,r,s,i=Ua,a=(...c)=>fetch(...c)){this.app=e,this.fetchImpl=a,this.emulatorOrigin=null,this.contextProvider=new PA(e,t,r,s),this.cancelAllRequests=new Promise(c=>{this.deleteService=()=>Promise.resolve(c())});try{const c=new URL(i);this.customDomain=c.origin+(c.pathname==="/"?"":c.pathname),this.region=Ua}catch{this.customDomain=null,this.region=i}}_delete(){return this.deleteService()}_url(e){const t=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${t}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${t}.cloudfunctions.net/${e}`}}function DA(n,e,t){const r=fn(e);n.emulatorOrigin=`http${r?"s":""}://${e}:${t}`,r&&(ec(n.emulatorOrigin+"/backends"),tc("Functions",!0))}function VA(n,e,t){const r=s=>MA(n,e,s,{});return r.stream=(s,i)=>xA(n,e,s,i),r}function Kp(n){return n.emulatorOrigin&&fn(n.emulatorOrigin)?"include":void 0}async function OA(n,e,t,r,s){t["Content-Type"]="application/json";let i;try{i=await r(n,{method:"POST",body:JSON.stringify(e),headers:t,credentials:Kp(s)})}catch{return{status:0,json:null}}let a=null;try{a=await i.json()}catch{}return{status:i.status,json:a}}async function Qp(n,e){const t={},r=await n.contextProvider.getContext(e.limitedUseAppCheckTokens);return r.authToken&&(t.Authorization="Bearer "+r.authToken),r.messagingToken&&(t["Firebase-Instance-ID-Token"]=r.messagingToken),r.appCheckToken!==null&&(t["X-Firebase-AppCheck"]=r.appCheckToken),t}function MA(n,e,t,r){const s=n._url(e);return LA(n,s,t,r)}async function LA(n,e,t,r){t=qi(t);const s={data:t},i=await Qp(n,r),a=r.timeout||7e4,c=kA(a),l=await Promise.race([OA(e,s,i,n.fetchImpl,n),c.promise,n.cancelAllRequests]);if(c.cancel(),!l)throw new qe("cancelled","Firebase Functions instance was deleted.");const h=zi(l.status,l.json);if(h)throw h;if(!l.json)throw new qe("internal","Response is not valid JSON object.");let d=l.json.data;if(typeof d>"u"&&(d=l.json.result),typeof d>"u")throw new qe("internal","Response is missing data field.");return{data:Ar(d)}}function xA(n,e,t,r){const s=n._url(e);return FA(n,s,t,r||{})}async function FA(n,e,t,r){t=qi(t);const s={data:t},i=await Qp(n,r);i["Content-Type"]="application/json",i.Accept="text/event-stream";let a;try{a=await n.fetchImpl(e,{method:"POST",body:JSON.stringify(s),headers:i,signal:r?.signal,credentials:Kp(n)})}catch(g){if(g instanceof Error&&g.name==="AbortError"){const S=new qe("cancelled","Request was cancelled.");return{data:Promise.reject(S),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(S)}}}}}}const T=zi(0,null);return{data:Promise.reject(T),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(T)}}}}}}let c,l;const h=new Promise((g,T)=>{c=g,l=T});r?.signal?.addEventListener("abort",()=>{const g=new qe("cancelled","Request was cancelled.");l(g)});const d=a.body.getReader(),m=UA(d,c,l,r?.signal);return{stream:{[Symbol.asyncIterator](){const g=m.getReader();return{async next(){const{value:T,done:S}=await g.read();return{value:T,done:S}},async return(){return await g.cancel(),{done:!0,value:void 0}}}}},data:h}}function UA(n,e,t,r){const s=(a,c)=>{const l=a.match(CA);if(!l)return;const h=l[1];try{const d=JSON.parse(h);if("result"in d){e(Ar(d.result));return}if("message"in d){c.enqueue(Ar(d.message));return}if("error"in d){const m=zi(0,d);c.error(m),t(m);return}}catch(d){if(d instanceof qe){c.error(d),t(d);return}}},i=new TextDecoder;return new ReadableStream({start(a){let c="";return l();async function l(){if(r?.aborted){const h=new qe("cancelled","Request was cancelled");return a.error(h),t(h),Promise.resolve()}try{const{value:h,done:d}=await n.read();if(d){c.trim()&&s(c.trim(),a),a.close();return}if(r?.aborted){const g=new qe("cancelled","Request was cancelled");a.error(g),t(g),await n.cancel();return}c+=i.decode(h,{stream:!0});const m=c.split(`
`);c=m.pop()||"";for(const g of m)g.trim()&&s(g.trim(),a);return l()}catch(h){const d=h instanceof qe?h:zi(0,null);a.error(d),t(d)}}},cancel(){return n.cancel()}})}const Fh="@firebase/functions",Uh="0.13.1";const BA="auth-internal",jA="app-check-internal",$A="messaging-internal";function qA(n){const e=(t,{instanceIdentifier:r})=>{const s=t.getProvider("app").getImmediate(),i=t.getProvider(BA),a=t.getProvider($A),c=t.getProvider(jA);return new NA(s,i,a,c,r)};Vn(new sn(Jc,e,"PUBLIC").setMultipleInstances(!0)),dt(Fh,Uh,n),dt(Fh,Uh,"esm2020")}function zA(n=sc(),e=Ua){const r=Zi(pe(n),Jc).getImmediate({identifier:e}),s=Mf("functions");return s&&HA(r,...s),r}function HA(n,e,t){DA(pe(n),e,t)}function GA(n,e,t){return VA(pe(n),e)}qA();var WA=Ue("<p>You are logged in, but not authorized to add new places.</p>"),KA=Ue("<p>Checking authorization...</p>"),QA=Ue('<!> <div class="container svelte-1n46o8q"><h1>Clean Girl Travel Wishlist</h1> <!> <!></div>',1),XA=Ue("<main><!></main>");function JA(n,e){Fn(e,!1);const t=()=>Cf(Xc,"$user",r),[r,s]=kf(),i=zA(Kc),a=GA(i,"checkAuthorization");let c=et(!1),l=et(!1);wg(()=>t(),()=>{t()?a().then(T=>{te(c,T.data.status==="authorized"),te(l,!0)}).catch(T=>{console.error("Error checking authorization:",T),te(c,!1),te(l,!0)}):(te(c,!1),te(l,!0))}),Ag(),Cr();var h=XA(),d=ze(h);{var m=T=>{var S=QA(),k=ms(S);pA(k,{});var P=ge(k,2),x=ge(ze(P),2);{var V=X=>{var Y=Af(),I=ms(Y);{var _=w=>{yi(w,{children:(E,A)=>{gA(E,{})},$$slots:{default:!0}})},v=w=>{yi(w,{children:(E,A)=>{var y=WA();we(E,y)},$$slots:{default:!0}})};Rn(I,w=>{q(c)?w(_):w(v,!1)})}we(X,Y)},M=X=>{yi(X,{children:(Y,I)=>{var _=KA();we(Y,_)},$$slots:{default:!0}})};Rn(x,X=>{q(l)?X(V):X(M,!1)})}var K=ge(x,2);AA(K,{}),we(T,S)},g=T=>{hA(T,{})};Rn(d,T=>{t()?T(m):T(g,!1)})}we(n,h),Un(),s()}Ug(JA,{target:document.getElementById("app")});
