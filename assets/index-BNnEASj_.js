(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();const uf=!1;var ho=Array.isArray,Xm=Array.prototype.indexOf,dc=Array.from,lf=Object.defineProperty,Ir=Object.getOwnPropertyDescriptor,hf=Object.getOwnPropertyDescriptors,Jm=Object.prototype,Ym=Array.prototype,pc=Object.getPrototypeOf,vl=Object.isExtensible;function Zm(n){return typeof n=="function"}const ut=()=>{};function eg(n){return n()}function ka(n){for(var e=0;e<n.length;e++)n[e]()}function ff(){var n,e,t=new Promise((r,s)=>{n=r,e=s});return{promise:t,resolve:n,reject:e}}const Fe=2,fo=4,po=8,Ft=16,nn=32,ir=64,mo=128,pt=512,ke=1024,Qe=2048,Ut=4096,et=8192,_n=16384,go=32768,Xn=65536,El=1<<17,df=1<<18,Gr=1<<19,pf=1<<20,Ms=32768,Na=1<<21,mc=1<<22,yn=1<<23,Ar=Symbol("$state"),tg=Symbol("legacy props"),ng=Symbol(""),Tr=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function gc(n){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function rg(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function sg(n){throw new Error("https://svelte.dev/e/effect_in_teardown")}function ig(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function og(n){throw new Error("https://svelte.dev/e/effect_orphan")}function ag(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function cg(n){throw new Error("https://svelte.dev/e/props_invalid_value")}function ug(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function lg(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function hg(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function fg(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const dg=1,pg=2,mg=16,gg=1,_g=2,yg=4,vg=8,Eg=16,Tg=4,wg=1,Ig=2,Me=Symbol(),Ag="http://www.w3.org/1999/xhtml";function bg(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}let Sg=!1;function mf(n){return n===this.v}function gf(n,e){return n!=n?e==e:n!==e||n!==null&&typeof n=="object"||typeof n=="function"}function _f(n){return!gf(n,this.v)}let Kr=!1,Rg=!1;function Pg(){Kr=!0}let ie=null;function Vr(n){ie=n}function Or(n){return yf().get(n)}function Da(n,e){return yf().set(n,e),e}function tt(n,e=!1,t){ie={p:ie,i:!1,c:null,e:null,s:n,x:null,l:Kr&&!e?{s:null,u:null,$:[]}:null}}function nt(n){var e=ie,t=e.e;if(t!==null){e.e=null;for(var r of t)Vf(r)}return e.i=!0,ie=e.p,{}}function Ws(){return!Kr||ie!==null&&ie.l===null}function yf(n){return ie===null&&gc(),ie.c??=new Map(Cg(ie)||void 0)}function Cg(n){let e=n.p;for(;e!==null;){const t=e.c;if(t!==null)return t;e=e.p}return null}let jn=[];function vf(){var n=jn;jn=[],ka(n)}function Gs(n){if(jn.length===0&&!Rs){var e=jn;queueMicrotask(()=>{e===jn&&vf()})}jn.push(n)}function kg(){for(;jn.length>0;)vf()}function Ef(n){var e=te;if(e===null)return Z.f|=yn,n;if((e.f&go)===0){if((e.f&mo)===0)throw n;e.b.error(n)}else Mr(n,e)}function Mr(n,e){for(;e!==null;){if((e.f&mo)!==0)try{e.b.error(n);return}catch(t){n=t}e=e.parent}throw n}const yi=new Set;let ce=null,Ri=null,Ye=null,It=[],_o=null,Va=!1,Rs=!1;class At{committed=!1;current=new Map;previous=new Map;#e=new Set;#t=new Set;#n=0;#r=0;#c=null;#o=[];#a=[];skipped_effects=new Set;is_fork=!1;process(e){It=[],Ri=null,this.apply();var t={parent:null,effect:null,effects:[],render_effects:[],block_effects:[]};for(const r of e)this.#s(r,t);this.is_fork||this.#u(),this.#r>0||this.is_fork?(this.#i(t.effects),this.#i(t.render_effects),this.#i(t.block_effects)):(Ri=this,ce=null,Tl(t.render_effects),Tl(t.effects),Ri=null,this.#c?.resolve()),Ye=null}#s(e,t){e.f^=ke;for(var r=e.first;r!==null;){var s=r.f,i=(s&(nn|ir))!==0,a=i&&(s&ke)!==0,c=a||(s&et)!==0||this.skipped_effects.has(r);if((r.f&mo)!==0&&r.b?.is_pending()&&(t={parent:t,effect:r,effects:[],render_effects:[],block_effects:[]}),!c&&r.fn!==null){i?r.f^=ke:(s&fo)!==0?t.effects.push(r):Xr(r)&&((r.f&Ft)!==0&&t.block_effects.push(r),xr(r));var l=r.first;if(l!==null){r=l;continue}}var h=r.parent;for(r=r.next;r===null&&h!==null;)h===t.effect&&(this.#i(t.effects),this.#i(t.render_effects),this.#i(t.block_effects),t=t.parent),r=h.next,h=h.parent}}#i(e){for(const t of e)((t.f&Qe)!==0?this.#o:this.#a).push(t),Ne(t,ke)}capture(e,t){this.previous.has(e)||this.previous.set(e,t),(e.f&yn)===0&&(this.current.set(e,e.v),Ye?.set(e,e.v))}activate(){ce=this,this.apply()}deactivate(){ce=null,Ye=null}flush(){if(this.activate(),It.length>0){if(Tf(),ce!==null&&ce!==this)return}else this.#n===0&&this.process([]);this.deactivate()}discard(){for(const e of this.#t)e(this);this.#t.clear()}#u(){if(this.#r===0){for(const e of this.#e)e();this.#e.clear()}this.#n===0&&this.#l()}#l(){if(yi.size>1){this.previous.clear();var e=Ye,t=!0,r={parent:null,effect:null,effects:[],render_effects:[],block_effects:[]};for(const s of yi){if(s===this){t=!1;continue}const i=[];for(const[c,l]of this.current){if(s.current.has(c))if(t&&l!==s.current.get(c))s.current.set(c,l);else continue;i.push(c)}if(i.length===0)continue;const a=[...s.current.keys()].filter(c=>!this.current.has(c));if(a.length>0){const c=new Set,l=new Map;for(const h of i)wf(h,a,c,l);if(It.length>0){ce=s,s.apply();for(const h of It)s.#s(h,r);It=[],s.deactivate()}}}ce=null,Ye=e}this.committed=!0,yi.delete(this)}increment(e){this.#n+=1,e&&(this.#r+=1)}decrement(e){this.#n-=1,e&&(this.#r-=1),this.revive()}revive(){for(const e of this.#o)Ne(e,Qe),Jn(e);for(const e of this.#a)Ne(e,Ut),Jn(e);this.#o=[],this.#a=[],this.flush()}oncommit(e){this.#e.add(e)}ondiscard(e){this.#t.add(e)}settled(){return(this.#c??=ff()).promise}static ensure(){if(ce===null){const e=ce=new At;yi.add(ce),Rs||At.enqueue(()=>{ce===e&&e.flush()})}return ce}static enqueue(e){Gs(e)}apply(){}}function Ng(n){var e=Rs;Rs=!0;try{for(var t;;){if(kg(),It.length===0&&(ce?.flush(),It.length===0))return _o=null,t;Tf()}}finally{Rs=e}}function Tf(){var n=Hn;Va=!0;try{var e=0;for(Il(!0);It.length>0;){var t=At.ensure();if(e++>1e3){var r,s;Dg()}t.process(It),vn.clear()}}finally{Va=!1,Il(n),_o=null}}function Dg(){try{ag()}catch(n){Mr(n,_o)}}let Ht=null;function Tl(n){var e=n.length;if(e!==0){for(var t=0;t<e;){var r=n[t++];if((r.f&(_n|et))===0&&Xr(r)&&(Ht=new Set,xr(r),r.deps===null&&r.first===null&&r.nodes_start===null&&(r.teardown===null&&r.ac===null?Lf(r):r.fn=null),Ht?.size>0)){vn.clear();for(const s of Ht){if((s.f&(_n|et))!==0)continue;const i=[s];let a=s.parent;for(;a!==null;)Ht.has(a)&&(Ht.delete(a),i.push(a)),a=a.parent;for(let c=i.length-1;c>=0;c--){const l=i[c];(l.f&(_n|et))===0&&xr(l)}}Ht.clear()}}Ht=null}}function wf(n,e,t,r){if(!t.has(n)&&(t.add(n),n.reactions!==null))for(const s of n.reactions){const i=s.f;(i&Fe)!==0?wf(s,e,t,r):(i&(mc|Ft))!==0&&(i&Qe)===0&&If(s,e,r)&&(Ne(s,Qe),Jn(s))}}function If(n,e,t){const r=t.get(n);if(r!==void 0)return r;if(n.deps!==null)for(const s of n.deps){if(e.includes(s))return!0;if((s.f&Fe)!==0&&If(s,e,t))return t.set(s,!0),!0}return t.set(n,!1),!1}function Jn(n){for(var e=_o=n;e.parent!==null;){e=e.parent;var t=e.f;if(Va&&e===te&&(t&Ft)!==0&&(t&df)===0)return;if((t&(ir|nn))!==0){if((t&ke)===0)return;e.f^=ke}}It.push(e)}function Vg(n){let e=0,t=Yn(0),r;return()=>{Eo()&&(O(t),To(()=>(e===0&&(r=Pe(()=>n(()=>Ps(t)))),e+=1,()=>{Gs(()=>{e-=1,e===0&&(r?.(),r=void 0,Ps(t))})})))}}var Og=Xn|Gr|mo;function Mg(n,e,t){new Lg(n,e,t)}class Lg{parent;#e=!1;#t;#n=null;#r;#c;#o;#a=null;#s=null;#i=null;#u=null;#l=null;#d=0;#h=0;#p=!1;#f=null;#v=Vg(()=>(this.#f=Yn(this.#d),()=>{this.#f=null}));constructor(e,t,r){this.#t=e,this.#r=t,this.#c=r,this.parent=te.b,this.#e=!!this.#r.pending,this.#o=vc(()=>{te.b=this;{var s=this.#_();try{this.#a=ct(()=>r(s))}catch(i){this.error(i)}this.#h>0?this.#g():this.#e=!1}return()=>{this.#l?.remove()}},Og)}#E(){try{this.#a=ct(()=>this.#c(this.#t))}catch(e){this.error(e)}this.#e=!1}#T(){const e=this.#r.pending;e&&(this.#s=ct(()=>e(this.#t)),At.enqueue(()=>{var t=this.#_();this.#a=this.#m(()=>(At.ensure(),ct(()=>this.#c(t)))),this.#h>0?this.#g():(br(this.#s,()=>{this.#s=null}),this.#e=!1)}))}#_(){var e=this.#t;return this.#e&&(this.#l=Zn(),this.#t.before(this.#l),e=this.#l),e}is_pending(){return this.#e||!!this.parent&&this.parent.is_pending()}has_pending_snippet(){return!!this.#r.pending}#m(e){var t=te,r=Z,s=ie;Ot(this.#o),Ge(this.#o),Vr(this.#o.ctx);try{return e()}catch(i){return Ef(i),null}finally{Ot(t),Ge(r),Vr(s)}}#g(){const e=this.#r.pending;this.#a!==null&&(this.#u=document.createDocumentFragment(),this.#u.append(this.#l),Uf(this.#a,this.#u)),this.#s===null&&(this.#s=ct(()=>e(this.#t)))}#y(e){if(!this.has_pending_snippet()){this.parent&&this.parent.#y(e);return}this.#h+=e,this.#h===0&&(this.#e=!1,this.#s&&br(this.#s,()=>{this.#s=null}),this.#u&&(this.#t.before(this.#u),this.#u=null))}update_pending_count(e){this.#y(e),this.#d+=e,this.#f&&Ls(this.#f,this.#d)}get_effect_pending(){return this.#v(),O(this.#f)}error(e){var t=this.#r.onerror;let r=this.#r.failed;if(this.#p||!t&&!r)throw e;this.#a&&(ze(this.#a),this.#a=null),this.#s&&(ze(this.#s),this.#s=null),this.#i&&(ze(this.#i),this.#i=null);var s=!1,i=!1;const a=()=>{if(s){bg();return}s=!0,i&&fg(),At.ensure(),this.#d=0,this.#i!==null&&br(this.#i,()=>{this.#i=null}),this.#e=this.has_pending_snippet(),this.#a=this.#m(()=>(this.#p=!1,ct(()=>this.#c(this.#t)))),this.#h>0?this.#g():this.#e=!1};var c=Z;try{Ge(null),i=!0,t?.(e,a),i=!1}catch(l){Mr(l,this.#o&&this.#o.parent)}finally{Ge(c)}r&&Gs(()=>{this.#i=this.#m(()=>{At.ensure(),this.#p=!0;try{return ct(()=>{r(this.#t,()=>e,()=>a)})}catch(l){return Mr(l,this.#o.parent),null}finally{this.#p=!1}})})}}function xg(n,e,t,r){const s=Ws()?yo:vo;if(t.length===0&&n.length===0){r(e.map(s));return}var i=ce,a=te,c=Fg();function l(){Promise.all(t.map(h=>Ug(h))).then(h=>{c();try{r([...e.map(s),...h])}catch(d){(a.f&_n)===0&&Mr(d,a)}i?.deactivate(),Fi()}).catch(h=>{Mr(h,a)})}n.length>0?Promise.all(n).then(()=>{c();try{return l()}finally{i?.deactivate(),Fi()}}):l()}function Fg(){var n=te,e=Z,t=ie,r=ce;return function(i=!0){Ot(n),Ge(e),Vr(t),i&&r?.activate()}}function Fi(){Ot(null),Ge(null),Vr(null)}function yo(n){var e=Fe|Qe,t=Z!==null&&(Z.f&Fe)!==0?Z:null;return te!==null&&(te.f|=Gr),{ctx:ie,deps:null,effects:null,equals:mf,f:e,fn:n,reactions:null,rv:0,v:Me,wv:0,parent:t??te,ac:null}}function Ug(n,e){let t=te;t===null&&rg();var r=t.b,s=void 0,i=Yn(Me),a=!Z,c=new Map;return Xg(()=>{var l=ff();s=l.promise;try{Promise.resolve(n()).then(l.resolve,l.reject).then(()=>{h===ce&&h.committed&&h.deactivate(),Fi()})}catch(m){l.reject(m),Fi()}var h=ce;if(a){var d=!r.is_pending();r.update_pending_count(1),h.increment(d),c.get(h)?.reject(Tr),c.delete(h),c.set(h,l)}const g=(m,T=void 0)=>{if(h.activate(),T)T!==Tr&&(i.f|=yn,Ls(i,T));else{(i.f&yn)!==0&&(i.f^=yn),Ls(i,m);for(const[S,P]of c){if(c.delete(S),S===h)break;P.reject(Tr)}}a&&(r.update_pending_count(-1),h.decrement(d))};l.promise.then(g,m=>g(null,m||"unknown"))}),yc(()=>{for(const l of c.values())l.reject(Tr)}),new Promise(l=>{function h(d){function g(){d===s?l(i):h(s)}d.then(g,g)}h(s)})}function vo(n){const e=yo(n);return e.equals=_f,e}function Af(n){var e=n.effects;if(e!==null){n.effects=null;for(var t=0;t<e.length;t+=1)ze(e[t])}}function Bg(n){for(var e=n.parent;e!==null;){if((e.f&Fe)===0)return e;e=e.parent}return null}function _c(n){var e,t=te;Ot(Bg(n));try{n.f&=~Ms,Af(n),e=qf(n)}finally{Ot(t)}return e}function bf(n){var e=_c(n);if(n.equals(e)||(n.v=e,n.wv=$f()),!ar)if(Ye!==null)Eo()&&Ye.set(n,n.v);else{var t=(n.f&pt)===0?Ut:ke;Ne(n,t)}}let Oa=new Set;const vn=new Map;let Sf=!1;function Yn(n,e){var t={f:0,v:n,reactions:null,equals:mf,rv:0,wv:0};return t}function hn(n,e){const t=Yn(n);return Zg(t),t}function he(n,e=!1,t=!0){const r=Yn(n);return e||(r.equals=_f),Kr&&t&&ie!==null&&ie.l!==null&&(ie.l.s??=[]).push(r),r}function $(n,e,t=!1){Z!==null&&(!bt||(Z.f&El)!==0)&&Ws()&&(Z.f&(Fe|Ft|mc|El))!==0&&!Xt?.includes(n)&&hg();let r=t?wr(e):e;return Ls(n,r)}function Ls(n,e){if(!n.equals(e)){var t=n.v;ar?vn.set(n,e):vn.set(n,t),n.v=e;var r=At.ensure();r.capture(n,t),(n.f&Fe)!==0&&((n.f&Qe)!==0&&_c(n),Ne(n,(n.f&pt)!==0?ke:Ut)),n.wv=$f(),Rf(n,Qe),Ws()&&te!==null&&(te.f&ke)!==0&&(te.f&(nn|ir))===0&&(rt===null?e_([n]):rt.push(n)),!r.is_fork&&Oa.size>0&&!Sf&&$g()}return e}function $g(){Sf=!1;const n=Array.from(Oa);for(const e of n)(e.f&ke)!==0&&Ne(e,Ut),Xr(e)&&xr(e);Oa.clear()}function Ps(n){$(n,n.v+1)}function Rf(n,e){var t=n.reactions;if(t!==null)for(var r=Ws(),s=t.length,i=0;i<s;i++){var a=t[i],c=a.f;if(!(!r&&a===te)){var l=(c&Qe)===0;if(l&&Ne(a,e),(c&Fe)!==0){var h=a;Ye?.delete(h),(c&Ms)===0&&(c&pt&&(a.f|=Ms),Rf(h,Ut))}else l&&((c&Ft)!==0&&Ht!==null&&Ht.add(a),Jn(a))}}}function wr(n){if(typeof n!="object"||n===null||Ar in n)return n;const e=pc(n);if(e!==Jm&&e!==Ym)return n;var t=new Map,r=ho(n),s=hn(0),i=Wn,a=c=>{if(Wn===i)return c();var l=Z,h=Wn;Ge(null),bl(i);var d=c();return Ge(l),bl(h),d};return r&&t.set("length",hn(n.length)),new Proxy(n,{defineProperty(c,l,h){(!("value"in h)||h.configurable===!1||h.enumerable===!1||h.writable===!1)&&ug();var d=t.get(l);return d===void 0?d=a(()=>{var g=hn(h.value);return t.set(l,g),g}):$(d,h.value,!0),!0},deleteProperty(c,l){var h=t.get(l);if(h===void 0){if(l in c){const d=a(()=>hn(Me));t.set(l,d),Ps(s)}}else $(h,Me),Ps(s);return!0},get(c,l,h){if(l===Ar)return n;var d=t.get(l),g=l in c;if(d===void 0&&(!g||Ir(c,l)?.writable)&&(d=a(()=>{var T=wr(g?c[l]:Me),S=hn(T);return S}),t.set(l,d)),d!==void 0){var m=O(d);return m===Me?void 0:m}return Reflect.get(c,l,h)},getOwnPropertyDescriptor(c,l){var h=Reflect.getOwnPropertyDescriptor(c,l);if(h&&"value"in h){var d=t.get(l);d&&(h.value=O(d))}else if(h===void 0){var g=t.get(l),m=g?.v;if(g!==void 0&&m!==Me)return{enumerable:!0,configurable:!0,value:m,writable:!0}}return h},has(c,l){if(l===Ar)return!0;var h=t.get(l),d=h!==void 0&&h.v!==Me||Reflect.has(c,l);if(h!==void 0||te!==null&&(!d||Ir(c,l)?.writable)){h===void 0&&(h=a(()=>{var m=d?wr(c[l]):Me,T=hn(m);return T}),t.set(l,h));var g=O(h);if(g===Me)return!1}return d},set(c,l,h,d){var g=t.get(l),m=l in c;if(r&&l==="length")for(var T=h;T<g.v;T+=1){var S=t.get(T+"");S!==void 0?$(S,Me):T in c&&(S=a(()=>hn(Me)),t.set(T+"",S))}if(g===void 0)(!m||Ir(c,l)?.writable)&&(g=a(()=>hn(void 0)),$(g,wr(h)),t.set(l,g));else{m=g.v!==Me;var P=a(()=>wr(h));$(g,P)}var C=Reflect.getOwnPropertyDescriptor(c,l);if(C?.set&&C.set.call(d,h),!m){if(r&&typeof l=="string"){var L=t.get("length"),V=Number(l);Number.isInteger(V)&&V>=L.v&&$(L,V+1)}Ps(s)}return!0},ownKeys(c){O(s);var l=Reflect.ownKeys(c).filter(g=>{var m=t.get(g);return m===void 0||m.v!==Me});for(var[h,d]of t)d.v!==Me&&!(h in c)&&l.push(h);return l},setPrototypeOf(){lg()}})}var Ui,Pf,Cf,kf;function jg(){if(Ui===void 0){Ui=window,Pf=/Firefox/.test(navigator.userAgent);var n=Element.prototype,e=Node.prototype,t=Text.prototype;Cf=Ir(e,"firstChild").get,kf=Ir(e,"nextSibling").get,vl(n)&&(n.__click=void 0,n.__className=void 0,n.__attributes=null,n.__style=void 0,n.__e=void 0),vl(t)&&(t.__t=void 0)}}function Zn(n=""){return document.createTextNode(n)}function Bi(n){return Cf.call(n)}function Ks(n){return kf.call(n)}function ee(n,e){return Bi(n)}function Lr(n,e=!1){{var t=Bi(n);return t instanceof Comment&&t.data===""?Ks(t):t}}function oe(n,e=1,t=!1){let r=n;for(;e--;)r=Ks(r);return r}function qg(n){n.textContent=""}function Nf(){return!1}let wl=!1;function zg(){wl||(wl=!0,document.addEventListener("reset",n=>{Promise.resolve().then(()=>{if(!n.defaultPrevented)for(const e of n.target.elements)e.__on_r?.()})},{capture:!0}))}function Qr(n){var e=Z,t=te;Ge(null),Ot(null);try{return n()}finally{Ge(e),Ot(t)}}function Hg(n,e,t,r=t){n.addEventListener(e,()=>Qr(t));const s=n.__on_r;s?n.__on_r=()=>{s(),r(!0)}:n.__on_r=()=>r(!0),zg()}function Df(n){te===null&&(Z===null&&og(),ig()),ar&&sg()}function Wg(n,e){var t=e.last;t===null?e.last=e.first=n:(t.next=n,n.prev=t,e.last=n)}function Bt(n,e,t,r=!0){var s=te;s!==null&&(s.f&et)!==0&&(n|=et);var i={ctx:ie,deps:null,nodes_start:null,nodes_end:null,f:n|Qe|pt,first:null,fn:e,last:null,next:null,parent:s,b:s&&s.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(t)try{xr(i),i.f|=go}catch(l){throw ze(i),l}else e!==null&&Jn(i);if(r){var a=i;if(t&&a.deps===null&&a.teardown===null&&a.nodes_start===null&&a.first===a.last&&(a.f&Gr)===0&&(a=a.first,(n&Ft)!==0&&(n&Xn)!==0&&a!==null&&(a.f|=Xn)),a!==null&&(a.parent=s,s!==null&&Wg(a,s),Z!==null&&(Z.f&Fe)!==0&&(n&ir)===0)){var c=Z;(c.effects??=[]).push(a)}}return i}function Eo(){return Z!==null&&!bt}function yc(n){const e=Bt(po,null,!1);return Ne(e,ke),e.teardown=n,e}function Ma(n){Df();var e=te.f,t=!Z&&(e&nn)!==0&&(e&go)===0;if(t){var r=ie;(r.e??=[]).push(n)}else return Vf(n)}function Vf(n){return Bt(fo|pf,n,!1)}function Gg(n){return Df(),Bt(po|pf,n,!0)}function Kg(n){At.ensure();const e=Bt(ir|Gr,n,!0);return(t={})=>new Promise(r=>{t.outro?br(e,()=>{ze(e),r(void 0)}):(ze(e),r(void 0))})}function Qg(n){return Bt(fo,n,!1)}function St(n,e){var t=ie,r={effect:null,ran:!1,deps:n};t.l.$.push(r),r.effect=To(()=>{n(),!r.ran&&(r.ran=!0,Pe(e))})}function or(){var n=ie;To(()=>{for(var e of n.l.$){e.deps();var t=e.effect;(t.f&ke)!==0&&Ne(t,Ut),Xr(t)&&xr(t),e.ran=!1}})}function Xg(n){return Bt(mc|Gr,n,!0)}function To(n,e=0){return Bt(po|e,n,!0)}function mt(n,e=[],t=[],r=[],s=!1){xg(r,e,t,i=>{Bt(s?fo:po,()=>n(...i.map(O)),!0)})}function vc(n,e=0){var t=Bt(Ft|e,n,!0);return t}function ct(n,e=!0){return Bt(nn|Gr,n,!0,e)}function Of(n){var e=n.teardown;if(e!==null){const t=ar,r=Z;Al(!0),Ge(null);try{e.call(null)}finally{Al(t),Ge(r)}}}function Mf(n,e=!1){var t=n.first;for(n.first=n.last=null;t!==null;){const s=t.ac;s!==null&&Qr(()=>{s.abort(Tr)});var r=t.next;(t.f&ir)!==0?t.parent=null:ze(t,e),t=r}}function Jg(n){for(var e=n.first;e!==null;){var t=e.next;(e.f&nn)===0&&ze(e),e=t}}function ze(n,e=!0){var t=!1;(e||(n.f&df)!==0)&&n.nodes_start!==null&&n.nodes_end!==null&&(Yg(n.nodes_start,n.nodes_end),t=!0),Mf(n,e&&!t),$i(n,0),Ne(n,_n);var r=n.transitions;if(r!==null)for(const i of r)i.stop();Of(n);var s=n.parent;s!==null&&s.first!==null&&Lf(n),n.next=n.prev=n.teardown=n.ctx=n.deps=n.fn=n.nodes_start=n.nodes_end=n.ac=null}function Yg(n,e){for(;n!==null;){var t=n===e?null:Ks(n);n.remove(),n=t}}function Lf(n){var e=n.parent,t=n.prev,r=n.next;t!==null&&(t.next=r),r!==null&&(r.prev=t),e!==null&&(e.first===n&&(e.first=r),e.last===n&&(e.last=t))}function br(n,e,t=!0){var r=[];Ec(n,r,!0),xf(r,()=>{t&&ze(n),e&&e()})}function xf(n,e){var t=n.length;if(t>0){var r=()=>--t||e();for(var s of n)s.out(r)}else e()}function Ec(n,e,t){if((n.f&et)===0){if(n.f^=et,n.transitions!==null)for(const a of n.transitions)(a.is_global||t)&&e.push(a);for(var r=n.first;r!==null;){var s=r.next,i=(r.f&Xn)!==0||(r.f&nn)!==0&&(n.f&Ft)!==0;Ec(r,e,i?t:!1),r=s}}}function Tc(n){Ff(n,!0)}function Ff(n,e){if((n.f&et)!==0){n.f^=et,(n.f&ke)===0&&(Ne(n,Qe),Jn(n));for(var t=n.first;t!==null;){var r=t.next,s=(t.f&Xn)!==0||(t.f&nn)!==0;Ff(t,s?e:!1),t=r}if(n.transitions!==null)for(const i of n.transitions)(i.is_global||e)&&i.in()}}function Uf(n,e){for(var t=n.nodes_start,r=n.nodes_end;t!==null;){var s=t===r?null:Ks(t);e.append(t),t=s}}let Hn=!1;function Il(n){Hn=n}let ar=!1;function Al(n){ar=n}let Z=null,bt=!1;function Ge(n){Z=n}let te=null;function Ot(n){te=n}let Xt=null;function Zg(n){Z!==null&&(Xt===null?Xt=[n]:Xt.push(n))}let qe=null,Je=0,rt=null;function e_(n){rt=n}let Bf=1,xs=0,Wn=xs;function bl(n){Wn=n}function $f(){return++Bf}function Xr(n){var e=n.f;if((e&Qe)!==0)return!0;if(e&Fe&&(n.f&=~Ms),(e&Ut)!==0){var t=n.deps;if(t!==null)for(var r=t.length,s=0;s<r;s++){var i=t[s];if(Xr(i)&&bf(i),i.wv>n.wv)return!0}(e&pt)!==0&&Ye===null&&Ne(n,ke)}return!1}function jf(n,e,t=!0){var r=n.reactions;if(r!==null&&!Xt?.includes(n))for(var s=0;s<r.length;s++){var i=r[s];(i.f&Fe)!==0?jf(i,e,!1):e===i&&(t?Ne(i,Qe):(i.f&ke)!==0&&Ne(i,Ut),Jn(i))}}function qf(n){var e=qe,t=Je,r=rt,s=Z,i=Xt,a=ie,c=bt,l=Wn,h=n.f;qe=null,Je=0,rt=null,Z=(h&(nn|ir))===0?n:null,Xt=null,Vr(n.ctx),bt=!1,Wn=++xs,n.ac!==null&&(Qr(()=>{n.ac.abort(Tr)}),n.ac=null);try{n.f|=Na;var d=n.fn,g=d(),m=n.deps;if(qe!==null){var T;if($i(n,Je),m!==null&&Je>0)for(m.length=Je+qe.length,T=0;T<qe.length;T++)m[Je+T]=qe[T];else n.deps=m=qe;if(Hn&&Eo()&&(n.f&pt)!==0)for(T=Je;T<m.length;T++)(m[T].reactions??=[]).push(n)}else m!==null&&Je<m.length&&($i(n,Je),m.length=Je);if(Ws()&&rt!==null&&!bt&&m!==null&&(n.f&(Fe|Ut|Qe))===0)for(T=0;T<rt.length;T++)jf(rt[T],n);return s!==null&&s!==n&&(xs++,rt!==null&&(r===null?r=rt:r.push(...rt))),(n.f&yn)!==0&&(n.f^=yn),g}catch(S){return Ef(S)}finally{n.f^=Na,qe=e,Je=t,rt=r,Z=s,Xt=i,Vr(a),bt=c,Wn=l}}function t_(n,e){let t=e.reactions;if(t!==null){var r=Xm.call(t,n);if(r!==-1){var s=t.length-1;s===0?t=e.reactions=null:(t[r]=t[s],t.pop())}}t===null&&(e.f&Fe)!==0&&(qe===null||!qe.includes(e))&&(Ne(e,Ut),(e.f&pt)!==0&&(e.f^=pt,e.f&=~Ms),Af(e),$i(e,0))}function $i(n,e){var t=n.deps;if(t!==null)for(var r=e;r<t.length;r++)t_(n,t[r])}function xr(n){var e=n.f;if((e&_n)===0){Ne(n,ke);var t=te,r=Hn;te=n,Hn=!0;try{(e&Ft)!==0?Jg(n):Mf(n),Of(n);var s=qf(n);n.teardown=typeof s=="function"?s:null,n.wv=Bf;var i;uf&&Rg&&(n.f&Qe)!==0&&n.deps}finally{Hn=r,te=t}}}async function n_(){await Promise.resolve(),Ng()}function O(n){var e=n.f,t=(e&Fe)!==0;if(Z!==null&&!bt){var r=te!==null&&(te.f&_n)!==0;if(!r&&!Xt?.includes(n)){var s=Z.deps;if((Z.f&Na)!==0)n.rv<xs&&(n.rv=xs,qe===null&&s!==null&&s[Je]===n?Je++:qe===null?qe=[n]:qe.includes(n)||qe.push(n));else{(Z.deps??=[]).push(n);var i=n.reactions;i===null?n.reactions=[Z]:i.includes(Z)||i.push(Z)}}}if(ar){if(vn.has(n))return vn.get(n);if(t){var a=n,c=a.v;return((a.f&ke)===0&&a.reactions!==null||Hf(a))&&(c=_c(a)),vn.set(a,c),c}}else if(t){if(a=n,Ye?.has(a))return Ye.get(a);Xr(a)&&bf(a),Hn&&Eo()&&(a.f&pt)===0&&zf(a)}else if(Ye?.has(n))return Ye.get(n);if((n.f&yn)!==0)throw n.v;return n.v}function zf(n){if(n.deps!==null){n.f^=pt;for(const e of n.deps)(e.reactions??=[]).push(n),(e.f&Fe)!==0&&(e.f&pt)===0&&zf(e)}}function Hf(n){if(n.v===Me)return!0;if(n.deps===null)return!1;for(const e of n.deps)if(vn.has(e)||(e.f&Fe)!==0&&Hf(e))return!0;return!1}function Pe(n){var e=bt;try{return bt=!0,n()}finally{bt=e}}const r_=-7169;function Ne(n,e){n.f=n.f&r_|e}function wc(n){if(!(typeof n!="object"||!n||n instanceof EventTarget)){if(Ar in n)La(n);else if(!Array.isArray(n))for(let e in n){const t=n[e];typeof t=="object"&&t&&Ar in t&&La(t)}}}function La(n,e=new Set){if(typeof n=="object"&&n!==null&&!(n instanceof EventTarget)&&!e.has(n)){e.add(n),n instanceof Date&&n.getTime();for(let r in n)try{La(n[r],e)}catch{}const t=pc(n);if(t!==Object.prototype&&t!==Array.prototype&&t!==Map.prototype&&t!==Set.prototype&&t!==Date.prototype){const r=hf(t);for(let s in r){const i=r[s].get;if(i)try{i.call(n)}catch{}}}}}const s_=["touchstart","touchmove"];function i_(n){return s_.includes(n)}const o_=new Set,Sl=new Set;function a_(n,e,t,r={}){function s(i){if(r.capture||ws.call(e,i),!i.cancelBubble)return Qr(()=>t?.call(this,i))}return n.startsWith("pointer")||n.startsWith("touch")||n==="wheel"?Gs(()=>{e.addEventListener(n,s,r)}):e.addEventListener(n,s,r),s}function gt(n,e,t,r,s){var i={capture:r,passive:s},a=a_(n,e,t,i);(e===document.body||e===window||e===document||e instanceof HTMLMediaElement)&&yc(()=>{e.removeEventListener(n,a,i)})}let Rl=null;function ws(n){var e=this,t=e.ownerDocument,r=n.type,s=n.composedPath?.()||[],i=s[0]||n.target;Rl=n;var a=0,c=Rl===n&&n.__root;if(c){var l=s.indexOf(c);if(l!==-1&&(e===document||e===window)){n.__root=e;return}var h=s.indexOf(e);if(h===-1)return;l<=h&&(a=l)}if(i=s[a]||n.target,i!==e){lf(n,"currentTarget",{configurable:!0,get(){return i||t}});var d=Z,g=te;Ge(null),Ot(null);try{for(var m,T=[];i!==null;){var S=i.assignedSlot||i.parentNode||i.host||null;try{var P=i["__"+r];P!=null&&(!i.disabled||n.target===i)&&P.call(i,n)}catch(C){m?T.push(C):m=C}if(n.cancelBubble||S===e||S===null)break;i=S}if(m){for(let C of T)queueMicrotask(()=>{throw C});throw m}}finally{n.__root=e,delete n.currentTarget,Ge(d),Ot(g)}}}function c_(n){var e=document.createElement("template");return e.innerHTML=n.replaceAll("<!>","<!---->"),e.content}function xa(n,e){var t=te;t.nodes_start===null&&(t.nodes_start=n,t.nodes_end=e)}function pe(n,e){var t=(e&wg)!==0,r=(e&Ig)!==0,s,i=!n.startsWith("<!>");return()=>{s===void 0&&(s=c_(i?n:"<!>"+n),t||(s=Bi(s)));var a=r||Pf?document.importNode(s,!0):s.cloneNode(!0);if(t){var c=Bi(a),l=a.lastChild;xa(c,l)}else xa(a,a);return a}}function Wf(){var n=document.createDocumentFragment(),e=document.createComment(""),t=Zn();return n.append(e,t),xa(e,t),n}function fe(n,e){n!==null&&n.before(e)}let Fa=!0;function wo(n,e){var t=e==null?"":typeof e=="object"?e+"":e;t!==(n.__t??=n.nodeValue)&&(n.__t=t,n.nodeValue=t+"")}function u_(n,e){return l_(n,e)}const mr=new Map;function l_(n,{target:e,anchor:t,props:r={},events:s,context:i,intro:a=!0}){jg();var c=new Set,l=g=>{for(var m=0;m<g.length;m++){var T=g[m];if(!c.has(T)){c.add(T);var S=i_(T);e.addEventListener(T,ws,{passive:S});var P=mr.get(T);P===void 0?(document.addEventListener(T,ws,{passive:S}),mr.set(T,1)):mr.set(T,P+1)}}};l(dc(o_)),Sl.add(l);var h=void 0,d=Kg(()=>{var g=t??e.appendChild(Zn());return Mg(g,{pending:()=>{}},m=>{if(i){tt({});var T=ie;T.c=i}s&&(r.$$events=s),Fa=a,h=n(m,r)||{},Fa=!0,i&&nt()}),()=>{for(var m of c){e.removeEventListener(m,ws);var T=mr.get(m);--T===0?(document.removeEventListener(m,ws),mr.delete(m)):mr.set(m,T)}Sl.delete(l),g!==t&&g.parentNode?.removeChild(g)}});return h_.set(h,d),h}let h_=new WeakMap;class f_{anchor;#e=new Map;#t=new Map;#n=new Map;#r=!0;constructor(e,t=!0){this.anchor=e,this.#r=t}#c=()=>{var e=ce;if(this.#e.has(e)){var t=this.#e.get(e),r=this.#t.get(t);if(r)Tc(r);else{var s=this.#n.get(t);s&&(this.#t.set(t,s.effect),this.#n.delete(t),s.fragment.lastChild.remove(),this.anchor.before(s.fragment),r=s.effect)}for(const[i,a]of this.#e){if(this.#e.delete(i),i===e)break;const c=this.#n.get(a);c&&(ze(c.effect),this.#n.delete(a))}for(const[i,a]of this.#t){if(i===t)continue;const c=()=>{if(Array.from(this.#e.values()).includes(i)){var h=document.createDocumentFragment();Uf(a,h),h.append(Zn()),this.#n.set(i,{effect:a,fragment:h})}else ze(a);this.#t.delete(i)};this.#r||!r?br(a,c,!1):c()}}};#o=e=>{this.#e.delete(e);const t=Array.from(this.#e.values());for(const[r,s]of this.#n)t.includes(r)||(ze(s.effect),this.#n.delete(r))};ensure(e,t){var r=ce,s=Nf();if(t&&!this.#t.has(e)&&!this.#n.has(e))if(s){var i=document.createDocumentFragment(),a=Zn();i.append(a),this.#n.set(e,{effect:ct(()=>t(a)),fragment:i})}else this.#t.set(e,ct(()=>t(this.anchor)));if(this.#e.set(r,e),s){for(const[c,l]of this.#t)c===e?r.skipped_effects.delete(l):r.skipped_effects.add(l);for(const[c,l]of this.#n)c===e?r.skipped_effects.delete(l.effect):r.skipped_effects.add(l.effect);r.oncommit(this.#c),r.ondiscard(this.#o)}else this.#c()}}function ht(n,e,t=!1){var r=new f_(n),s=t?Xn:0;function i(a,c){r.ensure(a,c)}vc(()=>{var a=!1;e((c,l=!0)=>{a=!0,i(l,c)}),a||i(!1,null)},s)}function Gf(n,e){return e}function d_(n,e,t){for(var r=n.items,s=[],i=e.length,a=0;a<i;a++)Ec(e[a].e,s,!0);var c=i>0&&s.length===0&&t!==null;if(c){var l=t.parentNode;qg(l),l.append(t),r.clear(),Tt(n,e[0].prev,e[i-1].next)}xf(s,()=>{for(var h=0;h<i;h++){var d=e[h];c||(r.delete(d.k),Tt(n,d.prev,d.next)),ze(d.e,!c)}})}function Kf(n,e,t,r,s,i=null){var a=n,c={flags:e,items:new Map,first:null};{var l=n;a=l.appendChild(Zn())}var h=null,d=!1,g=new Map,m=vo(()=>{var C=t();return ho(C)?C:C==null?[]:dc(C)}),T,S;function P(){p_(S,T,c,g,a,s,e,r,t),i!==null&&(T.length===0?h?Tc(h):h=ct(()=>i(a)):h!==null&&br(h,()=>{h=null}))}vc(()=>{S??=te,T=O(m);var C=T.length;if(!(d&&C===0)){d=C===0;var L,V,N,F;if(Nf()){var W=new Set,K=ce;for(V=0;V<C;V+=1){N=T[V],F=r(N,V);var w=c.items.get(F)??g.get(F);w?Qf(w,N,V):(L=Xf(null,c,null,null,N,F,V,s,e,t,!0),g.set(F,L)),W.add(F)}for(const[_,y]of c.items)W.has(_)||K.skipped_effects.add(y.e);K.oncommit(P)}else P();O(m)}})}function p_(n,e,t,r,s,i,a,c,l){var h=e.length,d=t.items,g=t.first,m=g,T,S=null,P=[],C=[],L,V,N,F;for(F=0;F<h;F+=1){if(L=e[F],V=c(L,F),N=d.get(V),N===void 0){var W=r.get(V);if(W!==void 0){r.delete(V),d.set(V,W);var K=S?S.next:m;Tt(t,S,W),Tt(t,W,K),ma(W,K,s),S=W}else{var w=m?m.e.nodes_start:s;S=Xf(w,t,S,S===null?t.first:S.next,L,V,F,i,a,l)}d.set(V,S),P=[],C=[],m=S.next;continue}if(Qf(N,L,F),(N.e.f&et)!==0&&Tc(N.e),N!==m){if(T!==void 0&&T.has(N)){if(P.length<C.length){var _=C[0],y;S=_.prev;var I=P[0],E=P[P.length-1];for(y=0;y<P.length;y+=1)ma(P[y],_,s);for(y=0;y<C.length;y+=1)T.delete(C[y]);Tt(t,I.prev,E.next),Tt(t,S,I),Tt(t,E,_),m=_,S=E,F-=1,P=[],C=[]}else T.delete(N),ma(N,m,s),Tt(t,N.prev,N.next),Tt(t,N,S===null?t.first:S.next),Tt(t,S,N),S=N;continue}for(P=[],C=[];m!==null&&m.k!==V;)(m.e.f&et)===0&&(T??=new Set).add(m),C.push(m),m=m.next;if(m===null)continue;N=m}P.push(N),S=N,m=N.next}if(m!==null||T!==void 0){for(var A=T===void 0?[]:dc(T);m!==null;)(m.e.f&et)===0&&A.push(m),m=m.next;var v=A.length;if(v>0){var re=h===0?s:null;d_(t,A,re)}}n.first=t.first&&t.first.e,n.last=S&&S.e;for(var Be of r.values())ze(Be.e);r.clear()}function Qf(n,e,t,r){Ls(n.v,e),n.i=t}function Xf(n,e,t,r,s,i,a,c,l,h,d){var g=(l&dg)!==0,m=(l&mg)===0,T=g?m?he(s,!1,!1):Yn(s):s,S=(l&pg)===0?a:Yn(a),P={i:S,v:T,k:i,a:null,e:null,prev:t,next:r};try{if(n===null){var C=document.createDocumentFragment();C.append(n=Zn())}return P.e=ct(()=>c(n,T,S,h),Sg),P.e.prev=t&&t.e,P.e.next=r&&r.e,t===null?d||(e.first=P):(t.next=P,t.e.next=P.e),r!==null&&(r.prev=P,r.e.prev=P.e),P}finally{}}function ma(n,e,t){for(var r=n.next?n.next.e.nodes_start:t,s=e?e.e.nodes_start:t,i=n.e.nodes_start;i!==null&&i!==r;){var a=Ks(i);s.before(i),i=a}}function Tt(n,e,t){e===null?n.first=t:(e.next=t,e.e.next=t&&t.e),t!==null&&(t.prev=e,t.e.prev=e&&e.e)}function Ic(n,e,t,r,s){var i=e.$$slots?.[t],a=!1;i===!0&&(i=e.children,a=!0),i===void 0||i(n,a?()=>r:r)}const Pl=[...` 	
\r\fÂ \v\uFEFF`];function m_(n,e,t){var r=n==null?"":""+n;if(t){for(var s in t)if(t[s])r=r?r+" "+s:s;else if(r.length)for(var i=s.length,a=0;(a=r.indexOf(s,a))>=0;){var c=a+i;(a===0||Pl.includes(r[a-1]))&&(c===r.length||Pl.includes(r[c]))?r=(a===0?"":r.substring(0,a))+r.substring(c+1):a=c}}return r===""?null:r}function g_(n,e){return n==null?null:String(n)}function bn(n,e,t,r,s,i){var a=n.__className;if(a!==t||a===void 0){var c=m_(t,r,i);c==null?n.removeAttribute("class"):n.className=c,n.__className=t}else if(i&&s!==i)for(var l in i){var h=!!i[l];(s==null||h!==!!s[l])&&n.classList.toggle(l,h)}return i}function __(n,e,t,r){var s=n.__style;if(s!==e){var i=g_(e);i==null?n.removeAttribute("style"):n.style.cssText=i,n.__style=e}return r}const y_=Symbol("is custom element"),v_=Symbol("is html");function Sr(n,e,t,r){var s=E_(n);s[e]!==(s[e]=t)&&(e==="loading"&&(n[ng]=t),t==null?n.removeAttribute(e):typeof t!="string"&&T_(n).includes(e)?n[e]=t:n.setAttribute(e,t))}function E_(n){return n.__attributes??={[y_]:n.nodeName.includes("-"),[v_]:n.namespaceURI===Ag}}var Cl=new Map;function T_(n){var e=n.getAttribute("is")||n.nodeName,t=Cl.get(e);if(t)return t;Cl.set(e,t=[]);for(var r,s=n,i=Element.prototype;i!==s;){r=hf(s);for(var a in r)r[a].set&&t.push(a);s=pc(s)}return t}const w_=()=>performance.now(),Wt={tick:n=>requestAnimationFrame(n),now:()=>w_(),tasks:new Set};function Jf(){const n=Wt.now();Wt.tasks.forEach(e=>{e.c(n)||(Wt.tasks.delete(e),e.f())}),Wt.tasks.size!==0&&Wt.tick(Jf)}function I_(n){let e;return Wt.tasks.size===0&&Wt.tick(Jf),{promise:new Promise(t=>{Wt.tasks.add(e={c:n,f:t})}),abort(){Wt.tasks.delete(e)}}}function vi(n,e){Qr(()=>{n.dispatchEvent(new CustomEvent(e))})}function A_(n){if(n==="float")return"cssFloat";if(n==="offset")return"cssOffset";if(n.startsWith("--"))return n;const e=n.split("-");return e.length===1?e[0]:e[0]+e.slice(1).map(t=>t[0].toUpperCase()+t.slice(1)).join("")}function kl(n){const e={},t=n.split(";");for(const r of t){const[s,i]=r.split(":");if(!s||i===void 0)break;const a=A_(s.trim());e[a]=i.trim()}return e}const b_=n=>n;function S_(n,e,t,r){var s=(n&Tg)!==0,i="both",a,c=e.inert,l=e.style.overflow,h,d;function g(){return Qr(()=>a??=t()(e,r?.()??{},{direction:i}))}var m={is_global:s,in(){e.inert=c,vi(e,"introstart"),h=Ua(e,g(),d,1,()=>{vi(e,"introend"),h?.abort(),h=a=void 0,e.style.overflow=l})},out(C){e.inert=!0,vi(e,"outrostart"),d=Ua(e,g(),h,0,()=>{vi(e,"outroend"),C?.()})},stop:()=>{h?.abort(),d?.abort()}},T=te;if((T.transitions??=[]).push(m),Fa){var S=s;if(!S){for(var P=T.parent;P&&(P.f&Xn)!==0;)for(;(P=P.parent)&&(P.f&Ft)===0;);S=!P||(P.f&go)!==0}S&&Qg(()=>{Pe(()=>m.in())})}}function Ua(n,e,t,r,s){var i=r===1;if(Zm(e)){var a,c=!1;return Gs(()=>{if(!c){var C=e({direction:i?"in":"out"});a=Ua(n,C,t,r,s)}}),{abort:()=>{c=!0,a?.abort()},deactivate:()=>a.deactivate(),reset:()=>a.reset(),t:()=>a.t()}}if(t?.deactivate(),!e?.duration)return s(),{abort:ut,deactivate:ut,reset:ut,t:()=>r};const{delay:l=0,css:h,tick:d,easing:g=b_}=e;var m=[];if(i&&t===void 0&&(d&&d(0,1),h)){var T=kl(h(0,1));m.push(T,T)}var S=()=>1-r,P=n.animate(m,{duration:l,fill:"forwards"});return P.onfinish=()=>{P.cancel();var C=t?.t()??1-r;t?.abort();var L=r-C,V=e.duration*Math.abs(L),N=[];if(V>0){var F=!1;if(h)for(var W=Math.ceil(V/16.666666666666668),K=0;K<=W;K+=1){var w=C+L*g(K/W),_=kl(h(w,1-w));N.push(_),F||=_.overflow==="hidden"}F&&(n.style.overflow="hidden"),S=()=>{var y=P.currentTime;return C+L*g(y/V)},d&&I_(()=>{if(P.playState!=="running")return!1;var y=S();return d(y,1-y),!0})}P=n.animate(N,{duration:V,fill:"forwards"}),P.onfinish=()=>{S=()=>r,d?.(r,1-r),s()}},{abort:()=>{P&&(P.cancel(),P.effect=null,P.onfinish=ut)},deactivate:()=>{s=ut},reset:()=>{r===0&&d?.(1,0)},t:()=>S()}}function Rr(n,e,t=e){var r=new WeakSet;Hg(n,"input",async s=>{var i=s?n.defaultValue:n.value;if(i=ga(n)?_a(i):i,t(i),ce!==null&&r.add(ce),await n_(),i!==(i=e())){var a=n.selectionStart,c=n.selectionEnd,l=n.value.length;if(n.value=i??"",c!==null){var h=n.value.length;a===c&&c===l&&h>l?(n.selectionStart=h,n.selectionEnd=h):(n.selectionStart=a,n.selectionEnd=Math.min(c,h))}}}),Pe(e)==null&&n.value&&(t(ga(n)?_a(n.value):n.value),ce!==null&&r.add(ce)),To(()=>{var s=e();if(n===document.activeElement){var i=Ri??ce;if(r.has(i))return}ga(n)&&s===_a(n.value)||n.type==="date"&&!s&&!n.value||s!==n.value&&(n.value=s??"")})}function ga(n){var e=n.type;return e==="number"||e==="range"}function _a(n){return n===""?null:+n}function R_(n){return function(...e){var t=e[0];return t.preventDefault(),n?.apply(this,e)}}function ot(n=!1){const e=ie,t=e.l.u;if(!t)return;let r=()=>wc(e.s);if(n){let s=0,i={};const a=yo(()=>{let c=!1;const l=e.s;for(const h in l)l[h]!==i[h]&&(i[h]=l[h],c=!0);return c&&s++,s});r=()=>O(a)}t.b.length&&Gg(()=>{Nl(e,r),ka(t.b)}),Ma(()=>{const s=Pe(()=>t.m.map(eg));return()=>{for(const i of s)typeof i=="function"&&i()}}),t.a.length&&Ma(()=>{Nl(e,r),ka(t.a)})}function Nl(n,e){if(n.l.s)for(const t of n.l.s)O(t);e()}function P_(n,e){var t=n.$$events?.[e.type],r=ho(t)?t.slice():t==null?[]:[t];for(var s of r)s.call(this,e)}function Yf(n,e,t){if(n==null)return e(void 0),ut;const r=Pe(()=>n.subscribe(e,t));return r.unsubscribe?()=>r.unsubscribe():r}const gr=[];function Io(n,e=ut){let t=null;const r=new Set;function s(c){if(gf(n,c)&&(n=c,t)){const l=!gr.length;for(const h of r)h[1](),gr.push(h,n);if(l){for(let h=0;h<gr.length;h+=2)gr[h][0](gr[h+1]);gr.length=0}}}function i(c){s(c(n))}function a(c,l=ut){const h=[c,l];return r.add(h),r.size===1&&(t=e(s,i)||ut),c(n),()=>{r.delete(h),r.size===0&&t&&(t(),t=null)}}return{set:s,update:i,subscribe:a}}function C_(n){let e;return Yf(n,t=>e=t)(),e}let Ei=!1,Ba=Symbol();function Rt(n,e,t){const r=t[e]??={store:null,source:he(void 0),unsubscribe:ut};if(r.store!==n&&!(Ba in t))if(r.unsubscribe(),r.store=n??null,n==null)r.source.v=void 0,r.unsubscribe=ut;else{var s=!0;r.unsubscribe=Yf(n,i=>{s?r.source.v=i:$(r.source,i)}),s=!1}return n&&Ba in t?C_(n):O(r.source)}function Jr(){const n={};function e(){yc(()=>{for(var t in n)n[t].unsubscribe();lf(n,Ba,{enumerable:!1,value:!0})})}return[n,e]}function k_(n){var e=Ei;try{return Ei=!1,[n(),Ei]}finally{Ei=e}}function Te(n,e,t,r){var s=!Kr||(t&_g)!==0,i=(t&vg)!==0,a=(t&Eg)!==0,c=r,l=!0,h=()=>(l&&(l=!1,c=a?Pe(r):r),c),d;if(i){var g=Ar in n||tg in n;d=Ir(n,e)?.set??(g&&e in n?N=>n[e]=N:void 0)}var m,T=!1;i?[m,T]=k_(()=>n[e]):m=n[e],m===void 0&&r!==void 0&&(m=h(),d&&(s&&cg(),d(m)));var S;if(s?S=()=>{var N=n[e];return N===void 0?h():(l=!0,N)}:S=()=>{var N=n[e];return N!==void 0&&(c=void 0),N===void 0?c:N},s&&(t&yg)===0)return S;if(d){var P=n.$$legacy;return(function(N,F){return arguments.length>0?((!s||!F||P||T)&&d(F?S():N),N):S()})}var C=!1,L=((t&gg)!==0?yo:vo)(()=>(C=!1,S()));i&&O(L);var V=te;return(function(N,F){if(arguments.length>0){const W=F?O(L):s&&i?wr(N):N;return $(L,W),C=!0,c!==void 0&&(c=W),N}return ar&&C||(V.f&_n)!==0?L.v:O(L)})}function N_(n){ie===null&&gc(),Kr&&ie.l!==null?V_(ie).m.push(n):Ma(()=>{const e=Pe(n);if(typeof e=="function")return e})}function D_(n,e,{bubbles:t=!1,cancelable:r=!1}={}){return new CustomEvent(n,{detail:e,bubbles:t,cancelable:r})}function Ao(){const n=ie;return n===null&&gc(),(e,t,r)=>{const s=n.s.$$events?.[e];if(s){const i=ho(s)?s.slice():[s],a=D_(e,t,r);for(const c of i)c.call(n.x,a);return!a.defaultPrevented}return!0}}function V_(n){var e=n.l;return e.u??={a:[],b:[],m:[]}}const O_="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(O_);Pg();const M_=()=>{};var Dl={};const Zf=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let s=n.charCodeAt(r);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},L_=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const s=n[t++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=n[t++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=n[t++],a=n[t++],c=n[t++],l=((s&7)<<18|(i&63)<<12|(a&63)<<6|c&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const i=n[t++],a=n[t++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|a&63)}}return e.join("")},ed={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<n.length;s+=3){const i=n[s],a=s+1<n.length,c=a?n[s+1]:0,l=s+2<n.length,h=l?n[s+2]:0,d=i>>2,g=(i&3)<<4|c>>4;let m=(c&15)<<2|h>>6,T=h&63;l||(T=64,a||(m=64)),r.push(t[d],t[g],t[m],t[T])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(Zf(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):L_(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<n.length;){const i=t[n.charAt(s++)],c=s<n.length?t[n.charAt(s)]:0;++s;const h=s<n.length?t[n.charAt(s)]:64;++s;const g=s<n.length?t[n.charAt(s)]:64;if(++s,i==null||c==null||h==null||g==null)throw new x_;const m=i<<2|c>>4;if(r.push(m),h!==64){const T=c<<4&240|h>>2;if(r.push(T),g!==64){const S=h<<6&192|g;r.push(S)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class x_ extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const F_=function(n){const e=Zf(n);return ed.encodeByteArray(e,!0)},ji=function(n){return F_(n).replace(/\./g,"")},td=function(n){try{return ed.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function U_(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const B_=()=>U_().__FIREBASE_DEFAULTS__,$_=()=>{if(typeof process>"u"||typeof Dl>"u")return;const n=Dl.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},j_=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&td(n[1]);return e&&JSON.parse(e)},bo=()=>{try{return M_()||B_()||$_()||j_()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},nd=n=>bo()?.emulatorHosts?.[n],rd=n=>{const e=nd(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},sd=()=>bo()?.config,id=n=>bo()?.[`_${n}`];class q_{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}function Vn(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Ac(n){return(await fetch(n,{credentials:"include"})).ok}function z_(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",s=n.iat||0,i=n.sub||n.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a={iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...n};return[ji(JSON.stringify(t)),ji(JSON.stringify(a)),""].join(".")}const Cs={};function H_(){const n={prod:[],emulator:[]};for(const e of Object.keys(Cs))Cs[e]?n.emulator.push(e):n.prod.push(e);return n}function W_(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let Vl=!1;function bc(n,e){if(typeof window>"u"||typeof document>"u"||!Vn(window.location.host)||Cs[n]===e||Cs[n]||Vl)return;Cs[n]=e;function t(m){return`__firebase__banner__${m}`}const r="__firebase__banner",i=H_().prod.length>0;function a(){const m=document.getElementById(r);m&&m.remove()}function c(m){m.style.display="flex",m.style.background="#7faaf0",m.style.position="fixed",m.style.bottom="5px",m.style.left="5px",m.style.padding=".5em",m.style.borderRadius="5px",m.style.alignItems="center"}function l(m,T){m.setAttribute("width","24"),m.setAttribute("id",T),m.setAttribute("height","24"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.style.marginLeft="-6px"}function h(){const m=document.createElement("span");return m.style.cursor="pointer",m.style.marginLeft="16px",m.style.fontSize="24px",m.innerHTML=" &times;",m.onclick=()=>{Vl=!0,a()},m}function d(m,T){m.setAttribute("id",T),m.innerText="Learn more",m.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",m.setAttribute("target","__blank"),m.style.paddingLeft="5px",m.style.textDecoration="underline"}function g(){const m=W_(r),T=t("text"),S=document.getElementById(T)||document.createElement("span"),P=t("learnmore"),C=document.getElementById(P)||document.createElement("a"),L=t("preprendIcon"),V=document.getElementById(L)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.created){const N=m.element;c(N),d(C,P);const F=h();l(V,L),N.append(V,S,C,F),document.body.appendChild(N)}i?(S.innerText="Preview backend disconnected.",V.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(V.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,S.innerText="Preview backend running in this workspace."),S.setAttribute("id",T)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",g):g()}function Ue(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function G_(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ue())}function K_(){const n=bo()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Q_(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function X_(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function J_(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Y_(){const n=Ue();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function Z_(){return!K_()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function ey(){try{return typeof indexedDB=="object"}catch{return!1}}function ty(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{e(s.error?.message||"")}}catch(t){e(t)}})}const ny="FirebaseError";class $t extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=ny,Object.setPrototypeOf(this,$t.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Qs.prototype.create)}}class Qs{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},s=`${this.service}/${e}`,i=this.errors[e],a=i?ry(i,r):"Error",c=`${this.serviceName}: ${a} (${s}).`;return new $t(s,c,r)}}function ry(n,e){return n.replace(sy,(t,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const sy=/\{\$([^}]+)}/g;function iy(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function er(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const s of t){if(!r.includes(s))return!1;const i=n[s],a=e[s];if(Ol(i)&&Ol(a)){if(!er(i,a))return!1}else if(i!==a)return!1}for(const s of r)if(!t.includes(s))return!1;return!0}function Ol(n){return n!==null&&typeof n=="object"}function Xs(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function oy(n,e){const t=new ay(n,e);return t.subscribe.bind(t)}class ay{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let s;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");cy(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:r},s.next===void 0&&(s.next=ya),s.error===void 0&&(s.error=ya),s.complete===void 0&&(s.complete=ya);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function cy(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function ya(){}function ve(n){return n&&n._delegate?n._delegate:n}class Sn{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const $n="[DEFAULT]";class uy{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new q_;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(hy(e))try{this.getOrInitializeService({instanceIdentifier:$n})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=$n){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=$n){return this.instances.has(e)}getOptions(e=$n){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[i,a]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(i);r===c&&a.resolve(s)}return s}onInit(e,t){const r=this.normalizeInstanceIdentifier(t),s=this.onInitCallbacks.get(r)??new Set;s.add(e),this.onInitCallbacks.set(r,s);const i=this.instances.get(r);return i&&e(i,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const s of r)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:ly(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=$n){return this.component?this.component.multipleInstances?e:$n:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function ly(n){return n===$n?void 0:n}function hy(n){return n.instantiationMode==="EAGER"}class fy{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new uy(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var Q;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Q||(Q={}));const dy={debug:Q.DEBUG,verbose:Q.VERBOSE,info:Q.INFO,warn:Q.WARN,error:Q.ERROR,silent:Q.SILENT},py=Q.INFO,my={[Q.DEBUG]:"log",[Q.VERBOSE]:"log",[Q.INFO]:"info",[Q.WARN]:"warn",[Q.ERROR]:"error"},gy=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),s=my[e];if(s)console[s](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Sc{constructor(e){this.name=e,this._logLevel=py,this._logHandler=gy,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Q))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?dy[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Q.DEBUG,...e),this._logHandler(this,Q.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Q.VERBOSE,...e),this._logHandler(this,Q.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Q.INFO,...e),this._logHandler(this,Q.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Q.WARN,...e),this._logHandler(this,Q.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Q.ERROR,...e),this._logHandler(this,Q.ERROR,...e)}}const _y=(n,e)=>e.some(t=>n instanceof t);let Ml,Ll;function yy(){return Ml||(Ml=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function vy(){return Ll||(Ll=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const od=new WeakMap,$a=new WeakMap,ad=new WeakMap,va=new WeakMap,Rc=new WeakMap;function Ey(n){const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("success",i),n.removeEventListener("error",a)},i=()=>{t(En(n.result)),s()},a=()=>{r(n.error),s()};n.addEventListener("success",i),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&od.set(t,n)}).catch(()=>{}),Rc.set(e,n),e}function Ty(n){if($a.has(n))return;const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("complete",i),n.removeEventListener("error",a),n.removeEventListener("abort",a)},i=()=>{t(),s()},a=()=>{r(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",i),n.addEventListener("error",a),n.addEventListener("abort",a)});$a.set(n,e)}let ja={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return $a.get(n);if(e==="objectStoreNames")return n.objectStoreNames||ad.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return En(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function wy(n){ja=n(ja)}function Iy(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(Ea(this),e,...t);return ad.set(r,e.sort?e.sort():[e]),En(r)}:vy().includes(n)?function(...e){return n.apply(Ea(this),e),En(od.get(this))}:function(...e){return En(n.apply(Ea(this),e))}}function Ay(n){return typeof n=="function"?Iy(n):(n instanceof IDBTransaction&&Ty(n),_y(n,yy())?new Proxy(n,ja):n)}function En(n){if(n instanceof IDBRequest)return Ey(n);if(va.has(n))return va.get(n);const e=Ay(n);return e!==n&&(va.set(n,e),Rc.set(e,n)),e}const Ea=n=>Rc.get(n);function by(n,e,{blocked:t,upgrade:r,blocking:s,terminated:i}={}){const a=indexedDB.open(n,e),c=En(a);return r&&a.addEventListener("upgradeneeded",l=>{r(En(a.result),l.oldVersion,l.newVersion,En(a.transaction),l)}),t&&a.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),c.then(l=>{i&&l.addEventListener("close",()=>i()),s&&l.addEventListener("versionchange",h=>s(h.oldVersion,h.newVersion,h))}).catch(()=>{}),c}const Sy=["get","getKey","getAll","getAllKeys","count"],Ry=["put","add","delete","clear"],Ta=new Map;function xl(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Ta.get(e))return Ta.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,s=Ry.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(s||Sy.includes(t)))return;const i=async function(a,...c){const l=this.transaction(a,s?"readwrite":"readonly");let h=l.store;return r&&(h=h.index(c.shift())),(await Promise.all([h[t](...c),s&&l.done]))[0]};return Ta.set(e,i),i}wy(n=>({...n,get:(e,t,r)=>xl(e,t)||n.get(e,t,r),has:(e,t)=>!!xl(e,t)||n.has(e,t)}));class Py{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(Cy(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function Cy(n){return n.getComponent()?.type==="VERSION"}const qa="@firebase/app",Fl="0.14.5";const Yt=new Sc("@firebase/app"),ky="@firebase/app-compat",Ny="@firebase/analytics-compat",Dy="@firebase/analytics",Vy="@firebase/app-check-compat",Oy="@firebase/app-check",My="@firebase/auth",Ly="@firebase/auth-compat",xy="@firebase/database",Fy="@firebase/data-connect",Uy="@firebase/database-compat",By="@firebase/functions",$y="@firebase/functions-compat",jy="@firebase/installations",qy="@firebase/installations-compat",zy="@firebase/messaging",Hy="@firebase/messaging-compat",Wy="@firebase/performance",Gy="@firebase/performance-compat",Ky="@firebase/remote-config",Qy="@firebase/remote-config-compat",Xy="@firebase/storage",Jy="@firebase/storage-compat",Yy="@firebase/firestore",Zy="@firebase/ai",ev="@firebase/firestore-compat",tv="firebase",nv="12.5.0";const za="[DEFAULT]",rv={[qa]:"fire-core",[ky]:"fire-core-compat",[Dy]:"fire-analytics",[Ny]:"fire-analytics-compat",[Oy]:"fire-app-check",[Vy]:"fire-app-check-compat",[My]:"fire-auth",[Ly]:"fire-auth-compat",[xy]:"fire-rtdb",[Fy]:"fire-data-connect",[Uy]:"fire-rtdb-compat",[By]:"fire-fn",[$y]:"fire-fn-compat",[jy]:"fire-iid",[qy]:"fire-iid-compat",[zy]:"fire-fcm",[Hy]:"fire-fcm-compat",[Wy]:"fire-perf",[Gy]:"fire-perf-compat",[Ky]:"fire-rc",[Qy]:"fire-rc-compat",[Xy]:"fire-gcs",[Jy]:"fire-gcs-compat",[Yy]:"fire-fst",[ev]:"fire-fst-compat",[Zy]:"fire-vertex","fire-js":"fire-js",[tv]:"fire-js-all"};const qi=new Map,sv=new Map,Ha=new Map;function Ul(n,e){try{n.container.addComponent(e)}catch(t){Yt.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function tr(n){const e=n.name;if(Ha.has(e))return Yt.debug(`There were multiple attempts to register component ${e}.`),!1;Ha.set(e,n);for(const t of qi.values())Ul(t,n);for(const t of sv.values())Ul(t,n);return!0}function So(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function st(n){return n==null?!1:n.settings!==void 0}const iv={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Tn=new Qs("app","Firebase",iv);class ov{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Sn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Tn.create("app-deleted",{appName:this._name})}}const Yr=nv;function cd(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r={name:za,automaticDataCollectionEnabled:!0,...e},s=r.name;if(typeof s!="string"||!s)throw Tn.create("bad-app-name",{appName:String(s)});if(t||(t=sd()),!t)throw Tn.create("no-options");const i=qi.get(s);if(i){if(er(t,i.options)&&er(r,i.config))return i;throw Tn.create("duplicate-app",{appName:s})}const a=new fy(s);for(const l of Ha.values())a.addComponent(l);const c=new ov(t,r,a);return qi.set(s,c),c}function Pc(n=za){const e=qi.get(n);if(!e&&n===za&&sd())return cd();if(!e)throw Tn.create("no-app",{appName:n});return e}function Pt(n,e,t){let r=rv[n]??n;t&&(r+=`-${t}`);const s=r.match(/\s|\//),i=e.match(/\s|\//);if(s||i){const a=[`Unable to register library "${r}" with version "${e}":`];s&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&i&&a.push("and"),i&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Yt.warn(a.join(" "));return}tr(new Sn(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}const av="firebase-heartbeat-database",cv=1,Fs="firebase-heartbeat-store";let wa=null;function ud(){return wa||(wa=by(av,cv,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Fs)}catch(t){console.warn(t)}}}}).catch(n=>{throw Tn.create("idb-open",{originalErrorMessage:n.message})})),wa}async function uv(n){try{const t=(await ud()).transaction(Fs),r=await t.objectStore(Fs).get(ld(n));return await t.done,r}catch(e){if(e instanceof $t)Yt.warn(e.message);else{const t=Tn.create("idb-get",{originalErrorMessage:e?.message});Yt.warn(t.message)}}}async function Bl(n,e){try{const r=(await ud()).transaction(Fs,"readwrite");await r.objectStore(Fs).put(e,ld(n)),await r.done}catch(t){if(t instanceof $t)Yt.warn(t.message);else{const r=Tn.create("idb-set",{originalErrorMessage:t?.message});Yt.warn(r.message)}}}function ld(n){return`${n.name}!${n.options.appId}`}const lv=1024,hv=30;class fv{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new pv(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=$l();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(s=>s.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:t}),this._heartbeatsCache.heartbeats.length>hv){const s=mv(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(s,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Yt.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=$l(),{heartbeatsToSend:t,unsentEntries:r}=dv(this._heartbeatsCache.heartbeats),s=ji(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(e){return Yt.warn(e),""}}}function $l(){return new Date().toISOString().substring(0,10)}function dv(n,e=lv){const t=[];let r=n.slice();for(const s of n){const i=t.find(a=>a.agent===s.agent);if(i){if(i.dates.push(s.date),jl(t)>e){i.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),jl(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class pv{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return ey()?ty().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await uv(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Bl(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Bl(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function jl(n){return ji(JSON.stringify({version:2,heartbeats:n})).length}function mv(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function gv(n){tr(new Sn("platform-logger",e=>new Py(e),"PRIVATE")),tr(new Sn("heartbeat",e=>new fv(e),"PRIVATE")),Pt(qa,Fl,n),Pt(qa,Fl,"esm2020"),Pt("fire-js","")}gv("");var _v="firebase",yv="12.5.0";Pt(_v,yv,"app");var ql=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var wn,hd;(function(){var n;function e(w,_){function y(){}y.prototype=_.prototype,w.F=_.prototype,w.prototype=new y,w.prototype.constructor=w,w.D=function(I,E,A){for(var v=Array(arguments.length-2),re=2;re<arguments.length;re++)v[re-2]=arguments[re];return _.prototype[E].apply(I,v)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(w,_,y){y||(y=0);const I=Array(16);if(typeof _=="string")for(var E=0;E<16;++E)I[E]=_.charCodeAt(y++)|_.charCodeAt(y++)<<8|_.charCodeAt(y++)<<16|_.charCodeAt(y++)<<24;else for(E=0;E<16;++E)I[E]=_[y++]|_[y++]<<8|_[y++]<<16|_[y++]<<24;_=w.g[0],y=w.g[1],E=w.g[2];let A=w.g[3],v;v=_+(A^y&(E^A))+I[0]+3614090360&4294967295,_=y+(v<<7&4294967295|v>>>25),v=A+(E^_&(y^E))+I[1]+3905402710&4294967295,A=_+(v<<12&4294967295|v>>>20),v=E+(y^A&(_^y))+I[2]+606105819&4294967295,E=A+(v<<17&4294967295|v>>>15),v=y+(_^E&(A^_))+I[3]+3250441966&4294967295,y=E+(v<<22&4294967295|v>>>10),v=_+(A^y&(E^A))+I[4]+4118548399&4294967295,_=y+(v<<7&4294967295|v>>>25),v=A+(E^_&(y^E))+I[5]+1200080426&4294967295,A=_+(v<<12&4294967295|v>>>20),v=E+(y^A&(_^y))+I[6]+2821735955&4294967295,E=A+(v<<17&4294967295|v>>>15),v=y+(_^E&(A^_))+I[7]+4249261313&4294967295,y=E+(v<<22&4294967295|v>>>10),v=_+(A^y&(E^A))+I[8]+1770035416&4294967295,_=y+(v<<7&4294967295|v>>>25),v=A+(E^_&(y^E))+I[9]+2336552879&4294967295,A=_+(v<<12&4294967295|v>>>20),v=E+(y^A&(_^y))+I[10]+4294925233&4294967295,E=A+(v<<17&4294967295|v>>>15),v=y+(_^E&(A^_))+I[11]+2304563134&4294967295,y=E+(v<<22&4294967295|v>>>10),v=_+(A^y&(E^A))+I[12]+1804603682&4294967295,_=y+(v<<7&4294967295|v>>>25),v=A+(E^_&(y^E))+I[13]+4254626195&4294967295,A=_+(v<<12&4294967295|v>>>20),v=E+(y^A&(_^y))+I[14]+2792965006&4294967295,E=A+(v<<17&4294967295|v>>>15),v=y+(_^E&(A^_))+I[15]+1236535329&4294967295,y=E+(v<<22&4294967295|v>>>10),v=_+(E^A&(y^E))+I[1]+4129170786&4294967295,_=y+(v<<5&4294967295|v>>>27),v=A+(y^E&(_^y))+I[6]+3225465664&4294967295,A=_+(v<<9&4294967295|v>>>23),v=E+(_^y&(A^_))+I[11]+643717713&4294967295,E=A+(v<<14&4294967295|v>>>18),v=y+(A^_&(E^A))+I[0]+3921069994&4294967295,y=E+(v<<20&4294967295|v>>>12),v=_+(E^A&(y^E))+I[5]+3593408605&4294967295,_=y+(v<<5&4294967295|v>>>27),v=A+(y^E&(_^y))+I[10]+38016083&4294967295,A=_+(v<<9&4294967295|v>>>23),v=E+(_^y&(A^_))+I[15]+3634488961&4294967295,E=A+(v<<14&4294967295|v>>>18),v=y+(A^_&(E^A))+I[4]+3889429448&4294967295,y=E+(v<<20&4294967295|v>>>12),v=_+(E^A&(y^E))+I[9]+568446438&4294967295,_=y+(v<<5&4294967295|v>>>27),v=A+(y^E&(_^y))+I[14]+3275163606&4294967295,A=_+(v<<9&4294967295|v>>>23),v=E+(_^y&(A^_))+I[3]+4107603335&4294967295,E=A+(v<<14&4294967295|v>>>18),v=y+(A^_&(E^A))+I[8]+1163531501&4294967295,y=E+(v<<20&4294967295|v>>>12),v=_+(E^A&(y^E))+I[13]+2850285829&4294967295,_=y+(v<<5&4294967295|v>>>27),v=A+(y^E&(_^y))+I[2]+4243563512&4294967295,A=_+(v<<9&4294967295|v>>>23),v=E+(_^y&(A^_))+I[7]+1735328473&4294967295,E=A+(v<<14&4294967295|v>>>18),v=y+(A^_&(E^A))+I[12]+2368359562&4294967295,y=E+(v<<20&4294967295|v>>>12),v=_+(y^E^A)+I[5]+4294588738&4294967295,_=y+(v<<4&4294967295|v>>>28),v=A+(_^y^E)+I[8]+2272392833&4294967295,A=_+(v<<11&4294967295|v>>>21),v=E+(A^_^y)+I[11]+1839030562&4294967295,E=A+(v<<16&4294967295|v>>>16),v=y+(E^A^_)+I[14]+4259657740&4294967295,y=E+(v<<23&4294967295|v>>>9),v=_+(y^E^A)+I[1]+2763975236&4294967295,_=y+(v<<4&4294967295|v>>>28),v=A+(_^y^E)+I[4]+1272893353&4294967295,A=_+(v<<11&4294967295|v>>>21),v=E+(A^_^y)+I[7]+4139469664&4294967295,E=A+(v<<16&4294967295|v>>>16),v=y+(E^A^_)+I[10]+3200236656&4294967295,y=E+(v<<23&4294967295|v>>>9),v=_+(y^E^A)+I[13]+681279174&4294967295,_=y+(v<<4&4294967295|v>>>28),v=A+(_^y^E)+I[0]+3936430074&4294967295,A=_+(v<<11&4294967295|v>>>21),v=E+(A^_^y)+I[3]+3572445317&4294967295,E=A+(v<<16&4294967295|v>>>16),v=y+(E^A^_)+I[6]+76029189&4294967295,y=E+(v<<23&4294967295|v>>>9),v=_+(y^E^A)+I[9]+3654602809&4294967295,_=y+(v<<4&4294967295|v>>>28),v=A+(_^y^E)+I[12]+3873151461&4294967295,A=_+(v<<11&4294967295|v>>>21),v=E+(A^_^y)+I[15]+530742520&4294967295,E=A+(v<<16&4294967295|v>>>16),v=y+(E^A^_)+I[2]+3299628645&4294967295,y=E+(v<<23&4294967295|v>>>9),v=_+(E^(y|~A))+I[0]+4096336452&4294967295,_=y+(v<<6&4294967295|v>>>26),v=A+(y^(_|~E))+I[7]+1126891415&4294967295,A=_+(v<<10&4294967295|v>>>22),v=E+(_^(A|~y))+I[14]+2878612391&4294967295,E=A+(v<<15&4294967295|v>>>17),v=y+(A^(E|~_))+I[5]+4237533241&4294967295,y=E+(v<<21&4294967295|v>>>11),v=_+(E^(y|~A))+I[12]+1700485571&4294967295,_=y+(v<<6&4294967295|v>>>26),v=A+(y^(_|~E))+I[3]+2399980690&4294967295,A=_+(v<<10&4294967295|v>>>22),v=E+(_^(A|~y))+I[10]+4293915773&4294967295,E=A+(v<<15&4294967295|v>>>17),v=y+(A^(E|~_))+I[1]+2240044497&4294967295,y=E+(v<<21&4294967295|v>>>11),v=_+(E^(y|~A))+I[8]+1873313359&4294967295,_=y+(v<<6&4294967295|v>>>26),v=A+(y^(_|~E))+I[15]+4264355552&4294967295,A=_+(v<<10&4294967295|v>>>22),v=E+(_^(A|~y))+I[6]+2734768916&4294967295,E=A+(v<<15&4294967295|v>>>17),v=y+(A^(E|~_))+I[13]+1309151649&4294967295,y=E+(v<<21&4294967295|v>>>11),v=_+(E^(y|~A))+I[4]+4149444226&4294967295,_=y+(v<<6&4294967295|v>>>26),v=A+(y^(_|~E))+I[11]+3174756917&4294967295,A=_+(v<<10&4294967295|v>>>22),v=E+(_^(A|~y))+I[2]+718787259&4294967295,E=A+(v<<15&4294967295|v>>>17),v=y+(A^(E|~_))+I[9]+3951481745&4294967295,w.g[0]=w.g[0]+_&4294967295,w.g[1]=w.g[1]+(E+(v<<21&4294967295|v>>>11))&4294967295,w.g[2]=w.g[2]+E&4294967295,w.g[3]=w.g[3]+A&4294967295}r.prototype.v=function(w,_){_===void 0&&(_=w.length);const y=_-this.blockSize,I=this.C;let E=this.h,A=0;for(;A<_;){if(E==0)for(;A<=y;)s(this,w,A),A+=this.blockSize;if(typeof w=="string"){for(;A<_;)if(I[E++]=w.charCodeAt(A++),E==this.blockSize){s(this,I),E=0;break}}else for(;A<_;)if(I[E++]=w[A++],E==this.blockSize){s(this,I),E=0;break}}this.h=E,this.o+=_},r.prototype.A=function(){var w=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);w[0]=128;for(var _=1;_<w.length-8;++_)w[_]=0;_=this.o*8;for(var y=w.length-8;y<w.length;++y)w[y]=_&255,_/=256;for(this.v(w),w=Array(16),_=0,y=0;y<4;++y)for(let I=0;I<32;I+=8)w[_++]=this.g[y]>>>I&255;return w};function i(w,_){var y=c;return Object.prototype.hasOwnProperty.call(y,w)?y[w]:y[w]=_(w)}function a(w,_){this.h=_;const y=[];let I=!0;for(let E=w.length-1;E>=0;E--){const A=w[E]|0;I&&A==_||(y[E]=A,I=!1)}this.g=y}var c={};function l(w){return-128<=w&&w<128?i(w,function(_){return new a([_|0],_<0?-1:0)}):new a([w|0],w<0?-1:0)}function h(w){if(isNaN(w)||!isFinite(w))return g;if(w<0)return C(h(-w));const _=[];let y=1;for(let I=0;w>=y;I++)_[I]=w/y|0,y*=4294967296;return new a(_,0)}function d(w,_){if(w.length==0)throw Error("number format error: empty string");if(_=_||10,_<2||36<_)throw Error("radix out of range: "+_);if(w.charAt(0)=="-")return C(d(w.substring(1),_));if(w.indexOf("-")>=0)throw Error('number format error: interior "-" character');const y=h(Math.pow(_,8));let I=g;for(let A=0;A<w.length;A+=8){var E=Math.min(8,w.length-A);const v=parseInt(w.substring(A,A+E),_);E<8?(E=h(Math.pow(_,E)),I=I.j(E).add(h(v))):(I=I.j(y),I=I.add(h(v)))}return I}var g=l(0),m=l(1),T=l(16777216);n=a.prototype,n.m=function(){if(P(this))return-C(this).m();let w=0,_=1;for(let y=0;y<this.g.length;y++){const I=this.i(y);w+=(I>=0?I:4294967296+I)*_,_*=4294967296}return w},n.toString=function(w){if(w=w||10,w<2||36<w)throw Error("radix out of range: "+w);if(S(this))return"0";if(P(this))return"-"+C(this).toString(w);const _=h(Math.pow(w,6));var y=this;let I="";for(;;){const E=F(y,_).g;y=L(y,E.j(_));let A=((y.g.length>0?y.g[0]:y.h)>>>0).toString(w);if(y=E,S(y))return A+I;for(;A.length<6;)A="0"+A;I=A+I}},n.i=function(w){return w<0?0:w<this.g.length?this.g[w]:this.h};function S(w){if(w.h!=0)return!1;for(let _=0;_<w.g.length;_++)if(w.g[_]!=0)return!1;return!0}function P(w){return w.h==-1}n.l=function(w){return w=L(this,w),P(w)?-1:S(w)?0:1};function C(w){const _=w.g.length,y=[];for(let I=0;I<_;I++)y[I]=~w.g[I];return new a(y,~w.h).add(m)}n.abs=function(){return P(this)?C(this):this},n.add=function(w){const _=Math.max(this.g.length,w.g.length),y=[];let I=0;for(let E=0;E<=_;E++){let A=I+(this.i(E)&65535)+(w.i(E)&65535),v=(A>>>16)+(this.i(E)>>>16)+(w.i(E)>>>16);I=v>>>16,A&=65535,v&=65535,y[E]=v<<16|A}return new a(y,y[y.length-1]&-2147483648?-1:0)};function L(w,_){return w.add(C(_))}n.j=function(w){if(S(this)||S(w))return g;if(P(this))return P(w)?C(this).j(C(w)):C(C(this).j(w));if(P(w))return C(this.j(C(w)));if(this.l(T)<0&&w.l(T)<0)return h(this.m()*w.m());const _=this.g.length+w.g.length,y=[];for(var I=0;I<2*_;I++)y[I]=0;for(I=0;I<this.g.length;I++)for(let E=0;E<w.g.length;E++){const A=this.i(I)>>>16,v=this.i(I)&65535,re=w.i(E)>>>16,Be=w.i(E)&65535;y[2*I+2*E]+=v*Be,V(y,2*I+2*E),y[2*I+2*E+1]+=A*Be,V(y,2*I+2*E+1),y[2*I+2*E+1]+=v*re,V(y,2*I+2*E+1),y[2*I+2*E+2]+=A*re,V(y,2*I+2*E+2)}for(w=0;w<_;w++)y[w]=y[2*w+1]<<16|y[2*w];for(w=_;w<2*_;w++)y[w]=0;return new a(y,0)};function V(w,_){for(;(w[_]&65535)!=w[_];)w[_+1]+=w[_]>>>16,w[_]&=65535,_++}function N(w,_){this.g=w,this.h=_}function F(w,_){if(S(_))throw Error("division by zero");if(S(w))return new N(g,g);if(P(w))return _=F(C(w),_),new N(C(_.g),C(_.h));if(P(_))return _=F(w,C(_)),new N(C(_.g),_.h);if(w.g.length>30){if(P(w)||P(_))throw Error("slowDivide_ only works with positive integers.");for(var y=m,I=_;I.l(w)<=0;)y=W(y),I=W(I);var E=K(y,1),A=K(I,1);for(I=K(I,2),y=K(y,2);!S(I);){var v=A.add(I);v.l(w)<=0&&(E=E.add(y),A=v),I=K(I,1),y=K(y,1)}return _=L(w,E.j(_)),new N(E,_)}for(E=g;w.l(_)>=0;){for(y=Math.max(1,Math.floor(w.m()/_.m())),I=Math.ceil(Math.log(y)/Math.LN2),I=I<=48?1:Math.pow(2,I-48),A=h(y),v=A.j(_);P(v)||v.l(w)>0;)y-=I,A=h(y),v=A.j(_);S(A)&&(A=m),E=E.add(A),w=L(w,v)}return new N(E,w)}n.B=function(w){return F(this,w).h},n.and=function(w){const _=Math.max(this.g.length,w.g.length),y=[];for(let I=0;I<_;I++)y[I]=this.i(I)&w.i(I);return new a(y,this.h&w.h)},n.or=function(w){const _=Math.max(this.g.length,w.g.length),y=[];for(let I=0;I<_;I++)y[I]=this.i(I)|w.i(I);return new a(y,this.h|w.h)},n.xor=function(w){const _=Math.max(this.g.length,w.g.length),y=[];for(let I=0;I<_;I++)y[I]=this.i(I)^w.i(I);return new a(y,this.h^w.h)};function W(w){const _=w.g.length+1,y=[];for(let I=0;I<_;I++)y[I]=w.i(I)<<1|w.i(I-1)>>>31;return new a(y,w.h)}function K(w,_){const y=_>>5;_%=32;const I=w.g.length-y,E=[];for(let A=0;A<I;A++)E[A]=_>0?w.i(A+y)>>>_|w.i(A+y+1)<<32-_:w.i(A+y);return new a(E,w.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,hd=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.B,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=h,a.fromString=d,wn=a}).apply(typeof ql<"u"?ql:typeof self<"u"?self:typeof window<"u"?window:{});var Ti=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var fd,Is,dd,Pi,Wa,pd,md,gd;(function(){var n,e=Object.defineProperty;function t(o){o=[typeof globalThis=="object"&&globalThis,o,typeof window=="object"&&window,typeof self=="object"&&self,typeof Ti=="object"&&Ti];for(var u=0;u<o.length;++u){var f=o[u];if(f&&f.Math==Math)return f}throw Error("Cannot find global object")}var r=t(this);function s(o,u){if(u)e:{var f=r;o=o.split(".");for(var p=0;p<o.length-1;p++){var b=o[p];if(!(b in f))break e;f=f[b]}o=o[o.length-1],p=f[o],u=u(p),u!=p&&u!=null&&e(f,o,{configurable:!0,writable:!0,value:u})}}s("Symbol.dispose",function(o){return o||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(o){return o||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(o){return o||function(u){var f=[],p;for(p in u)Object.prototype.hasOwnProperty.call(u,p)&&f.push([p,u[p]]);return f}});var i=i||{},a=this||self;function c(o){var u=typeof o;return u=="object"&&o!=null||u=="function"}function l(o,u,f){return o.call.apply(o.bind,arguments)}function h(o,u,f){return h=l,h.apply(null,arguments)}function d(o,u){var f=Array.prototype.slice.call(arguments,1);return function(){var p=f.slice();return p.push.apply(p,arguments),o.apply(this,p)}}function g(o,u){function f(){}f.prototype=u.prototype,o.Z=u.prototype,o.prototype=new f,o.prototype.constructor=o,o.Ob=function(p,b,R){for(var M=Array(arguments.length-2),G=2;G<arguments.length;G++)M[G-2]=arguments[G];return u.prototype[b].apply(p,M)}}var m=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?o=>o&&AsyncContext.Snapshot.wrap(o):o=>o;function T(o){const u=o.length;if(u>0){const f=Array(u);for(let p=0;p<u;p++)f[p]=o[p];return f}return[]}function S(o,u){for(let p=1;p<arguments.length;p++){const b=arguments[p];var f=typeof b;if(f=f!="object"?f:b?Array.isArray(b)?"array":f:"null",f=="array"||f=="object"&&typeof b.length=="number"){f=o.length||0;const R=b.length||0;o.length=f+R;for(let M=0;M<R;M++)o[f+M]=b[M]}else o.push(b)}}class P{constructor(u,f){this.i=u,this.j=f,this.h=0,this.g=null}get(){let u;return this.h>0?(this.h--,u=this.g,this.g=u.next,u.next=null):u=this.i(),u}}function C(o){a.setTimeout(()=>{throw o},0)}function L(){var o=w;let u=null;return o.g&&(u=o.g,o.g=o.g.next,o.g||(o.h=null),u.next=null),u}class V{constructor(){this.h=this.g=null}add(u,f){const p=N.get();p.set(u,f),this.h?this.h.next=p:this.g=p,this.h=p}}var N=new P(()=>new F,o=>o.reset());class F{constructor(){this.next=this.g=this.h=null}set(u,f){this.h=u,this.g=f,this.next=null}reset(){this.next=this.g=this.h=null}}let W,K=!1,w=new V,_=()=>{const o=Promise.resolve(void 0);W=()=>{o.then(y)}};function y(){for(var o;o=L();){try{o.h.call(o.g)}catch(f){C(f)}var u=N;u.j(o),u.h<100&&(u.h++,o.next=u.g,u.g=o)}K=!1}function I(){this.u=this.u,this.C=this.C}I.prototype.u=!1,I.prototype.dispose=function(){this.u||(this.u=!0,this.N())},I.prototype[Symbol.dispose]=function(){this.dispose()},I.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function E(o,u){this.type=o,this.g=this.target=u,this.defaultPrevented=!1}E.prototype.h=function(){this.defaultPrevented=!0};var A=(function(){if(!a.addEventListener||!Object.defineProperty)return!1;var o=!1,u=Object.defineProperty({},"passive",{get:function(){o=!0}});try{const f=()=>{};a.addEventListener("test",f,u),a.removeEventListener("test",f,u)}catch{}return o})();function v(o){return/^[\s\xa0]*$/.test(o)}function re(o,u){E.call(this,o?o.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,o&&this.init(o,u)}g(re,E),re.prototype.init=function(o,u){const f=this.type=o.type,p=o.changedTouches&&o.changedTouches.length?o.changedTouches[0]:null;this.target=o.target||o.srcElement,this.g=u,u=o.relatedTarget,u||(f=="mouseover"?u=o.fromElement:f=="mouseout"&&(u=o.toElement)),this.relatedTarget=u,p?(this.clientX=p.clientX!==void 0?p.clientX:p.pageX,this.clientY=p.clientY!==void 0?p.clientY:p.pageY,this.screenX=p.screenX||0,this.screenY=p.screenY||0):(this.clientX=o.clientX!==void 0?o.clientX:o.pageX,this.clientY=o.clientY!==void 0?o.clientY:o.pageY,this.screenX=o.screenX||0,this.screenY=o.screenY||0),this.button=o.button,this.key=o.key||"",this.ctrlKey=o.ctrlKey,this.altKey=o.altKey,this.shiftKey=o.shiftKey,this.metaKey=o.metaKey,this.pointerId=o.pointerId||0,this.pointerType=o.pointerType,this.state=o.state,this.i=o,o.defaultPrevented&&re.Z.h.call(this)},re.prototype.h=function(){re.Z.h.call(this);const o=this.i;o.preventDefault?o.preventDefault():o.returnValue=!1};var Be="closure_listenable_"+(Math.random()*1e6|0),ss=0;function is(o,u,f,p,b){this.listener=o,this.proxy=null,this.src=u,this.type=f,this.capture=!!p,this.ha=b,this.key=++ss,this.da=this.fa=!1}function jt(o){o.da=!0,o.listener=null,o.proxy=null,o.src=null,o.ha=null}function _t(o,u,f){for(const p in o)u.call(f,o[p],p,o)}function qt(o,u){for(const f in o)u.call(void 0,o[f],f,o)}function rn(o){const u={};for(const f in o)u[f]=o[f];return u}const lr="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function yt(o,u){let f,p;for(let b=1;b<arguments.length;b++){p=arguments[b];for(f in p)o[f]=p[f];for(let R=0;R<lr.length;R++)f=lr[R],Object.prototype.hasOwnProperty.call(p,f)&&(o[f]=p[f])}}function at(o){this.src=o,this.g={},this.h=0}at.prototype.add=function(o,u,f,p,b){const R=o.toString();o=this.g[R],o||(o=this.g[R]=[],this.h++);const M=zt(o,u,p,b);return M>-1?(u=o[M],f||(u.fa=!1)):(u=new is(u,this.src,R,!!p,b),u.fa=f,o.push(u)),u};function hr(o,u){const f=u.type;if(f in o.g){var p=o.g[f],b=Array.prototype.indexOf.call(p,u,void 0),R;(R=b>=0)&&Array.prototype.splice.call(p,b,1),R&&(jt(u),o.g[f].length==0&&(delete o.g[f],o.h--))}}function zt(o,u,f,p){for(let b=0;b<o.length;++b){const R=o[b];if(!R.da&&R.listener==u&&R.capture==!!f&&R.ha==p)return b}return-1}var ii="closure_lm_"+(Math.random()*1e6|0),Ko={};function Tu(o,u,f,p,b){if(Array.isArray(u)){for(let R=0;R<u.length;R++)Tu(o,u[R],f,p,b);return null}return f=Au(f),o&&o[Be]?o.J(u,f,c(p)?!!p.capture:!1,b):Tm(o,u,f,!1,p,b)}function Tm(o,u,f,p,b,R){if(!u)throw Error("Invalid event type");const M=c(b)?!!b.capture:!!b;let G=Xo(o);if(G||(o[ii]=G=new at(o)),f=G.add(u,f,p,M,R),f.proxy)return f;if(p=wm(),f.proxy=p,p.src=o,p.listener=f,o.addEventListener)A||(b=M),b===void 0&&(b=!1),o.addEventListener(u.toString(),p,b);else if(o.attachEvent)o.attachEvent(Iu(u.toString()),p);else if(o.addListener&&o.removeListener)o.addListener(p);else throw Error("addEventListener and attachEvent are unavailable.");return f}function wm(){function o(f){return u.call(o.src,o.listener,f)}const u=Im;return o}function wu(o,u,f,p,b){if(Array.isArray(u))for(var R=0;R<u.length;R++)wu(o,u[R],f,p,b);else p=c(p)?!!p.capture:!!p,f=Au(f),o&&o[Be]?(o=o.i,R=String(u).toString(),R in o.g&&(u=o.g[R],f=zt(u,f,p,b),f>-1&&(jt(u[f]),Array.prototype.splice.call(u,f,1),u.length==0&&(delete o.g[R],o.h--)))):o&&(o=Xo(o))&&(u=o.g[u.toString()],o=-1,u&&(o=zt(u,f,p,b)),(f=o>-1?u[o]:null)&&Qo(f))}function Qo(o){if(typeof o!="number"&&o&&!o.da){var u=o.src;if(u&&u[Be])hr(u.i,o);else{var f=o.type,p=o.proxy;u.removeEventListener?u.removeEventListener(f,p,o.capture):u.detachEvent?u.detachEvent(Iu(f),p):u.addListener&&u.removeListener&&u.removeListener(p),(f=Xo(u))?(hr(f,o),f.h==0&&(f.src=null,u[ii]=null)):jt(o)}}}function Iu(o){return o in Ko?Ko[o]:Ko[o]="on"+o}function Im(o,u){if(o.da)o=!0;else{u=new re(u,this);const f=o.listener,p=o.ha||o.src;o.fa&&Qo(o),o=f.call(p,u)}return o}function Xo(o){return o=o[ii],o instanceof at?o:null}var Jo="__closure_events_fn_"+(Math.random()*1e9>>>0);function Au(o){return typeof o=="function"?o:(o[Jo]||(o[Jo]=function(u){return o.handleEvent(u)}),o[Jo])}function Ve(){I.call(this),this.i=new at(this),this.M=this,this.G=null}g(Ve,I),Ve.prototype[Be]=!0,Ve.prototype.removeEventListener=function(o,u,f,p){wu(this,o,u,f,p)};function $e(o,u){var f,p=o.G;if(p)for(f=[];p;p=p.G)f.push(p);if(o=o.M,p=u.type||u,typeof u=="string")u=new E(u,o);else if(u instanceof E)u.target=u.target||o;else{var b=u;u=new E(p,o),yt(u,b)}b=!0;let R,M;if(f)for(M=f.length-1;M>=0;M--)R=u.g=f[M],b=oi(R,p,!0,u)&&b;if(R=u.g=o,b=oi(R,p,!0,u)&&b,b=oi(R,p,!1,u)&&b,f)for(M=0;M<f.length;M++)R=u.g=f[M],b=oi(R,p,!1,u)&&b}Ve.prototype.N=function(){if(Ve.Z.N.call(this),this.i){var o=this.i;for(const u in o.g){const f=o.g[u];for(let p=0;p<f.length;p++)jt(f[p]);delete o.g[u],o.h--}}this.G=null},Ve.prototype.J=function(o,u,f,p){return this.i.add(String(o),u,!1,f,p)},Ve.prototype.K=function(o,u,f,p){return this.i.add(String(o),u,!0,f,p)};function oi(o,u,f,p){if(u=o.i.g[String(u)],!u)return!0;u=u.concat();let b=!0;for(let R=0;R<u.length;++R){const M=u[R];if(M&&!M.da&&M.capture==f){const G=M.listener,Ee=M.ha||M.src;M.fa&&hr(o.i,M),b=G.call(Ee,p)!==!1&&b}}return b&&!p.defaultPrevented}function Am(o,u){if(typeof o!="function")if(o&&typeof o.handleEvent=="function")o=h(o.handleEvent,o);else throw Error("Invalid listener argument");return Number(u)>2147483647?-1:a.setTimeout(o,u||0)}function bu(o){o.g=Am(()=>{o.g=null,o.i&&(o.i=!1,bu(o))},o.l);const u=o.h;o.h=null,o.m.apply(null,u)}class bm extends I{constructor(u,f){super(),this.m=u,this.l=f,this.h=null,this.i=!1,this.g=null}j(u){this.h=arguments,this.g?this.i=!0:bu(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function os(o){I.call(this),this.h=o,this.g={}}g(os,I);var Su=[];function Ru(o){_t(o.g,function(u,f){this.g.hasOwnProperty(f)&&Qo(u)},o),o.g={}}os.prototype.N=function(){os.Z.N.call(this),Ru(this)},os.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Yo=a.JSON.stringify,Sm=a.JSON.parse,Rm=class{stringify(o){return a.JSON.stringify(o,void 0)}parse(o){return a.JSON.parse(o,void 0)}};function Pu(){}function Cu(){}var as={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Zo(){E.call(this,"d")}g(Zo,E);function ea(){E.call(this,"c")}g(ea,E);var Ln={},ku=null;function ai(){return ku=ku||new Ve}Ln.Ia="serverreachability";function Nu(o){E.call(this,Ln.Ia,o)}g(Nu,E);function cs(o){const u=ai();$e(u,new Nu(u))}Ln.STAT_EVENT="statevent";function Du(o,u){E.call(this,Ln.STAT_EVENT,o),this.stat=u}g(Du,E);function je(o){const u=ai();$e(u,new Du(u,o))}Ln.Ja="timingevent";function Vu(o,u){E.call(this,Ln.Ja,o),this.size=u}g(Vu,E);function us(o,u){if(typeof o!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){o()},u)}function ls(){this.g=!0}ls.prototype.ua=function(){this.g=!1};function Pm(o,u,f,p,b,R){o.info(function(){if(o.g)if(R){var M="",G=R.split("&");for(let se=0;se<G.length;se++){var Ee=G[se].split("=");if(Ee.length>1){const be=Ee[0];Ee=Ee[1];const Et=be.split("_");M=Et.length>=2&&Et[1]=="type"?M+(be+"="+Ee+"&"):M+(be+"=redacted&")}}}else M=null;else M=R;return"XMLHTTP REQ ("+p+") [attempt "+b+"]: "+u+`
`+f+`
`+M})}function Cm(o,u,f,p,b,R,M){o.info(function(){return"XMLHTTP RESP ("+p+") [ attempt "+b+"]: "+u+`
`+f+`
`+R+" "+M})}function fr(o,u,f,p){o.info(function(){return"XMLHTTP TEXT ("+u+"): "+Nm(o,f)+(p?" "+p:"")})}function km(o,u){o.info(function(){return"TIMEOUT: "+u})}ls.prototype.info=function(){};function Nm(o,u){if(!o.g)return u;if(!u)return null;try{const R=JSON.parse(u);if(R){for(o=0;o<R.length;o++)if(Array.isArray(R[o])){var f=R[o];if(!(f.length<2)){var p=f[1];if(Array.isArray(p)&&!(p.length<1)){var b=p[0];if(b!="noop"&&b!="stop"&&b!="close")for(let M=1;M<p.length;M++)p[M]=""}}}}return Yo(R)}catch{return u}}var ci={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Ou={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Mu;function ta(){}g(ta,Pu),ta.prototype.g=function(){return new XMLHttpRequest},Mu=new ta;function hs(o){return encodeURIComponent(String(o))}function Dm(o){var u=1;o=o.split(":");const f=[];for(;u>0&&o.length;)f.push(o.shift()),u--;return o.length&&f.push(o.join(":")),f}function sn(o,u,f,p){this.j=o,this.i=u,this.l=f,this.S=p||1,this.V=new os(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Lu}function Lu(){this.i=null,this.g="",this.h=!1}var xu={},na={};function ra(o,u,f){o.M=1,o.A=li(vt(u)),o.u=f,o.R=!0,Fu(o,null)}function Fu(o,u){o.F=Date.now(),ui(o),o.B=vt(o.A);var f=o.B,p=o.S;Array.isArray(p)||(p=[String(p)]),Ju(f.i,"t",p),o.C=0,f=o.j.L,o.h=new Lu,o.g=ml(o.j,f?u:null,!o.u),o.P>0&&(o.O=new bm(h(o.Y,o,o.g),o.P)),u=o.V,f=o.g,p=o.ba;var b="readystatechange";Array.isArray(b)||(b&&(Su[0]=b.toString()),b=Su);for(let R=0;R<b.length;R++){const M=Tu(f,b[R],p||u.handleEvent,!1,u.h||u);if(!M)break;u.g[M.key]=M}u=o.J?rn(o.J):{},o.u?(o.v||(o.v="POST"),u["Content-Type"]="application/x-www-form-urlencoded",o.g.ea(o.B,o.v,o.u,u)):(o.v="GET",o.g.ea(o.B,o.v,null,u)),cs(),Pm(o.i,o.v,o.B,o.l,o.S,o.u)}sn.prototype.ba=function(o){o=o.target;const u=this.O;u&&cn(o)==3?u.j():this.Y(o)},sn.prototype.Y=function(o){try{if(o==this.g)e:{const G=cn(this.g),Ee=this.g.ya(),se=this.g.ca();if(!(G<3)&&(G!=3||this.g&&(this.h.h||this.g.la()||sl(this.g)))){this.K||G!=4||Ee==7||(Ee==8||se<=0?cs(3):cs(2)),sa(this);var u=this.g.ca();this.X=u;var f=Vm(this);if(this.o=u==200,Cm(this.i,this.v,this.B,this.l,this.S,G,u),this.o){if(this.U&&!this.L){t:{if(this.g){var p,b=this.g;if((p=b.g?b.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!v(p)){var R=p;break t}}R=null}if(o=R)fr(this.i,this.l,o,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,ia(this,o);else{this.o=!1,this.m=3,je(12),xn(this),fs(this);break e}}if(this.R){o=!0;let be;for(;!this.K&&this.C<f.length;)if(be=Om(this,f),be==na){G==4&&(this.m=4,je(14),o=!1),fr(this.i,this.l,null,"[Incomplete Response]");break}else if(be==xu){this.m=4,je(15),fr(this.i,this.l,f,"[Invalid Chunk]"),o=!1;break}else fr(this.i,this.l,be,null),ia(this,be);if(Uu(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),G!=4||f.length!=0||this.h.h||(this.m=1,je(16),o=!1),this.o=this.o&&o,!o)fr(this.i,this.l,f,"[Invalid Chunked Response]"),xn(this),fs(this);else if(f.length>0&&!this.W){this.W=!0;var M=this.j;M.g==this&&M.aa&&!M.P&&(M.j.info("Great, no buffering proxy detected. Bytes received: "+f.length),da(M),M.P=!0,je(11))}}else fr(this.i,this.l,f,null),ia(this,f);G==4&&xn(this),this.o&&!this.K&&(G==4?hl(this.j,this):(this.o=!1,ui(this)))}else Km(this.g),u==400&&f.indexOf("Unknown SID")>0?(this.m=3,je(12)):(this.m=0,je(13)),xn(this),fs(this)}}}catch{}finally{}};function Vm(o){if(!Uu(o))return o.g.la();const u=sl(o.g);if(u==="")return"";let f="";const p=u.length,b=cn(o.g)==4;if(!o.h.i){if(typeof TextDecoder>"u")return xn(o),fs(o),"";o.h.i=new a.TextDecoder}for(let R=0;R<p;R++)o.h.h=!0,f+=o.h.i.decode(u[R],{stream:!(b&&R==p-1)});return u.length=0,o.h.g+=f,o.C=0,o.h.g}function Uu(o){return o.g?o.v=="GET"&&o.M!=2&&o.j.Aa:!1}function Om(o,u){var f=o.C,p=u.indexOf(`
`,f);return p==-1?na:(f=Number(u.substring(f,p)),isNaN(f)?xu:(p+=1,p+f>u.length?na:(u=u.slice(p,p+f),o.C=p+f,u)))}sn.prototype.cancel=function(){this.K=!0,xn(this)};function ui(o){o.T=Date.now()+o.H,Bu(o,o.H)}function Bu(o,u){if(o.D!=null)throw Error("WatchDog timer not null");o.D=us(h(o.aa,o),u)}function sa(o){o.D&&(a.clearTimeout(o.D),o.D=null)}sn.prototype.aa=function(){this.D=null;const o=Date.now();o-this.T>=0?(km(this.i,this.B),this.M!=2&&(cs(),je(17)),xn(this),this.m=2,fs(this)):Bu(this,this.T-o)};function fs(o){o.j.I==0||o.K||hl(o.j,o)}function xn(o){sa(o);var u=o.O;u&&typeof u.dispose=="function"&&u.dispose(),o.O=null,Ru(o.V),o.g&&(u=o.g,o.g=null,u.abort(),u.dispose())}function ia(o,u){try{var f=o.j;if(f.I!=0&&(f.g==o||oa(f.h,o))){if(!o.L&&oa(f.h,o)&&f.I==3){try{var p=f.Ba.g.parse(u)}catch{p=null}if(Array.isArray(p)&&p.length==3){var b=p;if(b[0]==0){e:if(!f.v){if(f.g)if(f.g.F+3e3<o.F)mi(f),di(f);else break e;fa(f),je(18)}}else f.xa=b[1],0<f.xa-f.K&&b[2]<37500&&f.F&&f.A==0&&!f.C&&(f.C=us(h(f.Va,f),6e3));qu(f.h)<=1&&f.ta&&(f.ta=void 0)}else Un(f,11)}else if((o.L||f.g==o)&&mi(f),!v(u))for(b=f.Ba.g.parse(u),u=0;u<b.length;u++){let se=b[u];const be=se[0];if(!(be<=f.K))if(f.K=be,se=se[1],f.I==2)if(se[0]=="c"){f.M=se[1],f.ba=se[2];const Et=se[3];Et!=null&&(f.ka=Et,f.j.info("VER="+f.ka));const Bn=se[4];Bn!=null&&(f.za=Bn,f.j.info("SVER="+f.za));const un=se[5];un!=null&&typeof un=="number"&&un>0&&(p=1.5*un,f.O=p,f.j.info("backChannelRequestTimeoutMs_="+p)),p=f;const ln=o.g;if(ln){const _i=ln.g?ln.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(_i){var R=p.h;R.g||_i.indexOf("spdy")==-1&&_i.indexOf("quic")==-1&&_i.indexOf("h2")==-1||(R.j=R.l,R.g=new Set,R.h&&(aa(R,R.h),R.h=null))}if(p.G){const pa=ln.g?ln.g.getResponseHeader("X-HTTP-Session-Id"):null;pa&&(p.wa=pa,ae(p.J,p.G,pa))}}f.I=3,f.l&&f.l.ra(),f.aa&&(f.T=Date.now()-o.F,f.j.info("Handshake RTT: "+f.T+"ms")),p=f;var M=o;if(p.na=pl(p,p.L?p.ba:null,p.W),M.L){zu(p.h,M);var G=M,Ee=p.O;Ee&&(G.H=Ee),G.D&&(sa(G),ui(G)),p.g=M}else ul(p);f.i.length>0&&pi(f)}else se[0]!="stop"&&se[0]!="close"||Un(f,7);else f.I==3&&(se[0]=="stop"||se[0]=="close"?se[0]=="stop"?Un(f,7):ha(f):se[0]!="noop"&&f.l&&f.l.qa(se),f.A=0)}}cs(4)}catch{}}var Mm=class{constructor(o,u){this.g=o,this.map=u}};function $u(o){this.l=o||10,a.PerformanceNavigationTiming?(o=a.performance.getEntriesByType("navigation"),o=o.length>0&&(o[0].nextHopProtocol=="hq"||o[0].nextHopProtocol=="h2")):o=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=o?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function ju(o){return o.h?!0:o.g?o.g.size>=o.j:!1}function qu(o){return o.h?1:o.g?o.g.size:0}function oa(o,u){return o.h?o.h==u:o.g?o.g.has(u):!1}function aa(o,u){o.g?o.g.add(u):o.h=u}function zu(o,u){o.h&&o.h==u?o.h=null:o.g&&o.g.has(u)&&o.g.delete(u)}$u.prototype.cancel=function(){if(this.i=Hu(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const o of this.g.values())o.cancel();this.g.clear()}};function Hu(o){if(o.h!=null)return o.i.concat(o.h.G);if(o.g!=null&&o.g.size!==0){let u=o.i;for(const f of o.g.values())u=u.concat(f.G);return u}return T(o.i)}var Wu=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Lm(o,u){if(o){o=o.split("&");for(let f=0;f<o.length;f++){const p=o[f].indexOf("=");let b,R=null;p>=0?(b=o[f].substring(0,p),R=o[f].substring(p+1)):b=o[f],u(b,R?decodeURIComponent(R.replace(/\+/g," ")):"")}}}function on(o){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let u;o instanceof on?(this.l=o.l,ds(this,o.j),this.o=o.o,this.g=o.g,ps(this,o.u),this.h=o.h,ca(this,Yu(o.i)),this.m=o.m):o&&(u=String(o).match(Wu))?(this.l=!1,ds(this,u[1]||"",!0),this.o=ms(u[2]||""),this.g=ms(u[3]||"",!0),ps(this,u[4]),this.h=ms(u[5]||"",!0),ca(this,u[6]||"",!0),this.m=ms(u[7]||"")):(this.l=!1,this.i=new _s(null,this.l))}on.prototype.toString=function(){const o=[];var u=this.j;u&&o.push(gs(u,Gu,!0),":");var f=this.g;return(f||u=="file")&&(o.push("//"),(u=this.o)&&o.push(gs(u,Gu,!0),"@"),o.push(hs(f).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f=this.u,f!=null&&o.push(":",String(f))),(f=this.h)&&(this.g&&f.charAt(0)!="/"&&o.push("/"),o.push(gs(f,f.charAt(0)=="/"?Um:Fm,!0))),(f=this.i.toString())&&o.push("?",f),(f=this.m)&&o.push("#",gs(f,$m)),o.join("")},on.prototype.resolve=function(o){const u=vt(this);let f=!!o.j;f?ds(u,o.j):f=!!o.o,f?u.o=o.o:f=!!o.g,f?u.g=o.g:f=o.u!=null;var p=o.h;if(f)ps(u,o.u);else if(f=!!o.h){if(p.charAt(0)!="/")if(this.g&&!this.h)p="/"+p;else{var b=u.h.lastIndexOf("/");b!=-1&&(p=u.h.slice(0,b+1)+p)}if(b=p,b==".."||b==".")p="";else if(b.indexOf("./")!=-1||b.indexOf("/.")!=-1){p=b.lastIndexOf("/",0)==0,b=b.split("/");const R=[];for(let M=0;M<b.length;){const G=b[M++];G=="."?p&&M==b.length&&R.push(""):G==".."?((R.length>1||R.length==1&&R[0]!="")&&R.pop(),p&&M==b.length&&R.push("")):(R.push(G),p=!0)}p=R.join("/")}else p=b}return f?u.h=p:f=o.i.toString()!=="",f?ca(u,Yu(o.i)):f=!!o.m,f&&(u.m=o.m),u};function vt(o){return new on(o)}function ds(o,u,f){o.j=f?ms(u,!0):u,o.j&&(o.j=o.j.replace(/:$/,""))}function ps(o,u){if(u){if(u=Number(u),isNaN(u)||u<0)throw Error("Bad port number "+u);o.u=u}else o.u=null}function ca(o,u,f){u instanceof _s?(o.i=u,jm(o.i,o.l)):(f||(u=gs(u,Bm)),o.i=new _s(u,o.l))}function ae(o,u,f){o.i.set(u,f)}function li(o){return ae(o,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),o}function ms(o,u){return o?u?decodeURI(o.replace(/%25/g,"%2525")):decodeURIComponent(o):""}function gs(o,u,f){return typeof o=="string"?(o=encodeURI(o).replace(u,xm),f&&(o=o.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),o):null}function xm(o){return o=o.charCodeAt(0),"%"+(o>>4&15).toString(16)+(o&15).toString(16)}var Gu=/[#\/\?@]/g,Fm=/[#\?:]/g,Um=/[#\?]/g,Bm=/[#\?@]/g,$m=/#/g;function _s(o,u){this.h=this.g=null,this.i=o||null,this.j=!!u}function Fn(o){o.g||(o.g=new Map,o.h=0,o.i&&Lm(o.i,function(u,f){o.add(decodeURIComponent(u.replace(/\+/g," ")),f)}))}n=_s.prototype,n.add=function(o,u){Fn(this),this.i=null,o=dr(this,o);let f=this.g.get(o);return f||this.g.set(o,f=[]),f.push(u),this.h+=1,this};function Ku(o,u){Fn(o),u=dr(o,u),o.g.has(u)&&(o.i=null,o.h-=o.g.get(u).length,o.g.delete(u))}function Qu(o,u){return Fn(o),u=dr(o,u),o.g.has(u)}n.forEach=function(o,u){Fn(this),this.g.forEach(function(f,p){f.forEach(function(b){o.call(u,b,p,this)},this)},this)};function Xu(o,u){Fn(o);let f=[];if(typeof u=="string")Qu(o,u)&&(f=f.concat(o.g.get(dr(o,u))));else for(o=Array.from(o.g.values()),u=0;u<o.length;u++)f=f.concat(o[u]);return f}n.set=function(o,u){return Fn(this),this.i=null,o=dr(this,o),Qu(this,o)&&(this.h-=this.g.get(o).length),this.g.set(o,[u]),this.h+=1,this},n.get=function(o,u){return o?(o=Xu(this,o),o.length>0?String(o[0]):u):u};function Ju(o,u,f){Ku(o,u),f.length>0&&(o.i=null,o.g.set(dr(o,u),T(f)),o.h+=f.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const o=[],u=Array.from(this.g.keys());for(let p=0;p<u.length;p++){var f=u[p];const b=hs(f);f=Xu(this,f);for(let R=0;R<f.length;R++){let M=b;f[R]!==""&&(M+="="+hs(f[R])),o.push(M)}}return this.i=o.join("&")};function Yu(o){const u=new _s;return u.i=o.i,o.g&&(u.g=new Map(o.g),u.h=o.h),u}function dr(o,u){return u=String(u),o.j&&(u=u.toLowerCase()),u}function jm(o,u){u&&!o.j&&(Fn(o),o.i=null,o.g.forEach(function(f,p){const b=p.toLowerCase();p!=b&&(Ku(this,p),Ju(this,b,f))},o)),o.j=u}function qm(o,u){const f=new ls;if(a.Image){const p=new Image;p.onload=d(an,f,"TestLoadImage: loaded",!0,u,p),p.onerror=d(an,f,"TestLoadImage: error",!1,u,p),p.onabort=d(an,f,"TestLoadImage: abort",!1,u,p),p.ontimeout=d(an,f,"TestLoadImage: timeout",!1,u,p),a.setTimeout(function(){p.ontimeout&&p.ontimeout()},1e4),p.src=o}else u(!1)}function zm(o,u){const f=new ls,p=new AbortController,b=setTimeout(()=>{p.abort(),an(f,"TestPingServer: timeout",!1,u)},1e4);fetch(o,{signal:p.signal}).then(R=>{clearTimeout(b),R.ok?an(f,"TestPingServer: ok",!0,u):an(f,"TestPingServer: server error",!1,u)}).catch(()=>{clearTimeout(b),an(f,"TestPingServer: error",!1,u)})}function an(o,u,f,p,b){try{b&&(b.onload=null,b.onerror=null,b.onabort=null,b.ontimeout=null),p(f)}catch{}}function Hm(){this.g=new Rm}function ua(o){this.i=o.Sb||null,this.h=o.ab||!1}g(ua,Pu),ua.prototype.g=function(){return new hi(this.i,this.h)};function hi(o,u){Ve.call(this),this.H=o,this.o=u,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}g(hi,Ve),n=hi.prototype,n.open=function(o,u){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=o,this.D=u,this.readyState=1,vs(this)},n.send=function(o){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const u={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};o&&(u.body=o),(this.H||a).fetch(new Request(this.D,u)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,ys(this)),this.readyState=0},n.Pa=function(o){if(this.g&&(this.l=o,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=o.headers,this.readyState=2,vs(this)),this.g&&(this.readyState=3,vs(this),this.g)))if(this.responseType==="arraybuffer")o.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in o){if(this.j=o.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Zu(this)}else o.text().then(this.Oa.bind(this),this.ga.bind(this))};function Zu(o){o.j.read().then(o.Ma.bind(o)).catch(o.ga.bind(o))}n.Ma=function(o){if(this.g){if(this.o&&o.value)this.response.push(o.value);else if(!this.o){var u=o.value?o.value:new Uint8Array(0);(u=this.B.decode(u,{stream:!o.done}))&&(this.response=this.responseText+=u)}o.done?ys(this):vs(this),this.readyState==3&&Zu(this)}},n.Oa=function(o){this.g&&(this.response=this.responseText=o,ys(this))},n.Na=function(o){this.g&&(this.response=o,ys(this))},n.ga=function(){this.g&&ys(this)};function ys(o){o.readyState=4,o.l=null,o.j=null,o.B=null,vs(o)}n.setRequestHeader=function(o,u){this.A.append(o,u)},n.getResponseHeader=function(o){return this.h&&this.h.get(o.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const o=[],u=this.h.entries();for(var f=u.next();!f.done;)f=f.value,o.push(f[0]+": "+f[1]),f=u.next();return o.join(`\r
`)};function vs(o){o.onreadystatechange&&o.onreadystatechange.call(o)}Object.defineProperty(hi.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(o){this.m=o?"include":"same-origin"}});function el(o){let u="";return _t(o,function(f,p){u+=p,u+=":",u+=f,u+=`\r
`}),u}function la(o,u,f){e:{for(p in f){var p=!1;break e}p=!0}p||(f=el(f),typeof o=="string"?f!=null&&hs(f):ae(o,u,f))}function me(o){Ve.call(this),this.headers=new Map,this.L=o||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}g(me,Ve);var Wm=/^https?$/i,Gm=["POST","PUT"];n=me.prototype,n.Fa=function(o){this.H=o},n.ea=function(o,u,f,p){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+o);u=u?u.toUpperCase():"GET",this.D=o,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Mu.g(),this.g.onreadystatechange=m(h(this.Ca,this));try{this.B=!0,this.g.open(u,String(o),!0),this.B=!1}catch(R){tl(this,R);return}if(o=f||"",f=new Map(this.headers),p)if(Object.getPrototypeOf(p)===Object.prototype)for(var b in p)f.set(b,p[b]);else if(typeof p.keys=="function"&&typeof p.get=="function")for(const R of p.keys())f.set(R,p.get(R));else throw Error("Unknown input type for opt_headers: "+String(p));p=Array.from(f.keys()).find(R=>R.toLowerCase()=="content-type"),b=a.FormData&&o instanceof a.FormData,!(Array.prototype.indexOf.call(Gm,u,void 0)>=0)||p||b||f.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[R,M]of f)this.g.setRequestHeader(R,M);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(o),this.v=!1}catch(R){tl(this,R)}};function tl(o,u){o.h=!1,o.g&&(o.j=!0,o.g.abort(),o.j=!1),o.l=u,o.o=5,nl(o),fi(o)}function nl(o){o.A||(o.A=!0,$e(o,"complete"),$e(o,"error"))}n.abort=function(o){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=o||7,$e(this,"complete"),$e(this,"abort"),fi(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),fi(this,!0)),me.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?rl(this):this.Xa())},n.Xa=function(){rl(this)};function rl(o){if(o.h&&typeof i<"u"){if(o.v&&cn(o)==4)setTimeout(o.Ca.bind(o),0);else if($e(o,"readystatechange"),cn(o)==4){o.h=!1;try{const R=o.ca();e:switch(R){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var u=!0;break e;default:u=!1}var f;if(!(f=u)){var p;if(p=R===0){let M=String(o.D).match(Wu)[1]||null;!M&&a.self&&a.self.location&&(M=a.self.location.protocol.slice(0,-1)),p=!Wm.test(M?M.toLowerCase():"")}f=p}if(f)$e(o,"complete"),$e(o,"success");else{o.o=6;try{var b=cn(o)>2?o.g.statusText:""}catch{b=""}o.l=b+" ["+o.ca()+"]",nl(o)}}finally{fi(o)}}}}function fi(o,u){if(o.g){o.m&&(clearTimeout(o.m),o.m=null);const f=o.g;o.g=null,u||$e(o,"ready");try{f.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function cn(o){return o.g?o.g.readyState:0}n.ca=function(){try{return cn(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(o){if(this.g){var u=this.g.responseText;return o&&u.indexOf(o)==0&&(u=u.substring(o.length)),Sm(u)}};function sl(o){try{if(!o.g)return null;if("response"in o.g)return o.g.response;switch(o.F){case"":case"text":return o.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in o.g)return o.g.mozResponseArrayBuffer}return null}catch{return null}}function Km(o){const u={};o=(o.g&&cn(o)>=2&&o.g.getAllResponseHeaders()||"").split(`\r
`);for(let p=0;p<o.length;p++){if(v(o[p]))continue;var f=Dm(o[p]);const b=f[0];if(f=f[1],typeof f!="string")continue;f=f.trim();const R=u[b]||[];u[b]=R,R.push(f)}qt(u,function(p){return p.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Es(o,u,f){return f&&f.internalChannelParams&&f.internalChannelParams[o]||u}function il(o){this.za=0,this.i=[],this.j=new ls,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Es("failFast",!1,o),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Es("baseRetryDelayMs",5e3,o),this.Za=Es("retryDelaySeedMs",1e4,o),this.Ta=Es("forwardChannelMaxRetries",2,o),this.va=Es("forwardChannelRequestTimeoutMs",2e4,o),this.ma=o&&o.xmlHttpFactory||void 0,this.Ua=o&&o.Rb||void 0,this.Aa=o&&o.useFetchStreams||!1,this.O=void 0,this.L=o&&o.supportsCrossDomainXhr||!1,this.M="",this.h=new $u(o&&o.concurrentRequestLimit),this.Ba=new Hm,this.S=o&&o.fastHandshake||!1,this.R=o&&o.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=o&&o.Pb||!1,o&&o.ua&&this.j.ua(),o&&o.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&o&&o.detectBufferingProxy||!1,this.ia=void 0,o&&o.longPollingTimeout&&o.longPollingTimeout>0&&(this.ia=o.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=il.prototype,n.ka=8,n.I=1,n.connect=function(o,u,f,p){je(0),this.W=o,this.H=u||{},f&&p!==void 0&&(this.H.OSID=f,this.H.OAID=p),this.F=this.X,this.J=pl(this,null,this.W),pi(this)};function ha(o){if(ol(o),o.I==3){var u=o.V++,f=vt(o.J);if(ae(f,"SID",o.M),ae(f,"RID",u),ae(f,"TYPE","terminate"),Ts(o,f),u=new sn(o,o.j,u),u.M=2,u.A=li(vt(f)),f=!1,a.navigator&&a.navigator.sendBeacon)try{f=a.navigator.sendBeacon(u.A.toString(),"")}catch{}!f&&a.Image&&(new Image().src=u.A,f=!0),f||(u.g=ml(u.j,null),u.g.ea(u.A)),u.F=Date.now(),ui(u)}dl(o)}function di(o){o.g&&(da(o),o.g.cancel(),o.g=null)}function ol(o){di(o),o.v&&(a.clearTimeout(o.v),o.v=null),mi(o),o.h.cancel(),o.m&&(typeof o.m=="number"&&a.clearTimeout(o.m),o.m=null)}function pi(o){if(!ju(o.h)&&!o.m){o.m=!0;var u=o.Ea;W||_(),K||(W(),K=!0),w.add(u,o),o.D=0}}function Qm(o,u){return qu(o.h)>=o.h.j-(o.m?1:0)?!1:o.m?(o.i=u.G.concat(o.i),!0):o.I==1||o.I==2||o.D>=(o.Sa?0:o.Ta)?!1:(o.m=us(h(o.Ea,o,u),fl(o,o.D)),o.D++,!0)}n.Ea=function(o){if(this.m)if(this.m=null,this.I==1){if(!o){this.V=Math.floor(Math.random()*1e5),o=this.V++;const b=new sn(this,this.j,o);let R=this.o;if(this.U&&(R?(R=rn(R),yt(R,this.U)):R=this.U),this.u!==null||this.R||(b.J=R,R=null),this.S)e:{for(var u=0,f=0;f<this.i.length;f++){t:{var p=this.i[f];if("__data__"in p.map&&(p=p.map.__data__,typeof p=="string")){p=p.length;break t}p=void 0}if(p===void 0)break;if(u+=p,u>4096){u=f;break e}if(u===4096||f===this.i.length-1){u=f+1;break e}}u=1e3}else u=1e3;u=cl(this,b,u),f=vt(this.J),ae(f,"RID",o),ae(f,"CVER",22),this.G&&ae(f,"X-HTTP-Session-Id",this.G),Ts(this,f),R&&(this.R?u="headers="+hs(el(R))+"&"+u:this.u&&la(f,this.u,R)),aa(this.h,b),this.Ra&&ae(f,"TYPE","init"),this.S?(ae(f,"$req",u),ae(f,"SID","null"),b.U=!0,ra(b,f,null)):ra(b,f,u),this.I=2}}else this.I==3&&(o?al(this,o):this.i.length==0||ju(this.h)||al(this))};function al(o,u){var f;u?f=u.l:f=o.V++;const p=vt(o.J);ae(p,"SID",o.M),ae(p,"RID",f),ae(p,"AID",o.K),Ts(o,p),o.u&&o.o&&la(p,o.u,o.o),f=new sn(o,o.j,f,o.D+1),o.u===null&&(f.J=o.o),u&&(o.i=u.G.concat(o.i)),u=cl(o,f,1e3),f.H=Math.round(o.va*.5)+Math.round(o.va*.5*Math.random()),aa(o.h,f),ra(f,p,u)}function Ts(o,u){o.H&&_t(o.H,function(f,p){ae(u,p,f)}),o.l&&_t({},function(f,p){ae(u,p,f)})}function cl(o,u,f){f=Math.min(o.i.length,f);const p=o.l?h(o.l.Ka,o.l,o):null;e:{var b=o.i;let G=-1;for(;;){const Ee=["count="+f];G==-1?f>0?(G=b[0].g,Ee.push("ofs="+G)):G=0:Ee.push("ofs="+G);let se=!0;for(let be=0;be<f;be++){var R=b[be].g;const Et=b[be].map;if(R-=G,R<0)G=Math.max(0,b[be].g-100),se=!1;else try{R="req"+R+"_"||"";try{var M=Et instanceof Map?Et:Object.entries(Et);for(const[Bn,un]of M){let ln=un;c(un)&&(ln=Yo(un)),Ee.push(R+Bn+"="+encodeURIComponent(ln))}}catch(Bn){throw Ee.push(R+"type="+encodeURIComponent("_badmap")),Bn}}catch{p&&p(Et)}}if(se){M=Ee.join("&");break e}}M=void 0}return o=o.i.splice(0,f),u.G=o,M}function ul(o){if(!o.g&&!o.v){o.Y=1;var u=o.Da;W||_(),K||(W(),K=!0),w.add(u,o),o.A=0}}function fa(o){return o.g||o.v||o.A>=3?!1:(o.Y++,o.v=us(h(o.Da,o),fl(o,o.A)),o.A++,!0)}n.Da=function(){if(this.v=null,ll(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var o=4*this.T;this.j.info("BP detection timer enabled: "+o),this.B=us(h(this.Wa,this),o)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,je(10),di(this),ll(this))};function da(o){o.B!=null&&(a.clearTimeout(o.B),o.B=null)}function ll(o){o.g=new sn(o,o.j,"rpc",o.Y),o.u===null&&(o.g.J=o.o),o.g.P=0;var u=vt(o.na);ae(u,"RID","rpc"),ae(u,"SID",o.M),ae(u,"AID",o.K),ae(u,"CI",o.F?"0":"1"),!o.F&&o.ia&&ae(u,"TO",o.ia),ae(u,"TYPE","xmlhttp"),Ts(o,u),o.u&&o.o&&la(u,o.u,o.o),o.O&&(o.g.H=o.O);var f=o.g;o=o.ba,f.M=1,f.A=li(vt(u)),f.u=null,f.R=!0,Fu(f,o)}n.Va=function(){this.C!=null&&(this.C=null,di(this),fa(this),je(19))};function mi(o){o.C!=null&&(a.clearTimeout(o.C),o.C=null)}function hl(o,u){var f=null;if(o.g==u){mi(o),da(o),o.g=null;var p=2}else if(oa(o.h,u))f=u.G,zu(o.h,u),p=1;else return;if(o.I!=0){if(u.o)if(p==1){f=u.u?u.u.length:0,u=Date.now()-u.F;var b=o.D;p=ai(),$e(p,new Vu(p,f)),pi(o)}else ul(o);else if(b=u.m,b==3||b==0&&u.X>0||!(p==1&&Qm(o,u)||p==2&&fa(o)))switch(f&&f.length>0&&(u=o.h,u.i=u.i.concat(f)),b){case 1:Un(o,5);break;case 4:Un(o,10);break;case 3:Un(o,6);break;default:Un(o,2)}}}function fl(o,u){let f=o.Qa+Math.floor(Math.random()*o.Za);return o.isActive()||(f*=2),f*u}function Un(o,u){if(o.j.info("Error code "+u),u==2){var f=h(o.bb,o),p=o.Ua;const b=!p;p=new on(p||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||ds(p,"https"),li(p),b?qm(p.toString(),f):zm(p.toString(),f)}else je(2);o.I=0,o.l&&o.l.pa(u),dl(o),ol(o)}n.bb=function(o){o?(this.j.info("Successfully pinged google.com"),je(2)):(this.j.info("Failed to ping google.com"),je(1))};function dl(o){if(o.I=0,o.ja=[],o.l){const u=Hu(o.h);(u.length!=0||o.i.length!=0)&&(S(o.ja,u),S(o.ja,o.i),o.h.i.length=0,T(o.i),o.i.length=0),o.l.oa()}}function pl(o,u,f){var p=f instanceof on?vt(f):new on(f);if(p.g!="")u&&(p.g=u+"."+p.g),ps(p,p.u);else{var b=a.location;p=b.protocol,u=u?u+"."+b.hostname:b.hostname,b=+b.port;const R=new on(null);p&&ds(R,p),u&&(R.g=u),b&&ps(R,b),f&&(R.h=f),p=R}return f=o.G,u=o.wa,f&&u&&ae(p,f,u),ae(p,"VER",o.ka),Ts(o,p),p}function ml(o,u,f){if(u&&!o.L)throw Error("Can't create secondary domain capable XhrIo object.");return u=o.Aa&&!o.ma?new me(new ua({ab:f})):new me(o.ma),u.Fa(o.L),u}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function gl(){}n=gl.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function gi(){}gi.prototype.g=function(o,u){return new Xe(o,u)};function Xe(o,u){Ve.call(this),this.g=new il(u),this.l=o,this.h=u&&u.messageUrlParams||null,o=u&&u.messageHeaders||null,u&&u.clientProtocolHeaderRequired&&(o?o["X-Client-Protocol"]="webchannel":o={"X-Client-Protocol":"webchannel"}),this.g.o=o,o=u&&u.initMessageHeaders||null,u&&u.messageContentType&&(o?o["X-WebChannel-Content-Type"]=u.messageContentType:o={"X-WebChannel-Content-Type":u.messageContentType}),u&&u.sa&&(o?o["X-WebChannel-Client-Profile"]=u.sa:o={"X-WebChannel-Client-Profile":u.sa}),this.g.U=o,(o=u&&u.Qb)&&!v(o)&&(this.g.u=o),this.A=u&&u.supportsCrossDomainXhr||!1,this.v=u&&u.sendRawJson||!1,(u=u&&u.httpSessionIdParam)&&!v(u)&&(this.g.G=u,o=this.h,o!==null&&u in o&&(o=this.h,u in o&&delete o[u])),this.j=new pr(this)}g(Xe,Ve),Xe.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Xe.prototype.close=function(){ha(this.g)},Xe.prototype.o=function(o){var u=this.g;if(typeof o=="string"){var f={};f.__data__=o,o=f}else this.v&&(f={},f.__data__=Yo(o),o=f);u.i.push(new Mm(u.Ya++,o)),u.I==3&&pi(u)},Xe.prototype.N=function(){this.g.l=null,delete this.j,ha(this.g),delete this.g,Xe.Z.N.call(this)};function _l(o){Zo.call(this),o.__headers__&&(this.headers=o.__headers__,this.statusCode=o.__status__,delete o.__headers__,delete o.__status__);var u=o.__sm__;if(u){e:{for(const f in u){o=f;break e}o=void 0}(this.i=o)&&(o=this.i,u=u!==null&&o in u?u[o]:void 0),this.data=u}else this.data=o}g(_l,Zo);function yl(){ea.call(this),this.status=1}g(yl,ea);function pr(o){this.g=o}g(pr,gl),pr.prototype.ra=function(){$e(this.g,"a")},pr.prototype.qa=function(o){$e(this.g,new _l(o))},pr.prototype.pa=function(o){$e(this.g,new yl)},pr.prototype.oa=function(){$e(this.g,"b")},gi.prototype.createWebChannel=gi.prototype.g,Xe.prototype.send=Xe.prototype.o,Xe.prototype.open=Xe.prototype.m,Xe.prototype.close=Xe.prototype.close,gd=function(){return new gi},md=function(){return ai()},pd=Ln,Wa={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},ci.NO_ERROR=0,ci.TIMEOUT=8,ci.HTTP_ERROR=6,Pi=ci,Ou.COMPLETE="complete",dd=Ou,Cu.EventType=as,as.OPEN="a",as.CLOSE="b",as.ERROR="c",as.MESSAGE="d",Ve.prototype.listen=Ve.prototype.J,Is=Cu,me.prototype.listenOnce=me.prototype.K,me.prototype.getLastError=me.prototype.Ha,me.prototype.getLastErrorCode=me.prototype.ya,me.prototype.getStatus=me.prototype.ca,me.prototype.getResponseJson=me.prototype.La,me.prototype.getResponseText=me.prototype.la,me.prototype.send=me.prototype.ea,me.prototype.setWithCredentials=me.prototype.Fa,fd=me}).apply(typeof Ti<"u"?Ti:typeof self<"u"?self:typeof window<"u"?window:{});const zl="@firebase/firestore",Hl="4.9.2";class Le{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Le.UNAUTHENTICATED=new Le(null),Le.GOOGLE_CREDENTIALS=new Le("google-credentials-uid"),Le.FIRST_PARTY=new Le("first-party-uid"),Le.MOCK_USER=new Le("mock-user");let Zr="12.3.0";const nr=new Sc("@firebase/firestore");function _r(){return nr.logLevel}function x(n,...e){if(nr.logLevel<=Q.DEBUG){const t=e.map(Cc);nr.debug(`Firestore (${Zr}): ${n}`,...t)}}function Zt(n,...e){if(nr.logLevel<=Q.ERROR){const t=e.map(Cc);nr.error(`Firestore (${Zr}): ${n}`,...t)}}function Fr(n,...e){if(nr.logLevel<=Q.WARN){const t=e.map(Cc);nr.warn(`Firestore (${Zr}): ${n}`,...t)}}function Cc(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function j(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,_d(n,r,t)}function _d(n,e,t){let r=`FIRESTORE (${Zr}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw Zt(r),new Error(r)}function ne(n,e,t,r){let s="Unexpected state";typeof t=="string"?s=t:r=t,n||_d(e,s,r)}function H(n,e){return n}const D={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class U extends $t{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Gn{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class yd{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class vv{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Le.UNAUTHENTICATED)))}shutdown(){}}class Ev{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class Tv{constructor(e){this.t=e,this.currentUser=Le.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){ne(this.o===void 0,42304);let r=this.i;const s=l=>this.i!==r?(r=this.i,t(l)):Promise.resolve();let i=new Gn;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Gn,e.enqueueRetryable((()=>s(this.currentUser)))};const a=()=>{const l=i;e.enqueueRetryable((async()=>{await l.promise,await s(this.currentUser)}))},c=l=>{x("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit((l=>c(l))),setTimeout((()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?c(l):(x("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Gn)}}),0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((r=>this.i!==e?(x("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ne(typeof r.accessToken=="string",31837,{l:r}),new yd(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ne(e===null||typeof e=="string",2055,{h:e}),new Le(e)}}class wv{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=Le.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class Iv{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new wv(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(Le.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Wl{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Av{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,st(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){ne(this.o===void 0,3512);const r=i=>{i.error!=null&&x("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const a=i.token!==this.m;return this.m=i.token,x("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable((()=>r(i)))};const s=i=>{x("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((i=>s(i))),setTimeout((()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):x("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new Wl(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(ne(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new Wl(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function bv(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}class kc{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=bv(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<t&&(r+=e.charAt(s[i]%62))}return r}}function X(n,e){return n<e?-1:n>e?1:0}function Ga(n,e){const t=Math.min(n.length,e.length);for(let r=0;r<t;r++){const s=n.charAt(r),i=e.charAt(r);if(s!==i)return Ia(s)===Ia(i)?X(s,i):Ia(s)?1:-1}return X(n.length,e.length)}const Sv=55296,Rv=57343;function Ia(n){const e=n.charCodeAt(0);return e>=Sv&&e<=Rv}function Ur(n,e,t){return n.length===e.length&&n.every(((r,s)=>t(r,e[s])))}const Gl="__name__";class wt{constructor(e,t,r){t===void 0?t=0:t>e.length&&j(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&j(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return wt.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof wt?e.forEach((r=>{t.push(r)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let s=0;s<r;s++){const i=wt.compareSegments(e.get(s),t.get(s));if(i!==0)return i}return X(e.length,t.length)}static compareSegments(e,t){const r=wt.isNumericId(e),s=wt.isNumericId(t);return r&&!s?-1:!r&&s?1:r&&s?wt.extractNumericId(e).compare(wt.extractNumericId(t)):Ga(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return wn.fromString(e.substring(4,e.length-2))}}class ue extends wt{construct(e,t,r){return new ue(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new U(D.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter((s=>s.length>0)))}return new ue(t)}static emptyPath(){return new ue([])}}const Pv=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ce extends wt{construct(e,t,r){return new Ce(e,t,r)}static isValidIdentifier(e){return Pv.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ce.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Gl}static keyField(){return new Ce([Gl])}static fromServerFormat(e){const t=[];let r="",s=0;const i=()=>{if(r.length===0)throw new U(D.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let a=!1;for(;s<e.length;){const c=e[s];if(c==="\\"){if(s+1===e.length)throw new U(D.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new U(D.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,s+=2}else c==="`"?(a=!a,s++):c!=="."||a?(r+=c,s++):(i(),s++)}if(i(),a)throw new U(D.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ce(t)}static emptyPath(){return new Ce([])}}class B{constructor(e){this.path=e}static fromPath(e){return new B(ue.fromString(e))}static fromName(e){return new B(ue.fromString(e).popFirst(5))}static empty(){return new B(ue.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ue.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return ue.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new B(new ue(e.slice()))}}function vd(n,e,t){if(!t)throw new U(D.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function Cv(n,e,t,r){if(e===!0&&r===!0)throw new U(D.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function Kl(n){if(!B.isDocumentKey(n))throw new U(D.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function Ql(n){if(B.isDocumentKey(n))throw new U(D.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Ed(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function Nc(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":j(12329,{type:typeof n})}function In(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new U(D.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Nc(n);throw new U(D.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function ye(n,e){const t={typeString:n};return e&&(t.value=e),t}function Js(n,e){if(!Ed(n))throw new U(D.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const s=e[r].typeString,i="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}const a=n[r];if(s&&typeof a!==s){t=`JSON field '${r}' must be a ${s}.`;break}if(i!==void 0&&a!==i.value){t=`Expected '${r}' field to equal '${i.value}'`;break}}if(t)throw new U(D.INVALID_ARGUMENT,t);return!0}const Xl=-62135596800,Jl=1e6;class le{static now(){return le.fromMillis(Date.now())}static fromDate(e){return le.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*Jl);return new le(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new U(D.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new U(D.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<Xl)throw new U(D.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new U(D.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Jl}_compareTo(e){return this.seconds===e.seconds?X(this.nanoseconds,e.nanoseconds):X(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:le._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Js(e,le._jsonSchema))return new le(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Xl;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}le._jsonSchemaVersion="firestore/timestamp/1.0",le._jsonSchema={type:ye("string",le._jsonSchemaVersion),seconds:ye("number"),nanoseconds:ye("number")};class z{static fromTimestamp(e){return new z(e)}static min(){return new z(new le(0,0))}static max(){return new z(new le(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Us=-1;function kv(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,s=z.fromTimestamp(r===1e9?new le(t+1,0):new le(t,r));return new Rn(s,B.empty(),e)}function Nv(n){return new Rn(n.readTime,n.key,Us)}class Rn{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new Rn(z.min(),B.empty(),Us)}static max(){return new Rn(z.max(),B.empty(),Us)}}function Dv(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=B.comparator(n.documentKey,e.documentKey),t!==0?t:X(n.largestBatchId,e.largestBatchId))}const Vv="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Ov{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function es(n){if(n.code!==D.FAILED_PRECONDITION||n.message!==Vv)throw n;x("LocalStore","Unexpectedly lost primary lease")}class k{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&j(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new k(((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(t,i).next(r,s)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof k?t:k.resolve(t)}catch(t){return k.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):k.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):k.reject(t)}static resolve(e){return new k(((t,r)=>{t(e)}))}static reject(e){return new k(((t,r)=>{r(e)}))}static waitFor(e){return new k(((t,r)=>{let s=0,i=0,a=!1;e.forEach((c=>{++s,c.next((()=>{++i,a&&i===s&&t()}),(l=>r(l)))})),a=!0,i===s&&t()}))}static or(e){let t=k.resolve(!1);for(const r of e)t=t.next((s=>s?k.resolve(s):r()));return t}static forEach(e,t){const r=[];return e.forEach(((s,i)=>{r.push(t.call(this,s,i))})),this.waitFor(r)}static mapArray(e,t){return new k(((r,s)=>{const i=e.length,a=new Array(i);let c=0;for(let l=0;l<i;l++){const h=l;t(e[h]).next((d=>{a[h]=d,++c,c===i&&r(a)}),(d=>s(d)))}}))}static doWhile(e,t){return new k(((r,s)=>{const i=()=>{e()===!0?t().next((()=>{i()}),s):r()};i()}))}}function Mv(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function ts(n){return n.name==="IndexedDbTransactionError"}class Ro{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>t.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Ro.ce=-1;const Dc=-1;function Po(n){return n==null}function zi(n){return n===0&&1/n==-1/0}function Lv(n){return typeof n=="number"&&Number.isInteger(n)&&!zi(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const Td="";function xv(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=Yl(e)),e=Fv(n.get(t),e);return Yl(e)}function Fv(n,e){let t=e;const r=n.length;for(let s=0;s<r;s++){const i=n.charAt(s);switch(i){case"\0":t+="";break;case Td:t+="";break;default:t+=i}}return t}function Yl(n){return n+Td+""}function Zl(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function On(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function wd(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class de{constructor(e,t){this.comparator=e,this.root=t||Re.EMPTY}insert(e,t){return new de(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Re.BLACK,null,null))}remove(e){return new de(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Re.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return t+r.left.size;s<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,r)=>(e(t,r),!1)))}toString(){const e=[];return this.inorderTraversal(((t,r)=>(e.push(`${t}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new wi(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new wi(this.root,e,this.comparator,!1)}getReverseIterator(){return new wi(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new wi(this.root,e,this.comparator,!0)}}class wi{constructor(e,t,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?r(e.key,t):1,t&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Re{constructor(e,t,r,s,i){this.key=e,this.value=t,this.color=r??Re.RED,this.left=s??Re.EMPTY,this.right=i??Re.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,s,i){return new Re(e??this.key,t??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,t,r),null):i===0?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Re.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),t(e,s.key)===0){if(s.right.isEmpty())return Re.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Re.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Re.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw j(43730,{key:this.key,value:this.value});if(this.right.isRed())throw j(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw j(27949);return e+(this.isRed()?0:1)}}Re.EMPTY=null,Re.RED=!0,Re.BLACK=!1;Re.EMPTY=new class{constructor(){this.size=0}get key(){throw j(57766)}get value(){throw j(16141)}get color(){throw j(16727)}get left(){throw j(29726)}get right(){throw j(36894)}copy(e,t,r,s,i){return this}insert(e,t,r){return new Re(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Ae{constructor(e){this.comparator=e,this.data=new de(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,r)=>(e(t),!1)))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new eh(this.data.getIterator())}getIteratorFrom(e){return new eh(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((r=>{t=t.add(r)})),t}isEqual(e){if(!(e instanceof Ae)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Ae(this.comparator);return t.data=e,t}}class eh{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Ze{constructor(e){this.fields=e,e.sort(Ce.comparator)}static empty(){return new Ze([])}unionWith(e){let t=new Ae(Ce.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Ze(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Ur(this.fields,e.fields,((t,r)=>t.isEqual(r)))}}class Id extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class De{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new Id("Invalid base64 string: "+i):i}})(e);return new De(t)}static fromUint8Array(e){const t=(function(s){let i="";for(let a=0;a<s.length;++a)i+=String.fromCharCode(s[a]);return i})(e);return new De(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const r=new Uint8Array(t.length);for(let s=0;s<t.length;s++)r[s]=t.charCodeAt(s);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return X(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}De.EMPTY_BYTE_STRING=new De("");const Uv=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Pn(n){if(ne(!!n,39018),typeof n=="string"){let e=0;const t=Uv.exec(n);if(ne(!!t,46558,{timestamp:n}),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ge(n.seconds),nanos:ge(n.nanos)}}function ge(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Cn(n){return typeof n=="string"?De.fromBase64String(n):De.fromUint8Array(n)}const Ad="server_timestamp",bd="__type__",Sd="__previous_value__",Rd="__local_write_time__";function Vc(n){return(n?.mapValue?.fields||{})[bd]?.stringValue===Ad}function Co(n){const e=n.mapValue.fields[Sd];return Vc(e)?Co(e):e}function Bs(n){const e=Pn(n.mapValue.fields[Rd].timestampValue);return new le(e.seconds,e.nanos)}class Bv{constructor(e,t,r,s,i,a,c,l,h,d){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=a,this.autoDetectLongPolling=c,this.longPollingOptions=l,this.useFetchStreams=h,this.isUsingEmulator=d}}const Hi="(default)";class $s{constructor(e,t){this.projectId=e,this.database=t||Hi}static empty(){return new $s("","")}get isDefaultDatabase(){return this.database===Hi}isEqual(e){return e instanceof $s&&e.projectId===this.projectId&&e.database===this.database}}const Pd="__type__",$v="__max__",Ii={mapValue:{}},Cd="__vector__",Wi="value";function kn(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Vc(n)?4:qv(n)?9007199254740991:jv(n)?10:11:j(28295,{value:n})}function Mt(n,e){if(n===e)return!0;const t=kn(n);if(t!==kn(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Bs(n).isEqual(Bs(e));case 3:return(function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const a=Pn(s.timestampValue),c=Pn(i.timestampValue);return a.seconds===c.seconds&&a.nanos===c.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(s,i){return Cn(s.bytesValue).isEqual(Cn(i.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(s,i){return ge(s.geoPointValue.latitude)===ge(i.geoPointValue.latitude)&&ge(s.geoPointValue.longitude)===ge(i.geoPointValue.longitude)})(n,e);case 2:return(function(s,i){if("integerValue"in s&&"integerValue"in i)return ge(s.integerValue)===ge(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const a=ge(s.doubleValue),c=ge(i.doubleValue);return a===c?zi(a)===zi(c):isNaN(a)&&isNaN(c)}return!1})(n,e);case 9:return Ur(n.arrayValue.values||[],e.arrayValue.values||[],Mt);case 10:case 11:return(function(s,i){const a=s.mapValue.fields||{},c=i.mapValue.fields||{};if(Zl(a)!==Zl(c))return!1;for(const l in a)if(a.hasOwnProperty(l)&&(c[l]===void 0||!Mt(a[l],c[l])))return!1;return!0})(n,e);default:return j(52216,{left:n})}}function js(n,e){return(n.values||[]).find((t=>Mt(t,e)))!==void 0}function Br(n,e){if(n===e)return 0;const t=kn(n),r=kn(e);if(t!==r)return X(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return X(n.booleanValue,e.booleanValue);case 2:return(function(i,a){const c=ge(i.integerValue||i.doubleValue),l=ge(a.integerValue||a.doubleValue);return c<l?-1:c>l?1:c===l?0:isNaN(c)?isNaN(l)?0:-1:1})(n,e);case 3:return th(n.timestampValue,e.timestampValue);case 4:return th(Bs(n),Bs(e));case 5:return Ga(n.stringValue,e.stringValue);case 6:return(function(i,a){const c=Cn(i),l=Cn(a);return c.compareTo(l)})(n.bytesValue,e.bytesValue);case 7:return(function(i,a){const c=i.split("/"),l=a.split("/");for(let h=0;h<c.length&&h<l.length;h++){const d=X(c[h],l[h]);if(d!==0)return d}return X(c.length,l.length)})(n.referenceValue,e.referenceValue);case 8:return(function(i,a){const c=X(ge(i.latitude),ge(a.latitude));return c!==0?c:X(ge(i.longitude),ge(a.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return nh(n.arrayValue,e.arrayValue);case 10:return(function(i,a){const c=i.fields||{},l=a.fields||{},h=c[Wi]?.arrayValue,d=l[Wi]?.arrayValue,g=X(h?.values?.length||0,d?.values?.length||0);return g!==0?g:nh(h,d)})(n.mapValue,e.mapValue);case 11:return(function(i,a){if(i===Ii.mapValue&&a===Ii.mapValue)return 0;if(i===Ii.mapValue)return 1;if(a===Ii.mapValue)return-1;const c=i.fields||{},l=Object.keys(c),h=a.fields||{},d=Object.keys(h);l.sort(),d.sort();for(let g=0;g<l.length&&g<d.length;++g){const m=Ga(l[g],d[g]);if(m!==0)return m;const T=Br(c[l[g]],h[d[g]]);if(T!==0)return T}return X(l.length,d.length)})(n.mapValue,e.mapValue);default:throw j(23264,{he:t})}}function th(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return X(n,e);const t=Pn(n),r=Pn(e),s=X(t.seconds,r.seconds);return s!==0?s:X(t.nanos,r.nanos)}function nh(n,e){const t=n.values||[],r=e.values||[];for(let s=0;s<t.length&&s<r.length;++s){const i=Br(t[s],r[s]);if(i)return i}return X(t.length,r.length)}function $r(n){return Ka(n)}function Ka(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const r=Pn(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return Cn(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return B.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",s=!0;for(const i of t.values||[])s?s=!1:r+=",",r+=Ka(i);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){const r=Object.keys(t.fields||{}).sort();let s="{",i=!0;for(const a of r)i?i=!1:s+=",",s+=`${a}:${Ka(t.fields[a])}`;return s+"}"})(n.mapValue):j(61005,{value:n})}function Ci(n){switch(kn(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Co(n);return e?16+Ci(e):16;case 5:return 2*n.stringValue.length;case 6:return Cn(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((s,i)=>s+Ci(i)),0)})(n.arrayValue);case 10:case 11:return(function(r){let s=0;return On(r.fields,((i,a)=>{s+=i.length+Ci(a)})),s})(n.mapValue);default:throw j(13486,{value:n})}}function Qa(n){return!!n&&"integerValue"in n}function Oc(n){return!!n&&"arrayValue"in n}function rh(n){return!!n&&"nullValue"in n}function sh(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function ki(n){return!!n&&"mapValue"in n}function jv(n){return(n?.mapValue?.fields||{})[Pd]?.stringValue===Cd}function ks(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return On(n.mapValue.fields,((t,r)=>e.mapValue.fields[t]=ks(r))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=ks(n.arrayValue.values[t]);return e}return{...n}}function qv(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===$v}class We{constructor(e){this.value=e}static empty(){return new We({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!ki(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=ks(t)}setAll(e){let t=Ce.emptyPath(),r={},s=[];e.forEach(((a,c)=>{if(!t.isImmediateParentOf(c)){const l=this.getFieldsMap(t);this.applyChanges(l,r,s),r={},s=[],t=c.popLast()}a?r[c.lastSegment()]=ks(a):s.push(c.lastSegment())}));const i=this.getFieldsMap(t);this.applyChanges(i,r,s)}delete(e){const t=this.field(e.popLast());ki(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Mt(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=t.mapValue.fields[e.get(r)];ki(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,r){On(t,((s,i)=>e[s]=i));for(const s of r)delete e[s]}clone(){return new We(ks(this.value))}}function kd(n){const e=[];return On(n.fields,((t,r)=>{const s=new Ce([t]);if(ki(r)){const i=kd(r.mapValue).fields;if(i.length===0)e.push(s);else for(const a of i)e.push(s.child(a))}else e.push(s)})),new Ze(e)}class xe{constructor(e,t,r,s,i,a,c){this.key=e,this.documentType=t,this.version=r,this.readTime=s,this.createTime=i,this.data=a,this.documentState=c}static newInvalidDocument(e){return new xe(e,0,z.min(),z.min(),z.min(),We.empty(),0)}static newFoundDocument(e,t,r,s){return new xe(e,1,t,z.min(),r,s,0)}static newNoDocument(e,t){return new xe(e,2,t,z.min(),z.min(),We.empty(),0)}static newUnknownDocument(e,t){return new xe(e,3,t,z.min(),z.min(),We.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(z.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=We.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=We.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=z.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof xe&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new xe(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Gi{constructor(e,t){this.position=e,this.inclusive=t}}function ih(n,e,t){let r=0;for(let s=0;s<n.position.length;s++){const i=e[s],a=n.position[s];if(i.field.isKeyField()?r=B.comparator(B.fromName(a.referenceValue),t.key):r=Br(a,t.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function oh(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Mt(n.position[t],e.position[t]))return!1;return!0}class Ki{constructor(e,t="asc"){this.field=e,this.dir=t}}function zv(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class Nd{}class we extends Nd{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new Wv(e,t,r):t==="array-contains"?new Qv(e,r):t==="in"?new Xv(e,r):t==="not-in"?new Jv(e,r):t==="array-contains-any"?new Yv(e,r):new we(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new Gv(e,r):new Kv(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Br(t,this.value)):t!==null&&kn(this.value)===kn(t)&&this.matchesComparison(Br(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return j(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Lt extends Nd{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Lt(e,t)}matches(e){return Dd(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Dd(n){return n.op==="and"}function Vd(n){return Hv(n)&&Dd(n)}function Hv(n){for(const e of n.filters)if(e instanceof Lt)return!1;return!0}function Xa(n){if(n instanceof we)return n.field.canonicalString()+n.op.toString()+$r(n.value);if(Vd(n))return n.filters.map((e=>Xa(e))).join(",");{const e=n.filters.map((t=>Xa(t))).join(",");return`${n.op}(${e})`}}function Od(n,e){return n instanceof we?(function(r,s){return s instanceof we&&r.op===s.op&&r.field.isEqual(s.field)&&Mt(r.value,s.value)})(n,e):n instanceof Lt?(function(r,s){return s instanceof Lt&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce(((i,a,c)=>i&&Od(a,s.filters[c])),!0):!1})(n,e):void j(19439)}function Md(n){return n instanceof we?(function(t){return`${t.field.canonicalString()} ${t.op} ${$r(t.value)}`})(n):n instanceof Lt?(function(t){return t.op.toString()+" {"+t.getFilters().map(Md).join(" ,")+"}"})(n):"Filter"}class Wv extends we{constructor(e,t,r){super(e,t,r),this.key=B.fromName(r.referenceValue)}matches(e){const t=B.comparator(e.key,this.key);return this.matchesComparison(t)}}class Gv extends we{constructor(e,t){super(e,"in",t),this.keys=Ld("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class Kv extends we{constructor(e,t){super(e,"not-in",t),this.keys=Ld("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function Ld(n,e){return(e.arrayValue?.values||[]).map((t=>B.fromName(t.referenceValue)))}class Qv extends we{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Oc(t)&&js(t.arrayValue,this.value)}}class Xv extends we{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&js(this.value.arrayValue,t)}}class Jv extends we{constructor(e,t){super(e,"not-in",t)}matches(e){if(js(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!js(this.value.arrayValue,t)}}class Yv extends we{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Oc(t)||!t.arrayValue.values)&&t.arrayValue.values.some((r=>js(this.value.arrayValue,r)))}}class Zv{constructor(e,t=null,r=[],s=[],i=null,a=null,c=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=a,this.endAt=c,this.Te=null}}function ah(n,e=null,t=[],r=[],s=null,i=null,a=null){return new Zv(n,e,t,r,s,i,a)}function Mc(n){const e=H(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((r=>Xa(r))).join(","),t+="|ob:",t+=e.orderBy.map((r=>(function(i){return i.field.canonicalString()+i.dir})(r))).join(","),Po(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((r=>$r(r))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((r=>$r(r))).join(",")),e.Te=t}return e.Te}function Lc(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!zv(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!Od(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!oh(n.startAt,e.startAt)&&oh(n.endAt,e.endAt)}function Ja(n){return B.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}class ko{constructor(e,t=null,r=[],s=[],i=null,a="F",c=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=a,this.startAt=c,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function eE(n,e,t,r,s,i,a,c){return new ko(n,e,t,r,s,i,a,c)}function xc(n){return new ko(n)}function ch(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function tE(n){return n.collectionGroup!==null}function Ns(n){const e=H(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),t.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let c=new Ae(Ce.comparator);return a.filters.forEach((l=>{l.getFlattenedFilters().forEach((h=>{h.isInequality()&&(c=c.add(h.field))}))})),c})(e).forEach((i=>{t.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new Ki(i,r))})),t.has(Ce.keyField().canonicalString())||e.Ie.push(new Ki(Ce.keyField(),r))}return e.Ie}function Ct(n){const e=H(n);return e.Ee||(e.Ee=nE(e,Ns(n))),e.Ee}function nE(n,e){if(n.limitType==="F")return ah(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((s=>{const i=s.dir==="desc"?"asc":"desc";return new Ki(s.field,i)}));const t=n.endAt?new Gi(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Gi(n.startAt.position,n.startAt.inclusive):null;return ah(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function Ya(n,e,t){return new ko(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function No(n,e){return Lc(Ct(n),Ct(e))&&n.limitType===e.limitType}function xd(n){return`${Mc(Ct(n))}|lt:${n.limitType}`}function yr(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map((s=>Md(s))).join(", ")}]`),Po(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map((s=>(function(a){return`${a.field.canonicalString()} (${a.dir})`})(s))).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map((s=>$r(s))).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map((s=>$r(s))).join(",")),`Target(${r})`})(Ct(n))}; limitType=${n.limitType})`}function Do(n,e){return e.isFoundDocument()&&(function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):B.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)})(n,e)&&(function(r,s){for(const i of Ns(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0})(n,e)&&(function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0})(n,e)&&(function(r,s){return!(r.startAt&&!(function(a,c,l){const h=ih(a,c,l);return a.inclusive?h<=0:h<0})(r.startAt,Ns(r),s)||r.endAt&&!(function(a,c,l){const h=ih(a,c,l);return a.inclusive?h>=0:h>0})(r.endAt,Ns(r),s))})(n,e)}function rE(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function Fd(n){return(e,t)=>{let r=!1;for(const s of Ns(n)){const i=sE(s,e,t);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function sE(n,e,t){const r=n.field.isKeyField()?B.comparator(e.key,t.key):(function(i,a,c){const l=a.data.field(i),h=c.data.field(i);return l!==null&&h!==null?Br(l,h):j(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return j(19790,{direction:n.dir})}}class cr{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[t]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){On(this.inner,((t,r)=>{for(const[s,i]of r)e(s,i)}))}isEmpty(){return wd(this.inner)}size(){return this.innerSize}}const iE=new de(B.comparator);function en(){return iE}const Ud=new de(B.comparator);function As(...n){let e=Ud;for(const t of n)e=e.insert(t.key,t);return e}function Bd(n){let e=Ud;return n.forEach(((t,r)=>e=e.insert(t,r.overlayedDocument))),e}function qn(){return Ds()}function $d(){return Ds()}function Ds(){return new cr((n=>n.toString()),((n,e)=>n.isEqual(e)))}const oE=new de(B.comparator),aE=new Ae(B.comparator);function J(...n){let e=aE;for(const t of n)e=e.add(t);return e}const cE=new Ae(X);function uE(){return cE}function Fc(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:zi(e)?"-0":e}}function jd(n){return{integerValue:""+n}}function lE(n,e){return Lv(e)?jd(e):Fc(n,e)}class Vo{constructor(){this._=void 0}}function hE(n,e,t){return n instanceof Qi?(function(s,i){const a={fields:{[bd]:{stringValue:Ad},[Rd]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&Vc(i)&&(i=Co(i)),i&&(a.fields[Sd]=i),{mapValue:a}})(t,e):n instanceof qs?zd(n,e):n instanceof zs?Hd(n,e):(function(s,i){const a=qd(s,i),c=uh(a)+uh(s.Ae);return Qa(a)&&Qa(s.Ae)?jd(c):Fc(s.serializer,c)})(n,e)}function fE(n,e,t){return n instanceof qs?zd(n,e):n instanceof zs?Hd(n,e):t}function qd(n,e){return n instanceof Xi?(function(r){return Qa(r)||(function(i){return!!i&&"doubleValue"in i})(r)})(e)?e:{integerValue:0}:null}class Qi extends Vo{}class qs extends Vo{constructor(e){super(),this.elements=e}}function zd(n,e){const t=Wd(e);for(const r of n.elements)t.some((s=>Mt(s,r)))||t.push(r);return{arrayValue:{values:t}}}class zs extends Vo{constructor(e){super(),this.elements=e}}function Hd(n,e){let t=Wd(e);for(const r of n.elements)t=t.filter((s=>!Mt(s,r)));return{arrayValue:{values:t}}}class Xi extends Vo{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function uh(n){return ge(n.integerValue||n.doubleValue)}function Wd(n){return Oc(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function dE(n,e){return n.field.isEqual(e.field)&&(function(r,s){return r instanceof qs&&s instanceof qs||r instanceof zs&&s instanceof zs?Ur(r.elements,s.elements,Mt):r instanceof Xi&&s instanceof Xi?Mt(r.Ae,s.Ae):r instanceof Qi&&s instanceof Qi})(n.transform,e.transform)}class pE{constructor(e,t){this.version=e,this.transformResults=t}}class ft{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new ft}static exists(e){return new ft(void 0,e)}static updateTime(e){return new ft(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Ni(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Oo{}function Gd(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Uc(n.key,ft.none()):new Ys(n.key,n.data,ft.none());{const t=n.data,r=We.empty();let s=new Ae(Ce.comparator);for(let i of e.fields)if(!s.has(i)){let a=t.field(i);a===null&&i.length>1&&(i=i.popLast(),a=t.field(i)),a===null?r.delete(i):r.set(i,a),s=s.add(i)}return new Mn(n.key,r,new Ze(s.toArray()),ft.none())}}function mE(n,e,t){n instanceof Ys?(function(s,i,a){const c=s.value.clone(),l=hh(s.fieldTransforms,i,a.transformResults);c.setAll(l),i.convertToFoundDocument(a.version,c).setHasCommittedMutations()})(n,e,t):n instanceof Mn?(function(s,i,a){if(!Ni(s.precondition,i))return void i.convertToUnknownDocument(a.version);const c=hh(s.fieldTransforms,i,a.transformResults),l=i.data;l.setAll(Kd(s)),l.setAll(c),i.convertToFoundDocument(a.version,l).setHasCommittedMutations()})(n,e,t):(function(s,i,a){i.convertToNoDocument(a.version).setHasCommittedMutations()})(0,e,t)}function Vs(n,e,t,r){return n instanceof Ys?(function(i,a,c,l){if(!Ni(i.precondition,a))return c;const h=i.value.clone(),d=fh(i.fieldTransforms,l,a);return h.setAll(d),a.convertToFoundDocument(a.version,h).setHasLocalMutations(),null})(n,e,t,r):n instanceof Mn?(function(i,a,c,l){if(!Ni(i.precondition,a))return c;const h=fh(i.fieldTransforms,l,a),d=a.data;return d.setAll(Kd(i)),d.setAll(h),a.convertToFoundDocument(a.version,d).setHasLocalMutations(),c===null?null:c.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map((g=>g.field)))})(n,e,t,r):(function(i,a,c){return Ni(i.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):c})(n,e,t)}function gE(n,e){let t=null;for(const r of n.fieldTransforms){const s=e.data.field(r.field),i=qd(r.transform,s||null);i!=null&&(t===null&&(t=We.empty()),t.set(r.field,i))}return t||null}function lh(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&Ur(r,s,((i,a)=>dE(i,a)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Ys extends Oo{constructor(e,t,r,s=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Mn extends Oo{constructor(e,t,r,s,i=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Kd(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}})),e}function hh(n,e,t){const r=new Map;ne(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let s=0;s<t.length;s++){const i=n[s],a=i.transform,c=e.data.field(i.field);r.set(i.field,fE(a,c,t[s]))}return r}function fh(n,e,t){const r=new Map;for(const s of n){const i=s.transform,a=t.data.field(s.field);r.set(s.field,hE(i,a,e))}return r}class Uc extends Oo{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class _E extends Oo{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class yE{constructor(e,t,r,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&mE(i,e,r[s])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=Vs(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=Vs(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=$d();return this.mutations.forEach((s=>{const i=e.get(s.key),a=i.overlayedDocument;let c=this.applyToLocalView(a,i.mutatedFields);c=t.has(s.key)?null:c;const l=Gd(a,c);l!==null&&r.set(s.key,l),a.isValidDocument()||a.convertToNoDocument(z.min())})),r}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),J())}isEqual(e){return this.batchId===e.batchId&&Ur(this.mutations,e.mutations,((t,r)=>lh(t,r)))&&Ur(this.baseMutations,e.baseMutations,((t,r)=>lh(t,r)))}}class Bc{constructor(e,t,r,s){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=s}static from(e,t,r){ne(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let s=(function(){return oE})();const i=e.mutations;for(let a=0;a<i.length;a++)s=s.insert(i[a].key,r[a].version);return new Bc(e,t,r,s)}}class vE{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class EE{constructor(e,t){this.count=e,this.unchangedNames=t}}var _e,Y;function TE(n){switch(n){case D.OK:return j(64938);case D.CANCELLED:case D.UNKNOWN:case D.DEADLINE_EXCEEDED:case D.RESOURCE_EXHAUSTED:case D.INTERNAL:case D.UNAVAILABLE:case D.UNAUTHENTICATED:return!1;case D.INVALID_ARGUMENT:case D.NOT_FOUND:case D.ALREADY_EXISTS:case D.PERMISSION_DENIED:case D.FAILED_PRECONDITION:case D.ABORTED:case D.OUT_OF_RANGE:case D.UNIMPLEMENTED:case D.DATA_LOSS:return!0;default:return j(15467,{code:n})}}function Qd(n){if(n===void 0)return Zt("GRPC error has no .code"),D.UNKNOWN;switch(n){case _e.OK:return D.OK;case _e.CANCELLED:return D.CANCELLED;case _e.UNKNOWN:return D.UNKNOWN;case _e.DEADLINE_EXCEEDED:return D.DEADLINE_EXCEEDED;case _e.RESOURCE_EXHAUSTED:return D.RESOURCE_EXHAUSTED;case _e.INTERNAL:return D.INTERNAL;case _e.UNAVAILABLE:return D.UNAVAILABLE;case _e.UNAUTHENTICATED:return D.UNAUTHENTICATED;case _e.INVALID_ARGUMENT:return D.INVALID_ARGUMENT;case _e.NOT_FOUND:return D.NOT_FOUND;case _e.ALREADY_EXISTS:return D.ALREADY_EXISTS;case _e.PERMISSION_DENIED:return D.PERMISSION_DENIED;case _e.FAILED_PRECONDITION:return D.FAILED_PRECONDITION;case _e.ABORTED:return D.ABORTED;case _e.OUT_OF_RANGE:return D.OUT_OF_RANGE;case _e.UNIMPLEMENTED:return D.UNIMPLEMENTED;case _e.DATA_LOSS:return D.DATA_LOSS;default:return j(39323,{code:n})}}(Y=_e||(_e={}))[Y.OK=0]="OK",Y[Y.CANCELLED=1]="CANCELLED",Y[Y.UNKNOWN=2]="UNKNOWN",Y[Y.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Y[Y.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Y[Y.NOT_FOUND=5]="NOT_FOUND",Y[Y.ALREADY_EXISTS=6]="ALREADY_EXISTS",Y[Y.PERMISSION_DENIED=7]="PERMISSION_DENIED",Y[Y.UNAUTHENTICATED=16]="UNAUTHENTICATED",Y[Y.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Y[Y.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Y[Y.ABORTED=10]="ABORTED",Y[Y.OUT_OF_RANGE=11]="OUT_OF_RANGE",Y[Y.UNIMPLEMENTED=12]="UNIMPLEMENTED",Y[Y.INTERNAL=13]="INTERNAL",Y[Y.UNAVAILABLE=14]="UNAVAILABLE",Y[Y.DATA_LOSS=15]="DATA_LOSS";function wE(){return new TextEncoder}const IE=new wn([4294967295,4294967295],0);function dh(n){const e=wE().encode(n),t=new hd;return t.update(e),new Uint8Array(t.digest())}function ph(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new wn([t,r],0),new wn([s,i],0)]}class $c{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new bs(`Invalid padding: ${t}`);if(r<0)throw new bs(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new bs(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new bs(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=wn.fromNumber(this.ge)}ye(e,t,r){let s=e.add(t.multiply(wn.fromNumber(r)));return s.compare(IE)===1&&(s=new wn([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=dh(e),[r,s]=ph(t);for(let i=0;i<this.hashCount;i++){const a=this.ye(r,s,i);if(!this.we(a))return!1}return!0}static create(e,t,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),a=new $c(i,s,t);return r.forEach((c=>a.insert(c))),a}insert(e){if(this.ge===0)return;const t=dh(e),[r,s]=ph(t);for(let i=0;i<this.hashCount;i++){const a=this.ye(r,s,i);this.Se(a)}}Se(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class bs extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Mo{constructor(e,t,r,s,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const s=new Map;return s.set(e,Zs.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new Mo(z.min(),s,new de(X),en(),J())}}class Zs{constructor(e,t,r,s,i){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new Zs(r,t,J(),J(),J())}}class Di{constructor(e,t,r,s){this.be=e,this.removedTargetIds=t,this.key=r,this.De=s}}class Xd{constructor(e,t){this.targetId=e,this.Ce=t}}class Jd{constructor(e,t,r=De.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=s}}class mh{constructor(){this.ve=0,this.Fe=gh(),this.Me=De.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=J(),t=J(),r=J();return this.Fe.forEach(((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:r=r.add(s);break;default:j(38017,{changeType:i})}})),new Zs(this.Me,this.xe,e,t,r)}qe(){this.Oe=!1,this.Fe=gh()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,ne(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class AE{constructor(e){this.Ge=e,this.ze=new Map,this.je=en(),this.Je=Ai(),this.He=Ai(),this.Ye=new de(X)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:j(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((r,s)=>{this.rt(s)&&t(s)}))}st(e){const t=e.targetId,r=e.Ce.count,s=this.ot(t);if(s){const i=s.target;if(Ja(i))if(r===0){const a=new B(i.path);this.et(t,a,xe.newNoDocument(a,z.min()))}else ne(r===1,20013,{expectedCount:r});else{const a=this._t(t);if(a!==r){const c=this.ut(e),l=c?this.ct(c,e,a):1;if(l!==0){this.it(t);const h=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,h)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=t;let a,c;try{a=Cn(r).toUint8Array()}catch(l){if(l instanceof Id)return Fr("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{c=new $c(a,s,i)}catch(l){return Fr(l instanceof bs?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return c.ge===0?null:c}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){const r=this.Ge.getRemoteKeysForTarget(t);let s=0;return r.forEach((i=>{const a=this.Ge.ht(),c=`projects/${a.projectId}/databases/${a.database}/documents/${i.path.canonicalString()}`;e.mightContain(c)||(this.et(t,i,null),s++)})),s}Tt(e){const t=new Map;this.ze.forEach(((i,a)=>{const c=this.ot(a);if(c){if(i.current&&Ja(c.target)){const l=new B(c.target.path);this.It(l).has(a)||this.Et(a,l)||this.et(a,l,xe.newNoDocument(l,e))}i.Be&&(t.set(a,i.ke()),i.qe())}}));let r=J();this.He.forEach(((i,a)=>{let c=!0;a.forEachWhile((l=>{const h=this.ot(l);return!h||h.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)})),c&&(r=r.add(i))})),this.je.forEach(((i,a)=>a.setReadTime(e)));const s=new Mo(e,t,this.Ye,this.je,r);return this.je=en(),this.Je=Ai(),this.He=Ai(),this.Ye=new de(X),s}Xe(e,t){if(!this.rt(e))return;const r=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,r),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,t)?s.Qe(t,1):s.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new mh,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Ae(X),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Ae(X),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||x("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new mh),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Ai(){return new de(B.comparator)}function gh(){return new de(B.comparator)}const bE={asc:"ASCENDING",desc:"DESCENDING"},SE={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},RE={and:"AND",or:"OR"};class PE{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Za(n,e){return n.useProto3Json||Po(e)?e:{value:e}}function Ji(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Yd(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function CE(n,e){return Ji(n,e.toTimestamp())}function kt(n){return ne(!!n,49232),z.fromTimestamp((function(t){const r=Pn(t);return new le(r.seconds,r.nanos)})(n))}function jc(n,e){return ec(n,e).canonicalString()}function ec(n,e){const t=(function(s){return new ue(["projects",s.projectId,"databases",s.database])})(n).child("documents");return e===void 0?t:t.child(e)}function Zd(n){const e=ue.fromString(n);return ne(sp(e),10190,{key:e.toString()}),e}function tc(n,e){return jc(n.databaseId,e.path)}function Aa(n,e){const t=Zd(e);if(t.get(1)!==n.databaseId.projectId)throw new U(D.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new U(D.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new B(tp(t))}function ep(n,e){return jc(n.databaseId,e)}function kE(n){const e=Zd(n);return e.length===4?ue.emptyPath():tp(e)}function nc(n){return new ue(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function tp(n){return ne(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function _h(n,e,t){return{name:tc(n,e),fields:t.value.mapValue.fields}}function NE(n,e){let t;if("targetChange"in e){e.targetChange;const r=(function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:j(39313,{state:h})})(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=(function(h,d){return h.useProto3Json?(ne(d===void 0||typeof d=="string",58123),De.fromBase64String(d||"")):(ne(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),De.fromUint8Array(d||new Uint8Array))})(n,e.targetChange.resumeToken),a=e.targetChange.cause,c=a&&(function(h){const d=h.code===void 0?D.UNKNOWN:Qd(h.code);return new U(d,h.message||"")})(a);t=new Jd(r,s,i,c||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=Aa(n,r.document.name),i=kt(r.document.updateTime),a=r.document.createTime?kt(r.document.createTime):z.min(),c=new We({mapValue:{fields:r.document.fields}}),l=xe.newFoundDocument(s,i,a,c),h=r.targetIds||[],d=r.removedTargetIds||[];t=new Di(h,d,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=Aa(n,r.document),i=r.readTime?kt(r.readTime):z.min(),a=xe.newNoDocument(s,i),c=r.removedTargetIds||[];t=new Di([],c,a.key,a)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=Aa(n,r.document),i=r.removedTargetIds||[];t=new Di([],i,s,null)}else{if(!("filter"in e))return j(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,a=new EE(s,i),c=r.targetId;t=new Xd(c,a)}}return t}function DE(n,e){let t;if(e instanceof Ys)t={update:_h(n,e.key,e.value)};else if(e instanceof Uc)t={delete:tc(n,e.key)};else if(e instanceof Mn)t={update:_h(n,e.key,e.data),updateMask:$E(e.fieldMask)};else{if(!(e instanceof _E))return j(16599,{Vt:e.type});t={verify:tc(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((r=>(function(i,a){const c=a.transform;if(c instanceof Qi)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof qs)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof zs)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof Xi)return{fieldPath:a.field.canonicalString(),increment:c.Ae};throw j(20930,{transform:a.transform})})(0,r)))),e.precondition.isNone||(t.currentDocument=(function(s,i){return i.updateTime!==void 0?{updateTime:CE(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:j(27497)})(n,e.precondition)),t}function VE(n,e){return n&&n.length>0?(ne(e!==void 0,14353),n.map((t=>(function(s,i){let a=s.updateTime?kt(s.updateTime):kt(i);return a.isEqual(z.min())&&(a=kt(i)),new pE(a,s.transformResults||[])})(t,e)))):[]}function OE(n,e){return{documents:[ep(n,e.path)]}}function ME(n,e){const t={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=ep(n,s);const i=(function(h){if(h.length!==0)return rp(Lt.create(h,"and"))})(e.filters);i&&(t.structuredQuery.where=i);const a=(function(h){if(h.length!==0)return h.map((d=>(function(m){return{field:vr(m.field),direction:FE(m.dir)}})(d)))})(e.orderBy);a&&(t.structuredQuery.orderBy=a);const c=Za(n,e.limit);return c!==null&&(t.structuredQuery.limit=c),e.startAt&&(t.structuredQuery.startAt=(function(h){return{before:h.inclusive,values:h.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(h){return{before:!h.inclusive,values:h.position}})(e.endAt)),{ft:t,parent:s}}function LE(n){let e=kE(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let s=null;if(r>0){ne(r===1,65062);const d=t.from[0];d.allDescendants?s=d.collectionId:e=e.child(d.collectionId)}let i=[];t.where&&(i=(function(g){const m=np(g);return m instanceof Lt&&Vd(m)?m.getFilters():[m]})(t.where));let a=[];t.orderBy&&(a=(function(g){return g.map((m=>(function(S){return new Ki(Er(S.field),(function(C){switch(C){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(S.direction))})(m)))})(t.orderBy));let c=null;t.limit&&(c=(function(g){let m;return m=typeof g=="object"?g.value:g,Po(m)?null:m})(t.limit));let l=null;t.startAt&&(l=(function(g){const m=!!g.before,T=g.values||[];return new Gi(T,m)})(t.startAt));let h=null;return t.endAt&&(h=(function(g){const m=!g.before,T=g.values||[];return new Gi(T,m)})(t.endAt)),eE(e,s,a,i,c,"F",l,h)}function xE(n,e){const t=(function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return j(28987,{purpose:s})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function np(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=Er(t.unaryFilter.field);return we.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Er(t.unaryFilter.field);return we.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Er(t.unaryFilter.field);return we.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=Er(t.unaryFilter.field);return we.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return j(61313);default:return j(60726)}})(n):n.fieldFilter!==void 0?(function(t){return we.create(Er(t.fieldFilter.field),(function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return j(58110);default:return j(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Lt.create(t.compositeFilter.filters.map((r=>np(r))),(function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return j(1026)}})(t.compositeFilter.op))})(n):j(30097,{filter:n})}function FE(n){return bE[n]}function UE(n){return SE[n]}function BE(n){return RE[n]}function vr(n){return{fieldPath:n.canonicalString()}}function Er(n){return Ce.fromServerFormat(n.fieldPath)}function rp(n){return n instanceof we?(function(t){if(t.op==="=="){if(sh(t.value))return{unaryFilter:{field:vr(t.field),op:"IS_NAN"}};if(rh(t.value))return{unaryFilter:{field:vr(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(sh(t.value))return{unaryFilter:{field:vr(t.field),op:"IS_NOT_NAN"}};if(rh(t.value))return{unaryFilter:{field:vr(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:vr(t.field),op:UE(t.op),value:t.value}}})(n):n instanceof Lt?(function(t){const r=t.getFilters().map((s=>rp(s)));return r.length===1?r[0]:{compositeFilter:{op:BE(t.op),filters:r}}})(n):j(54877,{filter:n})}function $E(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function sp(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}class gn{constructor(e,t,r,s,i=z.min(),a=z.min(),c=De.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=c,this.expectedCount=l}withSequenceNumber(e){return new gn(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new gn(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new gn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new gn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class jE{constructor(e){this.yt=e}}function qE(n){const e=LE({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Ya(e,e.limit,"L"):e}class zE{constructor(){this.Cn=new HE}addToCollectionParentIndex(e,t){return this.Cn.add(t),k.resolve()}getCollectionParents(e,t){return k.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return k.resolve()}deleteFieldIndex(e,t){return k.resolve()}deleteAllFieldIndexes(e){return k.resolve()}createTargetIndexes(e,t){return k.resolve()}getDocumentsMatchingTarget(e,t){return k.resolve(null)}getIndexType(e,t){return k.resolve(0)}getFieldIndexes(e,t){return k.resolve([])}getNextCollectionGroupToUpdate(e){return k.resolve(null)}getMinOffset(e,t){return k.resolve(Rn.min())}getMinOffsetFromCollectionGroup(e,t){return k.resolve(Rn.min())}updateCollectionGroup(e,t,r){return k.resolve()}updateIndexEntries(e,t){return k.resolve()}}class HE{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t]||new Ae(ue.comparator),i=!s.has(r);return this.index[t]=s.add(r),i}has(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t];return s&&s.has(r)}getEntries(e){return(this.index[e]||new Ae(ue.comparator)).toArray()}}const yh={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},ip=41943040;class He{static withCacheSize(e){return new He(e,He.DEFAULT_COLLECTION_PERCENTILE,He.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}He.DEFAULT_COLLECTION_PERCENTILE=10,He.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,He.DEFAULT=new He(ip,He.DEFAULT_COLLECTION_PERCENTILE,He.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),He.DISABLED=new He(-1,0,0);class jr{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new jr(0)}static cr(){return new jr(-1)}}const vh="LruGarbageCollector",WE=1048576;function Eh([n,e],[t,r]){const s=X(n,t);return s===0?X(e,r):s}class GE{constructor(e){this.Ir=e,this.buffer=new Ae(Eh),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();Eh(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class KE{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){x(vh,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){ts(t)?x(vh,"Ignoring IndexedDB error during garbage collection: ",t):await es(t)}await this.Vr(3e5)}))}}class QE{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((r=>Math.floor(t/100*r)))}nthSequenceNumber(e,t){if(t===0)return k.resolve(Ro.ce);const r=new GE(t);return this.mr.forEachTarget(e,(s=>r.Ar(s.sequenceNumber))).next((()=>this.mr.pr(e,(s=>r.Ar(s))))).next((()=>r.maxValue))}removeTargets(e,t,r){return this.mr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(x("LruGarbageCollector","Garbage collection skipped; disabled"),k.resolve(yh)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(x("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),yh):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let r,s,i,a,c,l,h;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((g=>(g>this.params.maximumSequenceNumbersToCollect?(x("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${g}`),s=this.params.maximumSequenceNumbersToCollect):s=g,a=Date.now(),this.nthSequenceNumber(e,s)))).next((g=>(r=g,c=Date.now(),this.removeTargets(e,r,t)))).next((g=>(i=g,l=Date.now(),this.removeOrphanedDocuments(e,r)))).next((g=>(h=Date.now(),_r()<=Q.DEBUG&&x("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-d}ms
	Determined least recently used ${s} in `+(c-a)+`ms
	Removed ${i} targets in `+(l-c)+`ms
	Removed ${g} documents in `+(h-l)+`ms
Total Duration: ${h-d}ms`),k.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:g}))))}}function XE(n,e){return new QE(n,e)}class JE{constructor(){this.changes=new cr((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,xe.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?k.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class YE{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class ZE{constructor(e,t,r,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next((s=>(r=s,this.remoteDocumentCache.getEntry(e,t)))).next((s=>(r!==null&&Vs(r.mutation,s,Ze.empty(),le.now()),s)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.getLocalViewOfDocuments(e,r,J()).next((()=>r))))}getLocalViewOfDocuments(e,t,r=J()){const s=qn();return this.populateOverlays(e,s,t).next((()=>this.computeViews(e,t,s,r).next((i=>{let a=As();return i.forEach(((c,l)=>{a=a.insert(c,l.overlayedDocument)})),a}))))}getOverlayedDocuments(e,t){const r=qn();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,J())))}populateOverlays(e,t,r){const s=[];return r.forEach((i=>{t.has(i)||s.push(i)})),this.documentOverlayCache.getOverlays(e,s).next((i=>{i.forEach(((a,c)=>{t.set(a,c)}))}))}computeViews(e,t,r,s){let i=en();const a=Ds(),c=(function(){return Ds()})();return t.forEach(((l,h)=>{const d=r.get(h.key);s.has(h.key)&&(d===void 0||d.mutation instanceof Mn)?i=i.insert(h.key,h):d!==void 0?(a.set(h.key,d.mutation.getFieldMask()),Vs(d.mutation,h,d.mutation.getFieldMask(),le.now())):a.set(h.key,Ze.empty())})),this.recalculateAndSaveOverlays(e,i).next((l=>(l.forEach(((h,d)=>a.set(h,d))),t.forEach(((h,d)=>c.set(h,new YE(d,a.get(h)??null)))),c)))}recalculateAndSaveOverlays(e,t){const r=Ds();let s=new de(((a,c)=>a-c)),i=J();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((a=>{for(const c of a)c.keys().forEach((l=>{const h=t.get(l);if(h===null)return;let d=r.get(l)||Ze.empty();d=c.applyToLocalView(h,d),r.set(l,d);const g=(s.get(c.batchId)||J()).add(l);s=s.insert(c.batchId,g)}))})).next((()=>{const a=[],c=s.getReverseIterator();for(;c.hasNext();){const l=c.getNext(),h=l.key,d=l.value,g=$d();d.forEach((m=>{if(!i.has(m)){const T=Gd(t.get(m),r.get(m));T!==null&&g.set(m,T),i=i.add(m)}})),a.push(this.documentOverlayCache.saveOverlays(e,h,g))}return k.waitFor(a)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,t,r,s){return(function(a){return B.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):tE(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,s):this.getDocumentsMatchingCollectionQuery(e,t,r,s)}getNextDocuments(e,t,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,s).next((i=>{const a=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,s-i.size):k.resolve(qn());let c=Us,l=i;return a.next((h=>k.forEach(h,((d,g)=>(c<g.largestBatchId&&(c=g.largestBatchId),i.get(d)?k.resolve():this.remoteDocumentCache.getEntry(e,d).next((m=>{l=l.insert(d,m)}))))).next((()=>this.populateOverlays(e,h,i))).next((()=>this.computeViews(e,l,h,J()))).next((d=>({batchId:c,changes:Bd(d)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new B(t)).next((r=>{let s=As();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s}))}getDocumentsMatchingCollectionGroupQuery(e,t,r,s){const i=t.collectionGroup;let a=As();return this.indexManager.getCollectionParents(e,i).next((c=>k.forEach(c,(l=>{const h=(function(g,m){return new ko(m,null,g.explicitOrderBy.slice(),g.filters.slice(),g.limit,g.limitType,g.startAt,g.endAt)})(t,l.child(i));return this.getDocumentsMatchingCollectionQuery(e,h,r,s).next((d=>{d.forEach(((g,m)=>{a=a.insert(g,m)}))}))})).next((()=>a))))}getDocumentsMatchingCollectionQuery(e,t,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next((a=>(i=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,i,s)))).next((a=>{i.forEach(((l,h)=>{const d=h.getKey();a.get(d)===null&&(a=a.insert(d,xe.newInvalidDocument(d)))}));let c=As();return a.forEach(((l,h)=>{const d=i.get(l);d!==void 0&&Vs(d.mutation,h,Ze.empty(),le.now()),Do(t,h)&&(c=c.insert(l,h))})),c}))}}class eT{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return k.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(s){return{id:s.id,version:s.version,createTime:kt(s.createTime)}})(t)),k.resolve()}getNamedQuery(e,t){return k.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(s){return{name:s.name,query:qE(s.bundledQuery),readTime:kt(s.readTime)}})(t)),k.resolve()}}class tT{constructor(){this.overlays=new de(B.comparator),this.qr=new Map}getOverlay(e,t){return k.resolve(this.overlays.get(t))}getOverlays(e,t){const r=qn();return k.forEach(t,(s=>this.getOverlay(e,s).next((i=>{i!==null&&r.set(s,i)})))).next((()=>r))}saveOverlays(e,t,r){return r.forEach(((s,i)=>{this.St(e,t,i)})),k.resolve()}removeOverlaysForBatchId(e,t,r){const s=this.qr.get(r);return s!==void 0&&(s.forEach((i=>this.overlays=this.overlays.remove(i))),this.qr.delete(r)),k.resolve()}getOverlaysForCollection(e,t,r){const s=qn(),i=t.length+1,a=new B(t.child("")),c=this.overlays.getIteratorFrom(a);for(;c.hasNext();){const l=c.getNext().value,h=l.getKey();if(!t.isPrefixOf(h.path))break;h.path.length===i&&l.largestBatchId>r&&s.set(l.getKey(),l)}return k.resolve(s)}getOverlaysForCollectionGroup(e,t,r,s){let i=new de(((h,d)=>h-d));const a=this.overlays.getIterator();for(;a.hasNext();){const h=a.getNext().value;if(h.getKey().getCollectionGroup()===t&&h.largestBatchId>r){let d=i.get(h.largestBatchId);d===null&&(d=qn(),i=i.insert(h.largestBatchId,d)),d.set(h.getKey(),h)}}const c=qn(),l=i.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach(((h,d)=>c.set(h,d))),!(c.size()>=s)););return k.resolve(c)}St(e,t,r){const s=this.overlays.get(r.key);if(s!==null){const a=this.qr.get(s.largestBatchId).delete(r.key);this.qr.set(s.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new vE(t,r));let i=this.qr.get(t);i===void 0&&(i=J(),this.qr.set(t,i)),this.qr.set(t,i.add(r.key))}}class nT{constructor(){this.sessionToken=De.EMPTY_BYTE_STRING}getSessionToken(e){return k.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,k.resolve()}}class qc{constructor(){this.Qr=new Ae(Se.$r),this.Ur=new Ae(Se.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const r=new Se(e,t);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,t){e.forEach((r=>this.addReference(r,t)))}removeReference(e,t){this.Gr(new Se(e,t))}zr(e,t){e.forEach((r=>this.removeReference(r,t)))}jr(e){const t=new B(new ue([])),r=new Se(t,e),s=new Se(t,e+1),i=[];return this.Ur.forEachInRange([r,s],(a=>{this.Gr(a),i.push(a.key)})),i}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new B(new ue([])),r=new Se(t,e),s=new Se(t,e+1);let i=J();return this.Ur.forEachInRange([r,s],(a=>{i=i.add(a.key)})),i}containsKey(e){const t=new Se(e,0),r=this.Qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class Se{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return B.comparator(e.key,t.key)||X(e.Yr,t.Yr)}static Kr(e,t){return X(e.Yr,t.Yr)||B.comparator(e.key,t.key)}}class rT{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Ae(Se.$r)}checkEmpty(e){return k.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,s){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new yE(i,t,r,s);this.mutationQueue.push(a);for(const c of s)this.Zr=this.Zr.add(new Se(c.key,i)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return k.resolve(a)}lookupMutationBatch(e,t){return k.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,s=this.ei(r),i=s<0?0:s;return k.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return k.resolve(this.mutationQueue.length===0?Dc:this.tr-1)}getAllMutationBatches(e){return k.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new Se(t,0),s=new Se(t,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([r,s],(a=>{const c=this.Xr(a.Yr);i.push(c)})),k.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Ae(X);return t.forEach((s=>{const i=new Se(s,0),a=new Se(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,a],(c=>{r=r.add(c.Yr)}))})),k.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,s=r.length+1;let i=r;B.isDocumentKey(i)||(i=i.child(""));const a=new Se(new B(i),0);let c=new Ae(X);return this.Zr.forEachWhile((l=>{const h=l.key.path;return!!r.isPrefixOf(h)&&(h.length===s&&(c=c.add(l.Yr)),!0)}),a),k.resolve(this.ti(c))}ti(e){const t=[];return e.forEach((r=>{const s=this.Xr(r);s!==null&&t.push(s)})),t}removeMutationBatch(e,t){ne(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return k.forEach(t.mutations,(s=>{const i=new Se(s.key,t.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)})).next((()=>{this.Zr=r}))}ir(e){}containsKey(e,t){const r=new Se(t,0),s=this.Zr.firstAfterOrEqual(r);return k.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,k.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class sT{constructor(e){this.ri=e,this.docs=(function(){return new de(B.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,s=this.docs.get(r),i=s?s.size:0,a=this.ri(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return k.resolve(r?r.document.mutableCopy():xe.newInvalidDocument(t))}getEntries(e,t){let r=en();return t.forEach((s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():xe.newInvalidDocument(s))})),k.resolve(r)}getDocumentsMatchingQuery(e,t,r,s){let i=en();const a=t.path,c=new B(a.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(c);for(;l.hasNext();){const{key:h,value:{document:d}}=l.getNext();if(!a.isPrefixOf(h.path))break;h.path.length>a.length+1||Dv(Nv(d),r)<=0||(s.has(d.key)||Do(t,d))&&(i=i.insert(d.key,d.mutableCopy()))}return k.resolve(i)}getAllFromCollectionGroup(e,t,r,s){j(9500)}ii(e,t){return k.forEach(this.docs,(r=>t(r)))}newChangeBuffer(e){return new iT(this)}getSize(e){return k.resolve(this.size)}}class iT extends JE{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((r,s)=>{s.isValidDocument()?t.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(r)})),k.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class oT{constructor(e){this.persistence=e,this.si=new cr((t=>Mc(t)),Lc),this.lastRemoteSnapshotVersion=z.min(),this.highestTargetId=0,this.oi=0,this._i=new qc,this.targetCount=0,this.ai=jr.ur()}forEachTarget(e,t){return this.si.forEach(((r,s)=>t(s))),k.resolve()}getLastRemoteSnapshotVersion(e){return k.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return k.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),k.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.oi&&(this.oi=t),k.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new jr(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,k.resolve()}updateTargetData(e,t){return this.Pr(t),k.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,k.resolve()}removeTargets(e,t,r){let s=0;const i=[];return this.si.forEach(((a,c)=>{c.sequenceNumber<=t&&r.get(c.targetId)===null&&(this.si.delete(a),i.push(this.removeMatchingKeysForTargetId(e,c.targetId)),s++)})),k.waitFor(i).next((()=>s))}getTargetCount(e){return k.resolve(this.targetCount)}getTargetData(e,t){const r=this.si.get(t)||null;return k.resolve(r)}addMatchingKeys(e,t,r){return this._i.Wr(t,r),k.resolve()}removeMatchingKeys(e,t,r){this._i.zr(t,r);const s=this.persistence.referenceDelegate,i=[];return s&&t.forEach((a=>{i.push(s.markPotentiallyOrphaned(e,a))})),k.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),k.resolve()}getMatchingKeysForTargetId(e,t){const r=this._i.Hr(t);return k.resolve(r)}containsKey(e,t){return k.resolve(this._i.containsKey(t))}}class op{constructor(e,t){this.ui={},this.overlays={},this.ci=new Ro(0),this.li=!1,this.li=!0,this.hi=new nT,this.referenceDelegate=e(this),this.Pi=new oT(this),this.indexManager=new zE,this.remoteDocumentCache=(function(s){return new sT(s)})((r=>this.referenceDelegate.Ti(r))),this.serializer=new jE(t),this.Ii=new eT(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new tT,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ui[e.toKey()];return r||(r=new rT(t,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,r){x("MemoryPersistence","Starting transaction:",e);const s=new aT(this.ci.next());return this.referenceDelegate.Ei(),r(s).next((i=>this.referenceDelegate.di(s).next((()=>i)))).toPromise().then((i=>(s.raiseOnCommittedEvent(),i)))}Ai(e,t){return k.or(Object.values(this.ui).map((r=>()=>r.containsKey(e,t))))}}class aT extends Ov{constructor(e){super(),this.currentSequenceNumber=e}}class zc{constructor(e){this.persistence=e,this.Ri=new qc,this.Vi=null}static mi(e){return new zc(e)}get fi(){if(this.Vi)return this.Vi;throw j(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.fi.delete(r.toString()),k.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.fi.add(r.toString()),k.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),k.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((s=>this.fi.add(s.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((s=>{s.forEach((i=>this.fi.add(i.toString())))})).next((()=>r.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return k.forEach(this.fi,(r=>{const s=B.fromPath(r);return this.gi(e,s).next((i=>{i||t.removeEntry(s,z.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((r=>{r?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return k.or([()=>k.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class Yi{constructor(e,t){this.persistence=e,this.pi=new cr((r=>xv(r.path)),((r,s)=>r.isEqual(s))),this.garbageCollector=XE(this,t)}static mi(e,t){return new Yi(e,t)}Ei(){}di(e){return k.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>t.next((s=>r+s))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}pr(e,t){return k.forEach(this.pi,((r,s)=>this.br(e,r,s).next((i=>i?k.resolve():t(s)))))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.ii(e,(a=>this.br(e,a,t).next((c=>{c||(r++,i.removeEntry(a,z.min()))})))).next((()=>i.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),k.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),k.resolve()}removeReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),k.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),k.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Ci(e.data.value)),t}br(e,t,r){return k.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const s=this.pi.get(t);return k.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class Hc{constructor(e,t,r,s){this.targetId=e,this.fromCache=t,this.Es=r,this.ds=s}static As(e,t){let r=J(),s=J();for(const i of t.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new Hc(e,t.fromCache,r,s)}}class cT{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class uT{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return Z_()?8:Mv(Ue())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,s){const i={result:null};return this.ys(e,t).next((a=>{i.result=a})).next((()=>{if(!i.result)return this.ws(e,t,s,r).next((a=>{i.result=a}))})).next((()=>{if(i.result)return;const a=new cT;return this.Ss(e,t,a).next((c=>{if(i.result=c,this.Vs)return this.bs(e,t,a,c.size)}))})).next((()=>i.result))}bs(e,t,r,s){return r.documentReadCount<this.fs?(_r()<=Q.DEBUG&&x("QueryEngine","SDK will not create cache indexes for query:",yr(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),k.resolve()):(_r()<=Q.DEBUG&&x("QueryEngine","Query:",yr(t),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.gs*s?(_r()<=Q.DEBUG&&x("QueryEngine","The SDK decides to create cache indexes for query:",yr(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ct(t))):k.resolve())}ys(e,t){if(ch(t))return k.resolve(null);let r=Ct(t);return this.indexManager.getIndexType(e,r).next((s=>s===0?null:(t.limit!==null&&s===1&&(t=Ya(t,null,"F"),r=Ct(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next((i=>{const a=J(...i);return this.ps.getDocuments(e,a).next((c=>this.indexManager.getMinOffset(e,r).next((l=>{const h=this.Ds(t,c);return this.Cs(t,h,a,l.readTime)?this.ys(e,Ya(t,null,"F")):this.vs(e,h,t,l)}))))})))))}ws(e,t,r,s){return ch(t)||s.isEqual(z.min())?k.resolve(null):this.ps.getDocuments(e,r).next((i=>{const a=this.Ds(t,i);return this.Cs(t,a,r,s)?k.resolve(null):(_r()<=Q.DEBUG&&x("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),yr(t)),this.vs(e,a,t,kv(s,Us)).next((c=>c)))}))}Ds(e,t){let r=new Ae(Fd(e));return t.forEach(((s,i)=>{Do(e,i)&&(r=r.add(i))})),r}Cs(e,t,r,s){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const i=e.limitType==="F"?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Ss(e,t,r){return _r()<=Q.DEBUG&&x("QueryEngine","Using full collection scan to execute query:",yr(t)),this.ps.getDocumentsMatchingQuery(e,t,Rn.min(),r)}vs(e,t,r,s){return this.ps.getDocumentsMatchingQuery(e,r,s).next((i=>(t.forEach((a=>{i=i.insert(a.key,a)})),i)))}}const Wc="LocalStore",lT=3e8;class hT{constructor(e,t,r,s){this.persistence=e,this.Fs=t,this.serializer=s,this.Ms=new de(X),this.xs=new cr((i=>Mc(i)),Lc),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new ZE(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function fT(n,e,t,r){return new hT(n,e,t,r)}async function ap(n,e){const t=H(n);return await t.persistence.runTransaction("Handle user change","readonly",(r=>{let s;return t.mutationQueue.getAllMutationBatches(r).next((i=>(s=i,t.Bs(e),t.mutationQueue.getAllMutationBatches(r)))).next((i=>{const a=[],c=[];let l=J();for(const h of s){a.push(h.batchId);for(const d of h.mutations)l=l.add(d.key)}for(const h of i){c.push(h.batchId);for(const d of h.mutations)l=l.add(d.key)}return t.localDocuments.getDocuments(r,l).next((h=>({Ls:h,removedBatchIds:a,addedBatchIds:c})))}))}))}function dT(n,e){const t=H(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const s=e.batch.keys(),i=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(c,l,h,d){const g=h.batch,m=g.keys();let T=k.resolve();return m.forEach((S=>{T=T.next((()=>d.getEntry(l,S))).next((P=>{const C=h.docVersions.get(S);ne(C!==null,48541),P.version.compareTo(C)<0&&(g.applyToRemoteDocument(P,h),P.isValidDocument()&&(P.setReadTime(h.commitVersion),d.addEntry(P)))}))})),T.next((()=>c.mutationQueue.removeMutationBatch(l,g)))})(t,r,e,i).next((()=>i.apply(r))).next((()=>t.mutationQueue.performConsistencyCheck(r))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(c){let l=J();for(let h=0;h<c.mutationResults.length;++h)c.mutationResults[h].transformResults.length>0&&(l=l.add(c.batch.mutations[h].key));return l})(e)))).next((()=>t.localDocuments.getDocuments(r,s)))}))}function cp(n){const e=H(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function pT(n,e){const t=H(n),r=e.snapshotVersion;let s=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(i=>{const a=t.Ns.newChangeBuffer({trackRemovals:!0});s=t.Ms;const c=[];e.targetChanges.forEach(((d,g)=>{const m=s.get(g);if(!m)return;c.push(t.Pi.removeMatchingKeys(i,d.removedDocuments,g).next((()=>t.Pi.addMatchingKeys(i,d.addedDocuments,g))));let T=m.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(g)!==null?T=T.withResumeToken(De.EMPTY_BYTE_STRING,z.min()).withLastLimboFreeSnapshotVersion(z.min()):d.resumeToken.approximateByteSize()>0&&(T=T.withResumeToken(d.resumeToken,r)),s=s.insert(g,T),(function(P,C,L){return P.resumeToken.approximateByteSize()===0||C.snapshotVersion.toMicroseconds()-P.snapshotVersion.toMicroseconds()>=lT?!0:L.addedDocuments.size+L.modifiedDocuments.size+L.removedDocuments.size>0})(m,T,d)&&c.push(t.Pi.updateTargetData(i,T))}));let l=en(),h=J();if(e.documentUpdates.forEach((d=>{e.resolvedLimboDocuments.has(d)&&c.push(t.persistence.referenceDelegate.updateLimboDocument(i,d))})),c.push(mT(i,a,e.documentUpdates).next((d=>{l=d.ks,h=d.qs}))),!r.isEqual(z.min())){const d=t.Pi.getLastRemoteSnapshotVersion(i).next((g=>t.Pi.setTargetsMetadata(i,i.currentSequenceNumber,r)));c.push(d)}return k.waitFor(c).next((()=>a.apply(i))).next((()=>t.localDocuments.getLocalViewOfDocuments(i,l,h))).next((()=>l))})).then((i=>(t.Ms=s,i)))}function mT(n,e,t){let r=J(),s=J();return t.forEach((i=>r=r.add(i))),e.getEntries(n,r).next((i=>{let a=en();return t.forEach(((c,l)=>{const h=i.get(c);l.isFoundDocument()!==h.isFoundDocument()&&(s=s.add(c)),l.isNoDocument()&&l.version.isEqual(z.min())?(e.removeEntry(c,l.readTime),a=a.insert(c,l)):!h.isValidDocument()||l.version.compareTo(h.version)>0||l.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(l),a=a.insert(c,l)):x(Wc,"Ignoring outdated watch update for ",c,". Current version:",h.version," Watch version:",l.version)})),{ks:a,qs:s}}))}function gT(n,e){const t=H(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=Dc),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function _T(n,e){const t=H(n);return t.persistence.runTransaction("Allocate target","readwrite",(r=>{let s;return t.Pi.getTargetData(r,e).next((i=>i?(s=i,k.resolve(s)):t.Pi.allocateTargetId(r).next((a=>(s=new gn(e,a,"TargetPurposeListen",r.currentSequenceNumber),t.Pi.addTargetData(r,s).next((()=>s)))))))})).then((r=>{const s=t.Ms.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(r.targetId,r),t.xs.set(e,r.targetId)),r}))}async function rc(n,e,t){const r=H(n),s=r.Ms.get(e),i=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",i,(a=>r.persistence.referenceDelegate.removeTarget(a,s)))}catch(a){if(!ts(a))throw a;x(Wc,`Failed to update sequence numbers for target ${e}: ${a}`)}r.Ms=r.Ms.remove(e),r.xs.delete(s.target)}function Th(n,e,t){const r=H(n);let s=z.min(),i=J();return r.persistence.runTransaction("Execute query","readwrite",(a=>(function(l,h,d){const g=H(l),m=g.xs.get(d);return m!==void 0?k.resolve(g.Ms.get(m)):g.Pi.getTargetData(h,d)})(r,a,Ct(e)).next((c=>{if(c)return s=c.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(a,c.targetId).next((l=>{i=l}))})).next((()=>r.Fs.getDocumentsMatchingQuery(a,e,t?s:z.min(),t?i:J()))).next((c=>(yT(r,rE(e),c),{documents:c,Qs:i})))))}function yT(n,e,t){let r=n.Os.get(e)||z.min();t.forEach(((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)})),n.Os.set(e,r)}class wh{constructor(){this.activeTargetIds=uE()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class vT{constructor(){this.Mo=new wh,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,r){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new wh,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class ET{Oo(e){}shutdown(){}}const Ih="ConnectivityMonitor";class Ah{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){x(Ih,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){x(Ih,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let bi=null;function sc(){return bi===null?bi=(function(){return 268435456+Math.round(2147483648*Math.random())})():bi++,"0x"+bi.toString(16)}const ba="RestConnection",TT={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class wT{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${r}/databases/${s}`,this.Wo=this.databaseId.database===Hi?`project_id=${r}`:`project_id=${r}&database_id=${s}`}Go(e,t,r,s,i){const a=sc(),c=this.zo(e,t.toUriEncodedString());x(ba,`Sending RPC '${e}' ${a}:`,c,r);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,s,i);const{host:h}=new URL(c),d=Vn(h);return this.Jo(e,c,l,r,d).then((g=>(x(ba,`Received RPC '${e}' ${a}: `,g),g)),(g=>{throw Fr(ba,`RPC '${e}' ${a} failed with error: `,g,"url: ",c,"request:",r),g}))}Ho(e,t,r,s,i,a){return this.Go(e,t,r,s,i)}jo(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Zr})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((s,i)=>e[i]=s)),r&&r.headers.forEach(((s,i)=>e[i]=s))}zo(e,t){const r=TT[e];return`${this.Uo}/v1/${t}:${r}`}terminate(){}}class IT{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const Oe="WebChannelConnection";class AT extends wT{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,s,i){const a=sc();return new Promise(((c,l)=>{const h=new fd;h.setWithCredentials(!0),h.listenOnce(dd.COMPLETE,(()=>{try{switch(h.getLastErrorCode()){case Pi.NO_ERROR:const g=h.getResponseJson();x(Oe,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(g)),c(g);break;case Pi.TIMEOUT:x(Oe,`RPC '${e}' ${a} timed out`),l(new U(D.DEADLINE_EXCEEDED,"Request time out"));break;case Pi.HTTP_ERROR:const m=h.getStatus();if(x(Oe,`RPC '${e}' ${a} failed with status:`,m,"response text:",h.getResponseText()),m>0){let T=h.getResponseJson();Array.isArray(T)&&(T=T[0]);const S=T?.error;if(S&&S.status&&S.message){const P=(function(L){const V=L.toLowerCase().replace(/_/g,"-");return Object.values(D).indexOf(V)>=0?V:D.UNKNOWN})(S.status);l(new U(P,S.message))}else l(new U(D.UNKNOWN,"Server responded with status "+h.getStatus()))}else l(new U(D.UNAVAILABLE,"Connection failed."));break;default:j(9055,{l_:e,streamId:a,h_:h.getLastErrorCode(),P_:h.getLastError()})}}finally{x(Oe,`RPC '${e}' ${a} completed.`)}}));const d=JSON.stringify(s);x(Oe,`RPC '${e}' ${a} sending request:`,s),h.send(t,"POST",d,r,15)}))}T_(e,t,r){const s=sc(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=gd(),c=md(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(l.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,t,r),l.encodeInitMessageHeaders=!0;const d=i.join("");x(Oe,`Creating RPC '${e}' stream ${s}: ${d}`,l);const g=a.createWebChannel(d,l);this.I_(g);let m=!1,T=!1;const S=new IT({Yo:C=>{T?x(Oe,`Not sending because RPC '${e}' stream ${s} is closed:`,C):(m||(x(Oe,`Opening RPC '${e}' stream ${s} transport.`),g.open(),m=!0),x(Oe,`RPC '${e}' stream ${s} sending:`,C),g.send(C))},Zo:()=>g.close()}),P=(C,L,V)=>{C.listen(L,(N=>{try{V(N)}catch(F){setTimeout((()=>{throw F}),0)}}))};return P(g,Is.EventType.OPEN,(()=>{T||(x(Oe,`RPC '${e}' stream ${s} transport opened.`),S.o_())})),P(g,Is.EventType.CLOSE,(()=>{T||(T=!0,x(Oe,`RPC '${e}' stream ${s} transport closed`),S.a_(),this.E_(g))})),P(g,Is.EventType.ERROR,(C=>{T||(T=!0,Fr(Oe,`RPC '${e}' stream ${s} transport errored. Name:`,C.name,"Message:",C.message),S.a_(new U(D.UNAVAILABLE,"The operation could not be completed")))})),P(g,Is.EventType.MESSAGE,(C=>{if(!T){const L=C.data[0];ne(!!L,16349);const V=L,N=V?.error||V[0]?.error;if(N){x(Oe,`RPC '${e}' stream ${s} received error:`,N);const F=N.status;let W=(function(_){const y=_e[_];if(y!==void 0)return Qd(y)})(F),K=N.message;W===void 0&&(W=D.INTERNAL,K="Unknown error status: "+F+" with message "+N.message),T=!0,S.a_(new U(W,K)),g.close()}else x(Oe,`RPC '${e}' stream ${s} received:`,L),S.u_(L)}})),P(c,pd.STAT_EVENT,(C=>{C.stat===Wa.PROXY?x(Oe,`RPC '${e}' stream ${s} detected buffering proxy`):C.stat===Wa.NOPROXY&&x(Oe,`RPC '${e}' stream ${s} detected no buffering proxy`)})),setTimeout((()=>{S.__()}),0),S}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function Sa(){return typeof document<"u"?document:null}function Lo(n){return new PE(n,!0)}class up{constructor(e,t,r=1e3,s=1.5,i=6e4){this.Mi=e,this.timerId=t,this.d_=r,this.A_=s,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),s=Math.max(0,t-r);s>0&&x("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const bh="PersistentStream";class lp{constructor(e,t,r,s,i,a,c,l){this.Mi=e,this.S_=r,this.b_=s,this.connection=i,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=c,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new up(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===D.RESOURCE_EXHAUSTED?(Zt(t.toString()),Zt("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===D.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,s])=>{this.D_===t&&this.G_(r,s)}),(r=>{e((()=>{const s=new U(D.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(s)}))}))}G_(e,t){const r=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{r((()=>this.listener.Xo()))})),this.stream.t_((()=>{r((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((s=>{r((()=>this.z_(s)))})),this.stream.onMessage((s=>{r((()=>++this.F_==1?this.J_(s):this.onNext(s)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return x(bh,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(x(bh,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class bT extends lp{constructor(e,t,r,s,i,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,s,a),this.serializer=i}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=NE(this.serializer,e),r=(function(i){if(!("targetChange"in i))return z.min();const a=i.targetChange;return a.targetIds&&a.targetIds.length?z.min():a.readTime?kt(a.readTime):z.min()})(e);return this.listener.H_(t,r)}Y_(e){const t={};t.database=nc(this.serializer),t.addTarget=(function(i,a){let c;const l=a.target;if(c=Ja(l)?{documents:OE(i,l)}:{query:ME(i,l).ft},c.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){c.resumeToken=Yd(i,a.resumeToken);const h=Za(i,a.expectedCount);h!==null&&(c.expectedCount=h)}else if(a.snapshotVersion.compareTo(z.min())>0){c.readTime=Ji(i,a.snapshotVersion.toTimestamp());const h=Za(i,a.expectedCount);h!==null&&(c.expectedCount=h)}return c})(this.serializer,e);const r=xE(this.serializer,e);r&&(t.labels=r),this.q_(t)}Z_(e){const t={};t.database=nc(this.serializer),t.removeTarget=e,this.q_(t)}}class ST extends lp{constructor(e,t,r,s,i,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,s,a),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return ne(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,ne(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){ne(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=VE(e.writeResults,e.commitTime),r=kt(e.commitTime);return this.listener.na(r,t)}ra(){const e={};e.database=nc(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((r=>DE(this.serializer,r)))};this.q_(t)}}class RT{}class PT extends RT{constructor(e,t,r,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new U(D.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,a])=>this.connection.Go(e,ec(t,r),s,i,a))).catch((i=>{throw i.name==="FirebaseError"?(i.code===D.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new U(D.UNKNOWN,i.toString())}))}Ho(e,t,r,s,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,c])=>this.connection.Ho(e,ec(t,r),s,a,c,i))).catch((a=>{throw a.name==="FirebaseError"?(a.code===D.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new U(D.UNKNOWN,a.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class CT{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Zt(t),this.aa=!1):x("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const rr="RemoteStore";class kT{constructor(e,t,r,s,i){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo((a=>{r.enqueueAndForget((async()=>{ur(this)&&(x(rr,"Restarting streams for network reachability change."),await(async function(l){const h=H(l);h.Ea.add(4),await ei(h),h.Ra.set("Unknown"),h.Ea.delete(4),await xo(h)})(this))}))})),this.Ra=new CT(r,s)}}async function xo(n){if(ur(n))for(const e of n.da)await e(!0)}async function ei(n){for(const e of n.da)await e(!1)}function hp(n,e){const t=H(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),Xc(t)?Qc(t):ns(t).O_()&&Kc(t,e))}function Gc(n,e){const t=H(n),r=ns(t);t.Ia.delete(e),r.O_()&&fp(t,e),t.Ia.size===0&&(r.O_()?r.L_():ur(t)&&t.Ra.set("Unknown"))}function Kc(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(z.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}ns(n).Y_(e)}function fp(n,e){n.Va.Ue(e),ns(n).Z_(e)}function Qc(n){n.Va=new AE({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),ns(n).start(),n.Ra.ua()}function Xc(n){return ur(n)&&!ns(n).x_()&&n.Ia.size>0}function ur(n){return H(n).Ea.size===0}function dp(n){n.Va=void 0}async function NT(n){n.Ra.set("Online")}async function DT(n){n.Ia.forEach(((e,t)=>{Kc(n,e)}))}async function VT(n,e){dp(n),Xc(n)?(n.Ra.ha(e),Qc(n)):n.Ra.set("Unknown")}async function OT(n,e,t){if(n.Ra.set("Online"),e instanceof Jd&&e.state===2&&e.cause)try{await(async function(s,i){const a=i.cause;for(const c of i.targetIds)s.Ia.has(c)&&(await s.remoteSyncer.rejectListen(c,a),s.Ia.delete(c),s.Va.removeTarget(c))})(n,e)}catch(r){x(rr,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Zi(n,r)}else if(e instanceof Di?n.Va.Ze(e):e instanceof Xd?n.Va.st(e):n.Va.tt(e),!t.isEqual(z.min()))try{const r=await cp(n.localStore);t.compareTo(r)>=0&&await(function(i,a){const c=i.Va.Tt(a);return c.targetChanges.forEach(((l,h)=>{if(l.resumeToken.approximateByteSize()>0){const d=i.Ia.get(h);d&&i.Ia.set(h,d.withResumeToken(l.resumeToken,a))}})),c.targetMismatches.forEach(((l,h)=>{const d=i.Ia.get(l);if(!d)return;i.Ia.set(l,d.withResumeToken(De.EMPTY_BYTE_STRING,d.snapshotVersion)),fp(i,l);const g=new gn(d.target,l,h,d.sequenceNumber);Kc(i,g)})),i.remoteSyncer.applyRemoteEvent(c)})(n,t)}catch(r){x(rr,"Failed to raise snapshot:",r),await Zi(n,r)}}async function Zi(n,e,t){if(!ts(e))throw e;n.Ea.add(1),await ei(n),n.Ra.set("Offline"),t||(t=()=>cp(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{x(rr,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await xo(n)}))}function pp(n,e){return e().catch((t=>Zi(n,t,e)))}async function Fo(n){const e=H(n),t=Nn(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Dc;for(;MT(e);)try{const s=await gT(e.localStore,r);if(s===null){e.Ta.length===0&&t.L_();break}r=s.batchId,LT(e,s)}catch(s){await Zi(e,s)}mp(e)&&gp(e)}function MT(n){return ur(n)&&n.Ta.length<10}function LT(n,e){n.Ta.push(e);const t=Nn(n);t.O_()&&t.X_&&t.ea(e.mutations)}function mp(n){return ur(n)&&!Nn(n).x_()&&n.Ta.length>0}function gp(n){Nn(n).start()}async function xT(n){Nn(n).ra()}async function FT(n){const e=Nn(n);for(const t of n.Ta)e.ea(t.mutations)}async function UT(n,e,t){const r=n.Ta.shift(),s=Bc.from(r,e,t);await pp(n,(()=>n.remoteSyncer.applySuccessfulWrite(s))),await Fo(n)}async function BT(n,e){e&&Nn(n).X_&&await(async function(r,s){if((function(a){return TE(a)&&a!==D.ABORTED})(s.code)){const i=r.Ta.shift();Nn(r).B_(),await pp(r,(()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s))),await Fo(r)}})(n,e),mp(n)&&gp(n)}async function Sh(n,e){const t=H(n);t.asyncQueue.verifyOperationInProgress(),x(rr,"RemoteStore received new credentials");const r=ur(t);t.Ea.add(3),await ei(t),r&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await xo(t)}async function $T(n,e){const t=H(n);e?(t.Ea.delete(2),await xo(t)):e||(t.Ea.add(2),await ei(t),t.Ra.set("Unknown"))}function ns(n){return n.ma||(n.ma=(function(t,r,s){const i=H(t);return i.sa(),new bT(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)})(n.datastore,n.asyncQueue,{Xo:NT.bind(null,n),t_:DT.bind(null,n),r_:VT.bind(null,n),H_:OT.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),Xc(n)?Qc(n):n.Ra.set("Unknown")):(await n.ma.stop(),dp(n))}))),n.ma}function Nn(n){return n.fa||(n.fa=(function(t,r,s){const i=H(t);return i.sa(),new ST(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:xT.bind(null,n),r_:BT.bind(null,n),ta:FT.bind(null,n),na:UT.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await Fo(n)):(await n.fa.stop(),n.Ta.length>0&&(x(rr,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class Jc{constructor(e,t,r,s,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new Gn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((a=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,s,i){const a=Date.now()+r,c=new Jc(e,t,a,s,i);return c.start(r),c}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new U(D.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Yc(n,e){if(Zt("AsyncQueue",`${e}: ${n}`),ts(n))return new U(D.UNAVAILABLE,`${e}: ${n}`);throw n}class Pr{static emptySet(e){return new Pr(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||B.comparator(t.key,r.key):(t,r)=>B.comparator(t.key,r.key),this.keyedMap=As(),this.sortedSet=new de(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,r)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Pr)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new Pr;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class Rh{constructor(){this.ga=new de(B.comparator)}track(e){const t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):j(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,r)=>{e.push(r)})),e}}class qr{constructor(e,t,r,s,i,a,c,l,h){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=a,this.syncStateChanged=c,this.excludesMetadataChanges=l,this.hasCachedResults=h}static fromInitialDocuments(e,t,r,s,i){const a=[];return t.forEach((c=>{a.push({type:0,doc:c})})),new qr(e,t,Pr.emptySet(t),a,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&No(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==r[s].type||!t[s].doc.isEqual(r[s].doc))return!1;return!0}}class jT{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class qT{constructor(){this.queries=Ph(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){const s=H(t),i=s.queries;s.queries=Ph(),i.forEach(((a,c)=>{for(const l of c.Sa)l.onError(r)}))})(this,new U(D.ABORTED,"Firestore shutting down"))}}function Ph(){return new cr((n=>xd(n)),No)}async function zT(n,e){const t=H(n);let r=3;const s=e.query;let i=t.queries.get(s);i?!i.ba()&&e.Da()&&(r=2):(i=new jT,r=e.Da()?0:1);try{switch(r){case 0:i.wa=await t.onListen(s,!0);break;case 1:i.wa=await t.onListen(s,!1);break;case 2:await t.onFirstRemoteStoreListen(s)}}catch(a){const c=Yc(a,`Initialization of query '${yr(e.query)}' failed`);return void e.onError(c)}t.queries.set(s,i),i.Sa.push(e),e.va(t.onlineState),i.wa&&e.Fa(i.wa)&&Zc(t)}async function HT(n,e){const t=H(n),r=e.query;let s=3;const i=t.queries.get(r);if(i){const a=i.Sa.indexOf(e);a>=0&&(i.Sa.splice(a,1),i.Sa.length===0?s=e.Da()?0:1:!i.ba()&&e.Da()&&(s=2))}switch(s){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function WT(n,e){const t=H(n);let r=!1;for(const s of e){const i=s.query,a=t.queries.get(i);if(a){for(const c of a.Sa)c.Fa(s)&&(r=!0);a.wa=s}}r&&Zc(t)}function GT(n,e,t){const r=H(n),s=r.queries.get(e);if(s)for(const i of s.Sa)i.onError(t);r.queries.delete(e)}function Zc(n){n.Ca.forEach((e=>{e.next()}))}var ic,Ch;(Ch=ic||(ic={})).Ma="default",Ch.Cache="cache";class KT{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new qr(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const r=t!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=qr.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==ic.Cache}}class _p{constructor(e){this.key=e}}class yp{constructor(e){this.key=e}}class QT{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=J(),this.mutatedKeys=J(),this.eu=Fd(e),this.tu=new Pr(this.eu)}get nu(){return this.Ya}ru(e,t){const r=t?t.iu:new Rh,s=t?t.tu:this.tu;let i=t?t.mutatedKeys:this.mutatedKeys,a=s,c=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,h=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal(((d,g)=>{const m=s.get(d),T=Do(this.query,g)?g:null,S=!!m&&this.mutatedKeys.has(m.key),P=!!T&&(T.hasLocalMutations||this.mutatedKeys.has(T.key)&&T.hasCommittedMutations);let C=!1;m&&T?m.data.isEqual(T.data)?S!==P&&(r.track({type:3,doc:T}),C=!0):this.su(m,T)||(r.track({type:2,doc:T}),C=!0,(l&&this.eu(T,l)>0||h&&this.eu(T,h)<0)&&(c=!0)):!m&&T?(r.track({type:0,doc:T}),C=!0):m&&!T&&(r.track({type:1,doc:m}),C=!0,(l||h)&&(c=!0)),C&&(T?(a=a.add(T),i=P?i.add(d):i.delete(d)):(a=a.delete(d),i=i.delete(d)))})),this.query.limit!==null)for(;a.size>this.query.limit;){const d=this.query.limitType==="F"?a.last():a.first();a=a.delete(d.key),i=i.delete(d.key),r.track({type:1,doc:d})}return{tu:a,iu:r,Cs:c,mutatedKeys:i}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,s){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const a=e.iu.ya();a.sort(((d,g)=>(function(T,S){const P=C=>{switch(C){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return j(20277,{Rt:C})}};return P(T)-P(S)})(d.type,g.type)||this.eu(d.doc,g.doc))),this.ou(r),s=s??!1;const c=t&&!s?this._u():[],l=this.Xa.size===0&&this.current&&!s?1:0,h=l!==this.Za;return this.Za=l,a.length!==0||h?{snapshot:new qr(this.query,e.tu,i,a,e.mutatedKeys,l===0,h,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:c}:{au:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Rh,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=J(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))}));const t=[];return e.forEach((r=>{this.Xa.has(r)||t.push(new yp(r))})),this.Xa.forEach((r=>{e.has(r)||t.push(new _p(r))})),t}cu(e){this.Ya=e.Qs,this.Xa=J();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return qr.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const eu="SyncEngine";class XT{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class JT{constructor(e){this.key=e,this.hu=!1}}class YT{constructor(e,t,r,s,i,a){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new cr((c=>xd(c)),No),this.Iu=new Map,this.Eu=new Set,this.du=new de(B.comparator),this.Au=new Map,this.Ru=new qc,this.Vu={},this.mu=new Map,this.fu=jr.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function ZT(n,e,t=!0){const r=Ap(n);let s;const i=r.Tu.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.lu()):s=await vp(r,e,t,!0),s}async function ew(n,e){const t=Ap(n);await vp(t,e,!0,!1)}async function vp(n,e,t,r){const s=await _T(n.localStore,Ct(e)),i=s.targetId,a=n.sharedClientState.addLocalQueryTarget(i,t);let c;return r&&(c=await tw(n,e,i,a==="current",s.resumeToken)),n.isPrimaryClient&&t&&hp(n.remoteStore,s),c}async function tw(n,e,t,r,s){n.pu=(g,m,T)=>(async function(P,C,L,V){let N=C.view.ru(L);N.Cs&&(N=await Th(P.localStore,C.query,!1).then((({documents:w})=>C.view.ru(w,N))));const F=V&&V.targetChanges.get(C.targetId),W=V&&V.targetMismatches.get(C.targetId)!=null,K=C.view.applyChanges(N,P.isPrimaryClient,F,W);return Nh(P,C.targetId,K.au),K.snapshot})(n,g,m,T);const i=await Th(n.localStore,e,!0),a=new QT(e,i.Qs),c=a.ru(i.documents),l=Zs.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",s),h=a.applyChanges(c,n.isPrimaryClient,l);Nh(n,t,h.au);const d=new XT(e,t,a);return n.Tu.set(e,d),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),h.snapshot}async function nw(n,e,t){const r=H(n),s=r.Tu.get(e),i=r.Iu.get(s.targetId);if(i.length>1)return r.Iu.set(s.targetId,i.filter((a=>!No(a,e)))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await rc(r.localStore,s.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(s.targetId),t&&Gc(r.remoteStore,s.targetId),oc(r,s.targetId)})).catch(es)):(oc(r,s.targetId),await rc(r.localStore,s.targetId,!0))}async function rw(n,e){const t=H(n),r=t.Tu.get(e),s=t.Iu.get(r.targetId);t.isPrimaryClient&&s.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Gc(t.remoteStore,r.targetId))}async function sw(n,e,t){const r=hw(n);try{const s=await(function(a,c){const l=H(a),h=le.now(),d=c.reduce(((T,S)=>T.add(S.key)),J());let g,m;return l.persistence.runTransaction("Locally write mutations","readwrite",(T=>{let S=en(),P=J();return l.Ns.getEntries(T,d).next((C=>{S=C,S.forEach(((L,V)=>{V.isValidDocument()||(P=P.add(L))}))})).next((()=>l.localDocuments.getOverlayedDocuments(T,S))).next((C=>{g=C;const L=[];for(const V of c){const N=gE(V,g.get(V.key).overlayedDocument);N!=null&&L.push(new Mn(V.key,N,kd(N.value.mapValue),ft.exists(!0)))}return l.mutationQueue.addMutationBatch(T,h,L,c)})).next((C=>{m=C;const L=C.applyToLocalDocumentSet(g,P);return l.documentOverlayCache.saveOverlays(T,C.batchId,L)}))})).then((()=>({batchId:m.batchId,changes:Bd(g)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),(function(a,c,l){let h=a.Vu[a.currentUser.toKey()];h||(h=new de(X)),h=h.insert(c,l),a.Vu[a.currentUser.toKey()]=h})(r,s.batchId,t),await ti(r,s.changes),await Fo(r.remoteStore)}catch(s){const i=Yc(s,"Failed to persist write");t.reject(i)}}async function Ep(n,e){const t=H(n);try{const r=await pT(t.localStore,e);e.targetChanges.forEach(((s,i)=>{const a=t.Au.get(i);a&&(ne(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?a.hu=!0:s.modifiedDocuments.size>0?ne(a.hu,14607):s.removedDocuments.size>0&&(ne(a.hu,42227),a.hu=!1))})),await ti(t,r,e)}catch(r){await es(r)}}function kh(n,e,t){const r=H(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const s=[];r.Tu.forEach(((i,a)=>{const c=a.view.va(e);c.snapshot&&s.push(c.snapshot)})),(function(a,c){const l=H(a);l.onlineState=c;let h=!1;l.queries.forEach(((d,g)=>{for(const m of g.Sa)m.va(c)&&(h=!0)})),h&&Zc(l)})(r.eventManager,e),s.length&&r.Pu.H_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function iw(n,e,t){const r=H(n);r.sharedClientState.updateQueryState(e,"rejected",t);const s=r.Au.get(e),i=s&&s.key;if(i){let a=new de(B.comparator);a=a.insert(i,xe.newNoDocument(i,z.min()));const c=J().add(i),l=new Mo(z.min(),new Map,new de(X),a,c);await Ep(r,l),r.du=r.du.remove(i),r.Au.delete(e),tu(r)}else await rc(r.localStore,e,!1).then((()=>oc(r,e,t))).catch(es)}async function ow(n,e){const t=H(n),r=e.batch.batchId;try{const s=await dT(t.localStore,e);wp(t,r,null),Tp(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await ti(t,s)}catch(s){await es(s)}}async function aw(n,e,t){const r=H(n);try{const s=await(function(a,c){const l=H(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",(h=>{let d;return l.mutationQueue.lookupMutationBatch(h,c).next((g=>(ne(g!==null,37113),d=g.keys(),l.mutationQueue.removeMutationBatch(h,g)))).next((()=>l.mutationQueue.performConsistencyCheck(h))).next((()=>l.documentOverlayCache.removeOverlaysForBatchId(h,d,c))).next((()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,d))).next((()=>l.localDocuments.getDocuments(h,d)))}))})(r.localStore,e);wp(r,e,t),Tp(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await ti(r,s)}catch(s){await es(s)}}function Tp(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function wp(n,e,t){const r=H(n);let s=r.Vu[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(t?i.reject(t):i.resolve(),s=s.remove(e)),r.Vu[r.currentUser.toKey()]=s}}function oc(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Iu.get(e))n.Tu.delete(r),t&&n.Pu.yu(r,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((r=>{n.Ru.containsKey(r)||Ip(n,r)}))}function Ip(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(Gc(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),tu(n))}function Nh(n,e,t){for(const r of t)r instanceof _p?(n.Ru.addReference(r.key,e),cw(n,r)):r instanceof yp?(x(eu,"Document no longer in limbo: "+r.key),n.Ru.removeReference(r.key,e),n.Ru.containsKey(r.key)||Ip(n,r.key)):j(19791,{wu:r})}function cw(n,e){const t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Eu.has(r)||(x(eu,"New document in limbo: "+t),n.Eu.add(r),tu(n))}function tu(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new B(ue.fromString(e)),r=n.fu.next();n.Au.set(r,new JT(t)),n.du=n.du.insert(t,r),hp(n.remoteStore,new gn(Ct(xc(t.path)),r,"TargetPurposeLimboResolution",Ro.ce))}}async function ti(n,e,t){const r=H(n),s=[],i=[],a=[];r.Tu.isEmpty()||(r.Tu.forEach(((c,l)=>{a.push(r.pu(l,e,t).then((h=>{if((h||t)&&r.isPrimaryClient){const d=h?!h.fromCache:t?.targetChanges.get(l.targetId)?.current;r.sharedClientState.updateQueryState(l.targetId,d?"current":"not-current")}if(h){s.push(h);const d=Hc.As(l.targetId,h);i.push(d)}})))})),await Promise.all(a),r.Pu.H_(s),await(async function(l,h){const d=H(l);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",(g=>k.forEach(h,(m=>k.forEach(m.Es,(T=>d.persistence.referenceDelegate.addReference(g,m.targetId,T))).next((()=>k.forEach(m.ds,(T=>d.persistence.referenceDelegate.removeReference(g,m.targetId,T)))))))))}catch(g){if(!ts(g))throw g;x(Wc,"Failed to update sequence numbers: "+g)}for(const g of h){const m=g.targetId;if(!g.fromCache){const T=d.Ms.get(m),S=T.snapshotVersion,P=T.withLastLimboFreeSnapshotVersion(S);d.Ms=d.Ms.insert(m,P)}}})(r.localStore,i))}async function uw(n,e){const t=H(n);if(!t.currentUser.isEqual(e)){x(eu,"User change. New user:",e.toKey());const r=await ap(t.localStore,e);t.currentUser=e,(function(i,a){i.mu.forEach((c=>{c.forEach((l=>{l.reject(new U(D.CANCELLED,a))}))})),i.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await ti(t,r.Ls)}}function lw(n,e){const t=H(n),r=t.Au.get(e);if(r&&r.hu)return J().add(r.key);{let s=J();const i=t.Iu.get(e);if(!i)return s;for(const a of i){const c=t.Tu.get(a);s=s.unionWith(c.view.nu)}return s}}function Ap(n){const e=H(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Ep.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=lw.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=iw.bind(null,e),e.Pu.H_=WT.bind(null,e.eventManager),e.Pu.yu=GT.bind(null,e.eventManager),e}function hw(n){const e=H(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=ow.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=aw.bind(null,e),e}class eo{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Lo(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return fT(this.persistence,new uT,e.initialUser,this.serializer)}Cu(e){return new op(zc.mi,this.serializer)}Du(e){return new vT}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}eo.provider={build:()=>new eo};class fw extends eo{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){ne(this.persistence.referenceDelegate instanceof Yi,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new KE(r,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?He.withCacheSize(this.cacheSizeBytes):He.DEFAULT;return new op((r=>Yi.mi(r,t)),this.serializer)}}class ac{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>kh(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=uw.bind(null,this.syncEngine),await $T(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new qT})()}createDatastore(e){const t=Lo(e.databaseInfo.databaseId),r=(function(i){return new AT(i)})(e.databaseInfo);return(function(i,a,c,l){return new PT(i,a,c,l)})(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return(function(r,s,i,a,c){return new kT(r,s,i,a,c)})(this.localStore,this.datastore,e.asyncQueue,(t=>kh(this.syncEngine,t,0)),(function(){return Ah.v()?new Ah:new ET})())}createSyncEngine(e,t){return(function(s,i,a,c,l,h,d){const g=new YT(s,i,a,c,l,h);return d&&(g.gu=!0),g})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const r=H(t);x(rr,"RemoteStore shutting down."),r.Ea.add(5),await ei(r),r.Aa.shutdown(),r.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}ac.provider={build:()=>new ac};class dw{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Zt("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const Dn="FirestoreClient";class pw{constructor(e,t,r,s,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=s,this.user=Le.UNAUTHENTICATED,this.clientId=kc.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,(async a=>{x(Dn,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a})),this.appCheckCredentials.start(r,(a=>(x(Dn,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Gn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=Yc(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function Ra(n,e){n.asyncQueue.verifyOperationInProgress(),x(Dn,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener((async s=>{r.isEqual(s)||(await ap(e.localStore,s),r=s)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function Dh(n,e){n.asyncQueue.verifyOperationInProgress();const t=await mw(n);x(Dn,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((r=>Sh(e.remoteStore,r))),n.setAppCheckTokenChangeListener(((r,s)=>Sh(e.remoteStore,s))),n._onlineComponents=e}async function mw(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){x(Dn,"Using user provided OfflineComponentProvider");try{await Ra(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(s){return s.name==="FirebaseError"?s.code===D.FAILED_PRECONDITION||s.code===D.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11})(t))throw t;Fr("Error using user provided cache. Falling back to memory cache: "+t),await Ra(n,new eo)}}else x(Dn,"Using default OfflineComponentProvider"),await Ra(n,new fw(void 0));return n._offlineComponents}async function bp(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(x(Dn,"Using user provided OnlineComponentProvider"),await Dh(n,n._uninitializedComponentsProvider._online)):(x(Dn,"Using default OnlineComponentProvider"),await Dh(n,new ac))),n._onlineComponents}function gw(n){return bp(n).then((e=>e.syncEngine))}async function Vh(n){const e=await bp(n),t=e.eventManager;return t.onListen=ZT.bind(null,e.syncEngine),t.onUnlisten=nw.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=ew.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=rw.bind(null,e.syncEngine),t}function Sp(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const Oh=new Map;const Rp="firestore.googleapis.com",Mh=!0;class Lh{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new U(D.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Rp,this.ssl=Mh}else this.host=e.host,this.ssl=e.ssl??Mh;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=ip;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<WE)throw new U(D.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Cv("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Sp(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new U(D.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new U(D.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new U(D.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,s){return r.timeoutSeconds===s.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Uo{constructor(e,t,r,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Lh({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new U(D.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new U(D.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Lh(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new vv;switch(r.type){case"firstParty":return new Iv(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new U(D.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const r=Oh.get(t);r&&(x("ComponentProvider","Removing Datastore"),Oh.delete(t),r.terminate())})(this),Promise.resolve()}}function _w(n,e,t,r={}){n=In(n,Uo);const s=Vn(e),i=n._getSettings(),a={...i,emulatorOptions:n._getEmulatorOptions()},c=`${e}:${t}`;s&&(Ac(`https://${c}`),bc("Firestore",!0)),i.host!==Rp&&i.host!==c&&Fr("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...i,host:c,ssl:s,emulatorOptions:r};if(!er(l,a)&&(n._setSettings(l),r.mockUserToken)){let h,d;if(typeof r.mockUserToken=="string")h=r.mockUserToken,d=Le.MOCK_USER;else{h=z_(r.mockUserToken,n._app?.options.projectId);const g=r.mockUserToken.sub||r.mockUserToken.user_id;if(!g)throw new U(D.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new Le(g)}n._authCredentials=new Ev(new yd(h,d))}}class Bo{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Bo(this.firestore,e,this._query)}}class Ie{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new An(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ie(this.firestore,e,this._key)}toJSON(){return{type:Ie._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(Js(t,Ie._jsonSchema))return new Ie(e,r||null,new B(ue.fromString(t.referencePath)))}}Ie._jsonSchemaVersion="firestore/documentReference/1.0",Ie._jsonSchema={type:ye("string",Ie._jsonSchemaVersion),referencePath:ye("string")};class An extends Bo{constructor(e,t,r){super(e,t,xc(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ie(this.firestore,null,new B(e))}withConverter(e){return new An(this.firestore,e,this._path)}}function Pp(n,e,...t){if(n=ve(n),vd("collection","path",e),n instanceof Uo){const r=ue.fromString(e,...t);return Ql(r),new An(n,null,r)}{if(!(n instanceof Ie||n instanceof An))throw new U(D.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(ue.fromString(e,...t));return Ql(r),new An(n.firestore,null,r)}}function nu(n,e,...t){if(n=ve(n),arguments.length===1&&(e=kc.newId()),vd("doc","path",e),n instanceof Uo){const r=ue.fromString(e,...t);return Kl(r),new Ie(n,null,new B(r))}{if(!(n instanceof Ie||n instanceof An))throw new U(D.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(ue.fromString(e,...t));return Kl(r),new Ie(n.firestore,n instanceof An?n.converter:null,new B(r))}}const xh="AsyncQueue";class Fh{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new up(this,"async_queue_retry"),this._c=()=>{const r=Sa();r&&x(xh,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const t=Sa();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Sa();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new Gn;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!ts(e))throw e;x(xh,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((r=>{throw this.nc=r,this.rc=!1,Zt("INTERNAL UNHANDLED ERROR: ",Uh(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const s=Jc.createAndSchedule(this,e,t,r,(i=>this.hc(i)));return this.tc.push(s),s}uc(){this.nc&&j(47125,{Pc:Uh(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,r)=>t.targetTimeMs-r.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function Uh(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}function Bh(n){return(function(t,r){if(typeof t!="object"||t===null)return!1;const s=t;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1})(n,["next","error","complete"])}class zr extends Uo{constructor(e,t,r,s){super(e,t,r,s),this.type="firestore",this._queue=new Fh,this._persistenceKey=s?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Fh(e),this._firestoreClient=void 0,await e}}}function yw(n,e){const t=typeof n=="object"?n:Pc(),r=typeof n=="string"?n:Hi,s=So(t,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=rd("firestore");i&&_w(s,...i)}return s}function Cp(n){if(n._terminated)throw new U(D.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||vw(n),n._firestoreClient}function vw(n){const e=n._freezeSettings(),t=(function(s,i,a,c){return new Bv(s,i,a,c.host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,Sp(c.experimentalLongPollingOptions),c.useFetchStreams,c.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new pw(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(s){const i=s?._online.build();return{_offline:s?._offline.build(i),_online:i}})(n._componentsProvider))}class it{constructor(e){this._byteString=e}static fromBase64String(e){try{return new it(De.fromBase64String(e))}catch(t){throw new U(D.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new it(De.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:it._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Js(e,it._jsonSchema))return it.fromBase64String(e.bytes)}}it._jsonSchemaVersion="firestore/bytes/1.0",it._jsonSchema={type:ye("string",it._jsonSchemaVersion),bytes:ye("string")};class $o{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new U(D.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ce(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class ru{constructor(e){this._methodName=e}}class Nt{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new U(D.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new U(D.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return X(this._lat,e._lat)||X(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Nt._jsonSchemaVersion}}static fromJSON(e){if(Js(e,Nt._jsonSchema))return new Nt(e.latitude,e.longitude)}}Nt._jsonSchemaVersion="firestore/geoPoint/1.0",Nt._jsonSchema={type:ye("string",Nt._jsonSchemaVersion),latitude:ye("number"),longitude:ye("number")};class Dt{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Dt._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Js(e,Dt._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new Dt(e.vectorValues);throw new U(D.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Dt._jsonSchemaVersion="firestore/vectorValue/1.0",Dt._jsonSchema={type:ye("string",Dt._jsonSchemaVersion),vectorValues:ye("object")};const Ew=/^__.*__$/;class Tw{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Mn(e,this.data,this.fieldMask,t,this.fieldTransforms):new Ys(e,this.data,t,this.fieldTransforms)}}class kp{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Mn(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Np(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw j(40011,{Ac:n})}}class su{constructor(e,t,r,s,i,a){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new su({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.gc(e),r}yc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return to(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(Np(this.Ac)&&Ew.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class ww{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Lo(e)}Cc(e,t,r,s=!1){return new su({Ac:e,methodName:t,Dc:r,path:Ce.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Dp(n){const e=n._freezeSettings(),t=Lo(n._databaseId);return new ww(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Iw(n,e,t,r,s,i={}){const a=n.Cc(i.merge||i.mergeFields?2:0,e,t,s);iu("Data must be an object, but it was:",a,r);const c=Vp(r,a);let l,h;if(i.merge)l=new Ze(a.fieldMask),h=a.fieldTransforms;else if(i.mergeFields){const d=[];for(const g of i.mergeFields){const m=cc(e,g,t);if(!a.contains(m))throw new U(D.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);Mp(d,m)||d.push(m)}l=new Ze(d),h=a.fieldTransforms.filter((g=>l.covers(g.field)))}else l=null,h=a.fieldTransforms;return new Tw(new We(c),l,h)}class jo extends ru{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof jo}}function Aw(n,e,t,r){const s=n.Cc(1,e,t);iu("Data must be an object, but it was:",s,r);const i=[],a=We.empty();On(r,((l,h)=>{const d=ou(e,l,t);h=ve(h);const g=s.yc(d);if(h instanceof jo)i.push(d);else{const m=qo(h,g);m!=null&&(i.push(d),a.set(d,m))}}));const c=new Ze(i);return new kp(a,c,s.fieldTransforms)}function bw(n,e,t,r,s,i){const a=n.Cc(1,e,t),c=[cc(e,r,t)],l=[s];if(i.length%2!=0)throw new U(D.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<i.length;m+=2)c.push(cc(e,i[m])),l.push(i[m+1]);const h=[],d=We.empty();for(let m=c.length-1;m>=0;--m)if(!Mp(h,c[m])){const T=c[m];let S=l[m];S=ve(S);const P=a.yc(T);if(S instanceof jo)h.push(T);else{const C=qo(S,P);C!=null&&(h.push(T),d.set(T,C))}}const g=new Ze(h);return new kp(d,g,a.fieldTransforms)}function qo(n,e){if(Op(n=ve(n)))return iu("Unsupported field value:",e,n),Vp(n,e);if(n instanceof ru)return(function(r,s){if(!Np(s.Ac))throw s.Sc(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(r,s){const i=[];let a=0;for(const c of r){let l=qo(c,s.wc(a));l==null&&(l={nullValue:"NULL_VALUE"}),i.push(l),a++}return{arrayValue:{values:i}}})(n,e)}return(function(r,s){if((r=ve(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return lE(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=le.fromDate(r);return{timestampValue:Ji(s.serializer,i)}}if(r instanceof le){const i=new le(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Ji(s.serializer,i)}}if(r instanceof Nt)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof it)return{bytesValue:Yd(s.serializer,r._byteString)};if(r instanceof Ie){const i=s.databaseId,a=r.firestore._databaseId;if(!a.isEqual(i))throw s.Sc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:jc(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof Dt)return(function(a,c){return{mapValue:{fields:{[Pd]:{stringValue:Cd},[Wi]:{arrayValue:{values:a.toArray().map((h=>{if(typeof h!="number")throw c.Sc("VectorValues must only contain numeric values.");return Fc(c.serializer,h)}))}}}}}})(r,s);throw s.Sc(`Unsupported field value: ${Nc(r)}`)})(n,e)}function Vp(n,e){const t={};return wd(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):On(n,((r,s)=>{const i=qo(s,e.mc(r));i!=null&&(t[r]=i)})),{mapValue:{fields:t}}}function Op(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof le||n instanceof Nt||n instanceof it||n instanceof Ie||n instanceof ru||n instanceof Dt)}function iu(n,e,t){if(!Op(t)||!Ed(t)){const r=Nc(t);throw r==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+r)}}function cc(n,e,t){if((e=ve(e))instanceof $o)return e._internalPath;if(typeof e=="string")return ou(n,e);throw to("Field path arguments must be of type string or ",n,!1,void 0,t)}const Sw=new RegExp("[~\\*/\\[\\]]");function ou(n,e,t){if(e.search(Sw)>=0)throw to(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new $o(...e.split("."))._internalPath}catch{throw to(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function to(n,e,t,r,s){const i=r&&!r.isEmpty(),a=s!==void 0;let c=`Function ${e}() called with invalid data`;t&&(c+=" (via `toFirestore()`)"),c+=". ";let l="";return(i||a)&&(l+=" (found",i&&(l+=` in field ${r}`),a&&(l+=` in document ${s}`),l+=")"),new U(D.INVALID_ARGUMENT,c+n+l)}function Mp(n,e){return n.some((t=>t.isEqual(e)))}class Lp{constructor(e,t,r,s,i){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Ie(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new Rw(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(xp("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class Rw extends Lp{data(){return super.data()}}function xp(n,e){return typeof e=="string"?ou(n,e):e instanceof $o?e._internalPath:e._delegate._internalPath}function Pw(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new U(D.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Cw{convertValue(e,t="none"){switch(kn(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ge(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Cn(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw j(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return On(e,((s,i)=>{r[s]=this.convertValue(i,t)})),r}convertVectorValue(e){const t=e.fields?.[Wi].arrayValue?.values?.map((r=>ge(r.doubleValue)));return new Dt(t)}convertGeoPoint(e){return new Nt(ge(e.latitude),ge(e.longitude))}convertArray(e,t){return(e.values||[]).map((r=>this.convertValue(r,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const r=Co(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Bs(e));default:return null}}convertTimestamp(e){const t=Pn(e);return new le(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=ue.fromString(e);ne(sp(r),9688,{name:e});const s=new $s(r.get(1),r.get(3)),i=new B(r.popFirst(5));return s.isEqual(t)||Zt(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}function kw(n,e,t){let r;return r=n?n.toFirestore(e):e,r}class Ss{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Kn extends Lp{constructor(e,t,r,s,i,a){super(e,t,r,s,a),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Vi(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(xp("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new U(D.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Kn._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Kn._jsonSchemaVersion="firestore/documentSnapshot/1.0",Kn._jsonSchema={type:ye("string",Kn._jsonSchemaVersion),bundleSource:ye("string","DocumentSnapshot"),bundleName:ye("string"),bundle:ye("string")};class Vi extends Kn{data(e={}){return super.data(e)}}class Cr{constructor(e,t,r,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new Ss(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((r=>{e.call(t,new Vi(this._firestore,this._userDataWriter,r.key,r,new Ss(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new U(D.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(s,i){if(s._snapshot.oldDocs.isEmpty()){let a=0;return s._snapshot.docChanges.map((c=>{const l=new Vi(s._firestore,s._userDataWriter,c.doc.key,c.doc,new Ss(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);return c.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}}))}{let a=s._snapshot.oldDocs;return s._snapshot.docChanges.filter((c=>i||c.type!==3)).map((c=>{const l=new Vi(s._firestore,s._userDataWriter,c.doc.key,c.doc,new Ss(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);let h=-1,d=-1;return c.type!==0&&(h=a.indexOf(c.doc.key),a=a.delete(c.doc.key)),c.type!==1&&(a=a.add(c.doc),d=a.indexOf(c.doc.key)),{type:Nw(c.type),doc:l,oldIndex:h,newIndex:d}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new U(D.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Cr._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=kc.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],s=[];return this.docs.forEach((i=>{i._document!==null&&(t.push(i._document),r.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),s.push(i.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function Nw(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return j(61501,{type:n})}}Cr._jsonSchemaVersion="firestore/querySnapshot/1.0",Cr._jsonSchema={type:ye("string",Cr._jsonSchemaVersion),bundleSource:ye("string","QuerySnapshot"),bundleName:ye("string"),bundle:ye("string")};class Fp extends Cw{constructor(e){super(),this.firestore=e}convertBytes(e){return new it(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Ie(this.firestore,null,t)}}function Dw(n,e,t,...r){n=In(n,Ie);const s=In(n.firestore,zr),i=Dp(s);let a;return a=typeof(e=ve(e))=="string"||e instanceof $o?bw(i,"updateDoc",n._key,e,t,r):Aw(i,"updateDoc",n._key,e),au(s,[a.toMutation(n._key,ft.exists(!0))])}function Vw(n){return au(In(n.firestore,zr),[new Uc(n._key,ft.none())])}function Ow(n,e){const t=In(n.firestore,zr),r=nu(n),s=kw(n.converter,e);return au(t,[Iw(Dp(n.firestore),"addDoc",r._key,s,n.converter!==null,{}).toMutation(r._key,ft.exists(!1))]).then((()=>r))}function Mw(n,...e){n=ve(n);let t={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||Bh(e[r])||(t=e[r++]);const s={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(Bh(e[r])){const l=e[r];e[r]=l.next?.bind(l),e[r+1]=l.error?.bind(l),e[r+2]=l.complete?.bind(l)}let i,a,c;if(n instanceof Ie)a=In(n.firestore,zr),c=xc(n._key.path),i={next:l=>{e[r]&&e[r](Lw(a,n,l))},error:e[r+1],complete:e[r+2]};else{const l=In(n,Bo);a=In(l.firestore,zr),c=l._query;const h=new Fp(a);i={next:d=>{e[r]&&e[r](new Cr(a,h,l,d))},error:e[r+1],complete:e[r+2]},Pw(n._query)}return(function(h,d,g,m){const T=new dw(m),S=new KT(d,T,g);return h.asyncQueue.enqueueAndForget((async()=>zT(await Vh(h),S))),()=>{T.Nu(),h.asyncQueue.enqueueAndForget((async()=>HT(await Vh(h),S)))}})(Cp(a),c,s,i)}function au(n,e){return(function(r,s){const i=new Gn;return r.asyncQueue.enqueueAndForget((async()=>sw(await gw(r),s,i))),i.promise})(Cp(n),e)}function Lw(n,e,t){const r=t.docs.get(e._key),s=new Fp(n);return new Kn(n,s,e._key,r,new Ss(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(s){Zr=s})(Yr),tr(new Sn("firestore",((r,{instanceIdentifier:s,options:i})=>{const a=r.getProvider("app").getImmediate(),c=new zr(new Tv(r.getProvider("auth-internal")),new Av(a,r.getProvider("app-check-internal")),(function(h,d){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new U(D.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new $s(h.options.projectId,d)})(a,s),a);return i={useFetchStreams:t,...i},c._setSettings(i),c}),"PUBLIC").setMultipleInstances(!0)),Pt(zl,Hl,e),Pt(zl,Hl,"esm2020")})();function Up(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const xw=Up,Bp=new Qs("auth","Firebase",Up());const no=new Sc("@firebase/auth");function Fw(n,...e){no.logLevel<=Q.WARN&&no.warn(`Auth (${Yr}): ${n}`,...e)}function Oi(n,...e){no.logLevel<=Q.ERROR&&no.error(`Auth (${Yr}): ${n}`,...e)}function xt(n,...e){throw uu(n,...e)}function dt(n,...e){return uu(n,...e)}function cu(n,e,t){const r={...xw(),[e]:t};return new Qs("auth","Firebase",r).create(e,{appName:n.name})}function Qn(n){return cu(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Uw(n,e,t){const r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&xt(n,"argument-error"),cu(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function uu(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return Bp.create(n,...e)}function q(n,e,...t){if(!n)throw uu(e,...t)}function Kt(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Oi(e),new Error(e)}function tn(n,e){n||Kt(e)}function uc(){return typeof self<"u"&&self.location?.href||""}function Bw(){return $h()==="http:"||$h()==="https:"}function $h(){return typeof self<"u"&&self.location?.protocol||null}function $w(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Bw()||X_()||"connection"in navigator)?navigator.onLine:!0}function jw(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class ni{constructor(e,t){this.shortDelay=e,this.longDelay=t,tn(t>e,"Short delay should be less than long delay!"),this.isMobile=G_()||J_()}get(){return $w()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function lu(n,e){tn(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class $p{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Kt("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Kt("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Kt("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const qw={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const zw=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Hw=new ni(3e4,6e4);function hu(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function rs(n,e,t,r,s={}){return jp(n,s,async()=>{let i={},a={};r&&(e==="GET"?a=r:i={body:JSON.stringify(r)});const c=Xs({key:n.config.apiKey,...a}).slice(1),l=await n._getAdditionalHeaders();l["Content-Type"]="application/json",n.languageCode&&(l["X-Firebase-Locale"]=n.languageCode);const h={method:e,headers:l,...i};return Q_()||(h.referrerPolicy="no-referrer"),n.emulatorConfig&&Vn(n.emulatorConfig.host)&&(h.credentials="include"),$p.fetch()(await qp(n,n.config.apiHost,t,c),h)})}async function jp(n,e,t){n._canInitEmulator=!1;const r={...qw,...e};try{const s=new Gw(n),i=await Promise.race([t(),s.promise]);s.clearNetworkTimeout();const a=await i.json();if("needConfirmation"in a)throw Si(n,"account-exists-with-different-credential",a);if(i.ok&&!("errorMessage"in a))return a;{const c=i.ok?a.errorMessage:a.error.message,[l,h]=c.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Si(n,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw Si(n,"email-already-in-use",a);if(l==="USER_DISABLED")throw Si(n,"user-disabled",a);const d=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw cu(n,d,h);xt(n,d)}}catch(s){if(s instanceof $t)throw s;xt(n,"network-request-failed",{message:String(s)})}}async function Ww(n,e,t,r,s={}){const i=await rs(n,e,t,r,s);return"mfaPendingCredential"in i&&xt(n,"multi-factor-auth-required",{_serverResponse:i}),i}async function qp(n,e,t,r){const s=`${e}${t}?${r}`,i=n,a=i.config.emulator?lu(n.config,s):`${n.config.apiScheme}://${s}`;return zw.includes(t)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(a).toString():a}class Gw{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(dt(this.auth,"network-request-failed")),Hw.get())})}}function Si(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const s=dt(n,e,r);return s.customData._tokenResponse=t,s}async function Kw(n,e){return rs(n,"POST","/v1/accounts:delete",e)}async function ro(n,e){return rs(n,"POST","/v1/accounts:lookup",e)}function Os(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Qw(n,e=!1){const t=ve(n),r=await t.getIdToken(e),s=fu(r);q(s&&s.exp&&s.auth_time&&s.iat,t.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,a=i?.sign_in_provider;return{claims:s,token:r,authTime:Os(Pa(s.auth_time)),issuedAtTime:Os(Pa(s.iat)),expirationTime:Os(Pa(s.exp)),signInProvider:a||null,signInSecondFactor:i?.sign_in_second_factor||null}}function Pa(n){return Number(n)*1e3}function fu(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Oi("JWT malformed, contained fewer than 3 sections"),null;try{const s=td(t);return s?JSON.parse(s):(Oi("Failed to decode base64 JWT payload"),null)}catch(s){return Oi("Caught error parsing JWT payload as JSON",s?.toString()),null}}function jh(n){const e=fu(n);return q(e,"internal-error"),q(typeof e.exp<"u","internal-error"),q(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Hs(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof $t&&Xw(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function Xw({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class Jw{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class lc{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Os(this.lastLoginAt),this.creationTime=Os(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function so(n){const e=n.auth,t=await n.getIdToken(),r=await Hs(n,ro(e,{idToken:t}));q(r?.users.length,e,"internal-error");const s=r.users[0];n._notifyReloadListener(s);const i=s.providerUserInfo?.length?zp(s.providerUserInfo):[],a=Zw(n.providerData,i),c=n.isAnonymous,l=!(n.email&&s.passwordHash)&&!a?.length,h=c?l:!1,d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new lc(s.createdAt,s.lastLoginAt),isAnonymous:h};Object.assign(n,d)}async function Yw(n){const e=ve(n);await so(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Zw(n,e){return[...n.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function zp(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function eI(n,e){const t=await jp(n,{},async()=>{const r=Xs({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=n.config,a=await qp(n,s,"/v1/token",`key=${i}`),c=await n._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:c,body:r};return n.emulatorConfig&&Vn(n.emulatorConfig.host)&&(l.credentials="include"),$p.fetch()(a,l)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function tI(n,e){return rs(n,"POST","/v2/accounts:revokeToken",hu(n,e))}class kr{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){q(e.idToken,"internal-error"),q(typeof e.idToken<"u","internal-error"),q(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):jh(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){q(e.length!==0,"internal-error");const t=jh(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(q(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:s,expiresIn:i}=await eI(e,t);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:s,expirationTime:i}=t,a=new kr;return r&&(q(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),s&&(q(typeof s=="string","internal-error",{appName:e}),a.accessToken=s),i&&(q(typeof i=="number","internal-error",{appName:e}),a.expirationTime=i),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new kr,this.toJSON())}_performRefresh(){return Kt("not implemented")}}function fn(n,e){q(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class lt{constructor({uid:e,auth:t,stsTokenManager:r,...s}){this.providerId="firebase",this.proactiveRefresh=new Jw(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new lc(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await Hs(this,this.stsTokenManager.getToken(this.auth,e));return q(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return Qw(this,e)}reload(){return Yw(this)}_assign(e){this!==e&&(q(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new lt({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){q(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await so(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(st(this.auth.app))return Promise.reject(Qn(this.auth));const e=await this.getIdToken();return await Hs(this,Kw(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const r=t.displayName??void 0,s=t.email??void 0,i=t.phoneNumber??void 0,a=t.photoURL??void 0,c=t.tenantId??void 0,l=t._redirectEventId??void 0,h=t.createdAt??void 0,d=t.lastLoginAt??void 0,{uid:g,emailVerified:m,isAnonymous:T,providerData:S,stsTokenManager:P}=t;q(g&&P,e,"internal-error");const C=kr.fromJSON(this.name,P);q(typeof g=="string",e,"internal-error"),fn(r,e.name),fn(s,e.name),q(typeof m=="boolean",e,"internal-error"),q(typeof T=="boolean",e,"internal-error"),fn(i,e.name),fn(a,e.name),fn(c,e.name),fn(l,e.name),fn(h,e.name),fn(d,e.name);const L=new lt({uid:g,auth:e,email:s,emailVerified:m,displayName:r,isAnonymous:T,photoURL:a,phoneNumber:i,tenantId:c,stsTokenManager:C,createdAt:h,lastLoginAt:d});return S&&Array.isArray(S)&&(L.providerData=S.map(V=>({...V}))),l&&(L._redirectEventId=l),L}static async _fromIdTokenResponse(e,t,r=!1){const s=new kr;s.updateFromServerResponse(t);const i=new lt({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await so(i),i}static async _fromGetAccountInfoResponse(e,t,r){const s=t.users[0];q(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?zp(s.providerUserInfo):[],a=!(s.email&&s.passwordHash)&&!i?.length,c=new kr;c.updateFromIdToken(r);const l=new lt({uid:s.localId,auth:e,stsTokenManager:c,isAnonymous:a}),h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new lc(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!i?.length};return Object.assign(l,h),l}}const qh=new Map;function Qt(n){tn(n instanceof Function,"Expected a class definition");let e=qh.get(n);return e?(tn(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,qh.set(n,e),e)}class Hp{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Hp.type="NONE";const zh=Hp;function Mi(n,e,t){return`firebase:${n}:${e}:${t}`}class Nr{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=Mi(this.userKey,s.apiKey,i),this.fullPersistenceKey=Mi("persistence",s.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await ro(this.auth,{idToken:e}).catch(()=>{});return t?lt._fromGetAccountInfoResponse(this.auth,t,e):null}return lt._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new Nr(Qt(zh),e,r);const s=(await Promise.all(t.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let i=s[0]||Qt(zh);const a=Mi(r,e.config.apiKey,e.name);let c=null;for(const h of t)try{const d=await h._get(a);if(d){let g;if(typeof d=="string"){const m=await ro(e,{idToken:d}).catch(()=>{});if(!m)break;g=await lt._fromGetAccountInfoResponse(e,m,d)}else g=lt._fromJSON(e,d);h!==i&&(c=g),i=h;break}}catch{}const l=s.filter(h=>h._shouldAllowMigration);return!i._shouldAllowMigration||!l.length?new Nr(i,e,r):(i=l[0],c&&await i._set(a,c.toJSON()),await Promise.all(t.map(async h=>{if(h!==i)try{await h._remove(a)}catch{}})),new Nr(i,e,r))}}function Hh(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Qp(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Wp(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Jp(e))return"Blackberry";if(Yp(e))return"Webos";if(Gp(e))return"Safari";if((e.includes("chrome/")||Kp(e))&&!e.includes("edge/"))return"Chrome";if(Xp(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function Wp(n=Ue()){return/firefox\//i.test(n)}function Gp(n=Ue()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Kp(n=Ue()){return/crios\//i.test(n)}function Qp(n=Ue()){return/iemobile/i.test(n)}function Xp(n=Ue()){return/android/i.test(n)}function Jp(n=Ue()){return/blackberry/i.test(n)}function Yp(n=Ue()){return/webos/i.test(n)}function du(n=Ue()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function nI(n=Ue()){return du(n)&&!!window.navigator?.standalone}function rI(){return Y_()&&document.documentMode===10}function Zp(n=Ue()){return du(n)||Xp(n)||Yp(n)||Jp(n)||/windows phone/i.test(n)||Qp(n)}function em(n,e=[]){let t;switch(n){case"Browser":t=Hh(Ue());break;case"Worker":t=`${Hh(Ue())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Yr}/${r}`}class sI{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=i=>new Promise((a,c)=>{try{const l=e(i);a(l)}catch(l){c(l)}});r.onAbort=t,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const s of t)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}}async function iI(n,e={}){return rs(n,"GET","/v2/passwordPolicy",hu(n,e))}const oI=6;class aI{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??oI,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),s&&(t.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}class cI{constructor(e,t,r,s){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Wh(this),this.idTokenSubscription=new Wh(this),this.beforeStateQueue=new sI(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Bp,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Qt(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Nr.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await ro(this,{idToken:e}),r=await lt._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(st(this.app)){const i=this.app.settings.authIdToken;return i?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(i).then(a,a))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let r=t,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const i=this.redirectUser?._redirectEventId,a=r?._redirectEventId,c=await this.tryRedirectSignIn(e);(!i||i===a)&&c?.user&&(r=c.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(i){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(i))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return q(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await so(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=jw()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(st(this.app))return Promise.reject(Qn(this));const t=e?ve(e):null;return t&&q(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&q(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return st(this.app)?Promise.reject(Qn(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return st(this.app)?Promise.reject(Qn(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Qt(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await iI(this),t=new aI(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Qs("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await tI(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Qt(e)||this._popupRedirectResolver;q(t,this,"argument-error"),this.redirectPersistenceManager=await Nr.create(this,[Qt(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,s){if(this._deleted)return()=>{};const i=typeof t=="function"?t:t.next.bind(t);let a=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(q(c,this,"internal-error"),c.then(()=>{a||i(this.currentUser)}),typeof t=="function"){const l=e.addObserver(t,r,s);return()=>{a=!0,l()}}else{const l=e.addObserver(t);return()=>{a=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return q(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=em(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(st(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&Fw(`Error while retrieving App Check token: ${e.error}`),e?.token}}function zo(n){return ve(n)}class Wh{constructor(e){this.auth=e,this.observer=null,this.addObserver=oy(t=>this.observer=t)}get next(){return q(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let pu={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function uI(n){pu=n}function lI(n){return pu.loadJS(n)}function hI(){return pu.gapiScript}function fI(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function dI(n,e){const t=So(n,"auth");if(t.isInitialized()){const s=t.getImmediate(),i=t.getOptions();if(er(i,e??{}))return s;xt(s,"already-initialized")}return t.initialize({options:e})}function pI(n,e){const t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(Qt);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function mI(n,e,t){const r=zo(n);q(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=tm(e),{host:a,port:c}=gI(e),l=c===null?"":`:${c}`,h={url:`${i}//${a}${l}/`},d=Object.freeze({host:a,port:c,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){q(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),q(er(h,r.config.emulator)&&er(d,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=h,r.emulatorConfig=d,r.settings.appVerificationDisabledForTesting=!0,Vn(a)?(Ac(`${i}//${a}${l}`),bc("Auth",!0)):_I()}function tm(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function gI(n){const e=tm(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:Gh(r.substr(i.length+1))}}else{const[i,a]=r.split(":");return{host:i,port:Gh(a)}}}function Gh(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function _I(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class nm{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Kt("not implemented")}_getIdTokenResponse(e){return Kt("not implemented")}_linkToIdToken(e,t){return Kt("not implemented")}_getReauthenticationResolver(e){return Kt("not implemented")}}async function Dr(n,e){return Ww(n,"POST","/v1/accounts:signInWithIdp",hu(n,e))}const yI="http://localhost";class sr extends nm{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new sr(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):xt("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,...i}=t;if(!r||!s)return null;const a=new sr(r,s);return a.idToken=i.idToken||void 0,a.accessToken=i.accessToken||void 0,a.secret=i.secret,a.nonce=i.nonce,a.pendingToken=i.pendingToken||null,a}_getIdTokenResponse(e){const t=this.buildRequest();return Dr(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,Dr(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Dr(e,t)}buildRequest(){const e={requestUri:yI,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Xs(t)}return e}}class mu{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class ri extends mu{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class dn extends ri{constructor(){super("facebook.com")}static credential(e){return sr._fromParams({providerId:dn.PROVIDER_ID,signInMethod:dn.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return dn.credentialFromTaggedObject(e)}static credentialFromError(e){return dn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return dn.credential(e.oauthAccessToken)}catch{return null}}}dn.FACEBOOK_SIGN_IN_METHOD="facebook.com";dn.PROVIDER_ID="facebook.com";class Gt extends ri{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return sr._fromParams({providerId:Gt.PROVIDER_ID,signInMethod:Gt.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Gt.credentialFromTaggedObject(e)}static credentialFromError(e){return Gt.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return Gt.credential(t,r)}catch{return null}}}Gt.GOOGLE_SIGN_IN_METHOD="google.com";Gt.PROVIDER_ID="google.com";class pn extends ri{constructor(){super("github.com")}static credential(e){return sr._fromParams({providerId:pn.PROVIDER_ID,signInMethod:pn.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return pn.credentialFromTaggedObject(e)}static credentialFromError(e){return pn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return pn.credential(e.oauthAccessToken)}catch{return null}}}pn.GITHUB_SIGN_IN_METHOD="github.com";pn.PROVIDER_ID="github.com";class mn extends ri{constructor(){super("twitter.com")}static credential(e,t){return sr._fromParams({providerId:mn.PROVIDER_ID,signInMethod:mn.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return mn.credentialFromTaggedObject(e)}static credentialFromError(e){return mn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return mn.credential(t,r)}catch{return null}}}mn.TWITTER_SIGN_IN_METHOD="twitter.com";mn.PROVIDER_ID="twitter.com";class Hr{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,s=!1){const i=await lt._fromIdTokenResponse(e,r,s),a=Kh(r);return new Hr({user:i,providerId:a,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const s=Kh(r);return new Hr({user:e,providerId:s,_tokenResponse:r,operationType:t})}}function Kh(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class io extends $t{constructor(e,t,r,s){super(t.code,t.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,io.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,s){return new io(e,t,r,s)}}function rm(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?io._fromErrorAndOperation(n,i,e,r):i})}async function vI(n,e,t=!1){const r=await Hs(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Hr._forOperation(n,"link",r)}async function EI(n,e,t=!1){const{auth:r}=n;if(st(r.app))return Promise.reject(Qn(r));const s="reauthenticate";try{const i=await Hs(n,rm(r,s,e,n),t);q(i.idToken,r,"internal-error");const a=fu(i.idToken);q(a,r,"internal-error");const{sub:c}=a;return q(n.uid===c,r,"user-mismatch"),Hr._forOperation(n,s,i)}catch(i){throw i?.code==="auth/user-not-found"&&xt(r,"user-mismatch"),i}}async function TI(n,e,t=!1){if(st(n.app))return Promise.reject(Qn(n));const r="signIn",s=await rm(n,r,e),i=await Hr._fromIdTokenResponse(n,r,s);return t||await n._updateCurrentUser(i.user),i}function wI(n,e,t,r){return ve(n).onIdTokenChanged(e,t,r)}function II(n,e,t){return ve(n).beforeAuthStateChanged(e,t)}function AI(n,e,t,r){return ve(n).onAuthStateChanged(e,t,r)}function bI(n){return ve(n).signOut()}const oo="__sak";class sm{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(oo,"1"),this.storage.removeItem(oo),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const SI=1e3,RI=10;class im extends sm{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Zp(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),s=this.localCache[t];r!==s&&e(t,s,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((a,c,l)=>{this.notifyListeners(a,l)});return}const r=e.key;t?this.detachListener():this.stopPolling();const s=()=>{const a=this.storage.getItem(r);!t&&this.localCache[r]===a||this.notifyListeners(r,a)},i=this.storage.getItem(r);rI()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,RI):s()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},SI)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}im.type="LOCAL";const PI=im;class om extends sm{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}om.type="SESSION";const am=om;function CI(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class Ho{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(s=>s.isListeningto(e));if(t)return t;const r=new Ho(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:s,data:i}=t.data,a=this.handlersMap[s];if(!a?.size)return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const c=Array.from(a).map(async h=>h(t.origin,i)),l=await CI(c);t.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:l})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Ho.receivers=[];function gu(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}class kI{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,a;return new Promise((c,l)=>{const h=gu("",20);s.port1.start();const d=setTimeout(()=>{l(new Error("unsupported_event"))},r);a={messageChannel:s,onMessage(g){const m=g;if(m.data.eventId===h)switch(m.data.status){case"ack":clearTimeout(d),i=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),c(m.data.response);break;default:clearTimeout(d),clearTimeout(i),l(new Error("invalid_response"));break}}},this.handlers.add(a),s.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:h,data:t},[s.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}function Vt(){return window}function NI(n){Vt().location.href=n}function cm(){return typeof Vt().WorkerGlobalScope<"u"&&typeof Vt().importScripts=="function"}async function DI(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function VI(){return navigator?.serviceWorker?.controller||null}function OI(){return cm()?self:null}const um="firebaseLocalStorageDb",MI=1,ao="firebaseLocalStorage",lm="fbase_key";class si{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Wo(n,e){return n.transaction([ao],e?"readwrite":"readonly").objectStore(ao)}function LI(){const n=indexedDB.deleteDatabase(um);return new si(n).toPromise()}function hc(){const n=indexedDB.open(um,MI);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(ao,{keyPath:lm})}catch(s){t(s)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(ao)?e(r):(r.close(),await LI(),e(await hc()))})})}async function Qh(n,e,t){const r=Wo(n,!0).put({[lm]:e,value:t});return new si(r).toPromise()}async function xI(n,e){const t=Wo(n,!1).get(e),r=await new si(t).toPromise();return r===void 0?null:r.value}function Xh(n,e){const t=Wo(n,!0).delete(e);return new si(t).toPromise()}const FI=800,UI=3;class hm{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await hc(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>UI)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return cm()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Ho._getInstance(OI()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await DI(),!this.activeServiceWorker)return;this.sender=new kI(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||VI()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await hc();return await Qh(e,oo,"1"),await Xh(e,oo),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>Qh(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>xI(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Xh(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=Wo(s,!1).getAll();return new si(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),t.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),t.push(s));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),FI)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}hm.type="LOCAL";const BI=hm;new ni(3e4,6e4);function fm(n,e){return e?Qt(e):(q(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class _u extends nm{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Dr(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Dr(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Dr(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function $I(n){return TI(n.auth,new _u(n),n.bypassAuthState)}function jI(n){const{auth:e,user:t}=n;return q(t,e,"internal-error"),EI(t,new _u(n),n.bypassAuthState)}async function qI(n){const{auth:e,user:t}=n;return q(t,e,"internal-error"),vI(t,new _u(n),n.bypassAuthState)}class dm{constructor(e,t,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:s,tenantId:i,error:a,type:c}=e;if(a){this.reject(a);return}const l={auth:this.auth,requestUri:t,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(l))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return $I;case"linkViaPopup":case"linkViaRedirect":return qI;case"reauthViaPopup":case"reauthViaRedirect":return jI;default:xt(this.auth,"internal-error")}}resolve(e){tn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){tn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const zI=new ni(2e3,1e4);async function HI(n,e,t){if(st(n.app))return Promise.reject(dt(n,"operation-not-supported-in-this-environment"));const r=zo(n);Uw(n,e,mu);const s=fm(r,t);return new zn(r,"signInViaPopup",e,s).executeNotNull()}class zn extends dm{constructor(e,t,r,s,i){super(e,t,s,i),this.provider=r,this.authWindow=null,this.pollId=null,zn.currentPopupAction&&zn.currentPopupAction.cancel(),zn.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return q(e,this.auth,"internal-error"),e}async onExecution(){tn(this.filter.length===1,"Popup operations only handle one event");const e=gu();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(dt(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(dt(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,zn.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(dt(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,zI.get())};e()}}zn.currentPopupAction=null;const WI="pendingRedirect",Li=new Map;class GI extends dm{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=Li.get(this.auth._key());if(!e){try{const r=await KI(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Li.set(this.auth._key(),e)}return this.bypassAuthState||Li.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function KI(n,e){const t=JI(e),r=XI(n);if(!await r._isAvailable())return!1;const s=await r._get(t)==="true";return await r._remove(t),s}function QI(n,e){Li.set(n._key(),e)}function XI(n){return Qt(n._redirectPersistence)}function JI(n){return Mi(WI,n.config.apiKey,n.name)}async function YI(n,e,t=!1){if(st(n.app))return Promise.reject(Qn(n));const r=zo(n),s=fm(r,e),a=await new GI(r,s,t).execute();return a&&!t&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,e)),a}const ZI=600*1e3;class eA{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!tA(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!pm(e)){const r=e.error.code?.split("auth/")[1]||"internal-error";t.onError(dt(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=ZI&&this.cachedEventUids.clear(),this.cachedEventUids.has(Jh(e))}saveEventToCache(e){this.cachedEventUids.add(Jh(e)),this.lastProcessedEventTime=Date.now()}}function Jh(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function pm({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function tA(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return pm(n);default:return!1}}async function nA(n,e={}){return rs(n,"GET","/v1/projects",e)}const rA=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,sA=/^https?/;async function iA(n){if(n.config.emulator)return;const{authorizedDomains:e}=await nA(n);for(const t of e)try{if(oA(t))return}catch{}xt(n,"unauthorized-domain")}function oA(n){const e=uc(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const a=new URL(n);return a.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&a.hostname===r}if(!sA.test(t))return!1;if(rA.test(n))return r===n;const s=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}const aA=new ni(3e4,6e4);function Yh(){const n=Vt().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function cA(n){return new Promise((e,t)=>{function r(){Yh(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Yh(),t(dt(n,"network-request-failed"))},timeout:aA.get()})}if(Vt().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Vt().gapi?.load)r();else{const s=fI("iframefcb");return Vt()[s]=()=>{gapi.load?r():t(dt(n,"network-request-failed"))},lI(`${hI()}?onload=${s}`).catch(i=>t(i))}}).catch(e=>{throw xi=null,e})}let xi=null;function uA(n){return xi=xi||cA(n),xi}const lA=new ni(5e3,15e3),hA="__/auth/iframe",fA="emulator/auth/iframe",dA={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},pA=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function mA(n){const e=n.config;q(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?lu(e,fA):`https://${n.config.authDomain}/${hA}`,r={apiKey:e.apiKey,appName:n.name,v:Yr},s=pA.get(n.config.apiHost);s&&(r.eid=s);const i=n._getFrameworks();return i.length&&(r.fw=i.join(",")),`${t}?${Xs(r).slice(1)}`}async function gA(n){const e=await uA(n),t=Vt().gapi;return q(t,n,"internal-error"),e.open({where:document.body,url:mA(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:dA,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const a=dt(n,"network-request-failed"),c=Vt().setTimeout(()=>{i(a)},lA.get());function l(){Vt().clearTimeout(c),s(r)}r.ping(l).then(l,()=>{i(a)})}))}const _A={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},yA=500,vA=600,EA="_blank",TA="http://localhost";class Zh{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function wA(n,e,t,r=yA,s=vA){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let c="";const l={..._A,width:r.toString(),height:s.toString(),top:i,left:a},h=Ue().toLowerCase();t&&(c=Kp(h)?EA:t),Wp(h)&&(e=e||TA,l.scrollbars="yes");const d=Object.entries(l).reduce((m,[T,S])=>`${m}${T}=${S},`,"");if(nI(h)&&c!=="_self")return IA(e||"",c),new Zh(null);const g=window.open(e||"",c,d);q(g,n,"popup-blocked");try{g.focus()}catch{}return new Zh(g)}function IA(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}const AA="__/auth/handler",bA="emulator/auth/handler",SA=encodeURIComponent("fac");async function ef(n,e,t,r,s,i){q(n.config.authDomain,n,"auth-domain-config-required"),q(n.config.apiKey,n,"invalid-api-key");const a={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Yr,eventId:s};if(e instanceof mu){e.setDefaultLanguage(n.languageCode),a.providerId=e.providerId||"",iy(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,g]of Object.entries({}))a[d]=g}if(e instanceof ri){const d=e.getScopes().filter(g=>g!=="");d.length>0&&(a.scopes=d.join(","))}n.tenantId&&(a.tid=n.tenantId);const c=a;for(const d of Object.keys(c))c[d]===void 0&&delete c[d];const l=await n._getAppCheckToken(),h=l?`#${SA}=${encodeURIComponent(l)}`:"";return`${RA(n)}?${Xs(c).slice(1)}${h}`}function RA({config:n}){return n.emulator?lu(n,bA):`https://${n.authDomain}/${AA}`}const Ca="webStorageSupport";class PA{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=am,this._completeRedirectFn=YI,this._overrideRedirectResult=QI}async _openPopup(e,t,r,s){tn(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const i=await ef(e,t,r,uc(),s);return wA(e,i,gu())}async _openRedirect(e,t,r,s){await this._originValidation(e);const i=await ef(e,t,r,uc(),s);return NI(i),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:s,promise:i}=this.eventManagers[t];return s?Promise.resolve(s):(tn(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await gA(e),r=new eA(e);return t.register("authEvent",s=>(q(s?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Ca,{type:Ca},s=>{const i=s?.[0]?.[Ca];i!==void 0&&t(!!i),xt(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=iA(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Zp()||Gp()||du()}}const CA=PA;var tf="@firebase/auth",nf="1.11.1";class kA{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){q(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function NA(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function DA(n){tr(new Sn("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:a,authDomain:c}=r.options;q(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:a,authDomain:c,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:em(n)},h=new cI(r,s,i,l);return pI(h,t),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),tr(new Sn("auth-internal",e=>{const t=zo(e.getProvider("auth").getImmediate());return(r=>new kA(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Pt(tf,nf,NA(n)),Pt(tf,nf,"esm2020")}const VA=300,OA=id("authIdTokenMaxAge")||VA;let rf=null;const MA=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>OA)return;const s=t?.token;rf!==s&&(rf=s,await fetch(n,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function LA(n=Pc()){const e=So(n,"auth");if(e.isInitialized())return e.getImmediate();const t=dI(n,{popupRedirectResolver:CA,persistence:[BI,PI,am]}),r=id("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const a=MA(i.toString());II(t,a,()=>a(t.currentUser)),wI(t,c=>a(c))}}const s=nd("auth");return s&&mI(t,`http://${s}`),t}function xA(){return document.getElementsByTagName("head")?.[0]??document}uI({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=s=>{const i=dt("internal-error");i.customData=s,t(i)},r.type="text/javascript",r.charset="UTF-8",xA().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});DA("Browser");const FA={apiKey:"AIzaSyBC5VHNEcVL9KP8M0d64ZajF6P4Hzqzafc",authDomain:"bbnme-58716.firebaseapp.com",projectId:"bbnme-58716",storageBucket:"bbnme-58716.appspot.com",messagingSenderId:"155088179379",appId:"1:155088179379:web:5d98445c178b7513f520c6"},yu=cd(FA),co=yw(yu),vu=LA(yu),UA=new Gt,Go=Io(null),mm=Io(!0);AI(vu,n=>{Go.set(n),mm.set(!1)});var BA=pe('<button class="svelte-18sv61c"> </button>');function gm(n,e){let t=Te(e,"label",8,"Button"),r=Te(e,"onClick",8,()=>{});var s=BA(),i=ee(s);mt(()=>wo(i,t())),gt("click",s,function(...a){r()?.apply(this,a)}),fe(n,s)}var $A=pe('<div class="login-container svelte-8ukb9p"><h2 class="svelte-8ukb9p">Please sign in to continue</h2> <!></div>');function jA(n,e){tt(e,!1),ot();var t=$A(),r=oe(ee(t),2);gm(r,{label:"Sign in with Google",onClick:()=>HI(vu,UA)}),fe(n,t),nt()}var qA=pe("<button><img/></button>");function Jt(n,e){tt(e,!1),Ao();let t=Te(e,"iconSrc",8),r=Te(e,"altText",8,"Icon Button"),s=Te(e,"onClick",8,()=>{}),i=Te(e,"size",8,"md"),a=Te(e,"isSpinning",8,!1),c=Te(e,"isInteractive",8,!0),l=Te(e,"hoverEffect",8,!0),h=he();function d(P){c()&&(P.stopPropagation(),s()(P))}St(()=>wc(i()),()=>{switch(i()){case"sm":$(h,"var(--spacing-lg)");break;case"md":$(h,"33px");break;case"lg":$(h,"var(--spacing-xl)");break;case"xl":$(h,"60px");break;default:$(h,"33px");break}}),or(),ot();var g=qA();let m;var T=ee(g);let S;mt(()=>{m=bn(g,1,"icon-button svelte-11linj7",null,m,{interactive:c(),"hover-effect":l()}),Sr(T,"src",t()),Sr(T,"alt",r()),__(T,`width: ${O(h)??""}; height: ${O(h)??""};`),S=bn(T,1,"svelte-11linj7",null,S,{spinning:a()})}),gt("click",g,d),fe(n,g),nt()}function zA(n,e){tt(e,!1);const t=Ao();let r=Te(e,"iconSrc",8,"./assets/hambuger_menu.png"),s=Te(e,"altText",8,"Open Menu");function i(){t("toggle")}ot(),Jt(n,{get iconSrc(){return r()},get altText(){return s()},onClick:i,size:"md",class:"hamburger-icon-button"}),nt()}var HA=pe('<span class="not-authorized-message svelte-rfuq4y">Unauthorized user</span>'),WA=pe(`<nav class="svelte-rfuq4y"><!> <div class="navbar-title svelte-rfuq4y"><img src="./assets/icon.png" alt="App Icon" class="app-icon svelte-rfuq4y"/> <h1 class="svelte-rfuq4y">bb'n'me</h1></div> <div class="user-status svelte-rfuq4y"><!></div></nav>`);function GA(n,e){tt(e,!1);const t=()=>Rt(c,"$isAuthorizedToWriteStore",s),r=()=>Rt(Go,"$user",s),[s,i]=Jr(),a=he(),c=Or("isAuthorizedToWrite");St(()=>t(),()=>{$(a,t())}),or(),ot();var l=WA(),h=ee(l);zA(h,{iconSrc:"./assets/hambuger_menu.png",altText:"Open Menu",$$events:{toggle(T){P_.call(this,e,T)}}});var d=oe(h,4),g=ee(d);{var m=T=>{var S=HA();fe(T,S)};ht(g,T=>{r()&&!O(a)&&T(m)})}fe(n,l),nt(),i()}var KA=pe('<span class="not-authorized-message svelte-12buoxc">Unauthorized user</span>'),QA=pe('<div class="user-profile svelte-12buoxc"><img alt="Profile" class="svelte-12buoxc"/> <span class="svelte-12buoxc"> </span> <!></div> <div class="nav-links-wrapper svelte-12buoxc"><div class="nav-links svelte-12buoxc"><!></div></div> <div class="sidenav-footer svelte-12buoxc"><!></div>',1),XA=pe('<div><button class="close-button svelte-12buoxc">&times;</button> <!></div>');function JA(n,e){tt(e,!1);const t=()=>Rt(h,"$isAuthorizedToWriteStore",s),r=()=>Rt(Go,"$user",s),[s,i]=Jr(),a=he();let c=Te(e,"isOpen",8,!1);const l=Ao(),h=Or("isAuthorizedToWrite");function d(){l("close")}function g(){bI(vu),d()}St(()=>t(),()=>{$(a,t())}),or(),ot();var m=XA();let T;var S=ee(m),P=oe(S,2);{var C=L=>{var V=QA(),N=Lr(V),F=ee(N),W=oe(F,2),K=ee(W),w=oe(W,2);{var _=re=>{var Be=KA();fe(re,Be)};ht(w,re=>{O(a)||re(_)})}var y=oe(N,2),I=ee(y),E=ee(I);Jt(E,{iconSrc:"./assets/home.png",altText:"Home",onClick:d,size:"md"});var A=oe(y,2),v=ee(A);Jt(v,{iconSrc:"./assets/log_out.png",altText:"Sign Out",onClick:g,size:"md"}),mt(()=>{Sr(F,"src",(r(),Pe(()=>r().photoURL))),wo(K,(r(),Pe(()=>r().displayName)))}),fe(L,V)};ht(P,L=>{r()&&L(C)})}mt(()=>T=bn(m,1,"sidenav svelte-12buoxc",null,T,{open:c()})),gt("click",S,d),fe(n,m),nt(),i()}var YA=pe('<form class="svelte-7mtrh0"><h2 class="svelte-7mtrh0">Add a new place</h2> <input type="text" placeholder="Place name" required class="svelte-7mtrh0"/> <input type="url" placeholder="Website" class="svelte-7mtrh0"/> <input type="url" placeholder="Image URL" class="svelte-7mtrh0"/> <!></form>');function ZA(n,e){tt(e,!1);let t=he(""),r=he(""),s=he("");async function i(){try{const g=await Ow(Pp(co,"places"),{name:O(t),website:O(r),image:O(s)});console.log("Document written with ID: ",g.id),$(t,""),$(r,""),$(s,"")}catch(g){console.error("Error adding document: ",g)}}ot();var a=YA(),c=oe(ee(a),2),l=oe(c,2),h=oe(l,2),d=oe(h,2);gm(d,{label:"Add Place",type:"submit"}),Rr(c,()=>O(t),g=>$(t,g)),Rr(l,()=>O(r),g=>$(r,g)),Rr(h,()=>O(s),g=>$(s,g)),gt("submit",a,R_(i)),fe(n,a),nt()}var eb=pe('<div class="card svelte-1udyrqm"><!></div>');function _m(n,e){var t=eb(),r=ee(t);Ic(r,e,"default",{}),fe(n,t)}var tb=pe("<div><!> <!></div>"),nb=pe("<div><!> <!></div>");function rb(n,e){tt(e,!1);const t=()=>Rt(d,"$isAuthorizedToWriteStore",r),[r,s]=Jr(),i=he();let a=Te(e,"place",8),c=Te(e,"isHovered",8,!1);const l=Ao();let h=he(!1);const d=Or("isAuthorizedToWrite");function g(F){F.preventDefault(),F.stopPropagation(),$(h,!O(h))}function m(F){F.preventDefault(),l("edit",a()),$(h,!1)}function T(F){F.preventDefault(),l("delete",a().id),$(h,!1)}function S(F){O(h)&&!F.target.closest(".see-more-menu")&&$(h,!1)}St(()=>t(),()=>{$(i,t())}),St(()=>(wc(c()),O(h)),()=>{!c()&&O(h)&&$(h,!1)}),or(),ot();var P=nb();gt("click",Ui,S);let C;var L=ee(P);Jt(L,{iconSrc:"./assets/see_more.png",altText:"See More Options",onClick:g,size:"md",class:"see-more-icon-button"});var V=oe(L,2);{var N=F=>{var W=tb();let K;var w=ee(W);Jt(w,{iconSrc:"./assets/edit.png",altText:"Edit",onClick:m,size:"sm"});var _=oe(w,2);Jt(_,{iconSrc:"./assets/delete.png",altText:"Delete",onClick:T,size:"sm"}),mt(()=>K=bn(W,1,"floating-actions svelte-1222uzl",null,K,{open:O(h)})),fe(F,W)};ht(V,F=>{O(h)&&O(i)&&F(N)})}mt(()=>C=bn(P,1,"see-more-menu svelte-1222uzl",null,C,{visible:c()})),fe(n,P),nt(),s()}var sb=pe('<form class="svelte-136zmjt"><div class="header-with-actions svelte-136zmjt"><h2 class="svelte-136zmjt">Edit Place</h2> <div class="actions svelte-136zmjt"><!> <!></div></div> <input type="text" placeholder="Place name" required class="svelte-136zmjt"/> <input type="url" placeholder="Website" class="svelte-136zmjt"/> <input type="url" placeholder="Image URL" class="svelte-136zmjt"/></form>');function ib(n,e){tt(e,!1);let t=Te(e,"place",8),r=Te(e,"onSave",8,()=>{}),s=Te(e,"onCancel",8,()=>{}),i=he(t().name),a=he(t().website),c=he(t().image);async function l(V){V.preventDefault();try{const N=nu(co,"places",t().id);await Dw(N,{name:O(i),website:O(a),image:O(c)}),console.log("Document successfully updated!"),r()()}catch(N){console.error("Error updating document: ",N)}}function h(){s()()}ot();var d=sb(),g=ee(d),m=oe(ee(g),2),T=ee(m);Jt(T,{iconSrc:"./assets/save.png",altText:"Save",onClick:l,size:"sm"});var S=oe(T,2);Jt(S,{iconSrc:"./assets/cancel.png",altText:"Cancel",onClick:h,size:"sm"});var P=oe(g,2),C=oe(P,2),L=oe(C,2);Rr(P,()=>O(i),V=>$(i,V)),Rr(C,()=>O(a),V=>$(a,V)),Rr(L,()=>O(c),V=>$(c,V)),gt("submit",d,l),fe(n,d),nt()}var ob=pe('<div class="image-container svelte-13geuu4"><a target="_blank" rel="noreferrer" class="image-wrapper svelte-13geuu4"><img class="svelte-13geuu4"/> <!></a></div>'),ab=pe('<div class="place-header svelte-13geuu4"><h3 class="svelte-13geuu4"><b> </b></h3></div> <!>',1),cb=pe('<div class="places-list-container svelte-13geuu4"><h2 class="svelte-13geuu4">Travel Wishlist</h2> <div class="places-grid svelte-13geuu4"></div></div>');function ub(n,e){tt(e,!1);const t=()=>Rt(a,"$isAuthorizedToWriteStore",r),[r,s]=Jr(),i=he(),a=Or("isAuthorizedToWrite");let c=he([]),l=he(null),h=he(null);N_(()=>{const V=Mw(Pp(co,"places"),N=>{$(c,N.docs.map(F=>({id:F.id,...F.data()})))});return()=>V()});async function d(V){try{await Vw(nu(co,"places",V)),console.log("Document successfully deleted!")}catch(N){console.error("Error removing document: ",N)}}function g(V){$(l,V)}function m(){$(l,null)}function T(){$(l,null)}function S(V){$(h,V)}function P(){$(h,null)}St(()=>t(),()=>{$(i,t())}),or(),ot();var C=cb(),L=oe(ee(C),2);Kf(L,5,()=>O(c),Gf,(V,N)=>{_m(V,{children:(F,W)=>{var K=Wf(),w=Lr(K);{var _=I=>{ib(I,{get place(){return O(l)},onSave:m,onCancel:T})},y=I=>{var E=ab(),A=Lr(E),v=ee(A),re=ee(v),Be=ee(re),ss=oe(A,2);{var is=jt=>{var _t=ob(),qt=ee(_t),rn=ee(qt),lr=oe(rn,2);{var yt=at=>{{let hr=vo(()=>(O(h),O(N),Pe(()=>O(h)===O(N).id)));rb(at,{get place(){return O(N)},get isHovered(){return O(hr)},$$events:{edit:zt=>g(zt.detail),delete:zt=>d(zt.detail)}})}};ht(lr,at=>{O(i)&&at(yt)})}mt(()=>{Sr(qt,"href",(O(N),Pe(()=>O(N).website))),Sr(rn,"src",(O(N),Pe(()=>O(N).image))),Sr(rn,"alt",(O(N),Pe(()=>O(N).name)))}),gt("mouseenter",qt,()=>S(O(N).id)),gt("mouseleave",qt,P),fe(jt,_t)};ht(ss,jt=>{O(N),Pe(()=>O(N).image)&&jt(is)})}mt(()=>wo(Be,(O(N),Pe(()=>O(N).name)))),fe(I,E)};ht(w,I=>{O(l),O(N),Pe(()=>O(l)&&O(l).id===O(N).id)?I(_):I(y,!1)})}fe(F,K)},$$slots:{default:!0}})}),fe(n,C),nt(),s()}const lb=n=>n;function hb(n,{delay:e=0,duration:t=400,easing:r=lb}={}){const s=+getComputedStyle(n).opacity;return{delay:e,duration:t,easing:r,css:i=>`opacity: ${i*s}`}}var fb=pe("<button> </button>"),db=pe('<div class="tabs-container svelte-126ak3w"><div class="tab-headers svelte-126ak3w"></div> <div class="tab-content-wrapper svelte-126ak3w"><!></div></div>');function pb(n,e){tt(e,!1);let t=Te(e,"activeTab",12,0);const r=Io(t());Da("activeTab",r);let s=[],i=he([]);function a(m){return s=[...s,m],$(i,[...O(i),m]),s.length-1}Da("registerTab",a);function c(m){t(m),r.set(t())}ot();var l=db(),h=ee(l);Kf(h,5,()=>O(i),Gf,(m,T,S)=>{var P=fb();let C;var L=ee(P);mt(()=>{C=bn(P,1,"tab-header svelte-126ak3w",null,C,{active:t()===S}),wo(L,O(T))}),gt("click",P,()=>c(S)),fe(m,P)});var d=oe(h,2),g=ee(d);Ic(g,e,"default",{}),fe(n,l),nt()}var mb=pe('<div class="tab-panel svelte-1vjnlah"><!></div>');function sf(n,e){tt(e,!1);const t=()=>Rt(c,"$activeTabStore",r),[r,s]=Jr(),i=he();let a=Te(e,"title",8);const c=Or("activeTab"),l=Or("registerTab");let h=he();$(h,l(a())),St(()=>(t(),O(h)),()=>{$(i,t()===O(h))}),or(),ot();var d=Wf(),g=Lr(d);{var m=T=>{var S=mb(),P=ee(S);Ic(P,e,"default",{}),S_(3,S,()=>hb,()=>({duration:200})),fe(T,S)};ht(g,T=>{O(i)&&T(m)})}fe(n,d),nt(),s()}const gb="type.googleapis.com/google.protobuf.Int64Value",_b="type.googleapis.com/google.protobuf.UInt64Value";function ym(n,e){const t={};for(const r in n)n.hasOwnProperty(r)&&(t[r]=e(n[r]));return t}function uo(n){if(n==null)return null;if(n instanceof Number&&(n=n.valueOf()),typeof n=="number"&&isFinite(n)||n===!0||n===!1||Object.prototype.toString.call(n)==="[object String]")return n;if(n instanceof Date)return n.toISOString();if(Array.isArray(n))return n.map(e=>uo(e));if(typeof n=="function"||typeof n=="object")return ym(n,e=>uo(e));throw new Error("Data cannot be encoded in JSON: "+n)}function Wr(n){if(n==null)return n;if(n["@type"])switch(n["@type"]){case gb:case _b:{const e=Number(n.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+n);return e}default:throw new Error("Data cannot be decoded from JSON: "+n)}return Array.isArray(n)?n.map(e=>Wr(e)):typeof n=="function"||typeof n=="object"?ym(n,e=>Wr(e)):n}const Eu="functions";const of={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ke extends $t{constructor(e,t,r){super(`${Eu}/${e}`,t||""),this.details=r,Object.setPrototypeOf(this,Ke.prototype)}}function yb(n){if(n>=200&&n<300)return"ok";switch(n){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function lo(n,e){let t=yb(n),r=t,s;try{const i=e&&e.error;if(i){const a=i.status;if(typeof a=="string"){if(!of[a])return new Ke("internal","internal");t=of[a],r=a}const c=i.message;typeof c=="string"&&(r=c),s=i.details,s!==void 0&&(s=Wr(s))}}catch{}return t==="ok"?null:new Ke(t,r,s)}class vb{constructor(e,t,r,s){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,st(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=t.getImmediate({optional:!0}),this.messaging=r.getImmediate({optional:!0}),this.auth||t.get().then(i=>this.auth=i,()=>{}),this.messaging||r.get().then(i=>this.messaging=i,()=>{}),this.appCheck||s?.get().then(i=>this.appCheck=i,()=>{})}async getAuthToken(){if(this.auth)try{return(await this.auth.getToken())?.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){const t=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return t.error?null:t.token}return null}async getContext(e){const t=await this.getAuthToken(),r=await this.getMessagingToken(),s=await this.getAppCheckToken(e);return{authToken:t,messagingToken:r,appCheckToken:s}}}const fc="us-central1",Eb=/^data: (.*?)(?:\n|$)/;function Tb(n){let e=null;return{promise:new Promise((t,r)=>{e=setTimeout(()=>{r(new Ke("deadline-exceeded","deadline-exceeded"))},n)}),cancel:()=>{e&&clearTimeout(e)}}}class wb{constructor(e,t,r,s,i=fc,a=(...c)=>fetch(...c)){this.app=e,this.fetchImpl=a,this.emulatorOrigin=null,this.contextProvider=new vb(e,t,r,s),this.cancelAllRequests=new Promise(c=>{this.deleteService=()=>Promise.resolve(c())});try{const c=new URL(i);this.customDomain=c.origin+(c.pathname==="/"?"":c.pathname),this.region=fc}catch{this.customDomain=null,this.region=i}}_delete(){return this.deleteService()}_url(e){const t=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${t}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${t}.cloudfunctions.net/${e}`}}function Ib(n,e,t){const r=Vn(e);n.emulatorOrigin=`http${r?"s":""}://${e}:${t}`,r&&(Ac(n.emulatorOrigin+"/backends"),bc("Functions",!0))}function Ab(n,e,t){const r=s=>Sb(n,e,s,{});return r.stream=(s,i)=>Pb(n,e,s,i),r}function vm(n){return n.emulatorOrigin&&Vn(n.emulatorOrigin)?"include":void 0}async function bb(n,e,t,r,s){t["Content-Type"]="application/json";let i;try{i=await r(n,{method:"POST",body:JSON.stringify(e),headers:t,credentials:vm(s)})}catch{return{status:0,json:null}}let a=null;try{a=await i.json()}catch{}return{status:i.status,json:a}}async function Em(n,e){const t={},r=await n.contextProvider.getContext(e.limitedUseAppCheckTokens);return r.authToken&&(t.Authorization="Bearer "+r.authToken),r.messagingToken&&(t["Firebase-Instance-ID-Token"]=r.messagingToken),r.appCheckToken!==null&&(t["X-Firebase-AppCheck"]=r.appCheckToken),t}function Sb(n,e,t,r){const s=n._url(e);return Rb(n,s,t,r)}async function Rb(n,e,t,r){t=uo(t);const s={data:t},i=await Em(n,r),a=r.timeout||7e4,c=Tb(a),l=await Promise.race([bb(e,s,i,n.fetchImpl,n),c.promise,n.cancelAllRequests]);if(c.cancel(),!l)throw new Ke("cancelled","Firebase Functions instance was deleted.");const h=lo(l.status,l.json);if(h)throw h;if(!l.json)throw new Ke("internal","Response is not valid JSON object.");let d=l.json.data;if(typeof d>"u"&&(d=l.json.result),typeof d>"u")throw new Ke("internal","Response is missing data field.");return{data:Wr(d)}}function Pb(n,e,t,r){const s=n._url(e);return Cb(n,s,t,r||{})}async function Cb(n,e,t,r){t=uo(t);const s={data:t},i=await Em(n,r);i["Content-Type"]="application/json",i.Accept="text/event-stream";let a;try{a=await n.fetchImpl(e,{method:"POST",body:JSON.stringify(s),headers:i,signal:r?.signal,credentials:vm(n)})}catch(m){if(m instanceof Error&&m.name==="AbortError"){const S=new Ke("cancelled","Request was cancelled.");return{data:Promise.reject(S),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(S)}}}}}}const T=lo(0,null);return{data:Promise.reject(T),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(T)}}}}}}let c,l;const h=new Promise((m,T)=>{c=m,l=T});r?.signal?.addEventListener("abort",()=>{const m=new Ke("cancelled","Request was cancelled.");l(m)});const d=a.body.getReader(),g=kb(d,c,l,r?.signal);return{stream:{[Symbol.asyncIterator](){const m=g.getReader();return{async next(){const{value:T,done:S}=await m.read();return{value:T,done:S}},async return(){return await m.cancel(),{done:!0,value:void 0}}}}},data:h}}function kb(n,e,t,r){const s=(a,c)=>{const l=a.match(Eb);if(!l)return;const h=l[1];try{const d=JSON.parse(h);if("result"in d){e(Wr(d.result));return}if("message"in d){c.enqueue(Wr(d.message));return}if("error"in d){const g=lo(0,d);c.error(g),t(g);return}}catch(d){if(d instanceof Ke){c.error(d),t(d);return}}},i=new TextDecoder;return new ReadableStream({start(a){let c="";return l();async function l(){if(r?.aborted){const h=new Ke("cancelled","Request was cancelled");return a.error(h),t(h),Promise.resolve()}try{const{value:h,done:d}=await n.read();if(d){c.trim()&&s(c.trim(),a),a.close();return}if(r?.aborted){const m=new Ke("cancelled","Request was cancelled");a.error(m),t(m),await n.cancel();return}c+=i.decode(h,{stream:!0});const g=c.split(`
`);c=g.pop()||"";for(const m of g)m.trim()&&s(m.trim(),a);return l()}catch(h){const d=h instanceof Ke?h:lo(0,null);a.error(d),t(d)}}},cancel(){return n.cancel()}})}const af="@firebase/functions",cf="0.13.1";const Nb="auth-internal",Db="app-check-internal",Vb="messaging-internal";function Ob(n){const e=(t,{instanceIdentifier:r})=>{const s=t.getProvider("app").getImmediate(),i=t.getProvider(Nb),a=t.getProvider(Vb),c=t.getProvider(Db);return new wb(s,i,a,c,r)};tr(new Sn(Eu,e,"PUBLIC").setMultipleInstances(!0)),Pt(af,cf,n),Pt(af,cf,"esm2020")}function Mb(n=Pc(),e=fc){const r=So(ve(n),Eu).getImmediate({identifier:e}),s=rd("functions");return s&&Lb(r,...s),r}function Lb(n,e,t){Ib(ve(n),e,t)}function xb(n,e,t){return Ab(ve(n),e)}Ob();var Fb=pe("<!> <!>",1),Ub=pe('<!> <!> <div class="container svelte-1n46o8q"><!></div>',1),Bb=pe("<div><!></div>"),$b=pe('<main class="svelte-1n46o8q"><div><!></div> <!></main>');function jb(n,e){tt(e,!1);const t=()=>Rt(mm,"$authLoading",i),r=()=>Rt(Go,"$user",i),s=()=>Rt(d,"$isAuthorizedToWriteStore",i),[i,a]=Jr(),c=he(),l=Mb(yu),h=xb(l,"checkAuthorization"),d=Io(!1);let g=he(!1),m=he(!1),T=he(!0),S=he(!1);Da("isAuthorizedToWrite",d);async function P(){try{const E=await h();d.set(E.data.status==="authorized")}catch(E){console.error("Error checking authorization:",E),d.set(!1)}finally{$(g,!0)}}function C(){$(m,!O(m))}function L(){$(m,!1)}function V(E){E.key==="Escape"&&O(m)&&L()}St(()=>(t(),r()),()=>{!t()&&r()?P():!t()&&!r()?(d.set(!1),$(g,!0)):(d.set(!1),$(g,!1))}),St(()=>(t(),O(g)),()=>{$(c,!t()&&O(g))}),St(()=>(O(c),O(S)),()=>{O(c)&&!O(S)&&setTimeout(()=>{$(T,!1),$(S,!0)},500)}),or(),ot();var N=$b();gt("keydown",Ui,V);var F=ee(N);let W;var K=ee(F);{var w=E=>{var A=Ub(),v=Lr(A);GA(v,{$$events:{toggle:C}});var re=oe(v,2);JA(re,{get isOpen(){return O(m)},$$events:{close:L}});var Be=oe(re,2),ss=ee(Be);pb(ss,{children:(is,jt)=>{var _t=Fb(),qt=Lr(_t);{var rn=yt=>{sf(yt,{title:"Add Place",children:(at,hr)=>{_m(at,{children:(zt,ii)=>{ZA(zt,{})},$$slots:{default:!0}})},$$slots:{default:!0}})};ht(qt,yt=>{O(g)&&s()&&yt(rn)})}var lr=oe(qt,2);sf(lr,{title:"Travel Wishlist",children:(yt,at)=>{ub(yt,{})},$$slots:{default:!0}}),fe(is,_t)},$$slots:{default:!0}}),fe(E,A)},_=E=>{jA(E,{})};ht(K,E=>{r()?E(w):E(_,!1)})}var y=oe(F,2);{var I=E=>{var A=Bb();let v;var re=ee(A);Jt(re,{iconSrc:"./assets/spinner.png",altText:"Loading Spinner",size:"xl",isSpinning:!0,isInteractive:!1}),mt(()=>v=bn(A,1,"loading-screen svelte-1n46o8q",null,v,{"fade-out":O(c)})),fe(E,A)};ht(y,E=>{O(T)&&E(I)})}mt(()=>W=bn(F,1,"main-content-wrapper svelte-1n46o8q",null,W,{visible:!O(T)})),gt("click",F,L),fe(n,N),nt(),a()}u_(jb,{target:document.getElementById("app")});
