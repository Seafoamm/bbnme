(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();const Rh=!1;var bh=Array.isArray,pm=Array.prototype.indexOf,Da=Array.from,Sh=Object.defineProperty,Kn=Object.getOwnPropertyDescriptor,Ph=Object.getOwnPropertyDescriptors,mm=Object.prototype,gm=Array.prototype,Na=Object.getPrototypeOf,ju=Object.isExtensible;const Qn=()=>{};function _m(n){return n()}function Zo(n){for(var e=0;e<n.length;e++)n[e]()}function Ch(){var n,e,t=new Promise((r,s)=>{n=r,e=s});return{promise:t,resolve:n,reject:e}}const De=2,Oa=4,Bi=8,Vt=16,Dt=32,Nn=64,ji=128,rt=512,ke=1024,$e=2048,Nt=4096,Ke=8192,Kt=16384,Ma=32768,sr=65536,qu=1<<17,kh=1<<18,yr=1<<19,Vh=1<<20,as=32768,ea=1<<21,La=1<<22,Qt=1<<23,Xn=Symbol("$state"),ym=Symbol("legacy props"),vm=Symbol(""),Wn=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function Em(n){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function Tm(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function Im(n){throw new Error("https://svelte.dev/e/effect_in_teardown")}function wm(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Am(n){throw new Error("https://svelte.dev/e/effect_orphan")}function Rm(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function bm(n){throw new Error("https://svelte.dev/e/props_invalid_value")}function Sm(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Pm(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Cm(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function km(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const Vm=1,Dm=2,Nm=16,Om=2,Mm=4,Lm=8,xm=1,Fm=2,Se=Symbol(),Um="http://www.w3.org/1999/xhtml";function Bm(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}let jm=!1;function Dh(n){return n===this.v}function Nh(n,e){return n!=n?e==e:n!==e||n!==null&&typeof n=="object"||typeof n=="function"}function Oh(n){return!Nh(n,this.v)}let vr=!1,qm=!1;function $m(){vr=!0}let he=null;function ir(n){he=n}function Er(n,e=!1,t){he={p:he,i:!1,c:null,e:null,s:n,x:null,l:vr&&!e?{s:null,u:null,$:[]}:null}}function Tr(n){var e=he,t=e.e;if(t!==null){e.e=null;for(var r of t)Qh(r)}return e.i=!0,he=e.p,{}}function vs(){return!vr||he!==null&&he.l===null}let yn=[];function Mh(){var n=yn;yn=[],Zo(n)}function qi(n){if(yn.length===0&&!Xr){var e=yn;queueMicrotask(()=>{e===yn&&Mh()})}yn.push(n)}function zm(){for(;yn.length>0;)Mh()}function Lh(n){var e=Y;if(e===null)return X.f|=Qt,n;if((e.f&Ma)===0){if((e.f&ji)===0)throw n;e.b.error(n)}else or(n,e)}function or(n,e){for(;e!==null;){if((e.f&ji)!==0)try{e.b.error(n);return}catch(t){n=t}e=e.parent}throw n}const Qs=new Set;let re=null,ri=null,We=null,ct=[],$i=null,ta=!1,Xr=!1;class ut{committed=!1;current=new Map;previous=new Map;#e=new Set;#t=new Set;#n=0;#r=0;#c=null;#o=[];#a=[];skipped_effects=new Set;is_fork=!1;process(e){ct=[],ri=null,this.apply();var t={parent:null,effect:null,effects:[],render_effects:[],block_effects:[]};for(const r of e)this.#s(r,t);this.is_fork||this.#u(),this.#r>0||this.is_fork?(this.#i(t.effects),this.#i(t.render_effects),this.#i(t.block_effects)):(ri=this,re=null,$u(t.render_effects),$u(t.effects),ri=null,this.#c?.resolve()),We=null}#s(e,t){e.f^=ke;for(var r=e.first;r!==null;){var s=r.f,i=(s&(Dt|Nn))!==0,a=i&&(s&ke)!==0,c=a||(s&Ke)!==0||this.skipped_effects.has(r);if((r.f&ji)!==0&&r.b?.is_pending()&&(t={parent:t,effect:r,effects:[],render_effects:[],block_effects:[]}),!c&&r.fn!==null){i?r.f^=ke:(s&Oa)!==0?t.effects.push(r):Ts(r)&&((r.f&Vt)!==0&&t.block_effects.push(r),ls(r));var l=r.first;if(l!==null){r=l;continue}}var h=r.parent;for(r=r.next;r===null&&h!==null;)h===t.effect&&(this.#i(t.effects),this.#i(t.render_effects),this.#i(t.block_effects),t=t.parent),r=h.next,h=h.parent}}#i(e){for(const t of e)((t.f&$e)!==0?this.#o:this.#a).push(t),Ve(t,ke)}capture(e,t){this.previous.has(e)||this.previous.set(e,t),(e.f&Qt)===0&&(this.current.set(e,e.v),We?.set(e,e.v))}activate(){re=this,this.apply()}deactivate(){re=null,We=null}flush(){if(this.activate(),ct.length>0){if(xh(),re!==null&&re!==this)return}else this.#n===0&&this.process([]);this.deactivate()}discard(){for(const e of this.#t)e(this);this.#t.clear()}#u(){if(this.#r===0){for(const e of this.#e)e();this.#e.clear()}this.#n===0&&this.#l()}#l(){if(Qs.size>1){this.previous.clear();var e=We,t=!0,r={parent:null,effect:null,effects:[],render_effects:[],block_effects:[]};for(const s of Qs){if(s===this){t=!1;continue}const i=[];for(const[c,l]of this.current){if(s.current.has(c))if(t&&l!==s.current.get(c))s.current.set(c,l);else continue;i.push(c)}if(i.length===0)continue;const a=[...s.current.keys()].filter(c=>!this.current.has(c));if(a.length>0){const c=new Set,l=new Map;for(const h of i)Fh(h,a,c,l);if(ct.length>0){re=s,s.apply();for(const h of ct)s.#s(h,r);ct=[],s.deactivate()}}}re=null,We=e}this.committed=!0,Qs.delete(this)}increment(e){this.#n+=1,e&&(this.#r+=1)}decrement(e){this.#n-=1,e&&(this.#r-=1),this.revive()}revive(){for(const e of this.#o)Ve(e,$e),bn(e);for(const e of this.#a)Ve(e,Nt),bn(e);this.#o=[],this.#a=[],this.flush()}oncommit(e){this.#e.add(e)}ondiscard(e){this.#t.add(e)}settled(){return(this.#c??=Ch()).promise}static ensure(){if(re===null){const e=re=new ut;Qs.add(re),Xr||ut.enqueue(()=>{re===e&&e.flush()})}return re}static enqueue(e){qi(e)}apply(){}}function Hm(n){var e=Xr;Xr=!0;try{for(var t;;){if(zm(),ct.length===0&&(re?.flush(),ct.length===0))return $i=null,t;xh()}}finally{Xr=e}}function xh(){var n=Tn;ta=!0;try{var e=0;for(Wu(!0);ct.length>0;){var t=ut.ensure();if(e++>1e3){var r,s;Wm()}t.process(ct),Xt.clear()}}finally{ta=!1,Wu(n),$i=null}}function Wm(){try{Rm()}catch(n){or(n,$i)}}let It=null;function $u(n){var e=n.length;if(e!==0){for(var t=0;t<e;){var r=n[t++];if((r.f&(Kt|Ke))===0&&Ts(r)&&(It=new Set,ls(r),r.deps===null&&r.first===null&&r.nodes_start===null&&(r.teardown===null&&r.ac===null?Zh(r):r.fn=null),It?.size>0)){Xt.clear();for(const s of It){if((s.f&(Kt|Ke))!==0)continue;const i=[s];let a=s.parent;for(;a!==null;)It.has(a)&&(It.delete(a),i.push(a)),a=a.parent;for(let c=i.length-1;c>=0;c--){const l=i[c];(l.f&(Kt|Ke))===0&&ls(l)}}It.clear()}}It=null}}function Fh(n,e,t,r){if(!t.has(n)&&(t.add(n),n.reactions!==null))for(const s of n.reactions){const i=s.f;(i&De)!==0?Fh(s,e,t,r):(i&(La|Vt))!==0&&(i&$e)===0&&Uh(s,e,r)&&(Ve(s,$e),bn(s))}}function Uh(n,e,t){const r=t.get(n);if(r!==void 0)return r;if(n.deps!==null)for(const s of n.deps){if(e.includes(s))return!0;if((s.f&De)!==0&&Uh(s,e,t))return t.set(s,!0),!0}return t.set(n,!1),!1}function bn(n){for(var e=$i=n;e.parent!==null;){e=e.parent;var t=e.f;if(ta&&e===Y&&(t&Vt)!==0&&(t&kh)===0)return;if((t&(Nn|Dt))!==0){if((t&ke)===0)return;e.f^=ke}}ct.push(e)}function Gm(n){let e=0,t=Sn(0),r;return()=>{Hi()&&(z(t),Xh(()=>(e===0&&(r=Is(()=>n(()=>Yr(t)))),e+=1,()=>{qi(()=>{e-=1,e===0&&(r?.(),r=void 0,Yr(t))})})))}}var Km=sr|yr|ji;function Qm(n,e,t){new Xm(n,e,t)}class Xm{parent;#e=!1;#t;#n=null;#r;#c;#o;#a=null;#s=null;#i=null;#u=null;#l=null;#d=0;#h=0;#p=!1;#f=null;#v=Gm(()=>(this.#f=Sn(this.#d),()=>{this.#f=null}));constructor(e,t,r){this.#t=e,this.#r=t,this.#c=r,this.parent=Y.b,this.#e=!!this.#r.pending,this.#o=ja(()=>{Y.b=this;{var s=this.#_();try{this.#a=Je(()=>r(s))}catch(i){this.error(i)}this.#h>0?this.#g():this.#e=!1}return()=>{this.#l?.remove()}},Km)}#E(){try{this.#a=Je(()=>this.#c(this.#t))}catch(e){this.error(e)}this.#e=!1}#T(){const e=this.#r.pending;e&&(this.#s=Je(()=>e(this.#t)),ut.enqueue(()=>{var t=this.#_();this.#a=this.#m(()=>(ut.ensure(),Je(()=>this.#c(t)))),this.#h>0?this.#g():(Yn(this.#s,()=>{this.#s=null}),this.#e=!1)}))}#_(){var e=this.#t;return this.#e&&(this.#l=ar(),this.#t.before(this.#l),e=this.#l),e}is_pending(){return this.#e||!!this.parent&&this.parent.is_pending()}has_pending_snippet(){return!!this.#r.pending}#m(e){var t=Y,r=X,s=he;_t(this.#o),je(this.#o),ir(this.#o.ctx);try{return e()}catch(i){return Lh(i),null}finally{_t(t),je(r),ir(s)}}#g(){const e=this.#r.pending;this.#a!==null&&(this.#u=document.createDocumentFragment(),this.#u.append(this.#l),nf(this.#a,this.#u)),this.#s===null&&(this.#s=Je(()=>e(this.#t)))}#y(e){if(!this.has_pending_snippet()){this.parent&&this.parent.#y(e);return}this.#h+=e,this.#h===0&&(this.#e=!1,this.#s&&Yn(this.#s,()=>{this.#s=null}),this.#u&&(this.#t.before(this.#u),this.#u=null))}update_pending_count(e){this.#y(e),this.#d+=e,this.#f&&cs(this.#f,this.#d)}get_effect_pending(){return this.#v(),z(this.#f)}error(e){var t=this.#r.onerror;let r=this.#r.failed;if(this.#p||!t&&!r)throw e;this.#a&&(xe(this.#a),this.#a=null),this.#s&&(xe(this.#s),this.#s=null),this.#i&&(xe(this.#i),this.#i=null);var s=!1,i=!1;const a=()=>{if(s){Bm();return}s=!0,i&&km(),ut.ensure(),this.#d=0,this.#i!==null&&Yn(this.#i,()=>{this.#i=null}),this.#e=this.has_pending_snippet(),this.#a=this.#m(()=>(this.#p=!1,Je(()=>this.#c(this.#t)))),this.#h>0?this.#g():this.#e=!1};var c=X;try{je(null),i=!0,t?.(e,a),i=!1}catch(l){or(l,this.#o&&this.#o.parent)}finally{je(c)}r&&qi(()=>{this.#i=this.#m(()=>{ut.ensure(),this.#p=!0;try{return Je(()=>{r(this.#t,()=>e,()=>a)})}catch(l){return or(l,this.#o.parent),null}finally{this.#p=!1}})})}}function Ym(n,e,t,r){const s=vs()?xa:Fa;if(t.length===0&&n.length===0){r(e.map(s));return}var i=re,a=Y,c=Jm();function l(){Promise.all(t.map(h=>Zm(h))).then(h=>{c();try{r([...e.map(s),...h])}catch(d){(a.f&Kt)===0&&or(d,a)}i?.deactivate(),mi()}).catch(h=>{or(h,a)})}n.length>0?Promise.all(n).then(()=>{c();try{return l()}finally{i?.deactivate(),mi()}}):l()}function Jm(){var n=Y,e=X,t=he,r=re;return function(i=!0){_t(n),je(e),ir(t),i&&r?.activate()}}function mi(){_t(null),je(null),ir(null)}function xa(n){var e=De|$e,t=X!==null&&(X.f&De)!==0?X:null;return Y!==null&&(Y.f|=yr),{ctx:he,deps:null,effects:null,equals:Dh,f:e,fn:n,reactions:null,rv:0,v:Se,wv:0,parent:t??Y,ac:null}}function Zm(n,e){let t=Y;t===null&&Tm();var r=t.b,s=void 0,i=Sn(Se),a=!X,c=new Map;return ug(()=>{var l=Ch();s=l.promise;try{Promise.resolve(n()).then(l.resolve,l.reject).then(()=>{h===re&&h.committed&&h.deactivate(),mi()})}catch(g){l.reject(g),mi()}var h=re;if(a){var d=!r.is_pending();r.update_pending_count(1),h.increment(d),c.get(h)?.reject(Wn),c.delete(h),c.set(h,l)}const m=(g,w=void 0)=>{if(h.activate(),w)w!==Wn&&(i.f|=Qt,cs(i,w));else{(i.f&Qt)!==0&&(i.f^=Qt),cs(i,g);for(const[S,k]of c){if(c.delete(S),S===h)break;k.reject(Wn)}}a&&(r.update_pending_count(-1),h.decrement(d))};l.promise.then(m,g=>m(null,g||"unknown"))}),Ba(()=>{for(const l of c.values())l.reject(Wn)}),new Promise(l=>{function h(d){function m(){d===s?l(i):h(s)}d.then(m,m)}h(s)})}function Fa(n){const e=xa(n);return e.equals=Oh,e}function Bh(n){var e=n.effects;if(e!==null){n.effects=null;for(var t=0;t<e.length;t+=1)xe(e[t])}}function eg(n){for(var e=n.parent;e!==null;){if((e.f&De)===0)return e;e=e.parent}return null}function Ua(n){var e,t=Y;_t(eg(n));try{n.f&=~as,Bh(n),e=af(n)}finally{_t(t)}return e}function jh(n){var e=Ua(n);if(n.equals(e)||(n.v=e,n.wv=sf()),!On)if(We!==null)Hi()&&We.set(n,n.v);else{var t=(n.f&rt)===0?Nt:ke;Ve(n,t)}}let na=new Set;const Xt=new Map;let qh=!1;function Sn(n,e){var t={f:0,v:n,reactions:null,equals:Dh,rv:0,wv:0};return t}function qt(n,e){const t=Sn(n);return fg(t),t}function ht(n,e=!1,t=!0){const r=Sn(n);return e||(r.equals=Oh),vr&&t&&he!==null&&he.l!==null&&(he.l.s??=[]).push(r),r}function ue(n,e,t=!1){X!==null&&(!lt||(X.f&qu)!==0)&&vs()&&(X.f&(De|Vt|La|qu))!==0&&!bt?.includes(n)&&Cm();let r=t?Gn(e):e;return cs(n,r)}function cs(n,e){if(!n.equals(e)){var t=n.v;On?Xt.set(n,e):Xt.set(n,t),n.v=e;var r=ut.ensure();r.capture(n,t),(n.f&De)!==0&&((n.f&$e)!==0&&Ua(n),Ve(n,(n.f&rt)!==0?ke:Nt)),n.wv=sf(),$h(n,$e),vs()&&Y!==null&&(Y.f&ke)!==0&&(Y.f&(Dt|Nn))===0&&(Xe===null?dg([n]):Xe.push(n)),!r.is_fork&&na.size>0&&!qh&&tg()}return e}function tg(){qh=!1;const n=Array.from(na);for(const e of n)(e.f&ke)!==0&&Ve(e,Nt),Ts(e)&&ls(e);na.clear()}function Yr(n){ue(n,n.v+1)}function $h(n,e){var t=n.reactions;if(t!==null)for(var r=vs(),s=t.length,i=0;i<s;i++){var a=t[i],c=a.f;if(!(!r&&a===Y)){var l=(c&$e)===0;if(l&&Ve(a,e),(c&De)!==0){var h=a;We?.delete(h),(c&as)===0&&(c&rt&&(a.f|=as),$h(h,Nt))}else l&&((c&Vt)!==0&&It!==null&&It.add(a),bn(a))}}}function Gn(n){if(typeof n!="object"||n===null||Xn in n)return n;const e=Na(n);if(e!==mm&&e!==gm)return n;var t=new Map,r=bh(n),s=qt(0),i=In,a=c=>{if(In===i)return c();var l=X,h=In;je(null),Ku(i);var d=c();return je(l),Ku(h),d};return r&&t.set("length",qt(n.length)),new Proxy(n,{defineProperty(c,l,h){(!("value"in h)||h.configurable===!1||h.enumerable===!1||h.writable===!1)&&Sm();var d=t.get(l);return d===void 0?d=a(()=>{var m=qt(h.value);return t.set(l,m),m}):ue(d,h.value,!0),!0},deleteProperty(c,l){var h=t.get(l);if(h===void 0){if(l in c){const d=a(()=>qt(Se));t.set(l,d),Yr(s)}}else ue(h,Se),Yr(s);return!0},get(c,l,h){if(l===Xn)return n;var d=t.get(l),m=l in c;if(d===void 0&&(!m||Kn(c,l)?.writable)&&(d=a(()=>{var w=Gn(m?c[l]:Se),S=qt(w);return S}),t.set(l,d)),d!==void 0){var g=z(d);return g===Se?void 0:g}return Reflect.get(c,l,h)},getOwnPropertyDescriptor(c,l){var h=Reflect.getOwnPropertyDescriptor(c,l);if(h&&"value"in h){var d=t.get(l);d&&(h.value=z(d))}else if(h===void 0){var m=t.get(l),g=m?.v;if(m!==void 0&&g!==Se)return{enumerable:!0,configurable:!0,value:g,writable:!0}}return h},has(c,l){if(l===Xn)return!0;var h=t.get(l),d=h!==void 0&&h.v!==Se||Reflect.has(c,l);if(h!==void 0||Y!==null&&(!d||Kn(c,l)?.writable)){h===void 0&&(h=a(()=>{var g=d?Gn(c[l]):Se,w=qt(g);return w}),t.set(l,h));var m=z(h);if(m===Se)return!1}return d},set(c,l,h,d){var m=t.get(l),g=l in c;if(r&&l==="length")for(var w=h;w<m.v;w+=1){var S=t.get(w+"");S!==void 0?ue(S,Se):w in c&&(S=a(()=>qt(Se)),t.set(w+"",S))}if(m===void 0)(!g||Kn(c,l)?.writable)&&(m=a(()=>qt(void 0)),ue(m,Gn(h)),t.set(l,m));else{g=m.v!==Se;var k=a(()=>Gn(h));ue(m,k)}var P=Reflect.getOwnPropertyDescriptor(c,l);if(P?.set&&P.set.call(d,h),!g){if(r&&typeof l=="string"){var x=t.get("length"),N=Number(l);Number.isInteger(N)&&N>=x.v&&ue(x,N+1)}Yr(s)}return!0},ownKeys(c){z(s);var l=Reflect.ownKeys(c).filter(m=>{var g=t.get(m);return g===void 0||g.v!==Se});for(var[h,d]of t)d.v!==Se&&!(h in c)&&l.push(h);return l},setPrototypeOf(){Pm()}})}var zu,zh,Hh,Wh;function ng(){if(zu===void 0){zu=window,zh=/Firefox/.test(navigator.userAgent);var n=Element.prototype,e=Node.prototype,t=Text.prototype;Hh=Kn(e,"firstChild").get,Wh=Kn(e,"nextSibling").get,ju(n)&&(n.__click=void 0,n.__className=void 0,n.__attributes=null,n.__style=void 0,n.__e=void 0),ju(t)&&(t.__t=void 0)}}function ar(n=""){return document.createTextNode(n)}function gi(n){return Hh.call(n)}function Es(n){return Wh.call(n)}function qe(n,e){return gi(n)}function _i(n,e=!1){{var t=gi(n);return t instanceof Comment&&t.data===""?Es(t):t}}function me(n,e=1,t=!1){let r=n;for(;e--;)r=Es(r);return r}function rg(n){n.textContent=""}function Gh(){return!1}let Hu=!1;function sg(){Hu||(Hu=!0,document.addEventListener("reset",n=>{Promise.resolve().then(()=>{if(!n.defaultPrevented)for(const e of n.target.elements)e.__on_r?.()})},{capture:!0}))}function zi(n){var e=X,t=Y;je(null),_t(null);try{return n()}finally{je(e),_t(t)}}function ig(n,e,t,r=t){n.addEventListener(e,()=>zi(t));const s=n.__on_r;s?n.__on_r=()=>{s(),r(!0)}:n.__on_r=()=>r(!0),sg()}function Kh(n){Y===null&&(X===null&&Am(),wm()),On&&Im()}function og(n,e){var t=e.last;t===null?e.last=e.first=n:(t.next=n,n.prev=t,e.last=n)}function Ot(n,e,t,r=!0){var s=Y;s!==null&&(s.f&Ke)!==0&&(n|=Ke);var i={ctx:he,deps:null,nodes_start:null,nodes_end:null,f:n|$e|rt,first:null,fn:e,last:null,next:null,parent:s,b:s&&s.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(t)try{ls(i),i.f|=Ma}catch(l){throw xe(i),l}else e!==null&&bn(i);if(r){var a=i;if(t&&a.deps===null&&a.teardown===null&&a.nodes_start===null&&a.first===a.last&&(a.f&yr)===0&&(a=a.first,(n&Vt)!==0&&(n&sr)!==0&&a!==null&&(a.f|=sr)),a!==null&&(a.parent=s,s!==null&&og(a,s),X!==null&&(X.f&De)!==0&&(n&Nn)===0)){var c=X;(c.effects??=[]).push(a)}}return i}function Hi(){return X!==null&&!lt}function Ba(n){const e=Ot(Bi,null,!1);return Ve(e,ke),e.teardown=n,e}function ra(n){Kh();var e=Y.f,t=!X&&(e&Dt)!==0&&(e&Ma)===0;if(t){var r=he;(r.e??=[]).push(n)}else return Qh(n)}function Qh(n){return Ot(Oa|Vh,n,!1)}function ag(n){return Kh(),Ot(Bi|Vh,n,!0)}function cg(n){ut.ensure();const e=Ot(Nn|yr,n,!0);return(t={})=>new Promise(r=>{t.outro?Yn(e,()=>{xe(e),r(void 0)}):(xe(e),r(void 0))})}function ug(n){return Ot(La|yr,n,!0)}function Xh(n,e=0){return Ot(Bi|e,n,!0)}function Jr(n,e=[],t=[],r=[],s=!1){Ym(r,e,t,i=>{Ot(s?Oa:Bi,()=>n(...i.map(z)),!0)})}function ja(n,e=0){var t=Ot(Vt|e,n,!0);return t}function Je(n,e=!0){return Ot(Dt|yr,n,!0,e)}function Yh(n){var e=n.teardown;if(e!==null){const t=On,r=X;Gu(!0),je(null);try{e.call(null)}finally{Gu(t),je(r)}}}function Jh(n,e=!1){var t=n.first;for(n.first=n.last=null;t!==null;){const s=t.ac;s!==null&&zi(()=>{s.abort(Wn)});var r=t.next;(t.f&Nn)!==0?t.parent=null:xe(t,e),t=r}}function lg(n){for(var e=n.first;e!==null;){var t=e.next;(e.f&Dt)===0&&xe(e),e=t}}function xe(n,e=!0){var t=!1;(e||(n.f&kh)!==0)&&n.nodes_start!==null&&n.nodes_end!==null&&(hg(n.nodes_start,n.nodes_end),t=!0),Jh(n,e&&!t),yi(n,0),Ve(n,Kt);var r=n.transitions;if(r!==null)for(const i of r)i.stop();Yh(n);var s=n.parent;s!==null&&s.first!==null&&Zh(n),n.next=n.prev=n.teardown=n.ctx=n.deps=n.fn=n.nodes_start=n.nodes_end=n.ac=null}function hg(n,e){for(;n!==null;){var t=n===e?null:Es(n);n.remove(),n=t}}function Zh(n){var e=n.parent,t=n.prev,r=n.next;t!==null&&(t.next=r),r!==null&&(r.prev=t),e!==null&&(e.first===n&&(e.first=r),e.last===n&&(e.last=t))}function Yn(n,e,t=!0){var r=[];qa(n,r,!0),ef(r,()=>{t&&xe(n),e&&e()})}function ef(n,e){var t=n.length;if(t>0){var r=()=>--t||e();for(var s of n)s.out(r)}else e()}function qa(n,e,t){if((n.f&Ke)===0){if(n.f^=Ke,n.transitions!==null)for(const a of n.transitions)(a.is_global||t)&&e.push(a);for(var r=n.first;r!==null;){var s=r.next,i=(r.f&sr)!==0||(r.f&Dt)!==0&&(n.f&Vt)!==0;qa(r,e,i?t:!1),r=s}}}function $a(n){tf(n,!0)}function tf(n,e){if((n.f&Ke)!==0){n.f^=Ke,(n.f&ke)===0&&(Ve(n,$e),bn(n));for(var t=n.first;t!==null;){var r=t.next,s=(t.f&sr)!==0||(t.f&Dt)!==0;tf(t,s?e:!1),t=r}if(n.transitions!==null)for(const i of n.transitions)(i.is_global||e)&&i.in()}}function nf(n,e){for(var t=n.nodes_start,r=n.nodes_end;t!==null;){var s=t===r?null:Es(t);e.append(t),t=s}}let Tn=!1;function Wu(n){Tn=n}let On=!1;function Gu(n){On=n}let X=null,lt=!1;function je(n){X=n}let Y=null;function _t(n){Y=n}let bt=null;function fg(n){X!==null&&(bt===null?bt=[n]:bt.push(n))}let Le=null,He=0,Xe=null;function dg(n){Xe=n}let rf=1,us=0,In=us;function Ku(n){In=n}function sf(){return++rf}function Ts(n){var e=n.f;if((e&$e)!==0)return!0;if(e&De&&(n.f&=~as),(e&Nt)!==0){var t=n.deps;if(t!==null)for(var r=t.length,s=0;s<r;s++){var i=t[s];if(Ts(i)&&jh(i),i.wv>n.wv)return!0}(e&rt)!==0&&We===null&&Ve(n,ke)}return!1}function of(n,e,t=!0){var r=n.reactions;if(r!==null&&!bt?.includes(n))for(var s=0;s<r.length;s++){var i=r[s];(i.f&De)!==0?of(i,e,!1):e===i&&(t?Ve(i,$e):(i.f&ke)!==0&&Ve(i,Nt),bn(i))}}function af(n){var e=Le,t=He,r=Xe,s=X,i=bt,a=he,c=lt,l=In,h=n.f;Le=null,He=0,Xe=null,X=(h&(Dt|Nn))===0?n:null,bt=null,ir(n.ctx),lt=!1,In=++us,n.ac!==null&&(zi(()=>{n.ac.abort(Wn)}),n.ac=null);try{n.f|=ea;var d=n.fn,m=d(),g=n.deps;if(Le!==null){var w;if(yi(n,He),g!==null&&He>0)for(g.length=He+Le.length,w=0;w<Le.length;w++)g[He+w]=Le[w];else n.deps=g=Le;if(Tn&&Hi()&&(n.f&rt)!==0)for(w=He;w<g.length;w++)(g[w].reactions??=[]).push(n)}else g!==null&&He<g.length&&(yi(n,He),g.length=He);if(vs()&&Xe!==null&&!lt&&g!==null&&(n.f&(De|Nt|$e))===0)for(w=0;w<Xe.length;w++)of(Xe[w],n);return s!==null&&s!==n&&(us++,Xe!==null&&(r===null?r=Xe:r.push(...Xe))),(n.f&Qt)!==0&&(n.f^=Qt),m}catch(S){return Lh(S)}finally{n.f^=ea,Le=e,He=t,Xe=r,X=s,bt=i,ir(a),lt=c,In=l}}function pg(n,e){let t=e.reactions;if(t!==null){var r=pm.call(t,n);if(r!==-1){var s=t.length-1;s===0?t=e.reactions=null:(t[r]=t[s],t.pop())}}t===null&&(e.f&De)!==0&&(Le===null||!Le.includes(e))&&(Ve(e,Nt),(e.f&rt)!==0&&(e.f^=rt,e.f&=~as),Bh(e),yi(e,0))}function yi(n,e){var t=n.deps;if(t!==null)for(var r=e;r<t.length;r++)pg(n,t[r])}function ls(n){var e=n.f;if((e&Kt)===0){Ve(n,ke);var t=Y,r=Tn;Y=n,Tn=!0;try{(e&Vt)!==0?lg(n):Jh(n),Yh(n);var s=af(n);n.teardown=typeof s=="function"?s:null,n.wv=rf;var i;Rh&&qm&&(n.f&$e)!==0&&n.deps}finally{Tn=r,Y=t}}}async function mg(){await Promise.resolve(),Hm()}function z(n){var e=n.f,t=(e&De)!==0;if(X!==null&&!lt){var r=Y!==null&&(Y.f&Kt)!==0;if(!r&&!bt?.includes(n)){var s=X.deps;if((X.f&ea)!==0)n.rv<us&&(n.rv=us,Le===null&&s!==null&&s[He]===n?He++:Le===null?Le=[n]:Le.includes(n)||Le.push(n));else{(X.deps??=[]).push(n);var i=n.reactions;i===null?n.reactions=[X]:i.includes(X)||i.push(X)}}}if(On){if(Xt.has(n))return Xt.get(n);if(t){var a=n,c=a.v;return((a.f&ke)===0&&a.reactions!==null||uf(a))&&(c=Ua(a)),Xt.set(a,c),c}}else if(t){if(a=n,We?.has(a))return We.get(a);Ts(a)&&jh(a),Tn&&Hi()&&(a.f&rt)===0&&cf(a)}else if(We?.has(n))return We.get(n);if((n.f&Qt)!==0)throw n.v;return n.v}function cf(n){if(n.deps!==null){n.f^=rt;for(const e of n.deps)(e.reactions??=[]).push(n),(e.f&De)!==0&&(e.f&rt)===0&&cf(e)}}function uf(n){if(n.v===Se)return!0;if(n.deps===null)return!1;for(const e of n.deps)if(Xt.has(e)||(e.f&De)!==0&&uf(e))return!0;return!1}function Is(n){var e=lt;try{return lt=!0,n()}finally{lt=e}}const gg=-7169;function Ve(n,e){n.f=n.f&gg|e}function _g(n){if(!(typeof n!="object"||!n||n instanceof EventTarget)){if(Xn in n)sa(n);else if(!Array.isArray(n))for(let e in n){const t=n[e];typeof t=="object"&&t&&Xn in t&&sa(t)}}}function sa(n,e=new Set){if(typeof n=="object"&&n!==null&&!(n instanceof EventTarget)&&!e.has(n)){e.add(n),n instanceof Date&&n.getTime();for(let r in n)try{sa(n[r],e)}catch{}const t=Na(n);if(t!==Object.prototype&&t!==Array.prototype&&t!==Map.prototype&&t!==Set.prototype&&t!==Date.prototype){const r=Ph(t);for(let s in r){const i=r[s].get;if(i)try{i.call(n)}catch{}}}}}const yg=["touchstart","touchmove"];function vg(n){return yg.includes(n)}const Eg=new Set,Qu=new Set;function Tg(n,e,t,r={}){function s(i){if(r.capture||Hr.call(e,i),!i.cancelBubble)return zi(()=>t?.call(this,i))}return n.startsWith("pointer")||n.startsWith("touch")||n==="wheel"?qi(()=>{e.addEventListener(n,s,r)}):e.addEventListener(n,s,r),s}function za(n,e,t,r,s){var i={capture:r,passive:s},a=Tg(n,e,t,i);(e===document.body||e===window||e===document||e instanceof HTMLMediaElement)&&Ba(()=>{e.removeEventListener(n,a,i)})}let Xu=null;function Hr(n){var e=this,t=e.ownerDocument,r=n.type,s=n.composedPath?.()||[],i=s[0]||n.target;Xu=n;var a=0,c=Xu===n&&n.__root;if(c){var l=s.indexOf(c);if(l!==-1&&(e===document||e===window)){n.__root=e;return}var h=s.indexOf(e);if(h===-1)return;l<=h&&(a=l)}if(i=s[a]||n.target,i!==e){Sh(n,"currentTarget",{configurable:!0,get(){return i||t}});var d=X,m=Y;je(null),_t(null);try{for(var g,w=[];i!==null;){var S=i.assignedSlot||i.parentNode||i.host||null;try{var k=i["__"+r];k!=null&&(!i.disabled||n.target===i)&&k.call(i,n)}catch(P){g?w.push(P):g=P}if(n.cancelBubble||S===e||S===null)break;i=S}if(g){for(let P of w)queueMicrotask(()=>{throw P});throw g}}finally{n.__root=e,delete n.currentTarget,je(d),_t(m)}}}function Ig(n){var e=document.createElement("template");return e.innerHTML=n.replaceAll("<!>","<!---->"),e.content}function ia(n,e){var t=Y;t.nodes_start===null&&(t.nodes_start=n,t.nodes_end=e)}function Qe(n,e){var t=(e&xm)!==0,r=(e&Fm)!==0,s,i=!n.startsWith("<!>");return()=>{s===void 0&&(s=Ig(i?n:"<!>"+n),t||(s=gi(s)));var a=r||zh?document.importNode(s,!0):s.cloneNode(!0);if(t){var c=gi(a),l=a.lastChild;ia(c,l)}else ia(a,a);return a}}function wg(){var n=document.createDocumentFragment(),e=document.createComment(""),t=ar();return n.append(e,t),ia(e,t),n}function Ue(n,e){n!==null&&n.before(e)}function Ha(n,e){var t=e==null?"":typeof e=="object"?e+"":e;t!==(n.__t??=n.nodeValue)&&(n.__t=t,n.nodeValue=t+"")}function Ag(n,e){return Rg(n,e)}const Bn=new Map;function Rg(n,{target:e,anchor:t,props:r={},events:s,context:i,intro:a=!0}){ng();var c=new Set,l=m=>{for(var g=0;g<m.length;g++){var w=m[g];if(!c.has(w)){c.add(w);var S=vg(w);e.addEventListener(w,Hr,{passive:S});var k=Bn.get(w);k===void 0?(document.addEventListener(w,Hr,{passive:S}),Bn.set(w,1)):Bn.set(w,k+1)}}};l(Da(Eg)),Qu.add(l);var h=void 0,d=cg(()=>{var m=t??e.appendChild(ar());return Qm(m,{pending:()=>{}},g=>{if(i){Er({});var w=he;w.c=i}s&&(r.$$events=s),h=n(g,r)||{},i&&Tr()}),()=>{for(var g of c){e.removeEventListener(g,Hr);var w=Bn.get(g);--w===0?(document.removeEventListener(g,Hr),Bn.delete(g)):Bn.set(g,w)}Qu.delete(l),m!==t&&m.parentNode?.removeChild(m)}});return bg.set(h,d),h}let bg=new WeakMap;class Sg{anchor;#e=new Map;#t=new Map;#n=new Map;#r=!0;constructor(e,t=!0){this.anchor=e,this.#r=t}#c=()=>{var e=re;if(this.#e.has(e)){var t=this.#e.get(e),r=this.#t.get(t);if(r)$a(r);else{var s=this.#n.get(t);s&&(this.#t.set(t,s.effect),this.#n.delete(t),s.fragment.lastChild.remove(),this.anchor.before(s.fragment),r=s.effect)}for(const[i,a]of this.#e){if(this.#e.delete(i),i===e)break;const c=this.#n.get(a);c&&(xe(c.effect),this.#n.delete(a))}for(const[i,a]of this.#t){if(i===t)continue;const c=()=>{if(Array.from(this.#e.values()).includes(i)){var h=document.createDocumentFragment();nf(a,h),h.append(ar()),this.#n.set(i,{effect:a,fragment:h})}else xe(a);this.#t.delete(i)};this.#r||!r?Yn(a,c,!1):c()}}};#o=e=>{this.#e.delete(e);const t=Array.from(this.#e.values());for(const[r,s]of this.#n)t.includes(r)||(xe(s.effect),this.#n.delete(r))};ensure(e,t){var r=re,s=Gh();if(t&&!this.#t.has(e)&&!this.#n.has(e))if(s){var i=document.createDocumentFragment(),a=ar();i.append(a),this.#n.set(e,{effect:Je(()=>t(a)),fragment:i})}else this.#t.set(e,Je(()=>t(this.anchor)));if(this.#e.set(r,e),s){for(const[c,l]of this.#t)c===e?r.skipped_effects.delete(l):r.skipped_effects.add(l);for(const[c,l]of this.#n)c===e?r.skipped_effects.delete(l.effect):r.skipped_effects.add(l.effect);r.oncommit(this.#c),r.ondiscard(this.#o)}else this.#c()}}function Zr(n,e,t=!1){var r=new Sg(n),s=t?sr:0;function i(a,c){r.ensure(a,c)}ja(()=>{var a=!1;e((c,l=!0)=>{a=!0,i(l,c)}),a||i(!1,null)},s)}function Pg(n,e){return e}function Cg(n,e,t){for(var r=n.items,s=[],i=e.length,a=0;a<i;a++)qa(e[a].e,s,!0);var c=i>0&&s.length===0&&t!==null;if(c){var l=t.parentNode;rg(l),l.append(t),r.clear(),ot(n,e[0].prev,e[i-1].next)}ef(s,()=>{for(var h=0;h<i;h++){var d=e[h];c||(r.delete(d.k),ot(n,d.prev,d.next)),xe(d.e,!c)}})}function kg(n,e,t,r,s,i=null){var a=n,c={flags:e,items:new Map,first:null},l=null,h=!1,d=new Map,m=Fa(()=>{var k=t();return bh(k)?k:k==null?[]:Da(k)}),g,w;function S(){Vg(w,g,c,d,a,s,e,r,t),i!==null&&(g.length===0?l?$a(l):l=Je(()=>i(a)):l!==null&&Yn(l,()=>{l=null}))}ja(()=>{w??=Y,g=z(m);var k=g.length;if(!(h&&k===0)){h=k===0;var P,x,N,M;if(Gh()){var Q=new Set,te=re;for(x=0;x<k;x+=1){N=g[x],M=r(N,x);var Z=c.items.get(M)??d.get(M);Z?lf(Z,N,x):(P=hf(null,c,null,null,N,M,x,s,e,t,!0),d.set(M,P)),Q.add(M)}for(const[T,_]of c.items)Q.has(T)||te.skipped_effects.add(_.e);te.oncommit(S)}else S();z(m)}})}function Vg(n,e,t,r,s,i,a,c,l){var h=e.length,d=t.items,m=t.first,g=m,w,S=null,k=[],P=[],x,N,M,Q;for(Q=0;Q<h;Q+=1){if(x=e[Q],N=c(x,Q),M=d.get(N),M===void 0){var te=r.get(N);if(te!==void 0){r.delete(N),d.set(N,te);var Z=S?S.next:g;ot(t,S,te),ot(t,te,Z),Fo(te,Z,s),S=te}else{var T=g?g.e.nodes_start:s;S=hf(T,t,S,S===null?t.first:S.next,x,N,Q,i,a,l)}d.set(N,S),k=[],P=[],g=S.next;continue}if(lf(M,x,Q),(M.e.f&Ke)!==0&&$a(M.e),M!==g){if(w!==void 0&&w.has(M)){if(k.length<P.length){var _=P[0],v;S=_.prev;var I=k[0],E=k[k.length-1];for(v=0;v<k.length;v+=1)Fo(k[v],_,s);for(v=0;v<P.length;v+=1)w.delete(P[v]);ot(t,I.prev,E.next),ot(t,S,I),ot(t,E,_),g=_,S=E,Q-=1,k=[],P=[]}else w.delete(M),Fo(M,g,s),ot(t,M.prev,M.next),ot(t,M,S===null?t.first:S.next),ot(t,S,M),S=M;continue}for(k=[],P=[];g!==null&&g.k!==N;)(g.e.f&Ke)===0&&(w??=new Set).add(g),P.push(g),g=g.next;if(g===null)continue;M=g}k.push(M),S=M,g=M.next}if(g!==null||w!==void 0){for(var A=w===void 0?[]:Da(w);g!==null;)(g.e.f&Ke)===0&&A.push(g),g=g.next;var y=A.length;if(y>0){var oe=null;Cg(t,A,oe)}}n.first=t.first&&t.first.e,n.last=S&&S.e;for(var Tt of r.values())xe(Tt.e);r.clear()}function lf(n,e,t,r){cs(n.v,e),n.i=t}function hf(n,e,t,r,s,i,a,c,l,h,d){var m=(l&Vm)!==0,g=(l&Nm)===0,w=m?g?ht(s,!1,!1):Sn(s):s,S=(l&Dm)===0?a:Sn(a),k={i:S,v:w,k:i,a:null,e:null,prev:t,next:r};try{if(n===null){var P=document.createDocumentFragment();P.append(n=ar())}return k.e=Je(()=>c(n,w,S,h),jm),k.e.prev=t&&t.e,k.e.next=r&&r.e,t===null?d||(e.first=k):(t.next=k,t.e.next=k.e),r!==null&&(r.prev=k,r.e.prev=k.e),k}finally{}}function Fo(n,e,t){for(var r=n.next?n.next.e.nodes_start:t,s=e?e.e.nodes_start:t,i=n.e.nodes_start;i!==null&&i!==r;){var a=Es(i);s.before(i),i=a}}function ot(n,e,t){e===null?n.first=t:(e.next=t,e.e.next=t&&t.e),t!==null&&(t.prev=e,t.e.prev=e&&e.e)}function Dg(n,e,t,r,s){var i=e.$$slots?.[t],a=!1;i===!0&&(i=e.children,a=!0),i===void 0||i(n,a?()=>r:r)}const Ng=Symbol("is custom element"),Og=Symbol("is html");function si(n,e,t,r){var s=Mg(n);s[e]!==(s[e]=t)&&(e==="loading"&&(n[vm]=t),t==null?n.removeAttribute(e):typeof t!="string"&&Lg(n).includes(e)?n[e]=t:n.setAttribute(e,t))}function Mg(n){return n.__attributes??={[Ng]:n.nodeName.includes("-"),[Og]:n.namespaceURI===Um}}var Yu=new Map;function Lg(n){var e=n.getAttribute("is")||n.nodeName,t=Yu.get(e);if(t)return t;Yu.set(e,t=[]);for(var r,s=n,i=Element.prototype;i!==s;){r=Ph(s);for(var a in r)r[a].set&&t.push(a);s=Na(s)}return t}function Jn(n,e,t=e){var r=new WeakSet;ig(n,"input",async s=>{var i=s?n.defaultValue:n.value;if(i=Uo(n)?Bo(i):i,t(i),re!==null&&r.add(re),await mg(),i!==(i=e())){var a=n.selectionStart,c=n.selectionEnd,l=n.value.length;if(n.value=i??"",c!==null){var h=n.value.length;a===c&&c===l&&h>l?(n.selectionStart=h,n.selectionEnd=h):(n.selectionStart=a,n.selectionEnd=Math.min(c,h))}}}),Is(e)==null&&n.value&&(t(Uo(n)?Bo(n.value):n.value),re!==null&&r.add(re)),Xh(()=>{var s=e();if(n===document.activeElement){var i=ri??re;if(r.has(i))return}Uo(n)&&s===Bo(n.value)||n.type==="date"&&!s&&!n.value||s!==n.value&&(n.value=s??"")})}function Uo(n){var e=n.type;return e==="number"||e==="range"}function Bo(n){return n===""?null:+n}function ff(n){return function(...e){var t=e[0];return t.preventDefault(),n?.apply(this,e)}}function ws(n=!1){const e=he,t=e.l.u;if(!t)return;let r=()=>_g(e.s);if(n){let s=0,i={};const a=xa(()=>{let c=!1;const l=e.s;for(const h in l)l[h]!==i[h]&&(i[h]=l[h],c=!0);return c&&s++,s});r=()=>z(a)}t.b.length&&ag(()=>{Ju(e,r),Zo(t.b)}),ra(()=>{const s=Is(()=>t.m.map(_m));return()=>{for(const i of s)typeof i=="function"&&i()}}),t.a.length&&ra(()=>{Ju(e,r),Zo(t.a)})}function Ju(n,e){if(n.l.s)for(const t of n.l.s)z(t);e()}function df(n,e,t){if(n==null)return e(void 0),Qn;const r=Is(()=>n.subscribe(e,t));return r.unsubscribe?()=>r.unsubscribe():r}const jn=[];function xg(n,e=Qn){let t=null;const r=new Set;function s(c){if(Nh(n,c)&&(n=c,t)){const l=!jn.length;for(const h of r)h[1](),jn.push(h,n);if(l){for(let h=0;h<jn.length;h+=2)jn[h][0](jn[h+1]);jn.length=0}}}function i(c){s(c(n))}function a(c,l=Qn){const h=[c,l];return r.add(h),r.size===1&&(t=e(s,i)||Qn),c(n),()=>{r.delete(h),r.size===0&&t&&(t(),t=null)}}return{set:s,update:i,subscribe:a}}function Fg(n){let e;return df(n,t=>e=t)(),e}let Xs=!1,oa=Symbol();function pf(n,e,t){const r=t[e]??={store:null,source:ht(void 0),unsubscribe:Qn};if(r.store!==n&&!(oa in t))if(r.unsubscribe(),r.store=n??null,n==null)r.source.v=void 0,r.unsubscribe=Qn;else{var s=!0;r.unsubscribe=df(n,i=>{s?r.source.v=i:ue(r.source,i)}),s=!1}return n&&oa in t?Fg(n):z(r.source)}function mf(){const n={};function e(){Ba(()=>{for(var t in n)n[t].unsubscribe();Sh(n,oa,{enumerable:!1,value:!0})})}return[n,e]}function Ug(n){var e=Xs;try{return Xs=!1,[n(),Xs]}finally{Xs=e}}function es(n,e,t,r){var s=!vr||(t&Om)!==0,i=(t&Lm)!==0,a=r,c=!0,l=()=>(c&&(c=!1,a=r),a),h;{var d=Xn in n||ym in n;h=Kn(n,e)?.set??(d&&e in n?N=>n[e]=N:void 0)}var m,g=!1;[m,g]=Ug(()=>n[e]),m===void 0&&r!==void 0&&(m=l(),h&&(s&&bm(),h(m)));var w;if(s?w=()=>{var N=n[e];return N===void 0?l():(c=!0,N)}:w=()=>{var N=n[e];return N!==void 0&&(a=void 0),N===void 0?a:N},s&&(t&Mm)===0)return w;if(h){var S=n.$$legacy;return(function(N,M){return arguments.length>0?((!s||!M||S||g)&&h(M?w():N),N):w()})}var k=!1,P=Fa(()=>(k=!1,w()));z(P);var x=Y;return(function(N,M){if(arguments.length>0){const Q=M?z(P):s&&i?Gn(N):N;return ue(P,Q),k=!0,a!==void 0&&(a=Q),N}return On&&k||(x.f&Kt)!==0?P.v:z(P)})}function Bg(n){he===null&&Em(),vr&&he.l!==null?jg(he).m.push(n):ra(()=>{const e=Is(n);if(typeof e=="function")return e})}function jg(n){var e=n.l;return e.u??={a:[],b:[],m:[]}}const qg="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(qg);$m();const $g=()=>{};var Zu={};const gf=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let s=n.charCodeAt(r);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},zg=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const s=n[t++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=n[t++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=n[t++],a=n[t++],c=n[t++],l=((s&7)<<18|(i&63)<<12|(a&63)<<6|c&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const i=n[t++],a=n[t++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|a&63)}}return e.join("")},_f={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<n.length;s+=3){const i=n[s],a=s+1<n.length,c=a?n[s+1]:0,l=s+2<n.length,h=l?n[s+2]:0,d=i>>2,m=(i&3)<<4|c>>4;let g=(c&15)<<2|h>>6,w=h&63;l||(w=64,a||(g=64)),r.push(t[d],t[m],t[g],t[w])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(gf(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):zg(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<n.length;){const i=t[n.charAt(s++)],c=s<n.length?t[n.charAt(s)]:0;++s;const h=s<n.length?t[n.charAt(s)]:64;++s;const m=s<n.length?t[n.charAt(s)]:64;if(++s,i==null||c==null||h==null||m==null)throw new Hg;const g=i<<2|c>>4;if(r.push(g),h!==64){const w=c<<4&240|h>>2;if(r.push(w),m!==64){const S=h<<6&192|m;r.push(S)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class Hg extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Wg=function(n){const e=gf(n);return _f.encodeByteArray(e,!0)},vi=function(n){return Wg(n).replace(/\./g,"")},yf=function(n){try{return _f.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function Gg(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const Kg=()=>Gg().__FIREBASE_DEFAULTS__,Qg=()=>{if(typeof process>"u"||typeof Zu>"u")return;const n=Zu.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},Xg=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&yf(n[1]);return e&&JSON.parse(e)},Wi=()=>{try{return $g()||Kg()||Qg()||Xg()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},vf=n=>Wi()?.emulatorHosts?.[n],Yg=n=>{const e=vf(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},Ef=()=>Wi()?.config,Tf=n=>Wi()?.[`_${n}`];class Jg{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}function Ir(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function If(n){return(await fetch(n,{credentials:"include"})).ok}function Zg(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",s=n.iat||0,i=n.sub||n.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a={iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...n};return[vi(JSON.stringify(t)),vi(JSON.stringify(a)),""].join(".")}const ts={};function e_(){const n={prod:[],emulator:[]};for(const e of Object.keys(ts))ts[e]?n.emulator.push(e):n.prod.push(e);return n}function t_(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let el=!1;function wf(n,e){if(typeof window>"u"||typeof document>"u"||!Ir(window.location.host)||ts[n]===e||ts[n]||el)return;ts[n]=e;function t(g){return`__firebase__banner__${g}`}const r="__firebase__banner",i=e_().prod.length>0;function a(){const g=document.getElementById(r);g&&g.remove()}function c(g){g.style.display="flex",g.style.background="#7faaf0",g.style.position="fixed",g.style.bottom="5px",g.style.left="5px",g.style.padding=".5em",g.style.borderRadius="5px",g.style.alignItems="center"}function l(g,w){g.setAttribute("width","24"),g.setAttribute("id",w),g.setAttribute("height","24"),g.setAttribute("viewBox","0 0 24 24"),g.setAttribute("fill","none"),g.style.marginLeft="-6px"}function h(){const g=document.createElement("span");return g.style.cursor="pointer",g.style.marginLeft="16px",g.style.fontSize="24px",g.innerHTML=" &times;",g.onclick=()=>{el=!0,a()},g}function d(g,w){g.setAttribute("id",w),g.innerText="Learn more",g.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",g.setAttribute("target","__blank"),g.style.paddingLeft="5px",g.style.textDecoration="underline"}function m(){const g=t_(r),w=t("text"),S=document.getElementById(w)||document.createElement("span"),k=t("learnmore"),P=document.getElementById(k)||document.createElement("a"),x=t("preprendIcon"),N=document.getElementById(x)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(g.created){const M=g.element;c(M),d(P,k);const Q=h();l(N,x),M.append(N,S,P,Q),document.body.appendChild(M)}i?(S.innerText="Preview backend disconnected.",N.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(N.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,S.innerText="Preview backend running in this workspace."),S.setAttribute("id",w)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",m):m()}function Ne(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function n_(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ne())}function r_(){const n=Wi()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function s_(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function i_(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function o_(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function a_(){const n=Ne();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function c_(){return!r_()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function u_(){try{return typeof indexedDB=="object"}catch{return!1}}function l_(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{e(s.error?.message||"")}}catch(t){e(t)}})}const h_="FirebaseError";class Mt extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=h_,Object.setPrototypeOf(this,Mt.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,As.prototype.create)}}class As{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},s=`${this.service}/${e}`,i=this.errors[e],a=i?f_(i,r):"Error",c=`${this.serviceName}: ${a} (${s}).`;return new Mt(s,c,r)}}function f_(n,e){return n.replace(d_,(t,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const d_=/\{\$([^}]+)}/g;function p_(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Pn(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const s of t){if(!r.includes(s))return!1;const i=n[s],a=e[s];if(tl(i)&&tl(a)){if(!Pn(i,a))return!1}else if(i!==a)return!1}for(const s of r)if(!t.includes(s))return!1;return!0}function tl(n){return n!==null&&typeof n=="object"}function Rs(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function m_(n,e){const t=new g_(n,e);return t.subscribe.bind(t)}class g_{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let s;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");__(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:r},s.next===void 0&&(s.next=jo),s.error===void 0&&(s.error=jo),s.complete===void 0&&(s.complete=jo);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function __(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function jo(){}function we(n){return n&&n._delegate?n._delegate:n}class Cn{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const _n="[DEFAULT]";class y_{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new Jg;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(E_(e))try{this.getOrInitializeService({instanceIdentifier:_n})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=_n){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=_n){return this.instances.has(e)}getOptions(e=_n){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[i,a]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(i);r===c&&a.resolve(s)}return s}onInit(e,t){const r=this.normalizeInstanceIdentifier(t),s=this.onInitCallbacks.get(r)??new Set;s.add(e),this.onInitCallbacks.set(r,s);const i=this.instances.get(r);return i&&e(i,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const s of r)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:v_(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=_n){return this.component?this.component.multipleInstances?e:_n:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function v_(n){return n===_n?void 0:n}function E_(n){return n.instantiationMode==="EAGER"}class T_{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new y_(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var H;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(H||(H={}));const I_={debug:H.DEBUG,verbose:H.VERBOSE,info:H.INFO,warn:H.WARN,error:H.ERROR,silent:H.SILENT},w_=H.INFO,A_={[H.DEBUG]:"log",[H.VERBOSE]:"log",[H.INFO]:"info",[H.WARN]:"warn",[H.ERROR]:"error"},R_=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),s=A_[e];if(s)console[s](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Wa{constructor(e){this.name=e,this._logLevel=w_,this._logHandler=R_,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in H))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?I_[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,H.DEBUG,...e),this._logHandler(this,H.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,H.VERBOSE,...e),this._logHandler(this,H.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,H.INFO,...e),this._logHandler(this,H.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,H.WARN,...e),this._logHandler(this,H.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,H.ERROR,...e),this._logHandler(this,H.ERROR,...e)}}const b_=(n,e)=>e.some(t=>n instanceof t);let nl,rl;function S_(){return nl||(nl=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function P_(){return rl||(rl=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Af=new WeakMap,aa=new WeakMap,Rf=new WeakMap,qo=new WeakMap,Ga=new WeakMap;function C_(n){const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("success",i),n.removeEventListener("error",a)},i=()=>{t(Yt(n.result)),s()},a=()=>{r(n.error),s()};n.addEventListener("success",i),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&Af.set(t,n)}).catch(()=>{}),Ga.set(e,n),e}function k_(n){if(aa.has(n))return;const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("complete",i),n.removeEventListener("error",a),n.removeEventListener("abort",a)},i=()=>{t(),s()},a=()=>{r(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",i),n.addEventListener("error",a),n.addEventListener("abort",a)});aa.set(n,e)}let ca={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return aa.get(n);if(e==="objectStoreNames")return n.objectStoreNames||Rf.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Yt(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function V_(n){ca=n(ca)}function D_(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call($o(this),e,...t);return Rf.set(r,e.sort?e.sort():[e]),Yt(r)}:P_().includes(n)?function(...e){return n.apply($o(this),e),Yt(Af.get(this))}:function(...e){return Yt(n.apply($o(this),e))}}function N_(n){return typeof n=="function"?D_(n):(n instanceof IDBTransaction&&k_(n),b_(n,S_())?new Proxy(n,ca):n)}function Yt(n){if(n instanceof IDBRequest)return C_(n);if(qo.has(n))return qo.get(n);const e=N_(n);return e!==n&&(qo.set(n,e),Ga.set(e,n)),e}const $o=n=>Ga.get(n);function O_(n,e,{blocked:t,upgrade:r,blocking:s,terminated:i}={}){const a=indexedDB.open(n,e),c=Yt(a);return r&&a.addEventListener("upgradeneeded",l=>{r(Yt(a.result),l.oldVersion,l.newVersion,Yt(a.transaction),l)}),t&&a.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),c.then(l=>{i&&l.addEventListener("close",()=>i()),s&&l.addEventListener("versionchange",h=>s(h.oldVersion,h.newVersion,h))}).catch(()=>{}),c}const M_=["get","getKey","getAll","getAllKeys","count"],L_=["put","add","delete","clear"],zo=new Map;function sl(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(zo.get(e))return zo.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,s=L_.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(s||M_.includes(t)))return;const i=async function(a,...c){const l=this.transaction(a,s?"readwrite":"readonly");let h=l.store;return r&&(h=h.index(c.shift())),(await Promise.all([h[t](...c),s&&l.done]))[0]};return zo.set(e,i),i}V_(n=>({...n,get:(e,t,r)=>sl(e,t)||n.get(e,t,r),has:(e,t)=>!!sl(e,t)||n.has(e,t)}));class x_{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(F_(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function F_(n){return n.getComponent()?.type==="VERSION"}const ua="@firebase/app",il="0.14.5";const St=new Wa("@firebase/app"),U_="@firebase/app-compat",B_="@firebase/analytics-compat",j_="@firebase/analytics",q_="@firebase/app-check-compat",$_="@firebase/app-check",z_="@firebase/auth",H_="@firebase/auth-compat",W_="@firebase/database",G_="@firebase/data-connect",K_="@firebase/database-compat",Q_="@firebase/functions",X_="@firebase/functions-compat",Y_="@firebase/installations",J_="@firebase/installations-compat",Z_="@firebase/messaging",ey="@firebase/messaging-compat",ty="@firebase/performance",ny="@firebase/performance-compat",ry="@firebase/remote-config",sy="@firebase/remote-config-compat",iy="@firebase/storage",oy="@firebase/storage-compat",ay="@firebase/firestore",cy="@firebase/ai",uy="@firebase/firestore-compat",ly="firebase",hy="12.5.0";const la="[DEFAULT]",fy={[ua]:"fire-core",[U_]:"fire-core-compat",[j_]:"fire-analytics",[B_]:"fire-analytics-compat",[$_]:"fire-app-check",[q_]:"fire-app-check-compat",[z_]:"fire-auth",[H_]:"fire-auth-compat",[W_]:"fire-rtdb",[G_]:"fire-data-connect",[K_]:"fire-rtdb-compat",[Q_]:"fire-fn",[X_]:"fire-fn-compat",[Y_]:"fire-iid",[J_]:"fire-iid-compat",[Z_]:"fire-fcm",[ey]:"fire-fcm-compat",[ty]:"fire-perf",[ny]:"fire-perf-compat",[ry]:"fire-rc",[sy]:"fire-rc-compat",[iy]:"fire-gcs",[oy]:"fire-gcs-compat",[ay]:"fire-fst",[uy]:"fire-fst-compat",[cy]:"fire-vertex","fire-js":"fire-js",[ly]:"fire-js-all"};const Ei=new Map,dy=new Map,ha=new Map;function ol(n,e){try{n.container.addComponent(e)}catch(t){St.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function cr(n){const e=n.name;if(ha.has(e))return St.debug(`There were multiple attempts to register component ${e}.`),!1;ha.set(e,n);for(const t of Ei.values())ol(t,n);for(const t of dy.values())ol(t,n);return!0}function Ka(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Ze(n){return n==null?!1:n.settings!==void 0}const py={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Jt=new As("app","Firebase",py);class my{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Cn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Jt.create("app-deleted",{appName:this._name})}}const wr=hy;function bf(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r={name:la,automaticDataCollectionEnabled:!0,...e},s=r.name;if(typeof s!="string"||!s)throw Jt.create("bad-app-name",{appName:String(s)});if(t||(t=Ef()),!t)throw Jt.create("no-options");const i=Ei.get(s);if(i){if(Pn(t,i.options)&&Pn(r,i.config))return i;throw Jt.create("duplicate-app",{appName:s})}const a=new T_(s);for(const l of ha.values())a.addComponent(l);const c=new my(t,r,a);return Ei.set(s,c),c}function Sf(n=la){const e=Ei.get(n);if(!e&&n===la&&Ef())return bf();if(!e)throw Jt.create("no-app",{appName:n});return e}function Zt(n,e,t){let r=fy[n]??n;t&&(r+=`-${t}`);const s=r.match(/\s|\//),i=e.match(/\s|\//);if(s||i){const a=[`Unable to register library "${r}" with version "${e}":`];s&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&i&&a.push("and"),i&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),St.warn(a.join(" "));return}cr(new Cn(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}const gy="firebase-heartbeat-database",_y=1,hs="firebase-heartbeat-store";let Ho=null;function Pf(){return Ho||(Ho=O_(gy,_y,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(hs)}catch(t){console.warn(t)}}}}).catch(n=>{throw Jt.create("idb-open",{originalErrorMessage:n.message})})),Ho}async function yy(n){try{const t=(await Pf()).transaction(hs),r=await t.objectStore(hs).get(Cf(n));return await t.done,r}catch(e){if(e instanceof Mt)St.warn(e.message);else{const t=Jt.create("idb-get",{originalErrorMessage:e?.message});St.warn(t.message)}}}async function al(n,e){try{const r=(await Pf()).transaction(hs,"readwrite");await r.objectStore(hs).put(e,Cf(n)),await r.done}catch(t){if(t instanceof Mt)St.warn(t.message);else{const r=Jt.create("idb-set",{originalErrorMessage:t?.message});St.warn(r.message)}}}function Cf(n){return`${n.name}!${n.options.appId}`}const vy=1024,Ey=30;class Ty{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new wy(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=cl();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(s=>s.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:t}),this._heartbeatsCache.heartbeats.length>Ey){const s=Ay(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(s,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){St.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=cl(),{heartbeatsToSend:t,unsentEntries:r}=Iy(this._heartbeatsCache.heartbeats),s=vi(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(e){return St.warn(e),""}}}function cl(){return new Date().toISOString().substring(0,10)}function Iy(n,e=vy){const t=[];let r=n.slice();for(const s of n){const i=t.find(a=>a.agent===s.agent);if(i){if(i.dates.push(s.date),ul(t)>e){i.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),ul(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class wy{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return u_()?l_().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await yy(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return al(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return al(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function ul(n){return vi(JSON.stringify({version:2,heartbeats:n})).length}function Ay(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function Ry(n){cr(new Cn("platform-logger",e=>new x_(e),"PRIVATE")),cr(new Cn("heartbeat",e=>new Ty(e),"PRIVATE")),Zt(ua,il,n),Zt(ua,il,"esm2020"),Zt("fire-js","")}Ry("");var by="firebase",Sy="12.5.0";Zt(by,Sy,"app");var ll=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var en,kf;(function(){var n;function e(T,_){function v(){}v.prototype=_.prototype,T.F=_.prototype,T.prototype=new v,T.prototype.constructor=T,T.D=function(I,E,A){for(var y=Array(arguments.length-2),oe=2;oe<arguments.length;oe++)y[oe-2]=arguments[oe];return _.prototype[E].apply(I,y)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(T,_,v){v||(v=0);const I=Array(16);if(typeof _=="string")for(var E=0;E<16;++E)I[E]=_.charCodeAt(v++)|_.charCodeAt(v++)<<8|_.charCodeAt(v++)<<16|_.charCodeAt(v++)<<24;else for(E=0;E<16;++E)I[E]=_[v++]|_[v++]<<8|_[v++]<<16|_[v++]<<24;_=T.g[0],v=T.g[1],E=T.g[2];let A=T.g[3],y;y=_+(A^v&(E^A))+I[0]+3614090360&4294967295,_=v+(y<<7&4294967295|y>>>25),y=A+(E^_&(v^E))+I[1]+3905402710&4294967295,A=_+(y<<12&4294967295|y>>>20),y=E+(v^A&(_^v))+I[2]+606105819&4294967295,E=A+(y<<17&4294967295|y>>>15),y=v+(_^E&(A^_))+I[3]+3250441966&4294967295,v=E+(y<<22&4294967295|y>>>10),y=_+(A^v&(E^A))+I[4]+4118548399&4294967295,_=v+(y<<7&4294967295|y>>>25),y=A+(E^_&(v^E))+I[5]+1200080426&4294967295,A=_+(y<<12&4294967295|y>>>20),y=E+(v^A&(_^v))+I[6]+2821735955&4294967295,E=A+(y<<17&4294967295|y>>>15),y=v+(_^E&(A^_))+I[7]+4249261313&4294967295,v=E+(y<<22&4294967295|y>>>10),y=_+(A^v&(E^A))+I[8]+1770035416&4294967295,_=v+(y<<7&4294967295|y>>>25),y=A+(E^_&(v^E))+I[9]+2336552879&4294967295,A=_+(y<<12&4294967295|y>>>20),y=E+(v^A&(_^v))+I[10]+4294925233&4294967295,E=A+(y<<17&4294967295|y>>>15),y=v+(_^E&(A^_))+I[11]+2304563134&4294967295,v=E+(y<<22&4294967295|y>>>10),y=_+(A^v&(E^A))+I[12]+1804603682&4294967295,_=v+(y<<7&4294967295|y>>>25),y=A+(E^_&(v^E))+I[13]+4254626195&4294967295,A=_+(y<<12&4294967295|y>>>20),y=E+(v^A&(_^v))+I[14]+2792965006&4294967295,E=A+(y<<17&4294967295|y>>>15),y=v+(_^E&(A^_))+I[15]+1236535329&4294967295,v=E+(y<<22&4294967295|y>>>10),y=_+(E^A&(v^E))+I[1]+4129170786&4294967295,_=v+(y<<5&4294967295|y>>>27),y=A+(v^E&(_^v))+I[6]+3225465664&4294967295,A=_+(y<<9&4294967295|y>>>23),y=E+(_^v&(A^_))+I[11]+643717713&4294967295,E=A+(y<<14&4294967295|y>>>18),y=v+(A^_&(E^A))+I[0]+3921069994&4294967295,v=E+(y<<20&4294967295|y>>>12),y=_+(E^A&(v^E))+I[5]+3593408605&4294967295,_=v+(y<<5&4294967295|y>>>27),y=A+(v^E&(_^v))+I[10]+38016083&4294967295,A=_+(y<<9&4294967295|y>>>23),y=E+(_^v&(A^_))+I[15]+3634488961&4294967295,E=A+(y<<14&4294967295|y>>>18),y=v+(A^_&(E^A))+I[4]+3889429448&4294967295,v=E+(y<<20&4294967295|y>>>12),y=_+(E^A&(v^E))+I[9]+568446438&4294967295,_=v+(y<<5&4294967295|y>>>27),y=A+(v^E&(_^v))+I[14]+3275163606&4294967295,A=_+(y<<9&4294967295|y>>>23),y=E+(_^v&(A^_))+I[3]+4107603335&4294967295,E=A+(y<<14&4294967295|y>>>18),y=v+(A^_&(E^A))+I[8]+1163531501&4294967295,v=E+(y<<20&4294967295|y>>>12),y=_+(E^A&(v^E))+I[13]+2850285829&4294967295,_=v+(y<<5&4294967295|y>>>27),y=A+(v^E&(_^v))+I[2]+4243563512&4294967295,A=_+(y<<9&4294967295|y>>>23),y=E+(_^v&(A^_))+I[7]+1735328473&4294967295,E=A+(y<<14&4294967295|y>>>18),y=v+(A^_&(E^A))+I[12]+2368359562&4294967295,v=E+(y<<20&4294967295|y>>>12),y=_+(v^E^A)+I[5]+4294588738&4294967295,_=v+(y<<4&4294967295|y>>>28),y=A+(_^v^E)+I[8]+2272392833&4294967295,A=_+(y<<11&4294967295|y>>>21),y=E+(A^_^v)+I[11]+1839030562&4294967295,E=A+(y<<16&4294967295|y>>>16),y=v+(E^A^_)+I[14]+4259657740&4294967295,v=E+(y<<23&4294967295|y>>>9),y=_+(v^E^A)+I[1]+2763975236&4294967295,_=v+(y<<4&4294967295|y>>>28),y=A+(_^v^E)+I[4]+1272893353&4294967295,A=_+(y<<11&4294967295|y>>>21),y=E+(A^_^v)+I[7]+4139469664&4294967295,E=A+(y<<16&4294967295|y>>>16),y=v+(E^A^_)+I[10]+3200236656&4294967295,v=E+(y<<23&4294967295|y>>>9),y=_+(v^E^A)+I[13]+681279174&4294967295,_=v+(y<<4&4294967295|y>>>28),y=A+(_^v^E)+I[0]+3936430074&4294967295,A=_+(y<<11&4294967295|y>>>21),y=E+(A^_^v)+I[3]+3572445317&4294967295,E=A+(y<<16&4294967295|y>>>16),y=v+(E^A^_)+I[6]+76029189&4294967295,v=E+(y<<23&4294967295|y>>>9),y=_+(v^E^A)+I[9]+3654602809&4294967295,_=v+(y<<4&4294967295|y>>>28),y=A+(_^v^E)+I[12]+3873151461&4294967295,A=_+(y<<11&4294967295|y>>>21),y=E+(A^_^v)+I[15]+530742520&4294967295,E=A+(y<<16&4294967295|y>>>16),y=v+(E^A^_)+I[2]+3299628645&4294967295,v=E+(y<<23&4294967295|y>>>9),y=_+(E^(v|~A))+I[0]+4096336452&4294967295,_=v+(y<<6&4294967295|y>>>26),y=A+(v^(_|~E))+I[7]+1126891415&4294967295,A=_+(y<<10&4294967295|y>>>22),y=E+(_^(A|~v))+I[14]+2878612391&4294967295,E=A+(y<<15&4294967295|y>>>17),y=v+(A^(E|~_))+I[5]+4237533241&4294967295,v=E+(y<<21&4294967295|y>>>11),y=_+(E^(v|~A))+I[12]+1700485571&4294967295,_=v+(y<<6&4294967295|y>>>26),y=A+(v^(_|~E))+I[3]+2399980690&4294967295,A=_+(y<<10&4294967295|y>>>22),y=E+(_^(A|~v))+I[10]+4293915773&4294967295,E=A+(y<<15&4294967295|y>>>17),y=v+(A^(E|~_))+I[1]+2240044497&4294967295,v=E+(y<<21&4294967295|y>>>11),y=_+(E^(v|~A))+I[8]+1873313359&4294967295,_=v+(y<<6&4294967295|y>>>26),y=A+(v^(_|~E))+I[15]+4264355552&4294967295,A=_+(y<<10&4294967295|y>>>22),y=E+(_^(A|~v))+I[6]+2734768916&4294967295,E=A+(y<<15&4294967295|y>>>17),y=v+(A^(E|~_))+I[13]+1309151649&4294967295,v=E+(y<<21&4294967295|y>>>11),y=_+(E^(v|~A))+I[4]+4149444226&4294967295,_=v+(y<<6&4294967295|y>>>26),y=A+(v^(_|~E))+I[11]+3174756917&4294967295,A=_+(y<<10&4294967295|y>>>22),y=E+(_^(A|~v))+I[2]+718787259&4294967295,E=A+(y<<15&4294967295|y>>>17),y=v+(A^(E|~_))+I[9]+3951481745&4294967295,T.g[0]=T.g[0]+_&4294967295,T.g[1]=T.g[1]+(E+(y<<21&4294967295|y>>>11))&4294967295,T.g[2]=T.g[2]+E&4294967295,T.g[3]=T.g[3]+A&4294967295}r.prototype.v=function(T,_){_===void 0&&(_=T.length);const v=_-this.blockSize,I=this.C;let E=this.h,A=0;for(;A<_;){if(E==0)for(;A<=v;)s(this,T,A),A+=this.blockSize;if(typeof T=="string"){for(;A<_;)if(I[E++]=T.charCodeAt(A++),E==this.blockSize){s(this,I),E=0;break}}else for(;A<_;)if(I[E++]=T[A++],E==this.blockSize){s(this,I),E=0;break}}this.h=E,this.o+=_},r.prototype.A=function(){var T=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);T[0]=128;for(var _=1;_<T.length-8;++_)T[_]=0;_=this.o*8;for(var v=T.length-8;v<T.length;++v)T[v]=_&255,_/=256;for(this.v(T),T=Array(16),_=0,v=0;v<4;++v)for(let I=0;I<32;I+=8)T[_++]=this.g[v]>>>I&255;return T};function i(T,_){var v=c;return Object.prototype.hasOwnProperty.call(v,T)?v[T]:v[T]=_(T)}function a(T,_){this.h=_;const v=[];let I=!0;for(let E=T.length-1;E>=0;E--){const A=T[E]|0;I&&A==_||(v[E]=A,I=!1)}this.g=v}var c={};function l(T){return-128<=T&&T<128?i(T,function(_){return new a([_|0],_<0?-1:0)}):new a([T|0],T<0?-1:0)}function h(T){if(isNaN(T)||!isFinite(T))return m;if(T<0)return P(h(-T));const _=[];let v=1;for(let I=0;T>=v;I++)_[I]=T/v|0,v*=4294967296;return new a(_,0)}function d(T,_){if(T.length==0)throw Error("number format error: empty string");if(_=_||10,_<2||36<_)throw Error("radix out of range: "+_);if(T.charAt(0)=="-")return P(d(T.substring(1),_));if(T.indexOf("-")>=0)throw Error('number format error: interior "-" character');const v=h(Math.pow(_,8));let I=m;for(let A=0;A<T.length;A+=8){var E=Math.min(8,T.length-A);const y=parseInt(T.substring(A,A+E),_);E<8?(E=h(Math.pow(_,E)),I=I.j(E).add(h(y))):(I=I.j(v),I=I.add(h(y)))}return I}var m=l(0),g=l(1),w=l(16777216);n=a.prototype,n.m=function(){if(k(this))return-P(this).m();let T=0,_=1;for(let v=0;v<this.g.length;v++){const I=this.i(v);T+=(I>=0?I:4294967296+I)*_,_*=4294967296}return T},n.toString=function(T){if(T=T||10,T<2||36<T)throw Error("radix out of range: "+T);if(S(this))return"0";if(k(this))return"-"+P(this).toString(T);const _=h(Math.pow(T,6));var v=this;let I="";for(;;){const E=Q(v,_).g;v=x(v,E.j(_));let A=((v.g.length>0?v.g[0]:v.h)>>>0).toString(T);if(v=E,S(v))return A+I;for(;A.length<6;)A="0"+A;I=A+I}},n.i=function(T){return T<0?0:T<this.g.length?this.g[T]:this.h};function S(T){if(T.h!=0)return!1;for(let _=0;_<T.g.length;_++)if(T.g[_]!=0)return!1;return!0}function k(T){return T.h==-1}n.l=function(T){return T=x(this,T),k(T)?-1:S(T)?0:1};function P(T){const _=T.g.length,v=[];for(let I=0;I<_;I++)v[I]=~T.g[I];return new a(v,~T.h).add(g)}n.abs=function(){return k(this)?P(this):this},n.add=function(T){const _=Math.max(this.g.length,T.g.length),v=[];let I=0;for(let E=0;E<=_;E++){let A=I+(this.i(E)&65535)+(T.i(E)&65535),y=(A>>>16)+(this.i(E)>>>16)+(T.i(E)>>>16);I=y>>>16,A&=65535,y&=65535,v[E]=y<<16|A}return new a(v,v[v.length-1]&-2147483648?-1:0)};function x(T,_){return T.add(P(_))}n.j=function(T){if(S(this)||S(T))return m;if(k(this))return k(T)?P(this).j(P(T)):P(P(this).j(T));if(k(T))return P(this.j(P(T)));if(this.l(w)<0&&T.l(w)<0)return h(this.m()*T.m());const _=this.g.length+T.g.length,v=[];for(var I=0;I<2*_;I++)v[I]=0;for(I=0;I<this.g.length;I++)for(let E=0;E<T.g.length;E++){const A=this.i(I)>>>16,y=this.i(I)&65535,oe=T.i(E)>>>16,Tt=T.i(E)&65535;v[2*I+2*E]+=y*Tt,N(v,2*I+2*E),v[2*I+2*E+1]+=A*Tt,N(v,2*I+2*E+1),v[2*I+2*E+1]+=y*oe,N(v,2*I+2*E+1),v[2*I+2*E+2]+=A*oe,N(v,2*I+2*E+2)}for(T=0;T<_;T++)v[T]=v[2*T+1]<<16|v[2*T];for(T=_;T<2*_;T++)v[T]=0;return new a(v,0)};function N(T,_){for(;(T[_]&65535)!=T[_];)T[_+1]+=T[_]>>>16,T[_]&=65535,_++}function M(T,_){this.g=T,this.h=_}function Q(T,_){if(S(_))throw Error("division by zero");if(S(T))return new M(m,m);if(k(T))return _=Q(P(T),_),new M(P(_.g),P(_.h));if(k(_))return _=Q(T,P(_)),new M(P(_.g),_.h);if(T.g.length>30){if(k(T)||k(_))throw Error("slowDivide_ only works with positive integers.");for(var v=g,I=_;I.l(T)<=0;)v=te(v),I=te(I);var E=Z(v,1),A=Z(I,1);for(I=Z(I,2),v=Z(v,2);!S(I);){var y=A.add(I);y.l(T)<=0&&(E=E.add(v),A=y),I=Z(I,1),v=Z(v,1)}return _=x(T,E.j(_)),new M(E,_)}for(E=m;T.l(_)>=0;){for(v=Math.max(1,Math.floor(T.m()/_.m())),I=Math.ceil(Math.log(v)/Math.LN2),I=I<=48?1:Math.pow(2,I-48),A=h(v),y=A.j(_);k(y)||y.l(T)>0;)v-=I,A=h(v),y=A.j(_);S(A)&&(A=g),E=E.add(A),T=x(T,y)}return new M(E,T)}n.B=function(T){return Q(this,T).h},n.and=function(T){const _=Math.max(this.g.length,T.g.length),v=[];for(let I=0;I<_;I++)v[I]=this.i(I)&T.i(I);return new a(v,this.h&T.h)},n.or=function(T){const _=Math.max(this.g.length,T.g.length),v=[];for(let I=0;I<_;I++)v[I]=this.i(I)|T.i(I);return new a(v,this.h|T.h)},n.xor=function(T){const _=Math.max(this.g.length,T.g.length),v=[];for(let I=0;I<_;I++)v[I]=this.i(I)^T.i(I);return new a(v,this.h^T.h)};function te(T){const _=T.g.length+1,v=[];for(let I=0;I<_;I++)v[I]=T.i(I)<<1|T.i(I-1)>>>31;return new a(v,T.h)}function Z(T,_){const v=_>>5;_%=32;const I=T.g.length-v,E=[];for(let A=0;A<I;A++)E[A]=_>0?T.i(A+v)>>>_|T.i(A+v+1)<<32-_:T.i(A+v);return new a(E,T.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,kf=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.B,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=h,a.fromString=d,en=a}).apply(typeof ll<"u"?ll:typeof self<"u"?self:typeof window<"u"?window:{});var Ys=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Vf,Wr,Df,ii,fa,Nf,Of,Mf;(function(){var n,e=Object.defineProperty;function t(o){o=[typeof globalThis=="object"&&globalThis,o,typeof window=="object"&&window,typeof self=="object"&&self,typeof Ys=="object"&&Ys];for(var u=0;u<o.length;++u){var f=o[u];if(f&&f.Math==Math)return f}throw Error("Cannot find global object")}var r=t(this);function s(o,u){if(u)e:{var f=r;o=o.split(".");for(var p=0;p<o.length-1;p++){var R=o[p];if(!(R in f))break e;f=f[R]}o=o[o.length-1],p=f[o],u=u(p),u!=p&&u!=null&&e(f,o,{configurable:!0,writable:!0,value:u})}}s("Symbol.dispose",function(o){return o||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(o){return o||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(o){return o||function(u){var f=[],p;for(p in u)Object.prototype.hasOwnProperty.call(u,p)&&f.push([p,u[p]]);return f}});var i=i||{},a=this||self;function c(o){var u=typeof o;return u=="object"&&o!=null||u=="function"}function l(o,u,f){return o.call.apply(o.bind,arguments)}function h(o,u,f){return h=l,h.apply(null,arguments)}function d(o,u){var f=Array.prototype.slice.call(arguments,1);return function(){var p=f.slice();return p.push.apply(p,arguments),o.apply(this,p)}}function m(o,u){function f(){}f.prototype=u.prototype,o.Z=u.prototype,o.prototype=new f,o.prototype.constructor=o,o.Ob=function(p,R,b){for(var D=Array(arguments.length-2),$=2;$<arguments.length;$++)D[$-2]=arguments[$];return u.prototype[R].apply(p,D)}}var g=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?o=>o&&AsyncContext.Snapshot.wrap(o):o=>o;function w(o){const u=o.length;if(u>0){const f=Array(u);for(let p=0;p<u;p++)f[p]=o[p];return f}return[]}function S(o,u){for(let p=1;p<arguments.length;p++){const R=arguments[p];var f=typeof R;if(f=f!="object"?f:R?Array.isArray(R)?"array":f:"null",f=="array"||f=="object"&&typeof R.length=="number"){f=o.length||0;const b=R.length||0;o.length=f+b;for(let D=0;D<b;D++)o[f+D]=R[D]}else o.push(R)}}class k{constructor(u,f){this.i=u,this.j=f,this.h=0,this.g=null}get(){let u;return this.h>0?(this.h--,u=this.g,this.g=u.next,u.next=null):u=this.i(),u}}function P(o){a.setTimeout(()=>{throw o},0)}function x(){var o=T;let u=null;return o.g&&(u=o.g,o.g=o.g.next,o.g||(o.h=null),u.next=null),u}class N{constructor(){this.h=this.g=null}add(u,f){const p=M.get();p.set(u,f),this.h?this.h.next=p:this.g=p,this.h=p}}var M=new k(()=>new Q,o=>o.reset());class Q{constructor(){this.next=this.g=this.h=null}set(u,f){this.h=u,this.g=f,this.next=null}reset(){this.next=this.g=this.h=null}}let te,Z=!1,T=new N,_=()=>{const o=Promise.resolve(void 0);te=()=>{o.then(v)}};function v(){for(var o;o=x();){try{o.h.call(o.g)}catch(f){P(f)}var u=M;u.j(o),u.h<100&&(u.h++,o.next=u.g,u.g=o)}Z=!1}function I(){this.u=this.u,this.C=this.C}I.prototype.u=!1,I.prototype.dispose=function(){this.u||(this.u=!0,this.N())},I.prototype[Symbol.dispose]=function(){this.dispose()},I.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function E(o,u){this.type=o,this.g=this.target=u,this.defaultPrevented=!1}E.prototype.h=function(){this.defaultPrevented=!0};var A=(function(){if(!a.addEventListener||!Object.defineProperty)return!1;var o=!1,u=Object.defineProperty({},"passive",{get:function(){o=!0}});try{const f=()=>{};a.addEventListener("test",f,u),a.removeEventListener("test",f,u)}catch{}return o})();function y(o){return/^[\s\xa0]*$/.test(o)}function oe(o,u){E.call(this,o?o.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,o&&this.init(o,u)}m(oe,E),oe.prototype.init=function(o,u){const f=this.type=o.type,p=o.changedTouches&&o.changedTouches.length?o.changedTouches[0]:null;this.target=o.target||o.srcElement,this.g=u,u=o.relatedTarget,u||(f=="mouseover"?u=o.fromElement:f=="mouseout"&&(u=o.toElement)),this.relatedTarget=u,p?(this.clientX=p.clientX!==void 0?p.clientX:p.pageX,this.clientY=p.clientY!==void 0?p.clientY:p.pageY,this.screenX=p.screenX||0,this.screenY=p.screenY||0):(this.clientX=o.clientX!==void 0?o.clientX:o.pageX,this.clientY=o.clientY!==void 0?o.clientY:o.pageY,this.screenX=o.screenX||0,this.screenY=o.screenY||0),this.button=o.button,this.key=o.key||"",this.ctrlKey=o.ctrlKey,this.altKey=o.altKey,this.shiftKey=o.shiftKey,this.metaKey=o.metaKey,this.pointerId=o.pointerId||0,this.pointerType=o.pointerType,this.state=o.state,this.i=o,o.defaultPrevented&&oe.Z.h.call(this)},oe.prototype.h=function(){oe.Z.h.call(this);const o=this.i;o.preventDefault?o.preventDefault():o.returnValue=!1};var Tt="closure_listenable_"+(Math.random()*1e6|0),Lp=0;function xp(o,u,f,p,R){this.listener=o,this.proxy=null,this.src=u,this.type=f,this.capture=!!p,this.ha=R,this.key=++Lp,this.da=this.fa=!1}function Os(o){o.da=!0,o.listener=null,o.proxy=null,o.src=null,o.ha=null}function Ms(o,u,f){for(const p in o)u.call(f,o[p],p,o)}function Fp(o,u){for(const f in o)u.call(void 0,o[f],f,o)}function Bc(o){const u={};for(const f in o)u[f]=o[f];return u}const jc="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function qc(o,u){let f,p;for(let R=1;R<arguments.length;R++){p=arguments[R];for(f in p)o[f]=p[f];for(let b=0;b<jc.length;b++)f=jc[b],Object.prototype.hasOwnProperty.call(p,f)&&(o[f]=p[f])}}function Ls(o){this.src=o,this.g={},this.h=0}Ls.prototype.add=function(o,u,f,p,R){const b=o.toString();o=this.g[b],o||(o=this.g[b]=[],this.h++);const D=mo(o,u,p,R);return D>-1?(u=o[D],f||(u.fa=!1)):(u=new xp(u,this.src,b,!!p,R),u.fa=f,o.push(u)),u};function po(o,u){const f=u.type;if(f in o.g){var p=o.g[f],R=Array.prototype.indexOf.call(p,u,void 0),b;(b=R>=0)&&Array.prototype.splice.call(p,R,1),b&&(Os(u),o.g[f].length==0&&(delete o.g[f],o.h--))}}function mo(o,u,f,p){for(let R=0;R<o.length;++R){const b=o[R];if(!b.da&&b.listener==u&&b.capture==!!f&&b.ha==p)return R}return-1}var go="closure_lm_"+(Math.random()*1e6|0),_o={};function $c(o,u,f,p,R){if(Array.isArray(u)){for(let b=0;b<u.length;b++)$c(o,u[b],f,p,R);return null}return f=Wc(f),o&&o[Tt]?o.J(u,f,c(p)?!!p.capture:!1,R):Up(o,u,f,!1,p,R)}function Up(o,u,f,p,R,b){if(!u)throw Error("Invalid event type");const D=c(R)?!!R.capture:!!R;let $=vo(o);if($||(o[go]=$=new Ls(o)),f=$.add(u,f,p,D,b),f.proxy)return f;if(p=Bp(),f.proxy=p,p.src=o,p.listener=f,o.addEventListener)A||(R=D),R===void 0&&(R=!1),o.addEventListener(u.toString(),p,R);else if(o.attachEvent)o.attachEvent(Hc(u.toString()),p);else if(o.addListener&&o.removeListener)o.addListener(p);else throw Error("addEventListener and attachEvent are unavailable.");return f}function Bp(){function o(f){return u.call(o.src,o.listener,f)}const u=jp;return o}function zc(o,u,f,p,R){if(Array.isArray(u))for(var b=0;b<u.length;b++)zc(o,u[b],f,p,R);else p=c(p)?!!p.capture:!!p,f=Wc(f),o&&o[Tt]?(o=o.i,b=String(u).toString(),b in o.g&&(u=o.g[b],f=mo(u,f,p,R),f>-1&&(Os(u[f]),Array.prototype.splice.call(u,f,1),u.length==0&&(delete o.g[b],o.h--)))):o&&(o=vo(o))&&(u=o.g[u.toString()],o=-1,u&&(o=mo(u,f,p,R)),(f=o>-1?u[o]:null)&&yo(f))}function yo(o){if(typeof o!="number"&&o&&!o.da){var u=o.src;if(u&&u[Tt])po(u.i,o);else{var f=o.type,p=o.proxy;u.removeEventListener?u.removeEventListener(f,p,o.capture):u.detachEvent?u.detachEvent(Hc(f),p):u.addListener&&u.removeListener&&u.removeListener(p),(f=vo(u))?(po(f,o),f.h==0&&(f.src=null,u[go]=null)):Os(o)}}}function Hc(o){return o in _o?_o[o]:_o[o]="on"+o}function jp(o,u){if(o.da)o=!0;else{u=new oe(u,this);const f=o.listener,p=o.ha||o.src;o.fa&&yo(o),o=f.call(p,u)}return o}function vo(o){return o=o[go],o instanceof Ls?o:null}var Eo="__closure_events_fn_"+(Math.random()*1e9>>>0);function Wc(o){return typeof o=="function"?o:(o[Eo]||(o[Eo]=function(u){return o.handleEvent(u)}),o[Eo])}function Re(){I.call(this),this.i=new Ls(this),this.M=this,this.G=null}m(Re,I),Re.prototype[Tt]=!0,Re.prototype.removeEventListener=function(o,u,f,p){zc(this,o,u,f,p)};function Oe(o,u){var f,p=o.G;if(p)for(f=[];p;p=p.G)f.push(p);if(o=o.M,p=u.type||u,typeof u=="string")u=new E(u,o);else if(u instanceof E)u.target=u.target||o;else{var R=u;u=new E(p,o),qc(u,R)}R=!0;let b,D;if(f)for(D=f.length-1;D>=0;D--)b=u.g=f[D],R=xs(b,p,!0,u)&&R;if(b=u.g=o,R=xs(b,p,!0,u)&&R,R=xs(b,p,!1,u)&&R,f)for(D=0;D<f.length;D++)b=u.g=f[D],R=xs(b,p,!1,u)&&R}Re.prototype.N=function(){if(Re.Z.N.call(this),this.i){var o=this.i;for(const u in o.g){const f=o.g[u];for(let p=0;p<f.length;p++)Os(f[p]);delete o.g[u],o.h--}}this.G=null},Re.prototype.J=function(o,u,f,p){return this.i.add(String(o),u,!1,f,p)},Re.prototype.K=function(o,u,f,p){return this.i.add(String(o),u,!0,f,p)};function xs(o,u,f,p){if(u=o.i.g[String(u)],!u)return!0;u=u.concat();let R=!0;for(let b=0;b<u.length;++b){const D=u[b];if(D&&!D.da&&D.capture==f){const $=D.listener,pe=D.ha||D.src;D.fa&&po(o.i,D),R=$.call(pe,p)!==!1&&R}}return R&&!p.defaultPrevented}function qp(o,u){if(typeof o!="function")if(o&&typeof o.handleEvent=="function")o=h(o.handleEvent,o);else throw Error("Invalid listener argument");return Number(u)>2147483647?-1:a.setTimeout(o,u||0)}function Gc(o){o.g=qp(()=>{o.g=null,o.i&&(o.i=!1,Gc(o))},o.l);const u=o.h;o.h=null,o.m.apply(null,u)}class $p extends I{constructor(u,f){super(),this.m=u,this.l=f,this.h=null,this.i=!1,this.g=null}j(u){this.h=arguments,this.g?this.i=!0:Gc(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Cr(o){I.call(this),this.h=o,this.g={}}m(Cr,I);var Kc=[];function Qc(o){Ms(o.g,function(u,f){this.g.hasOwnProperty(f)&&yo(u)},o),o.g={}}Cr.prototype.N=function(){Cr.Z.N.call(this),Qc(this)},Cr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var To=a.JSON.stringify,zp=a.JSON.parse,Hp=class{stringify(o){return a.JSON.stringify(o,void 0)}parse(o){return a.JSON.parse(o,void 0)}};function Xc(){}function Yc(){}var kr={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Io(){E.call(this,"d")}m(Io,E);function wo(){E.call(this,"c")}m(wo,E);var fn={},Jc=null;function Fs(){return Jc=Jc||new Re}fn.Ia="serverreachability";function Zc(o){E.call(this,fn.Ia,o)}m(Zc,E);function Vr(o){const u=Fs();Oe(u,new Zc(u))}fn.STAT_EVENT="statevent";function eu(o,u){E.call(this,fn.STAT_EVENT,o),this.stat=u}m(eu,E);function Me(o){const u=Fs();Oe(u,new eu(u,o))}fn.Ja="timingevent";function tu(o,u){E.call(this,fn.Ja,o),this.size=u}m(tu,E);function Dr(o,u){if(typeof o!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){o()},u)}function Nr(){this.g=!0}Nr.prototype.ua=function(){this.g=!1};function Wp(o,u,f,p,R,b){o.info(function(){if(o.g)if(b){var D="",$=b.split("&");for(let ee=0;ee<$.length;ee++){var pe=$[ee].split("=");if(pe.length>1){const ve=pe[0];pe=pe[1];const it=ve.split("_");D=it.length>=2&&it[1]=="type"?D+(ve+"="+pe+"&"):D+(ve+"=redacted&")}}}else D=null;else D=b;return"XMLHTTP REQ ("+p+") [attempt "+R+"]: "+u+`
`+f+`
`+D})}function Gp(o,u,f,p,R,b,D){o.info(function(){return"XMLHTTP RESP ("+p+") [ attempt "+R+"]: "+u+`
`+f+`
`+b+" "+D})}function xn(o,u,f,p){o.info(function(){return"XMLHTTP TEXT ("+u+"): "+Qp(o,f)+(p?" "+p:"")})}function Kp(o,u){o.info(function(){return"TIMEOUT: "+u})}Nr.prototype.info=function(){};function Qp(o,u){if(!o.g)return u;if(!u)return null;try{const b=JSON.parse(u);if(b){for(o=0;o<b.length;o++)if(Array.isArray(b[o])){var f=b[o];if(!(f.length<2)){var p=f[1];if(Array.isArray(p)&&!(p.length<1)){var R=p[0];if(R!="noop"&&R!="stop"&&R!="close")for(let D=1;D<p.length;D++)p[D]=""}}}}return To(b)}catch{return u}}var Us={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},nu={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},ru;function Ao(){}m(Ao,Xc),Ao.prototype.g=function(){return new XMLHttpRequest},ru=new Ao;function Or(o){return encodeURIComponent(String(o))}function Xp(o){var u=1;o=o.split(":");const f=[];for(;u>0&&o.length;)f.push(o.shift()),u--;return o.length&&f.push(o.join(":")),f}function Lt(o,u,f,p){this.j=o,this.i=u,this.l=f,this.S=p||1,this.V=new Cr(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new su}function su(){this.i=null,this.g="",this.h=!1}var iu={},Ro={};function bo(o,u,f){o.M=1,o.A=js(st(u)),o.u=f,o.R=!0,ou(o,null)}function ou(o,u){o.F=Date.now(),Bs(o),o.B=st(o.A);var f=o.B,p=o.S;Array.isArray(p)||(p=[String(p)]),vu(f.i,"t",p),o.C=0,f=o.j.L,o.h=new su,o.g=xu(o.j,f?u:null,!o.u),o.P>0&&(o.O=new $p(h(o.Y,o,o.g),o.P)),u=o.V,f=o.g,p=o.ba;var R="readystatechange";Array.isArray(R)||(R&&(Kc[0]=R.toString()),R=Kc);for(let b=0;b<R.length;b++){const D=$c(f,R[b],p||u.handleEvent,!1,u.h||u);if(!D)break;u.g[D.key]=D}u=o.J?Bc(o.J):{},o.u?(o.v||(o.v="POST"),u["Content-Type"]="application/x-www-form-urlencoded",o.g.ea(o.B,o.v,o.u,u)):(o.v="GET",o.g.ea(o.B,o.v,null,u)),Vr(),Wp(o.i,o.v,o.B,o.l,o.S,o.u)}Lt.prototype.ba=function(o){o=o.target;const u=this.O;u&&Ut(o)==3?u.j():this.Y(o)},Lt.prototype.Y=function(o){try{if(o==this.g)e:{const $=Ut(this.g),pe=this.g.ya(),ee=this.g.ca();if(!($<3)&&($!=3||this.g&&(this.h.h||this.g.la()||bu(this.g)))){this.K||$!=4||pe==7||(pe==8||ee<=0?Vr(3):Vr(2)),So(this);var u=this.g.ca();this.X=u;var f=Yp(this);if(this.o=u==200,Gp(this.i,this.v,this.B,this.l,this.S,$,u),this.o){if(this.U&&!this.L){t:{if(this.g){var p,R=this.g;if((p=R.g?R.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!y(p)){var b=p;break t}}b=null}if(o=b)xn(this.i,this.l,o,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Po(this,o);else{this.o=!1,this.m=3,Me(12),dn(this),Mr(this);break e}}if(this.R){o=!0;let ve;for(;!this.K&&this.C<f.length;)if(ve=Jp(this,f),ve==Ro){$==4&&(this.m=4,Me(14),o=!1),xn(this.i,this.l,null,"[Incomplete Response]");break}else if(ve==iu){this.m=4,Me(15),xn(this.i,this.l,f,"[Invalid Chunk]"),o=!1;break}else xn(this.i,this.l,ve,null),Po(this,ve);if(au(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),$!=4||f.length!=0||this.h.h||(this.m=1,Me(16),o=!1),this.o=this.o&&o,!o)xn(this.i,this.l,f,"[Invalid Chunked Response]"),dn(this),Mr(this);else if(f.length>0&&!this.W){this.W=!0;var D=this.j;D.g==this&&D.aa&&!D.P&&(D.j.info("Great, no buffering proxy detected. Bytes received: "+f.length),Lo(D),D.P=!0,Me(11))}}else xn(this.i,this.l,f,null),Po(this,f);$==4&&dn(this),this.o&&!this.K&&($==4?Nu(this.j,this):(this.o=!1,Bs(this)))}else fm(this.g),u==400&&f.indexOf("Unknown SID")>0?(this.m=3,Me(12)):(this.m=0,Me(13)),dn(this),Mr(this)}}}catch{}finally{}};function Yp(o){if(!au(o))return o.g.la();const u=bu(o.g);if(u==="")return"";let f="";const p=u.length,R=Ut(o.g)==4;if(!o.h.i){if(typeof TextDecoder>"u")return dn(o),Mr(o),"";o.h.i=new a.TextDecoder}for(let b=0;b<p;b++)o.h.h=!0,f+=o.h.i.decode(u[b],{stream:!(R&&b==p-1)});return u.length=0,o.h.g+=f,o.C=0,o.h.g}function au(o){return o.g?o.v=="GET"&&o.M!=2&&o.j.Aa:!1}function Jp(o,u){var f=o.C,p=u.indexOf(`
`,f);return p==-1?Ro:(f=Number(u.substring(f,p)),isNaN(f)?iu:(p+=1,p+f>u.length?Ro:(u=u.slice(p,p+f),o.C=p+f,u)))}Lt.prototype.cancel=function(){this.K=!0,dn(this)};function Bs(o){o.T=Date.now()+o.H,cu(o,o.H)}function cu(o,u){if(o.D!=null)throw Error("WatchDog timer not null");o.D=Dr(h(o.aa,o),u)}function So(o){o.D&&(a.clearTimeout(o.D),o.D=null)}Lt.prototype.aa=function(){this.D=null;const o=Date.now();o-this.T>=0?(Kp(this.i,this.B),this.M!=2&&(Vr(),Me(17)),dn(this),this.m=2,Mr(this)):cu(this,this.T-o)};function Mr(o){o.j.I==0||o.K||Nu(o.j,o)}function dn(o){So(o);var u=o.O;u&&typeof u.dispose=="function"&&u.dispose(),o.O=null,Qc(o.V),o.g&&(u=o.g,o.g=null,u.abort(),u.dispose())}function Po(o,u){try{var f=o.j;if(f.I!=0&&(f.g==o||Co(f.h,o))){if(!o.L&&Co(f.h,o)&&f.I==3){try{var p=f.Ba.g.parse(u)}catch{p=null}if(Array.isArray(p)&&p.length==3){var R=p;if(R[0]==0){e:if(!f.v){if(f.g)if(f.g.F+3e3<o.F)Ws(f),zs(f);else break e;Mo(f),Me(18)}}else f.xa=R[1],0<f.xa-f.K&&R[2]<37500&&f.F&&f.A==0&&!f.C&&(f.C=Dr(h(f.Va,f),6e3));hu(f.h)<=1&&f.ta&&(f.ta=void 0)}else mn(f,11)}else if((o.L||f.g==o)&&Ws(f),!y(u))for(R=f.Ba.g.parse(u),u=0;u<R.length;u++){let ee=R[u];const ve=ee[0];if(!(ve<=f.K))if(f.K=ve,ee=ee[1],f.I==2)if(ee[0]=="c"){f.M=ee[1],f.ba=ee[2];const it=ee[3];it!=null&&(f.ka=it,f.j.info("VER="+f.ka));const gn=ee[4];gn!=null&&(f.za=gn,f.j.info("SVER="+f.za));const Bt=ee[5];Bt!=null&&typeof Bt=="number"&&Bt>0&&(p=1.5*Bt,f.O=p,f.j.info("backChannelRequestTimeoutMs_="+p)),p=f;const jt=o.g;if(jt){const Ks=jt.g?jt.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ks){var b=p.h;b.g||Ks.indexOf("spdy")==-1&&Ks.indexOf("quic")==-1&&Ks.indexOf("h2")==-1||(b.j=b.l,b.g=new Set,b.h&&(ko(b,b.h),b.h=null))}if(p.G){const xo=jt.g?jt.g.getResponseHeader("X-HTTP-Session-Id"):null;xo&&(p.wa=xo,ne(p.J,p.G,xo))}}f.I=3,f.l&&f.l.ra(),f.aa&&(f.T=Date.now()-o.F,f.j.info("Handshake RTT: "+f.T+"ms")),p=f;var D=o;if(p.na=Lu(p,p.L?p.ba:null,p.W),D.L){fu(p.h,D);var $=D,pe=p.O;pe&&($.H=pe),$.D&&(So($),Bs($)),p.g=D}else Vu(p);f.i.length>0&&Hs(f)}else ee[0]!="stop"&&ee[0]!="close"||mn(f,7);else f.I==3&&(ee[0]=="stop"||ee[0]=="close"?ee[0]=="stop"?mn(f,7):Oo(f):ee[0]!="noop"&&f.l&&f.l.qa(ee),f.A=0)}}Vr(4)}catch{}}var Zp=class{constructor(o,u){this.g=o,this.map=u}};function uu(o){this.l=o||10,a.PerformanceNavigationTiming?(o=a.performance.getEntriesByType("navigation"),o=o.length>0&&(o[0].nextHopProtocol=="hq"||o[0].nextHopProtocol=="h2")):o=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=o?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function lu(o){return o.h?!0:o.g?o.g.size>=o.j:!1}function hu(o){return o.h?1:o.g?o.g.size:0}function Co(o,u){return o.h?o.h==u:o.g?o.g.has(u):!1}function ko(o,u){o.g?o.g.add(u):o.h=u}function fu(o,u){o.h&&o.h==u?o.h=null:o.g&&o.g.has(u)&&o.g.delete(u)}uu.prototype.cancel=function(){if(this.i=du(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const o of this.g.values())o.cancel();this.g.clear()}};function du(o){if(o.h!=null)return o.i.concat(o.h.G);if(o.g!=null&&o.g.size!==0){let u=o.i;for(const f of o.g.values())u=u.concat(f.G);return u}return w(o.i)}var pu=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function em(o,u){if(o){o=o.split("&");for(let f=0;f<o.length;f++){const p=o[f].indexOf("=");let R,b=null;p>=0?(R=o[f].substring(0,p),b=o[f].substring(p+1)):R=o[f],u(R,b?decodeURIComponent(b.replace(/\+/g," ")):"")}}}function xt(o){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let u;o instanceof xt?(this.l=o.l,Lr(this,o.j),this.o=o.o,this.g=o.g,xr(this,o.u),this.h=o.h,Vo(this,Eu(o.i)),this.m=o.m):o&&(u=String(o).match(pu))?(this.l=!1,Lr(this,u[1]||"",!0),this.o=Fr(u[2]||""),this.g=Fr(u[3]||"",!0),xr(this,u[4]),this.h=Fr(u[5]||"",!0),Vo(this,u[6]||"",!0),this.m=Fr(u[7]||"")):(this.l=!1,this.i=new Br(null,this.l))}xt.prototype.toString=function(){const o=[];var u=this.j;u&&o.push(Ur(u,mu,!0),":");var f=this.g;return(f||u=="file")&&(o.push("//"),(u=this.o)&&o.push(Ur(u,mu,!0),"@"),o.push(Or(f).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f=this.u,f!=null&&o.push(":",String(f))),(f=this.h)&&(this.g&&f.charAt(0)!="/"&&o.push("/"),o.push(Ur(f,f.charAt(0)=="/"?rm:nm,!0))),(f=this.i.toString())&&o.push("?",f),(f=this.m)&&o.push("#",Ur(f,im)),o.join("")},xt.prototype.resolve=function(o){const u=st(this);let f=!!o.j;f?Lr(u,o.j):f=!!o.o,f?u.o=o.o:f=!!o.g,f?u.g=o.g:f=o.u!=null;var p=o.h;if(f)xr(u,o.u);else if(f=!!o.h){if(p.charAt(0)!="/")if(this.g&&!this.h)p="/"+p;else{var R=u.h.lastIndexOf("/");R!=-1&&(p=u.h.slice(0,R+1)+p)}if(R=p,R==".."||R==".")p="";else if(R.indexOf("./")!=-1||R.indexOf("/.")!=-1){p=R.lastIndexOf("/",0)==0,R=R.split("/");const b=[];for(let D=0;D<R.length;){const $=R[D++];$=="."?p&&D==R.length&&b.push(""):$==".."?((b.length>1||b.length==1&&b[0]!="")&&b.pop(),p&&D==R.length&&b.push("")):(b.push($),p=!0)}p=b.join("/")}else p=R}return f?u.h=p:f=o.i.toString()!=="",f?Vo(u,Eu(o.i)):f=!!o.m,f&&(u.m=o.m),u};function st(o){return new xt(o)}function Lr(o,u,f){o.j=f?Fr(u,!0):u,o.j&&(o.j=o.j.replace(/:$/,""))}function xr(o,u){if(u){if(u=Number(u),isNaN(u)||u<0)throw Error("Bad port number "+u);o.u=u}else o.u=null}function Vo(o,u,f){u instanceof Br?(o.i=u,om(o.i,o.l)):(f||(u=Ur(u,sm)),o.i=new Br(u,o.l))}function ne(o,u,f){o.i.set(u,f)}function js(o){return ne(o,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),o}function Fr(o,u){return o?u?decodeURI(o.replace(/%25/g,"%2525")):decodeURIComponent(o):""}function Ur(o,u,f){return typeof o=="string"?(o=encodeURI(o).replace(u,tm),f&&(o=o.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),o):null}function tm(o){return o=o.charCodeAt(0),"%"+(o>>4&15).toString(16)+(o&15).toString(16)}var mu=/[#\/\?@]/g,nm=/[#\?:]/g,rm=/[#\?]/g,sm=/[#\?@]/g,im=/#/g;function Br(o,u){this.h=this.g=null,this.i=o||null,this.j=!!u}function pn(o){o.g||(o.g=new Map,o.h=0,o.i&&em(o.i,function(u,f){o.add(decodeURIComponent(u.replace(/\+/g," ")),f)}))}n=Br.prototype,n.add=function(o,u){pn(this),this.i=null,o=Fn(this,o);let f=this.g.get(o);return f||this.g.set(o,f=[]),f.push(u),this.h+=1,this};function gu(o,u){pn(o),u=Fn(o,u),o.g.has(u)&&(o.i=null,o.h-=o.g.get(u).length,o.g.delete(u))}function _u(o,u){return pn(o),u=Fn(o,u),o.g.has(u)}n.forEach=function(o,u){pn(this),this.g.forEach(function(f,p){f.forEach(function(R){o.call(u,R,p,this)},this)},this)};function yu(o,u){pn(o);let f=[];if(typeof u=="string")_u(o,u)&&(f=f.concat(o.g.get(Fn(o,u))));else for(o=Array.from(o.g.values()),u=0;u<o.length;u++)f=f.concat(o[u]);return f}n.set=function(o,u){return pn(this),this.i=null,o=Fn(this,o),_u(this,o)&&(this.h-=this.g.get(o).length),this.g.set(o,[u]),this.h+=1,this},n.get=function(o,u){return o?(o=yu(this,o),o.length>0?String(o[0]):u):u};function vu(o,u,f){gu(o,u),f.length>0&&(o.i=null,o.g.set(Fn(o,u),w(f)),o.h+=f.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const o=[],u=Array.from(this.g.keys());for(let p=0;p<u.length;p++){var f=u[p];const R=Or(f);f=yu(this,f);for(let b=0;b<f.length;b++){let D=R;f[b]!==""&&(D+="="+Or(f[b])),o.push(D)}}return this.i=o.join("&")};function Eu(o){const u=new Br;return u.i=o.i,o.g&&(u.g=new Map(o.g),u.h=o.h),u}function Fn(o,u){return u=String(u),o.j&&(u=u.toLowerCase()),u}function om(o,u){u&&!o.j&&(pn(o),o.i=null,o.g.forEach(function(f,p){const R=p.toLowerCase();p!=R&&(gu(this,p),vu(this,R,f))},o)),o.j=u}function am(o,u){const f=new Nr;if(a.Image){const p=new Image;p.onload=d(Ft,f,"TestLoadImage: loaded",!0,u,p),p.onerror=d(Ft,f,"TestLoadImage: error",!1,u,p),p.onabort=d(Ft,f,"TestLoadImage: abort",!1,u,p),p.ontimeout=d(Ft,f,"TestLoadImage: timeout",!1,u,p),a.setTimeout(function(){p.ontimeout&&p.ontimeout()},1e4),p.src=o}else u(!1)}function cm(o,u){const f=new Nr,p=new AbortController,R=setTimeout(()=>{p.abort(),Ft(f,"TestPingServer: timeout",!1,u)},1e4);fetch(o,{signal:p.signal}).then(b=>{clearTimeout(R),b.ok?Ft(f,"TestPingServer: ok",!0,u):Ft(f,"TestPingServer: server error",!1,u)}).catch(()=>{clearTimeout(R),Ft(f,"TestPingServer: error",!1,u)})}function Ft(o,u,f,p,R){try{R&&(R.onload=null,R.onerror=null,R.onabort=null,R.ontimeout=null),p(f)}catch{}}function um(){this.g=new Hp}function Do(o){this.i=o.Sb||null,this.h=o.ab||!1}m(Do,Xc),Do.prototype.g=function(){return new qs(this.i,this.h)};function qs(o,u){Re.call(this),this.H=o,this.o=u,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}m(qs,Re),n=qs.prototype,n.open=function(o,u){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=o,this.D=u,this.readyState=1,qr(this)},n.send=function(o){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const u={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};o&&(u.body=o),(this.H||a).fetch(new Request(this.D,u)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,jr(this)),this.readyState=0},n.Pa=function(o){if(this.g&&(this.l=o,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=o.headers,this.readyState=2,qr(this)),this.g&&(this.readyState=3,qr(this),this.g)))if(this.responseType==="arraybuffer")o.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in o){if(this.j=o.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Tu(this)}else o.text().then(this.Oa.bind(this),this.ga.bind(this))};function Tu(o){o.j.read().then(o.Ma.bind(o)).catch(o.ga.bind(o))}n.Ma=function(o){if(this.g){if(this.o&&o.value)this.response.push(o.value);else if(!this.o){var u=o.value?o.value:new Uint8Array(0);(u=this.B.decode(u,{stream:!o.done}))&&(this.response=this.responseText+=u)}o.done?jr(this):qr(this),this.readyState==3&&Tu(this)}},n.Oa=function(o){this.g&&(this.response=this.responseText=o,jr(this))},n.Na=function(o){this.g&&(this.response=o,jr(this))},n.ga=function(){this.g&&jr(this)};function jr(o){o.readyState=4,o.l=null,o.j=null,o.B=null,qr(o)}n.setRequestHeader=function(o,u){this.A.append(o,u)},n.getResponseHeader=function(o){return this.h&&this.h.get(o.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const o=[],u=this.h.entries();for(var f=u.next();!f.done;)f=f.value,o.push(f[0]+": "+f[1]),f=u.next();return o.join(`\r
`)};function qr(o){o.onreadystatechange&&o.onreadystatechange.call(o)}Object.defineProperty(qs.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(o){this.m=o?"include":"same-origin"}});function Iu(o){let u="";return Ms(o,function(f,p){u+=p,u+=":",u+=f,u+=`\r
`}),u}function No(o,u,f){e:{for(p in f){var p=!1;break e}p=!0}p||(f=Iu(f),typeof o=="string"?f!=null&&Or(f):ne(o,u,f))}function ce(o){Re.call(this),this.headers=new Map,this.L=o||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}m(ce,Re);var lm=/^https?$/i,hm=["POST","PUT"];n=ce.prototype,n.Fa=function(o){this.H=o},n.ea=function(o,u,f,p){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+o);u=u?u.toUpperCase():"GET",this.D=o,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():ru.g(),this.g.onreadystatechange=g(h(this.Ca,this));try{this.B=!0,this.g.open(u,String(o),!0),this.B=!1}catch(b){wu(this,b);return}if(o=f||"",f=new Map(this.headers),p)if(Object.getPrototypeOf(p)===Object.prototype)for(var R in p)f.set(R,p[R]);else if(typeof p.keys=="function"&&typeof p.get=="function")for(const b of p.keys())f.set(b,p.get(b));else throw Error("Unknown input type for opt_headers: "+String(p));p=Array.from(f.keys()).find(b=>b.toLowerCase()=="content-type"),R=a.FormData&&o instanceof a.FormData,!(Array.prototype.indexOf.call(hm,u,void 0)>=0)||p||R||f.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[b,D]of f)this.g.setRequestHeader(b,D);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(o),this.v=!1}catch(b){wu(this,b)}};function wu(o,u){o.h=!1,o.g&&(o.j=!0,o.g.abort(),o.j=!1),o.l=u,o.o=5,Au(o),$s(o)}function Au(o){o.A||(o.A=!0,Oe(o,"complete"),Oe(o,"error"))}n.abort=function(o){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=o||7,Oe(this,"complete"),Oe(this,"abort"),$s(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),$s(this,!0)),ce.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?Ru(this):this.Xa())},n.Xa=function(){Ru(this)};function Ru(o){if(o.h&&typeof i<"u"){if(o.v&&Ut(o)==4)setTimeout(o.Ca.bind(o),0);else if(Oe(o,"readystatechange"),Ut(o)==4){o.h=!1;try{const b=o.ca();e:switch(b){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var u=!0;break e;default:u=!1}var f;if(!(f=u)){var p;if(p=b===0){let D=String(o.D).match(pu)[1]||null;!D&&a.self&&a.self.location&&(D=a.self.location.protocol.slice(0,-1)),p=!lm.test(D?D.toLowerCase():"")}f=p}if(f)Oe(o,"complete"),Oe(o,"success");else{o.o=6;try{var R=Ut(o)>2?o.g.statusText:""}catch{R=""}o.l=R+" ["+o.ca()+"]",Au(o)}}finally{$s(o)}}}}function $s(o,u){if(o.g){o.m&&(clearTimeout(o.m),o.m=null);const f=o.g;o.g=null,u||Oe(o,"ready");try{f.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function Ut(o){return o.g?o.g.readyState:0}n.ca=function(){try{return Ut(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(o){if(this.g){var u=this.g.responseText;return o&&u.indexOf(o)==0&&(u=u.substring(o.length)),zp(u)}};function bu(o){try{if(!o.g)return null;if("response"in o.g)return o.g.response;switch(o.F){case"":case"text":return o.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in o.g)return o.g.mozResponseArrayBuffer}return null}catch{return null}}function fm(o){const u={};o=(o.g&&Ut(o)>=2&&o.g.getAllResponseHeaders()||"").split(`\r
`);for(let p=0;p<o.length;p++){if(y(o[p]))continue;var f=Xp(o[p]);const R=f[0];if(f=f[1],typeof f!="string")continue;f=f.trim();const b=u[R]||[];u[R]=b,b.push(f)}Fp(u,function(p){return p.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function $r(o,u,f){return f&&f.internalChannelParams&&f.internalChannelParams[o]||u}function Su(o){this.za=0,this.i=[],this.j=new Nr,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=$r("failFast",!1,o),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=$r("baseRetryDelayMs",5e3,o),this.Za=$r("retryDelaySeedMs",1e4,o),this.Ta=$r("forwardChannelMaxRetries",2,o),this.va=$r("forwardChannelRequestTimeoutMs",2e4,o),this.ma=o&&o.xmlHttpFactory||void 0,this.Ua=o&&o.Rb||void 0,this.Aa=o&&o.useFetchStreams||!1,this.O=void 0,this.L=o&&o.supportsCrossDomainXhr||!1,this.M="",this.h=new uu(o&&o.concurrentRequestLimit),this.Ba=new um,this.S=o&&o.fastHandshake||!1,this.R=o&&o.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=o&&o.Pb||!1,o&&o.ua&&this.j.ua(),o&&o.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&o&&o.detectBufferingProxy||!1,this.ia=void 0,o&&o.longPollingTimeout&&o.longPollingTimeout>0&&(this.ia=o.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Su.prototype,n.ka=8,n.I=1,n.connect=function(o,u,f,p){Me(0),this.W=o,this.H=u||{},f&&p!==void 0&&(this.H.OSID=f,this.H.OAID=p),this.F=this.X,this.J=Lu(this,null,this.W),Hs(this)};function Oo(o){if(Pu(o),o.I==3){var u=o.V++,f=st(o.J);if(ne(f,"SID",o.M),ne(f,"RID",u),ne(f,"TYPE","terminate"),zr(o,f),u=new Lt(o,o.j,u),u.M=2,u.A=js(st(f)),f=!1,a.navigator&&a.navigator.sendBeacon)try{f=a.navigator.sendBeacon(u.A.toString(),"")}catch{}!f&&a.Image&&(new Image().src=u.A,f=!0),f||(u.g=xu(u.j,null),u.g.ea(u.A)),u.F=Date.now(),Bs(u)}Mu(o)}function zs(o){o.g&&(Lo(o),o.g.cancel(),o.g=null)}function Pu(o){zs(o),o.v&&(a.clearTimeout(o.v),o.v=null),Ws(o),o.h.cancel(),o.m&&(typeof o.m=="number"&&a.clearTimeout(o.m),o.m=null)}function Hs(o){if(!lu(o.h)&&!o.m){o.m=!0;var u=o.Ea;te||_(),Z||(te(),Z=!0),T.add(u,o),o.D=0}}function dm(o,u){return hu(o.h)>=o.h.j-(o.m?1:0)?!1:o.m?(o.i=u.G.concat(o.i),!0):o.I==1||o.I==2||o.D>=(o.Sa?0:o.Ta)?!1:(o.m=Dr(h(o.Ea,o,u),Ou(o,o.D)),o.D++,!0)}n.Ea=function(o){if(this.m)if(this.m=null,this.I==1){if(!o){this.V=Math.floor(Math.random()*1e5),o=this.V++;const R=new Lt(this,this.j,o);let b=this.o;if(this.U&&(b?(b=Bc(b),qc(b,this.U)):b=this.U),this.u!==null||this.R||(R.J=b,b=null),this.S)e:{for(var u=0,f=0;f<this.i.length;f++){t:{var p=this.i[f];if("__data__"in p.map&&(p=p.map.__data__,typeof p=="string")){p=p.length;break t}p=void 0}if(p===void 0)break;if(u+=p,u>4096){u=f;break e}if(u===4096||f===this.i.length-1){u=f+1;break e}}u=1e3}else u=1e3;u=ku(this,R,u),f=st(this.J),ne(f,"RID",o),ne(f,"CVER",22),this.G&&ne(f,"X-HTTP-Session-Id",this.G),zr(this,f),b&&(this.R?u="headers="+Or(Iu(b))+"&"+u:this.u&&No(f,this.u,b)),ko(this.h,R),this.Ra&&ne(f,"TYPE","init"),this.S?(ne(f,"$req",u),ne(f,"SID","null"),R.U=!0,bo(R,f,null)):bo(R,f,u),this.I=2}}else this.I==3&&(o?Cu(this,o):this.i.length==0||lu(this.h)||Cu(this))};function Cu(o,u){var f;u?f=u.l:f=o.V++;const p=st(o.J);ne(p,"SID",o.M),ne(p,"RID",f),ne(p,"AID",o.K),zr(o,p),o.u&&o.o&&No(p,o.u,o.o),f=new Lt(o,o.j,f,o.D+1),o.u===null&&(f.J=o.o),u&&(o.i=u.G.concat(o.i)),u=ku(o,f,1e3),f.H=Math.round(o.va*.5)+Math.round(o.va*.5*Math.random()),ko(o.h,f),bo(f,p,u)}function zr(o,u){o.H&&Ms(o.H,function(f,p){ne(u,p,f)}),o.l&&Ms({},function(f,p){ne(u,p,f)})}function ku(o,u,f){f=Math.min(o.i.length,f);const p=o.l?h(o.l.Ka,o.l,o):null;e:{var R=o.i;let $=-1;for(;;){const pe=["count="+f];$==-1?f>0?($=R[0].g,pe.push("ofs="+$)):$=0:pe.push("ofs="+$);let ee=!0;for(let ve=0;ve<f;ve++){var b=R[ve].g;const it=R[ve].map;if(b-=$,b<0)$=Math.max(0,R[ve].g-100),ee=!1;else try{b="req"+b+"_"||"";try{var D=it instanceof Map?it:Object.entries(it);for(const[gn,Bt]of D){let jt=Bt;c(Bt)&&(jt=To(Bt)),pe.push(b+gn+"="+encodeURIComponent(jt))}}catch(gn){throw pe.push(b+"type="+encodeURIComponent("_badmap")),gn}}catch{p&&p(it)}}if(ee){D=pe.join("&");break e}}D=void 0}return o=o.i.splice(0,f),u.G=o,D}function Vu(o){if(!o.g&&!o.v){o.Y=1;var u=o.Da;te||_(),Z||(te(),Z=!0),T.add(u,o),o.A=0}}function Mo(o){return o.g||o.v||o.A>=3?!1:(o.Y++,o.v=Dr(h(o.Da,o),Ou(o,o.A)),o.A++,!0)}n.Da=function(){if(this.v=null,Du(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var o=4*this.T;this.j.info("BP detection timer enabled: "+o),this.B=Dr(h(this.Wa,this),o)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Me(10),zs(this),Du(this))};function Lo(o){o.B!=null&&(a.clearTimeout(o.B),o.B=null)}function Du(o){o.g=new Lt(o,o.j,"rpc",o.Y),o.u===null&&(o.g.J=o.o),o.g.P=0;var u=st(o.na);ne(u,"RID","rpc"),ne(u,"SID",o.M),ne(u,"AID",o.K),ne(u,"CI",o.F?"0":"1"),!o.F&&o.ia&&ne(u,"TO",o.ia),ne(u,"TYPE","xmlhttp"),zr(o,u),o.u&&o.o&&No(u,o.u,o.o),o.O&&(o.g.H=o.O);var f=o.g;o=o.ba,f.M=1,f.A=js(st(u)),f.u=null,f.R=!0,ou(f,o)}n.Va=function(){this.C!=null&&(this.C=null,zs(this),Mo(this),Me(19))};function Ws(o){o.C!=null&&(a.clearTimeout(o.C),o.C=null)}function Nu(o,u){var f=null;if(o.g==u){Ws(o),Lo(o),o.g=null;var p=2}else if(Co(o.h,u))f=u.G,fu(o.h,u),p=1;else return;if(o.I!=0){if(u.o)if(p==1){f=u.u?u.u.length:0,u=Date.now()-u.F;var R=o.D;p=Fs(),Oe(p,new tu(p,f)),Hs(o)}else Vu(o);else if(R=u.m,R==3||R==0&&u.X>0||!(p==1&&dm(o,u)||p==2&&Mo(o)))switch(f&&f.length>0&&(u=o.h,u.i=u.i.concat(f)),R){case 1:mn(o,5);break;case 4:mn(o,10);break;case 3:mn(o,6);break;default:mn(o,2)}}}function Ou(o,u){let f=o.Qa+Math.floor(Math.random()*o.Za);return o.isActive()||(f*=2),f*u}function mn(o,u){if(o.j.info("Error code "+u),u==2){var f=h(o.bb,o),p=o.Ua;const R=!p;p=new xt(p||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Lr(p,"https"),js(p),R?am(p.toString(),f):cm(p.toString(),f)}else Me(2);o.I=0,o.l&&o.l.pa(u),Mu(o),Pu(o)}n.bb=function(o){o?(this.j.info("Successfully pinged google.com"),Me(2)):(this.j.info("Failed to ping google.com"),Me(1))};function Mu(o){if(o.I=0,o.ja=[],o.l){const u=du(o.h);(u.length!=0||o.i.length!=0)&&(S(o.ja,u),S(o.ja,o.i),o.h.i.length=0,w(o.i),o.i.length=0),o.l.oa()}}function Lu(o,u,f){var p=f instanceof xt?st(f):new xt(f);if(p.g!="")u&&(p.g=u+"."+p.g),xr(p,p.u);else{var R=a.location;p=R.protocol,u=u?u+"."+R.hostname:R.hostname,R=+R.port;const b=new xt(null);p&&Lr(b,p),u&&(b.g=u),R&&xr(b,R),f&&(b.h=f),p=b}return f=o.G,u=o.wa,f&&u&&ne(p,f,u),ne(p,"VER",o.ka),zr(o,p),p}function xu(o,u,f){if(u&&!o.L)throw Error("Can't create secondary domain capable XhrIo object.");return u=o.Aa&&!o.ma?new ce(new Do({ab:f})):new ce(o.ma),u.Fa(o.L),u}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Fu(){}n=Fu.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Gs(){}Gs.prototype.g=function(o,u){return new ze(o,u)};function ze(o,u){Re.call(this),this.g=new Su(u),this.l=o,this.h=u&&u.messageUrlParams||null,o=u&&u.messageHeaders||null,u&&u.clientProtocolHeaderRequired&&(o?o["X-Client-Protocol"]="webchannel":o={"X-Client-Protocol":"webchannel"}),this.g.o=o,o=u&&u.initMessageHeaders||null,u&&u.messageContentType&&(o?o["X-WebChannel-Content-Type"]=u.messageContentType:o={"X-WebChannel-Content-Type":u.messageContentType}),u&&u.sa&&(o?o["X-WebChannel-Client-Profile"]=u.sa:o={"X-WebChannel-Client-Profile":u.sa}),this.g.U=o,(o=u&&u.Qb)&&!y(o)&&(this.g.u=o),this.A=u&&u.supportsCrossDomainXhr||!1,this.v=u&&u.sendRawJson||!1,(u=u&&u.httpSessionIdParam)&&!y(u)&&(this.g.G=u,o=this.h,o!==null&&u in o&&(o=this.h,u in o&&delete o[u])),this.j=new Un(this)}m(ze,Re),ze.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},ze.prototype.close=function(){Oo(this.g)},ze.prototype.o=function(o){var u=this.g;if(typeof o=="string"){var f={};f.__data__=o,o=f}else this.v&&(f={},f.__data__=To(o),o=f);u.i.push(new Zp(u.Ya++,o)),u.I==3&&Hs(u)},ze.prototype.N=function(){this.g.l=null,delete this.j,Oo(this.g),delete this.g,ze.Z.N.call(this)};function Uu(o){Io.call(this),o.__headers__&&(this.headers=o.__headers__,this.statusCode=o.__status__,delete o.__headers__,delete o.__status__);var u=o.__sm__;if(u){e:{for(const f in u){o=f;break e}o=void 0}(this.i=o)&&(o=this.i,u=u!==null&&o in u?u[o]:void 0),this.data=u}else this.data=o}m(Uu,Io);function Bu(){wo.call(this),this.status=1}m(Bu,wo);function Un(o){this.g=o}m(Un,Fu),Un.prototype.ra=function(){Oe(this.g,"a")},Un.prototype.qa=function(o){Oe(this.g,new Uu(o))},Un.prototype.pa=function(o){Oe(this.g,new Bu)},Un.prototype.oa=function(){Oe(this.g,"b")},Gs.prototype.createWebChannel=Gs.prototype.g,ze.prototype.send=ze.prototype.o,ze.prototype.open=ze.prototype.m,ze.prototype.close=ze.prototype.close,Mf=function(){return new Gs},Of=function(){return Fs()},Nf=fn,fa={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Us.NO_ERROR=0,Us.TIMEOUT=8,Us.HTTP_ERROR=6,ii=Us,nu.COMPLETE="complete",Df=nu,Yc.EventType=kr,kr.OPEN="a",kr.CLOSE="b",kr.ERROR="c",kr.MESSAGE="d",Re.prototype.listen=Re.prototype.J,Wr=Yc,ce.prototype.listenOnce=ce.prototype.K,ce.prototype.getLastError=ce.prototype.Ha,ce.prototype.getLastErrorCode=ce.prototype.ya,ce.prototype.getStatus=ce.prototype.ca,ce.prototype.getResponseJson=ce.prototype.La,ce.prototype.getResponseText=ce.prototype.la,ce.prototype.send=ce.prototype.ea,ce.prototype.setWithCredentials=ce.prototype.Fa,Vf=ce}).apply(typeof Ys<"u"?Ys:typeof self<"u"?self:typeof window<"u"?window:{});const hl="@firebase/firestore",fl="4.9.2";class Pe{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Pe.UNAUTHENTICATED=new Pe(null),Pe.GOOGLE_CREDENTIALS=new Pe("google-credentials-uid"),Pe.FIRST_PARTY=new Pe("first-party-uid"),Pe.MOCK_USER=new Pe("mock-user");let Ar="12.3.0";const kn=new Wa("@firebase/firestore");function qn(){return kn.logLevel}function O(n,...e){if(kn.logLevel<=H.DEBUG){const t=e.map(Qa);kn.debug(`Firestore (${Ar}): ${n}`,...t)}}function Pt(n,...e){if(kn.logLevel<=H.ERROR){const t=e.map(Qa);kn.error(`Firestore (${Ar}): ${n}`,...t)}}function ur(n,...e){if(kn.logLevel<=H.WARN){const t=e.map(Qa);kn.warn(`Firestore (${Ar}): ${n}`,...t)}}function Qa(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function U(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,Lf(n,r,t)}function Lf(n,e,t){let r=`FIRESTORE (${Ar}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw Pt(r),new Error(r)}function J(n,e,t,r){let s="Unexpected state";typeof t=="string"?s=t:r=t,n||Lf(e,s,r)}function q(n,e){return n}const V={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class L extends Mt{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class wn{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class xf{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Py{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Pe.UNAUTHENTICATED)))}shutdown(){}}class Cy{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class ky{constructor(e){this.t=e,this.currentUser=Pe.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){J(this.o===void 0,42304);let r=this.i;const s=l=>this.i!==r?(r=this.i,t(l)):Promise.resolve();let i=new wn;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new wn,e.enqueueRetryable((()=>s(this.currentUser)))};const a=()=>{const l=i;e.enqueueRetryable((async()=>{await l.promise,await s(this.currentUser)}))},c=l=>{O("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit((l=>c(l))),setTimeout((()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?c(l):(O("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new wn)}}),0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((r=>this.i!==e?(O("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(J(typeof r.accessToken=="string",31837,{l:r}),new xf(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return J(e===null||typeof e=="string",2055,{h:e}),new Pe(e)}}class Vy{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=Pe.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class Dy{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new Vy(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(Pe.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class dl{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Ny{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Ze(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){J(this.o===void 0,3512);const r=i=>{i.error!=null&&O("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const a=i.token!==this.m;return this.m=i.token,O("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable((()=>r(i)))};const s=i=>{O("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((i=>s(i))),setTimeout((()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):O("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new dl(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(J(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new dl(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function Oy(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}class Xa{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=Oy(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<t&&(r+=e.charAt(s[i]%62))}return r}}function W(n,e){return n<e?-1:n>e?1:0}function da(n,e){const t=Math.min(n.length,e.length);for(let r=0;r<t;r++){const s=n.charAt(r),i=e.charAt(r);if(s!==i)return Wo(s)===Wo(i)?W(s,i):Wo(s)?1:-1}return W(n.length,e.length)}const My=55296,Ly=57343;function Wo(n){const e=n.charCodeAt(0);return e>=My&&e<=Ly}function lr(n,e,t){return n.length===e.length&&n.every(((r,s)=>t(r,e[s])))}const pl="__name__";class at{constructor(e,t,r){t===void 0?t=0:t>e.length&&U(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&U(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return at.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof at?e.forEach((r=>{t.push(r)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let s=0;s<r;s++){const i=at.compareSegments(e.get(s),t.get(s));if(i!==0)return i}return W(e.length,t.length)}static compareSegments(e,t){const r=at.isNumericId(e),s=at.isNumericId(t);return r&&!s?-1:!r&&s?1:r&&s?at.extractNumericId(e).compare(at.extractNumericId(t)):da(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return en.fromString(e.substring(4,e.length-2))}}class se extends at{construct(e,t,r){return new se(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new L(V.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter((s=>s.length>0)))}return new se(t)}static emptyPath(){return new se([])}}const xy=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ie extends at{construct(e,t,r){return new Ie(e,t,r)}static isValidIdentifier(e){return xy.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ie.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===pl}static keyField(){return new Ie([pl])}static fromServerFormat(e){const t=[];let r="",s=0;const i=()=>{if(r.length===0)throw new L(V.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let a=!1;for(;s<e.length;){const c=e[s];if(c==="\\"){if(s+1===e.length)throw new L(V.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new L(V.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,s+=2}else c==="`"?(a=!a,s++):c!=="."||a?(r+=c,s++):(i(),s++)}if(i(),a)throw new L(V.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ie(t)}static emptyPath(){return new Ie([])}}class F{constructor(e){this.path=e}static fromPath(e){return new F(se.fromString(e))}static fromName(e){return new F(se.fromString(e).popFirst(5))}static empty(){return new F(se.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&se.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return se.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new F(new se(e.slice()))}}function Ff(n,e,t){if(!t)throw new L(V.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function Fy(n,e,t,r){if(e===!0&&r===!0)throw new L(V.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function ml(n){if(!F.isDocumentKey(n))throw new L(V.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function gl(n){if(F.isDocumentKey(n))throw new L(V.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Uf(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function Ya(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":U(12329,{type:typeof n})}function tn(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new L(V.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Ya(n);throw new L(V.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function de(n,e){const t={typeString:n};return e&&(t.value=e),t}function bs(n,e){if(!Uf(n))throw new L(V.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const s=e[r].typeString,i="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}const a=n[r];if(s&&typeof a!==s){t=`JSON field '${r}' must be a ${s}.`;break}if(i!==void 0&&a!==i.value){t=`Expected '${r}' field to equal '${i.value}'`;break}}if(t)throw new L(V.INVALID_ARGUMENT,t);return!0}const _l=-62135596800,yl=1e6;class ie{static now(){return ie.fromMillis(Date.now())}static fromDate(e){return ie.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*yl);return new ie(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new L(V.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new L(V.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<_l)throw new L(V.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new L(V.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/yl}_compareTo(e){return this.seconds===e.seconds?W(this.nanoseconds,e.nanoseconds):W(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:ie._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(bs(e,ie._jsonSchema))return new ie(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-_l;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}ie._jsonSchemaVersion="firestore/timestamp/1.0",ie._jsonSchema={type:de("string",ie._jsonSchemaVersion),seconds:de("number"),nanoseconds:de("number")};class j{static fromTimestamp(e){return new j(e)}static min(){return new j(new ie(0,0))}static max(){return new j(new ie(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const fs=-1;function Uy(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,s=j.fromTimestamp(r===1e9?new ie(t+1,0):new ie(t,r));return new rn(s,F.empty(),e)}function By(n){return new rn(n.readTime,n.key,fs)}class rn{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new rn(j.min(),F.empty(),fs)}static max(){return new rn(j.max(),F.empty(),fs)}}function jy(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=F.comparator(n.documentKey,e.documentKey),t!==0?t:W(n.largestBatchId,e.largestBatchId))}const qy="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class $y{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Rr(n){if(n.code!==V.FAILED_PRECONDITION||n.message!==qy)throw n;O("LocalStore","Unexpectedly lost primary lease")}class C{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&U(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new C(((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(t,i).next(r,s)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof C?t:C.resolve(t)}catch(t){return C.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):C.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):C.reject(t)}static resolve(e){return new C(((t,r)=>{t(e)}))}static reject(e){return new C(((t,r)=>{r(e)}))}static waitFor(e){return new C(((t,r)=>{let s=0,i=0,a=!1;e.forEach((c=>{++s,c.next((()=>{++i,a&&i===s&&t()}),(l=>r(l)))})),a=!0,i===s&&t()}))}static or(e){let t=C.resolve(!1);for(const r of e)t=t.next((s=>s?C.resolve(s):r()));return t}static forEach(e,t){const r=[];return e.forEach(((s,i)=>{r.push(t.call(this,s,i))})),this.waitFor(r)}static mapArray(e,t){return new C(((r,s)=>{const i=e.length,a=new Array(i);let c=0;for(let l=0;l<i;l++){const h=l;t(e[h]).next((d=>{a[h]=d,++c,c===i&&r(a)}),(d=>s(d)))}}))}static doWhile(e,t){return new C(((r,s)=>{const i=()=>{e()===!0?t().next((()=>{i()}),s):r()};i()}))}}function zy(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function br(n){return n.name==="IndexedDbTransactionError"}class Gi{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>t.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Gi.ce=-1;const Ja=-1;function Ki(n){return n==null}function Ti(n){return n===0&&1/n==-1/0}function Hy(n){return typeof n=="number"&&Number.isInteger(n)&&!Ti(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const Bf="";function Wy(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=vl(e)),e=Gy(n.get(t),e);return vl(e)}function Gy(n,e){let t=e;const r=n.length;for(let s=0;s<r;s++){const i=n.charAt(s);switch(i){case"\0":t+="";break;case Bf:t+="";break;default:t+=i}}return t}function vl(n){return n+Bf+""}function El(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function ln(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function jf(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class ae{constructor(e,t){this.comparator=e,this.root=t||Te.EMPTY}insert(e,t){return new ae(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Te.BLACK,null,null))}remove(e){return new ae(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Te.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return t+r.left.size;s<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,r)=>(e(t,r),!1)))}toString(){const e=[];return this.inorderTraversal(((t,r)=>(e.push(`${t}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Js(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Js(this.root,e,this.comparator,!1)}getReverseIterator(){return new Js(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Js(this.root,e,this.comparator,!0)}}class Js{constructor(e,t,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?r(e.key,t):1,t&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Te{constructor(e,t,r,s,i){this.key=e,this.value=t,this.color=r??Te.RED,this.left=s??Te.EMPTY,this.right=i??Te.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,s,i){return new Te(e??this.key,t??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,t,r),null):i===0?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Te.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),t(e,s.key)===0){if(s.right.isEmpty())return Te.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Te.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Te.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw U(43730,{key:this.key,value:this.value});if(this.right.isRed())throw U(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw U(27949);return e+(this.isRed()?0:1)}}Te.EMPTY=null,Te.RED=!0,Te.BLACK=!1;Te.EMPTY=new class{constructor(){this.size=0}get key(){throw U(57766)}get value(){throw U(16141)}get color(){throw U(16727)}get left(){throw U(29726)}get right(){throw U(36894)}copy(e,t,r,s,i){return this}insert(e,t,r){return new Te(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class ye{constructor(e){this.comparator=e,this.data=new ae(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,r)=>(e(t),!1)))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Tl(this.data.getIterator())}getIteratorFrom(e){return new Tl(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((r=>{t=t.add(r)})),t}isEqual(e){if(!(e instanceof ye)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new ye(this.comparator);return t.data=e,t}}class Tl{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Ge{constructor(e){this.fields=e,e.sort(Ie.comparator)}static empty(){return new Ge([])}unionWith(e){let t=new ye(Ie.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Ge(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return lr(this.fields,e.fields,((t,r)=>t.isEqual(r)))}}class qf extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Ae{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new qf("Invalid base64 string: "+i):i}})(e);return new Ae(t)}static fromUint8Array(e){const t=(function(s){let i="";for(let a=0;a<s.length;++a)i+=String.fromCharCode(s[a]);return i})(e);return new Ae(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const r=new Uint8Array(t.length);for(let s=0;s<t.length;s++)r[s]=t.charCodeAt(s);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return W(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ae.EMPTY_BYTE_STRING=new Ae("");const Ky=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function sn(n){if(J(!!n,39018),typeof n=="string"){let e=0;const t=Ky.exec(n);if(J(!!t,46558,{timestamp:n}),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:le(n.seconds),nanos:le(n.nanos)}}function le(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function on(n){return typeof n=="string"?Ae.fromBase64String(n):Ae.fromUint8Array(n)}const $f="server_timestamp",zf="__type__",Hf="__previous_value__",Wf="__local_write_time__";function Za(n){return(n?.mapValue?.fields||{})[zf]?.stringValue===$f}function Qi(n){const e=n.mapValue.fields[Hf];return Za(e)?Qi(e):e}function ds(n){const e=sn(n.mapValue.fields[Wf].timestampValue);return new ie(e.seconds,e.nanos)}class Qy{constructor(e,t,r,s,i,a,c,l,h,d){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=a,this.autoDetectLongPolling=c,this.longPollingOptions=l,this.useFetchStreams=h,this.isUsingEmulator=d}}const Ii="(default)";class ps{constructor(e,t){this.projectId=e,this.database=t||Ii}static empty(){return new ps("","")}get isDefaultDatabase(){return this.database===Ii}isEqual(e){return e instanceof ps&&e.projectId===this.projectId&&e.database===this.database}}const Gf="__type__",Xy="__max__",Zs={mapValue:{}},Kf="__vector__",wi="value";function an(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Za(n)?4:Jy(n)?9007199254740991:Yy(n)?10:11:U(28295,{value:n})}function yt(n,e){if(n===e)return!0;const t=an(n);if(t!==an(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return ds(n).isEqual(ds(e));case 3:return(function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const a=sn(s.timestampValue),c=sn(i.timestampValue);return a.seconds===c.seconds&&a.nanos===c.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(s,i){return on(s.bytesValue).isEqual(on(i.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(s,i){return le(s.geoPointValue.latitude)===le(i.geoPointValue.latitude)&&le(s.geoPointValue.longitude)===le(i.geoPointValue.longitude)})(n,e);case 2:return(function(s,i){if("integerValue"in s&&"integerValue"in i)return le(s.integerValue)===le(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const a=le(s.doubleValue),c=le(i.doubleValue);return a===c?Ti(a)===Ti(c):isNaN(a)&&isNaN(c)}return!1})(n,e);case 9:return lr(n.arrayValue.values||[],e.arrayValue.values||[],yt);case 10:case 11:return(function(s,i){const a=s.mapValue.fields||{},c=i.mapValue.fields||{};if(El(a)!==El(c))return!1;for(const l in a)if(a.hasOwnProperty(l)&&(c[l]===void 0||!yt(a[l],c[l])))return!1;return!0})(n,e);default:return U(52216,{left:n})}}function ms(n,e){return(n.values||[]).find((t=>yt(t,e)))!==void 0}function hr(n,e){if(n===e)return 0;const t=an(n),r=an(e);if(t!==r)return W(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return W(n.booleanValue,e.booleanValue);case 2:return(function(i,a){const c=le(i.integerValue||i.doubleValue),l=le(a.integerValue||a.doubleValue);return c<l?-1:c>l?1:c===l?0:isNaN(c)?isNaN(l)?0:-1:1})(n,e);case 3:return Il(n.timestampValue,e.timestampValue);case 4:return Il(ds(n),ds(e));case 5:return da(n.stringValue,e.stringValue);case 6:return(function(i,a){const c=on(i),l=on(a);return c.compareTo(l)})(n.bytesValue,e.bytesValue);case 7:return(function(i,a){const c=i.split("/"),l=a.split("/");for(let h=0;h<c.length&&h<l.length;h++){const d=W(c[h],l[h]);if(d!==0)return d}return W(c.length,l.length)})(n.referenceValue,e.referenceValue);case 8:return(function(i,a){const c=W(le(i.latitude),le(a.latitude));return c!==0?c:W(le(i.longitude),le(a.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return wl(n.arrayValue,e.arrayValue);case 10:return(function(i,a){const c=i.fields||{},l=a.fields||{},h=c[wi]?.arrayValue,d=l[wi]?.arrayValue,m=W(h?.values?.length||0,d?.values?.length||0);return m!==0?m:wl(h,d)})(n.mapValue,e.mapValue);case 11:return(function(i,a){if(i===Zs.mapValue&&a===Zs.mapValue)return 0;if(i===Zs.mapValue)return 1;if(a===Zs.mapValue)return-1;const c=i.fields||{},l=Object.keys(c),h=a.fields||{},d=Object.keys(h);l.sort(),d.sort();for(let m=0;m<l.length&&m<d.length;++m){const g=da(l[m],d[m]);if(g!==0)return g;const w=hr(c[l[m]],h[d[m]]);if(w!==0)return w}return W(l.length,d.length)})(n.mapValue,e.mapValue);default:throw U(23264,{he:t})}}function Il(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return W(n,e);const t=sn(n),r=sn(e),s=W(t.seconds,r.seconds);return s!==0?s:W(t.nanos,r.nanos)}function wl(n,e){const t=n.values||[],r=e.values||[];for(let s=0;s<t.length&&s<r.length;++s){const i=hr(t[s],r[s]);if(i)return i}return W(t.length,r.length)}function fr(n){return pa(n)}function pa(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const r=sn(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return on(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return F.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",s=!0;for(const i of t.values||[])s?s=!1:r+=",",r+=pa(i);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){const r=Object.keys(t.fields||{}).sort();let s="{",i=!0;for(const a of r)i?i=!1:s+=",",s+=`${a}:${pa(t.fields[a])}`;return s+"}"})(n.mapValue):U(61005,{value:n})}function oi(n){switch(an(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Qi(n);return e?16+oi(e):16;case 5:return 2*n.stringValue.length;case 6:return on(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((s,i)=>s+oi(i)),0)})(n.arrayValue);case 10:case 11:return(function(r){let s=0;return ln(r.fields,((i,a)=>{s+=i.length+oi(a)})),s})(n.mapValue);default:throw U(13486,{value:n})}}function ma(n){return!!n&&"integerValue"in n}function ec(n){return!!n&&"arrayValue"in n}function Al(n){return!!n&&"nullValue"in n}function Rl(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function ai(n){return!!n&&"mapValue"in n}function Yy(n){return(n?.mapValue?.fields||{})[Gf]?.stringValue===Kf}function ns(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return ln(n.mapValue.fields,((t,r)=>e.mapValue.fields[t]=ns(r))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=ns(n.arrayValue.values[t]);return e}return{...n}}function Jy(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===Xy}class Be{constructor(e){this.value=e}static empty(){return new Be({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!ai(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=ns(t)}setAll(e){let t=Ie.emptyPath(),r={},s=[];e.forEach(((a,c)=>{if(!t.isImmediateParentOf(c)){const l=this.getFieldsMap(t);this.applyChanges(l,r,s),r={},s=[],t=c.popLast()}a?r[c.lastSegment()]=ns(a):s.push(c.lastSegment())}));const i=this.getFieldsMap(t);this.applyChanges(i,r,s)}delete(e){const t=this.field(e.popLast());ai(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return yt(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=t.mapValue.fields[e.get(r)];ai(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,r){ln(t,((s,i)=>e[s]=i));for(const s of r)delete e[s]}clone(){return new Be(ns(this.value))}}function Qf(n){const e=[];return ln(n.fields,((t,r)=>{const s=new Ie([t]);if(ai(r)){const i=Qf(r.mapValue).fields;if(i.length===0)e.push(s);else for(const a of i)e.push(s.child(a))}else e.push(s)})),new Ge(e)}class Ce{constructor(e,t,r,s,i,a,c){this.key=e,this.documentType=t,this.version=r,this.readTime=s,this.createTime=i,this.data=a,this.documentState=c}static newInvalidDocument(e){return new Ce(e,0,j.min(),j.min(),j.min(),Be.empty(),0)}static newFoundDocument(e,t,r,s){return new Ce(e,1,t,j.min(),r,s,0)}static newNoDocument(e,t){return new Ce(e,2,t,j.min(),j.min(),Be.empty(),0)}static newUnknownDocument(e,t){return new Ce(e,3,t,j.min(),j.min(),Be.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(j.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Be.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Be.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=j.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Ce&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ce(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Ai{constructor(e,t){this.position=e,this.inclusive=t}}function bl(n,e,t){let r=0;for(let s=0;s<n.position.length;s++){const i=e[s],a=n.position[s];if(i.field.isKeyField()?r=F.comparator(F.fromName(a.referenceValue),t.key):r=hr(a,t.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function Sl(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!yt(n.position[t],e.position[t]))return!1;return!0}class Ri{constructor(e,t="asc"){this.field=e,this.dir=t}}function Zy(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class Xf{}class ge extends Xf{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new tv(e,t,r):t==="array-contains"?new sv(e,r):t==="in"?new iv(e,r):t==="not-in"?new ov(e,r):t==="array-contains-any"?new av(e,r):new ge(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new nv(e,r):new rv(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(hr(t,this.value)):t!==null&&an(this.value)===an(t)&&this.matchesComparison(hr(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return U(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class vt extends Xf{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new vt(e,t)}matches(e){return Yf(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Yf(n){return n.op==="and"}function Jf(n){return ev(n)&&Yf(n)}function ev(n){for(const e of n.filters)if(e instanceof vt)return!1;return!0}function ga(n){if(n instanceof ge)return n.field.canonicalString()+n.op.toString()+fr(n.value);if(Jf(n))return n.filters.map((e=>ga(e))).join(",");{const e=n.filters.map((t=>ga(t))).join(",");return`${n.op}(${e})`}}function Zf(n,e){return n instanceof ge?(function(r,s){return s instanceof ge&&r.op===s.op&&r.field.isEqual(s.field)&&yt(r.value,s.value)})(n,e):n instanceof vt?(function(r,s){return s instanceof vt&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce(((i,a,c)=>i&&Zf(a,s.filters[c])),!0):!1})(n,e):void U(19439)}function ed(n){return n instanceof ge?(function(t){return`${t.field.canonicalString()} ${t.op} ${fr(t.value)}`})(n):n instanceof vt?(function(t){return t.op.toString()+" {"+t.getFilters().map(ed).join(" ,")+"}"})(n):"Filter"}class tv extends ge{constructor(e,t,r){super(e,t,r),this.key=F.fromName(r.referenceValue)}matches(e){const t=F.comparator(e.key,this.key);return this.matchesComparison(t)}}class nv extends ge{constructor(e,t){super(e,"in",t),this.keys=td("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class rv extends ge{constructor(e,t){super(e,"not-in",t),this.keys=td("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function td(n,e){return(e.arrayValue?.values||[]).map((t=>F.fromName(t.referenceValue)))}class sv extends ge{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return ec(t)&&ms(t.arrayValue,this.value)}}class iv extends ge{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&ms(this.value.arrayValue,t)}}class ov extends ge{constructor(e,t){super(e,"not-in",t)}matches(e){if(ms(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!ms(this.value.arrayValue,t)}}class av extends ge{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!ec(t)||!t.arrayValue.values)&&t.arrayValue.values.some((r=>ms(this.value.arrayValue,r)))}}class cv{constructor(e,t=null,r=[],s=[],i=null,a=null,c=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=a,this.endAt=c,this.Te=null}}function Pl(n,e=null,t=[],r=[],s=null,i=null,a=null){return new cv(n,e,t,r,s,i,a)}function tc(n){const e=q(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((r=>ga(r))).join(","),t+="|ob:",t+=e.orderBy.map((r=>(function(i){return i.field.canonicalString()+i.dir})(r))).join(","),Ki(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((r=>fr(r))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((r=>fr(r))).join(",")),e.Te=t}return e.Te}function nc(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!Zy(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!Zf(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Sl(n.startAt,e.startAt)&&Sl(n.endAt,e.endAt)}function _a(n){return F.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}class Xi{constructor(e,t=null,r=[],s=[],i=null,a="F",c=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=a,this.startAt=c,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function uv(n,e,t,r,s,i,a,c){return new Xi(n,e,t,r,s,i,a,c)}function rc(n){return new Xi(n)}function Cl(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function lv(n){return n.collectionGroup!==null}function rs(n){const e=q(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),t.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let c=new ye(Ie.comparator);return a.filters.forEach((l=>{l.getFlattenedFilters().forEach((h=>{h.isInequality()&&(c=c.add(h.field))}))})),c})(e).forEach((i=>{t.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new Ri(i,r))})),t.has(Ie.keyField().canonicalString())||e.Ie.push(new Ri(Ie.keyField(),r))}return e.Ie}function ft(n){const e=q(n);return e.Ee||(e.Ee=hv(e,rs(n))),e.Ee}function hv(n,e){if(n.limitType==="F")return Pl(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((s=>{const i=s.dir==="desc"?"asc":"desc";return new Ri(s.field,i)}));const t=n.endAt?new Ai(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Ai(n.startAt.position,n.startAt.inclusive):null;return Pl(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function ya(n,e,t){return new Xi(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Yi(n,e){return nc(ft(n),ft(e))&&n.limitType===e.limitType}function nd(n){return`${tc(ft(n))}|lt:${n.limitType}`}function $n(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map((s=>ed(s))).join(", ")}]`),Ki(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map((s=>(function(a){return`${a.field.canonicalString()} (${a.dir})`})(s))).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map((s=>fr(s))).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map((s=>fr(s))).join(",")),`Target(${r})`})(ft(n))}; limitType=${n.limitType})`}function Ji(n,e){return e.isFoundDocument()&&(function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):F.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)})(n,e)&&(function(r,s){for(const i of rs(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0})(n,e)&&(function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0})(n,e)&&(function(r,s){return!(r.startAt&&!(function(a,c,l){const h=bl(a,c,l);return a.inclusive?h<=0:h<0})(r.startAt,rs(r),s)||r.endAt&&!(function(a,c,l){const h=bl(a,c,l);return a.inclusive?h>=0:h>0})(r.endAt,rs(r),s))})(n,e)}function fv(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function rd(n){return(e,t)=>{let r=!1;for(const s of rs(n)){const i=dv(s,e,t);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function dv(n,e,t){const r=n.field.isKeyField()?F.comparator(e.key,t.key):(function(i,a,c){const l=a.data.field(i),h=c.data.field(i);return l!==null&&h!==null?hr(l,h):U(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return U(19790,{direction:n.dir})}}class Mn{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[t]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){ln(this.inner,((t,r)=>{for(const[s,i]of r)e(s,i)}))}isEmpty(){return jf(this.inner)}size(){return this.innerSize}}const pv=new ae(F.comparator);function Ct(){return pv}const sd=new ae(F.comparator);function Gr(...n){let e=sd;for(const t of n)e=e.insert(t.key,t);return e}function id(n){let e=sd;return n.forEach(((t,r)=>e=e.insert(t,r.overlayedDocument))),e}function vn(){return ss()}function od(){return ss()}function ss(){return new Mn((n=>n.toString()),((n,e)=>n.isEqual(e)))}const mv=new ae(F.comparator),gv=new ye(F.comparator);function G(...n){let e=gv;for(const t of n)e=e.add(t);return e}const _v=new ye(W);function yv(){return _v}function sc(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ti(e)?"-0":e}}function ad(n){return{integerValue:""+n}}function vv(n,e){return Hy(e)?ad(e):sc(n,e)}class Zi{constructor(){this._=void 0}}function Ev(n,e,t){return n instanceof bi?(function(s,i){const a={fields:{[zf]:{stringValue:$f},[Wf]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&Za(i)&&(i=Qi(i)),i&&(a.fields[Hf]=i),{mapValue:a}})(t,e):n instanceof gs?ud(n,e):n instanceof _s?ld(n,e):(function(s,i){const a=cd(s,i),c=kl(a)+kl(s.Ae);return ma(a)&&ma(s.Ae)?ad(c):sc(s.serializer,c)})(n,e)}function Tv(n,e,t){return n instanceof gs?ud(n,e):n instanceof _s?ld(n,e):t}function cd(n,e){return n instanceof Si?(function(r){return ma(r)||(function(i){return!!i&&"doubleValue"in i})(r)})(e)?e:{integerValue:0}:null}class bi extends Zi{}class gs extends Zi{constructor(e){super(),this.elements=e}}function ud(n,e){const t=hd(e);for(const r of n.elements)t.some((s=>yt(s,r)))||t.push(r);return{arrayValue:{values:t}}}class _s extends Zi{constructor(e){super(),this.elements=e}}function ld(n,e){let t=hd(e);for(const r of n.elements)t=t.filter((s=>!yt(s,r)));return{arrayValue:{values:t}}}class Si extends Zi{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function kl(n){return le(n.integerValue||n.doubleValue)}function hd(n){return ec(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function Iv(n,e){return n.field.isEqual(e.field)&&(function(r,s){return r instanceof gs&&s instanceof gs||r instanceof _s&&s instanceof _s?lr(r.elements,s.elements,yt):r instanceof Si&&s instanceof Si?yt(r.Ae,s.Ae):r instanceof bi&&s instanceof bi})(n.transform,e.transform)}class wv{constructor(e,t){this.version=e,this.transformResults=t}}class tt{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new tt}static exists(e){return new tt(void 0,e)}static updateTime(e){return new tt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function ci(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class eo{}function fd(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new ic(n.key,tt.none()):new Ss(n.key,n.data,tt.none());{const t=n.data,r=Be.empty();let s=new ye(Ie.comparator);for(let i of e.fields)if(!s.has(i)){let a=t.field(i);a===null&&i.length>1&&(i=i.popLast(),a=t.field(i)),a===null?r.delete(i):r.set(i,a),s=s.add(i)}return new hn(n.key,r,new Ge(s.toArray()),tt.none())}}function Av(n,e,t){n instanceof Ss?(function(s,i,a){const c=s.value.clone(),l=Dl(s.fieldTransforms,i,a.transformResults);c.setAll(l),i.convertToFoundDocument(a.version,c).setHasCommittedMutations()})(n,e,t):n instanceof hn?(function(s,i,a){if(!ci(s.precondition,i))return void i.convertToUnknownDocument(a.version);const c=Dl(s.fieldTransforms,i,a.transformResults),l=i.data;l.setAll(dd(s)),l.setAll(c),i.convertToFoundDocument(a.version,l).setHasCommittedMutations()})(n,e,t):(function(s,i,a){i.convertToNoDocument(a.version).setHasCommittedMutations()})(0,e,t)}function is(n,e,t,r){return n instanceof Ss?(function(i,a,c,l){if(!ci(i.precondition,a))return c;const h=i.value.clone(),d=Nl(i.fieldTransforms,l,a);return h.setAll(d),a.convertToFoundDocument(a.version,h).setHasLocalMutations(),null})(n,e,t,r):n instanceof hn?(function(i,a,c,l){if(!ci(i.precondition,a))return c;const h=Nl(i.fieldTransforms,l,a),d=a.data;return d.setAll(dd(i)),d.setAll(h),a.convertToFoundDocument(a.version,d).setHasLocalMutations(),c===null?null:c.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map((m=>m.field)))})(n,e,t,r):(function(i,a,c){return ci(i.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):c})(n,e,t)}function Rv(n,e){let t=null;for(const r of n.fieldTransforms){const s=e.data.field(r.field),i=cd(r.transform,s||null);i!=null&&(t===null&&(t=Be.empty()),t.set(r.field,i))}return t||null}function Vl(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&lr(r,s,((i,a)=>Iv(i,a)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Ss extends eo{constructor(e,t,r,s=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class hn extends eo{constructor(e,t,r,s,i=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function dd(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}})),e}function Dl(n,e,t){const r=new Map;J(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let s=0;s<t.length;s++){const i=n[s],a=i.transform,c=e.data.field(i.field);r.set(i.field,Tv(a,c,t[s]))}return r}function Nl(n,e,t){const r=new Map;for(const s of n){const i=s.transform,a=t.data.field(s.field);r.set(s.field,Ev(i,a,e))}return r}class ic extends eo{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class bv extends eo{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Sv{constructor(e,t,r,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&Av(i,e,r[s])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=is(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=is(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=od();return this.mutations.forEach((s=>{const i=e.get(s.key),a=i.overlayedDocument;let c=this.applyToLocalView(a,i.mutatedFields);c=t.has(s.key)?null:c;const l=fd(a,c);l!==null&&r.set(s.key,l),a.isValidDocument()||a.convertToNoDocument(j.min())})),r}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),G())}isEqual(e){return this.batchId===e.batchId&&lr(this.mutations,e.mutations,((t,r)=>Vl(t,r)))&&lr(this.baseMutations,e.baseMutations,((t,r)=>Vl(t,r)))}}class oc{constructor(e,t,r,s){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=s}static from(e,t,r){J(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let s=(function(){return mv})();const i=e.mutations;for(let a=0;a<i.length;a++)s=s.insert(i[a].key,r[a].version);return new oc(e,t,r,s)}}class Pv{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class Cv{constructor(e,t){this.count=e,this.unchangedNames=t}}var fe,K;function kv(n){switch(n){case V.OK:return U(64938);case V.CANCELLED:case V.UNKNOWN:case V.DEADLINE_EXCEEDED:case V.RESOURCE_EXHAUSTED:case V.INTERNAL:case V.UNAVAILABLE:case V.UNAUTHENTICATED:return!1;case V.INVALID_ARGUMENT:case V.NOT_FOUND:case V.ALREADY_EXISTS:case V.PERMISSION_DENIED:case V.FAILED_PRECONDITION:case V.ABORTED:case V.OUT_OF_RANGE:case V.UNIMPLEMENTED:case V.DATA_LOSS:return!0;default:return U(15467,{code:n})}}function pd(n){if(n===void 0)return Pt("GRPC error has no .code"),V.UNKNOWN;switch(n){case fe.OK:return V.OK;case fe.CANCELLED:return V.CANCELLED;case fe.UNKNOWN:return V.UNKNOWN;case fe.DEADLINE_EXCEEDED:return V.DEADLINE_EXCEEDED;case fe.RESOURCE_EXHAUSTED:return V.RESOURCE_EXHAUSTED;case fe.INTERNAL:return V.INTERNAL;case fe.UNAVAILABLE:return V.UNAVAILABLE;case fe.UNAUTHENTICATED:return V.UNAUTHENTICATED;case fe.INVALID_ARGUMENT:return V.INVALID_ARGUMENT;case fe.NOT_FOUND:return V.NOT_FOUND;case fe.ALREADY_EXISTS:return V.ALREADY_EXISTS;case fe.PERMISSION_DENIED:return V.PERMISSION_DENIED;case fe.FAILED_PRECONDITION:return V.FAILED_PRECONDITION;case fe.ABORTED:return V.ABORTED;case fe.OUT_OF_RANGE:return V.OUT_OF_RANGE;case fe.UNIMPLEMENTED:return V.UNIMPLEMENTED;case fe.DATA_LOSS:return V.DATA_LOSS;default:return U(39323,{code:n})}}(K=fe||(fe={}))[K.OK=0]="OK",K[K.CANCELLED=1]="CANCELLED",K[K.UNKNOWN=2]="UNKNOWN",K[K.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",K[K.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",K[K.NOT_FOUND=5]="NOT_FOUND",K[K.ALREADY_EXISTS=6]="ALREADY_EXISTS",K[K.PERMISSION_DENIED=7]="PERMISSION_DENIED",K[K.UNAUTHENTICATED=16]="UNAUTHENTICATED",K[K.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",K[K.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",K[K.ABORTED=10]="ABORTED",K[K.OUT_OF_RANGE=11]="OUT_OF_RANGE",K[K.UNIMPLEMENTED=12]="UNIMPLEMENTED",K[K.INTERNAL=13]="INTERNAL",K[K.UNAVAILABLE=14]="UNAVAILABLE",K[K.DATA_LOSS=15]="DATA_LOSS";function Vv(){return new TextEncoder}const Dv=new en([4294967295,4294967295],0);function Ol(n){const e=Vv().encode(n),t=new kf;return t.update(e),new Uint8Array(t.digest())}function Ml(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new en([t,r],0),new en([s,i],0)]}class ac{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Kr(`Invalid padding: ${t}`);if(r<0)throw new Kr(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Kr(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Kr(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=en.fromNumber(this.ge)}ye(e,t,r){let s=e.add(t.multiply(en.fromNumber(r)));return s.compare(Dv)===1&&(s=new en([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=Ol(e),[r,s]=Ml(t);for(let i=0;i<this.hashCount;i++){const a=this.ye(r,s,i);if(!this.we(a))return!1}return!0}static create(e,t,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),a=new ac(i,s,t);return r.forEach((c=>a.insert(c))),a}insert(e){if(this.ge===0)return;const t=Ol(e),[r,s]=Ml(t);for(let i=0;i<this.hashCount;i++){const a=this.ye(r,s,i);this.Se(a)}}Se(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class Kr extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class to{constructor(e,t,r,s,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const s=new Map;return s.set(e,Ps.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new to(j.min(),s,new ae(W),Ct(),G())}}class Ps{constructor(e,t,r,s,i){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new Ps(r,t,G(),G(),G())}}class ui{constructor(e,t,r,s){this.be=e,this.removedTargetIds=t,this.key=r,this.De=s}}class md{constructor(e,t){this.targetId=e,this.Ce=t}}class gd{constructor(e,t,r=Ae.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=s}}class Ll{constructor(){this.ve=0,this.Fe=xl(),this.Me=Ae.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=G(),t=G(),r=G();return this.Fe.forEach(((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:r=r.add(s);break;default:U(38017,{changeType:i})}})),new Ps(this.Me,this.xe,e,t,r)}qe(){this.Oe=!1,this.Fe=xl()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,J(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class Nv{constructor(e){this.Ge=e,this.ze=new Map,this.je=Ct(),this.Je=ei(),this.He=ei(),this.Ye=new ae(W)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:U(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((r,s)=>{this.rt(s)&&t(s)}))}st(e){const t=e.targetId,r=e.Ce.count,s=this.ot(t);if(s){const i=s.target;if(_a(i))if(r===0){const a=new F(i.path);this.et(t,a,Ce.newNoDocument(a,j.min()))}else J(r===1,20013,{expectedCount:r});else{const a=this._t(t);if(a!==r){const c=this.ut(e),l=c?this.ct(c,e,a):1;if(l!==0){this.it(t);const h=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,h)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=t;let a,c;try{a=on(r).toUint8Array()}catch(l){if(l instanceof qf)return ur("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{c=new ac(a,s,i)}catch(l){return ur(l instanceof Kr?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return c.ge===0?null:c}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){const r=this.Ge.getRemoteKeysForTarget(t);let s=0;return r.forEach((i=>{const a=this.Ge.ht(),c=`projects/${a.projectId}/databases/${a.database}/documents/${i.path.canonicalString()}`;e.mightContain(c)||(this.et(t,i,null),s++)})),s}Tt(e){const t=new Map;this.ze.forEach(((i,a)=>{const c=this.ot(a);if(c){if(i.current&&_a(c.target)){const l=new F(c.target.path);this.It(l).has(a)||this.Et(a,l)||this.et(a,l,Ce.newNoDocument(l,e))}i.Be&&(t.set(a,i.ke()),i.qe())}}));let r=G();this.He.forEach(((i,a)=>{let c=!0;a.forEachWhile((l=>{const h=this.ot(l);return!h||h.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)})),c&&(r=r.add(i))})),this.je.forEach(((i,a)=>a.setReadTime(e)));const s=new to(e,t,this.Ye,this.je,r);return this.je=Ct(),this.Je=ei(),this.He=ei(),this.Ye=new ae(W),s}Xe(e,t){if(!this.rt(e))return;const r=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,r),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,t)?s.Qe(t,1):s.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new Ll,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new ye(W),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new ye(W),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||O("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Ll),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function ei(){return new ae(F.comparator)}function xl(){return new ae(F.comparator)}const Ov={asc:"ASCENDING",desc:"DESCENDING"},Mv={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Lv={and:"AND",or:"OR"};class xv{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function va(n,e){return n.useProto3Json||Ki(e)?e:{value:e}}function Pi(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function _d(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function Fv(n,e){return Pi(n,e.toTimestamp())}function dt(n){return J(!!n,49232),j.fromTimestamp((function(t){const r=sn(t);return new ie(r.seconds,r.nanos)})(n))}function cc(n,e){return Ea(n,e).canonicalString()}function Ea(n,e){const t=(function(s){return new se(["projects",s.projectId,"databases",s.database])})(n).child("documents");return e===void 0?t:t.child(e)}function yd(n){const e=se.fromString(n);return J(wd(e),10190,{key:e.toString()}),e}function Ta(n,e){return cc(n.databaseId,e.path)}function Go(n,e){const t=yd(e);if(t.get(1)!==n.databaseId.projectId)throw new L(V.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new L(V.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new F(Ed(t))}function vd(n,e){return cc(n.databaseId,e)}function Uv(n){const e=yd(n);return e.length===4?se.emptyPath():Ed(e)}function Ia(n){return new se(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Ed(n){return J(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function Fl(n,e,t){return{name:Ta(n,e),fields:t.value.mapValue.fields}}function Bv(n,e){let t;if("targetChange"in e){e.targetChange;const r=(function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:U(39313,{state:h})})(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=(function(h,d){return h.useProto3Json?(J(d===void 0||typeof d=="string",58123),Ae.fromBase64String(d||"")):(J(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),Ae.fromUint8Array(d||new Uint8Array))})(n,e.targetChange.resumeToken),a=e.targetChange.cause,c=a&&(function(h){const d=h.code===void 0?V.UNKNOWN:pd(h.code);return new L(d,h.message||"")})(a);t=new gd(r,s,i,c||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=Go(n,r.document.name),i=dt(r.document.updateTime),a=r.document.createTime?dt(r.document.createTime):j.min(),c=new Be({mapValue:{fields:r.document.fields}}),l=Ce.newFoundDocument(s,i,a,c),h=r.targetIds||[],d=r.removedTargetIds||[];t=new ui(h,d,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=Go(n,r.document),i=r.readTime?dt(r.readTime):j.min(),a=Ce.newNoDocument(s,i),c=r.removedTargetIds||[];t=new ui([],c,a.key,a)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=Go(n,r.document),i=r.removedTargetIds||[];t=new ui([],i,s,null)}else{if(!("filter"in e))return U(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,a=new Cv(s,i),c=r.targetId;t=new md(c,a)}}return t}function jv(n,e){let t;if(e instanceof Ss)t={update:Fl(n,e.key,e.value)};else if(e instanceof ic)t={delete:Ta(n,e.key)};else if(e instanceof hn)t={update:Fl(n,e.key,e.data),updateMask:Xv(e.fieldMask)};else{if(!(e instanceof bv))return U(16599,{Vt:e.type});t={verify:Ta(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((r=>(function(i,a){const c=a.transform;if(c instanceof bi)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof gs)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof _s)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof Si)return{fieldPath:a.field.canonicalString(),increment:c.Ae};throw U(20930,{transform:a.transform})})(0,r)))),e.precondition.isNone||(t.currentDocument=(function(s,i){return i.updateTime!==void 0?{updateTime:Fv(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:U(27497)})(n,e.precondition)),t}function qv(n,e){return n&&n.length>0?(J(e!==void 0,14353),n.map((t=>(function(s,i){let a=s.updateTime?dt(s.updateTime):dt(i);return a.isEqual(j.min())&&(a=dt(i)),new wv(a,s.transformResults||[])})(t,e)))):[]}function $v(n,e){return{documents:[vd(n,e.path)]}}function zv(n,e){const t={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=vd(n,s);const i=(function(h){if(h.length!==0)return Id(vt.create(h,"and"))})(e.filters);i&&(t.structuredQuery.where=i);const a=(function(h){if(h.length!==0)return h.map((d=>(function(g){return{field:zn(g.field),direction:Gv(g.dir)}})(d)))})(e.orderBy);a&&(t.structuredQuery.orderBy=a);const c=va(n,e.limit);return c!==null&&(t.structuredQuery.limit=c),e.startAt&&(t.structuredQuery.startAt=(function(h){return{before:h.inclusive,values:h.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(h){return{before:!h.inclusive,values:h.position}})(e.endAt)),{ft:t,parent:s}}function Hv(n){let e=Uv(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let s=null;if(r>0){J(r===1,65062);const d=t.from[0];d.allDescendants?s=d.collectionId:e=e.child(d.collectionId)}let i=[];t.where&&(i=(function(m){const g=Td(m);return g instanceof vt&&Jf(g)?g.getFilters():[g]})(t.where));let a=[];t.orderBy&&(a=(function(m){return m.map((g=>(function(S){return new Ri(Hn(S.field),(function(P){switch(P){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(S.direction))})(g)))})(t.orderBy));let c=null;t.limit&&(c=(function(m){let g;return g=typeof m=="object"?m.value:m,Ki(g)?null:g})(t.limit));let l=null;t.startAt&&(l=(function(m){const g=!!m.before,w=m.values||[];return new Ai(w,g)})(t.startAt));let h=null;return t.endAt&&(h=(function(m){const g=!m.before,w=m.values||[];return new Ai(w,g)})(t.endAt)),uv(e,s,a,i,c,"F",l,h)}function Wv(n,e){const t=(function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return U(28987,{purpose:s})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Td(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=Hn(t.unaryFilter.field);return ge.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Hn(t.unaryFilter.field);return ge.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Hn(t.unaryFilter.field);return ge.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=Hn(t.unaryFilter.field);return ge.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return U(61313);default:return U(60726)}})(n):n.fieldFilter!==void 0?(function(t){return ge.create(Hn(t.fieldFilter.field),(function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return U(58110);default:return U(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return vt.create(t.compositeFilter.filters.map((r=>Td(r))),(function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return U(1026)}})(t.compositeFilter.op))})(n):U(30097,{filter:n})}function Gv(n){return Ov[n]}function Kv(n){return Mv[n]}function Qv(n){return Lv[n]}function zn(n){return{fieldPath:n.canonicalString()}}function Hn(n){return Ie.fromServerFormat(n.fieldPath)}function Id(n){return n instanceof ge?(function(t){if(t.op==="=="){if(Rl(t.value))return{unaryFilter:{field:zn(t.field),op:"IS_NAN"}};if(Al(t.value))return{unaryFilter:{field:zn(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Rl(t.value))return{unaryFilter:{field:zn(t.field),op:"IS_NOT_NAN"}};if(Al(t.value))return{unaryFilter:{field:zn(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:zn(t.field),op:Kv(t.op),value:t.value}}})(n):n instanceof vt?(function(t){const r=t.getFilters().map((s=>Id(s)));return r.length===1?r[0]:{compositeFilter:{op:Qv(t.op),filters:r}}})(n):U(54877,{filter:n})}function Xv(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function wd(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}class Gt{constructor(e,t,r,s,i=j.min(),a=j.min(),c=Ae.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=c,this.expectedCount=l}withSequenceNumber(e){return new Gt(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Gt(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Gt(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Gt(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class Yv{constructor(e){this.yt=e}}function Jv(n){const e=Hv({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?ya(e,e.limit,"L"):e}class Zv{constructor(){this.Cn=new eE}addToCollectionParentIndex(e,t){return this.Cn.add(t),C.resolve()}getCollectionParents(e,t){return C.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return C.resolve()}deleteFieldIndex(e,t){return C.resolve()}deleteAllFieldIndexes(e){return C.resolve()}createTargetIndexes(e,t){return C.resolve()}getDocumentsMatchingTarget(e,t){return C.resolve(null)}getIndexType(e,t){return C.resolve(0)}getFieldIndexes(e,t){return C.resolve([])}getNextCollectionGroupToUpdate(e){return C.resolve(null)}getMinOffset(e,t){return C.resolve(rn.min())}getMinOffsetFromCollectionGroup(e,t){return C.resolve(rn.min())}updateCollectionGroup(e,t,r){return C.resolve()}updateIndexEntries(e,t){return C.resolve()}}class eE{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t]||new ye(se.comparator),i=!s.has(r);return this.index[t]=s.add(r),i}has(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t];return s&&s.has(r)}getEntries(e){return(this.index[e]||new ye(se.comparator)).toArray()}}const Ul={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Ad=41943040;class Fe{static withCacheSize(e){return new Fe(e,Fe.DEFAULT_COLLECTION_PERCENTILE,Fe.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}Fe.DEFAULT_COLLECTION_PERCENTILE=10,Fe.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Fe.DEFAULT=new Fe(Ad,Fe.DEFAULT_COLLECTION_PERCENTILE,Fe.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Fe.DISABLED=new Fe(-1,0,0);class dr{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new dr(0)}static cr(){return new dr(-1)}}const Bl="LruGarbageCollector",tE=1048576;function jl([n,e],[t,r]){const s=W(n,t);return s===0?W(e,r):s}class nE{constructor(e){this.Ir=e,this.buffer=new ye(jl),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();jl(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class rE{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){O(Bl,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){br(t)?O(Bl,"Ignoring IndexedDB error during garbage collection: ",t):await Rr(t)}await this.Vr(3e5)}))}}class sE{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((r=>Math.floor(t/100*r)))}nthSequenceNumber(e,t){if(t===0)return C.resolve(Gi.ce);const r=new nE(t);return this.mr.forEachTarget(e,(s=>r.Ar(s.sequenceNumber))).next((()=>this.mr.pr(e,(s=>r.Ar(s))))).next((()=>r.maxValue))}removeTargets(e,t,r){return this.mr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(O("LruGarbageCollector","Garbage collection skipped; disabled"),C.resolve(Ul)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(O("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Ul):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let r,s,i,a,c,l,h;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((m=>(m>this.params.maximumSequenceNumbersToCollect?(O("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${m}`),s=this.params.maximumSequenceNumbersToCollect):s=m,a=Date.now(),this.nthSequenceNumber(e,s)))).next((m=>(r=m,c=Date.now(),this.removeTargets(e,r,t)))).next((m=>(i=m,l=Date.now(),this.removeOrphanedDocuments(e,r)))).next((m=>(h=Date.now(),qn()<=H.DEBUG&&O("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-d}ms
	Determined least recently used ${s} in `+(c-a)+`ms
	Removed ${i} targets in `+(l-c)+`ms
	Removed ${m} documents in `+(h-l)+`ms
Total Duration: ${h-d}ms`),C.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:m}))))}}function iE(n,e){return new sE(n,e)}class oE{constructor(){this.changes=new Mn((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Ce.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?C.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class aE{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class cE{constructor(e,t,r,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next((s=>(r=s,this.remoteDocumentCache.getEntry(e,t)))).next((s=>(r!==null&&is(r.mutation,s,Ge.empty(),ie.now()),s)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.getLocalViewOfDocuments(e,r,G()).next((()=>r))))}getLocalViewOfDocuments(e,t,r=G()){const s=vn();return this.populateOverlays(e,s,t).next((()=>this.computeViews(e,t,s,r).next((i=>{let a=Gr();return i.forEach(((c,l)=>{a=a.insert(c,l.overlayedDocument)})),a}))))}getOverlayedDocuments(e,t){const r=vn();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,G())))}populateOverlays(e,t,r){const s=[];return r.forEach((i=>{t.has(i)||s.push(i)})),this.documentOverlayCache.getOverlays(e,s).next((i=>{i.forEach(((a,c)=>{t.set(a,c)}))}))}computeViews(e,t,r,s){let i=Ct();const a=ss(),c=(function(){return ss()})();return t.forEach(((l,h)=>{const d=r.get(h.key);s.has(h.key)&&(d===void 0||d.mutation instanceof hn)?i=i.insert(h.key,h):d!==void 0?(a.set(h.key,d.mutation.getFieldMask()),is(d.mutation,h,d.mutation.getFieldMask(),ie.now())):a.set(h.key,Ge.empty())})),this.recalculateAndSaveOverlays(e,i).next((l=>(l.forEach(((h,d)=>a.set(h,d))),t.forEach(((h,d)=>c.set(h,new aE(d,a.get(h)??null)))),c)))}recalculateAndSaveOverlays(e,t){const r=ss();let s=new ae(((a,c)=>a-c)),i=G();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((a=>{for(const c of a)c.keys().forEach((l=>{const h=t.get(l);if(h===null)return;let d=r.get(l)||Ge.empty();d=c.applyToLocalView(h,d),r.set(l,d);const m=(s.get(c.batchId)||G()).add(l);s=s.insert(c.batchId,m)}))})).next((()=>{const a=[],c=s.getReverseIterator();for(;c.hasNext();){const l=c.getNext(),h=l.key,d=l.value,m=od();d.forEach((g=>{if(!i.has(g)){const w=fd(t.get(g),r.get(g));w!==null&&m.set(g,w),i=i.add(g)}})),a.push(this.documentOverlayCache.saveOverlays(e,h,m))}return C.waitFor(a)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,t,r,s){return(function(a){return F.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):lv(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,s):this.getDocumentsMatchingCollectionQuery(e,t,r,s)}getNextDocuments(e,t,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,s).next((i=>{const a=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,s-i.size):C.resolve(vn());let c=fs,l=i;return a.next((h=>C.forEach(h,((d,m)=>(c<m.largestBatchId&&(c=m.largestBatchId),i.get(d)?C.resolve():this.remoteDocumentCache.getEntry(e,d).next((g=>{l=l.insert(d,g)}))))).next((()=>this.populateOverlays(e,h,i))).next((()=>this.computeViews(e,l,h,G()))).next((d=>({batchId:c,changes:id(d)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new F(t)).next((r=>{let s=Gr();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s}))}getDocumentsMatchingCollectionGroupQuery(e,t,r,s){const i=t.collectionGroup;let a=Gr();return this.indexManager.getCollectionParents(e,i).next((c=>C.forEach(c,(l=>{const h=(function(m,g){return new Xi(g,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)})(t,l.child(i));return this.getDocumentsMatchingCollectionQuery(e,h,r,s).next((d=>{d.forEach(((m,g)=>{a=a.insert(m,g)}))}))})).next((()=>a))))}getDocumentsMatchingCollectionQuery(e,t,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next((a=>(i=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,i,s)))).next((a=>{i.forEach(((l,h)=>{const d=h.getKey();a.get(d)===null&&(a=a.insert(d,Ce.newInvalidDocument(d)))}));let c=Gr();return a.forEach(((l,h)=>{const d=i.get(l);d!==void 0&&is(d.mutation,h,Ge.empty(),ie.now()),Ji(t,h)&&(c=c.insert(l,h))})),c}))}}class uE{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return C.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(s){return{id:s.id,version:s.version,createTime:dt(s.createTime)}})(t)),C.resolve()}getNamedQuery(e,t){return C.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(s){return{name:s.name,query:Jv(s.bundledQuery),readTime:dt(s.readTime)}})(t)),C.resolve()}}class lE{constructor(){this.overlays=new ae(F.comparator),this.qr=new Map}getOverlay(e,t){return C.resolve(this.overlays.get(t))}getOverlays(e,t){const r=vn();return C.forEach(t,(s=>this.getOverlay(e,s).next((i=>{i!==null&&r.set(s,i)})))).next((()=>r))}saveOverlays(e,t,r){return r.forEach(((s,i)=>{this.St(e,t,i)})),C.resolve()}removeOverlaysForBatchId(e,t,r){const s=this.qr.get(r);return s!==void 0&&(s.forEach((i=>this.overlays=this.overlays.remove(i))),this.qr.delete(r)),C.resolve()}getOverlaysForCollection(e,t,r){const s=vn(),i=t.length+1,a=new F(t.child("")),c=this.overlays.getIteratorFrom(a);for(;c.hasNext();){const l=c.getNext().value,h=l.getKey();if(!t.isPrefixOf(h.path))break;h.path.length===i&&l.largestBatchId>r&&s.set(l.getKey(),l)}return C.resolve(s)}getOverlaysForCollectionGroup(e,t,r,s){let i=new ae(((h,d)=>h-d));const a=this.overlays.getIterator();for(;a.hasNext();){const h=a.getNext().value;if(h.getKey().getCollectionGroup()===t&&h.largestBatchId>r){let d=i.get(h.largestBatchId);d===null&&(d=vn(),i=i.insert(h.largestBatchId,d)),d.set(h.getKey(),h)}}const c=vn(),l=i.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach(((h,d)=>c.set(h,d))),!(c.size()>=s)););return C.resolve(c)}St(e,t,r){const s=this.overlays.get(r.key);if(s!==null){const a=this.qr.get(s.largestBatchId).delete(r.key);this.qr.set(s.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new Pv(t,r));let i=this.qr.get(t);i===void 0&&(i=G(),this.qr.set(t,i)),this.qr.set(t,i.add(r.key))}}class hE{constructor(){this.sessionToken=Ae.EMPTY_BYTE_STRING}getSessionToken(e){return C.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,C.resolve()}}class uc{constructor(){this.Qr=new ye(Ee.$r),this.Ur=new ye(Ee.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const r=new Ee(e,t);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,t){e.forEach((r=>this.addReference(r,t)))}removeReference(e,t){this.Gr(new Ee(e,t))}zr(e,t){e.forEach((r=>this.removeReference(r,t)))}jr(e){const t=new F(new se([])),r=new Ee(t,e),s=new Ee(t,e+1),i=[];return this.Ur.forEachInRange([r,s],(a=>{this.Gr(a),i.push(a.key)})),i}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new F(new se([])),r=new Ee(t,e),s=new Ee(t,e+1);let i=G();return this.Ur.forEachInRange([r,s],(a=>{i=i.add(a.key)})),i}containsKey(e){const t=new Ee(e,0),r=this.Qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class Ee{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return F.comparator(e.key,t.key)||W(e.Yr,t.Yr)}static Kr(e,t){return W(e.Yr,t.Yr)||F.comparator(e.key,t.key)}}class fE{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new ye(Ee.$r)}checkEmpty(e){return C.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,s){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new Sv(i,t,r,s);this.mutationQueue.push(a);for(const c of s)this.Zr=this.Zr.add(new Ee(c.key,i)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return C.resolve(a)}lookupMutationBatch(e,t){return C.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,s=this.ei(r),i=s<0?0:s;return C.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return C.resolve(this.mutationQueue.length===0?Ja:this.tr-1)}getAllMutationBatches(e){return C.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new Ee(t,0),s=new Ee(t,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([r,s],(a=>{const c=this.Xr(a.Yr);i.push(c)})),C.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new ye(W);return t.forEach((s=>{const i=new Ee(s,0),a=new Ee(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,a],(c=>{r=r.add(c.Yr)}))})),C.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,s=r.length+1;let i=r;F.isDocumentKey(i)||(i=i.child(""));const a=new Ee(new F(i),0);let c=new ye(W);return this.Zr.forEachWhile((l=>{const h=l.key.path;return!!r.isPrefixOf(h)&&(h.length===s&&(c=c.add(l.Yr)),!0)}),a),C.resolve(this.ti(c))}ti(e){const t=[];return e.forEach((r=>{const s=this.Xr(r);s!==null&&t.push(s)})),t}removeMutationBatch(e,t){J(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return C.forEach(t.mutations,(s=>{const i=new Ee(s.key,t.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)})).next((()=>{this.Zr=r}))}ir(e){}containsKey(e,t){const r=new Ee(t,0),s=this.Zr.firstAfterOrEqual(r);return C.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,C.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class dE{constructor(e){this.ri=e,this.docs=(function(){return new ae(F.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,s=this.docs.get(r),i=s?s.size:0,a=this.ri(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return C.resolve(r?r.document.mutableCopy():Ce.newInvalidDocument(t))}getEntries(e,t){let r=Ct();return t.forEach((s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():Ce.newInvalidDocument(s))})),C.resolve(r)}getDocumentsMatchingQuery(e,t,r,s){let i=Ct();const a=t.path,c=new F(a.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(c);for(;l.hasNext();){const{key:h,value:{document:d}}=l.getNext();if(!a.isPrefixOf(h.path))break;h.path.length>a.length+1||jy(By(d),r)<=0||(s.has(d.key)||Ji(t,d))&&(i=i.insert(d.key,d.mutableCopy()))}return C.resolve(i)}getAllFromCollectionGroup(e,t,r,s){U(9500)}ii(e,t){return C.forEach(this.docs,(r=>t(r)))}newChangeBuffer(e){return new pE(this)}getSize(e){return C.resolve(this.size)}}class pE extends oE{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((r,s)=>{s.isValidDocument()?t.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(r)})),C.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class mE{constructor(e){this.persistence=e,this.si=new Mn((t=>tc(t)),nc),this.lastRemoteSnapshotVersion=j.min(),this.highestTargetId=0,this.oi=0,this._i=new uc,this.targetCount=0,this.ai=dr.ur()}forEachTarget(e,t){return this.si.forEach(((r,s)=>t(s))),C.resolve()}getLastRemoteSnapshotVersion(e){return C.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return C.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),C.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.oi&&(this.oi=t),C.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new dr(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,C.resolve()}updateTargetData(e,t){return this.Pr(t),C.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,C.resolve()}removeTargets(e,t,r){let s=0;const i=[];return this.si.forEach(((a,c)=>{c.sequenceNumber<=t&&r.get(c.targetId)===null&&(this.si.delete(a),i.push(this.removeMatchingKeysForTargetId(e,c.targetId)),s++)})),C.waitFor(i).next((()=>s))}getTargetCount(e){return C.resolve(this.targetCount)}getTargetData(e,t){const r=this.si.get(t)||null;return C.resolve(r)}addMatchingKeys(e,t,r){return this._i.Wr(t,r),C.resolve()}removeMatchingKeys(e,t,r){this._i.zr(t,r);const s=this.persistence.referenceDelegate,i=[];return s&&t.forEach((a=>{i.push(s.markPotentiallyOrphaned(e,a))})),C.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),C.resolve()}getMatchingKeysForTargetId(e,t){const r=this._i.Hr(t);return C.resolve(r)}containsKey(e,t){return C.resolve(this._i.containsKey(t))}}class Rd{constructor(e,t){this.ui={},this.overlays={},this.ci=new Gi(0),this.li=!1,this.li=!0,this.hi=new hE,this.referenceDelegate=e(this),this.Pi=new mE(this),this.indexManager=new Zv,this.remoteDocumentCache=(function(s){return new dE(s)})((r=>this.referenceDelegate.Ti(r))),this.serializer=new Yv(t),this.Ii=new uE(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new lE,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ui[e.toKey()];return r||(r=new fE(t,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,r){O("MemoryPersistence","Starting transaction:",e);const s=new gE(this.ci.next());return this.referenceDelegate.Ei(),r(s).next((i=>this.referenceDelegate.di(s).next((()=>i)))).toPromise().then((i=>(s.raiseOnCommittedEvent(),i)))}Ai(e,t){return C.or(Object.values(this.ui).map((r=>()=>r.containsKey(e,t))))}}class gE extends $y{constructor(e){super(),this.currentSequenceNumber=e}}class lc{constructor(e){this.persistence=e,this.Ri=new uc,this.Vi=null}static mi(e){return new lc(e)}get fi(){if(this.Vi)return this.Vi;throw U(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.fi.delete(r.toString()),C.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.fi.add(r.toString()),C.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),C.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((s=>this.fi.add(s.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((s=>{s.forEach((i=>this.fi.add(i.toString())))})).next((()=>r.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return C.forEach(this.fi,(r=>{const s=F.fromPath(r);return this.gi(e,s).next((i=>{i||t.removeEntry(s,j.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((r=>{r?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return C.or([()=>C.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class Ci{constructor(e,t){this.persistence=e,this.pi=new Mn((r=>Wy(r.path)),((r,s)=>r.isEqual(s))),this.garbageCollector=iE(this,t)}static mi(e,t){return new Ci(e,t)}Ei(){}di(e){return C.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>t.next((s=>r+s))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}pr(e,t){return C.forEach(this.pi,((r,s)=>this.br(e,r,s).next((i=>i?C.resolve():t(s)))))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.ii(e,(a=>this.br(e,a,t).next((c=>{c||(r++,i.removeEntry(a,j.min()))})))).next((()=>i.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),C.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),C.resolve()}removeReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),C.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),C.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=oi(e.data.value)),t}br(e,t,r){return C.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const s=this.pi.get(t);return C.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class hc{constructor(e,t,r,s){this.targetId=e,this.fromCache=t,this.Es=r,this.ds=s}static As(e,t){let r=G(),s=G();for(const i of t.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new hc(e,t.fromCache,r,s)}}class _E{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class yE{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return c_()?8:zy(Ne())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,s){const i={result:null};return this.ys(e,t).next((a=>{i.result=a})).next((()=>{if(!i.result)return this.ws(e,t,s,r).next((a=>{i.result=a}))})).next((()=>{if(i.result)return;const a=new _E;return this.Ss(e,t,a).next((c=>{if(i.result=c,this.Vs)return this.bs(e,t,a,c.size)}))})).next((()=>i.result))}bs(e,t,r,s){return r.documentReadCount<this.fs?(qn()<=H.DEBUG&&O("QueryEngine","SDK will not create cache indexes for query:",$n(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),C.resolve()):(qn()<=H.DEBUG&&O("QueryEngine","Query:",$n(t),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.gs*s?(qn()<=H.DEBUG&&O("QueryEngine","The SDK decides to create cache indexes for query:",$n(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ft(t))):C.resolve())}ys(e,t){if(Cl(t))return C.resolve(null);let r=ft(t);return this.indexManager.getIndexType(e,r).next((s=>s===0?null:(t.limit!==null&&s===1&&(t=ya(t,null,"F"),r=ft(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next((i=>{const a=G(...i);return this.ps.getDocuments(e,a).next((c=>this.indexManager.getMinOffset(e,r).next((l=>{const h=this.Ds(t,c);return this.Cs(t,h,a,l.readTime)?this.ys(e,ya(t,null,"F")):this.vs(e,h,t,l)}))))})))))}ws(e,t,r,s){return Cl(t)||s.isEqual(j.min())?C.resolve(null):this.ps.getDocuments(e,r).next((i=>{const a=this.Ds(t,i);return this.Cs(t,a,r,s)?C.resolve(null):(qn()<=H.DEBUG&&O("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),$n(t)),this.vs(e,a,t,Uy(s,fs)).next((c=>c)))}))}Ds(e,t){let r=new ye(rd(e));return t.forEach(((s,i)=>{Ji(e,i)&&(r=r.add(i))})),r}Cs(e,t,r,s){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const i=e.limitType==="F"?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Ss(e,t,r){return qn()<=H.DEBUG&&O("QueryEngine","Using full collection scan to execute query:",$n(t)),this.ps.getDocumentsMatchingQuery(e,t,rn.min(),r)}vs(e,t,r,s){return this.ps.getDocumentsMatchingQuery(e,r,s).next((i=>(t.forEach((a=>{i=i.insert(a.key,a)})),i)))}}const fc="LocalStore",vE=3e8;class EE{constructor(e,t,r,s){this.persistence=e,this.Fs=t,this.serializer=s,this.Ms=new ae(W),this.xs=new Mn((i=>tc(i)),nc),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new cE(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function TE(n,e,t,r){return new EE(n,e,t,r)}async function bd(n,e){const t=q(n);return await t.persistence.runTransaction("Handle user change","readonly",(r=>{let s;return t.mutationQueue.getAllMutationBatches(r).next((i=>(s=i,t.Bs(e),t.mutationQueue.getAllMutationBatches(r)))).next((i=>{const a=[],c=[];let l=G();for(const h of s){a.push(h.batchId);for(const d of h.mutations)l=l.add(d.key)}for(const h of i){c.push(h.batchId);for(const d of h.mutations)l=l.add(d.key)}return t.localDocuments.getDocuments(r,l).next((h=>({Ls:h,removedBatchIds:a,addedBatchIds:c})))}))}))}function IE(n,e){const t=q(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const s=e.batch.keys(),i=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(c,l,h,d){const m=h.batch,g=m.keys();let w=C.resolve();return g.forEach((S=>{w=w.next((()=>d.getEntry(l,S))).next((k=>{const P=h.docVersions.get(S);J(P!==null,48541),k.version.compareTo(P)<0&&(m.applyToRemoteDocument(k,h),k.isValidDocument()&&(k.setReadTime(h.commitVersion),d.addEntry(k)))}))})),w.next((()=>c.mutationQueue.removeMutationBatch(l,m)))})(t,r,e,i).next((()=>i.apply(r))).next((()=>t.mutationQueue.performConsistencyCheck(r))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(c){let l=G();for(let h=0;h<c.mutationResults.length;++h)c.mutationResults[h].transformResults.length>0&&(l=l.add(c.batch.mutations[h].key));return l})(e)))).next((()=>t.localDocuments.getDocuments(r,s)))}))}function Sd(n){const e=q(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function wE(n,e){const t=q(n),r=e.snapshotVersion;let s=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(i=>{const a=t.Ns.newChangeBuffer({trackRemovals:!0});s=t.Ms;const c=[];e.targetChanges.forEach(((d,m)=>{const g=s.get(m);if(!g)return;c.push(t.Pi.removeMatchingKeys(i,d.removedDocuments,m).next((()=>t.Pi.addMatchingKeys(i,d.addedDocuments,m))));let w=g.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(m)!==null?w=w.withResumeToken(Ae.EMPTY_BYTE_STRING,j.min()).withLastLimboFreeSnapshotVersion(j.min()):d.resumeToken.approximateByteSize()>0&&(w=w.withResumeToken(d.resumeToken,r)),s=s.insert(m,w),(function(k,P,x){return k.resumeToken.approximateByteSize()===0||P.snapshotVersion.toMicroseconds()-k.snapshotVersion.toMicroseconds()>=vE?!0:x.addedDocuments.size+x.modifiedDocuments.size+x.removedDocuments.size>0})(g,w,d)&&c.push(t.Pi.updateTargetData(i,w))}));let l=Ct(),h=G();if(e.documentUpdates.forEach((d=>{e.resolvedLimboDocuments.has(d)&&c.push(t.persistence.referenceDelegate.updateLimboDocument(i,d))})),c.push(AE(i,a,e.documentUpdates).next((d=>{l=d.ks,h=d.qs}))),!r.isEqual(j.min())){const d=t.Pi.getLastRemoteSnapshotVersion(i).next((m=>t.Pi.setTargetsMetadata(i,i.currentSequenceNumber,r)));c.push(d)}return C.waitFor(c).next((()=>a.apply(i))).next((()=>t.localDocuments.getLocalViewOfDocuments(i,l,h))).next((()=>l))})).then((i=>(t.Ms=s,i)))}function AE(n,e,t){let r=G(),s=G();return t.forEach((i=>r=r.add(i))),e.getEntries(n,r).next((i=>{let a=Ct();return t.forEach(((c,l)=>{const h=i.get(c);l.isFoundDocument()!==h.isFoundDocument()&&(s=s.add(c)),l.isNoDocument()&&l.version.isEqual(j.min())?(e.removeEntry(c,l.readTime),a=a.insert(c,l)):!h.isValidDocument()||l.version.compareTo(h.version)>0||l.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(l),a=a.insert(c,l)):O(fc,"Ignoring outdated watch update for ",c,". Current version:",h.version," Watch version:",l.version)})),{ks:a,qs:s}}))}function RE(n,e){const t=q(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=Ja),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function bE(n,e){const t=q(n);return t.persistence.runTransaction("Allocate target","readwrite",(r=>{let s;return t.Pi.getTargetData(r,e).next((i=>i?(s=i,C.resolve(s)):t.Pi.allocateTargetId(r).next((a=>(s=new Gt(e,a,"TargetPurposeListen",r.currentSequenceNumber),t.Pi.addTargetData(r,s).next((()=>s)))))))})).then((r=>{const s=t.Ms.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(r.targetId,r),t.xs.set(e,r.targetId)),r}))}async function wa(n,e,t){const r=q(n),s=r.Ms.get(e),i=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",i,(a=>r.persistence.referenceDelegate.removeTarget(a,s)))}catch(a){if(!br(a))throw a;O(fc,`Failed to update sequence numbers for target ${e}: ${a}`)}r.Ms=r.Ms.remove(e),r.xs.delete(s.target)}function ql(n,e,t){const r=q(n);let s=j.min(),i=G();return r.persistence.runTransaction("Execute query","readwrite",(a=>(function(l,h,d){const m=q(l),g=m.xs.get(d);return g!==void 0?C.resolve(m.Ms.get(g)):m.Pi.getTargetData(h,d)})(r,a,ft(e)).next((c=>{if(c)return s=c.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(a,c.targetId).next((l=>{i=l}))})).next((()=>r.Fs.getDocumentsMatchingQuery(a,e,t?s:j.min(),t?i:G()))).next((c=>(SE(r,fv(e),c),{documents:c,Qs:i})))))}function SE(n,e,t){let r=n.Os.get(e)||j.min();t.forEach(((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)})),n.Os.set(e,r)}class $l{constructor(){this.activeTargetIds=yv()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class PE{constructor(){this.Mo=new $l,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,r){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new $l,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class CE{Oo(e){}shutdown(){}}const zl="ConnectivityMonitor";class Hl{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){O(zl,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){O(zl,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let ti=null;function Aa(){return ti===null?ti=(function(){return 268435456+Math.round(2147483648*Math.random())})():ti++,"0x"+ti.toString(16)}const Ko="RestConnection",kE={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class VE{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${r}/databases/${s}`,this.Wo=this.databaseId.database===Ii?`project_id=${r}`:`project_id=${r}&database_id=${s}`}Go(e,t,r,s,i){const a=Aa(),c=this.zo(e,t.toUriEncodedString());O(Ko,`Sending RPC '${e}' ${a}:`,c,r);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,s,i);const{host:h}=new URL(c),d=Ir(h);return this.Jo(e,c,l,r,d).then((m=>(O(Ko,`Received RPC '${e}' ${a}: `,m),m)),(m=>{throw ur(Ko,`RPC '${e}' ${a} failed with error: `,m,"url: ",c,"request:",r),m}))}Ho(e,t,r,s,i,a){return this.Go(e,t,r,s,i)}jo(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Ar})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((s,i)=>e[i]=s)),r&&r.headers.forEach(((s,i)=>e[i]=s))}zo(e,t){const r=kE[e];return`${this.Uo}/v1/${t}:${r}`}terminate(){}}class DE{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const be="WebChannelConnection";class NE extends VE{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,s,i){const a=Aa();return new Promise(((c,l)=>{const h=new Vf;h.setWithCredentials(!0),h.listenOnce(Df.COMPLETE,(()=>{try{switch(h.getLastErrorCode()){case ii.NO_ERROR:const m=h.getResponseJson();O(be,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(m)),c(m);break;case ii.TIMEOUT:O(be,`RPC '${e}' ${a} timed out`),l(new L(V.DEADLINE_EXCEEDED,"Request time out"));break;case ii.HTTP_ERROR:const g=h.getStatus();if(O(be,`RPC '${e}' ${a} failed with status:`,g,"response text:",h.getResponseText()),g>0){let w=h.getResponseJson();Array.isArray(w)&&(w=w[0]);const S=w?.error;if(S&&S.status&&S.message){const k=(function(x){const N=x.toLowerCase().replace(/_/g,"-");return Object.values(V).indexOf(N)>=0?N:V.UNKNOWN})(S.status);l(new L(k,S.message))}else l(new L(V.UNKNOWN,"Server responded with status "+h.getStatus()))}else l(new L(V.UNAVAILABLE,"Connection failed."));break;default:U(9055,{l_:e,streamId:a,h_:h.getLastErrorCode(),P_:h.getLastError()})}}finally{O(be,`RPC '${e}' ${a} completed.`)}}));const d=JSON.stringify(s);O(be,`RPC '${e}' ${a} sending request:`,s),h.send(t,"POST",d,r,15)}))}T_(e,t,r){const s=Aa(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=Mf(),c=Of(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(l.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,t,r),l.encodeInitMessageHeaders=!0;const d=i.join("");O(be,`Creating RPC '${e}' stream ${s}: ${d}`,l);const m=a.createWebChannel(d,l);this.I_(m);let g=!1,w=!1;const S=new DE({Yo:P=>{w?O(be,`Not sending because RPC '${e}' stream ${s} is closed:`,P):(g||(O(be,`Opening RPC '${e}' stream ${s} transport.`),m.open(),g=!0),O(be,`RPC '${e}' stream ${s} sending:`,P),m.send(P))},Zo:()=>m.close()}),k=(P,x,N)=>{P.listen(x,(M=>{try{N(M)}catch(Q){setTimeout((()=>{throw Q}),0)}}))};return k(m,Wr.EventType.OPEN,(()=>{w||(O(be,`RPC '${e}' stream ${s} transport opened.`),S.o_())})),k(m,Wr.EventType.CLOSE,(()=>{w||(w=!0,O(be,`RPC '${e}' stream ${s} transport closed`),S.a_(),this.E_(m))})),k(m,Wr.EventType.ERROR,(P=>{w||(w=!0,ur(be,`RPC '${e}' stream ${s} transport errored. Name:`,P.name,"Message:",P.message),S.a_(new L(V.UNAVAILABLE,"The operation could not be completed")))})),k(m,Wr.EventType.MESSAGE,(P=>{if(!w){const x=P.data[0];J(!!x,16349);const N=x,M=N?.error||N[0]?.error;if(M){O(be,`RPC '${e}' stream ${s} received error:`,M);const Q=M.status;let te=(function(_){const v=fe[_];if(v!==void 0)return pd(v)})(Q),Z=M.message;te===void 0&&(te=V.INTERNAL,Z="Unknown error status: "+Q+" with message "+M.message),w=!0,S.a_(new L(te,Z)),m.close()}else O(be,`RPC '${e}' stream ${s} received:`,x),S.u_(x)}})),k(c,Nf.STAT_EVENT,(P=>{P.stat===fa.PROXY?O(be,`RPC '${e}' stream ${s} detected buffering proxy`):P.stat===fa.NOPROXY&&O(be,`RPC '${e}' stream ${s} detected no buffering proxy`)})),setTimeout((()=>{S.__()}),0),S}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function Qo(){return typeof document<"u"?document:null}function no(n){return new xv(n,!0)}class Pd{constructor(e,t,r=1e3,s=1.5,i=6e4){this.Mi=e,this.timerId=t,this.d_=r,this.A_=s,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),s=Math.max(0,t-r);s>0&&O("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const Wl="PersistentStream";class Cd{constructor(e,t,r,s,i,a,c,l){this.Mi=e,this.S_=r,this.b_=s,this.connection=i,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=c,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Pd(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===V.RESOURCE_EXHAUSTED?(Pt(t.toString()),Pt("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===V.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,s])=>{this.D_===t&&this.G_(r,s)}),(r=>{e((()=>{const s=new L(V.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(s)}))}))}G_(e,t){const r=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{r((()=>this.listener.Xo()))})),this.stream.t_((()=>{r((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((s=>{r((()=>this.z_(s)))})),this.stream.onMessage((s=>{r((()=>++this.F_==1?this.J_(s):this.onNext(s)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return O(Wl,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(O(Wl,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class OE extends Cd{constructor(e,t,r,s,i,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,s,a),this.serializer=i}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=Bv(this.serializer,e),r=(function(i){if(!("targetChange"in i))return j.min();const a=i.targetChange;return a.targetIds&&a.targetIds.length?j.min():a.readTime?dt(a.readTime):j.min()})(e);return this.listener.H_(t,r)}Y_(e){const t={};t.database=Ia(this.serializer),t.addTarget=(function(i,a){let c;const l=a.target;if(c=_a(l)?{documents:$v(i,l)}:{query:zv(i,l).ft},c.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){c.resumeToken=_d(i,a.resumeToken);const h=va(i,a.expectedCount);h!==null&&(c.expectedCount=h)}else if(a.snapshotVersion.compareTo(j.min())>0){c.readTime=Pi(i,a.snapshotVersion.toTimestamp());const h=va(i,a.expectedCount);h!==null&&(c.expectedCount=h)}return c})(this.serializer,e);const r=Wv(this.serializer,e);r&&(t.labels=r),this.q_(t)}Z_(e){const t={};t.database=Ia(this.serializer),t.removeTarget=e,this.q_(t)}}class ME extends Cd{constructor(e,t,r,s,i,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,s,a),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return J(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,J(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){J(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=qv(e.writeResults,e.commitTime),r=dt(e.commitTime);return this.listener.na(r,t)}ra(){const e={};e.database=Ia(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((r=>jv(this.serializer,r)))};this.q_(t)}}class LE{}class xE extends LE{constructor(e,t,r,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new L(V.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,a])=>this.connection.Go(e,Ea(t,r),s,i,a))).catch((i=>{throw i.name==="FirebaseError"?(i.code===V.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new L(V.UNKNOWN,i.toString())}))}Ho(e,t,r,s,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,c])=>this.connection.Ho(e,Ea(t,r),s,a,c,i))).catch((a=>{throw a.name==="FirebaseError"?(a.code===V.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new L(V.UNKNOWN,a.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class FE{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Pt(t),this.aa=!1):O("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Vn="RemoteStore";class UE{constructor(e,t,r,s,i){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo((a=>{r.enqueueAndForget((async()=>{Ln(this)&&(O(Vn,"Restarting streams for network reachability change."),await(async function(l){const h=q(l);h.Ea.add(4),await Cs(h),h.Ra.set("Unknown"),h.Ea.delete(4),await ro(h)})(this))}))})),this.Ra=new FE(r,s)}}async function ro(n){if(Ln(n))for(const e of n.da)await e(!0)}async function Cs(n){for(const e of n.da)await e(!1)}function kd(n,e){const t=q(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),gc(t)?mc(t):Sr(t).O_()&&pc(t,e))}function dc(n,e){const t=q(n),r=Sr(t);t.Ia.delete(e),r.O_()&&Vd(t,e),t.Ia.size===0&&(r.O_()?r.L_():Ln(t)&&t.Ra.set("Unknown"))}function pc(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(j.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Sr(n).Y_(e)}function Vd(n,e){n.Va.Ue(e),Sr(n).Z_(e)}function mc(n){n.Va=new Nv({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),Sr(n).start(),n.Ra.ua()}function gc(n){return Ln(n)&&!Sr(n).x_()&&n.Ia.size>0}function Ln(n){return q(n).Ea.size===0}function Dd(n){n.Va=void 0}async function BE(n){n.Ra.set("Online")}async function jE(n){n.Ia.forEach(((e,t)=>{pc(n,e)}))}async function qE(n,e){Dd(n),gc(n)?(n.Ra.ha(e),mc(n)):n.Ra.set("Unknown")}async function $E(n,e,t){if(n.Ra.set("Online"),e instanceof gd&&e.state===2&&e.cause)try{await(async function(s,i){const a=i.cause;for(const c of i.targetIds)s.Ia.has(c)&&(await s.remoteSyncer.rejectListen(c,a),s.Ia.delete(c),s.Va.removeTarget(c))})(n,e)}catch(r){O(Vn,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await ki(n,r)}else if(e instanceof ui?n.Va.Ze(e):e instanceof md?n.Va.st(e):n.Va.tt(e),!t.isEqual(j.min()))try{const r=await Sd(n.localStore);t.compareTo(r)>=0&&await(function(i,a){const c=i.Va.Tt(a);return c.targetChanges.forEach(((l,h)=>{if(l.resumeToken.approximateByteSize()>0){const d=i.Ia.get(h);d&&i.Ia.set(h,d.withResumeToken(l.resumeToken,a))}})),c.targetMismatches.forEach(((l,h)=>{const d=i.Ia.get(l);if(!d)return;i.Ia.set(l,d.withResumeToken(Ae.EMPTY_BYTE_STRING,d.snapshotVersion)),Vd(i,l);const m=new Gt(d.target,l,h,d.sequenceNumber);pc(i,m)})),i.remoteSyncer.applyRemoteEvent(c)})(n,t)}catch(r){O(Vn,"Failed to raise snapshot:",r),await ki(n,r)}}async function ki(n,e,t){if(!br(e))throw e;n.Ea.add(1),await Cs(n),n.Ra.set("Offline"),t||(t=()=>Sd(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{O(Vn,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await ro(n)}))}function Nd(n,e){return e().catch((t=>ki(n,t,e)))}async function so(n){const e=q(n),t=cn(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Ja;for(;zE(e);)try{const s=await RE(e.localStore,r);if(s===null){e.Ta.length===0&&t.L_();break}r=s.batchId,HE(e,s)}catch(s){await ki(e,s)}Od(e)&&Md(e)}function zE(n){return Ln(n)&&n.Ta.length<10}function HE(n,e){n.Ta.push(e);const t=cn(n);t.O_()&&t.X_&&t.ea(e.mutations)}function Od(n){return Ln(n)&&!cn(n).x_()&&n.Ta.length>0}function Md(n){cn(n).start()}async function WE(n){cn(n).ra()}async function GE(n){const e=cn(n);for(const t of n.Ta)e.ea(t.mutations)}async function KE(n,e,t){const r=n.Ta.shift(),s=oc.from(r,e,t);await Nd(n,(()=>n.remoteSyncer.applySuccessfulWrite(s))),await so(n)}async function QE(n,e){e&&cn(n).X_&&await(async function(r,s){if((function(a){return kv(a)&&a!==V.ABORTED})(s.code)){const i=r.Ta.shift();cn(r).B_(),await Nd(r,(()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s))),await so(r)}})(n,e),Od(n)&&Md(n)}async function Gl(n,e){const t=q(n);t.asyncQueue.verifyOperationInProgress(),O(Vn,"RemoteStore received new credentials");const r=Ln(t);t.Ea.add(3),await Cs(t),r&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await ro(t)}async function XE(n,e){const t=q(n);e?(t.Ea.delete(2),await ro(t)):e||(t.Ea.add(2),await Cs(t),t.Ra.set("Unknown"))}function Sr(n){return n.ma||(n.ma=(function(t,r,s){const i=q(t);return i.sa(),new OE(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)})(n.datastore,n.asyncQueue,{Xo:BE.bind(null,n),t_:jE.bind(null,n),r_:qE.bind(null,n),H_:$E.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),gc(n)?mc(n):n.Ra.set("Unknown")):(await n.ma.stop(),Dd(n))}))),n.ma}function cn(n){return n.fa||(n.fa=(function(t,r,s){const i=q(t);return i.sa(),new ME(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:WE.bind(null,n),r_:QE.bind(null,n),ta:GE.bind(null,n),na:KE.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await so(n)):(await n.fa.stop(),n.Ta.length>0&&(O(Vn,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class _c{constructor(e,t,r,s,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new wn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((a=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,s,i){const a=Date.now()+r,c=new _c(e,t,a,s,i);return c.start(r),c}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new L(V.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function yc(n,e){if(Pt("AsyncQueue",`${e}: ${n}`),br(n))return new L(V.UNAVAILABLE,`${e}: ${n}`);throw n}class Zn{static emptySet(e){return new Zn(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||F.comparator(t.key,r.key):(t,r)=>F.comparator(t.key,r.key),this.keyedMap=Gr(),this.sortedSet=new ae(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,r)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Zn)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new Zn;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class Kl{constructor(){this.ga=new ae(F.comparator)}track(e){const t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):U(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,r)=>{e.push(r)})),e}}class pr{constructor(e,t,r,s,i,a,c,l,h){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=a,this.syncStateChanged=c,this.excludesMetadataChanges=l,this.hasCachedResults=h}static fromInitialDocuments(e,t,r,s,i){const a=[];return t.forEach((c=>{a.push({type:0,doc:c})})),new pr(e,t,Zn.emptySet(t),a,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Yi(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==r[s].type||!t[s].doc.isEqual(r[s].doc))return!1;return!0}}class YE{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class JE{constructor(){this.queries=Ql(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){const s=q(t),i=s.queries;s.queries=Ql(),i.forEach(((a,c)=>{for(const l of c.Sa)l.onError(r)}))})(this,new L(V.ABORTED,"Firestore shutting down"))}}function Ql(){return new Mn((n=>nd(n)),Yi)}async function ZE(n,e){const t=q(n);let r=3;const s=e.query;let i=t.queries.get(s);i?!i.ba()&&e.Da()&&(r=2):(i=new YE,r=e.Da()?0:1);try{switch(r){case 0:i.wa=await t.onListen(s,!0);break;case 1:i.wa=await t.onListen(s,!1);break;case 2:await t.onFirstRemoteStoreListen(s)}}catch(a){const c=yc(a,`Initialization of query '${$n(e.query)}' failed`);return void e.onError(c)}t.queries.set(s,i),i.Sa.push(e),e.va(t.onlineState),i.wa&&e.Fa(i.wa)&&vc(t)}async function eT(n,e){const t=q(n),r=e.query;let s=3;const i=t.queries.get(r);if(i){const a=i.Sa.indexOf(e);a>=0&&(i.Sa.splice(a,1),i.Sa.length===0?s=e.Da()?0:1:!i.ba()&&e.Da()&&(s=2))}switch(s){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function tT(n,e){const t=q(n);let r=!1;for(const s of e){const i=s.query,a=t.queries.get(i);if(a){for(const c of a.Sa)c.Fa(s)&&(r=!0);a.wa=s}}r&&vc(t)}function nT(n,e,t){const r=q(n),s=r.queries.get(e);if(s)for(const i of s.Sa)i.onError(t);r.queries.delete(e)}function vc(n){n.Ca.forEach((e=>{e.next()}))}var Ra,Xl;(Xl=Ra||(Ra={})).Ma="default",Xl.Cache="cache";class rT{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new pr(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const r=t!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=pr.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Ra.Cache}}class Ld{constructor(e){this.key=e}}class xd{constructor(e){this.key=e}}class sT{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=G(),this.mutatedKeys=G(),this.eu=rd(e),this.tu=new Zn(this.eu)}get nu(){return this.Ya}ru(e,t){const r=t?t.iu:new Kl,s=t?t.tu:this.tu;let i=t?t.mutatedKeys:this.mutatedKeys,a=s,c=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,h=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal(((d,m)=>{const g=s.get(d),w=Ji(this.query,m)?m:null,S=!!g&&this.mutatedKeys.has(g.key),k=!!w&&(w.hasLocalMutations||this.mutatedKeys.has(w.key)&&w.hasCommittedMutations);let P=!1;g&&w?g.data.isEqual(w.data)?S!==k&&(r.track({type:3,doc:w}),P=!0):this.su(g,w)||(r.track({type:2,doc:w}),P=!0,(l&&this.eu(w,l)>0||h&&this.eu(w,h)<0)&&(c=!0)):!g&&w?(r.track({type:0,doc:w}),P=!0):g&&!w&&(r.track({type:1,doc:g}),P=!0,(l||h)&&(c=!0)),P&&(w?(a=a.add(w),i=k?i.add(d):i.delete(d)):(a=a.delete(d),i=i.delete(d)))})),this.query.limit!==null)for(;a.size>this.query.limit;){const d=this.query.limitType==="F"?a.last():a.first();a=a.delete(d.key),i=i.delete(d.key),r.track({type:1,doc:d})}return{tu:a,iu:r,Cs:c,mutatedKeys:i}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,s){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const a=e.iu.ya();a.sort(((d,m)=>(function(w,S){const k=P=>{switch(P){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return U(20277,{Rt:P})}};return k(w)-k(S)})(d.type,m.type)||this.eu(d.doc,m.doc))),this.ou(r),s=s??!1;const c=t&&!s?this._u():[],l=this.Xa.size===0&&this.current&&!s?1:0,h=l!==this.Za;return this.Za=l,a.length!==0||h?{snapshot:new pr(this.query,e.tu,i,a,e.mutatedKeys,l===0,h,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:c}:{au:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Kl,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=G(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))}));const t=[];return e.forEach((r=>{this.Xa.has(r)||t.push(new xd(r))})),this.Xa.forEach((r=>{e.has(r)||t.push(new Ld(r))})),t}cu(e){this.Ya=e.Qs,this.Xa=G();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return pr.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Ec="SyncEngine";class iT{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class oT{constructor(e){this.key=e,this.hu=!1}}class aT{constructor(e,t,r,s,i,a){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new Mn((c=>nd(c)),Yi),this.Iu=new Map,this.Eu=new Set,this.du=new ae(F.comparator),this.Au=new Map,this.Ru=new uc,this.Vu={},this.mu=new Map,this.fu=dr.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function cT(n,e,t=!0){const r=$d(n);let s;const i=r.Tu.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.lu()):s=await Fd(r,e,t,!0),s}async function uT(n,e){const t=$d(n);await Fd(t,e,!0,!1)}async function Fd(n,e,t,r){const s=await bE(n.localStore,ft(e)),i=s.targetId,a=n.sharedClientState.addLocalQueryTarget(i,t);let c;return r&&(c=await lT(n,e,i,a==="current",s.resumeToken)),n.isPrimaryClient&&t&&kd(n.remoteStore,s),c}async function lT(n,e,t,r,s){n.pu=(m,g,w)=>(async function(k,P,x,N){let M=P.view.ru(x);M.Cs&&(M=await ql(k.localStore,P.query,!1).then((({documents:T})=>P.view.ru(T,M))));const Q=N&&N.targetChanges.get(P.targetId),te=N&&N.targetMismatches.get(P.targetId)!=null,Z=P.view.applyChanges(M,k.isPrimaryClient,Q,te);return Jl(k,P.targetId,Z.au),Z.snapshot})(n,m,g,w);const i=await ql(n.localStore,e,!0),a=new sT(e,i.Qs),c=a.ru(i.documents),l=Ps.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",s),h=a.applyChanges(c,n.isPrimaryClient,l);Jl(n,t,h.au);const d=new iT(e,t,a);return n.Tu.set(e,d),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),h.snapshot}async function hT(n,e,t){const r=q(n),s=r.Tu.get(e),i=r.Iu.get(s.targetId);if(i.length>1)return r.Iu.set(s.targetId,i.filter((a=>!Yi(a,e)))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await wa(r.localStore,s.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(s.targetId),t&&dc(r.remoteStore,s.targetId),ba(r,s.targetId)})).catch(Rr)):(ba(r,s.targetId),await wa(r.localStore,s.targetId,!0))}async function fT(n,e){const t=q(n),r=t.Tu.get(e),s=t.Iu.get(r.targetId);t.isPrimaryClient&&s.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),dc(t.remoteStore,r.targetId))}async function dT(n,e,t){const r=ET(n);try{const s=await(function(a,c){const l=q(a),h=ie.now(),d=c.reduce(((w,S)=>w.add(S.key)),G());let m,g;return l.persistence.runTransaction("Locally write mutations","readwrite",(w=>{let S=Ct(),k=G();return l.Ns.getEntries(w,d).next((P=>{S=P,S.forEach(((x,N)=>{N.isValidDocument()||(k=k.add(x))}))})).next((()=>l.localDocuments.getOverlayedDocuments(w,S))).next((P=>{m=P;const x=[];for(const N of c){const M=Rv(N,m.get(N.key).overlayedDocument);M!=null&&x.push(new hn(N.key,M,Qf(M.value.mapValue),tt.exists(!0)))}return l.mutationQueue.addMutationBatch(w,h,x,c)})).next((P=>{g=P;const x=P.applyToLocalDocumentSet(m,k);return l.documentOverlayCache.saveOverlays(w,P.batchId,x)}))})).then((()=>({batchId:g.batchId,changes:id(m)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),(function(a,c,l){let h=a.Vu[a.currentUser.toKey()];h||(h=new ae(W)),h=h.insert(c,l),a.Vu[a.currentUser.toKey()]=h})(r,s.batchId,t),await ks(r,s.changes),await so(r.remoteStore)}catch(s){const i=yc(s,"Failed to persist write");t.reject(i)}}async function Ud(n,e){const t=q(n);try{const r=await wE(t.localStore,e);e.targetChanges.forEach(((s,i)=>{const a=t.Au.get(i);a&&(J(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?a.hu=!0:s.modifiedDocuments.size>0?J(a.hu,14607):s.removedDocuments.size>0&&(J(a.hu,42227),a.hu=!1))})),await ks(t,r,e)}catch(r){await Rr(r)}}function Yl(n,e,t){const r=q(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const s=[];r.Tu.forEach(((i,a)=>{const c=a.view.va(e);c.snapshot&&s.push(c.snapshot)})),(function(a,c){const l=q(a);l.onlineState=c;let h=!1;l.queries.forEach(((d,m)=>{for(const g of m.Sa)g.va(c)&&(h=!0)})),h&&vc(l)})(r.eventManager,e),s.length&&r.Pu.H_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function pT(n,e,t){const r=q(n);r.sharedClientState.updateQueryState(e,"rejected",t);const s=r.Au.get(e),i=s&&s.key;if(i){let a=new ae(F.comparator);a=a.insert(i,Ce.newNoDocument(i,j.min()));const c=G().add(i),l=new to(j.min(),new Map,new ae(W),a,c);await Ud(r,l),r.du=r.du.remove(i),r.Au.delete(e),Tc(r)}else await wa(r.localStore,e,!1).then((()=>ba(r,e,t))).catch(Rr)}async function mT(n,e){const t=q(n),r=e.batch.batchId;try{const s=await IE(t.localStore,e);jd(t,r,null),Bd(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await ks(t,s)}catch(s){await Rr(s)}}async function gT(n,e,t){const r=q(n);try{const s=await(function(a,c){const l=q(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",(h=>{let d;return l.mutationQueue.lookupMutationBatch(h,c).next((m=>(J(m!==null,37113),d=m.keys(),l.mutationQueue.removeMutationBatch(h,m)))).next((()=>l.mutationQueue.performConsistencyCheck(h))).next((()=>l.documentOverlayCache.removeOverlaysForBatchId(h,d,c))).next((()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,d))).next((()=>l.localDocuments.getDocuments(h,d)))}))})(r.localStore,e);jd(r,e,t),Bd(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await ks(r,s)}catch(s){await Rr(s)}}function Bd(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function jd(n,e,t){const r=q(n);let s=r.Vu[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(t?i.reject(t):i.resolve(),s=s.remove(e)),r.Vu[r.currentUser.toKey()]=s}}function ba(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Iu.get(e))n.Tu.delete(r),t&&n.Pu.yu(r,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((r=>{n.Ru.containsKey(r)||qd(n,r)}))}function qd(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(dc(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),Tc(n))}function Jl(n,e,t){for(const r of t)r instanceof Ld?(n.Ru.addReference(r.key,e),_T(n,r)):r instanceof xd?(O(Ec,"Document no longer in limbo: "+r.key),n.Ru.removeReference(r.key,e),n.Ru.containsKey(r.key)||qd(n,r.key)):U(19791,{wu:r})}function _T(n,e){const t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Eu.has(r)||(O(Ec,"New document in limbo: "+t),n.Eu.add(r),Tc(n))}function Tc(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new F(se.fromString(e)),r=n.fu.next();n.Au.set(r,new oT(t)),n.du=n.du.insert(t,r),kd(n.remoteStore,new Gt(ft(rc(t.path)),r,"TargetPurposeLimboResolution",Gi.ce))}}async function ks(n,e,t){const r=q(n),s=[],i=[],a=[];r.Tu.isEmpty()||(r.Tu.forEach(((c,l)=>{a.push(r.pu(l,e,t).then((h=>{if((h||t)&&r.isPrimaryClient){const d=h?!h.fromCache:t?.targetChanges.get(l.targetId)?.current;r.sharedClientState.updateQueryState(l.targetId,d?"current":"not-current")}if(h){s.push(h);const d=hc.As(l.targetId,h);i.push(d)}})))})),await Promise.all(a),r.Pu.H_(s),await(async function(l,h){const d=q(l);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",(m=>C.forEach(h,(g=>C.forEach(g.Es,(w=>d.persistence.referenceDelegate.addReference(m,g.targetId,w))).next((()=>C.forEach(g.ds,(w=>d.persistence.referenceDelegate.removeReference(m,g.targetId,w)))))))))}catch(m){if(!br(m))throw m;O(fc,"Failed to update sequence numbers: "+m)}for(const m of h){const g=m.targetId;if(!m.fromCache){const w=d.Ms.get(g),S=w.snapshotVersion,k=w.withLastLimboFreeSnapshotVersion(S);d.Ms=d.Ms.insert(g,k)}}})(r.localStore,i))}async function yT(n,e){const t=q(n);if(!t.currentUser.isEqual(e)){O(Ec,"User change. New user:",e.toKey());const r=await bd(t.localStore,e);t.currentUser=e,(function(i,a){i.mu.forEach((c=>{c.forEach((l=>{l.reject(new L(V.CANCELLED,a))}))})),i.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await ks(t,r.Ls)}}function vT(n,e){const t=q(n),r=t.Au.get(e);if(r&&r.hu)return G().add(r.key);{let s=G();const i=t.Iu.get(e);if(!i)return s;for(const a of i){const c=t.Tu.get(a);s=s.unionWith(c.view.nu)}return s}}function $d(n){const e=q(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Ud.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=vT.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=pT.bind(null,e),e.Pu.H_=tT.bind(null,e.eventManager),e.Pu.yu=nT.bind(null,e.eventManager),e}function ET(n){const e=q(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=mT.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=gT.bind(null,e),e}class Vi{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=no(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return TE(this.persistence,new yE,e.initialUser,this.serializer)}Cu(e){return new Rd(lc.mi,this.serializer)}Du(e){return new PE}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Vi.provider={build:()=>new Vi};class TT extends Vi{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){J(this.persistence.referenceDelegate instanceof Ci,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new rE(r,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?Fe.withCacheSize(this.cacheSizeBytes):Fe.DEFAULT;return new Rd((r=>Ci.mi(r,t)),this.serializer)}}class Sa{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Yl(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=yT.bind(null,this.syncEngine),await XE(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new JE})()}createDatastore(e){const t=no(e.databaseInfo.databaseId),r=(function(i){return new NE(i)})(e.databaseInfo);return(function(i,a,c,l){return new xE(i,a,c,l)})(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return(function(r,s,i,a,c){return new UE(r,s,i,a,c)})(this.localStore,this.datastore,e.asyncQueue,(t=>Yl(this.syncEngine,t,0)),(function(){return Hl.v()?new Hl:new CE})())}createSyncEngine(e,t){return(function(s,i,a,c,l,h,d){const m=new aT(s,i,a,c,l,h);return d&&(m.gu=!0),m})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const r=q(t);O(Vn,"RemoteStore shutting down."),r.Ea.add(5),await Cs(r),r.Aa.shutdown(),r.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Sa.provider={build:()=>new Sa};class IT{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Pt("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const un="FirestoreClient";class wT{constructor(e,t,r,s,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=s,this.user=Pe.UNAUTHENTICATED,this.clientId=Xa.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,(async a=>{O(un,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a})),this.appCheckCredentials.start(r,(a=>(O(un,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new wn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=yc(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function Xo(n,e){n.asyncQueue.verifyOperationInProgress(),O(un,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener((async s=>{r.isEqual(s)||(await bd(e.localStore,s),r=s)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function Zl(n,e){n.asyncQueue.verifyOperationInProgress();const t=await AT(n);O(un,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((r=>Gl(e.remoteStore,r))),n.setAppCheckTokenChangeListener(((r,s)=>Gl(e.remoteStore,s))),n._onlineComponents=e}async function AT(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){O(un,"Using user provided OfflineComponentProvider");try{await Xo(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(s){return s.name==="FirebaseError"?s.code===V.FAILED_PRECONDITION||s.code===V.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11})(t))throw t;ur("Error using user provided cache. Falling back to memory cache: "+t),await Xo(n,new Vi)}}else O(un,"Using default OfflineComponentProvider"),await Xo(n,new TT(void 0));return n._offlineComponents}async function zd(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(O(un,"Using user provided OnlineComponentProvider"),await Zl(n,n._uninitializedComponentsProvider._online)):(O(un,"Using default OnlineComponentProvider"),await Zl(n,new Sa))),n._onlineComponents}function RT(n){return zd(n).then((e=>e.syncEngine))}async function eh(n){const e=await zd(n),t=e.eventManager;return t.onListen=cT.bind(null,e.syncEngine),t.onUnlisten=hT.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=uT.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=fT.bind(null,e.syncEngine),t}function Hd(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const th=new Map;const Wd="firestore.googleapis.com",nh=!0;class rh{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new L(V.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Wd,this.ssl=nh}else this.host=e.host,this.ssl=e.ssl??nh;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Ad;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<tE)throw new L(V.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Fy("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Hd(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new L(V.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new L(V.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new L(V.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,s){return r.timeoutSeconds===s.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class io{constructor(e,t,r,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new rh({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new L(V.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new L(V.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new rh(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new Py;switch(r.type){case"firstParty":return new Dy(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new L(V.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const r=th.get(t);r&&(O("ComponentProvider","Removing Datastore"),th.delete(t),r.terminate())})(this),Promise.resolve()}}function bT(n,e,t,r={}){n=tn(n,io);const s=Ir(e),i=n._getSettings(),a={...i,emulatorOptions:n._getEmulatorOptions()},c=`${e}:${t}`;s&&(If(`https://${c}`),wf("Firestore",!0)),i.host!==Wd&&i.host!==c&&ur("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...i,host:c,ssl:s,emulatorOptions:r};if(!Pn(l,a)&&(n._setSettings(l),r.mockUserToken)){let h,d;if(typeof r.mockUserToken=="string")h=r.mockUserToken,d=Pe.MOCK_USER;else{h=Zg(r.mockUserToken,n._app?.options.projectId);const m=r.mockUserToken.sub||r.mockUserToken.user_id;if(!m)throw new L(V.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new Pe(m)}n._authCredentials=new Cy(new xf(h,d))}}class oo{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new oo(this.firestore,e,this._query)}}class _e{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new nn(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new _e(this.firestore,e,this._key)}toJSON(){return{type:_e._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(bs(t,_e._jsonSchema))return new _e(e,r||null,new F(se.fromString(t.referencePath)))}}_e._jsonSchemaVersion="firestore/documentReference/1.0",_e._jsonSchema={type:de("string",_e._jsonSchemaVersion),referencePath:de("string")};class nn extends oo{constructor(e,t,r){super(e,t,rc(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new _e(this.firestore,null,new F(e))}withConverter(e){return new nn(this.firestore,e,this._path)}}function Gd(n,e,...t){if(n=we(n),Ff("collection","path",e),n instanceof io){const r=se.fromString(e,...t);return gl(r),new nn(n,null,r)}{if(!(n instanceof _e||n instanceof nn))throw new L(V.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(se.fromString(e,...t));return gl(r),new nn(n.firestore,null,r)}}function Ic(n,e,...t){if(n=we(n),arguments.length===1&&(e=Xa.newId()),Ff("doc","path",e),n instanceof io){const r=se.fromString(e,...t);return ml(r),new _e(n,null,new F(r))}{if(!(n instanceof _e||n instanceof nn))throw new L(V.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(se.fromString(e,...t));return ml(r),new _e(n.firestore,n instanceof nn?n.converter:null,new F(r))}}const sh="AsyncQueue";class ih{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Pd(this,"async_queue_retry"),this._c=()=>{const r=Qo();r&&O(sh,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const t=Qo();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Qo();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new wn;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!br(e))throw e;O(sh,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((r=>{throw this.nc=r,this.rc=!1,Pt("INTERNAL UNHANDLED ERROR: ",oh(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const s=_c.createAndSchedule(this,e,t,r,(i=>this.hc(i)));return this.tc.push(s),s}uc(){this.nc&&U(47125,{Pc:oh(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,r)=>t.targetTimeMs-r.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function oh(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}function ah(n){return(function(t,r){if(typeof t!="object"||t===null)return!1;const s=t;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1})(n,["next","error","complete"])}class mr extends io{constructor(e,t,r,s){super(e,t,r,s),this.type="firestore",this._queue=new ih,this._persistenceKey=s?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new ih(e),this._firestoreClient=void 0,await e}}}function ST(n,e){const t=typeof n=="object"?n:Sf(),r=typeof n=="string"?n:Ii,s=Ka(t,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=Yg("firestore");i&&bT(s,...i)}return s}function Kd(n){if(n._terminated)throw new L(V.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||PT(n),n._firestoreClient}function PT(n){const e=n._freezeSettings(),t=(function(s,i,a,c){return new Qy(s,i,a,c.host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,Hd(c.experimentalLongPollingOptions),c.useFetchStreams,c.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new wT(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(s){const i=s?._online.build();return{_offline:s?._offline.build(i),_online:i}})(n._componentsProvider))}class Ye{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Ye(Ae.fromBase64String(e))}catch(t){throw new L(V.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Ye(Ae.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Ye._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(bs(e,Ye._jsonSchema))return Ye.fromBase64String(e.bytes)}}Ye._jsonSchemaVersion="firestore/bytes/1.0",Ye._jsonSchema={type:de("string",Ye._jsonSchemaVersion),bytes:de("string")};class ao{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new L(V.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ie(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class wc{constructor(e){this._methodName=e}}class pt{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new L(V.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new L(V.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return W(this._lat,e._lat)||W(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:pt._jsonSchemaVersion}}static fromJSON(e){if(bs(e,pt._jsonSchema))return new pt(e.latitude,e.longitude)}}pt._jsonSchemaVersion="firestore/geoPoint/1.0",pt._jsonSchema={type:de("string",pt._jsonSchemaVersion),latitude:de("number"),longitude:de("number")};class mt{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0})(this._values,e._values)}toJSON(){return{type:mt._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(bs(e,mt._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new mt(e.vectorValues);throw new L(V.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}mt._jsonSchemaVersion="firestore/vectorValue/1.0",mt._jsonSchema={type:de("string",mt._jsonSchemaVersion),vectorValues:de("object")};const CT=/^__.*__$/;class kT{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new hn(e,this.data,this.fieldMask,t,this.fieldTransforms):new Ss(e,this.data,t,this.fieldTransforms)}}class Qd{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new hn(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Xd(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw U(40011,{Ac:n})}}class Ac{constructor(e,t,r,s,i,a){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Ac({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.gc(e),r}yc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Di(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(Xd(this.Ac)&&CT.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class VT{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||no(e)}Cc(e,t,r,s=!1){return new Ac({Ac:e,methodName:t,Dc:r,path:Ie.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Yd(n){const e=n._freezeSettings(),t=no(n._databaseId);return new VT(n._databaseId,!!e.ignoreUndefinedProperties,t)}function DT(n,e,t,r,s,i={}){const a=n.Cc(i.merge||i.mergeFields?2:0,e,t,s);Rc("Data must be an object, but it was:",a,r);const c=Jd(r,a);let l,h;if(i.merge)l=new Ge(a.fieldMask),h=a.fieldTransforms;else if(i.mergeFields){const d=[];for(const m of i.mergeFields){const g=Pa(e,m,t);if(!a.contains(g))throw new L(V.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);ep(d,g)||d.push(g)}l=new Ge(d),h=a.fieldTransforms.filter((m=>l.covers(m.field)))}else l=null,h=a.fieldTransforms;return new kT(new Be(c),l,h)}class co extends wc{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof co}}function NT(n,e,t,r){const s=n.Cc(1,e,t);Rc("Data must be an object, but it was:",s,r);const i=[],a=Be.empty();ln(r,((l,h)=>{const d=bc(e,l,t);h=we(h);const m=s.yc(d);if(h instanceof co)i.push(d);else{const g=uo(h,m);g!=null&&(i.push(d),a.set(d,g))}}));const c=new Ge(i);return new Qd(a,c,s.fieldTransforms)}function OT(n,e,t,r,s,i){const a=n.Cc(1,e,t),c=[Pa(e,r,t)],l=[s];if(i.length%2!=0)throw new L(V.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<i.length;g+=2)c.push(Pa(e,i[g])),l.push(i[g+1]);const h=[],d=Be.empty();for(let g=c.length-1;g>=0;--g)if(!ep(h,c[g])){const w=c[g];let S=l[g];S=we(S);const k=a.yc(w);if(S instanceof co)h.push(w);else{const P=uo(S,k);P!=null&&(h.push(w),d.set(w,P))}}const m=new Ge(h);return new Qd(d,m,a.fieldTransforms)}function uo(n,e){if(Zd(n=we(n)))return Rc("Unsupported field value:",e,n),Jd(n,e);if(n instanceof wc)return(function(r,s){if(!Xd(s.Ac))throw s.Sc(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(r,s){const i=[];let a=0;for(const c of r){let l=uo(c,s.wc(a));l==null&&(l={nullValue:"NULL_VALUE"}),i.push(l),a++}return{arrayValue:{values:i}}})(n,e)}return(function(r,s){if((r=we(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return vv(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=ie.fromDate(r);return{timestampValue:Pi(s.serializer,i)}}if(r instanceof ie){const i=new ie(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Pi(s.serializer,i)}}if(r instanceof pt)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Ye)return{bytesValue:_d(s.serializer,r._byteString)};if(r instanceof _e){const i=s.databaseId,a=r.firestore._databaseId;if(!a.isEqual(i))throw s.Sc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:cc(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof mt)return(function(a,c){return{mapValue:{fields:{[Gf]:{stringValue:Kf},[wi]:{arrayValue:{values:a.toArray().map((h=>{if(typeof h!="number")throw c.Sc("VectorValues must only contain numeric values.");return sc(c.serializer,h)}))}}}}}})(r,s);throw s.Sc(`Unsupported field value: ${Ya(r)}`)})(n,e)}function Jd(n,e){const t={};return jf(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ln(n,((r,s)=>{const i=uo(s,e.mc(r));i!=null&&(t[r]=i)})),{mapValue:{fields:t}}}function Zd(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof ie||n instanceof pt||n instanceof Ye||n instanceof _e||n instanceof wc||n instanceof mt)}function Rc(n,e,t){if(!Zd(t)||!Uf(t)){const r=Ya(t);throw r==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+r)}}function Pa(n,e,t){if((e=we(e))instanceof ao)return e._internalPath;if(typeof e=="string")return bc(n,e);throw Di("Field path arguments must be of type string or ",n,!1,void 0,t)}const MT=new RegExp("[~\\*/\\[\\]]");function bc(n,e,t){if(e.search(MT)>=0)throw Di(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new ao(...e.split("."))._internalPath}catch{throw Di(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Di(n,e,t,r,s){const i=r&&!r.isEmpty(),a=s!==void 0;let c=`Function ${e}() called with invalid data`;t&&(c+=" (via `toFirestore()`)"),c+=". ";let l="";return(i||a)&&(l+=" (found",i&&(l+=` in field ${r}`),a&&(l+=` in document ${s}`),l+=")"),new L(V.INVALID_ARGUMENT,c+n+l)}function ep(n,e){return n.some((t=>t.isEqual(e)))}class tp{constructor(e,t,r,s,i){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new _e(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new LT(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(np("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class LT extends tp{data(){return super.data()}}function np(n,e){return typeof e=="string"?bc(n,e):e instanceof ao?e._internalPath:e._delegate._internalPath}function xT(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new L(V.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class FT{convertValue(e,t="none"){switch(an(e)){case 0:return null;case 1:return e.booleanValue;case 2:return le(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(on(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw U(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return ln(e,((s,i)=>{r[s]=this.convertValue(i,t)})),r}convertVectorValue(e){const t=e.fields?.[wi].arrayValue?.values?.map((r=>le(r.doubleValue)));return new mt(t)}convertGeoPoint(e){return new pt(le(e.latitude),le(e.longitude))}convertArray(e,t){return(e.values||[]).map((r=>this.convertValue(r,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const r=Qi(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(ds(e));default:return null}}convertTimestamp(e){const t=sn(e);return new ie(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=se.fromString(e);J(wd(r),9688,{name:e});const s=new ps(r.get(1),r.get(3)),i=new F(r.popFirst(5));return s.isEqual(t)||Pt(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}function UT(n,e,t){let r;return r=n?n.toFirestore(e):e,r}class Qr{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class An extends tp{constructor(e,t,r,s,i,a){super(e,t,r,s,a),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new li(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(np("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new L(V.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=An._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}An._jsonSchemaVersion="firestore/documentSnapshot/1.0",An._jsonSchema={type:de("string",An._jsonSchemaVersion),bundleSource:de("string","DocumentSnapshot"),bundleName:de("string"),bundle:de("string")};class li extends An{data(e={}){return super.data(e)}}class er{constructor(e,t,r,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new Qr(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((r=>{e.call(t,new li(this._firestore,this._userDataWriter,r.key,r,new Qr(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new L(V.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(s,i){if(s._snapshot.oldDocs.isEmpty()){let a=0;return s._snapshot.docChanges.map((c=>{const l=new li(s._firestore,s._userDataWriter,c.doc.key,c.doc,new Qr(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);return c.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}}))}{let a=s._snapshot.oldDocs;return s._snapshot.docChanges.filter((c=>i||c.type!==3)).map((c=>{const l=new li(s._firestore,s._userDataWriter,c.doc.key,c.doc,new Qr(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);let h=-1,d=-1;return c.type!==0&&(h=a.indexOf(c.doc.key),a=a.delete(c.doc.key)),c.type!==1&&(a=a.add(c.doc),d=a.indexOf(c.doc.key)),{type:BT(c.type),doc:l,oldIndex:h,newIndex:d}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new L(V.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=er._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Xa.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],s=[];return this.docs.forEach((i=>{i._document!==null&&(t.push(i._document),r.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),s.push(i.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function BT(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return U(61501,{type:n})}}er._jsonSchemaVersion="firestore/querySnapshot/1.0",er._jsonSchema={type:de("string",er._jsonSchemaVersion),bundleSource:de("string","QuerySnapshot"),bundleName:de("string"),bundle:de("string")};class rp extends FT{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ye(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new _e(this.firestore,null,t)}}function jT(n,e,t,...r){n=tn(n,_e);const s=tn(n.firestore,mr),i=Yd(s);let a;return a=typeof(e=we(e))=="string"||e instanceof ao?OT(i,"updateDoc",n._key,e,t,r):NT(i,"updateDoc",n._key,e),Sc(s,[a.toMutation(n._key,tt.exists(!0))])}function qT(n){return Sc(tn(n.firestore,mr),[new ic(n._key,tt.none())])}function $T(n,e){const t=tn(n.firestore,mr),r=Ic(n),s=UT(n.converter,e);return Sc(t,[DT(Yd(n.firestore),"addDoc",r._key,s,n.converter!==null,{}).toMutation(r._key,tt.exists(!1))]).then((()=>r))}function zT(n,...e){n=we(n);let t={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||ah(e[r])||(t=e[r++]);const s={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(ah(e[r])){const l=e[r];e[r]=l.next?.bind(l),e[r+1]=l.error?.bind(l),e[r+2]=l.complete?.bind(l)}let i,a,c;if(n instanceof _e)a=tn(n.firestore,mr),c=rc(n._key.path),i={next:l=>{e[r]&&e[r](HT(a,n,l))},error:e[r+1],complete:e[r+2]};else{const l=tn(n,oo);a=tn(l.firestore,mr),c=l._query;const h=new rp(a);i={next:d=>{e[r]&&e[r](new er(a,h,l,d))},error:e[r+1],complete:e[r+2]},xT(n._query)}return(function(h,d,m,g){const w=new IT(g),S=new rT(d,w,m);return h.asyncQueue.enqueueAndForget((async()=>ZE(await eh(h),S))),()=>{w.Nu(),h.asyncQueue.enqueueAndForget((async()=>eT(await eh(h),S)))}})(Kd(a),c,s,i)}function Sc(n,e){return(function(r,s){const i=new wn;return r.asyncQueue.enqueueAndForget((async()=>dT(await RT(r),s,i))),i.promise})(Kd(n),e)}function HT(n,e,t){const r=t.docs.get(e._key),s=new rp(n);return new An(n,s,e._key,r,new Qr(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(s){Ar=s})(wr),cr(new Cn("firestore",((r,{instanceIdentifier:s,options:i})=>{const a=r.getProvider("app").getImmediate(),c=new mr(new ky(r.getProvider("auth-internal")),new Ny(a,r.getProvider("app-check-internal")),(function(h,d){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new L(V.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ps(h.options.projectId,d)})(a,s),a);return i={useFetchStreams:t,...i},c._setSettings(i),c}),"PUBLIC").setMultipleInstances(!0)),Zt(hl,fl,e),Zt(hl,fl,"esm2020")})();function sp(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const WT=sp,ip=new As("auth","Firebase",sp());const Ni=new Wa("@firebase/auth");function GT(n,...e){Ni.logLevel<=H.WARN&&Ni.warn(`Auth (${wr}): ${n}`,...e)}function hi(n,...e){Ni.logLevel<=H.ERROR&&Ni.error(`Auth (${wr}): ${n}`,...e)}function Et(n,...e){throw Cc(n,...e)}function nt(n,...e){return Cc(n,...e)}function Pc(n,e,t){const r={...WT(),[e]:t};return new As("auth","Firebase",r).create(e,{appName:n.name})}function Rn(n){return Pc(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function KT(n,e,t){const r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&Et(n,"argument-error"),Pc(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Cc(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return ip.create(n,...e)}function B(n,e,...t){if(!n)throw Cc(e,...t)}function At(n){const e="INTERNAL ASSERTION FAILED: "+n;throw hi(e),new Error(e)}function kt(n,e){n||At(e)}function Ca(){return typeof self<"u"&&self.location?.href||""}function QT(){return ch()==="http:"||ch()==="https:"}function ch(){return typeof self<"u"&&self.location?.protocol||null}function XT(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(QT()||i_()||"connection"in navigator)?navigator.onLine:!0}function YT(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class Vs{constructor(e,t){this.shortDelay=e,this.longDelay=t,kt(t>e,"Short delay should be less than long delay!"),this.isMobile=n_()||o_()}get(){return XT()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function kc(n,e){kt(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class op{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;At("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;At("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;At("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const JT={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const ZT=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],eI=new Vs(3e4,6e4);function Vc(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Pr(n,e,t,r,s={}){return ap(n,s,async()=>{let i={},a={};r&&(e==="GET"?a=r:i={body:JSON.stringify(r)});const c=Rs({key:n.config.apiKey,...a}).slice(1),l=await n._getAdditionalHeaders();l["Content-Type"]="application/json",n.languageCode&&(l["X-Firebase-Locale"]=n.languageCode);const h={method:e,headers:l,...i};return s_()||(h.referrerPolicy="no-referrer"),n.emulatorConfig&&Ir(n.emulatorConfig.host)&&(h.credentials="include"),op.fetch()(await cp(n,n.config.apiHost,t,c),h)})}async function ap(n,e,t){n._canInitEmulator=!1;const r={...JT,...e};try{const s=new nI(n),i=await Promise.race([t(),s.promise]);s.clearNetworkTimeout();const a=await i.json();if("needConfirmation"in a)throw ni(n,"account-exists-with-different-credential",a);if(i.ok&&!("errorMessage"in a))return a;{const c=i.ok?a.errorMessage:a.error.message,[l,h]=c.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw ni(n,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw ni(n,"email-already-in-use",a);if(l==="USER_DISABLED")throw ni(n,"user-disabled",a);const d=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw Pc(n,d,h);Et(n,d)}}catch(s){if(s instanceof Mt)throw s;Et(n,"network-request-failed",{message:String(s)})}}async function tI(n,e,t,r,s={}){const i=await Pr(n,e,t,r,s);return"mfaPendingCredential"in i&&Et(n,"multi-factor-auth-required",{_serverResponse:i}),i}async function cp(n,e,t,r){const s=`${e}${t}?${r}`,i=n,a=i.config.emulator?kc(n.config,s):`${n.config.apiScheme}://${s}`;return ZT.includes(t)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(a).toString():a}class nI{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(nt(this.auth,"network-request-failed")),eI.get())})}}function ni(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const s=nt(n,e,r);return s.customData._tokenResponse=t,s}async function rI(n,e){return Pr(n,"POST","/v1/accounts:delete",e)}async function Oi(n,e){return Pr(n,"POST","/v1/accounts:lookup",e)}function os(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function sI(n,e=!1){const t=we(n),r=await t.getIdToken(e),s=Dc(r);B(s&&s.exp&&s.auth_time&&s.iat,t.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,a=i?.sign_in_provider;return{claims:s,token:r,authTime:os(Yo(s.auth_time)),issuedAtTime:os(Yo(s.iat)),expirationTime:os(Yo(s.exp)),signInProvider:a||null,signInSecondFactor:i?.sign_in_second_factor||null}}function Yo(n){return Number(n)*1e3}function Dc(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return hi("JWT malformed, contained fewer than 3 sections"),null;try{const s=yf(t);return s?JSON.parse(s):(hi("Failed to decode base64 JWT payload"),null)}catch(s){return hi("Caught error parsing JWT payload as JSON",s?.toString()),null}}function uh(n){const e=Dc(n);return B(e,"internal-error"),B(typeof e.exp<"u","internal-error"),B(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function ys(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof Mt&&iI(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function iI({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class oI{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class ka{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=os(this.lastLoginAt),this.creationTime=os(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Mi(n){const e=n.auth,t=await n.getIdToken(),r=await ys(n,Oi(e,{idToken:t}));B(r?.users.length,e,"internal-error");const s=r.users[0];n._notifyReloadListener(s);const i=s.providerUserInfo?.length?up(s.providerUserInfo):[],a=cI(n.providerData,i),c=n.isAnonymous,l=!(n.email&&s.passwordHash)&&!a?.length,h=c?l:!1,d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new ka(s.createdAt,s.lastLoginAt),isAnonymous:h};Object.assign(n,d)}async function aI(n){const e=we(n);await Mi(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function cI(n,e){return[...n.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function up(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function uI(n,e){const t=await ap(n,{},async()=>{const r=Rs({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=n.config,a=await cp(n,s,"/v1/token",`key=${i}`),c=await n._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:c,body:r};return n.emulatorConfig&&Ir(n.emulatorConfig.host)&&(l.credentials="include"),op.fetch()(a,l)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function lI(n,e){return Pr(n,"POST","/v2/accounts:revokeToken",Vc(n,e))}class tr{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){B(e.idToken,"internal-error"),B(typeof e.idToken<"u","internal-error"),B(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):uh(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){B(e.length!==0,"internal-error");const t=uh(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(B(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:s,expiresIn:i}=await uI(e,t);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:s,expirationTime:i}=t,a=new tr;return r&&(B(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),s&&(B(typeof s=="string","internal-error",{appName:e}),a.accessToken=s),i&&(B(typeof i=="number","internal-error",{appName:e}),a.expirationTime=i),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new tr,this.toJSON())}_performRefresh(){return At("not implemented")}}function $t(n,e){B(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class et{constructor({uid:e,auth:t,stsTokenManager:r,...s}){this.providerId="firebase",this.proactiveRefresh=new oI(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new ka(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await ys(this,this.stsTokenManager.getToken(this.auth,e));return B(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return sI(this,e)}reload(){return aI(this)}_assign(e){this!==e&&(B(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new et({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){B(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await Mi(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Ze(this.auth.app))return Promise.reject(Rn(this.auth));const e=await this.getIdToken();return await ys(this,rI(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const r=t.displayName??void 0,s=t.email??void 0,i=t.phoneNumber??void 0,a=t.photoURL??void 0,c=t.tenantId??void 0,l=t._redirectEventId??void 0,h=t.createdAt??void 0,d=t.lastLoginAt??void 0,{uid:m,emailVerified:g,isAnonymous:w,providerData:S,stsTokenManager:k}=t;B(m&&k,e,"internal-error");const P=tr.fromJSON(this.name,k);B(typeof m=="string",e,"internal-error"),$t(r,e.name),$t(s,e.name),B(typeof g=="boolean",e,"internal-error"),B(typeof w=="boolean",e,"internal-error"),$t(i,e.name),$t(a,e.name),$t(c,e.name),$t(l,e.name),$t(h,e.name),$t(d,e.name);const x=new et({uid:m,auth:e,email:s,emailVerified:g,displayName:r,isAnonymous:w,photoURL:a,phoneNumber:i,tenantId:c,stsTokenManager:P,createdAt:h,lastLoginAt:d});return S&&Array.isArray(S)&&(x.providerData=S.map(N=>({...N}))),l&&(x._redirectEventId=l),x}static async _fromIdTokenResponse(e,t,r=!1){const s=new tr;s.updateFromServerResponse(t);const i=new et({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await Mi(i),i}static async _fromGetAccountInfoResponse(e,t,r){const s=t.users[0];B(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?up(s.providerUserInfo):[],a=!(s.email&&s.passwordHash)&&!i?.length,c=new tr;c.updateFromIdToken(r);const l=new et({uid:s.localId,auth:e,stsTokenManager:c,isAnonymous:a}),h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new ka(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!i?.length};return Object.assign(l,h),l}}const lh=new Map;function Rt(n){kt(n instanceof Function,"Expected a class definition");let e=lh.get(n);return e?(kt(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,lh.set(n,e),e)}class lp{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}lp.type="NONE";const hh=lp;function fi(n,e,t){return`firebase:${n}:${e}:${t}`}class nr{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=fi(this.userKey,s.apiKey,i),this.fullPersistenceKey=fi("persistence",s.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Oi(this.auth,{idToken:e}).catch(()=>{});return t?et._fromGetAccountInfoResponse(this.auth,t,e):null}return et._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new nr(Rt(hh),e,r);const s=(await Promise.all(t.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let i=s[0]||Rt(hh);const a=fi(r,e.config.apiKey,e.name);let c=null;for(const h of t)try{const d=await h._get(a);if(d){let m;if(typeof d=="string"){const g=await Oi(e,{idToken:d}).catch(()=>{});if(!g)break;m=await et._fromGetAccountInfoResponse(e,g,d)}else m=et._fromJSON(e,d);h!==i&&(c=m),i=h;break}}catch{}const l=s.filter(h=>h._shouldAllowMigration);return!i._shouldAllowMigration||!l.length?new nr(i,e,r):(i=l[0],c&&await i._set(a,c.toJSON()),await Promise.all(t.map(async h=>{if(h!==i)try{await h._remove(a)}catch{}})),new nr(i,e,r))}}function fh(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(pp(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(hp(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(gp(e))return"Blackberry";if(_p(e))return"Webos";if(fp(e))return"Safari";if((e.includes("chrome/")||dp(e))&&!e.includes("edge/"))return"Chrome";if(mp(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function hp(n=Ne()){return/firefox\//i.test(n)}function fp(n=Ne()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function dp(n=Ne()){return/crios\//i.test(n)}function pp(n=Ne()){return/iemobile/i.test(n)}function mp(n=Ne()){return/android/i.test(n)}function gp(n=Ne()){return/blackberry/i.test(n)}function _p(n=Ne()){return/webos/i.test(n)}function Nc(n=Ne()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function hI(n=Ne()){return Nc(n)&&!!window.navigator?.standalone}function fI(){return a_()&&document.documentMode===10}function yp(n=Ne()){return Nc(n)||mp(n)||_p(n)||gp(n)||/windows phone/i.test(n)||pp(n)}function vp(n,e=[]){let t;switch(n){case"Browser":t=fh(Ne());break;case"Worker":t=`${fh(Ne())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${wr}/${r}`}class dI{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=i=>new Promise((a,c)=>{try{const l=e(i);a(l)}catch(l){c(l)}});r.onAbort=t,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const s of t)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}}async function pI(n,e={}){return Pr(n,"GET","/v2/passwordPolicy",Vc(n,e))}const mI=6;class gI{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??mI,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),s&&(t.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}class _I{constructor(e,t,r,s){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new dh(this),this.idTokenSubscription=new dh(this),this.beforeStateQueue=new dI(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=ip,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Rt(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await nr.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Oi(this,{idToken:e}),r=await et._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Ze(this.app)){const i=this.app.settings.authIdToken;return i?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(i).then(a,a))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let r=t,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const i=this.redirectUser?._redirectEventId,a=r?._redirectEventId,c=await this.tryRedirectSignIn(e);(!i||i===a)&&c?.user&&(r=c.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(i){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(i))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return B(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Mi(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=YT()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Ze(this.app))return Promise.reject(Rn(this));const t=e?we(e):null;return t&&B(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&B(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Ze(this.app)?Promise.reject(Rn(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Ze(this.app)?Promise.reject(Rn(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Rt(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await pI(this),t=new gI(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new As("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await lI(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Rt(e)||this._popupRedirectResolver;B(t,this,"argument-error"),this.redirectPersistenceManager=await nr.create(this,[Rt(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,s){if(this._deleted)return()=>{};const i=typeof t=="function"?t:t.next.bind(t);let a=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(B(c,this,"internal-error"),c.then(()=>{a||i(this.currentUser)}),typeof t=="function"){const l=e.addObserver(t,r,s);return()=>{a=!0,l()}}else{const l=e.addObserver(t);return()=>{a=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return B(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=vp(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(Ze(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&GT(`Error while retrieving App Check token: ${e.error}`),e?.token}}function lo(n){return we(n)}class dh{constructor(e){this.auth=e,this.observer=null,this.addObserver=m_(t=>this.observer=t)}get next(){return B(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Oc={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function yI(n){Oc=n}function vI(n){return Oc.loadJS(n)}function EI(){return Oc.gapiScript}function TI(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function II(n,e){const t=Ka(n,"auth");if(t.isInitialized()){const s=t.getImmediate(),i=t.getOptions();if(Pn(i,e??{}))return s;Et(s,"already-initialized")}return t.initialize({options:e})}function wI(n,e){const t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(Rt);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function AI(n,e,t){const r=lo(n);B(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=Ep(e),{host:a,port:c}=RI(e),l=c===null?"":`:${c}`,h={url:`${i}//${a}${l}/`},d=Object.freeze({host:a,port:c,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){B(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),B(Pn(h,r.config.emulator)&&Pn(d,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=h,r.emulatorConfig=d,r.settings.appVerificationDisabledForTesting=!0,Ir(a)?(If(`${i}//${a}${l}`),wf("Auth",!0)):bI()}function Ep(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function RI(n){const e=Ep(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:ph(r.substr(i.length+1))}}else{const[i,a]=r.split(":");return{host:i,port:ph(a)}}}function ph(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function bI(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class Tp{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return At("not implemented")}_getIdTokenResponse(e){return At("not implemented")}_linkToIdToken(e,t){return At("not implemented")}_getReauthenticationResolver(e){return At("not implemented")}}async function rr(n,e){return tI(n,"POST","/v1/accounts:signInWithIdp",Vc(n,e))}const SI="http://localhost";class Dn extends Tp{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Dn(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Et("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,...i}=t;if(!r||!s)return null;const a=new Dn(r,s);return a.idToken=i.idToken||void 0,a.accessToken=i.accessToken||void 0,a.secret=i.secret,a.nonce=i.nonce,a.pendingToken=i.pendingToken||null,a}_getIdTokenResponse(e){const t=this.buildRequest();return rr(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,rr(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,rr(e,t)}buildRequest(){const e={requestUri:SI,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Rs(t)}return e}}class Mc{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Ds extends Mc{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class zt extends Ds{constructor(){super("facebook.com")}static credential(e){return Dn._fromParams({providerId:zt.PROVIDER_ID,signInMethod:zt.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return zt.credentialFromTaggedObject(e)}static credentialFromError(e){return zt.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return zt.credential(e.oauthAccessToken)}catch{return null}}}zt.FACEBOOK_SIGN_IN_METHOD="facebook.com";zt.PROVIDER_ID="facebook.com";class wt extends Ds{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Dn._fromParams({providerId:wt.PROVIDER_ID,signInMethod:wt.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return wt.credentialFromTaggedObject(e)}static credentialFromError(e){return wt.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return wt.credential(t,r)}catch{return null}}}wt.GOOGLE_SIGN_IN_METHOD="google.com";wt.PROVIDER_ID="google.com";class Ht extends Ds{constructor(){super("github.com")}static credential(e){return Dn._fromParams({providerId:Ht.PROVIDER_ID,signInMethod:Ht.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ht.credentialFromTaggedObject(e)}static credentialFromError(e){return Ht.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ht.credential(e.oauthAccessToken)}catch{return null}}}Ht.GITHUB_SIGN_IN_METHOD="github.com";Ht.PROVIDER_ID="github.com";class Wt extends Ds{constructor(){super("twitter.com")}static credential(e,t){return Dn._fromParams({providerId:Wt.PROVIDER_ID,signInMethod:Wt.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Wt.credentialFromTaggedObject(e)}static credentialFromError(e){return Wt.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return Wt.credential(t,r)}catch{return null}}}Wt.TWITTER_SIGN_IN_METHOD="twitter.com";Wt.PROVIDER_ID="twitter.com";class gr{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,s=!1){const i=await et._fromIdTokenResponse(e,r,s),a=mh(r);return new gr({user:i,providerId:a,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const s=mh(r);return new gr({user:e,providerId:s,_tokenResponse:r,operationType:t})}}function mh(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class Li extends Mt{constructor(e,t,r,s){super(t.code,t.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,Li.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,s){return new Li(e,t,r,s)}}function Ip(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Li._fromErrorAndOperation(n,i,e,r):i})}async function PI(n,e,t=!1){const r=await ys(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return gr._forOperation(n,"link",r)}async function CI(n,e,t=!1){const{auth:r}=n;if(Ze(r.app))return Promise.reject(Rn(r));const s="reauthenticate";try{const i=await ys(n,Ip(r,s,e,n),t);B(i.idToken,r,"internal-error");const a=Dc(i.idToken);B(a,r,"internal-error");const{sub:c}=a;return B(n.uid===c,r,"user-mismatch"),gr._forOperation(n,s,i)}catch(i){throw i?.code==="auth/user-not-found"&&Et(r,"user-mismatch"),i}}async function kI(n,e,t=!1){if(Ze(n.app))return Promise.reject(Rn(n));const r="signIn",s=await Ip(n,r,e),i=await gr._fromIdTokenResponse(n,r,s);return t||await n._updateCurrentUser(i.user),i}function VI(n,e,t,r){return we(n).onIdTokenChanged(e,t,r)}function DI(n,e,t){return we(n).beforeAuthStateChanged(e,t)}function NI(n,e,t,r){return we(n).onAuthStateChanged(e,t,r)}function OI(n){return we(n).signOut()}const xi="__sak";class wp{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(xi,"1"),this.storage.removeItem(xi),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const MI=1e3,LI=10;class Ap extends wp{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=yp(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),s=this.localCache[t];r!==s&&e(t,s,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((a,c,l)=>{this.notifyListeners(a,l)});return}const r=e.key;t?this.detachListener():this.stopPolling();const s=()=>{const a=this.storage.getItem(r);!t&&this.localCache[r]===a||this.notifyListeners(r,a)},i=this.storage.getItem(r);fI()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,LI):s()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},MI)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Ap.type="LOCAL";const xI=Ap;class Rp extends wp{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Rp.type="SESSION";const bp=Rp;function FI(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class ho{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(s=>s.isListeningto(e));if(t)return t;const r=new ho(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:s,data:i}=t.data,a=this.handlersMap[s];if(!a?.size)return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const c=Array.from(a).map(async h=>h(t.origin,i)),l=await FI(c);t.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:l})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}ho.receivers=[];function Lc(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}class UI{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,a;return new Promise((c,l)=>{const h=Lc("",20);s.port1.start();const d=setTimeout(()=>{l(new Error("unsupported_event"))},r);a={messageChannel:s,onMessage(m){const g=m;if(g.data.eventId===h)switch(g.data.status){case"ack":clearTimeout(d),i=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),c(g.data.response);break;default:clearTimeout(d),clearTimeout(i),l(new Error("invalid_response"));break}}},this.handlers.add(a),s.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:h,data:t},[s.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}function gt(){return window}function BI(n){gt().location.href=n}function Sp(){return typeof gt().WorkerGlobalScope<"u"&&typeof gt().importScripts=="function"}async function jI(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function qI(){return navigator?.serviceWorker?.controller||null}function $I(){return Sp()?self:null}const Pp="firebaseLocalStorageDb",zI=1,Fi="firebaseLocalStorage",Cp="fbase_key";class Ns{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function fo(n,e){return n.transaction([Fi],e?"readwrite":"readonly").objectStore(Fi)}function HI(){const n=indexedDB.deleteDatabase(Pp);return new Ns(n).toPromise()}function Va(){const n=indexedDB.open(Pp,zI);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(Fi,{keyPath:Cp})}catch(s){t(s)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(Fi)?e(r):(r.close(),await HI(),e(await Va()))})})}async function gh(n,e,t){const r=fo(n,!0).put({[Cp]:e,value:t});return new Ns(r).toPromise()}async function WI(n,e){const t=fo(n,!1).get(e),r=await new Ns(t).toPromise();return r===void 0?null:r.value}function _h(n,e){const t=fo(n,!0).delete(e);return new Ns(t).toPromise()}const GI=800,KI=3;class kp{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Va(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>KI)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Sp()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=ho._getInstance($I()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await jI(),!this.activeServiceWorker)return;this.sender=new UI(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||qI()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Va();return await gh(e,xi,"1"),await _h(e,xi),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>gh(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>WI(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>_h(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=fo(s,!1).getAll();return new Ns(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),t.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),t.push(s));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),GI)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}kp.type="LOCAL";const QI=kp;new Vs(3e4,6e4);function Vp(n,e){return e?Rt(e):(B(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class xc extends Tp{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return rr(e,this._buildIdpRequest())}_linkToIdToken(e,t){return rr(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return rr(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function XI(n){return kI(n.auth,new xc(n),n.bypassAuthState)}function YI(n){const{auth:e,user:t}=n;return B(t,e,"internal-error"),CI(t,new xc(n),n.bypassAuthState)}async function JI(n){const{auth:e,user:t}=n;return B(t,e,"internal-error"),PI(t,new xc(n),n.bypassAuthState)}class Dp{constructor(e,t,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:s,tenantId:i,error:a,type:c}=e;if(a){this.reject(a);return}const l={auth:this.auth,requestUri:t,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(l))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return XI;case"linkViaPopup":case"linkViaRedirect":return JI;case"reauthViaPopup":case"reauthViaRedirect":return YI;default:Et(this.auth,"internal-error")}}resolve(e){kt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){kt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const ZI=new Vs(2e3,1e4);async function ew(n,e,t){if(Ze(n.app))return Promise.reject(nt(n,"operation-not-supported-in-this-environment"));const r=lo(n);KT(n,e,Mc);const s=Vp(r,t);return new En(r,"signInViaPopup",e,s).executeNotNull()}class En extends Dp{constructor(e,t,r,s,i){super(e,t,s,i),this.provider=r,this.authWindow=null,this.pollId=null,En.currentPopupAction&&En.currentPopupAction.cancel(),En.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return B(e,this.auth,"internal-error"),e}async onExecution(){kt(this.filter.length===1,"Popup operations only handle one event");const e=Lc();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(nt(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(nt(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,En.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(nt(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,ZI.get())};e()}}En.currentPopupAction=null;const tw="pendingRedirect",di=new Map;class nw extends Dp{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=di.get(this.auth._key());if(!e){try{const r=await rw(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}di.set(this.auth._key(),e)}return this.bypassAuthState||di.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function rw(n,e){const t=ow(e),r=iw(n);if(!await r._isAvailable())return!1;const s=await r._get(t)==="true";return await r._remove(t),s}function sw(n,e){di.set(n._key(),e)}function iw(n){return Rt(n._redirectPersistence)}function ow(n){return fi(tw,n.config.apiKey,n.name)}async function aw(n,e,t=!1){if(Ze(n.app))return Promise.reject(Rn(n));const r=lo(n),s=Vp(r,e),a=await new nw(r,s,t).execute();return a&&!t&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,e)),a}const cw=600*1e3;class uw{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!lw(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!Np(e)){const r=e.error.code?.split("auth/")[1]||"internal-error";t.onError(nt(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=cw&&this.cachedEventUids.clear(),this.cachedEventUids.has(yh(e))}saveEventToCache(e){this.cachedEventUids.add(yh(e)),this.lastProcessedEventTime=Date.now()}}function yh(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function Np({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function lw(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Np(n);default:return!1}}async function hw(n,e={}){return Pr(n,"GET","/v1/projects",e)}const fw=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,dw=/^https?/;async function pw(n){if(n.config.emulator)return;const{authorizedDomains:e}=await hw(n);for(const t of e)try{if(mw(t))return}catch{}Et(n,"unauthorized-domain")}function mw(n){const e=Ca(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const a=new URL(n);return a.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&a.hostname===r}if(!dw.test(t))return!1;if(fw.test(n))return r===n;const s=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}const gw=new Vs(3e4,6e4);function vh(){const n=gt().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function _w(n){return new Promise((e,t)=>{function r(){vh(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{vh(),t(nt(n,"network-request-failed"))},timeout:gw.get()})}if(gt().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(gt().gapi?.load)r();else{const s=TI("iframefcb");return gt()[s]=()=>{gapi.load?r():t(nt(n,"network-request-failed"))},vI(`${EI()}?onload=${s}`).catch(i=>t(i))}}).catch(e=>{throw pi=null,e})}let pi=null;function yw(n){return pi=pi||_w(n),pi}const vw=new Vs(5e3,15e3),Ew="__/auth/iframe",Tw="emulator/auth/iframe",Iw={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},ww=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Aw(n){const e=n.config;B(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?kc(e,Tw):`https://${n.config.authDomain}/${Ew}`,r={apiKey:e.apiKey,appName:n.name,v:wr},s=ww.get(n.config.apiHost);s&&(r.eid=s);const i=n._getFrameworks();return i.length&&(r.fw=i.join(",")),`${t}?${Rs(r).slice(1)}`}async function Rw(n){const e=await yw(n),t=gt().gapi;return B(t,n,"internal-error"),e.open({where:document.body,url:Aw(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Iw,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const a=nt(n,"network-request-failed"),c=gt().setTimeout(()=>{i(a)},vw.get());function l(){gt().clearTimeout(c),s(r)}r.ping(l).then(l,()=>{i(a)})}))}const bw={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Sw=500,Pw=600,Cw="_blank",kw="http://localhost";class Eh{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function Vw(n,e,t,r=Sw,s=Pw){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let c="";const l={...bw,width:r.toString(),height:s.toString(),top:i,left:a},h=Ne().toLowerCase();t&&(c=dp(h)?Cw:t),hp(h)&&(e=e||kw,l.scrollbars="yes");const d=Object.entries(l).reduce((g,[w,S])=>`${g}${w}=${S},`,"");if(hI(h)&&c!=="_self")return Dw(e||"",c),new Eh(null);const m=window.open(e||"",c,d);B(m,n,"popup-blocked");try{m.focus()}catch{}return new Eh(m)}function Dw(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}const Nw="__/auth/handler",Ow="emulator/auth/handler",Mw=encodeURIComponent("fac");async function Th(n,e,t,r,s,i){B(n.config.authDomain,n,"auth-domain-config-required"),B(n.config.apiKey,n,"invalid-api-key");const a={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:wr,eventId:s};if(e instanceof Mc){e.setDefaultLanguage(n.languageCode),a.providerId=e.providerId||"",p_(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,m]of Object.entries({}))a[d]=m}if(e instanceof Ds){const d=e.getScopes().filter(m=>m!=="");d.length>0&&(a.scopes=d.join(","))}n.tenantId&&(a.tid=n.tenantId);const c=a;for(const d of Object.keys(c))c[d]===void 0&&delete c[d];const l=await n._getAppCheckToken(),h=l?`#${Mw}=${encodeURIComponent(l)}`:"";return`${Lw(n)}?${Rs(c).slice(1)}${h}`}function Lw({config:n}){return n.emulator?kc(n,Ow):`https://${n.authDomain}/${Nw}`}const Jo="webStorageSupport";class xw{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=bp,this._completeRedirectFn=aw,this._overrideRedirectResult=sw}async _openPopup(e,t,r,s){kt(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const i=await Th(e,t,r,Ca(),s);return Vw(e,i,Lc())}async _openRedirect(e,t,r,s){await this._originValidation(e);const i=await Th(e,t,r,Ca(),s);return BI(i),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:s,promise:i}=this.eventManagers[t];return s?Promise.resolve(s):(kt(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await Rw(e),r=new uw(e);return t.register("authEvent",s=>(B(s?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Jo,{type:Jo},s=>{const i=s?.[0]?.[Jo];i!==void 0&&t(!!i),Et(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=pw(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return yp()||fp()||Nc()}}const Fw=xw;var Ih="@firebase/auth",wh="1.11.1";class Uw{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){B(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function Bw(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function jw(n){cr(new Cn("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:a,authDomain:c}=r.options;B(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:a,authDomain:c,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:vp(n)},h=new _I(r,s,i,l);return wI(h,t),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),cr(new Cn("auth-internal",e=>{const t=lo(e.getProvider("auth").getImmediate());return(r=>new Uw(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Zt(Ih,wh,Bw(n)),Zt(Ih,wh,"esm2020")}const qw=300,$w=Tf("authIdTokenMaxAge")||qw;let Ah=null;const zw=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>$w)return;const s=t?.token;Ah!==s&&(Ah=s,await fetch(n,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function Hw(n=Sf()){const e=Ka(n,"auth");if(e.isInitialized())return e.getImmediate();const t=II(n,{popupRedirectResolver:Fw,persistence:[QI,xI,bp]}),r=Tf("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const a=zw(i.toString());DI(t,a,()=>a(t.currentUser)),VI(t,c=>a(c))}}const s=vf("auth");return s&&AI(t,`http://${s}`),t}function Ww(){return document.getElementsByTagName("head")?.[0]??document}yI({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=s=>{const i=nt("internal-error");i.customData=s,t(i)},r.type="text/javascript",r.charset="UTF-8",Ww().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});jw("Browser");const Gw={apiKey:"AIzaSyBC5VHNEcVL9KP8M0d64ZajF6P4Hzqzafc",authDomain:"bbnme-58716.firebaseapp.com",projectId:"bbnme-58716",storageBucket:"bbnme-58716.appspot.com",messagingSenderId:"155088179379",appId:"1:155088179379:web:5d98445c178b7513f520c6"},Op=bf(Gw),Ui=ST(Op),Fc=Hw(Op),Kw=new wt,Uc=xg(null);NI(Fc,n=>{Uc.set(n)});var Qw=Qe('<button class="svelte-18sv61c"> </button>');function _r(n,e){let t=es(e,"label",8,"Button"),r=es(e,"onClick",8,()=>{});var s=Qw(),i=qe(s);Jr(()=>Ha(i,t())),za("click",s,function(...a){r()?.apply(this,a)}),Ue(n,s)}var Xw=Qe('<div class="login-container svelte-8ukb9p"><h2>Please sign in to continue</h2> <!></div>');function Yw(n,e){Er(e,!1),ws();var t=Xw(),r=me(qe(t),2);_r(r,{label:"Sign in with Google",onClick:()=>ew(Fc,Kw)}),Ue(n,t),Tr()}var Jw=Qe('<div class="user-info svelte-rfuq4y"><img alt="Profile" class="svelte-rfuq4y"/> <span> </span></div> <!>',1),Zw=Qe('<nav class="svelte-rfuq4y"><!></nav>');function eA(n,e){Er(e,!1);const t=()=>pf(Uc,"$user",r),[r,s]=mf();ws();var i=Zw(),a=qe(i);{var c=l=>{var h=Jw(),d=_i(h),m=qe(d),g=me(m,2),w=qe(g),S=me(d,2);_r(S,{label:"Sign out",onClick:()=>OI(Fc)}),Jr(()=>{si(m,"src",t().photoURL),Ha(w,t().displayName)}),Ue(l,h)};Zr(a,l=>{t()&&l(c)})}Ue(n,i),Tr(),s()}var tA=Qe('<form class="svelte-7mtrh0"><h2>Add a new place</h2> <input type="text" placeholder="Place name" required class="svelte-7mtrh0"/> <input type="url" placeholder="Website" class="svelte-7mtrh0"/> <input type="url" placeholder="Image URL" class="svelte-7mtrh0"/> <button type="submit" class="svelte-7mtrh0">Add Place</button></form>');function nA(n,e){Er(e,!1);let t=ht(""),r=ht(""),s=ht("");async function i(){try{const d=await $T(Gd(Ui,"places"),{name:z(t),website:z(r),image:z(s)});console.log("Document written with ID: ",d.id),ue(t,""),ue(r,""),ue(s,"")}catch(d){console.error("Error adding document: ",d)}}ws();var a=tA(),c=me(qe(a),2),l=me(c,2),h=me(l,2);Jn(c,()=>z(t),d=>ue(t,d)),Jn(l,()=>z(r),d=>ue(r,d)),Jn(h,()=>z(s),d=>ue(s,d)),za("submit",a,ff(i)),Ue(n,a),Tr()}var rA=Qe('<div class="card svelte-1udyrqm"><!></div>');function Mp(n,e){var t=rA(),r=qe(t);Dg(r,e,"default",{}),Ue(n,t)}var sA=Qe('<form class="svelte-136zmjt"><h2>Edit Place</h2> <input type="text" placeholder="Place name" required class="svelte-136zmjt"/> <input type="url" placeholder="Website" class="svelte-136zmjt"/> <input type="url" placeholder="Image URL" class="svelte-136zmjt"/> <div class="actions svelte-136zmjt"><!> <!></div></form>');function iA(n,e){Er(e,!1);let t=es(e,"place",8),r=es(e,"onSave",8,()=>{}),s=es(e,"onCancel",8,()=>{}),i=ht(t().name),a=ht(t().website),c=ht(t().image);async function l(){try{const P=Ic(Ui,"places",t().id);await jT(P,{name:z(i),website:z(a),image:z(c)}),console.log("Document successfully updated!"),r()()}catch(P){console.error("Error updating document: ",P)}}ws();var h=sA(),d=me(qe(h),2),m=me(d,2),g=me(m,2),w=me(g,2),S=qe(w);_r(S,{label:"Save",type:"submit"});var k=me(S,2);_r(k,{label:"Cancel",get onClick(){return s()}}),Jn(d,()=>z(i),P=>ue(i,P)),Jn(m,()=>z(a),P=>ue(a,P)),Jn(g,()=>z(c),P=>ue(c,P)),za("submit",h,ff(l)),Ue(n,h),Tr()}var oA=Qe('<a target="_blank" rel="noreferrer">Website</a>'),aA=Qe('<img class="svelte-13geuu4"/>'),cA=Qe('<h3> </h3> <!> <!> <div class="actions svelte-13geuu4"><!> <!></div>',1),uA=Qe('<div class="svelte-13geuu4"><h2>Travel Wishlist</h2> <!></div>');function lA(n,e){Er(e,!1);let t=ht([]),r=ht(null);Bg(()=>{const d=zT(Gd(Ui,"places"),m=>{ue(t,m.docs.map(g=>({id:g.id,...g.data()})))});return()=>d()});async function s(d){try{await qT(Ic(Ui,"places",d)),console.log("Document successfully deleted!")}catch(m){console.error("Error removing document: ",m)}}function i(d){ue(r,d)}function a(){ue(r,null)}function c(){ue(r,null)}ws();var l=uA(),h=me(qe(l),2);kg(h,1,()=>z(t),Pg,(d,m)=>{Mp(d,{children:(g,w)=>{var S=wg(),k=_i(S);{var P=N=>{iA(N,{get place(){return z(r)},onSave:a,onCancel:c})},x=N=>{var M=cA(),Q=_i(M),te=qe(Q),Z=me(Q,2);{var T=y=>{var oe=oA();Jr(()=>si(oe,"href",z(m).website)),Ue(y,oe)};Zr(Z,y=>{z(m).website&&y(T)})}var _=me(Z,2);{var v=y=>{var oe=aA();Jr(()=>{si(oe,"src",z(m).image),si(oe,"alt",z(m).name)}),Ue(y,oe)};Zr(_,y=>{z(m).image&&y(v)})}var I=me(_,2),E=qe(I);_r(E,{label:"Edit",onClick:()=>i(z(m))});var A=me(E,2);_r(A,{label:"Delete",onClick:()=>s(z(m).id)}),Jr(()=>Ha(te,z(m).name)),Ue(N,M)};Zr(k,N=>{z(r)&&z(r).id===z(m).id?N(P):N(x,!1)})}Ue(g,S)},$$slots:{default:!0}})}),Ue(n,l),Tr()}var hA=Qe('<!> <div class="container svelte-1n46o8q"><h1>Clean Girl Travel Wishlist</h1> <!> <!></div>',1),fA=Qe("<main><!></main>");function dA(n){const e=()=>pf(Uc,"$user",t),[t,r]=mf();var s=fA(),i=qe(s);{var a=l=>{var h=hA(),d=_i(h);eA(d,{});var m=me(d,2),g=me(qe(m),2);Mp(g,{children:(S,k)=>{nA(S,{})},$$slots:{default:!0}});var w=me(g,2);lA(w,{}),Ue(l,h)},c=l=>{Yw(l,{})};Zr(i,l=>{e()?l(a):l(c,!1)})}Ue(n,s),r()}Ag(dA,{target:document.getElementById("app")});
