(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();const dh=!1;var ph=Array.isArray,om=Array.prototype.indexOf,wa=Array.from,mh=Object.defineProperty,Wn=Object.getOwnPropertyDescriptor,gh=Object.getOwnPropertyDescriptors,am=Object.prototype,cm=Array.prototype,Aa=Object.getPrototypeOf,Su=Object.isExtensible;const Gn=()=>{};function um(n){return n()}function Wo(n){for(var e=0;e<n.length;e++)n[e]()}function _h(){var n,e,t=new Promise((r,s)=>{n=r,e=s});return{promise:t,resolve:n,reject:e}}const ke=2,Ra=4,Oi=8,kt=16,Vt=32,Cn=64,Mi=128,nt=512,Pe=1024,Fe=2048,Dt=4096,$e=8192,Gt=16384,ba=32768,nr=65536,Pu=1<<17,yh=1<<18,dr=1<<19,vh=1<<20,Zr=32768,Go=1<<21,Sa=1<<22,Kt=1<<23,Kn=Symbol("$state"),lm=Symbol("legacy props"),hm=Symbol(""),zn=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function fm(n){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function dm(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function pm(n){throw new Error("https://svelte.dev/e/effect_in_teardown")}function mm(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function gm(n){throw new Error("https://svelte.dev/e/effect_orphan")}function _m(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function ym(n){throw new Error("https://svelte.dev/e/props_invalid_value")}function vm(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Em(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Tm(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function Im(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const wm=1,Am=2,Rm=16,bm=2,Sm=4,Pm=8,Cm=1,km=2,Ae=Symbol(),Vm="http://www.w3.org/1999/xhtml";function Dm(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}let Nm=!1;function Eh(n){return n===this.v}function Th(n,e){return n!=n?e==e:n!==e||n!==null&&typeof n=="object"||typeof n=="function"}function Ih(n){return!Th(n,this.v)}let pr=!1,Om=!1;function Mm(){pr=!0}let ue=null;function rr(n){ue=n}function fs(n,e=!1,t){ue={p:ue,i:!1,c:null,e:null,s:n,x:null,l:pr&&!e?{s:null,u:null,$:[]}:null}}function ds(n){var e=ue,t=e.e;if(t!==null){e.e=null;for(var r of t)xh(r)}return e.i=!0,ue=e.p,{}}function ps(){return!pr||ue!==null&&ue.l===null}let pn=[];function wh(){var n=pn;pn=[],Wo(n)}function Li(n){if(pn.length===0&&!$r){var e=pn;queueMicrotask(()=>{e===pn&&wh()})}pn.push(n)}function Lm(){for(;pn.length>0;)wh()}function Ah(n){var e=Q;if(e===null)return K.f|=Kt,n;if((e.f&ba)===0){if((e.f&Mi)===0)throw n;e.b.error(n)}else sr(n,e)}function sr(n,e){for(;e!==null;){if((e.f&Mi)!==0)try{e.b.error(n);return}catch(t){n=t}e=e.parent}throw n}const $s=new Set;let te=null,Ys=null,qe=null,at=[],xi=null,Ko=!1,$r=!1;class ct{committed=!1;current=new Map;previous=new Map;#e=new Set;#t=new Set;#n=0;#r=0;#c=null;#o=[];#a=[];skipped_effects=new Set;is_fork=!1;process(e){at=[],Ys=null,this.apply();var t={parent:null,effect:null,effects:[],render_effects:[],block_effects:[]};for(const r of e)this.#s(r,t);this.is_fork||this.#u(),this.#r>0||this.is_fork?(this.#i(t.effects),this.#i(t.render_effects),this.#i(t.block_effects)):(Ys=this,te=null,Cu(t.render_effects),Cu(t.effects),Ys=null,this.#c?.resolve()),qe=null}#s(e,t){e.f^=Pe;for(var r=e.first;r!==null;){var s=r.f,i=(s&(Vt|Cn))!==0,a=i&&(s&Pe)!==0,u=a||(s&$e)!==0||this.skipped_effects.has(r);if((r.f&Mi)!==0&&r.b?.is_pending()&&(t={parent:t,effect:r,effects:[],render_effects:[],block_effects:[]}),!u&&r.fn!==null){i?r.f^=Pe:(s&Ra)!==0?t.effects.push(r):gs(r)&&((r.f&kt)!==0&&t.block_effects.push(r),rs(r));var l=r.first;if(l!==null){r=l;continue}}var h=r.parent;for(r=r.next;r===null&&h!==null;)h===t.effect&&(this.#i(t.effects),this.#i(t.render_effects),this.#i(t.block_effects),t=t.parent),r=h.next,h=h.parent}}#i(e){for(const t of e)((t.f&Fe)!==0?this.#o:this.#a).push(t),Ce(t,Pe)}capture(e,t){this.previous.has(e)||this.previous.set(e,t),(e.f&Kt)===0&&(this.current.set(e,e.v),qe?.set(e,e.v))}activate(){te=this,this.apply()}deactivate(){te=null,qe=null}flush(){if(this.activate(),at.length>0){if(Rh(),te!==null&&te!==this)return}else this.#n===0&&this.process([]);this.deactivate()}discard(){for(const e of this.#t)e(this);this.#t.clear()}#u(){if(this.#r===0){for(const e of this.#e)e();this.#e.clear()}this.#n===0&&this.#l()}#l(){if($s.size>1){this.previous.clear();var e=qe,t=!0,r={parent:null,effect:null,effects:[],render_effects:[],block_effects:[]};for(const s of $s){if(s===this){t=!1;continue}const i=[];for(const[u,l]of this.current){if(s.current.has(u))if(t&&l!==s.current.get(u))s.current.set(u,l);else continue;i.push(u)}if(i.length===0)continue;const a=[...s.current.keys()].filter(u=>!this.current.has(u));if(a.length>0){const u=new Set,l=new Map;for(const h of i)bh(h,a,u,l);if(at.length>0){te=s,s.apply();for(const h of at)s.#s(h,r);at=[],s.deactivate()}}}te=null,qe=e}this.committed=!0,$s.delete(this)}increment(e){this.#n+=1,e&&(this.#r+=1)}decrement(e){this.#n-=1,e&&(this.#r-=1),this.revive()}revive(){for(const e of this.#o)Ce(e,Fe),In(e);for(const e of this.#a)Ce(e,Dt),In(e);this.#o=[],this.#a=[],this.flush()}oncommit(e){this.#e.add(e)}ondiscard(e){this.#t.add(e)}settled(){return(this.#c??=_h()).promise}static ensure(){if(te===null){const e=te=new ct;$s.add(te),$r||ct.enqueue(()=>{te===e&&e.flush()})}return te}static enqueue(e){Li(e)}apply(){}}function xm(n){var e=$r;$r=!0;try{for(var t;;){if(Lm(),at.length===0&&(te?.flush(),at.length===0))return xi=null,t;Rh()}}finally{$r=e}}function Rh(){var n=_n;Ko=!0;try{var e=0;for(Du(!0);at.length>0;){var t=ct.ensure();if(e++>1e3){var r,s;Fm()}t.process(at),Qt.clear()}}finally{Ko=!1,Du(n),xi=null}}function Fm(){try{_m()}catch(n){sr(n,xi)}}let Et=null;function Cu(n){var e=n.length;if(e!==0){for(var t=0;t<e;){var r=n[t++];if((r.f&(Gt|$e))===0&&gs(r)&&(Et=new Set,rs(r),r.deps===null&&r.first===null&&r.nodes_start===null&&(r.teardown===null&&r.ac===null?jh(r):r.fn=null),Et?.size>0)){Qt.clear();for(const s of Et){if((s.f&(Gt|$e))!==0)continue;const i=[s];let a=s.parent;for(;a!==null;)Et.has(a)&&(Et.delete(a),i.push(a)),a=a.parent;for(let u=i.length-1;u>=0;u--){const l=i[u];(l.f&(Gt|$e))===0&&rs(l)}}Et.clear()}}Et=null}}function bh(n,e,t,r){if(!t.has(n)&&(t.add(n),n.reactions!==null))for(const s of n.reactions){const i=s.f;(i&ke)!==0?bh(s,e,t,r):(i&(Sa|kt))!==0&&(i&Fe)===0&&Sh(s,e,r)&&(Ce(s,Fe),In(s))}}function Sh(n,e,t){const r=t.get(n);if(r!==void 0)return r;if(n.deps!==null)for(const s of n.deps){if(e.includes(s))return!0;if((s.f&ke)!==0&&Sh(s,e,t))return t.set(s,!0),!0}return t.set(n,!1),!1}function In(n){for(var e=xi=n;e.parent!==null;){e=e.parent;var t=e.f;if(Ko&&e===Q&&(t&kt)!==0&&(t&yh)===0)return;if((t&(Cn|Vt))!==0){if((t&Pe)===0)return;e.f^=Pe}}at.push(e)}function Um(n){let e=0,t=wn(0),r;return()=>{Ui()&&(J(t),Fh(()=>(e===0&&(r=_s(()=>n(()=>zr(t)))),e+=1,()=>{Li(()=>{e-=1,e===0&&(r?.(),r=void 0,zr(t))})})))}}var Bm=nr|dr|Mi;function jm(n,e,t){new qm(n,e,t)}class qm{parent;#e=!1;#t;#n=null;#r;#c;#o;#a=null;#s=null;#i=null;#u=null;#l=null;#d=0;#h=0;#p=!1;#f=null;#v=Um(()=>(this.#f=wn(this.#d),()=>{this.#f=null}));constructor(e,t,r){this.#t=e,this.#r=t,this.#c=r,this.parent=Q.b,this.#e=!!this.#r.pending,this.#o=Na(()=>{Q.b=this;{var s=this.#_();try{this.#a=Xe(()=>r(s))}catch(i){this.error(i)}this.#h>0?this.#g():this.#e=!1}return()=>{this.#l?.remove()}},Bm)}#E(){try{this.#a=Xe(()=>this.#c(this.#t))}catch(e){this.error(e)}this.#e=!1}#T(){const e=this.#r.pending;e&&(this.#s=Xe(()=>e(this.#t)),ct.enqueue(()=>{var t=this.#_();this.#a=this.#m(()=>(ct.ensure(),Xe(()=>this.#c(t)))),this.#h>0?this.#g():(Xn(this.#s,()=>{this.#s=null}),this.#e=!1)}))}#_(){var e=this.#t;return this.#e&&(this.#l=ts(),this.#t.before(this.#l),e=this.#l),e}is_pending(){return this.#e||!!this.parent&&this.parent.is_pending()}has_pending_snippet(){return!!this.#r.pending}#m(e){var t=Q,r=K,s=ue;mt(this.#o),xe(this.#o),rr(this.#o.ctx);try{return e()}catch(i){return Ah(i),null}finally{mt(t),xe(r),rr(s)}}#g(){const e=this.#r.pending;this.#a!==null&&(this.#u=document.createDocumentFragment(),this.#u.append(this.#l),zh(this.#a,this.#u)),this.#s===null&&(this.#s=Xe(()=>e(this.#t)))}#y(e){if(!this.has_pending_snippet()){this.parent&&this.parent.#y(e);return}this.#h+=e,this.#h===0&&(this.#e=!1,this.#s&&Xn(this.#s,()=>{this.#s=null}),this.#u&&(this.#t.before(this.#u),this.#u=null))}update_pending_count(e){this.#y(e),this.#d+=e,this.#f&&es(this.#f,this.#d)}get_effect_pending(){return this.#v(),J(this.#f)}error(e){var t=this.#r.onerror;let r=this.#r.failed;if(this.#p||!t&&!r)throw e;this.#a&&(Me(this.#a),this.#a=null),this.#s&&(Me(this.#s),this.#s=null),this.#i&&(Me(this.#i),this.#i=null);var s=!1,i=!1;const a=()=>{if(s){Dm();return}s=!0,i&&Im(),ct.ensure(),this.#d=0,this.#i!==null&&Xn(this.#i,()=>{this.#i=null}),this.#e=this.has_pending_snippet(),this.#a=this.#m(()=>(this.#p=!1,Xe(()=>this.#c(this.#t)))),this.#h>0?this.#g():this.#e=!1};var u=K;try{xe(null),i=!0,t?.(e,a),i=!1}catch(l){sr(l,this.#o&&this.#o.parent)}finally{xe(u)}r&&Li(()=>{this.#i=this.#m(()=>{ct.ensure(),this.#p=!0;try{return Xe(()=>{r(this.#t,()=>e,()=>a)})}catch(l){return sr(l,this.#o.parent),null}finally{this.#p=!1}})})}}function $m(n,e,t,r){const s=ps()?Pa:Ca;if(t.length===0&&n.length===0){r(e.map(s));return}var i=te,a=Q,u=zm();function l(){Promise.all(t.map(h=>Hm(h))).then(h=>{u();try{r([...e.map(s),...h])}catch(d){(a.f&Gt)===0&&sr(d,a)}i?.deactivate(),ui()}).catch(h=>{sr(h,a)})}n.length>0?Promise.all(n).then(()=>{u();try{return l()}finally{i?.deactivate(),ui()}}):l()}function zm(){var n=Q,e=K,t=ue,r=te;return function(i=!0){mt(n),xe(e),rr(t),i&&r?.activate()}}function ui(){mt(null),xe(null),rr(null)}function Pa(n){var e=ke|Fe,t=K!==null&&(K.f&ke)!==0?K:null;return Q!==null&&(Q.f|=dr),{ctx:ue,deps:null,effects:null,equals:Eh,f:e,fn:n,reactions:null,rv:0,v:Ae,wv:0,parent:t??Q,ac:null}}function Hm(n,e){let t=Q;t===null&&dm();var r=t.b,s=void 0,i=wn(Ae),a=!K,u=new Map;return tg(()=>{var l=_h();s=l.promise;try{Promise.resolve(n()).then(l.resolve,l.reject).then(()=>{h===te&&h.committed&&h.deactivate(),ui()})}catch(g){l.reject(g),ui()}var h=te;if(a){var d=!r.is_pending();r.update_pending_count(1),h.increment(d),u.get(h)?.reject(zn),u.delete(h),u.set(h,l)}const m=(g,w=void 0)=>{if(h.activate(),w)w!==zn&&(i.f|=Kt,es(i,w));else{(i.f&Kt)!==0&&(i.f^=Kt),es(i,g);for(const[S,V]of u){if(u.delete(S),S===h)break;V.reject(zn)}}a&&(r.update_pending_count(-1),h.decrement(d))};l.promise.then(m,g=>m(null,g||"unknown"))}),Da(()=>{for(const l of u.values())l.reject(zn)}),new Promise(l=>{function h(d){function m(){d===s?l(i):h(s)}d.then(m,m)}h(s)})}function Ca(n){const e=Pa(n);return e.equals=Ih,e}function Ph(n){var e=n.effects;if(e!==null){n.effects=null;for(var t=0;t<e.length;t+=1)Me(e[t])}}function Wm(n){for(var e=n.parent;e!==null;){if((e.f&ke)===0)return e;e=e.parent}return null}function ka(n){var e,t=Q;mt(Wm(n));try{n.f&=~Zr,Ph(n),e=Kh(n)}finally{mt(t)}return e}function Ch(n){var e=ka(n);if(n.equals(e)||(n.v=e,n.wv=Wh()),!kn)if(qe!==null)Ui()&&qe.set(n,n.v);else{var t=(n.f&nt)===0?Dt:Pe;Ce(n,t)}}let Qo=new Set;const Qt=new Map;let kh=!1;function wn(n,e){var t={f:0,v:n,reactions:null,equals:Eh,rv:0,wv:0};return t}function jt(n,e){const t=wn(n);return sg(t),t}function Qn(n,e=!1,t=!0){const r=wn(n);return e||(r.equals=Ih),pr&&t&&ue!==null&&ue.l!==null&&(ue.l.s??=[]).push(r),r}function be(n,e,t=!1){K!==null&&(!ut||(K.f&Pu)!==0)&&ps()&&(K.f&(ke|kt|Sa|Pu))!==0&&!At?.includes(n)&&Tm();let r=t?Hn(e):e;return es(n,r)}function es(n,e){if(!n.equals(e)){var t=n.v;kn?Qt.set(n,e):Qt.set(n,t),n.v=e;var r=ct.ensure();r.capture(n,t),(n.f&ke)!==0&&((n.f&Fe)!==0&&ka(n),Ce(n,(n.f&nt)!==0?Pe:Dt)),n.wv=Wh(),Vh(n,Fe),ps()&&Q!==null&&(Q.f&Pe)!==0&&(Q.f&(Vt|Cn))===0&&(ze===null?ig([n]):ze.push(n)),!r.is_fork&&Qo.size>0&&!kh&&Gm()}return e}function Gm(){kh=!1;const n=Array.from(Qo);for(const e of n)(e.f&Pe)!==0&&Ce(e,Dt),gs(e)&&rs(e);Qo.clear()}function zr(n){be(n,n.v+1)}function Vh(n,e){var t=n.reactions;if(t!==null)for(var r=ps(),s=t.length,i=0;i<s;i++){var a=t[i],u=a.f;if(!(!r&&a===Q)){var l=(u&Fe)===0;if(l&&Ce(a,e),(u&ke)!==0){var h=a;qe?.delete(h),(u&Zr)===0&&(u&nt&&(a.f|=Zr),Vh(h,Dt))}else l&&((u&kt)!==0&&Et!==null&&Et.add(a),In(a))}}}function Hn(n){if(typeof n!="object"||n===null||Kn in n)return n;const e=Aa(n);if(e!==am&&e!==cm)return n;var t=new Map,r=ph(n),s=jt(0),i=yn,a=u=>{if(yn===i)return u();var l=K,h=yn;xe(null),Ou(i);var d=u();return xe(l),Ou(h),d};return r&&t.set("length",jt(n.length)),new Proxy(n,{defineProperty(u,l,h){(!("value"in h)||h.configurable===!1||h.enumerable===!1||h.writable===!1)&&vm();var d=t.get(l);return d===void 0?d=a(()=>{var m=jt(h.value);return t.set(l,m),m}):be(d,h.value,!0),!0},deleteProperty(u,l){var h=t.get(l);if(h===void 0){if(l in u){const d=a(()=>jt(Ae));t.set(l,d),zr(s)}}else be(h,Ae),zr(s);return!0},get(u,l,h){if(l===Kn)return n;var d=t.get(l),m=l in u;if(d===void 0&&(!m||Wn(u,l)?.writable)&&(d=a(()=>{var w=Hn(m?u[l]:Ae),S=jt(w);return S}),t.set(l,d)),d!==void 0){var g=J(d);return g===Ae?void 0:g}return Reflect.get(u,l,h)},getOwnPropertyDescriptor(u,l){var h=Reflect.getOwnPropertyDescriptor(u,l);if(h&&"value"in h){var d=t.get(l);d&&(h.value=J(d))}else if(h===void 0){var m=t.get(l),g=m?.v;if(m!==void 0&&g!==Ae)return{enumerable:!0,configurable:!0,value:g,writable:!0}}return h},has(u,l){if(l===Kn)return!0;var h=t.get(l),d=h!==void 0&&h.v!==Ae||Reflect.has(u,l);if(h!==void 0||Q!==null&&(!d||Wn(u,l)?.writable)){h===void 0&&(h=a(()=>{var g=d?Hn(u[l]):Ae,w=jt(g);return w}),t.set(l,h));var m=J(h);if(m===Ae)return!1}return d},set(u,l,h,d){var m=t.get(l),g=l in u;if(r&&l==="length")for(var w=h;w<m.v;w+=1){var S=t.get(w+"");S!==void 0?be(S,Ae):w in u&&(S=a(()=>jt(Ae)),t.set(w+"",S))}if(m===void 0)(!g||Wn(u,l)?.writable)&&(m=a(()=>jt(void 0)),be(m,Hn(h)),t.set(l,m));else{g=m.v!==Ae;var V=a(()=>Hn(h));be(m,V)}var C=Reflect.getOwnPropertyDescriptor(u,l);if(C?.set&&C.set.call(d,h),!g){if(r&&typeof l=="string"){var L=t.get("length"),O=Number(l);Number.isInteger(O)&&O>=L.v&&be(L,O+1)}zr(s)}return!0},ownKeys(u){J(s);var l=Reflect.ownKeys(u).filter(m=>{var g=t.get(m);return g===void 0||g.v!==Ae});for(var[h,d]of t)d.v!==Ae&&!(h in u)&&l.push(h);return l},setPrototypeOf(){Em()}})}var ku,Dh,Nh,Oh;function Km(){if(ku===void 0){ku=window,Dh=/Firefox/.test(navigator.userAgent);var n=Element.prototype,e=Node.prototype,t=Text.prototype;Nh=Wn(e,"firstChild").get,Oh=Wn(e,"nextSibling").get,Su(n)&&(n.__click=void 0,n.__className=void 0,n.__attributes=null,n.__style=void 0,n.__e=void 0),Su(t)&&(t.__t=void 0)}}function ts(n=""){return document.createTextNode(n)}function li(n){return Nh.call(n)}function ms(n){return Oh.call(n)}function et(n,e){return li(n)}function Va(n,e=!1){{var t=li(n);return t instanceof Comment&&t.data===""?ms(t):t}}function Ke(n,e=1,t=!1){let r=n;for(;e--;)r=ms(r);return r}function Qm(n){n.textContent=""}function Mh(){return!1}let Vu=!1;function Xm(){Vu||(Vu=!0,document.addEventListener("reset",n=>{Promise.resolve().then(()=>{if(!n.defaultPrevented)for(const e of n.target.elements)e.__on_r?.()})},{capture:!0}))}function Fi(n){var e=K,t=Q;xe(null),mt(null);try{return n()}finally{xe(e),mt(t)}}function Ym(n,e,t,r=t){n.addEventListener(e,()=>Fi(t));const s=n.__on_r;s?n.__on_r=()=>{s(),r(!0)}:n.__on_r=()=>r(!0),Xm()}function Lh(n){Q===null&&(K===null&&gm(),mm()),kn&&pm()}function Jm(n,e){var t=e.last;t===null?e.last=e.first=n:(t.next=n,n.prev=t,e.last=n)}function Nt(n,e,t,r=!0){var s=Q;s!==null&&(s.f&$e)!==0&&(n|=$e);var i={ctx:ue,deps:null,nodes_start:null,nodes_end:null,f:n|Fe|nt,first:null,fn:e,last:null,next:null,parent:s,b:s&&s.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(t)try{rs(i),i.f|=ba}catch(l){throw Me(i),l}else e!==null&&In(i);if(r){var a=i;if(t&&a.deps===null&&a.teardown===null&&a.nodes_start===null&&a.first===a.last&&(a.f&dr)===0&&(a=a.first,(n&kt)!==0&&(n&nr)!==0&&a!==null&&(a.f|=nr)),a!==null&&(a.parent=s,s!==null&&Jm(a,s),K!==null&&(K.f&ke)!==0&&(n&Cn)===0)){var u=K;(u.effects??=[]).push(a)}}return i}function Ui(){return K!==null&&!ut}function Da(n){const e=Nt(Oi,null,!1);return Ce(e,Pe),e.teardown=n,e}function Xo(n){Lh();var e=Q.f,t=!K&&(e&Vt)!==0&&(e&ba)===0;if(t){var r=ue;(r.e??=[]).push(n)}else return xh(n)}function xh(n){return Nt(Ra|vh,n,!1)}function Zm(n){return Lh(),Nt(Oi|vh,n,!0)}function eg(n){ct.ensure();const e=Nt(Cn|dr,n,!0);return(t={})=>new Promise(r=>{t.outro?Xn(e,()=>{Me(e),r(void 0)}):(Me(e),r(void 0))})}function tg(n){return Nt(Sa|dr,n,!0)}function Fh(n,e=0){return Nt(Oi|e,n,!0)}function Hr(n,e=[],t=[],r=[],s=!1){$m(r,e,t,i=>{Nt(s?Ra:Oi,()=>n(...i.map(J)),!0)})}function Na(n,e=0){var t=Nt(kt|e,n,!0);return t}function Xe(n,e=!0){return Nt(Vt|dr,n,!0,e)}function Uh(n){var e=n.teardown;if(e!==null){const t=kn,r=K;Nu(!0),xe(null);try{e.call(null)}finally{Nu(t),xe(r)}}}function Bh(n,e=!1){var t=n.first;for(n.first=n.last=null;t!==null;){const s=t.ac;s!==null&&Fi(()=>{s.abort(zn)});var r=t.next;(t.f&Cn)!==0?t.parent=null:Me(t,e),t=r}}function ng(n){for(var e=n.first;e!==null;){var t=e.next;(e.f&Vt)===0&&Me(e),e=t}}function Me(n,e=!0){var t=!1;(e||(n.f&yh)!==0)&&n.nodes_start!==null&&n.nodes_end!==null&&(rg(n.nodes_start,n.nodes_end),t=!0),Bh(n,e&&!t),hi(n,0),Ce(n,Gt);var r=n.transitions;if(r!==null)for(const i of r)i.stop();Uh(n);var s=n.parent;s!==null&&s.first!==null&&jh(n),n.next=n.prev=n.teardown=n.ctx=n.deps=n.fn=n.nodes_start=n.nodes_end=n.ac=null}function rg(n,e){for(;n!==null;){var t=n===e?null:ms(n);n.remove(),n=t}}function jh(n){var e=n.parent,t=n.prev,r=n.next;t!==null&&(t.next=r),r!==null&&(r.prev=t),e!==null&&(e.first===n&&(e.first=r),e.last===n&&(e.last=t))}function Xn(n,e,t=!0){var r=[];Oa(n,r,!0),qh(r,()=>{t&&Me(n),e&&e()})}function qh(n,e){var t=n.length;if(t>0){var r=()=>--t||e();for(var s of n)s.out(r)}else e()}function Oa(n,e,t){if((n.f&$e)===0){if(n.f^=$e,n.transitions!==null)for(const a of n.transitions)(a.is_global||t)&&e.push(a);for(var r=n.first;r!==null;){var s=r.next,i=(r.f&nr)!==0||(r.f&Vt)!==0&&(n.f&kt)!==0;Oa(r,e,i?t:!1),r=s}}}function Ma(n){$h(n,!0)}function $h(n,e){if((n.f&$e)!==0){n.f^=$e,(n.f&Pe)===0&&(Ce(n,Fe),In(n));for(var t=n.first;t!==null;){var r=t.next,s=(t.f&nr)!==0||(t.f&Vt)!==0;$h(t,s?e:!1),t=r}if(n.transitions!==null)for(const i of n.transitions)(i.is_global||e)&&i.in()}}function zh(n,e){for(var t=n.nodes_start,r=n.nodes_end;t!==null;){var s=t===r?null:ms(t);e.append(t),t=s}}let _n=!1;function Du(n){_n=n}let kn=!1;function Nu(n){kn=n}let K=null,ut=!1;function xe(n){K=n}let Q=null;function mt(n){Q=n}let At=null;function sg(n){K!==null&&(At===null?At=[n]:At.push(n))}let Oe=null,je=0,ze=null;function ig(n){ze=n}let Hh=1,ns=0,yn=ns;function Ou(n){yn=n}function Wh(){return++Hh}function gs(n){var e=n.f;if((e&Fe)!==0)return!0;if(e&ke&&(n.f&=~Zr),(e&Dt)!==0){var t=n.deps;if(t!==null)for(var r=t.length,s=0;s<r;s++){var i=t[s];if(gs(i)&&Ch(i),i.wv>n.wv)return!0}(e&nt)!==0&&qe===null&&Ce(n,Pe)}return!1}function Gh(n,e,t=!0){var r=n.reactions;if(r!==null&&!At?.includes(n))for(var s=0;s<r.length;s++){var i=r[s];(i.f&ke)!==0?Gh(i,e,!1):e===i&&(t?Ce(i,Fe):(i.f&Pe)!==0&&Ce(i,Dt),In(i))}}function Kh(n){var e=Oe,t=je,r=ze,s=K,i=At,a=ue,u=ut,l=yn,h=n.f;Oe=null,je=0,ze=null,K=(h&(Vt|Cn))===0?n:null,At=null,rr(n.ctx),ut=!1,yn=++ns,n.ac!==null&&(Fi(()=>{n.ac.abort(zn)}),n.ac=null);try{n.f|=Go;var d=n.fn,m=d(),g=n.deps;if(Oe!==null){var w;if(hi(n,je),g!==null&&je>0)for(g.length=je+Oe.length,w=0;w<Oe.length;w++)g[je+w]=Oe[w];else n.deps=g=Oe;if(_n&&Ui()&&(n.f&nt)!==0)for(w=je;w<g.length;w++)(g[w].reactions??=[]).push(n)}else g!==null&&je<g.length&&(hi(n,je),g.length=je);if(ps()&&ze!==null&&!ut&&g!==null&&(n.f&(ke|Dt|Fe))===0)for(w=0;w<ze.length;w++)Gh(ze[w],n);return s!==null&&s!==n&&(ns++,ze!==null&&(r===null?r=ze:r.push(...ze))),(n.f&Kt)!==0&&(n.f^=Kt),m}catch(S){return Ah(S)}finally{n.f^=Go,Oe=e,je=t,ze=r,K=s,At=i,rr(a),ut=u,yn=l}}function og(n,e){let t=e.reactions;if(t!==null){var r=om.call(t,n);if(r!==-1){var s=t.length-1;s===0?t=e.reactions=null:(t[r]=t[s],t.pop())}}t===null&&(e.f&ke)!==0&&(Oe===null||!Oe.includes(e))&&(Ce(e,Dt),(e.f&nt)!==0&&(e.f^=nt,e.f&=~Zr),Ph(e),hi(e,0))}function hi(n,e){var t=n.deps;if(t!==null)for(var r=e;r<t.length;r++)og(n,t[r])}function rs(n){var e=n.f;if((e&Gt)===0){Ce(n,Pe);var t=Q,r=_n;Q=n,_n=!0;try{(e&kt)!==0?ng(n):Bh(n),Uh(n);var s=Kh(n);n.teardown=typeof s=="function"?s:null,n.wv=Hh;var i;dh&&Om&&(n.f&Fe)!==0&&n.deps}finally{_n=r,Q=t}}}async function ag(){await Promise.resolve(),xm()}function J(n){var e=n.f,t=(e&ke)!==0;if(K!==null&&!ut){var r=Q!==null&&(Q.f&Gt)!==0;if(!r&&!At?.includes(n)){var s=K.deps;if((K.f&Go)!==0)n.rv<ns&&(n.rv=ns,Oe===null&&s!==null&&s[je]===n?je++:Oe===null?Oe=[n]:Oe.includes(n)||Oe.push(n));else{(K.deps??=[]).push(n);var i=n.reactions;i===null?n.reactions=[K]:i.includes(K)||i.push(K)}}}if(kn){if(Qt.has(n))return Qt.get(n);if(t){var a=n,u=a.v;return((a.f&Pe)===0&&a.reactions!==null||Xh(a))&&(u=ka(a)),Qt.set(a,u),u}}else if(t){if(a=n,qe?.has(a))return qe.get(a);gs(a)&&Ch(a),_n&&Ui()&&(a.f&nt)===0&&Qh(a)}else if(qe?.has(n))return qe.get(n);if((n.f&Kt)!==0)throw n.v;return n.v}function Qh(n){if(n.deps!==null){n.f^=nt;for(const e of n.deps)(e.reactions??=[]).push(n),(e.f&ke)!==0&&(e.f&nt)===0&&Qh(e)}}function Xh(n){if(n.v===Ae)return!0;if(n.deps===null)return!1;for(const e of n.deps)if(Qt.has(e)||(e.f&ke)!==0&&Xh(e))return!0;return!1}function _s(n){var e=ut;try{return ut=!0,n()}finally{ut=e}}const cg=-7169;function Ce(n,e){n.f=n.f&cg|e}function ug(n){if(!(typeof n!="object"||!n||n instanceof EventTarget)){if(Kn in n)Yo(n);else if(!Array.isArray(n))for(let e in n){const t=n[e];typeof t=="object"&&t&&Kn in t&&Yo(t)}}}function Yo(n,e=new Set){if(typeof n=="object"&&n!==null&&!(n instanceof EventTarget)&&!e.has(n)){e.add(n),n instanceof Date&&n.getTime();for(let r in n)try{Yo(n[r],e)}catch{}const t=Aa(n);if(t!==Object.prototype&&t!==Array.prototype&&t!==Map.prototype&&t!==Set.prototype&&t!==Date.prototype){const r=gh(t);for(let s in r){const i=r[s].get;if(i)try{i.call(n)}catch{}}}}}const lg=["touchstart","touchmove"];function hg(n){return lg.includes(n)}const fg=new Set,Mu=new Set;function dg(n,e,t,r={}){function s(i){if(r.capture||Fr.call(e,i),!i.cancelBubble)return Fi(()=>t?.call(this,i))}return n.startsWith("pointer")||n.startsWith("touch")||n==="wheel"?Li(()=>{e.addEventListener(n,s,r)}):e.addEventListener(n,s,r),s}function Yh(n,e,t,r,s){var i={capture:r,passive:s},a=dg(n,e,t,i);(e===document.body||e===window||e===document||e instanceof HTMLMediaElement)&&Da(()=>{e.removeEventListener(n,a,i)})}let Lu=null;function Fr(n){var e=this,t=e.ownerDocument,r=n.type,s=n.composedPath?.()||[],i=s[0]||n.target;Lu=n;var a=0,u=Lu===n&&n.__root;if(u){var l=s.indexOf(u);if(l!==-1&&(e===document||e===window)){n.__root=e;return}var h=s.indexOf(e);if(h===-1)return;l<=h&&(a=l)}if(i=s[a]||n.target,i!==e){mh(n,"currentTarget",{configurable:!0,get(){return i||t}});var d=K,m=Q;xe(null),mt(null);try{for(var g,w=[];i!==null;){var S=i.assignedSlot||i.parentNode||i.host||null;try{var V=i["__"+r];V!=null&&(!i.disabled||n.target===i)&&V.call(i,n)}catch(C){g?w.push(C):g=C}if(n.cancelBubble||S===e||S===null)break;i=S}if(g){for(let C of w)queueMicrotask(()=>{throw C});throw g}}finally{n.__root=e,delete n.currentTarget,xe(d),mt(m)}}}function pg(n){var e=document.createElement("template");return e.innerHTML=n.replaceAll("<!>","<!---->"),e.content}function xu(n,e){var t=Q;t.nodes_start===null&&(t.nodes_start=n,t.nodes_end=e)}function Qe(n,e){var t=(e&Cm)!==0,r=(e&km)!==0,s,i=!n.startsWith("<!>");return()=>{s===void 0&&(s=pg(i?n:"<!>"+n),t||(s=li(s)));var a=r||Dh?document.importNode(s,!0):s.cloneNode(!0);if(t){var u=li(a),l=a.lastChild;xu(u,l)}else xu(a,a);return a}}function Ge(n,e){n!==null&&n.before(e)}function La(n,e){var t=e==null?"":typeof e=="object"?e+"":e;t!==(n.__t??=n.nodeValue)&&(n.__t=t,n.nodeValue=t+"")}function mg(n,e){return gg(n,e)}const Fn=new Map;function gg(n,{target:e,anchor:t,props:r={},events:s,context:i,intro:a=!0}){Km();var u=new Set,l=m=>{for(var g=0;g<m.length;g++){var w=m[g];if(!u.has(w)){u.add(w);var S=hg(w);e.addEventListener(w,Fr,{passive:S});var V=Fn.get(w);V===void 0?(document.addEventListener(w,Fr,{passive:S}),Fn.set(w,1)):Fn.set(w,V+1)}}};l(wa(fg)),Mu.add(l);var h=void 0,d=eg(()=>{var m=t??e.appendChild(ts());return jm(m,{pending:()=>{}},g=>{if(i){fs({});var w=ue;w.c=i}s&&(r.$$events=s),h=n(g,r)||{},i&&ds()}),()=>{for(var g of u){e.removeEventListener(g,Fr);var w=Fn.get(g);--w===0?(document.removeEventListener(g,Fr),Fn.delete(g)):Fn.set(g,w)}Mu.delete(l),m!==t&&m.parentNode?.removeChild(m)}});return _g.set(h,d),h}let _g=new WeakMap;class yg{anchor;#e=new Map;#t=new Map;#n=new Map;#r=!0;constructor(e,t=!0){this.anchor=e,this.#r=t}#c=()=>{var e=te;if(this.#e.has(e)){var t=this.#e.get(e),r=this.#t.get(t);if(r)Ma(r);else{var s=this.#n.get(t);s&&(this.#t.set(t,s.effect),this.#n.delete(t),s.fragment.lastChild.remove(),this.anchor.before(s.fragment),r=s.effect)}for(const[i,a]of this.#e){if(this.#e.delete(i),i===e)break;const u=this.#n.get(a);u&&(Me(u.effect),this.#n.delete(a))}for(const[i,a]of this.#t){if(i===t)continue;const u=()=>{if(Array.from(this.#e.values()).includes(i)){var h=document.createDocumentFragment();zh(a,h),h.append(ts()),this.#n.set(i,{effect:a,fragment:h})}else Me(a);this.#t.delete(i)};this.#r||!r?Xn(a,u,!1):u()}}};#o=e=>{this.#e.delete(e);const t=Array.from(this.#e.values());for(const[r,s]of this.#n)t.includes(r)||(Me(s.effect),this.#n.delete(r))};ensure(e,t){var r=te,s=Mh();if(t&&!this.#t.has(e)&&!this.#n.has(e))if(s){var i=document.createDocumentFragment(),a=ts();i.append(a),this.#n.set(e,{effect:Xe(()=>t(a)),fragment:i})}else this.#t.set(e,Xe(()=>t(this.anchor)));if(this.#e.set(r,e),s){for(const[u,l]of this.#t)u===e?r.skipped_effects.delete(l):r.skipped_effects.add(l);for(const[u,l]of this.#n)u===e?r.skipped_effects.delete(l.effect):r.skipped_effects.add(l.effect);r.oncommit(this.#c),r.ondiscard(this.#o)}else this.#c()}}function fi(n,e,t=!1){var r=new yg(n),s=t?nr:0;function i(a,u){r.ensure(a,u)}Na(()=>{var a=!1;e((u,l=!0)=>{a=!0,i(l,u)}),a||i(!1,null)},s)}function vg(n,e){return e}function Eg(n,e,t){for(var r=n.items,s=[],i=e.length,a=0;a<i;a++)Oa(e[a].e,s,!0);var u=i>0&&s.length===0&&t!==null;if(u){var l=t.parentNode;Qm(l),l.append(t),r.clear(),it(n,e[0].prev,e[i-1].next)}qh(s,()=>{for(var h=0;h<i;h++){var d=e[h];u||(r.delete(d.k),it(n,d.prev,d.next)),Me(d.e,!u)}})}function Tg(n,e,t,r,s,i=null){var a=n,u={flags:e,items:new Map,first:null},l=null,h=!1,d=new Map,m=Ca(()=>{var V=t();return ph(V)?V:V==null?[]:wa(V)}),g,w;function S(){Ig(w,g,u,d,a,s,e,r,t),i!==null&&(g.length===0?l?Ma(l):l=Xe(()=>i(a)):l!==null&&Xn(l,()=>{l=null}))}Na(()=>{w??=Q,g=J(m);var V=g.length;if(!(h&&V===0)){h=V===0;var C,L,O,M;if(Mh()){var X=new Set,se=te;for(L=0;L<V;L+=1){O=g[L],M=r(O,L);var ie=u.items.get(M)??d.get(M);ie?Jh(ie,O,L):(C=Zh(null,u,null,null,O,M,L,s,e,t,!0),d.set(M,C)),X.add(M)}for(const[T,_]of u.items)X.has(T)||se.skipped_effects.add(_.e);se.oncommit(S)}else S();J(m)}})}function Ig(n,e,t,r,s,i,a,u,l){var h=e.length,d=t.items,m=t.first,g=m,w,S=null,V=[],C=[],L,O,M,X;for(X=0;X<h;X+=1){if(L=e[X],O=u(L,X),M=d.get(O),M===void 0){var se=r.get(O);if(se!==void 0){r.delete(O),d.set(O,se);var ie=S?S.next:g;it(t,S,se),it(t,se,ie),ko(se,ie,s),S=se}else{var T=g?g.e.nodes_start:s;S=Zh(T,t,S,S===null?t.first:S.next,L,O,X,i,a,l)}d.set(O,S),V=[],C=[],g=S.next;continue}if(Jh(M,L,X),(M.e.f&$e)!==0&&Ma(M.e),M!==g){if(w!==void 0&&w.has(M)){if(V.length<C.length){var _=C[0],y;S=_.prev;var I=V[0],E=V[V.length-1];for(y=0;y<V.length;y+=1)ko(V[y],_,s);for(y=0;y<C.length;y+=1)w.delete(C[y]);it(t,I.prev,E.next),it(t,S,I),it(t,E,_),g=_,S=E,X-=1,V=[],C=[]}else w.delete(M),ko(M,g,s),it(t,M.prev,M.next),it(t,M,S===null?t.first:S.next),it(t,S,M),S=M;continue}for(V=[],C=[];g!==null&&g.k!==O;)(g.e.f&$e)===0&&(w??=new Set).add(g),C.push(g),g=g.next;if(g===null)continue;M=g}V.push(M),S=M,g=M.next}if(g!==null||w!==void 0){for(var R=w===void 0?[]:wa(w);g!==null;)(g.e.f&$e)===0&&R.push(g),g=g.next;var v=R.length;if(v>0){var Te=null;Eg(t,R,Te)}}n.first=t.first&&t.first.e,n.last=S&&S.e;for(var vt of r.values())Me(vt.e);r.clear()}function Jh(n,e,t,r){es(n.v,e),n.i=t}function Zh(n,e,t,r,s,i,a,u,l,h,d){var m=(l&wm)!==0,g=(l&Rm)===0,w=m?g?Qn(s,!1,!1):wn(s):s,S=(l&Am)===0?a:wn(a),V={i:S,v:w,k:i,a:null,e:null,prev:t,next:r};try{if(n===null){var C=document.createDocumentFragment();C.append(n=ts())}return V.e=Xe(()=>u(n,w,S,h),Nm),V.e.prev=t&&t.e,V.e.next=r&&r.e,t===null?d||(e.first=V):(t.next=V,t.e.next=V.e),r!==null&&(r.prev=V,r.e.prev=V.e),V}finally{}}function ko(n,e,t){for(var r=n.next?n.next.e.nodes_start:t,s=e?e.e.nodes_start:t,i=n.e.nodes_start;i!==null&&i!==r;){var a=ms(i);s.before(i),i=a}}function it(n,e,t){e===null?n.first=t:(e.next=t,e.e.next=t&&t.e),t!==null&&(t.prev=e,t.e.prev=e&&e.e)}function wg(n,e,t,r,s){var i=e.$$slots?.[t],a=!1;i===!0&&(i=e.children,a=!0),i===void 0||i(n,a?()=>r:r)}const Ag=Symbol("is custom element"),Rg=Symbol("is html");function Js(n,e,t,r){var s=bg(n);s[e]!==(s[e]=t)&&(e==="loading"&&(n[hm]=t),t==null?n.removeAttribute(e):typeof t!="string"&&Sg(n).includes(e)?n[e]=t:n.setAttribute(e,t))}function bg(n){return n.__attributes??={[Ag]:n.nodeName.includes("-"),[Rg]:n.namespaceURI===Vm}}var Fu=new Map;function Sg(n){var e=n.getAttribute("is")||n.nodeName,t=Fu.get(e);if(t)return t;Fu.set(e,t=[]);for(var r,s=n,i=Element.prototype;i!==s;){r=gh(s);for(var a in r)r[a].set&&t.push(a);s=Aa(s)}return t}function Vo(n,e,t=e){var r=new WeakSet;Ym(n,"input",async s=>{var i=s?n.defaultValue:n.value;if(i=Do(n)?No(i):i,t(i),te!==null&&r.add(te),await ag(),i!==(i=e())){var a=n.selectionStart,u=n.selectionEnd,l=n.value.length;if(n.value=i??"",u!==null){var h=n.value.length;a===u&&u===l&&h>l?(n.selectionStart=h,n.selectionEnd=h):(n.selectionStart=a,n.selectionEnd=Math.min(u,h))}}}),_s(e)==null&&n.value&&(t(Do(n)?No(n.value):n.value),te!==null&&r.add(te)),Fh(()=>{var s=e();if(n===document.activeElement){var i=Ys??te;if(r.has(i))return}Do(n)&&s===No(n.value)||n.type==="date"&&!s&&!n.value||s!==n.value&&(n.value=s??"")})}function Do(n){var e=n.type;return e==="number"||e==="range"}function No(n){return n===""?null:+n}function Pg(n){return function(...e){var t=e[0];return t.preventDefault(),n?.apply(this,e)}}function Bi(n=!1){const e=ue,t=e.l.u;if(!t)return;let r=()=>ug(e.s);if(n){let s=0,i={};const a=Pa(()=>{let u=!1;const l=e.s;for(const h in l)l[h]!==i[h]&&(i[h]=l[h],u=!0);return u&&s++,s});r=()=>J(a)}t.b.length&&Zm(()=>{Uu(e,r),Wo(t.b)}),Xo(()=>{const s=_s(()=>t.m.map(um));return()=>{for(const i of s)typeof i=="function"&&i()}}),t.a.length&&Xo(()=>{Uu(e,r),Wo(t.a)})}function Uu(n,e){if(n.l.s)for(const t of n.l.s)J(t);e()}function ef(n,e,t){if(n==null)return e(void 0),Gn;const r=_s(()=>n.subscribe(e,t));return r.unsubscribe?()=>r.unsubscribe():r}const Un=[];function Cg(n,e=Gn){let t=null;const r=new Set;function s(u){if(Th(n,u)&&(n=u,t)){const l=!Un.length;for(const h of r)h[1](),Un.push(h,n);if(l){for(let h=0;h<Un.length;h+=2)Un[h][0](Un[h+1]);Un.length=0}}}function i(u){s(u(n))}function a(u,l=Gn){const h=[u,l];return r.add(h),r.size===1&&(t=e(s,i)||Gn),u(n),()=>{r.delete(h),r.size===0&&t&&(t(),t=null)}}return{set:s,update:i,subscribe:a}}function kg(n){let e;return ef(n,t=>e=t)(),e}let zs=!1,Jo=Symbol();function tf(n,e,t){const r=t[e]??={store:null,source:Qn(void 0),unsubscribe:Gn};if(r.store!==n&&!(Jo in t))if(r.unsubscribe(),r.store=n??null,n==null)r.source.v=void 0,r.unsubscribe=Gn;else{var s=!0;r.unsubscribe=ef(n,i=>{s?r.source.v=i:be(r.source,i)}),s=!1}return n&&Jo in t?kg(n):J(r.source)}function nf(){const n={};function e(){Da(()=>{for(var t in n)n[t].unsubscribe();mh(n,Jo,{enumerable:!1,value:!0})})}return[n,e]}function Vg(n){var e=zs;try{return zs=!1,[n(),zs]}finally{zs=e}}function Bu(n,e,t,r){var s=!pr||(t&bm)!==0,i=(t&Pm)!==0,a=r,u=!0,l=()=>(u&&(u=!1,a=r),a),h;{var d=Kn in n||lm in n;h=Wn(n,e)?.set??(d&&e in n?O=>n[e]=O:void 0)}var m,g=!1;[m,g]=Vg(()=>n[e]),m===void 0&&r!==void 0&&(m=l(),h&&(s&&ym(),h(m)));var w;if(s?w=()=>{var O=n[e];return O===void 0?l():(u=!0,O)}:w=()=>{var O=n[e];return O!==void 0&&(a=void 0),O===void 0?a:O},s&&(t&Sm)===0)return w;if(h){var S=n.$$legacy;return(function(O,M){return arguments.length>0?((!s||!M||S||g)&&h(M?w():O),O):w()})}var V=!1,C=Ca(()=>(V=!1,w()));J(C);var L=Q;return(function(O,M){if(arguments.length>0){const X=M?J(C):s&&i?Hn(O):O;return be(C,X),V=!0,a!==void 0&&(a=X),O}return kn&&V||(L.f&Gt)!==0?C.v:J(C)})}function Dg(n){ue===null&&fm(),pr&&ue.l!==null?Ng(ue).m.push(n):Xo(()=>{const e=_s(n);if(typeof e=="function")return e})}function Ng(n){var e=n.l;return e.u??={a:[],b:[],m:[]}}const Og="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(Og);Mm();const Mg=()=>{};var ju={};const rf=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let s=n.charCodeAt(r);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},Lg=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const s=n[t++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=n[t++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=n[t++],a=n[t++],u=n[t++],l=((s&7)<<18|(i&63)<<12|(a&63)<<6|u&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const i=n[t++],a=n[t++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|a&63)}}return e.join("")},sf={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<n.length;s+=3){const i=n[s],a=s+1<n.length,u=a?n[s+1]:0,l=s+2<n.length,h=l?n[s+2]:0,d=i>>2,m=(i&3)<<4|u>>4;let g=(u&15)<<2|h>>6,w=h&63;l||(w=64,a||(g=64)),r.push(t[d],t[m],t[g],t[w])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(rf(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):Lg(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<n.length;){const i=t[n.charAt(s++)],u=s<n.length?t[n.charAt(s)]:0;++s;const h=s<n.length?t[n.charAt(s)]:64;++s;const m=s<n.length?t[n.charAt(s)]:64;if(++s,i==null||u==null||h==null||m==null)throw new xg;const g=i<<2|u>>4;if(r.push(g),h!==64){const w=u<<4&240|h>>2;if(r.push(w),m!==64){const S=h<<6&192|m;r.push(S)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class xg extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Fg=function(n){const e=rf(n);return sf.encodeByteArray(e,!0)},di=function(n){return Fg(n).replace(/\./g,"")},of=function(n){try{return sf.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function Ug(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const Bg=()=>Ug().__FIREBASE_DEFAULTS__,jg=()=>{if(typeof process>"u"||typeof ju>"u")return;const n=ju.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},qg=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&of(n[1]);return e&&JSON.parse(e)},ji=()=>{try{return Mg()||Bg()||jg()||qg()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},af=n=>ji()?.emulatorHosts?.[n],$g=n=>{const e=af(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},cf=()=>ji()?.config,uf=n=>ji()?.[`_${n}`];class zg{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}function mr(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function lf(n){return(await fetch(n,{credentials:"include"})).ok}function Hg(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",s=n.iat||0,i=n.sub||n.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a={iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...n};return[di(JSON.stringify(t)),di(JSON.stringify(a)),""].join(".")}const Wr={};function Wg(){const n={prod:[],emulator:[]};for(const e of Object.keys(Wr))Wr[e]?n.emulator.push(e):n.prod.push(e);return n}function Gg(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let qu=!1;function hf(n,e){if(typeof window>"u"||typeof document>"u"||!mr(window.location.host)||Wr[n]===e||Wr[n]||qu)return;Wr[n]=e;function t(g){return`__firebase__banner__${g}`}const r="__firebase__banner",i=Wg().prod.length>0;function a(){const g=document.getElementById(r);g&&g.remove()}function u(g){g.style.display="flex",g.style.background="#7faaf0",g.style.position="fixed",g.style.bottom="5px",g.style.left="5px",g.style.padding=".5em",g.style.borderRadius="5px",g.style.alignItems="center"}function l(g,w){g.setAttribute("width","24"),g.setAttribute("id",w),g.setAttribute("height","24"),g.setAttribute("viewBox","0 0 24 24"),g.setAttribute("fill","none"),g.style.marginLeft="-6px"}function h(){const g=document.createElement("span");return g.style.cursor="pointer",g.style.marginLeft="16px",g.style.fontSize="24px",g.innerHTML=" &times;",g.onclick=()=>{qu=!0,a()},g}function d(g,w){g.setAttribute("id",w),g.innerText="Learn more",g.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",g.setAttribute("target","__blank"),g.style.paddingLeft="5px",g.style.textDecoration="underline"}function m(){const g=Gg(r),w=t("text"),S=document.getElementById(w)||document.createElement("span"),V=t("learnmore"),C=document.getElementById(V)||document.createElement("a"),L=t("preprendIcon"),O=document.getElementById(L)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(g.created){const M=g.element;u(M),d(C,V);const X=h();l(O,L),M.append(O,S,C,X),document.body.appendChild(M)}i?(S.innerText="Preview backend disconnected.",O.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(O.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,S.innerText="Preview backend running in this workspace."),S.setAttribute("id",w)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",m):m()}function Ve(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Kg(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ve())}function Qg(){const n=ji()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Xg(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Yg(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function Jg(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Zg(){const n=Ve();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function e_(){return!Qg()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function t_(){try{return typeof indexedDB=="object"}catch{return!1}}function n_(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{e(s.error?.message||"")}}catch(t){e(t)}})}const r_="FirebaseError";class Ot extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=r_,Object.setPrototypeOf(this,Ot.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ys.prototype.create)}}class ys{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},s=`${this.service}/${e}`,i=this.errors[e],a=i?s_(i,r):"Error",u=`${this.serviceName}: ${a} (${s}).`;return new Ot(s,u,r)}}function s_(n,e){return n.replace(i_,(t,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const i_=/\{\$([^}]+)}/g;function o_(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function An(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const s of t){if(!r.includes(s))return!1;const i=n[s],a=e[s];if($u(i)&&$u(a)){if(!An(i,a))return!1}else if(i!==a)return!1}for(const s of r)if(!t.includes(s))return!1;return!0}function $u(n){return n!==null&&typeof n=="object"}function vs(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function a_(n,e){const t=new c_(n,e);return t.subscribe.bind(t)}class c_{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let s;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");u_(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:r},s.next===void 0&&(s.next=Oo),s.error===void 0&&(s.error=Oo),s.complete===void 0&&(s.complete=Oo);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function u_(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Oo(){}function Ue(n){return n&&n._delegate?n._delegate:n}class Rn{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const dn="[DEFAULT]";class l_{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new zg;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(f_(e))try{this.getOrInitializeService({instanceIdentifier:dn})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=dn){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=dn){return this.instances.has(e)}getOptions(e=dn){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[i,a]of this.instancesDeferred.entries()){const u=this.normalizeInstanceIdentifier(i);r===u&&a.resolve(s)}return s}onInit(e,t){const r=this.normalizeInstanceIdentifier(t),s=this.onInitCallbacks.get(r)??new Set;s.add(e),this.onInitCallbacks.set(r,s);const i=this.instances.get(r);return i&&e(i,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const s of r)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:h_(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=dn){return this.component?this.component.multipleInstances?e:dn:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function h_(n){return n===dn?void 0:n}function f_(n){return n.instantiationMode==="EAGER"}class d_{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new l_(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var z;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(z||(z={}));const p_={debug:z.DEBUG,verbose:z.VERBOSE,info:z.INFO,warn:z.WARN,error:z.ERROR,silent:z.SILENT},m_=z.INFO,g_={[z.DEBUG]:"log",[z.VERBOSE]:"log",[z.INFO]:"info",[z.WARN]:"warn",[z.ERROR]:"error"},__=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),s=g_[e];if(s)console[s](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class xa{constructor(e){this.name=e,this._logLevel=m_,this._logHandler=__,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in z))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?p_[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,z.DEBUG,...e),this._logHandler(this,z.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,z.VERBOSE,...e),this._logHandler(this,z.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,z.INFO,...e),this._logHandler(this,z.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,z.WARN,...e),this._logHandler(this,z.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,z.ERROR,...e),this._logHandler(this,z.ERROR,...e)}}const y_=(n,e)=>e.some(t=>n instanceof t);let zu,Hu;function v_(){return zu||(zu=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function E_(){return Hu||(Hu=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const ff=new WeakMap,Zo=new WeakMap,df=new WeakMap,Mo=new WeakMap,Fa=new WeakMap;function T_(n){const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("success",i),n.removeEventListener("error",a)},i=()=>{t(Xt(n.result)),s()},a=()=>{r(n.error),s()};n.addEventListener("success",i),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&ff.set(t,n)}).catch(()=>{}),Fa.set(e,n),e}function I_(n){if(Zo.has(n))return;const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("complete",i),n.removeEventListener("error",a),n.removeEventListener("abort",a)},i=()=>{t(),s()},a=()=>{r(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",i),n.addEventListener("error",a),n.addEventListener("abort",a)});Zo.set(n,e)}let ea={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Zo.get(n);if(e==="objectStoreNames")return n.objectStoreNames||df.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Xt(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function w_(n){ea=n(ea)}function A_(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(Lo(this),e,...t);return df.set(r,e.sort?e.sort():[e]),Xt(r)}:E_().includes(n)?function(...e){return n.apply(Lo(this),e),Xt(ff.get(this))}:function(...e){return Xt(n.apply(Lo(this),e))}}function R_(n){return typeof n=="function"?A_(n):(n instanceof IDBTransaction&&I_(n),y_(n,v_())?new Proxy(n,ea):n)}function Xt(n){if(n instanceof IDBRequest)return T_(n);if(Mo.has(n))return Mo.get(n);const e=R_(n);return e!==n&&(Mo.set(n,e),Fa.set(e,n)),e}const Lo=n=>Fa.get(n);function b_(n,e,{blocked:t,upgrade:r,blocking:s,terminated:i}={}){const a=indexedDB.open(n,e),u=Xt(a);return r&&a.addEventListener("upgradeneeded",l=>{r(Xt(a.result),l.oldVersion,l.newVersion,Xt(a.transaction),l)}),t&&a.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),u.then(l=>{i&&l.addEventListener("close",()=>i()),s&&l.addEventListener("versionchange",h=>s(h.oldVersion,h.newVersion,h))}).catch(()=>{}),u}const S_=["get","getKey","getAll","getAllKeys","count"],P_=["put","add","delete","clear"],xo=new Map;function Wu(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(xo.get(e))return xo.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,s=P_.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(s||S_.includes(t)))return;const i=async function(a,...u){const l=this.transaction(a,s?"readwrite":"readonly");let h=l.store;return r&&(h=h.index(u.shift())),(await Promise.all([h[t](...u),s&&l.done]))[0]};return xo.set(e,i),i}w_(n=>({...n,get:(e,t,r)=>Wu(e,t)||n.get(e,t,r),has:(e,t)=>!!Wu(e,t)||n.has(e,t)}));class C_{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(k_(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function k_(n){return n.getComponent()?.type==="VERSION"}const ta="@firebase/app",Gu="0.14.5";const bt=new xa("@firebase/app"),V_="@firebase/app-compat",D_="@firebase/analytics-compat",N_="@firebase/analytics",O_="@firebase/app-check-compat",M_="@firebase/app-check",L_="@firebase/auth",x_="@firebase/auth-compat",F_="@firebase/database",U_="@firebase/data-connect",B_="@firebase/database-compat",j_="@firebase/functions",q_="@firebase/functions-compat",$_="@firebase/installations",z_="@firebase/installations-compat",H_="@firebase/messaging",W_="@firebase/messaging-compat",G_="@firebase/performance",K_="@firebase/performance-compat",Q_="@firebase/remote-config",X_="@firebase/remote-config-compat",Y_="@firebase/storage",J_="@firebase/storage-compat",Z_="@firebase/firestore",ey="@firebase/ai",ty="@firebase/firestore-compat",ny="firebase",ry="12.5.0";const na="[DEFAULT]",sy={[ta]:"fire-core",[V_]:"fire-core-compat",[N_]:"fire-analytics",[D_]:"fire-analytics-compat",[M_]:"fire-app-check",[O_]:"fire-app-check-compat",[L_]:"fire-auth",[x_]:"fire-auth-compat",[F_]:"fire-rtdb",[U_]:"fire-data-connect",[B_]:"fire-rtdb-compat",[j_]:"fire-fn",[q_]:"fire-fn-compat",[$_]:"fire-iid",[z_]:"fire-iid-compat",[H_]:"fire-fcm",[W_]:"fire-fcm-compat",[G_]:"fire-perf",[K_]:"fire-perf-compat",[Q_]:"fire-rc",[X_]:"fire-rc-compat",[Y_]:"fire-gcs",[J_]:"fire-gcs-compat",[Z_]:"fire-fst",[ty]:"fire-fst-compat",[ey]:"fire-vertex","fire-js":"fire-js",[ny]:"fire-js-all"};const pi=new Map,iy=new Map,ra=new Map;function Ku(n,e){try{n.container.addComponent(e)}catch(t){bt.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function ir(n){const e=n.name;if(ra.has(e))return bt.debug(`There were multiple attempts to register component ${e}.`),!1;ra.set(e,n);for(const t of pi.values())Ku(t,n);for(const t of iy.values())Ku(t,n);return!0}function Ua(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Ye(n){return n==null?!1:n.settings!==void 0}const oy={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Yt=new ys("app","Firebase",oy);class ay{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Rn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Yt.create("app-deleted",{appName:this._name})}}const gr=ry;function pf(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r={name:na,automaticDataCollectionEnabled:!0,...e},s=r.name;if(typeof s!="string"||!s)throw Yt.create("bad-app-name",{appName:String(s)});if(t||(t=cf()),!t)throw Yt.create("no-options");const i=pi.get(s);if(i){if(An(t,i.options)&&An(r,i.config))return i;throw Yt.create("duplicate-app",{appName:s})}const a=new d_(s);for(const l of ra.values())a.addComponent(l);const u=new ay(t,r,a);return pi.set(s,u),u}function mf(n=na){const e=pi.get(n);if(!e&&n===na&&cf())return pf();if(!e)throw Yt.create("no-app",{appName:n});return e}function Jt(n,e,t){let r=sy[n]??n;t&&(r+=`-${t}`);const s=r.match(/\s|\//),i=e.match(/\s|\//);if(s||i){const a=[`Unable to register library "${r}" with version "${e}":`];s&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&i&&a.push("and"),i&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),bt.warn(a.join(" "));return}ir(new Rn(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}const cy="firebase-heartbeat-database",uy=1,ss="firebase-heartbeat-store";let Fo=null;function gf(){return Fo||(Fo=b_(cy,uy,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(ss)}catch(t){console.warn(t)}}}}).catch(n=>{throw Yt.create("idb-open",{originalErrorMessage:n.message})})),Fo}async function ly(n){try{const t=(await gf()).transaction(ss),r=await t.objectStore(ss).get(_f(n));return await t.done,r}catch(e){if(e instanceof Ot)bt.warn(e.message);else{const t=Yt.create("idb-get",{originalErrorMessage:e?.message});bt.warn(t.message)}}}async function Qu(n,e){try{const r=(await gf()).transaction(ss,"readwrite");await r.objectStore(ss).put(e,_f(n)),await r.done}catch(t){if(t instanceof Ot)bt.warn(t.message);else{const r=Yt.create("idb-set",{originalErrorMessage:t?.message});bt.warn(r.message)}}}function _f(n){return`${n.name}!${n.options.appId}`}const hy=1024,fy=30;class dy{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new my(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=Xu();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(s=>s.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:t}),this._heartbeatsCache.heartbeats.length>fy){const s=gy(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(s,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){bt.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Xu(),{heartbeatsToSend:t,unsentEntries:r}=py(this._heartbeatsCache.heartbeats),s=di(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(e){return bt.warn(e),""}}}function Xu(){return new Date().toISOString().substring(0,10)}function py(n,e=hy){const t=[];let r=n.slice();for(const s of n){const i=t.find(a=>a.agent===s.agent);if(i){if(i.dates.push(s.date),Yu(t)>e){i.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),Yu(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class my{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return t_()?n_().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await ly(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Qu(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Qu(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function Yu(n){return di(JSON.stringify({version:2,heartbeats:n})).length}function gy(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function _y(n){ir(new Rn("platform-logger",e=>new C_(e),"PRIVATE")),ir(new Rn("heartbeat",e=>new dy(e),"PRIVATE")),Jt(ta,Gu,n),Jt(ta,Gu,"esm2020"),Jt("fire-js","")}_y("");var yy="firebase",vy="12.5.0";Jt(yy,vy,"app");var Ju=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Zt,yf;(function(){var n;function e(T,_){function y(){}y.prototype=_.prototype,T.F=_.prototype,T.prototype=new y,T.prototype.constructor=T,T.D=function(I,E,R){for(var v=Array(arguments.length-2),Te=2;Te<arguments.length;Te++)v[Te-2]=arguments[Te];return _.prototype[E].apply(I,v)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(T,_,y){y||(y=0);const I=Array(16);if(typeof _=="string")for(var E=0;E<16;++E)I[E]=_.charCodeAt(y++)|_.charCodeAt(y++)<<8|_.charCodeAt(y++)<<16|_.charCodeAt(y++)<<24;else for(E=0;E<16;++E)I[E]=_[y++]|_[y++]<<8|_[y++]<<16|_[y++]<<24;_=T.g[0],y=T.g[1],E=T.g[2];let R=T.g[3],v;v=_+(R^y&(E^R))+I[0]+3614090360&4294967295,_=y+(v<<7&4294967295|v>>>25),v=R+(E^_&(y^E))+I[1]+3905402710&4294967295,R=_+(v<<12&4294967295|v>>>20),v=E+(y^R&(_^y))+I[2]+606105819&4294967295,E=R+(v<<17&4294967295|v>>>15),v=y+(_^E&(R^_))+I[3]+3250441966&4294967295,y=E+(v<<22&4294967295|v>>>10),v=_+(R^y&(E^R))+I[4]+4118548399&4294967295,_=y+(v<<7&4294967295|v>>>25),v=R+(E^_&(y^E))+I[5]+1200080426&4294967295,R=_+(v<<12&4294967295|v>>>20),v=E+(y^R&(_^y))+I[6]+2821735955&4294967295,E=R+(v<<17&4294967295|v>>>15),v=y+(_^E&(R^_))+I[7]+4249261313&4294967295,y=E+(v<<22&4294967295|v>>>10),v=_+(R^y&(E^R))+I[8]+1770035416&4294967295,_=y+(v<<7&4294967295|v>>>25),v=R+(E^_&(y^E))+I[9]+2336552879&4294967295,R=_+(v<<12&4294967295|v>>>20),v=E+(y^R&(_^y))+I[10]+4294925233&4294967295,E=R+(v<<17&4294967295|v>>>15),v=y+(_^E&(R^_))+I[11]+2304563134&4294967295,y=E+(v<<22&4294967295|v>>>10),v=_+(R^y&(E^R))+I[12]+1804603682&4294967295,_=y+(v<<7&4294967295|v>>>25),v=R+(E^_&(y^E))+I[13]+4254626195&4294967295,R=_+(v<<12&4294967295|v>>>20),v=E+(y^R&(_^y))+I[14]+2792965006&4294967295,E=R+(v<<17&4294967295|v>>>15),v=y+(_^E&(R^_))+I[15]+1236535329&4294967295,y=E+(v<<22&4294967295|v>>>10),v=_+(E^R&(y^E))+I[1]+4129170786&4294967295,_=y+(v<<5&4294967295|v>>>27),v=R+(y^E&(_^y))+I[6]+3225465664&4294967295,R=_+(v<<9&4294967295|v>>>23),v=E+(_^y&(R^_))+I[11]+643717713&4294967295,E=R+(v<<14&4294967295|v>>>18),v=y+(R^_&(E^R))+I[0]+3921069994&4294967295,y=E+(v<<20&4294967295|v>>>12),v=_+(E^R&(y^E))+I[5]+3593408605&4294967295,_=y+(v<<5&4294967295|v>>>27),v=R+(y^E&(_^y))+I[10]+38016083&4294967295,R=_+(v<<9&4294967295|v>>>23),v=E+(_^y&(R^_))+I[15]+3634488961&4294967295,E=R+(v<<14&4294967295|v>>>18),v=y+(R^_&(E^R))+I[4]+3889429448&4294967295,y=E+(v<<20&4294967295|v>>>12),v=_+(E^R&(y^E))+I[9]+568446438&4294967295,_=y+(v<<5&4294967295|v>>>27),v=R+(y^E&(_^y))+I[14]+3275163606&4294967295,R=_+(v<<9&4294967295|v>>>23),v=E+(_^y&(R^_))+I[3]+4107603335&4294967295,E=R+(v<<14&4294967295|v>>>18),v=y+(R^_&(E^R))+I[8]+1163531501&4294967295,y=E+(v<<20&4294967295|v>>>12),v=_+(E^R&(y^E))+I[13]+2850285829&4294967295,_=y+(v<<5&4294967295|v>>>27),v=R+(y^E&(_^y))+I[2]+4243563512&4294967295,R=_+(v<<9&4294967295|v>>>23),v=E+(_^y&(R^_))+I[7]+1735328473&4294967295,E=R+(v<<14&4294967295|v>>>18),v=y+(R^_&(E^R))+I[12]+2368359562&4294967295,y=E+(v<<20&4294967295|v>>>12),v=_+(y^E^R)+I[5]+4294588738&4294967295,_=y+(v<<4&4294967295|v>>>28),v=R+(_^y^E)+I[8]+2272392833&4294967295,R=_+(v<<11&4294967295|v>>>21),v=E+(R^_^y)+I[11]+1839030562&4294967295,E=R+(v<<16&4294967295|v>>>16),v=y+(E^R^_)+I[14]+4259657740&4294967295,y=E+(v<<23&4294967295|v>>>9),v=_+(y^E^R)+I[1]+2763975236&4294967295,_=y+(v<<4&4294967295|v>>>28),v=R+(_^y^E)+I[4]+1272893353&4294967295,R=_+(v<<11&4294967295|v>>>21),v=E+(R^_^y)+I[7]+4139469664&4294967295,E=R+(v<<16&4294967295|v>>>16),v=y+(E^R^_)+I[10]+3200236656&4294967295,y=E+(v<<23&4294967295|v>>>9),v=_+(y^E^R)+I[13]+681279174&4294967295,_=y+(v<<4&4294967295|v>>>28),v=R+(_^y^E)+I[0]+3936430074&4294967295,R=_+(v<<11&4294967295|v>>>21),v=E+(R^_^y)+I[3]+3572445317&4294967295,E=R+(v<<16&4294967295|v>>>16),v=y+(E^R^_)+I[6]+76029189&4294967295,y=E+(v<<23&4294967295|v>>>9),v=_+(y^E^R)+I[9]+3654602809&4294967295,_=y+(v<<4&4294967295|v>>>28),v=R+(_^y^E)+I[12]+3873151461&4294967295,R=_+(v<<11&4294967295|v>>>21),v=E+(R^_^y)+I[15]+530742520&4294967295,E=R+(v<<16&4294967295|v>>>16),v=y+(E^R^_)+I[2]+3299628645&4294967295,y=E+(v<<23&4294967295|v>>>9),v=_+(E^(y|~R))+I[0]+4096336452&4294967295,_=y+(v<<6&4294967295|v>>>26),v=R+(y^(_|~E))+I[7]+1126891415&4294967295,R=_+(v<<10&4294967295|v>>>22),v=E+(_^(R|~y))+I[14]+2878612391&4294967295,E=R+(v<<15&4294967295|v>>>17),v=y+(R^(E|~_))+I[5]+4237533241&4294967295,y=E+(v<<21&4294967295|v>>>11),v=_+(E^(y|~R))+I[12]+1700485571&4294967295,_=y+(v<<6&4294967295|v>>>26),v=R+(y^(_|~E))+I[3]+2399980690&4294967295,R=_+(v<<10&4294967295|v>>>22),v=E+(_^(R|~y))+I[10]+4293915773&4294967295,E=R+(v<<15&4294967295|v>>>17),v=y+(R^(E|~_))+I[1]+2240044497&4294967295,y=E+(v<<21&4294967295|v>>>11),v=_+(E^(y|~R))+I[8]+1873313359&4294967295,_=y+(v<<6&4294967295|v>>>26),v=R+(y^(_|~E))+I[15]+4264355552&4294967295,R=_+(v<<10&4294967295|v>>>22),v=E+(_^(R|~y))+I[6]+2734768916&4294967295,E=R+(v<<15&4294967295|v>>>17),v=y+(R^(E|~_))+I[13]+1309151649&4294967295,y=E+(v<<21&4294967295|v>>>11),v=_+(E^(y|~R))+I[4]+4149444226&4294967295,_=y+(v<<6&4294967295|v>>>26),v=R+(y^(_|~E))+I[11]+3174756917&4294967295,R=_+(v<<10&4294967295|v>>>22),v=E+(_^(R|~y))+I[2]+718787259&4294967295,E=R+(v<<15&4294967295|v>>>17),v=y+(R^(E|~_))+I[9]+3951481745&4294967295,T.g[0]=T.g[0]+_&4294967295,T.g[1]=T.g[1]+(E+(v<<21&4294967295|v>>>11))&4294967295,T.g[2]=T.g[2]+E&4294967295,T.g[3]=T.g[3]+R&4294967295}r.prototype.v=function(T,_){_===void 0&&(_=T.length);const y=_-this.blockSize,I=this.C;let E=this.h,R=0;for(;R<_;){if(E==0)for(;R<=y;)s(this,T,R),R+=this.blockSize;if(typeof T=="string"){for(;R<_;)if(I[E++]=T.charCodeAt(R++),E==this.blockSize){s(this,I),E=0;break}}else for(;R<_;)if(I[E++]=T[R++],E==this.blockSize){s(this,I),E=0;break}}this.h=E,this.o+=_},r.prototype.A=function(){var T=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);T[0]=128;for(var _=1;_<T.length-8;++_)T[_]=0;_=this.o*8;for(var y=T.length-8;y<T.length;++y)T[y]=_&255,_/=256;for(this.v(T),T=Array(16),_=0,y=0;y<4;++y)for(let I=0;I<32;I+=8)T[_++]=this.g[y]>>>I&255;return T};function i(T,_){var y=u;return Object.prototype.hasOwnProperty.call(y,T)?y[T]:y[T]=_(T)}function a(T,_){this.h=_;const y=[];let I=!0;for(let E=T.length-1;E>=0;E--){const R=T[E]|0;I&&R==_||(y[E]=R,I=!1)}this.g=y}var u={};function l(T){return-128<=T&&T<128?i(T,function(_){return new a([_|0],_<0?-1:0)}):new a([T|0],T<0?-1:0)}function h(T){if(isNaN(T)||!isFinite(T))return m;if(T<0)return C(h(-T));const _=[];let y=1;for(let I=0;T>=y;I++)_[I]=T/y|0,y*=4294967296;return new a(_,0)}function d(T,_){if(T.length==0)throw Error("number format error: empty string");if(_=_||10,_<2||36<_)throw Error("radix out of range: "+_);if(T.charAt(0)=="-")return C(d(T.substring(1),_));if(T.indexOf("-")>=0)throw Error('number format error: interior "-" character');const y=h(Math.pow(_,8));let I=m;for(let R=0;R<T.length;R+=8){var E=Math.min(8,T.length-R);const v=parseInt(T.substring(R,R+E),_);E<8?(E=h(Math.pow(_,E)),I=I.j(E).add(h(v))):(I=I.j(y),I=I.add(h(v)))}return I}var m=l(0),g=l(1),w=l(16777216);n=a.prototype,n.m=function(){if(V(this))return-C(this).m();let T=0,_=1;for(let y=0;y<this.g.length;y++){const I=this.i(y);T+=(I>=0?I:4294967296+I)*_,_*=4294967296}return T},n.toString=function(T){if(T=T||10,T<2||36<T)throw Error("radix out of range: "+T);if(S(this))return"0";if(V(this))return"-"+C(this).toString(T);const _=h(Math.pow(T,6));var y=this;let I="";for(;;){const E=X(y,_).g;y=L(y,E.j(_));let R=((y.g.length>0?y.g[0]:y.h)>>>0).toString(T);if(y=E,S(y))return R+I;for(;R.length<6;)R="0"+R;I=R+I}},n.i=function(T){return T<0?0:T<this.g.length?this.g[T]:this.h};function S(T){if(T.h!=0)return!1;for(let _=0;_<T.g.length;_++)if(T.g[_]!=0)return!1;return!0}function V(T){return T.h==-1}n.l=function(T){return T=L(this,T),V(T)?-1:S(T)?0:1};function C(T){const _=T.g.length,y=[];for(let I=0;I<_;I++)y[I]=~T.g[I];return new a(y,~T.h).add(g)}n.abs=function(){return V(this)?C(this):this},n.add=function(T){const _=Math.max(this.g.length,T.g.length),y=[];let I=0;for(let E=0;E<=_;E++){let R=I+(this.i(E)&65535)+(T.i(E)&65535),v=(R>>>16)+(this.i(E)>>>16)+(T.i(E)>>>16);I=v>>>16,R&=65535,v&=65535,y[E]=v<<16|R}return new a(y,y[y.length-1]&-2147483648?-1:0)};function L(T,_){return T.add(C(_))}n.j=function(T){if(S(this)||S(T))return m;if(V(this))return V(T)?C(this).j(C(T)):C(C(this).j(T));if(V(T))return C(this.j(C(T)));if(this.l(w)<0&&T.l(w)<0)return h(this.m()*T.m());const _=this.g.length+T.g.length,y=[];for(var I=0;I<2*_;I++)y[I]=0;for(I=0;I<this.g.length;I++)for(let E=0;E<T.g.length;E++){const R=this.i(I)>>>16,v=this.i(I)&65535,Te=T.i(E)>>>16,vt=T.i(E)&65535;y[2*I+2*E]+=v*vt,O(y,2*I+2*E),y[2*I+2*E+1]+=R*vt,O(y,2*I+2*E+1),y[2*I+2*E+1]+=v*Te,O(y,2*I+2*E+1),y[2*I+2*E+2]+=R*Te,O(y,2*I+2*E+2)}for(T=0;T<_;T++)y[T]=y[2*T+1]<<16|y[2*T];for(T=_;T<2*_;T++)y[T]=0;return new a(y,0)};function O(T,_){for(;(T[_]&65535)!=T[_];)T[_+1]+=T[_]>>>16,T[_]&=65535,_++}function M(T,_){this.g=T,this.h=_}function X(T,_){if(S(_))throw Error("division by zero");if(S(T))return new M(m,m);if(V(T))return _=X(C(T),_),new M(C(_.g),C(_.h));if(V(_))return _=X(T,C(_)),new M(C(_.g),_.h);if(T.g.length>30){if(V(T)||V(_))throw Error("slowDivide_ only works with positive integers.");for(var y=g,I=_;I.l(T)<=0;)y=se(y),I=se(I);var E=ie(y,1),R=ie(I,1);for(I=ie(I,2),y=ie(y,2);!S(I);){var v=R.add(I);v.l(T)<=0&&(E=E.add(y),R=v),I=ie(I,1),y=ie(y,1)}return _=L(T,E.j(_)),new M(E,_)}for(E=m;T.l(_)>=0;){for(y=Math.max(1,Math.floor(T.m()/_.m())),I=Math.ceil(Math.log(y)/Math.LN2),I=I<=48?1:Math.pow(2,I-48),R=h(y),v=R.j(_);V(v)||v.l(T)>0;)y-=I,R=h(y),v=R.j(_);S(R)&&(R=g),E=E.add(R),T=L(T,v)}return new M(E,T)}n.B=function(T){return X(this,T).h},n.and=function(T){const _=Math.max(this.g.length,T.g.length),y=[];for(let I=0;I<_;I++)y[I]=this.i(I)&T.i(I);return new a(y,this.h&T.h)},n.or=function(T){const _=Math.max(this.g.length,T.g.length),y=[];for(let I=0;I<_;I++)y[I]=this.i(I)|T.i(I);return new a(y,this.h|T.h)},n.xor=function(T){const _=Math.max(this.g.length,T.g.length),y=[];for(let I=0;I<_;I++)y[I]=this.i(I)^T.i(I);return new a(y,this.h^T.h)};function se(T){const _=T.g.length+1,y=[];for(let I=0;I<_;I++)y[I]=T.i(I)<<1|T.i(I-1)>>>31;return new a(y,T.h)}function ie(T,_){const y=_>>5;_%=32;const I=T.g.length-y,E=[];for(let R=0;R<I;R++)E[R]=_>0?T.i(R+y)>>>_|T.i(R+y+1)<<32-_:T.i(R+y);return new a(E,T.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,yf=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.B,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=h,a.fromString=d,Zt=a}).apply(typeof Ju<"u"?Ju:typeof self<"u"?self:typeof window<"u"?window:{});var Hs=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var vf,Ur,Ef,Zs,sa,Tf,If,wf;(function(){var n,e=Object.defineProperty;function t(o){o=[typeof globalThis=="object"&&globalThis,o,typeof window=="object"&&window,typeof self=="object"&&self,typeof Hs=="object"&&Hs];for(var c=0;c<o.length;++c){var f=o[c];if(f&&f.Math==Math)return f}throw Error("Cannot find global object")}var r=t(this);function s(o,c){if(c)e:{var f=r;o=o.split(".");for(var p=0;p<o.length-1;p++){var A=o[p];if(!(A in f))break e;f=f[A]}o=o[o.length-1],p=f[o],c=c(p),c!=p&&c!=null&&e(f,o,{configurable:!0,writable:!0,value:c})}}s("Symbol.dispose",function(o){return o||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(o){return o||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(o){return o||function(c){var f=[],p;for(p in c)Object.prototype.hasOwnProperty.call(c,p)&&f.push([p,c[p]]);return f}});var i=i||{},a=this||self;function u(o){var c=typeof o;return c=="object"&&o!=null||c=="function"}function l(o,c,f){return o.call.apply(o.bind,arguments)}function h(o,c,f){return h=l,h.apply(null,arguments)}function d(o,c){var f=Array.prototype.slice.call(arguments,1);return function(){var p=f.slice();return p.push.apply(p,arguments),o.apply(this,p)}}function m(o,c){function f(){}f.prototype=c.prototype,o.Z=c.prototype,o.prototype=new f,o.prototype.constructor=o,o.Ob=function(p,A,b){for(var D=Array(arguments.length-2),$=2;$<arguments.length;$++)D[$-2]=arguments[$];return c.prototype[A].apply(p,D)}}var g=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?o=>o&&AsyncContext.Snapshot.wrap(o):o=>o;function w(o){const c=o.length;if(c>0){const f=Array(c);for(let p=0;p<c;p++)f[p]=o[p];return f}return[]}function S(o,c){for(let p=1;p<arguments.length;p++){const A=arguments[p];var f=typeof A;if(f=f!="object"?f:A?Array.isArray(A)?"array":f:"null",f=="array"||f=="object"&&typeof A.length=="number"){f=o.length||0;const b=A.length||0;o.length=f+b;for(let D=0;D<b;D++)o[f+D]=A[D]}else o.push(A)}}class V{constructor(c,f){this.i=c,this.j=f,this.h=0,this.g=null}get(){let c;return this.h>0?(this.h--,c=this.g,this.g=c.next,c.next=null):c=this.i(),c}}function C(o){a.setTimeout(()=>{throw o},0)}function L(){var o=T;let c=null;return o.g&&(c=o.g,o.g=o.g.next,o.g||(o.h=null),c.next=null),c}class O{constructor(){this.h=this.g=null}add(c,f){const p=M.get();p.set(c,f),this.h?this.h.next=p:this.g=p,this.h=p}}var M=new V(()=>new X,o=>o.reset());class X{constructor(){this.next=this.g=this.h=null}set(c,f){this.h=c,this.g=f,this.next=null}reset(){this.next=this.g=this.h=null}}let se,ie=!1,T=new O,_=()=>{const o=Promise.resolve(void 0);se=()=>{o.then(y)}};function y(){for(var o;o=L();){try{o.h.call(o.g)}catch(f){C(f)}var c=M;c.j(o),c.h<100&&(c.h++,o.next=c.g,c.g=o)}ie=!1}function I(){this.u=this.u,this.C=this.C}I.prototype.u=!1,I.prototype.dispose=function(){this.u||(this.u=!0,this.N())},I.prototype[Symbol.dispose]=function(){this.dispose()},I.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function E(o,c){this.type=o,this.g=this.target=c,this.defaultPrevented=!1}E.prototype.h=function(){this.defaultPrevented=!0};var R=(function(){if(!a.addEventListener||!Object.defineProperty)return!1;var o=!1,c=Object.defineProperty({},"passive",{get:function(){o=!0}});try{const f=()=>{};a.addEventListener("test",f,c),a.removeEventListener("test",f,c)}catch{}return o})();function v(o){return/^[\s\xa0]*$/.test(o)}function Te(o,c){E.call(this,o?o.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,o&&this.init(o,c)}m(Te,E),Te.prototype.init=function(o,c){const f=this.type=o.type,p=o.changedTouches&&o.changedTouches.length?o.changedTouches[0]:null;this.target=o.target||o.srcElement,this.g=c,c=o.relatedTarget,c||(f=="mouseover"?c=o.fromElement:f=="mouseout"&&(c=o.toElement)),this.relatedTarget=c,p?(this.clientX=p.clientX!==void 0?p.clientX:p.pageX,this.clientY=p.clientY!==void 0?p.clientY:p.pageY,this.screenX=p.screenX||0,this.screenY=p.screenY||0):(this.clientX=o.clientX!==void 0?o.clientX:o.pageX,this.clientY=o.clientY!==void 0?o.clientY:o.pageY,this.screenX=o.screenX||0,this.screenY=o.screenY||0),this.button=o.button,this.key=o.key||"",this.ctrlKey=o.ctrlKey,this.altKey=o.altKey,this.shiftKey=o.shiftKey,this.metaKey=o.metaKey,this.pointerId=o.pointerId||0,this.pointerType=o.pointerType,this.state=o.state,this.i=o,o.defaultPrevented&&Te.Z.h.call(this)},Te.prototype.h=function(){Te.Z.h.call(this);const o=this.i;o.preventDefault?o.preventDefault():o.returnValue=!1};var vt="closure_listenable_"+(Math.random()*1e6|0),Pp=0;function Cp(o,c,f,p,A){this.listener=o,this.proxy=null,this.src=c,this.type=f,this.capture=!!p,this.ha=A,this.key=++Pp,this.da=this.fa=!1}function Ps(o){o.da=!0,o.listener=null,o.proxy=null,o.src=null,o.ha=null}function Cs(o,c,f){for(const p in o)c.call(f,o[p],p,o)}function kp(o,c){for(const f in o)c.call(void 0,o[f],f,o)}function bc(o){const c={};for(const f in o)c[f]=o[f];return c}const Sc="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Pc(o,c){let f,p;for(let A=1;A<arguments.length;A++){p=arguments[A];for(f in p)o[f]=p[f];for(let b=0;b<Sc.length;b++)f=Sc[b],Object.prototype.hasOwnProperty.call(p,f)&&(o[f]=p[f])}}function ks(o){this.src=o,this.g={},this.h=0}ks.prototype.add=function(o,c,f,p,A){const b=o.toString();o=this.g[b],o||(o=this.g[b]=[],this.h++);const D=oo(o,c,p,A);return D>-1?(c=o[D],f||(c.fa=!1)):(c=new Cp(c,this.src,b,!!p,A),c.fa=f,o.push(c)),c};function io(o,c){const f=c.type;if(f in o.g){var p=o.g[f],A=Array.prototype.indexOf.call(p,c,void 0),b;(b=A>=0)&&Array.prototype.splice.call(p,A,1),b&&(Ps(c),o.g[f].length==0&&(delete o.g[f],o.h--))}}function oo(o,c,f,p){for(let A=0;A<o.length;++A){const b=o[A];if(!b.da&&b.listener==c&&b.capture==!!f&&b.ha==p)return A}return-1}var ao="closure_lm_"+(Math.random()*1e6|0),co={};function Cc(o,c,f,p,A){if(Array.isArray(c)){for(let b=0;b<c.length;b++)Cc(o,c[b],f,p,A);return null}return f=Dc(f),o&&o[vt]?o.J(c,f,u(p)?!!p.capture:!1,A):Vp(o,c,f,!1,p,A)}function Vp(o,c,f,p,A,b){if(!c)throw Error("Invalid event type");const D=u(A)?!!A.capture:!!A;let $=lo(o);if($||(o[ao]=$=new ks(o)),f=$.add(c,f,p,D,b),f.proxy)return f;if(p=Dp(),f.proxy=p,p.src=o,p.listener=f,o.addEventListener)R||(A=D),A===void 0&&(A=!1),o.addEventListener(c.toString(),p,A);else if(o.attachEvent)o.attachEvent(Vc(c.toString()),p);else if(o.addListener&&o.removeListener)o.addListener(p);else throw Error("addEventListener and attachEvent are unavailable.");return f}function Dp(){function o(f){return c.call(o.src,o.listener,f)}const c=Np;return o}function kc(o,c,f,p,A){if(Array.isArray(c))for(var b=0;b<c.length;b++)kc(o,c[b],f,p,A);else p=u(p)?!!p.capture:!!p,f=Dc(f),o&&o[vt]?(o=o.i,b=String(c).toString(),b in o.g&&(c=o.g[b],f=oo(c,f,p,A),f>-1&&(Ps(c[f]),Array.prototype.splice.call(c,f,1),c.length==0&&(delete o.g[b],o.h--)))):o&&(o=lo(o))&&(c=o.g[c.toString()],o=-1,c&&(o=oo(c,f,p,A)),(f=o>-1?c[o]:null)&&uo(f))}function uo(o){if(typeof o!="number"&&o&&!o.da){var c=o.src;if(c&&c[vt])io(c.i,o);else{var f=o.type,p=o.proxy;c.removeEventListener?c.removeEventListener(f,p,o.capture):c.detachEvent?c.detachEvent(Vc(f),p):c.addListener&&c.removeListener&&c.removeListener(p),(f=lo(c))?(io(f,o),f.h==0&&(f.src=null,c[ao]=null)):Ps(o)}}}function Vc(o){return o in co?co[o]:co[o]="on"+o}function Np(o,c){if(o.da)o=!0;else{c=new Te(c,this);const f=o.listener,p=o.ha||o.src;o.fa&&uo(o),o=f.call(p,c)}return o}function lo(o){return o=o[ao],o instanceof ks?o:null}var ho="__closure_events_fn_"+(Math.random()*1e9>>>0);function Dc(o){return typeof o=="function"?o:(o[ho]||(o[ho]=function(c){return o.handleEvent(c)}),o[ho])}function Ie(){I.call(this),this.i=new ks(this),this.M=this,this.G=null}m(Ie,I),Ie.prototype[vt]=!0,Ie.prototype.removeEventListener=function(o,c,f,p){kc(this,o,c,f,p)};function De(o,c){var f,p=o.G;if(p)for(f=[];p;p=p.G)f.push(p);if(o=o.M,p=c.type||c,typeof c=="string")c=new E(c,o);else if(c instanceof E)c.target=c.target||o;else{var A=c;c=new E(p,o),Pc(c,A)}A=!0;let b,D;if(f)for(D=f.length-1;D>=0;D--)b=c.g=f[D],A=Vs(b,p,!0,c)&&A;if(b=c.g=o,A=Vs(b,p,!0,c)&&A,A=Vs(b,p,!1,c)&&A,f)for(D=0;D<f.length;D++)b=c.g=f[D],A=Vs(b,p,!1,c)&&A}Ie.prototype.N=function(){if(Ie.Z.N.call(this),this.i){var o=this.i;for(const c in o.g){const f=o.g[c];for(let p=0;p<f.length;p++)Ps(f[p]);delete o.g[c],o.h--}}this.G=null},Ie.prototype.J=function(o,c,f,p){return this.i.add(String(o),c,!1,f,p)},Ie.prototype.K=function(o,c,f,p){return this.i.add(String(o),c,!0,f,p)};function Vs(o,c,f,p){if(c=o.i.g[String(c)],!c)return!0;c=c.concat();let A=!0;for(let b=0;b<c.length;++b){const D=c[b];if(D&&!D.da&&D.capture==f){const $=D.listener,fe=D.ha||D.src;D.fa&&io(o.i,D),A=$.call(fe,p)!==!1&&A}}return A&&!p.defaultPrevented}function Op(o,c){if(typeof o!="function")if(o&&typeof o.handleEvent=="function")o=h(o.handleEvent,o);else throw Error("Invalid listener argument");return Number(c)>2147483647?-1:a.setTimeout(o,c||0)}function Nc(o){o.g=Op(()=>{o.g=null,o.i&&(o.i=!1,Nc(o))},o.l);const c=o.h;o.h=null,o.m.apply(null,c)}class Mp extends I{constructor(c,f){super(),this.m=c,this.l=f,this.h=null,this.i=!1,this.g=null}j(c){this.h=arguments,this.g?this.i=!0:Nc(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ir(o){I.call(this),this.h=o,this.g={}}m(Ir,I);var Oc=[];function Mc(o){Cs(o.g,function(c,f){this.g.hasOwnProperty(f)&&uo(c)},o),o.g={}}Ir.prototype.N=function(){Ir.Z.N.call(this),Mc(this)},Ir.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var fo=a.JSON.stringify,Lp=a.JSON.parse,xp=class{stringify(o){return a.JSON.stringify(o,void 0)}parse(o){return a.JSON.parse(o,void 0)}};function Lc(){}function xc(){}var wr={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function po(){E.call(this,"d")}m(po,E);function mo(){E.call(this,"c")}m(mo,E);var cn={},Fc=null;function Ds(){return Fc=Fc||new Ie}cn.Ia="serverreachability";function Uc(o){E.call(this,cn.Ia,o)}m(Uc,E);function Ar(o){const c=Ds();De(c,new Uc(c))}cn.STAT_EVENT="statevent";function Bc(o,c){E.call(this,cn.STAT_EVENT,o),this.stat=c}m(Bc,E);function Ne(o){const c=Ds();De(c,new Bc(c,o))}cn.Ja="timingevent";function jc(o,c){E.call(this,cn.Ja,o),this.size=c}m(jc,E);function Rr(o,c){if(typeof o!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){o()},c)}function br(){this.g=!0}br.prototype.ua=function(){this.g=!1};function Fp(o,c,f,p,A,b){o.info(function(){if(o.g)if(b){var D="",$=b.split("&");for(let Z=0;Z<$.length;Z++){var fe=$[Z].split("=");if(fe.length>1){const me=fe[0];fe=fe[1];const st=me.split("_");D=st.length>=2&&st[1]=="type"?D+(me+"="+fe+"&"):D+(me+"=redacted&")}}}else D=null;else D=b;return"XMLHTTP REQ ("+p+") [attempt "+A+"]: "+c+`
`+f+`
`+D})}function Up(o,c,f,p,A,b,D){o.info(function(){return"XMLHTTP RESP ("+p+") [ attempt "+A+"]: "+c+`
`+f+`
`+b+" "+D})}function Mn(o,c,f,p){o.info(function(){return"XMLHTTP TEXT ("+c+"): "+jp(o,f)+(p?" "+p:"")})}function Bp(o,c){o.info(function(){return"TIMEOUT: "+c})}br.prototype.info=function(){};function jp(o,c){if(!o.g)return c;if(!c)return null;try{const b=JSON.parse(c);if(b){for(o=0;o<b.length;o++)if(Array.isArray(b[o])){var f=b[o];if(!(f.length<2)){var p=f[1];if(Array.isArray(p)&&!(p.length<1)){var A=p[0];if(A!="noop"&&A!="stop"&&A!="close")for(let D=1;D<p.length;D++)p[D]=""}}}}return fo(b)}catch{return c}}var Ns={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},qc={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},$c;function go(){}m(go,Lc),go.prototype.g=function(){return new XMLHttpRequest},$c=new go;function Sr(o){return encodeURIComponent(String(o))}function qp(o){var c=1;o=o.split(":");const f=[];for(;c>0&&o.length;)f.push(o.shift()),c--;return o.length&&f.push(o.join(":")),f}function Mt(o,c,f,p){this.j=o,this.i=c,this.l=f,this.S=p||1,this.V=new Ir(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new zc}function zc(){this.i=null,this.g="",this.h=!1}var Hc={},_o={};function yo(o,c,f){o.M=1,o.A=Ms(rt(c)),o.u=f,o.R=!0,Wc(o,null)}function Wc(o,c){o.F=Date.now(),Os(o),o.B=rt(o.A);var f=o.B,p=o.S;Array.isArray(p)||(p=[String(p)]),iu(f.i,"t",p),o.C=0,f=o.j.L,o.h=new zc,o.g=wu(o.j,f?c:null,!o.u),o.P>0&&(o.O=new Mp(h(o.Y,o,o.g),o.P)),c=o.V,f=o.g,p=o.ba;var A="readystatechange";Array.isArray(A)||(A&&(Oc[0]=A.toString()),A=Oc);for(let b=0;b<A.length;b++){const D=Cc(f,A[b],p||c.handleEvent,!1,c.h||c);if(!D)break;c.g[D.key]=D}c=o.J?bc(o.J):{},o.u?(o.v||(o.v="POST"),c["Content-Type"]="application/x-www-form-urlencoded",o.g.ea(o.B,o.v,o.u,c)):(o.v="GET",o.g.ea(o.B,o.v,null,c)),Ar(),Fp(o.i,o.v,o.B,o.l,o.S,o.u)}Mt.prototype.ba=function(o){o=o.target;const c=this.O;c&&Ft(o)==3?c.j():this.Y(o)},Mt.prototype.Y=function(o){try{if(o==this.g)e:{const $=Ft(this.g),fe=this.g.ya(),Z=this.g.ca();if(!($<3)&&($!=3||this.g&&(this.h.h||this.g.la()||fu(this.g)))){this.K||$!=4||fe==7||(fe==8||Z<=0?Ar(3):Ar(2)),vo(this);var c=this.g.ca();this.X=c;var f=$p(this);if(this.o=c==200,Up(this.i,this.v,this.B,this.l,this.S,$,c),this.o){if(this.U&&!this.L){t:{if(this.g){var p,A=this.g;if((p=A.g?A.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!v(p)){var b=p;break t}}b=null}if(o=b)Mn(this.i,this.l,o,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Eo(this,o);else{this.o=!1,this.m=3,Ne(12),un(this),Pr(this);break e}}if(this.R){o=!0;let me;for(;!this.K&&this.C<f.length;)if(me=zp(this,f),me==_o){$==4&&(this.m=4,Ne(14),o=!1),Mn(this.i,this.l,null,"[Incomplete Response]");break}else if(me==Hc){this.m=4,Ne(15),Mn(this.i,this.l,f,"[Invalid Chunk]"),o=!1;break}else Mn(this.i,this.l,me,null),Eo(this,me);if(Gc(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),$!=4||f.length!=0||this.h.h||(this.m=1,Ne(16),o=!1),this.o=this.o&&o,!o)Mn(this.i,this.l,f,"[Invalid Chunked Response]"),un(this),Pr(this);else if(f.length>0&&!this.W){this.W=!0;var D=this.j;D.g==this&&D.aa&&!D.P&&(D.j.info("Great, no buffering proxy detected. Bytes received: "+f.length),Po(D),D.P=!0,Ne(11))}}else Mn(this.i,this.l,f,null),Eo(this,f);$==4&&un(this),this.o&&!this.K&&($==4?vu(this.j,this):(this.o=!1,Os(this)))}else sm(this.g),c==400&&f.indexOf("Unknown SID")>0?(this.m=3,Ne(12)):(this.m=0,Ne(13)),un(this),Pr(this)}}}catch{}finally{}};function $p(o){if(!Gc(o))return o.g.la();const c=fu(o.g);if(c==="")return"";let f="";const p=c.length,A=Ft(o.g)==4;if(!o.h.i){if(typeof TextDecoder>"u")return un(o),Pr(o),"";o.h.i=new a.TextDecoder}for(let b=0;b<p;b++)o.h.h=!0,f+=o.h.i.decode(c[b],{stream:!(A&&b==p-1)});return c.length=0,o.h.g+=f,o.C=0,o.h.g}function Gc(o){return o.g?o.v=="GET"&&o.M!=2&&o.j.Aa:!1}function zp(o,c){var f=o.C,p=c.indexOf(`
`,f);return p==-1?_o:(f=Number(c.substring(f,p)),isNaN(f)?Hc:(p+=1,p+f>c.length?_o:(c=c.slice(p,p+f),o.C=p+f,c)))}Mt.prototype.cancel=function(){this.K=!0,un(this)};function Os(o){o.T=Date.now()+o.H,Kc(o,o.H)}function Kc(o,c){if(o.D!=null)throw Error("WatchDog timer not null");o.D=Rr(h(o.aa,o),c)}function vo(o){o.D&&(a.clearTimeout(o.D),o.D=null)}Mt.prototype.aa=function(){this.D=null;const o=Date.now();o-this.T>=0?(Bp(this.i,this.B),this.M!=2&&(Ar(),Ne(17)),un(this),this.m=2,Pr(this)):Kc(this,this.T-o)};function Pr(o){o.j.I==0||o.K||vu(o.j,o)}function un(o){vo(o);var c=o.O;c&&typeof c.dispose=="function"&&c.dispose(),o.O=null,Mc(o.V),o.g&&(c=o.g,o.g=null,c.abort(),c.dispose())}function Eo(o,c){try{var f=o.j;if(f.I!=0&&(f.g==o||To(f.h,o))){if(!o.L&&To(f.h,o)&&f.I==3){try{var p=f.Ba.g.parse(c)}catch{p=null}if(Array.isArray(p)&&p.length==3){var A=p;if(A[0]==0){e:if(!f.v){if(f.g)if(f.g.F+3e3<o.F)Bs(f),Fs(f);else break e;So(f),Ne(18)}}else f.xa=A[1],0<f.xa-f.K&&A[2]<37500&&f.F&&f.A==0&&!f.C&&(f.C=Rr(h(f.Va,f),6e3));Yc(f.h)<=1&&f.ta&&(f.ta=void 0)}else hn(f,11)}else if((o.L||f.g==o)&&Bs(f),!v(c))for(A=f.Ba.g.parse(c),c=0;c<A.length;c++){let Z=A[c];const me=Z[0];if(!(me<=f.K))if(f.K=me,Z=Z[1],f.I==2)if(Z[0]=="c"){f.M=Z[1],f.ba=Z[2];const st=Z[3];st!=null&&(f.ka=st,f.j.info("VER="+f.ka));const fn=Z[4];fn!=null&&(f.za=fn,f.j.info("SVER="+f.za));const Ut=Z[5];Ut!=null&&typeof Ut=="number"&&Ut>0&&(p=1.5*Ut,f.O=p,f.j.info("backChannelRequestTimeoutMs_="+p)),p=f;const Bt=o.g;if(Bt){const qs=Bt.g?Bt.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(qs){var b=p.h;b.g||qs.indexOf("spdy")==-1&&qs.indexOf("quic")==-1&&qs.indexOf("h2")==-1||(b.j=b.l,b.g=new Set,b.h&&(Io(b,b.h),b.h=null))}if(p.G){const Co=Bt.g?Bt.g.getResponseHeader("X-HTTP-Session-Id"):null;Co&&(p.wa=Co,ee(p.J,p.G,Co))}}f.I=3,f.l&&f.l.ra(),f.aa&&(f.T=Date.now()-o.F,f.j.info("Handshake RTT: "+f.T+"ms")),p=f;var D=o;if(p.na=Iu(p,p.L?p.ba:null,p.W),D.L){Jc(p.h,D);var $=D,fe=p.O;fe&&($.H=fe),$.D&&(vo($),Os($)),p.g=D}else _u(p);f.i.length>0&&Us(f)}else Z[0]!="stop"&&Z[0]!="close"||hn(f,7);else f.I==3&&(Z[0]=="stop"||Z[0]=="close"?Z[0]=="stop"?hn(f,7):bo(f):Z[0]!="noop"&&f.l&&f.l.qa(Z),f.A=0)}}Ar(4)}catch{}}var Hp=class{constructor(o,c){this.g=o,this.map=c}};function Qc(o){this.l=o||10,a.PerformanceNavigationTiming?(o=a.performance.getEntriesByType("navigation"),o=o.length>0&&(o[0].nextHopProtocol=="hq"||o[0].nextHopProtocol=="h2")):o=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=o?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Xc(o){return o.h?!0:o.g?o.g.size>=o.j:!1}function Yc(o){return o.h?1:o.g?o.g.size:0}function To(o,c){return o.h?o.h==c:o.g?o.g.has(c):!1}function Io(o,c){o.g?o.g.add(c):o.h=c}function Jc(o,c){o.h&&o.h==c?o.h=null:o.g&&o.g.has(c)&&o.g.delete(c)}Qc.prototype.cancel=function(){if(this.i=Zc(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const o of this.g.values())o.cancel();this.g.clear()}};function Zc(o){if(o.h!=null)return o.i.concat(o.h.G);if(o.g!=null&&o.g.size!==0){let c=o.i;for(const f of o.g.values())c=c.concat(f.G);return c}return w(o.i)}var eu=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Wp(o,c){if(o){o=o.split("&");for(let f=0;f<o.length;f++){const p=o[f].indexOf("=");let A,b=null;p>=0?(A=o[f].substring(0,p),b=o[f].substring(p+1)):A=o[f],c(A,b?decodeURIComponent(b.replace(/\+/g," ")):"")}}}function Lt(o){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let c;o instanceof Lt?(this.l=o.l,Cr(this,o.j),this.o=o.o,this.g=o.g,kr(this,o.u),this.h=o.h,wo(this,ou(o.i)),this.m=o.m):o&&(c=String(o).match(eu))?(this.l=!1,Cr(this,c[1]||"",!0),this.o=Vr(c[2]||""),this.g=Vr(c[3]||"",!0),kr(this,c[4]),this.h=Vr(c[5]||"",!0),wo(this,c[6]||"",!0),this.m=Vr(c[7]||"")):(this.l=!1,this.i=new Nr(null,this.l))}Lt.prototype.toString=function(){const o=[];var c=this.j;c&&o.push(Dr(c,tu,!0),":");var f=this.g;return(f||c=="file")&&(o.push("//"),(c=this.o)&&o.push(Dr(c,tu,!0),"@"),o.push(Sr(f).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f=this.u,f!=null&&o.push(":",String(f))),(f=this.h)&&(this.g&&f.charAt(0)!="/"&&o.push("/"),o.push(Dr(f,f.charAt(0)=="/"?Qp:Kp,!0))),(f=this.i.toString())&&o.push("?",f),(f=this.m)&&o.push("#",Dr(f,Yp)),o.join("")},Lt.prototype.resolve=function(o){const c=rt(this);let f=!!o.j;f?Cr(c,o.j):f=!!o.o,f?c.o=o.o:f=!!o.g,f?c.g=o.g:f=o.u!=null;var p=o.h;if(f)kr(c,o.u);else if(f=!!o.h){if(p.charAt(0)!="/")if(this.g&&!this.h)p="/"+p;else{var A=c.h.lastIndexOf("/");A!=-1&&(p=c.h.slice(0,A+1)+p)}if(A=p,A==".."||A==".")p="";else if(A.indexOf("./")!=-1||A.indexOf("/.")!=-1){p=A.lastIndexOf("/",0)==0,A=A.split("/");const b=[];for(let D=0;D<A.length;){const $=A[D++];$=="."?p&&D==A.length&&b.push(""):$==".."?((b.length>1||b.length==1&&b[0]!="")&&b.pop(),p&&D==A.length&&b.push("")):(b.push($),p=!0)}p=b.join("/")}else p=A}return f?c.h=p:f=o.i.toString()!=="",f?wo(c,ou(o.i)):f=!!o.m,f&&(c.m=o.m),c};function rt(o){return new Lt(o)}function Cr(o,c,f){o.j=f?Vr(c,!0):c,o.j&&(o.j=o.j.replace(/:$/,""))}function kr(o,c){if(c){if(c=Number(c),isNaN(c)||c<0)throw Error("Bad port number "+c);o.u=c}else o.u=null}function wo(o,c,f){c instanceof Nr?(o.i=c,Jp(o.i,o.l)):(f||(c=Dr(c,Xp)),o.i=new Nr(c,o.l))}function ee(o,c,f){o.i.set(c,f)}function Ms(o){return ee(o,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),o}function Vr(o,c){return o?c?decodeURI(o.replace(/%25/g,"%2525")):decodeURIComponent(o):""}function Dr(o,c,f){return typeof o=="string"?(o=encodeURI(o).replace(c,Gp),f&&(o=o.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),o):null}function Gp(o){return o=o.charCodeAt(0),"%"+(o>>4&15).toString(16)+(o&15).toString(16)}var tu=/[#\/\?@]/g,Kp=/[#\?:]/g,Qp=/[#\?]/g,Xp=/[#\?@]/g,Yp=/#/g;function Nr(o,c){this.h=this.g=null,this.i=o||null,this.j=!!c}function ln(o){o.g||(o.g=new Map,o.h=0,o.i&&Wp(o.i,function(c,f){o.add(decodeURIComponent(c.replace(/\+/g," ")),f)}))}n=Nr.prototype,n.add=function(o,c){ln(this),this.i=null,o=Ln(this,o);let f=this.g.get(o);return f||this.g.set(o,f=[]),f.push(c),this.h+=1,this};function nu(o,c){ln(o),c=Ln(o,c),o.g.has(c)&&(o.i=null,o.h-=o.g.get(c).length,o.g.delete(c))}function ru(o,c){return ln(o),c=Ln(o,c),o.g.has(c)}n.forEach=function(o,c){ln(this),this.g.forEach(function(f,p){f.forEach(function(A){o.call(c,A,p,this)},this)},this)};function su(o,c){ln(o);let f=[];if(typeof c=="string")ru(o,c)&&(f=f.concat(o.g.get(Ln(o,c))));else for(o=Array.from(o.g.values()),c=0;c<o.length;c++)f=f.concat(o[c]);return f}n.set=function(o,c){return ln(this),this.i=null,o=Ln(this,o),ru(this,o)&&(this.h-=this.g.get(o).length),this.g.set(o,[c]),this.h+=1,this},n.get=function(o,c){return o?(o=su(this,o),o.length>0?String(o[0]):c):c};function iu(o,c,f){nu(o,c),f.length>0&&(o.i=null,o.g.set(Ln(o,c),w(f)),o.h+=f.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const o=[],c=Array.from(this.g.keys());for(let p=0;p<c.length;p++){var f=c[p];const A=Sr(f);f=su(this,f);for(let b=0;b<f.length;b++){let D=A;f[b]!==""&&(D+="="+Sr(f[b])),o.push(D)}}return this.i=o.join("&")};function ou(o){const c=new Nr;return c.i=o.i,o.g&&(c.g=new Map(o.g),c.h=o.h),c}function Ln(o,c){return c=String(c),o.j&&(c=c.toLowerCase()),c}function Jp(o,c){c&&!o.j&&(ln(o),o.i=null,o.g.forEach(function(f,p){const A=p.toLowerCase();p!=A&&(nu(this,p),iu(this,A,f))},o)),o.j=c}function Zp(o,c){const f=new br;if(a.Image){const p=new Image;p.onload=d(xt,f,"TestLoadImage: loaded",!0,c,p),p.onerror=d(xt,f,"TestLoadImage: error",!1,c,p),p.onabort=d(xt,f,"TestLoadImage: abort",!1,c,p),p.ontimeout=d(xt,f,"TestLoadImage: timeout",!1,c,p),a.setTimeout(function(){p.ontimeout&&p.ontimeout()},1e4),p.src=o}else c(!1)}function em(o,c){const f=new br,p=new AbortController,A=setTimeout(()=>{p.abort(),xt(f,"TestPingServer: timeout",!1,c)},1e4);fetch(o,{signal:p.signal}).then(b=>{clearTimeout(A),b.ok?xt(f,"TestPingServer: ok",!0,c):xt(f,"TestPingServer: server error",!1,c)}).catch(()=>{clearTimeout(A),xt(f,"TestPingServer: error",!1,c)})}function xt(o,c,f,p,A){try{A&&(A.onload=null,A.onerror=null,A.onabort=null,A.ontimeout=null),p(f)}catch{}}function tm(){this.g=new xp}function Ao(o){this.i=o.Sb||null,this.h=o.ab||!1}m(Ao,Lc),Ao.prototype.g=function(){return new Ls(this.i,this.h)};function Ls(o,c){Ie.call(this),this.H=o,this.o=c,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}m(Ls,Ie),n=Ls.prototype,n.open=function(o,c){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=o,this.D=c,this.readyState=1,Mr(this)},n.send=function(o){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const c={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};o&&(c.body=o),(this.H||a).fetch(new Request(this.D,c)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Or(this)),this.readyState=0},n.Pa=function(o){if(this.g&&(this.l=o,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=o.headers,this.readyState=2,Mr(this)),this.g&&(this.readyState=3,Mr(this),this.g)))if(this.responseType==="arraybuffer")o.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in o){if(this.j=o.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;au(this)}else o.text().then(this.Oa.bind(this),this.ga.bind(this))};function au(o){o.j.read().then(o.Ma.bind(o)).catch(o.ga.bind(o))}n.Ma=function(o){if(this.g){if(this.o&&o.value)this.response.push(o.value);else if(!this.o){var c=o.value?o.value:new Uint8Array(0);(c=this.B.decode(c,{stream:!o.done}))&&(this.response=this.responseText+=c)}o.done?Or(this):Mr(this),this.readyState==3&&au(this)}},n.Oa=function(o){this.g&&(this.response=this.responseText=o,Or(this))},n.Na=function(o){this.g&&(this.response=o,Or(this))},n.ga=function(){this.g&&Or(this)};function Or(o){o.readyState=4,o.l=null,o.j=null,o.B=null,Mr(o)}n.setRequestHeader=function(o,c){this.A.append(o,c)},n.getResponseHeader=function(o){return this.h&&this.h.get(o.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const o=[],c=this.h.entries();for(var f=c.next();!f.done;)f=f.value,o.push(f[0]+": "+f[1]),f=c.next();return o.join(`\r
`)};function Mr(o){o.onreadystatechange&&o.onreadystatechange.call(o)}Object.defineProperty(Ls.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(o){this.m=o?"include":"same-origin"}});function cu(o){let c="";return Cs(o,function(f,p){c+=p,c+=":",c+=f,c+=`\r
`}),c}function Ro(o,c,f){e:{for(p in f){var p=!1;break e}p=!0}p||(f=cu(f),typeof o=="string"?f!=null&&Sr(f):ee(o,c,f))}function ae(o){Ie.call(this),this.headers=new Map,this.L=o||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}m(ae,Ie);var nm=/^https?$/i,rm=["POST","PUT"];n=ae.prototype,n.Fa=function(o){this.H=o},n.ea=function(o,c,f,p){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+o);c=c?c.toUpperCase():"GET",this.D=o,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():$c.g(),this.g.onreadystatechange=g(h(this.Ca,this));try{this.B=!0,this.g.open(c,String(o),!0),this.B=!1}catch(b){uu(this,b);return}if(o=f||"",f=new Map(this.headers),p)if(Object.getPrototypeOf(p)===Object.prototype)for(var A in p)f.set(A,p[A]);else if(typeof p.keys=="function"&&typeof p.get=="function")for(const b of p.keys())f.set(b,p.get(b));else throw Error("Unknown input type for opt_headers: "+String(p));p=Array.from(f.keys()).find(b=>b.toLowerCase()=="content-type"),A=a.FormData&&o instanceof a.FormData,!(Array.prototype.indexOf.call(rm,c,void 0)>=0)||p||A||f.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[b,D]of f)this.g.setRequestHeader(b,D);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(o),this.v=!1}catch(b){uu(this,b)}};function uu(o,c){o.h=!1,o.g&&(o.j=!0,o.g.abort(),o.j=!1),o.l=c,o.o=5,lu(o),xs(o)}function lu(o){o.A||(o.A=!0,De(o,"complete"),De(o,"error"))}n.abort=function(o){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=o||7,De(this,"complete"),De(this,"abort"),xs(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),xs(this,!0)),ae.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?hu(this):this.Xa())},n.Xa=function(){hu(this)};function hu(o){if(o.h&&typeof i<"u"){if(o.v&&Ft(o)==4)setTimeout(o.Ca.bind(o),0);else if(De(o,"readystatechange"),Ft(o)==4){o.h=!1;try{const b=o.ca();e:switch(b){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var c=!0;break e;default:c=!1}var f;if(!(f=c)){var p;if(p=b===0){let D=String(o.D).match(eu)[1]||null;!D&&a.self&&a.self.location&&(D=a.self.location.protocol.slice(0,-1)),p=!nm.test(D?D.toLowerCase():"")}f=p}if(f)De(o,"complete"),De(o,"success");else{o.o=6;try{var A=Ft(o)>2?o.g.statusText:""}catch{A=""}o.l=A+" ["+o.ca()+"]",lu(o)}}finally{xs(o)}}}}function xs(o,c){if(o.g){o.m&&(clearTimeout(o.m),o.m=null);const f=o.g;o.g=null,c||De(o,"ready");try{f.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function Ft(o){return o.g?o.g.readyState:0}n.ca=function(){try{return Ft(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(o){if(this.g){var c=this.g.responseText;return o&&c.indexOf(o)==0&&(c=c.substring(o.length)),Lp(c)}};function fu(o){try{if(!o.g)return null;if("response"in o.g)return o.g.response;switch(o.F){case"":case"text":return o.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in o.g)return o.g.mozResponseArrayBuffer}return null}catch{return null}}function sm(o){const c={};o=(o.g&&Ft(o)>=2&&o.g.getAllResponseHeaders()||"").split(`\r
`);for(let p=0;p<o.length;p++){if(v(o[p]))continue;var f=qp(o[p]);const A=f[0];if(f=f[1],typeof f!="string")continue;f=f.trim();const b=c[A]||[];c[A]=b,b.push(f)}kp(c,function(p){return p.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Lr(o,c,f){return f&&f.internalChannelParams&&f.internalChannelParams[o]||c}function du(o){this.za=0,this.i=[],this.j=new br,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Lr("failFast",!1,o),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Lr("baseRetryDelayMs",5e3,o),this.Za=Lr("retryDelaySeedMs",1e4,o),this.Ta=Lr("forwardChannelMaxRetries",2,o),this.va=Lr("forwardChannelRequestTimeoutMs",2e4,o),this.ma=o&&o.xmlHttpFactory||void 0,this.Ua=o&&o.Rb||void 0,this.Aa=o&&o.useFetchStreams||!1,this.O=void 0,this.L=o&&o.supportsCrossDomainXhr||!1,this.M="",this.h=new Qc(o&&o.concurrentRequestLimit),this.Ba=new tm,this.S=o&&o.fastHandshake||!1,this.R=o&&o.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=o&&o.Pb||!1,o&&o.ua&&this.j.ua(),o&&o.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&o&&o.detectBufferingProxy||!1,this.ia=void 0,o&&o.longPollingTimeout&&o.longPollingTimeout>0&&(this.ia=o.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=du.prototype,n.ka=8,n.I=1,n.connect=function(o,c,f,p){Ne(0),this.W=o,this.H=c||{},f&&p!==void 0&&(this.H.OSID=f,this.H.OAID=p),this.F=this.X,this.J=Iu(this,null,this.W),Us(this)};function bo(o){if(pu(o),o.I==3){var c=o.V++,f=rt(o.J);if(ee(f,"SID",o.M),ee(f,"RID",c),ee(f,"TYPE","terminate"),xr(o,f),c=new Mt(o,o.j,c),c.M=2,c.A=Ms(rt(f)),f=!1,a.navigator&&a.navigator.sendBeacon)try{f=a.navigator.sendBeacon(c.A.toString(),"")}catch{}!f&&a.Image&&(new Image().src=c.A,f=!0),f||(c.g=wu(c.j,null),c.g.ea(c.A)),c.F=Date.now(),Os(c)}Tu(o)}function Fs(o){o.g&&(Po(o),o.g.cancel(),o.g=null)}function pu(o){Fs(o),o.v&&(a.clearTimeout(o.v),o.v=null),Bs(o),o.h.cancel(),o.m&&(typeof o.m=="number"&&a.clearTimeout(o.m),o.m=null)}function Us(o){if(!Xc(o.h)&&!o.m){o.m=!0;var c=o.Ea;se||_(),ie||(se(),ie=!0),T.add(c,o),o.D=0}}function im(o,c){return Yc(o.h)>=o.h.j-(o.m?1:0)?!1:o.m?(o.i=c.G.concat(o.i),!0):o.I==1||o.I==2||o.D>=(o.Sa?0:o.Ta)?!1:(o.m=Rr(h(o.Ea,o,c),Eu(o,o.D)),o.D++,!0)}n.Ea=function(o){if(this.m)if(this.m=null,this.I==1){if(!o){this.V=Math.floor(Math.random()*1e5),o=this.V++;const A=new Mt(this,this.j,o);let b=this.o;if(this.U&&(b?(b=bc(b),Pc(b,this.U)):b=this.U),this.u!==null||this.R||(A.J=b,b=null),this.S)e:{for(var c=0,f=0;f<this.i.length;f++){t:{var p=this.i[f];if("__data__"in p.map&&(p=p.map.__data__,typeof p=="string")){p=p.length;break t}p=void 0}if(p===void 0)break;if(c+=p,c>4096){c=f;break e}if(c===4096||f===this.i.length-1){c=f+1;break e}}c=1e3}else c=1e3;c=gu(this,A,c),f=rt(this.J),ee(f,"RID",o),ee(f,"CVER",22),this.G&&ee(f,"X-HTTP-Session-Id",this.G),xr(this,f),b&&(this.R?c="headers="+Sr(cu(b))+"&"+c:this.u&&Ro(f,this.u,b)),Io(this.h,A),this.Ra&&ee(f,"TYPE","init"),this.S?(ee(f,"$req",c),ee(f,"SID","null"),A.U=!0,yo(A,f,null)):yo(A,f,c),this.I=2}}else this.I==3&&(o?mu(this,o):this.i.length==0||Xc(this.h)||mu(this))};function mu(o,c){var f;c?f=c.l:f=o.V++;const p=rt(o.J);ee(p,"SID",o.M),ee(p,"RID",f),ee(p,"AID",o.K),xr(o,p),o.u&&o.o&&Ro(p,o.u,o.o),f=new Mt(o,o.j,f,o.D+1),o.u===null&&(f.J=o.o),c&&(o.i=c.G.concat(o.i)),c=gu(o,f,1e3),f.H=Math.round(o.va*.5)+Math.round(o.va*.5*Math.random()),Io(o.h,f),yo(f,p,c)}function xr(o,c){o.H&&Cs(o.H,function(f,p){ee(c,p,f)}),o.l&&Cs({},function(f,p){ee(c,p,f)})}function gu(o,c,f){f=Math.min(o.i.length,f);const p=o.l?h(o.l.Ka,o.l,o):null;e:{var A=o.i;let $=-1;for(;;){const fe=["count="+f];$==-1?f>0?($=A[0].g,fe.push("ofs="+$)):$=0:fe.push("ofs="+$);let Z=!0;for(let me=0;me<f;me++){var b=A[me].g;const st=A[me].map;if(b-=$,b<0)$=Math.max(0,A[me].g-100),Z=!1;else try{b="req"+b+"_"||"";try{var D=st instanceof Map?st:Object.entries(st);for(const[fn,Ut]of D){let Bt=Ut;u(Ut)&&(Bt=fo(Ut)),fe.push(b+fn+"="+encodeURIComponent(Bt))}}catch(fn){throw fe.push(b+"type="+encodeURIComponent("_badmap")),fn}}catch{p&&p(st)}}if(Z){D=fe.join("&");break e}}D=void 0}return o=o.i.splice(0,f),c.G=o,D}function _u(o){if(!o.g&&!o.v){o.Y=1;var c=o.Da;se||_(),ie||(se(),ie=!0),T.add(c,o),o.A=0}}function So(o){return o.g||o.v||o.A>=3?!1:(o.Y++,o.v=Rr(h(o.Da,o),Eu(o,o.A)),o.A++,!0)}n.Da=function(){if(this.v=null,yu(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var o=4*this.T;this.j.info("BP detection timer enabled: "+o),this.B=Rr(h(this.Wa,this),o)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Ne(10),Fs(this),yu(this))};function Po(o){o.B!=null&&(a.clearTimeout(o.B),o.B=null)}function yu(o){o.g=new Mt(o,o.j,"rpc",o.Y),o.u===null&&(o.g.J=o.o),o.g.P=0;var c=rt(o.na);ee(c,"RID","rpc"),ee(c,"SID",o.M),ee(c,"AID",o.K),ee(c,"CI",o.F?"0":"1"),!o.F&&o.ia&&ee(c,"TO",o.ia),ee(c,"TYPE","xmlhttp"),xr(o,c),o.u&&o.o&&Ro(c,o.u,o.o),o.O&&(o.g.H=o.O);var f=o.g;o=o.ba,f.M=1,f.A=Ms(rt(c)),f.u=null,f.R=!0,Wc(f,o)}n.Va=function(){this.C!=null&&(this.C=null,Fs(this),So(this),Ne(19))};function Bs(o){o.C!=null&&(a.clearTimeout(o.C),o.C=null)}function vu(o,c){var f=null;if(o.g==c){Bs(o),Po(o),o.g=null;var p=2}else if(To(o.h,c))f=c.G,Jc(o.h,c),p=1;else return;if(o.I!=0){if(c.o)if(p==1){f=c.u?c.u.length:0,c=Date.now()-c.F;var A=o.D;p=Ds(),De(p,new jc(p,f)),Us(o)}else _u(o);else if(A=c.m,A==3||A==0&&c.X>0||!(p==1&&im(o,c)||p==2&&So(o)))switch(f&&f.length>0&&(c=o.h,c.i=c.i.concat(f)),A){case 1:hn(o,5);break;case 4:hn(o,10);break;case 3:hn(o,6);break;default:hn(o,2)}}}function Eu(o,c){let f=o.Qa+Math.floor(Math.random()*o.Za);return o.isActive()||(f*=2),f*c}function hn(o,c){if(o.j.info("Error code "+c),c==2){var f=h(o.bb,o),p=o.Ua;const A=!p;p=new Lt(p||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Cr(p,"https"),Ms(p),A?Zp(p.toString(),f):em(p.toString(),f)}else Ne(2);o.I=0,o.l&&o.l.pa(c),Tu(o),pu(o)}n.bb=function(o){o?(this.j.info("Successfully pinged google.com"),Ne(2)):(this.j.info("Failed to ping google.com"),Ne(1))};function Tu(o){if(o.I=0,o.ja=[],o.l){const c=Zc(o.h);(c.length!=0||o.i.length!=0)&&(S(o.ja,c),S(o.ja,o.i),o.h.i.length=0,w(o.i),o.i.length=0),o.l.oa()}}function Iu(o,c,f){var p=f instanceof Lt?rt(f):new Lt(f);if(p.g!="")c&&(p.g=c+"."+p.g),kr(p,p.u);else{var A=a.location;p=A.protocol,c=c?c+"."+A.hostname:A.hostname,A=+A.port;const b=new Lt(null);p&&Cr(b,p),c&&(b.g=c),A&&kr(b,A),f&&(b.h=f),p=b}return f=o.G,c=o.wa,f&&c&&ee(p,f,c),ee(p,"VER",o.ka),xr(o,p),p}function wu(o,c,f){if(c&&!o.L)throw Error("Can't create secondary domain capable XhrIo object.");return c=o.Aa&&!o.ma?new ae(new Ao({ab:f})):new ae(o.ma),c.Fa(o.L),c}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Au(){}n=Au.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function js(){}js.prototype.g=function(o,c){return new Be(o,c)};function Be(o,c){Ie.call(this),this.g=new du(c),this.l=o,this.h=c&&c.messageUrlParams||null,o=c&&c.messageHeaders||null,c&&c.clientProtocolHeaderRequired&&(o?o["X-Client-Protocol"]="webchannel":o={"X-Client-Protocol":"webchannel"}),this.g.o=o,o=c&&c.initMessageHeaders||null,c&&c.messageContentType&&(o?o["X-WebChannel-Content-Type"]=c.messageContentType:o={"X-WebChannel-Content-Type":c.messageContentType}),c&&c.sa&&(o?o["X-WebChannel-Client-Profile"]=c.sa:o={"X-WebChannel-Client-Profile":c.sa}),this.g.U=o,(o=c&&c.Qb)&&!v(o)&&(this.g.u=o),this.A=c&&c.supportsCrossDomainXhr||!1,this.v=c&&c.sendRawJson||!1,(c=c&&c.httpSessionIdParam)&&!v(c)&&(this.g.G=c,o=this.h,o!==null&&c in o&&(o=this.h,c in o&&delete o[c])),this.j=new xn(this)}m(Be,Ie),Be.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Be.prototype.close=function(){bo(this.g)},Be.prototype.o=function(o){var c=this.g;if(typeof o=="string"){var f={};f.__data__=o,o=f}else this.v&&(f={},f.__data__=fo(o),o=f);c.i.push(new Hp(c.Ya++,o)),c.I==3&&Us(c)},Be.prototype.N=function(){this.g.l=null,delete this.j,bo(this.g),delete this.g,Be.Z.N.call(this)};function Ru(o){po.call(this),o.__headers__&&(this.headers=o.__headers__,this.statusCode=o.__status__,delete o.__headers__,delete o.__status__);var c=o.__sm__;if(c){e:{for(const f in c){o=f;break e}o=void 0}(this.i=o)&&(o=this.i,c=c!==null&&o in c?c[o]:void 0),this.data=c}else this.data=o}m(Ru,po);function bu(){mo.call(this),this.status=1}m(bu,mo);function xn(o){this.g=o}m(xn,Au),xn.prototype.ra=function(){De(this.g,"a")},xn.prototype.qa=function(o){De(this.g,new Ru(o))},xn.prototype.pa=function(o){De(this.g,new bu)},xn.prototype.oa=function(){De(this.g,"b")},js.prototype.createWebChannel=js.prototype.g,Be.prototype.send=Be.prototype.o,Be.prototype.open=Be.prototype.m,Be.prototype.close=Be.prototype.close,wf=function(){return new js},If=function(){return Ds()},Tf=cn,sa={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Ns.NO_ERROR=0,Ns.TIMEOUT=8,Ns.HTTP_ERROR=6,Zs=Ns,qc.COMPLETE="complete",Ef=qc,xc.EventType=wr,wr.OPEN="a",wr.CLOSE="b",wr.ERROR="c",wr.MESSAGE="d",Ie.prototype.listen=Ie.prototype.J,Ur=xc,ae.prototype.listenOnce=ae.prototype.K,ae.prototype.getLastError=ae.prototype.Ha,ae.prototype.getLastErrorCode=ae.prototype.ya,ae.prototype.getStatus=ae.prototype.ca,ae.prototype.getResponseJson=ae.prototype.La,ae.prototype.getResponseText=ae.prototype.la,ae.prototype.send=ae.prototype.ea,ae.prototype.setWithCredentials=ae.prototype.Fa,vf=ae}).apply(typeof Hs<"u"?Hs:typeof self<"u"?self:typeof window<"u"?window:{});const Zu="@firebase/firestore",el="4.9.2";class Re{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Re.UNAUTHENTICATED=new Re(null),Re.GOOGLE_CREDENTIALS=new Re("google-credentials-uid"),Re.FIRST_PARTY=new Re("first-party-uid"),Re.MOCK_USER=new Re("mock-user");let _r="12.3.0";const bn=new xa("@firebase/firestore");function Bn(){return bn.logLevel}function N(n,...e){if(bn.logLevel<=z.DEBUG){const t=e.map(Ba);bn.debug(`Firestore (${_r}): ${n}`,...t)}}function St(n,...e){if(bn.logLevel<=z.ERROR){const t=e.map(Ba);bn.error(`Firestore (${_r}): ${n}`,...t)}}function or(n,...e){if(bn.logLevel<=z.WARN){const t=e.map(Ba);bn.warn(`Firestore (${_r}): ${n}`,...t)}}function Ba(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function U(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,Af(n,r,t)}function Af(n,e,t){let r=`FIRESTORE (${_r}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw St(r),new Error(r)}function Y(n,e,t,r){let s="Unexpected state";typeof t=="string"?s=t:r=t,n||Af(e,s,r)}function q(n,e){return n}const k={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class x extends Ot{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class vn{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class Rf{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Ey{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Re.UNAUTHENTICATED)))}shutdown(){}}class Ty{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class Iy{constructor(e){this.t=e,this.currentUser=Re.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Y(this.o===void 0,42304);let r=this.i;const s=l=>this.i!==r?(r=this.i,t(l)):Promise.resolve();let i=new vn;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new vn,e.enqueueRetryable((()=>s(this.currentUser)))};const a=()=>{const l=i;e.enqueueRetryable((async()=>{await l.promise,await s(this.currentUser)}))},u=l=>{N("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit((l=>u(l))),setTimeout((()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?u(l):(N("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new vn)}}),0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((r=>this.i!==e?(N("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Y(typeof r.accessToken=="string",31837,{l:r}),new Rf(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Y(e===null||typeof e=="string",2055,{h:e}),new Re(e)}}class wy{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=Re.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class Ay{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new wy(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(Re.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class tl{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Ry{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Ye(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Y(this.o===void 0,3512);const r=i=>{i.error!=null&&N("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const a=i.token!==this.m;return this.m=i.token,N("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable((()=>r(i)))};const s=i=>{N("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((i=>s(i))),setTimeout((()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):N("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new tl(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Y(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new tl(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function by(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}class ja{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=by(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<t&&(r+=e.charAt(s[i]%62))}return r}}function H(n,e){return n<e?-1:n>e?1:0}function ia(n,e){const t=Math.min(n.length,e.length);for(let r=0;r<t;r++){const s=n.charAt(r),i=e.charAt(r);if(s!==i)return Uo(s)===Uo(i)?H(s,i):Uo(s)?1:-1}return H(n.length,e.length)}const Sy=55296,Py=57343;function Uo(n){const e=n.charCodeAt(0);return e>=Sy&&e<=Py}function ar(n,e,t){return n.length===e.length&&n.every(((r,s)=>t(r,e[s])))}const nl="__name__";class ot{constructor(e,t,r){t===void 0?t=0:t>e.length&&U(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&U(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return ot.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof ot?e.forEach((r=>{t.push(r)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let s=0;s<r;s++){const i=ot.compareSegments(e.get(s),t.get(s));if(i!==0)return i}return H(e.length,t.length)}static compareSegments(e,t){const r=ot.isNumericId(e),s=ot.isNumericId(t);return r&&!s?-1:!r&&s?1:r&&s?ot.extractNumericId(e).compare(ot.extractNumericId(t)):ia(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Zt.fromString(e.substring(4,e.length-2))}}class ne extends ot{construct(e,t,r){return new ne(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new x(k.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter((s=>s.length>0)))}return new ne(t)}static emptyPath(){return new ne([])}}const Cy=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ve extends ot{construct(e,t,r){return new ve(e,t,r)}static isValidIdentifier(e){return Cy.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ve.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===nl}static keyField(){return new ve([nl])}static fromServerFormat(e){const t=[];let r="",s=0;const i=()=>{if(r.length===0)throw new x(k.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let a=!1;for(;s<e.length;){const u=e[s];if(u==="\\"){if(s+1===e.length)throw new x(k.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new x(k.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,s+=2}else u==="`"?(a=!a,s++):u!=="."||a?(r+=u,s++):(i(),s++)}if(i(),a)throw new x(k.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ve(t)}static emptyPath(){return new ve([])}}class F{constructor(e){this.path=e}static fromPath(e){return new F(ne.fromString(e))}static fromName(e){return new F(ne.fromString(e).popFirst(5))}static empty(){return new F(ne.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ne.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return ne.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new F(new ne(e.slice()))}}function bf(n,e,t){if(!t)throw new x(k.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function ky(n,e,t,r){if(e===!0&&r===!0)throw new x(k.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function rl(n){if(!F.isDocumentKey(n))throw new x(k.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function sl(n){if(F.isDocumentKey(n))throw new x(k.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Sf(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function qa(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":U(12329,{type:typeof n})}function Gr(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new x(k.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=qa(n);throw new x(k.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function he(n,e){const t={typeString:n};return e&&(t.value=e),t}function Es(n,e){if(!Sf(n))throw new x(k.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const s=e[r].typeString,i="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}const a=n[r];if(s&&typeof a!==s){t=`JSON field '${r}' must be a ${s}.`;break}if(i!==void 0&&a!==i.value){t=`Expected '${r}' field to equal '${i.value}'`;break}}if(t)throw new x(k.INVALID_ARGUMENT,t);return!0}const il=-62135596800,ol=1e6;class re{static now(){return re.fromMillis(Date.now())}static fromDate(e){return re.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*ol);return new re(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new x(k.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new x(k.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<il)throw new x(k.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new x(k.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/ol}_compareTo(e){return this.seconds===e.seconds?H(this.nanoseconds,e.nanoseconds):H(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:re._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Es(e,re._jsonSchema))return new re(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-il;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}re._jsonSchemaVersion="firestore/timestamp/1.0",re._jsonSchema={type:he("string",re._jsonSchemaVersion),seconds:he("number"),nanoseconds:he("number")};class j{static fromTimestamp(e){return new j(e)}static min(){return new j(new re(0,0))}static max(){return new j(new re(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const is=-1;function Vy(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,s=j.fromTimestamp(r===1e9?new re(t+1,0):new re(t,r));return new tn(s,F.empty(),e)}function Dy(n){return new tn(n.readTime,n.key,is)}class tn{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new tn(j.min(),F.empty(),is)}static max(){return new tn(j.max(),F.empty(),is)}}function Ny(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=F.comparator(n.documentKey,e.documentKey),t!==0?t:H(n.largestBatchId,e.largestBatchId))}const Oy="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class My{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function yr(n){if(n.code!==k.FAILED_PRECONDITION||n.message!==Oy)throw n;N("LocalStore","Unexpectedly lost primary lease")}class P{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&U(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new P(((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(t,i).next(r,s)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof P?t:P.resolve(t)}catch(t){return P.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):P.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):P.reject(t)}static resolve(e){return new P(((t,r)=>{t(e)}))}static reject(e){return new P(((t,r)=>{r(e)}))}static waitFor(e){return new P(((t,r)=>{let s=0,i=0,a=!1;e.forEach((u=>{++s,u.next((()=>{++i,a&&i===s&&t()}),(l=>r(l)))})),a=!0,i===s&&t()}))}static or(e){let t=P.resolve(!1);for(const r of e)t=t.next((s=>s?P.resolve(s):r()));return t}static forEach(e,t){const r=[];return e.forEach(((s,i)=>{r.push(t.call(this,s,i))})),this.waitFor(r)}static mapArray(e,t){return new P(((r,s)=>{const i=e.length,a=new Array(i);let u=0;for(let l=0;l<i;l++){const h=l;t(e[h]).next((d=>{a[h]=d,++u,u===i&&r(a)}),(d=>s(d)))}}))}static doWhile(e,t){return new P(((r,s)=>{const i=()=>{e()===!0?t().next((()=>{i()}),s):r()};i()}))}}function Ly(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function vr(n){return n.name==="IndexedDbTransactionError"}class qi{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>t.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}qi.ce=-1;const $a=-1;function $i(n){return n==null}function mi(n){return n===0&&1/n==-1/0}function xy(n){return typeof n=="number"&&Number.isInteger(n)&&!mi(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const Pf="";function Fy(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=al(e)),e=Uy(n.get(t),e);return al(e)}function Uy(n,e){let t=e;const r=n.length;for(let s=0;s<r;s++){const i=n.charAt(s);switch(i){case"\0":t+="";break;case Pf:t+="";break;default:t+=i}}return t}function al(n){return n+Pf+""}function cl(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Vn(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Cf(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class oe{constructor(e,t){this.comparator=e,this.root=t||ye.EMPTY}insert(e,t){return new oe(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,ye.BLACK,null,null))}remove(e){return new oe(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ye.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return t+r.left.size;s<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,r)=>(e(t,r),!1)))}toString(){const e=[];return this.inorderTraversal(((t,r)=>(e.push(`${t}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ws(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ws(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ws(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ws(this.root,e,this.comparator,!0)}}class Ws{constructor(e,t,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?r(e.key,t):1,t&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ye{constructor(e,t,r,s,i){this.key=e,this.value=t,this.color=r??ye.RED,this.left=s??ye.EMPTY,this.right=i??ye.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,s,i){return new ye(e??this.key,t??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,t,r),null):i===0?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return ye.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),t(e,s.key)===0){if(s.right.isEmpty())return ye.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ye.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ye.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw U(43730,{key:this.key,value:this.value});if(this.right.isRed())throw U(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw U(27949);return e+(this.isRed()?0:1)}}ye.EMPTY=null,ye.RED=!0,ye.BLACK=!1;ye.EMPTY=new class{constructor(){this.size=0}get key(){throw U(57766)}get value(){throw U(16141)}get color(){throw U(16727)}get left(){throw U(29726)}get right(){throw U(36894)}copy(e,t,r,s,i){return this}insert(e,t,r){return new ye(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class pe{constructor(e){this.comparator=e,this.data=new oe(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,r)=>(e(t),!1)))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new ul(this.data.getIterator())}getIteratorFrom(e){return new ul(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((r=>{t=t.add(r)})),t}isEqual(e){if(!(e instanceof pe)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new pe(this.comparator);return t.data=e,t}}class ul{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Je{constructor(e){this.fields=e,e.sort(ve.comparator)}static empty(){return new Je([])}unionWith(e){let t=new pe(ve.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Je(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return ar(this.fields,e.fields,((t,r)=>t.isEqual(r)))}}class kf extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Ee{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new kf("Invalid base64 string: "+i):i}})(e);return new Ee(t)}static fromUint8Array(e){const t=(function(s){let i="";for(let a=0;a<s.length;++a)i+=String.fromCharCode(s[a]);return i})(e);return new Ee(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const r=new Uint8Array(t.length);for(let s=0;s<t.length;s++)r[s]=t.charCodeAt(s);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return H(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ee.EMPTY_BYTE_STRING=new Ee("");const By=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function nn(n){if(Y(!!n,39018),typeof n=="string"){let e=0;const t=By.exec(n);if(Y(!!t,46558,{timestamp:n}),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ce(n.seconds),nanos:ce(n.nanos)}}function ce(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function rn(n){return typeof n=="string"?Ee.fromBase64String(n):Ee.fromUint8Array(n)}const Vf="server_timestamp",Df="__type__",Nf="__previous_value__",Of="__local_write_time__";function za(n){return(n?.mapValue?.fields||{})[Df]?.stringValue===Vf}function zi(n){const e=n.mapValue.fields[Nf];return za(e)?zi(e):e}function os(n){const e=nn(n.mapValue.fields[Of].timestampValue);return new re(e.seconds,e.nanos)}class jy{constructor(e,t,r,s,i,a,u,l,h,d){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=a,this.autoDetectLongPolling=u,this.longPollingOptions=l,this.useFetchStreams=h,this.isUsingEmulator=d}}const gi="(default)";class as{constructor(e,t){this.projectId=e,this.database=t||gi}static empty(){return new as("","")}get isDefaultDatabase(){return this.database===gi}isEqual(e){return e instanceof as&&e.projectId===this.projectId&&e.database===this.database}}const Mf="__type__",qy="__max__",Gs={mapValue:{}},Lf="__vector__",_i="value";function sn(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?za(n)?4:zy(n)?9007199254740991:$y(n)?10:11:U(28295,{value:n})}function gt(n,e){if(n===e)return!0;const t=sn(n);if(t!==sn(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return os(n).isEqual(os(e));case 3:return(function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const a=nn(s.timestampValue),u=nn(i.timestampValue);return a.seconds===u.seconds&&a.nanos===u.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(s,i){return rn(s.bytesValue).isEqual(rn(i.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(s,i){return ce(s.geoPointValue.latitude)===ce(i.geoPointValue.latitude)&&ce(s.geoPointValue.longitude)===ce(i.geoPointValue.longitude)})(n,e);case 2:return(function(s,i){if("integerValue"in s&&"integerValue"in i)return ce(s.integerValue)===ce(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const a=ce(s.doubleValue),u=ce(i.doubleValue);return a===u?mi(a)===mi(u):isNaN(a)&&isNaN(u)}return!1})(n,e);case 9:return ar(n.arrayValue.values||[],e.arrayValue.values||[],gt);case 10:case 11:return(function(s,i){const a=s.mapValue.fields||{},u=i.mapValue.fields||{};if(cl(a)!==cl(u))return!1;for(const l in a)if(a.hasOwnProperty(l)&&(u[l]===void 0||!gt(a[l],u[l])))return!1;return!0})(n,e);default:return U(52216,{left:n})}}function cs(n,e){return(n.values||[]).find((t=>gt(t,e)))!==void 0}function cr(n,e){if(n===e)return 0;const t=sn(n),r=sn(e);if(t!==r)return H(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return H(n.booleanValue,e.booleanValue);case 2:return(function(i,a){const u=ce(i.integerValue||i.doubleValue),l=ce(a.integerValue||a.doubleValue);return u<l?-1:u>l?1:u===l?0:isNaN(u)?isNaN(l)?0:-1:1})(n,e);case 3:return ll(n.timestampValue,e.timestampValue);case 4:return ll(os(n),os(e));case 5:return ia(n.stringValue,e.stringValue);case 6:return(function(i,a){const u=rn(i),l=rn(a);return u.compareTo(l)})(n.bytesValue,e.bytesValue);case 7:return(function(i,a){const u=i.split("/"),l=a.split("/");for(let h=0;h<u.length&&h<l.length;h++){const d=H(u[h],l[h]);if(d!==0)return d}return H(u.length,l.length)})(n.referenceValue,e.referenceValue);case 8:return(function(i,a){const u=H(ce(i.latitude),ce(a.latitude));return u!==0?u:H(ce(i.longitude),ce(a.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return hl(n.arrayValue,e.arrayValue);case 10:return(function(i,a){const u=i.fields||{},l=a.fields||{},h=u[_i]?.arrayValue,d=l[_i]?.arrayValue,m=H(h?.values?.length||0,d?.values?.length||0);return m!==0?m:hl(h,d)})(n.mapValue,e.mapValue);case 11:return(function(i,a){if(i===Gs.mapValue&&a===Gs.mapValue)return 0;if(i===Gs.mapValue)return 1;if(a===Gs.mapValue)return-1;const u=i.fields||{},l=Object.keys(u),h=a.fields||{},d=Object.keys(h);l.sort(),d.sort();for(let m=0;m<l.length&&m<d.length;++m){const g=ia(l[m],d[m]);if(g!==0)return g;const w=cr(u[l[m]],h[d[m]]);if(w!==0)return w}return H(l.length,d.length)})(n.mapValue,e.mapValue);default:throw U(23264,{he:t})}}function ll(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return H(n,e);const t=nn(n),r=nn(e),s=H(t.seconds,r.seconds);return s!==0?s:H(t.nanos,r.nanos)}function hl(n,e){const t=n.values||[],r=e.values||[];for(let s=0;s<t.length&&s<r.length;++s){const i=cr(t[s],r[s]);if(i)return i}return H(t.length,r.length)}function ur(n){return oa(n)}function oa(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const r=nn(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return rn(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return F.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",s=!0;for(const i of t.values||[])s?s=!1:r+=",",r+=oa(i);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){const r=Object.keys(t.fields||{}).sort();let s="{",i=!0;for(const a of r)i?i=!1:s+=",",s+=`${a}:${oa(t.fields[a])}`;return s+"}"})(n.mapValue):U(61005,{value:n})}function ei(n){switch(sn(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=zi(n);return e?16+ei(e):16;case 5:return 2*n.stringValue.length;case 6:return rn(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((s,i)=>s+ei(i)),0)})(n.arrayValue);case 10:case 11:return(function(r){let s=0;return Vn(r.fields,((i,a)=>{s+=i.length+ei(a)})),s})(n.mapValue);default:throw U(13486,{value:n})}}function aa(n){return!!n&&"integerValue"in n}function Ha(n){return!!n&&"arrayValue"in n}function fl(n){return!!n&&"nullValue"in n}function dl(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function ti(n){return!!n&&"mapValue"in n}function $y(n){return(n?.mapValue?.fields||{})[Mf]?.stringValue===Lf}function Kr(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return Vn(n.mapValue.fields,((t,r)=>e.mapValue.fields[t]=Kr(r))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Kr(n.arrayValue.values[t]);return e}return{...n}}function zy(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===qy}class He{constructor(e){this.value=e}static empty(){return new He({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!ti(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Kr(t)}setAll(e){let t=ve.emptyPath(),r={},s=[];e.forEach(((a,u)=>{if(!t.isImmediateParentOf(u)){const l=this.getFieldsMap(t);this.applyChanges(l,r,s),r={},s=[],t=u.popLast()}a?r[u.lastSegment()]=Kr(a):s.push(u.lastSegment())}));const i=this.getFieldsMap(t);this.applyChanges(i,r,s)}delete(e){const t=this.field(e.popLast());ti(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return gt(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=t.mapValue.fields[e.get(r)];ti(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,r){Vn(t,((s,i)=>e[s]=i));for(const s of r)delete e[s]}clone(){return new He(Kr(this.value))}}function xf(n){const e=[];return Vn(n.fields,((t,r)=>{const s=new ve([t]);if(ti(r)){const i=xf(r.mapValue).fields;if(i.length===0)e.push(s);else for(const a of i)e.push(s.child(a))}else e.push(s)})),new Je(e)}class Se{constructor(e,t,r,s,i,a,u){this.key=e,this.documentType=t,this.version=r,this.readTime=s,this.createTime=i,this.data=a,this.documentState=u}static newInvalidDocument(e){return new Se(e,0,j.min(),j.min(),j.min(),He.empty(),0)}static newFoundDocument(e,t,r,s){return new Se(e,1,t,j.min(),r,s,0)}static newNoDocument(e,t){return new Se(e,2,t,j.min(),j.min(),He.empty(),0)}static newUnknownDocument(e,t){return new Se(e,3,t,j.min(),j.min(),He.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(j.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=He.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=He.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=j.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Se&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Se(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class yi{constructor(e,t){this.position=e,this.inclusive=t}}function pl(n,e,t){let r=0;for(let s=0;s<n.position.length;s++){const i=e[s],a=n.position[s];if(i.field.isKeyField()?r=F.comparator(F.fromName(a.referenceValue),t.key):r=cr(a,t.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function ml(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!gt(n.position[t],e.position[t]))return!1;return!0}class vi{constructor(e,t="asc"){this.field=e,this.dir=t}}function Hy(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class Ff{}class de extends Ff{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new Gy(e,t,r):t==="array-contains"?new Xy(e,r):t==="in"?new Yy(e,r):t==="not-in"?new Jy(e,r):t==="array-contains-any"?new Zy(e,r):new de(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new Ky(e,r):new Qy(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(cr(t,this.value)):t!==null&&sn(this.value)===sn(t)&&this.matchesComparison(cr(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return U(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class _t extends Ff{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new _t(e,t)}matches(e){return Uf(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Uf(n){return n.op==="and"}function Bf(n){return Wy(n)&&Uf(n)}function Wy(n){for(const e of n.filters)if(e instanceof _t)return!1;return!0}function ca(n){if(n instanceof de)return n.field.canonicalString()+n.op.toString()+ur(n.value);if(Bf(n))return n.filters.map((e=>ca(e))).join(",");{const e=n.filters.map((t=>ca(t))).join(",");return`${n.op}(${e})`}}function jf(n,e){return n instanceof de?(function(r,s){return s instanceof de&&r.op===s.op&&r.field.isEqual(s.field)&&gt(r.value,s.value)})(n,e):n instanceof _t?(function(r,s){return s instanceof _t&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce(((i,a,u)=>i&&jf(a,s.filters[u])),!0):!1})(n,e):void U(19439)}function qf(n){return n instanceof de?(function(t){return`${t.field.canonicalString()} ${t.op} ${ur(t.value)}`})(n):n instanceof _t?(function(t){return t.op.toString()+" {"+t.getFilters().map(qf).join(" ,")+"}"})(n):"Filter"}class Gy extends de{constructor(e,t,r){super(e,t,r),this.key=F.fromName(r.referenceValue)}matches(e){const t=F.comparator(e.key,this.key);return this.matchesComparison(t)}}class Ky extends de{constructor(e,t){super(e,"in",t),this.keys=$f("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class Qy extends de{constructor(e,t){super(e,"not-in",t),this.keys=$f("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function $f(n,e){return(e.arrayValue?.values||[]).map((t=>F.fromName(t.referenceValue)))}class Xy extends de{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Ha(t)&&cs(t.arrayValue,this.value)}}class Yy extends de{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&cs(this.value.arrayValue,t)}}class Jy extends de{constructor(e,t){super(e,"not-in",t)}matches(e){if(cs(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!cs(this.value.arrayValue,t)}}class Zy extends de{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Ha(t)||!t.arrayValue.values)&&t.arrayValue.values.some((r=>cs(this.value.arrayValue,r)))}}class ev{constructor(e,t=null,r=[],s=[],i=null,a=null,u=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=a,this.endAt=u,this.Te=null}}function gl(n,e=null,t=[],r=[],s=null,i=null,a=null){return new ev(n,e,t,r,s,i,a)}function Wa(n){const e=q(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((r=>ca(r))).join(","),t+="|ob:",t+=e.orderBy.map((r=>(function(i){return i.field.canonicalString()+i.dir})(r))).join(","),$i(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((r=>ur(r))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((r=>ur(r))).join(",")),e.Te=t}return e.Te}function Ga(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!Hy(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!jf(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!ml(n.startAt,e.startAt)&&ml(n.endAt,e.endAt)}function ua(n){return F.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}class Hi{constructor(e,t=null,r=[],s=[],i=null,a="F",u=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=a,this.startAt=u,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function tv(n,e,t,r,s,i,a,u){return new Hi(n,e,t,r,s,i,a,u)}function Ka(n){return new Hi(n)}function _l(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function nv(n){return n.collectionGroup!==null}function Qr(n){const e=q(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),t.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let u=new pe(ve.comparator);return a.filters.forEach((l=>{l.getFlattenedFilters().forEach((h=>{h.isInequality()&&(u=u.add(h.field))}))})),u})(e).forEach((i=>{t.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new vi(i,r))})),t.has(ve.keyField().canonicalString())||e.Ie.push(new vi(ve.keyField(),r))}return e.Ie}function lt(n){const e=q(n);return e.Ee||(e.Ee=rv(e,Qr(n))),e.Ee}function rv(n,e){if(n.limitType==="F")return gl(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((s=>{const i=s.dir==="desc"?"asc":"desc";return new vi(s.field,i)}));const t=n.endAt?new yi(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new yi(n.startAt.position,n.startAt.inclusive):null;return gl(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function la(n,e,t){return new Hi(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Wi(n,e){return Ga(lt(n),lt(e))&&n.limitType===e.limitType}function zf(n){return`${Wa(lt(n))}|lt:${n.limitType}`}function jn(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map((s=>qf(s))).join(", ")}]`),$i(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map((s=>(function(a){return`${a.field.canonicalString()} (${a.dir})`})(s))).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map((s=>ur(s))).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map((s=>ur(s))).join(",")),`Target(${r})`})(lt(n))}; limitType=${n.limitType})`}function Gi(n,e){return e.isFoundDocument()&&(function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):F.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)})(n,e)&&(function(r,s){for(const i of Qr(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0})(n,e)&&(function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0})(n,e)&&(function(r,s){return!(r.startAt&&!(function(a,u,l){const h=pl(a,u,l);return a.inclusive?h<=0:h<0})(r.startAt,Qr(r),s)||r.endAt&&!(function(a,u,l){const h=pl(a,u,l);return a.inclusive?h>=0:h>0})(r.endAt,Qr(r),s))})(n,e)}function sv(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function Hf(n){return(e,t)=>{let r=!1;for(const s of Qr(n)){const i=iv(s,e,t);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function iv(n,e,t){const r=n.field.isKeyField()?F.comparator(e.key,t.key):(function(i,a,u){const l=a.data.field(i),h=u.data.field(i);return l!==null&&h!==null?cr(l,h):U(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return U(19790,{direction:n.dir})}}class Dn{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[t]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Vn(this.inner,((t,r)=>{for(const[s,i]of r)e(s,i)}))}isEmpty(){return Cf(this.inner)}size(){return this.innerSize}}const ov=new oe(F.comparator);function Pt(){return ov}const Wf=new oe(F.comparator);function Br(...n){let e=Wf;for(const t of n)e=e.insert(t.key,t);return e}function Gf(n){let e=Wf;return n.forEach(((t,r)=>e=e.insert(t,r.overlayedDocument))),e}function mn(){return Xr()}function Kf(){return Xr()}function Xr(){return new Dn((n=>n.toString()),((n,e)=>n.isEqual(e)))}const av=new oe(F.comparator),cv=new pe(F.comparator);function W(...n){let e=cv;for(const t of n)e=e.add(t);return e}const uv=new pe(H);function lv(){return uv}function Qa(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:mi(e)?"-0":e}}function Qf(n){return{integerValue:""+n}}function hv(n,e){return xy(e)?Qf(e):Qa(n,e)}class Ki{constructor(){this._=void 0}}function fv(n,e,t){return n instanceof Ei?(function(s,i){const a={fields:{[Df]:{stringValue:Vf},[Of]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&za(i)&&(i=zi(i)),i&&(a.fields[Nf]=i),{mapValue:a}})(t,e):n instanceof us?Yf(n,e):n instanceof ls?Jf(n,e):(function(s,i){const a=Xf(s,i),u=yl(a)+yl(s.Ae);return aa(a)&&aa(s.Ae)?Qf(u):Qa(s.serializer,u)})(n,e)}function dv(n,e,t){return n instanceof us?Yf(n,e):n instanceof ls?Jf(n,e):t}function Xf(n,e){return n instanceof Ti?(function(r){return aa(r)||(function(i){return!!i&&"doubleValue"in i})(r)})(e)?e:{integerValue:0}:null}class Ei extends Ki{}class us extends Ki{constructor(e){super(),this.elements=e}}function Yf(n,e){const t=Zf(e);for(const r of n.elements)t.some((s=>gt(s,r)))||t.push(r);return{arrayValue:{values:t}}}class ls extends Ki{constructor(e){super(),this.elements=e}}function Jf(n,e){let t=Zf(e);for(const r of n.elements)t=t.filter((s=>!gt(s,r)));return{arrayValue:{values:t}}}class Ti extends Ki{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function yl(n){return ce(n.integerValue||n.doubleValue)}function Zf(n){return Ha(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function pv(n,e){return n.field.isEqual(e.field)&&(function(r,s){return r instanceof us&&s instanceof us||r instanceof ls&&s instanceof ls?ar(r.elements,s.elements,gt):r instanceof Ti&&s instanceof Ti?gt(r.Ae,s.Ae):r instanceof Ei&&s instanceof Ei})(n.transform,e.transform)}class mv{constructor(e,t){this.version=e,this.transformResults=t}}class Rt{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Rt}static exists(e){return new Rt(void 0,e)}static updateTime(e){return new Rt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function ni(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Qi{}function ed(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new nd(n.key,Rt.none()):new Ts(n.key,n.data,Rt.none());{const t=n.data,r=He.empty();let s=new pe(ve.comparator);for(let i of e.fields)if(!s.has(i)){let a=t.field(i);a===null&&i.length>1&&(i=i.popLast(),a=t.field(i)),a===null?r.delete(i):r.set(i,a),s=s.add(i)}return new Nn(n.key,r,new Je(s.toArray()),Rt.none())}}function gv(n,e,t){n instanceof Ts?(function(s,i,a){const u=s.value.clone(),l=El(s.fieldTransforms,i,a.transformResults);u.setAll(l),i.convertToFoundDocument(a.version,u).setHasCommittedMutations()})(n,e,t):n instanceof Nn?(function(s,i,a){if(!ni(s.precondition,i))return void i.convertToUnknownDocument(a.version);const u=El(s.fieldTransforms,i,a.transformResults),l=i.data;l.setAll(td(s)),l.setAll(u),i.convertToFoundDocument(a.version,l).setHasCommittedMutations()})(n,e,t):(function(s,i,a){i.convertToNoDocument(a.version).setHasCommittedMutations()})(0,e,t)}function Yr(n,e,t,r){return n instanceof Ts?(function(i,a,u,l){if(!ni(i.precondition,a))return u;const h=i.value.clone(),d=Tl(i.fieldTransforms,l,a);return h.setAll(d),a.convertToFoundDocument(a.version,h).setHasLocalMutations(),null})(n,e,t,r):n instanceof Nn?(function(i,a,u,l){if(!ni(i.precondition,a))return u;const h=Tl(i.fieldTransforms,l,a),d=a.data;return d.setAll(td(i)),d.setAll(h),a.convertToFoundDocument(a.version,d).setHasLocalMutations(),u===null?null:u.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map((m=>m.field)))})(n,e,t,r):(function(i,a,u){return ni(i.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):u})(n,e,t)}function _v(n,e){let t=null;for(const r of n.fieldTransforms){const s=e.data.field(r.field),i=Xf(r.transform,s||null);i!=null&&(t===null&&(t=He.empty()),t.set(r.field,i))}return t||null}function vl(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&ar(r,s,((i,a)=>pv(i,a)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Ts extends Qi{constructor(e,t,r,s=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Nn extends Qi{constructor(e,t,r,s,i=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function td(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}})),e}function El(n,e,t){const r=new Map;Y(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let s=0;s<t.length;s++){const i=n[s],a=i.transform,u=e.data.field(i.field);r.set(i.field,dv(a,u,t[s]))}return r}function Tl(n,e,t){const r=new Map;for(const s of n){const i=s.transform,a=t.data.field(s.field);r.set(s.field,fv(i,a,e))}return r}class nd extends Qi{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class yv extends Qi{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class vv{constructor(e,t,r,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&gv(i,e,r[s])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=Yr(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=Yr(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=Kf();return this.mutations.forEach((s=>{const i=e.get(s.key),a=i.overlayedDocument;let u=this.applyToLocalView(a,i.mutatedFields);u=t.has(s.key)?null:u;const l=ed(a,u);l!==null&&r.set(s.key,l),a.isValidDocument()||a.convertToNoDocument(j.min())})),r}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),W())}isEqual(e){return this.batchId===e.batchId&&ar(this.mutations,e.mutations,((t,r)=>vl(t,r)))&&ar(this.baseMutations,e.baseMutations,((t,r)=>vl(t,r)))}}class Xa{constructor(e,t,r,s){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=s}static from(e,t,r){Y(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let s=(function(){return av})();const i=e.mutations;for(let a=0;a<i.length;a++)s=s.insert(i[a].key,r[a].version);return new Xa(e,t,r,s)}}class Ev{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class Tv{constructor(e,t){this.count=e,this.unchangedNames=t}}var le,G;function Iv(n){switch(n){case k.OK:return U(64938);case k.CANCELLED:case k.UNKNOWN:case k.DEADLINE_EXCEEDED:case k.RESOURCE_EXHAUSTED:case k.INTERNAL:case k.UNAVAILABLE:case k.UNAUTHENTICATED:return!1;case k.INVALID_ARGUMENT:case k.NOT_FOUND:case k.ALREADY_EXISTS:case k.PERMISSION_DENIED:case k.FAILED_PRECONDITION:case k.ABORTED:case k.OUT_OF_RANGE:case k.UNIMPLEMENTED:case k.DATA_LOSS:return!0;default:return U(15467,{code:n})}}function rd(n){if(n===void 0)return St("GRPC error has no .code"),k.UNKNOWN;switch(n){case le.OK:return k.OK;case le.CANCELLED:return k.CANCELLED;case le.UNKNOWN:return k.UNKNOWN;case le.DEADLINE_EXCEEDED:return k.DEADLINE_EXCEEDED;case le.RESOURCE_EXHAUSTED:return k.RESOURCE_EXHAUSTED;case le.INTERNAL:return k.INTERNAL;case le.UNAVAILABLE:return k.UNAVAILABLE;case le.UNAUTHENTICATED:return k.UNAUTHENTICATED;case le.INVALID_ARGUMENT:return k.INVALID_ARGUMENT;case le.NOT_FOUND:return k.NOT_FOUND;case le.ALREADY_EXISTS:return k.ALREADY_EXISTS;case le.PERMISSION_DENIED:return k.PERMISSION_DENIED;case le.FAILED_PRECONDITION:return k.FAILED_PRECONDITION;case le.ABORTED:return k.ABORTED;case le.OUT_OF_RANGE:return k.OUT_OF_RANGE;case le.UNIMPLEMENTED:return k.UNIMPLEMENTED;case le.DATA_LOSS:return k.DATA_LOSS;default:return U(39323,{code:n})}}(G=le||(le={}))[G.OK=0]="OK",G[G.CANCELLED=1]="CANCELLED",G[G.UNKNOWN=2]="UNKNOWN",G[G.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",G[G.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",G[G.NOT_FOUND=5]="NOT_FOUND",G[G.ALREADY_EXISTS=6]="ALREADY_EXISTS",G[G.PERMISSION_DENIED=7]="PERMISSION_DENIED",G[G.UNAUTHENTICATED=16]="UNAUTHENTICATED",G[G.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",G[G.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",G[G.ABORTED=10]="ABORTED",G[G.OUT_OF_RANGE=11]="OUT_OF_RANGE",G[G.UNIMPLEMENTED=12]="UNIMPLEMENTED",G[G.INTERNAL=13]="INTERNAL",G[G.UNAVAILABLE=14]="UNAVAILABLE",G[G.DATA_LOSS=15]="DATA_LOSS";function wv(){return new TextEncoder}const Av=new Zt([4294967295,4294967295],0);function Il(n){const e=wv().encode(n),t=new yf;return t.update(e),new Uint8Array(t.digest())}function wl(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Zt([t,r],0),new Zt([s,i],0)]}class Ya{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new jr(`Invalid padding: ${t}`);if(r<0)throw new jr(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new jr(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new jr(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Zt.fromNumber(this.ge)}ye(e,t,r){let s=e.add(t.multiply(Zt.fromNumber(r)));return s.compare(Av)===1&&(s=new Zt([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=Il(e),[r,s]=wl(t);for(let i=0;i<this.hashCount;i++){const a=this.ye(r,s,i);if(!this.we(a))return!1}return!0}static create(e,t,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),a=new Ya(i,s,t);return r.forEach((u=>a.insert(u))),a}insert(e){if(this.ge===0)return;const t=Il(e),[r,s]=wl(t);for(let i=0;i<this.hashCount;i++){const a=this.ye(r,s,i);this.Se(a)}}Se(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class jr extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Xi{constructor(e,t,r,s,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const s=new Map;return s.set(e,Is.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new Xi(j.min(),s,new oe(H),Pt(),W())}}class Is{constructor(e,t,r,s,i){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new Is(r,t,W(),W(),W())}}class ri{constructor(e,t,r,s){this.be=e,this.removedTargetIds=t,this.key=r,this.De=s}}class sd{constructor(e,t){this.targetId=e,this.Ce=t}}class id{constructor(e,t,r=Ee.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=s}}class Al{constructor(){this.ve=0,this.Fe=Rl(),this.Me=Ee.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=W(),t=W(),r=W();return this.Fe.forEach(((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:r=r.add(s);break;default:U(38017,{changeType:i})}})),new Is(this.Me,this.xe,e,t,r)}qe(){this.Oe=!1,this.Fe=Rl()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Y(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class Rv{constructor(e){this.Ge=e,this.ze=new Map,this.je=Pt(),this.Je=Ks(),this.He=Ks(),this.Ye=new oe(H)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:U(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((r,s)=>{this.rt(s)&&t(s)}))}st(e){const t=e.targetId,r=e.Ce.count,s=this.ot(t);if(s){const i=s.target;if(ua(i))if(r===0){const a=new F(i.path);this.et(t,a,Se.newNoDocument(a,j.min()))}else Y(r===1,20013,{expectedCount:r});else{const a=this._t(t);if(a!==r){const u=this.ut(e),l=u?this.ct(u,e,a):1;if(l!==0){this.it(t);const h=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,h)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=t;let a,u;try{a=rn(r).toUint8Array()}catch(l){if(l instanceof kf)return or("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{u=new Ya(a,s,i)}catch(l){return or(l instanceof jr?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return u.ge===0?null:u}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){const r=this.Ge.getRemoteKeysForTarget(t);let s=0;return r.forEach((i=>{const a=this.Ge.ht(),u=`projects/${a.projectId}/databases/${a.database}/documents/${i.path.canonicalString()}`;e.mightContain(u)||(this.et(t,i,null),s++)})),s}Tt(e){const t=new Map;this.ze.forEach(((i,a)=>{const u=this.ot(a);if(u){if(i.current&&ua(u.target)){const l=new F(u.target.path);this.It(l).has(a)||this.Et(a,l)||this.et(a,l,Se.newNoDocument(l,e))}i.Be&&(t.set(a,i.ke()),i.qe())}}));let r=W();this.He.forEach(((i,a)=>{let u=!0;a.forEachWhile((l=>{const h=this.ot(l);return!h||h.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)})),u&&(r=r.add(i))})),this.je.forEach(((i,a)=>a.setReadTime(e)));const s=new Xi(e,t,this.Ye,this.je,r);return this.je=Pt(),this.Je=Ks(),this.He=Ks(),this.Ye=new oe(H),s}Xe(e,t){if(!this.rt(e))return;const r=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,r),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,t)?s.Qe(t,1):s.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new Al,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new pe(H),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new pe(H),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||N("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Al),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Ks(){return new oe(F.comparator)}function Rl(){return new oe(F.comparator)}const bv={asc:"ASCENDING",desc:"DESCENDING"},Sv={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Pv={and:"AND",or:"OR"};class Cv{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function ha(n,e){return n.useProto3Json||$i(e)?e:{value:e}}function Ii(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function od(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function kv(n,e){return Ii(n,e.toTimestamp())}function ht(n){return Y(!!n,49232),j.fromTimestamp((function(t){const r=nn(t);return new re(r.seconds,r.nanos)})(n))}function Ja(n,e){return fa(n,e).canonicalString()}function fa(n,e){const t=(function(s){return new ne(["projects",s.projectId,"databases",s.database])})(n).child("documents");return e===void 0?t:t.child(e)}function ad(n){const e=ne.fromString(n);return Y(fd(e),10190,{key:e.toString()}),e}function da(n,e){return Ja(n.databaseId,e.path)}function Bo(n,e){const t=ad(e);if(t.get(1)!==n.databaseId.projectId)throw new x(k.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new x(k.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new F(ud(t))}function cd(n,e){return Ja(n.databaseId,e)}function Vv(n){const e=ad(n);return e.length===4?ne.emptyPath():ud(e)}function pa(n){return new ne(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function ud(n){return Y(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function bl(n,e,t){return{name:da(n,e),fields:t.value.mapValue.fields}}function Dv(n,e){let t;if("targetChange"in e){e.targetChange;const r=(function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:U(39313,{state:h})})(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=(function(h,d){return h.useProto3Json?(Y(d===void 0||typeof d=="string",58123),Ee.fromBase64String(d||"")):(Y(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),Ee.fromUint8Array(d||new Uint8Array))})(n,e.targetChange.resumeToken),a=e.targetChange.cause,u=a&&(function(h){const d=h.code===void 0?k.UNKNOWN:rd(h.code);return new x(d,h.message||"")})(a);t=new id(r,s,i,u||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=Bo(n,r.document.name),i=ht(r.document.updateTime),a=r.document.createTime?ht(r.document.createTime):j.min(),u=new He({mapValue:{fields:r.document.fields}}),l=Se.newFoundDocument(s,i,a,u),h=r.targetIds||[],d=r.removedTargetIds||[];t=new ri(h,d,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=Bo(n,r.document),i=r.readTime?ht(r.readTime):j.min(),a=Se.newNoDocument(s,i),u=r.removedTargetIds||[];t=new ri([],u,a.key,a)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=Bo(n,r.document),i=r.removedTargetIds||[];t=new ri([],i,s,null)}else{if(!("filter"in e))return U(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,a=new Tv(s,i),u=r.targetId;t=new sd(u,a)}}return t}function Nv(n,e){let t;if(e instanceof Ts)t={update:bl(n,e.key,e.value)};else if(e instanceof nd)t={delete:da(n,e.key)};else if(e instanceof Nn)t={update:bl(n,e.key,e.data),updateMask:qv(e.fieldMask)};else{if(!(e instanceof yv))return U(16599,{Vt:e.type});t={verify:da(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((r=>(function(i,a){const u=a.transform;if(u instanceof Ei)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof us)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof ls)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof Ti)return{fieldPath:a.field.canonicalString(),increment:u.Ae};throw U(20930,{transform:a.transform})})(0,r)))),e.precondition.isNone||(t.currentDocument=(function(s,i){return i.updateTime!==void 0?{updateTime:kv(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:U(27497)})(n,e.precondition)),t}function Ov(n,e){return n&&n.length>0?(Y(e!==void 0,14353),n.map((t=>(function(s,i){let a=s.updateTime?ht(s.updateTime):ht(i);return a.isEqual(j.min())&&(a=ht(i)),new mv(a,s.transformResults||[])})(t,e)))):[]}function Mv(n,e){return{documents:[cd(n,e.path)]}}function Lv(n,e){const t={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=cd(n,s);const i=(function(h){if(h.length!==0)return hd(_t.create(h,"and"))})(e.filters);i&&(t.structuredQuery.where=i);const a=(function(h){if(h.length!==0)return h.map((d=>(function(g){return{field:qn(g.field),direction:Uv(g.dir)}})(d)))})(e.orderBy);a&&(t.structuredQuery.orderBy=a);const u=ha(n,e.limit);return u!==null&&(t.structuredQuery.limit=u),e.startAt&&(t.structuredQuery.startAt=(function(h){return{before:h.inclusive,values:h.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(h){return{before:!h.inclusive,values:h.position}})(e.endAt)),{ft:t,parent:s}}function xv(n){let e=Vv(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let s=null;if(r>0){Y(r===1,65062);const d=t.from[0];d.allDescendants?s=d.collectionId:e=e.child(d.collectionId)}let i=[];t.where&&(i=(function(m){const g=ld(m);return g instanceof _t&&Bf(g)?g.getFilters():[g]})(t.where));let a=[];t.orderBy&&(a=(function(m){return m.map((g=>(function(S){return new vi($n(S.field),(function(C){switch(C){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(S.direction))})(g)))})(t.orderBy));let u=null;t.limit&&(u=(function(m){let g;return g=typeof m=="object"?m.value:m,$i(g)?null:g})(t.limit));let l=null;t.startAt&&(l=(function(m){const g=!!m.before,w=m.values||[];return new yi(w,g)})(t.startAt));let h=null;return t.endAt&&(h=(function(m){const g=!m.before,w=m.values||[];return new yi(w,g)})(t.endAt)),tv(e,s,a,i,u,"F",l,h)}function Fv(n,e){const t=(function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return U(28987,{purpose:s})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function ld(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=$n(t.unaryFilter.field);return de.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=$n(t.unaryFilter.field);return de.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=$n(t.unaryFilter.field);return de.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=$n(t.unaryFilter.field);return de.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return U(61313);default:return U(60726)}})(n):n.fieldFilter!==void 0?(function(t){return de.create($n(t.fieldFilter.field),(function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return U(58110);default:return U(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return _t.create(t.compositeFilter.filters.map((r=>ld(r))),(function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return U(1026)}})(t.compositeFilter.op))})(n):U(30097,{filter:n})}function Uv(n){return bv[n]}function Bv(n){return Sv[n]}function jv(n){return Pv[n]}function qn(n){return{fieldPath:n.canonicalString()}}function $n(n){return ve.fromServerFormat(n.fieldPath)}function hd(n){return n instanceof de?(function(t){if(t.op==="=="){if(dl(t.value))return{unaryFilter:{field:qn(t.field),op:"IS_NAN"}};if(fl(t.value))return{unaryFilter:{field:qn(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(dl(t.value))return{unaryFilter:{field:qn(t.field),op:"IS_NOT_NAN"}};if(fl(t.value))return{unaryFilter:{field:qn(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:qn(t.field),op:Bv(t.op),value:t.value}}})(n):n instanceof _t?(function(t){const r=t.getFilters().map((s=>hd(s)));return r.length===1?r[0]:{compositeFilter:{op:jv(t.op),filters:r}}})(n):U(54877,{filter:n})}function qv(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function fd(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}class Wt{constructor(e,t,r,s,i=j.min(),a=j.min(),u=Ee.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=u,this.expectedCount=l}withSequenceNumber(e){return new Wt(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Wt(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Wt(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Wt(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class $v{constructor(e){this.yt=e}}function zv(n){const e=xv({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?la(e,e.limit,"L"):e}class Hv{constructor(){this.Cn=new Wv}addToCollectionParentIndex(e,t){return this.Cn.add(t),P.resolve()}getCollectionParents(e,t){return P.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return P.resolve()}deleteFieldIndex(e,t){return P.resolve()}deleteAllFieldIndexes(e){return P.resolve()}createTargetIndexes(e,t){return P.resolve()}getDocumentsMatchingTarget(e,t){return P.resolve(null)}getIndexType(e,t){return P.resolve(0)}getFieldIndexes(e,t){return P.resolve([])}getNextCollectionGroupToUpdate(e){return P.resolve(null)}getMinOffset(e,t){return P.resolve(tn.min())}getMinOffsetFromCollectionGroup(e,t){return P.resolve(tn.min())}updateCollectionGroup(e,t,r){return P.resolve()}updateIndexEntries(e,t){return P.resolve()}}class Wv{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t]||new pe(ne.comparator),i=!s.has(r);return this.index[t]=s.add(r),i}has(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t];return s&&s.has(r)}getEntries(e){return(this.index[e]||new pe(ne.comparator)).toArray()}}const Sl={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},dd=41943040;class Le{static withCacheSize(e){return new Le(e,Le.DEFAULT_COLLECTION_PERCENTILE,Le.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}Le.DEFAULT_COLLECTION_PERCENTILE=10,Le.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Le.DEFAULT=new Le(dd,Le.DEFAULT_COLLECTION_PERCENTILE,Le.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Le.DISABLED=new Le(-1,0,0);class lr{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new lr(0)}static cr(){return new lr(-1)}}const Pl="LruGarbageCollector",Gv=1048576;function Cl([n,e],[t,r]){const s=H(n,t);return s===0?H(e,r):s}class Kv{constructor(e){this.Ir=e,this.buffer=new pe(Cl),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();Cl(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class Qv{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){N(Pl,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){vr(t)?N(Pl,"Ignoring IndexedDB error during garbage collection: ",t):await yr(t)}await this.Vr(3e5)}))}}class Xv{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((r=>Math.floor(t/100*r)))}nthSequenceNumber(e,t){if(t===0)return P.resolve(qi.ce);const r=new Kv(t);return this.mr.forEachTarget(e,(s=>r.Ar(s.sequenceNumber))).next((()=>this.mr.pr(e,(s=>r.Ar(s))))).next((()=>r.maxValue))}removeTargets(e,t,r){return this.mr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(N("LruGarbageCollector","Garbage collection skipped; disabled"),P.resolve(Sl)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(N("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Sl):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let r,s,i,a,u,l,h;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((m=>(m>this.params.maximumSequenceNumbersToCollect?(N("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${m}`),s=this.params.maximumSequenceNumbersToCollect):s=m,a=Date.now(),this.nthSequenceNumber(e,s)))).next((m=>(r=m,u=Date.now(),this.removeTargets(e,r,t)))).next((m=>(i=m,l=Date.now(),this.removeOrphanedDocuments(e,r)))).next((m=>(h=Date.now(),Bn()<=z.DEBUG&&N("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-d}ms
	Determined least recently used ${s} in `+(u-a)+`ms
	Removed ${i} targets in `+(l-u)+`ms
	Removed ${m} documents in `+(h-l)+`ms
Total Duration: ${h-d}ms`),P.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:m}))))}}function Yv(n,e){return new Xv(n,e)}class Jv{constructor(){this.changes=new Dn((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Se.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?P.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class Zv{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class eE{constructor(e,t,r,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next((s=>(r=s,this.remoteDocumentCache.getEntry(e,t)))).next((s=>(r!==null&&Yr(r.mutation,s,Je.empty(),re.now()),s)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.getLocalViewOfDocuments(e,r,W()).next((()=>r))))}getLocalViewOfDocuments(e,t,r=W()){const s=mn();return this.populateOverlays(e,s,t).next((()=>this.computeViews(e,t,s,r).next((i=>{let a=Br();return i.forEach(((u,l)=>{a=a.insert(u,l.overlayedDocument)})),a}))))}getOverlayedDocuments(e,t){const r=mn();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,W())))}populateOverlays(e,t,r){const s=[];return r.forEach((i=>{t.has(i)||s.push(i)})),this.documentOverlayCache.getOverlays(e,s).next((i=>{i.forEach(((a,u)=>{t.set(a,u)}))}))}computeViews(e,t,r,s){let i=Pt();const a=Xr(),u=(function(){return Xr()})();return t.forEach(((l,h)=>{const d=r.get(h.key);s.has(h.key)&&(d===void 0||d.mutation instanceof Nn)?i=i.insert(h.key,h):d!==void 0?(a.set(h.key,d.mutation.getFieldMask()),Yr(d.mutation,h,d.mutation.getFieldMask(),re.now())):a.set(h.key,Je.empty())})),this.recalculateAndSaveOverlays(e,i).next((l=>(l.forEach(((h,d)=>a.set(h,d))),t.forEach(((h,d)=>u.set(h,new Zv(d,a.get(h)??null)))),u)))}recalculateAndSaveOverlays(e,t){const r=Xr();let s=new oe(((a,u)=>a-u)),i=W();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((a=>{for(const u of a)u.keys().forEach((l=>{const h=t.get(l);if(h===null)return;let d=r.get(l)||Je.empty();d=u.applyToLocalView(h,d),r.set(l,d);const m=(s.get(u.batchId)||W()).add(l);s=s.insert(u.batchId,m)}))})).next((()=>{const a=[],u=s.getReverseIterator();for(;u.hasNext();){const l=u.getNext(),h=l.key,d=l.value,m=Kf();d.forEach((g=>{if(!i.has(g)){const w=ed(t.get(g),r.get(g));w!==null&&m.set(g,w),i=i.add(g)}})),a.push(this.documentOverlayCache.saveOverlays(e,h,m))}return P.waitFor(a)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,t,r,s){return(function(a){return F.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):nv(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,s):this.getDocumentsMatchingCollectionQuery(e,t,r,s)}getNextDocuments(e,t,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,s).next((i=>{const a=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,s-i.size):P.resolve(mn());let u=is,l=i;return a.next((h=>P.forEach(h,((d,m)=>(u<m.largestBatchId&&(u=m.largestBatchId),i.get(d)?P.resolve():this.remoteDocumentCache.getEntry(e,d).next((g=>{l=l.insert(d,g)}))))).next((()=>this.populateOverlays(e,h,i))).next((()=>this.computeViews(e,l,h,W()))).next((d=>({batchId:u,changes:Gf(d)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new F(t)).next((r=>{let s=Br();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s}))}getDocumentsMatchingCollectionGroupQuery(e,t,r,s){const i=t.collectionGroup;let a=Br();return this.indexManager.getCollectionParents(e,i).next((u=>P.forEach(u,(l=>{const h=(function(m,g){return new Hi(g,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)})(t,l.child(i));return this.getDocumentsMatchingCollectionQuery(e,h,r,s).next((d=>{d.forEach(((m,g)=>{a=a.insert(m,g)}))}))})).next((()=>a))))}getDocumentsMatchingCollectionQuery(e,t,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next((a=>(i=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,i,s)))).next((a=>{i.forEach(((l,h)=>{const d=h.getKey();a.get(d)===null&&(a=a.insert(d,Se.newInvalidDocument(d)))}));let u=Br();return a.forEach(((l,h)=>{const d=i.get(l);d!==void 0&&Yr(d.mutation,h,Je.empty(),re.now()),Gi(t,h)&&(u=u.insert(l,h))})),u}))}}class tE{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return P.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(s){return{id:s.id,version:s.version,createTime:ht(s.createTime)}})(t)),P.resolve()}getNamedQuery(e,t){return P.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(s){return{name:s.name,query:zv(s.bundledQuery),readTime:ht(s.readTime)}})(t)),P.resolve()}}class nE{constructor(){this.overlays=new oe(F.comparator),this.qr=new Map}getOverlay(e,t){return P.resolve(this.overlays.get(t))}getOverlays(e,t){const r=mn();return P.forEach(t,(s=>this.getOverlay(e,s).next((i=>{i!==null&&r.set(s,i)})))).next((()=>r))}saveOverlays(e,t,r){return r.forEach(((s,i)=>{this.St(e,t,i)})),P.resolve()}removeOverlaysForBatchId(e,t,r){const s=this.qr.get(r);return s!==void 0&&(s.forEach((i=>this.overlays=this.overlays.remove(i))),this.qr.delete(r)),P.resolve()}getOverlaysForCollection(e,t,r){const s=mn(),i=t.length+1,a=new F(t.child("")),u=this.overlays.getIteratorFrom(a);for(;u.hasNext();){const l=u.getNext().value,h=l.getKey();if(!t.isPrefixOf(h.path))break;h.path.length===i&&l.largestBatchId>r&&s.set(l.getKey(),l)}return P.resolve(s)}getOverlaysForCollectionGroup(e,t,r,s){let i=new oe(((h,d)=>h-d));const a=this.overlays.getIterator();for(;a.hasNext();){const h=a.getNext().value;if(h.getKey().getCollectionGroup()===t&&h.largestBatchId>r){let d=i.get(h.largestBatchId);d===null&&(d=mn(),i=i.insert(h.largestBatchId,d)),d.set(h.getKey(),h)}}const u=mn(),l=i.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach(((h,d)=>u.set(h,d))),!(u.size()>=s)););return P.resolve(u)}St(e,t,r){const s=this.overlays.get(r.key);if(s!==null){const a=this.qr.get(s.largestBatchId).delete(r.key);this.qr.set(s.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new Ev(t,r));let i=this.qr.get(t);i===void 0&&(i=W(),this.qr.set(t,i)),this.qr.set(t,i.add(r.key))}}class rE{constructor(){this.sessionToken=Ee.EMPTY_BYTE_STRING}getSessionToken(e){return P.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,P.resolve()}}class Za{constructor(){this.Qr=new pe(ge.$r),this.Ur=new pe(ge.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const r=new ge(e,t);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,t){e.forEach((r=>this.addReference(r,t)))}removeReference(e,t){this.Gr(new ge(e,t))}zr(e,t){e.forEach((r=>this.removeReference(r,t)))}jr(e){const t=new F(new ne([])),r=new ge(t,e),s=new ge(t,e+1),i=[];return this.Ur.forEachInRange([r,s],(a=>{this.Gr(a),i.push(a.key)})),i}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new F(new ne([])),r=new ge(t,e),s=new ge(t,e+1);let i=W();return this.Ur.forEachInRange([r,s],(a=>{i=i.add(a.key)})),i}containsKey(e){const t=new ge(e,0),r=this.Qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class ge{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return F.comparator(e.key,t.key)||H(e.Yr,t.Yr)}static Kr(e,t){return H(e.Yr,t.Yr)||F.comparator(e.key,t.key)}}class sE{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new pe(ge.$r)}checkEmpty(e){return P.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,s){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new vv(i,t,r,s);this.mutationQueue.push(a);for(const u of s)this.Zr=this.Zr.add(new ge(u.key,i)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return P.resolve(a)}lookupMutationBatch(e,t){return P.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,s=this.ei(r),i=s<0?0:s;return P.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return P.resolve(this.mutationQueue.length===0?$a:this.tr-1)}getAllMutationBatches(e){return P.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new ge(t,0),s=new ge(t,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([r,s],(a=>{const u=this.Xr(a.Yr);i.push(u)})),P.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new pe(H);return t.forEach((s=>{const i=new ge(s,0),a=new ge(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,a],(u=>{r=r.add(u.Yr)}))})),P.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,s=r.length+1;let i=r;F.isDocumentKey(i)||(i=i.child(""));const a=new ge(new F(i),0);let u=new pe(H);return this.Zr.forEachWhile((l=>{const h=l.key.path;return!!r.isPrefixOf(h)&&(h.length===s&&(u=u.add(l.Yr)),!0)}),a),P.resolve(this.ti(u))}ti(e){const t=[];return e.forEach((r=>{const s=this.Xr(r);s!==null&&t.push(s)})),t}removeMutationBatch(e,t){Y(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return P.forEach(t.mutations,(s=>{const i=new ge(s.key,t.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)})).next((()=>{this.Zr=r}))}ir(e){}containsKey(e,t){const r=new ge(t,0),s=this.Zr.firstAfterOrEqual(r);return P.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,P.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class iE{constructor(e){this.ri=e,this.docs=(function(){return new oe(F.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,s=this.docs.get(r),i=s?s.size:0,a=this.ri(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return P.resolve(r?r.document.mutableCopy():Se.newInvalidDocument(t))}getEntries(e,t){let r=Pt();return t.forEach((s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():Se.newInvalidDocument(s))})),P.resolve(r)}getDocumentsMatchingQuery(e,t,r,s){let i=Pt();const a=t.path,u=new F(a.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(u);for(;l.hasNext();){const{key:h,value:{document:d}}=l.getNext();if(!a.isPrefixOf(h.path))break;h.path.length>a.length+1||Ny(Dy(d),r)<=0||(s.has(d.key)||Gi(t,d))&&(i=i.insert(d.key,d.mutableCopy()))}return P.resolve(i)}getAllFromCollectionGroup(e,t,r,s){U(9500)}ii(e,t){return P.forEach(this.docs,(r=>t(r)))}newChangeBuffer(e){return new oE(this)}getSize(e){return P.resolve(this.size)}}class oE extends Jv{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((r,s)=>{s.isValidDocument()?t.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(r)})),P.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class aE{constructor(e){this.persistence=e,this.si=new Dn((t=>Wa(t)),Ga),this.lastRemoteSnapshotVersion=j.min(),this.highestTargetId=0,this.oi=0,this._i=new Za,this.targetCount=0,this.ai=lr.ur()}forEachTarget(e,t){return this.si.forEach(((r,s)=>t(s))),P.resolve()}getLastRemoteSnapshotVersion(e){return P.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return P.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),P.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.oi&&(this.oi=t),P.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new lr(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,P.resolve()}updateTargetData(e,t){return this.Pr(t),P.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,P.resolve()}removeTargets(e,t,r){let s=0;const i=[];return this.si.forEach(((a,u)=>{u.sequenceNumber<=t&&r.get(u.targetId)===null&&(this.si.delete(a),i.push(this.removeMatchingKeysForTargetId(e,u.targetId)),s++)})),P.waitFor(i).next((()=>s))}getTargetCount(e){return P.resolve(this.targetCount)}getTargetData(e,t){const r=this.si.get(t)||null;return P.resolve(r)}addMatchingKeys(e,t,r){return this._i.Wr(t,r),P.resolve()}removeMatchingKeys(e,t,r){this._i.zr(t,r);const s=this.persistence.referenceDelegate,i=[];return s&&t.forEach((a=>{i.push(s.markPotentiallyOrphaned(e,a))})),P.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),P.resolve()}getMatchingKeysForTargetId(e,t){const r=this._i.Hr(t);return P.resolve(r)}containsKey(e,t){return P.resolve(this._i.containsKey(t))}}class pd{constructor(e,t){this.ui={},this.overlays={},this.ci=new qi(0),this.li=!1,this.li=!0,this.hi=new rE,this.referenceDelegate=e(this),this.Pi=new aE(this),this.indexManager=new Hv,this.remoteDocumentCache=(function(s){return new iE(s)})((r=>this.referenceDelegate.Ti(r))),this.serializer=new $v(t),this.Ii=new tE(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new nE,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ui[e.toKey()];return r||(r=new sE(t,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,r){N("MemoryPersistence","Starting transaction:",e);const s=new cE(this.ci.next());return this.referenceDelegate.Ei(),r(s).next((i=>this.referenceDelegate.di(s).next((()=>i)))).toPromise().then((i=>(s.raiseOnCommittedEvent(),i)))}Ai(e,t){return P.or(Object.values(this.ui).map((r=>()=>r.containsKey(e,t))))}}class cE extends My{constructor(e){super(),this.currentSequenceNumber=e}}class ec{constructor(e){this.persistence=e,this.Ri=new Za,this.Vi=null}static mi(e){return new ec(e)}get fi(){if(this.Vi)return this.Vi;throw U(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.fi.delete(r.toString()),P.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.fi.add(r.toString()),P.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),P.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((s=>this.fi.add(s.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((s=>{s.forEach((i=>this.fi.add(i.toString())))})).next((()=>r.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return P.forEach(this.fi,(r=>{const s=F.fromPath(r);return this.gi(e,s).next((i=>{i||t.removeEntry(s,j.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((r=>{r?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return P.or([()=>P.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class wi{constructor(e,t){this.persistence=e,this.pi=new Dn((r=>Fy(r.path)),((r,s)=>r.isEqual(s))),this.garbageCollector=Yv(this,t)}static mi(e,t){return new wi(e,t)}Ei(){}di(e){return P.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>t.next((s=>r+s))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}pr(e,t){return P.forEach(this.pi,((r,s)=>this.br(e,r,s).next((i=>i?P.resolve():t(s)))))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.ii(e,(a=>this.br(e,a,t).next((u=>{u||(r++,i.removeEntry(a,j.min()))})))).next((()=>i.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),P.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),P.resolve()}removeReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),P.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),P.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=ei(e.data.value)),t}br(e,t,r){return P.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const s=this.pi.get(t);return P.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class tc{constructor(e,t,r,s){this.targetId=e,this.fromCache=t,this.Es=r,this.ds=s}static As(e,t){let r=W(),s=W();for(const i of t.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new tc(e,t.fromCache,r,s)}}class uE{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class lE{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return e_()?8:Ly(Ve())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,s){const i={result:null};return this.ys(e,t).next((a=>{i.result=a})).next((()=>{if(!i.result)return this.ws(e,t,s,r).next((a=>{i.result=a}))})).next((()=>{if(i.result)return;const a=new uE;return this.Ss(e,t,a).next((u=>{if(i.result=u,this.Vs)return this.bs(e,t,a,u.size)}))})).next((()=>i.result))}bs(e,t,r,s){return r.documentReadCount<this.fs?(Bn()<=z.DEBUG&&N("QueryEngine","SDK will not create cache indexes for query:",jn(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),P.resolve()):(Bn()<=z.DEBUG&&N("QueryEngine","Query:",jn(t),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.gs*s?(Bn()<=z.DEBUG&&N("QueryEngine","The SDK decides to create cache indexes for query:",jn(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,lt(t))):P.resolve())}ys(e,t){if(_l(t))return P.resolve(null);let r=lt(t);return this.indexManager.getIndexType(e,r).next((s=>s===0?null:(t.limit!==null&&s===1&&(t=la(t,null,"F"),r=lt(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next((i=>{const a=W(...i);return this.ps.getDocuments(e,a).next((u=>this.indexManager.getMinOffset(e,r).next((l=>{const h=this.Ds(t,u);return this.Cs(t,h,a,l.readTime)?this.ys(e,la(t,null,"F")):this.vs(e,h,t,l)}))))})))))}ws(e,t,r,s){return _l(t)||s.isEqual(j.min())?P.resolve(null):this.ps.getDocuments(e,r).next((i=>{const a=this.Ds(t,i);return this.Cs(t,a,r,s)?P.resolve(null):(Bn()<=z.DEBUG&&N("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),jn(t)),this.vs(e,a,t,Vy(s,is)).next((u=>u)))}))}Ds(e,t){let r=new pe(Hf(e));return t.forEach(((s,i)=>{Gi(e,i)&&(r=r.add(i))})),r}Cs(e,t,r,s){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const i=e.limitType==="F"?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Ss(e,t,r){return Bn()<=z.DEBUG&&N("QueryEngine","Using full collection scan to execute query:",jn(t)),this.ps.getDocumentsMatchingQuery(e,t,tn.min(),r)}vs(e,t,r,s){return this.ps.getDocumentsMatchingQuery(e,r,s).next((i=>(t.forEach((a=>{i=i.insert(a.key,a)})),i)))}}const nc="LocalStore",hE=3e8;class fE{constructor(e,t,r,s){this.persistence=e,this.Fs=t,this.serializer=s,this.Ms=new oe(H),this.xs=new Dn((i=>Wa(i)),Ga),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new eE(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function dE(n,e,t,r){return new fE(n,e,t,r)}async function md(n,e){const t=q(n);return await t.persistence.runTransaction("Handle user change","readonly",(r=>{let s;return t.mutationQueue.getAllMutationBatches(r).next((i=>(s=i,t.Bs(e),t.mutationQueue.getAllMutationBatches(r)))).next((i=>{const a=[],u=[];let l=W();for(const h of s){a.push(h.batchId);for(const d of h.mutations)l=l.add(d.key)}for(const h of i){u.push(h.batchId);for(const d of h.mutations)l=l.add(d.key)}return t.localDocuments.getDocuments(r,l).next((h=>({Ls:h,removedBatchIds:a,addedBatchIds:u})))}))}))}function pE(n,e){const t=q(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const s=e.batch.keys(),i=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(u,l,h,d){const m=h.batch,g=m.keys();let w=P.resolve();return g.forEach((S=>{w=w.next((()=>d.getEntry(l,S))).next((V=>{const C=h.docVersions.get(S);Y(C!==null,48541),V.version.compareTo(C)<0&&(m.applyToRemoteDocument(V,h),V.isValidDocument()&&(V.setReadTime(h.commitVersion),d.addEntry(V)))}))})),w.next((()=>u.mutationQueue.removeMutationBatch(l,m)))})(t,r,e,i).next((()=>i.apply(r))).next((()=>t.mutationQueue.performConsistencyCheck(r))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(u){let l=W();for(let h=0;h<u.mutationResults.length;++h)u.mutationResults[h].transformResults.length>0&&(l=l.add(u.batch.mutations[h].key));return l})(e)))).next((()=>t.localDocuments.getDocuments(r,s)))}))}function gd(n){const e=q(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function mE(n,e){const t=q(n),r=e.snapshotVersion;let s=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(i=>{const a=t.Ns.newChangeBuffer({trackRemovals:!0});s=t.Ms;const u=[];e.targetChanges.forEach(((d,m)=>{const g=s.get(m);if(!g)return;u.push(t.Pi.removeMatchingKeys(i,d.removedDocuments,m).next((()=>t.Pi.addMatchingKeys(i,d.addedDocuments,m))));let w=g.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(m)!==null?w=w.withResumeToken(Ee.EMPTY_BYTE_STRING,j.min()).withLastLimboFreeSnapshotVersion(j.min()):d.resumeToken.approximateByteSize()>0&&(w=w.withResumeToken(d.resumeToken,r)),s=s.insert(m,w),(function(V,C,L){return V.resumeToken.approximateByteSize()===0||C.snapshotVersion.toMicroseconds()-V.snapshotVersion.toMicroseconds()>=hE?!0:L.addedDocuments.size+L.modifiedDocuments.size+L.removedDocuments.size>0})(g,w,d)&&u.push(t.Pi.updateTargetData(i,w))}));let l=Pt(),h=W();if(e.documentUpdates.forEach((d=>{e.resolvedLimboDocuments.has(d)&&u.push(t.persistence.referenceDelegate.updateLimboDocument(i,d))})),u.push(gE(i,a,e.documentUpdates).next((d=>{l=d.ks,h=d.qs}))),!r.isEqual(j.min())){const d=t.Pi.getLastRemoteSnapshotVersion(i).next((m=>t.Pi.setTargetsMetadata(i,i.currentSequenceNumber,r)));u.push(d)}return P.waitFor(u).next((()=>a.apply(i))).next((()=>t.localDocuments.getLocalViewOfDocuments(i,l,h))).next((()=>l))})).then((i=>(t.Ms=s,i)))}function gE(n,e,t){let r=W(),s=W();return t.forEach((i=>r=r.add(i))),e.getEntries(n,r).next((i=>{let a=Pt();return t.forEach(((u,l)=>{const h=i.get(u);l.isFoundDocument()!==h.isFoundDocument()&&(s=s.add(u)),l.isNoDocument()&&l.version.isEqual(j.min())?(e.removeEntry(u,l.readTime),a=a.insert(u,l)):!h.isValidDocument()||l.version.compareTo(h.version)>0||l.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(l),a=a.insert(u,l)):N(nc,"Ignoring outdated watch update for ",u,". Current version:",h.version," Watch version:",l.version)})),{ks:a,qs:s}}))}function _E(n,e){const t=q(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=$a),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function yE(n,e){const t=q(n);return t.persistence.runTransaction("Allocate target","readwrite",(r=>{let s;return t.Pi.getTargetData(r,e).next((i=>i?(s=i,P.resolve(s)):t.Pi.allocateTargetId(r).next((a=>(s=new Wt(e,a,"TargetPurposeListen",r.currentSequenceNumber),t.Pi.addTargetData(r,s).next((()=>s)))))))})).then((r=>{const s=t.Ms.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(r.targetId,r),t.xs.set(e,r.targetId)),r}))}async function ma(n,e,t){const r=q(n),s=r.Ms.get(e),i=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",i,(a=>r.persistence.referenceDelegate.removeTarget(a,s)))}catch(a){if(!vr(a))throw a;N(nc,`Failed to update sequence numbers for target ${e}: ${a}`)}r.Ms=r.Ms.remove(e),r.xs.delete(s.target)}function kl(n,e,t){const r=q(n);let s=j.min(),i=W();return r.persistence.runTransaction("Execute query","readwrite",(a=>(function(l,h,d){const m=q(l),g=m.xs.get(d);return g!==void 0?P.resolve(m.Ms.get(g)):m.Pi.getTargetData(h,d)})(r,a,lt(e)).next((u=>{if(u)return s=u.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(a,u.targetId).next((l=>{i=l}))})).next((()=>r.Fs.getDocumentsMatchingQuery(a,e,t?s:j.min(),t?i:W()))).next((u=>(vE(r,sv(e),u),{documents:u,Qs:i})))))}function vE(n,e,t){let r=n.Os.get(e)||j.min();t.forEach(((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)})),n.Os.set(e,r)}class Vl{constructor(){this.activeTargetIds=lv()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class EE{constructor(){this.Mo=new Vl,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,r){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Vl,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class TE{Oo(e){}shutdown(){}}const Dl="ConnectivityMonitor";class Nl{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){N(Dl,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){N(Dl,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let Qs=null;function ga(){return Qs===null?Qs=(function(){return 268435456+Math.round(2147483648*Math.random())})():Qs++,"0x"+Qs.toString(16)}const jo="RestConnection",IE={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class wE{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${r}/databases/${s}`,this.Wo=this.databaseId.database===gi?`project_id=${r}`:`project_id=${r}&database_id=${s}`}Go(e,t,r,s,i){const a=ga(),u=this.zo(e,t.toUriEncodedString());N(jo,`Sending RPC '${e}' ${a}:`,u,r);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,s,i);const{host:h}=new URL(u),d=mr(h);return this.Jo(e,u,l,r,d).then((m=>(N(jo,`Received RPC '${e}' ${a}: `,m),m)),(m=>{throw or(jo,`RPC '${e}' ${a} failed with error: `,m,"url: ",u,"request:",r),m}))}Ho(e,t,r,s,i,a){return this.Go(e,t,r,s,i)}jo(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+_r})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((s,i)=>e[i]=s)),r&&r.headers.forEach(((s,i)=>e[i]=s))}zo(e,t){const r=IE[e];return`${this.Uo}/v1/${t}:${r}`}terminate(){}}class AE{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const we="WebChannelConnection";class RE extends wE{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,s,i){const a=ga();return new Promise(((u,l)=>{const h=new vf;h.setWithCredentials(!0),h.listenOnce(Ef.COMPLETE,(()=>{try{switch(h.getLastErrorCode()){case Zs.NO_ERROR:const m=h.getResponseJson();N(we,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(m)),u(m);break;case Zs.TIMEOUT:N(we,`RPC '${e}' ${a} timed out`),l(new x(k.DEADLINE_EXCEEDED,"Request time out"));break;case Zs.HTTP_ERROR:const g=h.getStatus();if(N(we,`RPC '${e}' ${a} failed with status:`,g,"response text:",h.getResponseText()),g>0){let w=h.getResponseJson();Array.isArray(w)&&(w=w[0]);const S=w?.error;if(S&&S.status&&S.message){const V=(function(L){const O=L.toLowerCase().replace(/_/g,"-");return Object.values(k).indexOf(O)>=0?O:k.UNKNOWN})(S.status);l(new x(V,S.message))}else l(new x(k.UNKNOWN,"Server responded with status "+h.getStatus()))}else l(new x(k.UNAVAILABLE,"Connection failed."));break;default:U(9055,{l_:e,streamId:a,h_:h.getLastErrorCode(),P_:h.getLastError()})}}finally{N(we,`RPC '${e}' ${a} completed.`)}}));const d=JSON.stringify(s);N(we,`RPC '${e}' ${a} sending request:`,s),h.send(t,"POST",d,r,15)}))}T_(e,t,r){const s=ga(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=wf(),u=If(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(l.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,t,r),l.encodeInitMessageHeaders=!0;const d=i.join("");N(we,`Creating RPC '${e}' stream ${s}: ${d}`,l);const m=a.createWebChannel(d,l);this.I_(m);let g=!1,w=!1;const S=new AE({Yo:C=>{w?N(we,`Not sending because RPC '${e}' stream ${s} is closed:`,C):(g||(N(we,`Opening RPC '${e}' stream ${s} transport.`),m.open(),g=!0),N(we,`RPC '${e}' stream ${s} sending:`,C),m.send(C))},Zo:()=>m.close()}),V=(C,L,O)=>{C.listen(L,(M=>{try{O(M)}catch(X){setTimeout((()=>{throw X}),0)}}))};return V(m,Ur.EventType.OPEN,(()=>{w||(N(we,`RPC '${e}' stream ${s} transport opened.`),S.o_())})),V(m,Ur.EventType.CLOSE,(()=>{w||(w=!0,N(we,`RPC '${e}' stream ${s} transport closed`),S.a_(),this.E_(m))})),V(m,Ur.EventType.ERROR,(C=>{w||(w=!0,or(we,`RPC '${e}' stream ${s} transport errored. Name:`,C.name,"Message:",C.message),S.a_(new x(k.UNAVAILABLE,"The operation could not be completed")))})),V(m,Ur.EventType.MESSAGE,(C=>{if(!w){const L=C.data[0];Y(!!L,16349);const O=L,M=O?.error||O[0]?.error;if(M){N(we,`RPC '${e}' stream ${s} received error:`,M);const X=M.status;let se=(function(_){const y=le[_];if(y!==void 0)return rd(y)})(X),ie=M.message;se===void 0&&(se=k.INTERNAL,ie="Unknown error status: "+X+" with message "+M.message),w=!0,S.a_(new x(se,ie)),m.close()}else N(we,`RPC '${e}' stream ${s} received:`,L),S.u_(L)}})),V(u,Tf.STAT_EVENT,(C=>{C.stat===sa.PROXY?N(we,`RPC '${e}' stream ${s} detected buffering proxy`):C.stat===sa.NOPROXY&&N(we,`RPC '${e}' stream ${s} detected no buffering proxy`)})),setTimeout((()=>{S.__()}),0),S}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function qo(){return typeof document<"u"?document:null}function Yi(n){return new Cv(n,!0)}class _d{constructor(e,t,r=1e3,s=1.5,i=6e4){this.Mi=e,this.timerId=t,this.d_=r,this.A_=s,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),s=Math.max(0,t-r);s>0&&N("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const Ol="PersistentStream";class yd{constructor(e,t,r,s,i,a,u,l){this.Mi=e,this.S_=r,this.b_=s,this.connection=i,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=u,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new _d(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===k.RESOURCE_EXHAUSTED?(St(t.toString()),St("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===k.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,s])=>{this.D_===t&&this.G_(r,s)}),(r=>{e((()=>{const s=new x(k.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(s)}))}))}G_(e,t){const r=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{r((()=>this.listener.Xo()))})),this.stream.t_((()=>{r((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((s=>{r((()=>this.z_(s)))})),this.stream.onMessage((s=>{r((()=>++this.F_==1?this.J_(s):this.onNext(s)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return N(Ol,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(N(Ol,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class bE extends yd{constructor(e,t,r,s,i,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,s,a),this.serializer=i}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=Dv(this.serializer,e),r=(function(i){if(!("targetChange"in i))return j.min();const a=i.targetChange;return a.targetIds&&a.targetIds.length?j.min():a.readTime?ht(a.readTime):j.min()})(e);return this.listener.H_(t,r)}Y_(e){const t={};t.database=pa(this.serializer),t.addTarget=(function(i,a){let u;const l=a.target;if(u=ua(l)?{documents:Mv(i,l)}:{query:Lv(i,l).ft},u.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){u.resumeToken=od(i,a.resumeToken);const h=ha(i,a.expectedCount);h!==null&&(u.expectedCount=h)}else if(a.snapshotVersion.compareTo(j.min())>0){u.readTime=Ii(i,a.snapshotVersion.toTimestamp());const h=ha(i,a.expectedCount);h!==null&&(u.expectedCount=h)}return u})(this.serializer,e);const r=Fv(this.serializer,e);r&&(t.labels=r),this.q_(t)}Z_(e){const t={};t.database=pa(this.serializer),t.removeTarget=e,this.q_(t)}}class SE extends yd{constructor(e,t,r,s,i,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,s,a),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return Y(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Y(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Y(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=Ov(e.writeResults,e.commitTime),r=ht(e.commitTime);return this.listener.na(r,t)}ra(){const e={};e.database=pa(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((r=>Nv(this.serializer,r)))};this.q_(t)}}class PE{}class CE extends PE{constructor(e,t,r,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new x(k.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,a])=>this.connection.Go(e,fa(t,r),s,i,a))).catch((i=>{throw i.name==="FirebaseError"?(i.code===k.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new x(k.UNKNOWN,i.toString())}))}Ho(e,t,r,s,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,u])=>this.connection.Ho(e,fa(t,r),s,a,u,i))).catch((a=>{throw a.name==="FirebaseError"?(a.code===k.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new x(k.UNKNOWN,a.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class kE{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(St(t),this.aa=!1):N("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Sn="RemoteStore";class VE{constructor(e,t,r,s,i){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo((a=>{r.enqueueAndForget((async()=>{On(this)&&(N(Sn,"Restarting streams for network reachability change."),await(async function(l){const h=q(l);h.Ea.add(4),await ws(h),h.Ra.set("Unknown"),h.Ea.delete(4),await Ji(h)})(this))}))})),this.Ra=new kE(r,s)}}async function Ji(n){if(On(n))for(const e of n.da)await e(!0)}async function ws(n){for(const e of n.da)await e(!1)}function vd(n,e){const t=q(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),oc(t)?ic(t):Er(t).O_()&&sc(t,e))}function rc(n,e){const t=q(n),r=Er(t);t.Ia.delete(e),r.O_()&&Ed(t,e),t.Ia.size===0&&(r.O_()?r.L_():On(t)&&t.Ra.set("Unknown"))}function sc(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(j.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Er(n).Y_(e)}function Ed(n,e){n.Va.Ue(e),Er(n).Z_(e)}function ic(n){n.Va=new Rv({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),Er(n).start(),n.Ra.ua()}function oc(n){return On(n)&&!Er(n).x_()&&n.Ia.size>0}function On(n){return q(n).Ea.size===0}function Td(n){n.Va=void 0}async function DE(n){n.Ra.set("Online")}async function NE(n){n.Ia.forEach(((e,t)=>{sc(n,e)}))}async function OE(n,e){Td(n),oc(n)?(n.Ra.ha(e),ic(n)):n.Ra.set("Unknown")}async function ME(n,e,t){if(n.Ra.set("Online"),e instanceof id&&e.state===2&&e.cause)try{await(async function(s,i){const a=i.cause;for(const u of i.targetIds)s.Ia.has(u)&&(await s.remoteSyncer.rejectListen(u,a),s.Ia.delete(u),s.Va.removeTarget(u))})(n,e)}catch(r){N(Sn,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Ai(n,r)}else if(e instanceof ri?n.Va.Ze(e):e instanceof sd?n.Va.st(e):n.Va.tt(e),!t.isEqual(j.min()))try{const r=await gd(n.localStore);t.compareTo(r)>=0&&await(function(i,a){const u=i.Va.Tt(a);return u.targetChanges.forEach(((l,h)=>{if(l.resumeToken.approximateByteSize()>0){const d=i.Ia.get(h);d&&i.Ia.set(h,d.withResumeToken(l.resumeToken,a))}})),u.targetMismatches.forEach(((l,h)=>{const d=i.Ia.get(l);if(!d)return;i.Ia.set(l,d.withResumeToken(Ee.EMPTY_BYTE_STRING,d.snapshotVersion)),Ed(i,l);const m=new Wt(d.target,l,h,d.sequenceNumber);sc(i,m)})),i.remoteSyncer.applyRemoteEvent(u)})(n,t)}catch(r){N(Sn,"Failed to raise snapshot:",r),await Ai(n,r)}}async function Ai(n,e,t){if(!vr(e))throw e;n.Ea.add(1),await ws(n),n.Ra.set("Offline"),t||(t=()=>gd(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{N(Sn,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await Ji(n)}))}function Id(n,e){return e().catch((t=>Ai(n,t,e)))}async function Zi(n){const e=q(n),t=on(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:$a;for(;LE(e);)try{const s=await _E(e.localStore,r);if(s===null){e.Ta.length===0&&t.L_();break}r=s.batchId,xE(e,s)}catch(s){await Ai(e,s)}wd(e)&&Ad(e)}function LE(n){return On(n)&&n.Ta.length<10}function xE(n,e){n.Ta.push(e);const t=on(n);t.O_()&&t.X_&&t.ea(e.mutations)}function wd(n){return On(n)&&!on(n).x_()&&n.Ta.length>0}function Ad(n){on(n).start()}async function FE(n){on(n).ra()}async function UE(n){const e=on(n);for(const t of n.Ta)e.ea(t.mutations)}async function BE(n,e,t){const r=n.Ta.shift(),s=Xa.from(r,e,t);await Id(n,(()=>n.remoteSyncer.applySuccessfulWrite(s))),await Zi(n)}async function jE(n,e){e&&on(n).X_&&await(async function(r,s){if((function(a){return Iv(a)&&a!==k.ABORTED})(s.code)){const i=r.Ta.shift();on(r).B_(),await Id(r,(()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s))),await Zi(r)}})(n,e),wd(n)&&Ad(n)}async function Ml(n,e){const t=q(n);t.asyncQueue.verifyOperationInProgress(),N(Sn,"RemoteStore received new credentials");const r=On(t);t.Ea.add(3),await ws(t),r&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await Ji(t)}async function qE(n,e){const t=q(n);e?(t.Ea.delete(2),await Ji(t)):e||(t.Ea.add(2),await ws(t),t.Ra.set("Unknown"))}function Er(n){return n.ma||(n.ma=(function(t,r,s){const i=q(t);return i.sa(),new bE(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)})(n.datastore,n.asyncQueue,{Xo:DE.bind(null,n),t_:NE.bind(null,n),r_:OE.bind(null,n),H_:ME.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),oc(n)?ic(n):n.Ra.set("Unknown")):(await n.ma.stop(),Td(n))}))),n.ma}function on(n){return n.fa||(n.fa=(function(t,r,s){const i=q(t);return i.sa(),new SE(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:FE.bind(null,n),r_:jE.bind(null,n),ta:UE.bind(null,n),na:BE.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await Zi(n)):(await n.fa.stop(),n.Ta.length>0&&(N(Sn,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class ac{constructor(e,t,r,s,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new vn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((a=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,s,i){const a=Date.now()+r,u=new ac(e,t,a,s,i);return u.start(r),u}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new x(k.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function cc(n,e){if(St("AsyncQueue",`${e}: ${n}`),vr(n))return new x(k.UNAVAILABLE,`${e}: ${n}`);throw n}class Yn{static emptySet(e){return new Yn(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||F.comparator(t.key,r.key):(t,r)=>F.comparator(t.key,r.key),this.keyedMap=Br(),this.sortedSet=new oe(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,r)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Yn)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new Yn;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class Ll{constructor(){this.ga=new oe(F.comparator)}track(e){const t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):U(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,r)=>{e.push(r)})),e}}class hr{constructor(e,t,r,s,i,a,u,l,h){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=a,this.syncStateChanged=u,this.excludesMetadataChanges=l,this.hasCachedResults=h}static fromInitialDocuments(e,t,r,s,i){const a=[];return t.forEach((u=>{a.push({type:0,doc:u})})),new hr(e,t,Yn.emptySet(t),a,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Wi(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==r[s].type||!t[s].doc.isEqual(r[s].doc))return!1;return!0}}class $E{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class zE{constructor(){this.queries=xl(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){const s=q(t),i=s.queries;s.queries=xl(),i.forEach(((a,u)=>{for(const l of u.Sa)l.onError(r)}))})(this,new x(k.ABORTED,"Firestore shutting down"))}}function xl(){return new Dn((n=>zf(n)),Wi)}async function HE(n,e){const t=q(n);let r=3;const s=e.query;let i=t.queries.get(s);i?!i.ba()&&e.Da()&&(r=2):(i=new $E,r=e.Da()?0:1);try{switch(r){case 0:i.wa=await t.onListen(s,!0);break;case 1:i.wa=await t.onListen(s,!1);break;case 2:await t.onFirstRemoteStoreListen(s)}}catch(a){const u=cc(a,`Initialization of query '${jn(e.query)}' failed`);return void e.onError(u)}t.queries.set(s,i),i.Sa.push(e),e.va(t.onlineState),i.wa&&e.Fa(i.wa)&&uc(t)}async function WE(n,e){const t=q(n),r=e.query;let s=3;const i=t.queries.get(r);if(i){const a=i.Sa.indexOf(e);a>=0&&(i.Sa.splice(a,1),i.Sa.length===0?s=e.Da()?0:1:!i.ba()&&e.Da()&&(s=2))}switch(s){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function GE(n,e){const t=q(n);let r=!1;for(const s of e){const i=s.query,a=t.queries.get(i);if(a){for(const u of a.Sa)u.Fa(s)&&(r=!0);a.wa=s}}r&&uc(t)}function KE(n,e,t){const r=q(n),s=r.queries.get(e);if(s)for(const i of s.Sa)i.onError(t);r.queries.delete(e)}function uc(n){n.Ca.forEach((e=>{e.next()}))}var _a,Fl;(Fl=_a||(_a={})).Ma="default",Fl.Cache="cache";class QE{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new hr(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const r=t!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=hr.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==_a.Cache}}class Rd{constructor(e){this.key=e}}class bd{constructor(e){this.key=e}}class XE{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=W(),this.mutatedKeys=W(),this.eu=Hf(e),this.tu=new Yn(this.eu)}get nu(){return this.Ya}ru(e,t){const r=t?t.iu:new Ll,s=t?t.tu:this.tu;let i=t?t.mutatedKeys:this.mutatedKeys,a=s,u=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,h=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal(((d,m)=>{const g=s.get(d),w=Gi(this.query,m)?m:null,S=!!g&&this.mutatedKeys.has(g.key),V=!!w&&(w.hasLocalMutations||this.mutatedKeys.has(w.key)&&w.hasCommittedMutations);let C=!1;g&&w?g.data.isEqual(w.data)?S!==V&&(r.track({type:3,doc:w}),C=!0):this.su(g,w)||(r.track({type:2,doc:w}),C=!0,(l&&this.eu(w,l)>0||h&&this.eu(w,h)<0)&&(u=!0)):!g&&w?(r.track({type:0,doc:w}),C=!0):g&&!w&&(r.track({type:1,doc:g}),C=!0,(l||h)&&(u=!0)),C&&(w?(a=a.add(w),i=V?i.add(d):i.delete(d)):(a=a.delete(d),i=i.delete(d)))})),this.query.limit!==null)for(;a.size>this.query.limit;){const d=this.query.limitType==="F"?a.last():a.first();a=a.delete(d.key),i=i.delete(d.key),r.track({type:1,doc:d})}return{tu:a,iu:r,Cs:u,mutatedKeys:i}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,s){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const a=e.iu.ya();a.sort(((d,m)=>(function(w,S){const V=C=>{switch(C){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return U(20277,{Rt:C})}};return V(w)-V(S)})(d.type,m.type)||this.eu(d.doc,m.doc))),this.ou(r),s=s??!1;const u=t&&!s?this._u():[],l=this.Xa.size===0&&this.current&&!s?1:0,h=l!==this.Za;return this.Za=l,a.length!==0||h?{snapshot:new hr(this.query,e.tu,i,a,e.mutatedKeys,l===0,h,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:u}:{au:u}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Ll,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=W(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))}));const t=[];return e.forEach((r=>{this.Xa.has(r)||t.push(new bd(r))})),this.Xa.forEach((r=>{e.has(r)||t.push(new Rd(r))})),t}cu(e){this.Ya=e.Qs,this.Xa=W();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return hr.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const lc="SyncEngine";class YE{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class JE{constructor(e){this.key=e,this.hu=!1}}class ZE{constructor(e,t,r,s,i,a){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new Dn((u=>zf(u)),Wi),this.Iu=new Map,this.Eu=new Set,this.du=new oe(F.comparator),this.Au=new Map,this.Ru=new Za,this.Vu={},this.mu=new Map,this.fu=lr.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function eT(n,e,t=!0){const r=Dd(n);let s;const i=r.Tu.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.lu()):s=await Sd(r,e,t,!0),s}async function tT(n,e){const t=Dd(n);await Sd(t,e,!0,!1)}async function Sd(n,e,t,r){const s=await yE(n.localStore,lt(e)),i=s.targetId,a=n.sharedClientState.addLocalQueryTarget(i,t);let u;return r&&(u=await nT(n,e,i,a==="current",s.resumeToken)),n.isPrimaryClient&&t&&vd(n.remoteStore,s),u}async function nT(n,e,t,r,s){n.pu=(m,g,w)=>(async function(V,C,L,O){let M=C.view.ru(L);M.Cs&&(M=await kl(V.localStore,C.query,!1).then((({documents:T})=>C.view.ru(T,M))));const X=O&&O.targetChanges.get(C.targetId),se=O&&O.targetMismatches.get(C.targetId)!=null,ie=C.view.applyChanges(M,V.isPrimaryClient,X,se);return Bl(V,C.targetId,ie.au),ie.snapshot})(n,m,g,w);const i=await kl(n.localStore,e,!0),a=new XE(e,i.Qs),u=a.ru(i.documents),l=Is.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",s),h=a.applyChanges(u,n.isPrimaryClient,l);Bl(n,t,h.au);const d=new YE(e,t,a);return n.Tu.set(e,d),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),h.snapshot}async function rT(n,e,t){const r=q(n),s=r.Tu.get(e),i=r.Iu.get(s.targetId);if(i.length>1)return r.Iu.set(s.targetId,i.filter((a=>!Wi(a,e)))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await ma(r.localStore,s.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(s.targetId),t&&rc(r.remoteStore,s.targetId),ya(r,s.targetId)})).catch(yr)):(ya(r,s.targetId),await ma(r.localStore,s.targetId,!0))}async function sT(n,e){const t=q(n),r=t.Tu.get(e),s=t.Iu.get(r.targetId);t.isPrimaryClient&&s.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),rc(t.remoteStore,r.targetId))}async function iT(n,e,t){const r=fT(n);try{const s=await(function(a,u){const l=q(a),h=re.now(),d=u.reduce(((w,S)=>w.add(S.key)),W());let m,g;return l.persistence.runTransaction("Locally write mutations","readwrite",(w=>{let S=Pt(),V=W();return l.Ns.getEntries(w,d).next((C=>{S=C,S.forEach(((L,O)=>{O.isValidDocument()||(V=V.add(L))}))})).next((()=>l.localDocuments.getOverlayedDocuments(w,S))).next((C=>{m=C;const L=[];for(const O of u){const M=_v(O,m.get(O.key).overlayedDocument);M!=null&&L.push(new Nn(O.key,M,xf(M.value.mapValue),Rt.exists(!0)))}return l.mutationQueue.addMutationBatch(w,h,L,u)})).next((C=>{g=C;const L=C.applyToLocalDocumentSet(m,V);return l.documentOverlayCache.saveOverlays(w,C.batchId,L)}))})).then((()=>({batchId:g.batchId,changes:Gf(m)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),(function(a,u,l){let h=a.Vu[a.currentUser.toKey()];h||(h=new oe(H)),h=h.insert(u,l),a.Vu[a.currentUser.toKey()]=h})(r,s.batchId,t),await As(r,s.changes),await Zi(r.remoteStore)}catch(s){const i=cc(s,"Failed to persist write");t.reject(i)}}async function Pd(n,e){const t=q(n);try{const r=await mE(t.localStore,e);e.targetChanges.forEach(((s,i)=>{const a=t.Au.get(i);a&&(Y(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?a.hu=!0:s.modifiedDocuments.size>0?Y(a.hu,14607):s.removedDocuments.size>0&&(Y(a.hu,42227),a.hu=!1))})),await As(t,r,e)}catch(r){await yr(r)}}function Ul(n,e,t){const r=q(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const s=[];r.Tu.forEach(((i,a)=>{const u=a.view.va(e);u.snapshot&&s.push(u.snapshot)})),(function(a,u){const l=q(a);l.onlineState=u;let h=!1;l.queries.forEach(((d,m)=>{for(const g of m.Sa)g.va(u)&&(h=!0)})),h&&uc(l)})(r.eventManager,e),s.length&&r.Pu.H_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function oT(n,e,t){const r=q(n);r.sharedClientState.updateQueryState(e,"rejected",t);const s=r.Au.get(e),i=s&&s.key;if(i){let a=new oe(F.comparator);a=a.insert(i,Se.newNoDocument(i,j.min()));const u=W().add(i),l=new Xi(j.min(),new Map,new oe(H),a,u);await Pd(r,l),r.du=r.du.remove(i),r.Au.delete(e),hc(r)}else await ma(r.localStore,e,!1).then((()=>ya(r,e,t))).catch(yr)}async function aT(n,e){const t=q(n),r=e.batch.batchId;try{const s=await pE(t.localStore,e);kd(t,r,null),Cd(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await As(t,s)}catch(s){await yr(s)}}async function cT(n,e,t){const r=q(n);try{const s=await(function(a,u){const l=q(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",(h=>{let d;return l.mutationQueue.lookupMutationBatch(h,u).next((m=>(Y(m!==null,37113),d=m.keys(),l.mutationQueue.removeMutationBatch(h,m)))).next((()=>l.mutationQueue.performConsistencyCheck(h))).next((()=>l.documentOverlayCache.removeOverlaysForBatchId(h,d,u))).next((()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,d))).next((()=>l.localDocuments.getDocuments(h,d)))}))})(r.localStore,e);kd(r,e,t),Cd(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await As(r,s)}catch(s){await yr(s)}}function Cd(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function kd(n,e,t){const r=q(n);let s=r.Vu[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(t?i.reject(t):i.resolve(),s=s.remove(e)),r.Vu[r.currentUser.toKey()]=s}}function ya(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Iu.get(e))n.Tu.delete(r),t&&n.Pu.yu(r,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((r=>{n.Ru.containsKey(r)||Vd(n,r)}))}function Vd(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(rc(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),hc(n))}function Bl(n,e,t){for(const r of t)r instanceof Rd?(n.Ru.addReference(r.key,e),uT(n,r)):r instanceof bd?(N(lc,"Document no longer in limbo: "+r.key),n.Ru.removeReference(r.key,e),n.Ru.containsKey(r.key)||Vd(n,r.key)):U(19791,{wu:r})}function uT(n,e){const t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Eu.has(r)||(N(lc,"New document in limbo: "+t),n.Eu.add(r),hc(n))}function hc(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new F(ne.fromString(e)),r=n.fu.next();n.Au.set(r,new JE(t)),n.du=n.du.insert(t,r),vd(n.remoteStore,new Wt(lt(Ka(t.path)),r,"TargetPurposeLimboResolution",qi.ce))}}async function As(n,e,t){const r=q(n),s=[],i=[],a=[];r.Tu.isEmpty()||(r.Tu.forEach(((u,l)=>{a.push(r.pu(l,e,t).then((h=>{if((h||t)&&r.isPrimaryClient){const d=h?!h.fromCache:t?.targetChanges.get(l.targetId)?.current;r.sharedClientState.updateQueryState(l.targetId,d?"current":"not-current")}if(h){s.push(h);const d=tc.As(l.targetId,h);i.push(d)}})))})),await Promise.all(a),r.Pu.H_(s),await(async function(l,h){const d=q(l);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",(m=>P.forEach(h,(g=>P.forEach(g.Es,(w=>d.persistence.referenceDelegate.addReference(m,g.targetId,w))).next((()=>P.forEach(g.ds,(w=>d.persistence.referenceDelegate.removeReference(m,g.targetId,w)))))))))}catch(m){if(!vr(m))throw m;N(nc,"Failed to update sequence numbers: "+m)}for(const m of h){const g=m.targetId;if(!m.fromCache){const w=d.Ms.get(g),S=w.snapshotVersion,V=w.withLastLimboFreeSnapshotVersion(S);d.Ms=d.Ms.insert(g,V)}}})(r.localStore,i))}async function lT(n,e){const t=q(n);if(!t.currentUser.isEqual(e)){N(lc,"User change. New user:",e.toKey());const r=await md(t.localStore,e);t.currentUser=e,(function(i,a){i.mu.forEach((u=>{u.forEach((l=>{l.reject(new x(k.CANCELLED,a))}))})),i.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await As(t,r.Ls)}}function hT(n,e){const t=q(n),r=t.Au.get(e);if(r&&r.hu)return W().add(r.key);{let s=W();const i=t.Iu.get(e);if(!i)return s;for(const a of i){const u=t.Tu.get(a);s=s.unionWith(u.view.nu)}return s}}function Dd(n){const e=q(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Pd.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=hT.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=oT.bind(null,e),e.Pu.H_=GE.bind(null,e.eventManager),e.Pu.yu=KE.bind(null,e.eventManager),e}function fT(n){const e=q(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=aT.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=cT.bind(null,e),e}class Ri{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Yi(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return dE(this.persistence,new lE,e.initialUser,this.serializer)}Cu(e){return new pd(ec.mi,this.serializer)}Du(e){return new EE}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Ri.provider={build:()=>new Ri};class dT extends Ri{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Y(this.persistence.referenceDelegate instanceof wi,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new Qv(r,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?Le.withCacheSize(this.cacheSizeBytes):Le.DEFAULT;return new pd((r=>wi.mi(r,t)),this.serializer)}}class va{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Ul(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=lT.bind(null,this.syncEngine),await qE(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new zE})()}createDatastore(e){const t=Yi(e.databaseInfo.databaseId),r=(function(i){return new RE(i)})(e.databaseInfo);return(function(i,a,u,l){return new CE(i,a,u,l)})(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return(function(r,s,i,a,u){return new VE(r,s,i,a,u)})(this.localStore,this.datastore,e.asyncQueue,(t=>Ul(this.syncEngine,t,0)),(function(){return Nl.v()?new Nl:new TE})())}createSyncEngine(e,t){return(function(s,i,a,u,l,h,d){const m=new ZE(s,i,a,u,l,h);return d&&(m.gu=!0),m})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const r=q(t);N(Sn,"RemoteStore shutting down."),r.Ea.add(5),await ws(r),r.Aa.shutdown(),r.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}va.provider={build:()=>new va};class pT{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):St("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const an="FirestoreClient";class mT{constructor(e,t,r,s,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=s,this.user=Re.UNAUTHENTICATED,this.clientId=ja.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,(async a=>{N(an,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a})),this.appCheckCredentials.start(r,(a=>(N(an,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new vn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=cc(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function $o(n,e){n.asyncQueue.verifyOperationInProgress(),N(an,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener((async s=>{r.isEqual(s)||(await md(e.localStore,s),r=s)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function jl(n,e){n.asyncQueue.verifyOperationInProgress();const t=await gT(n);N(an,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((r=>Ml(e.remoteStore,r))),n.setAppCheckTokenChangeListener(((r,s)=>Ml(e.remoteStore,s))),n._onlineComponents=e}async function gT(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){N(an,"Using user provided OfflineComponentProvider");try{await $o(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(s){return s.name==="FirebaseError"?s.code===k.FAILED_PRECONDITION||s.code===k.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11})(t))throw t;or("Error using user provided cache. Falling back to memory cache: "+t),await $o(n,new Ri)}}else N(an,"Using default OfflineComponentProvider"),await $o(n,new dT(void 0));return n._offlineComponents}async function Nd(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(N(an,"Using user provided OnlineComponentProvider"),await jl(n,n._uninitializedComponentsProvider._online)):(N(an,"Using default OnlineComponentProvider"),await jl(n,new va))),n._onlineComponents}function _T(n){return Nd(n).then((e=>e.syncEngine))}async function ql(n){const e=await Nd(n),t=e.eventManager;return t.onListen=eT.bind(null,e.syncEngine),t.onUnlisten=rT.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=tT.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=sT.bind(null,e.syncEngine),t}function Od(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const $l=new Map;const Md="firestore.googleapis.com",zl=!0;class Hl{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new x(k.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Md,this.ssl=zl}else this.host=e.host,this.ssl=e.ssl??zl;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=dd;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<Gv)throw new x(k.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}ky("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Od(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new x(k.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new x(k.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new x(k.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,s){return r.timeoutSeconds===s.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class eo{constructor(e,t,r,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Hl({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new x(k.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new x(k.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Hl(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new Ey;switch(r.type){case"firstParty":return new Ay(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new x(k.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const r=$l.get(t);r&&(N("ComponentProvider","Removing Datastore"),$l.delete(t),r.terminate())})(this),Promise.resolve()}}function yT(n,e,t,r={}){n=Gr(n,eo);const s=mr(e),i=n._getSettings(),a={...i,emulatorOptions:n._getEmulatorOptions()},u=`${e}:${t}`;s&&(lf(`https://${u}`),hf("Firestore",!0)),i.host!==Md&&i.host!==u&&or("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...i,host:u,ssl:s,emulatorOptions:r};if(!An(l,a)&&(n._setSettings(l),r.mockUserToken)){let h,d;if(typeof r.mockUserToken=="string")h=r.mockUserToken,d=Re.MOCK_USER;else{h=Hg(r.mockUserToken,n._app?.options.projectId);const m=r.mockUserToken.sub||r.mockUserToken.user_id;if(!m)throw new x(k.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new Re(m)}n._authCredentials=new Ty(new Rf(h,d))}}class to{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new to(this.firestore,e,this._query)}}class _e{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new en(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new _e(this.firestore,e,this._key)}toJSON(){return{type:_e._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(Es(t,_e._jsonSchema))return new _e(e,r||null,new F(ne.fromString(t.referencePath)))}}_e._jsonSchemaVersion="firestore/documentReference/1.0",_e._jsonSchema={type:he("string",_e._jsonSchemaVersion),referencePath:he("string")};class en extends to{constructor(e,t,r){super(e,t,Ka(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new _e(this.firestore,null,new F(e))}withConverter(e){return new en(this.firestore,e,this._path)}}function Ld(n,e,...t){if(n=Ue(n),bf("collection","path",e),n instanceof eo){const r=ne.fromString(e,...t);return sl(r),new en(n,null,r)}{if(!(n instanceof _e||n instanceof en))throw new x(k.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(ne.fromString(e,...t));return sl(r),new en(n.firestore,null,r)}}function vT(n,e,...t){if(n=Ue(n),arguments.length===1&&(e=ja.newId()),bf("doc","path",e),n instanceof eo){const r=ne.fromString(e,...t);return rl(r),new _e(n,null,new F(r))}{if(!(n instanceof _e||n instanceof en))throw new x(k.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(ne.fromString(e,...t));return rl(r),new _e(n.firestore,n instanceof en?n.converter:null,new F(r))}}const Wl="AsyncQueue";class Gl{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new _d(this,"async_queue_retry"),this._c=()=>{const r=qo();r&&N(Wl,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const t=qo();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=qo();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new vn;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!vr(e))throw e;N(Wl,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((r=>{throw this.nc=r,this.rc=!1,St("INTERNAL UNHANDLED ERROR: ",Kl(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const s=ac.createAndSchedule(this,e,t,r,(i=>this.hc(i)));return this.tc.push(s),s}uc(){this.nc&&U(47125,{Pc:Kl(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,r)=>t.targetTimeMs-r.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function Kl(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}function Ql(n){return(function(t,r){if(typeof t!="object"||t===null)return!1;const s=t;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1})(n,["next","error","complete"])}class bi extends eo{constructor(e,t,r,s){super(e,t,r,s),this.type="firestore",this._queue=new Gl,this._persistenceKey=s?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Gl(e),this._firestoreClient=void 0,await e}}}function ET(n,e){const t=typeof n=="object"?n:mf(),r=typeof n=="string"?n:gi,s=Ua(t,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=$g("firestore");i&&yT(s,...i)}return s}function xd(n){if(n._terminated)throw new x(k.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||TT(n),n._firestoreClient}function TT(n){const e=n._freezeSettings(),t=(function(s,i,a,u){return new jy(s,i,a,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,Od(u.experimentalLongPollingOptions),u.useFetchStreams,u.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new mT(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(s){const i=s?._online.build();return{_offline:s?._offline.build(i),_online:i}})(n._componentsProvider))}class We{constructor(e){this._byteString=e}static fromBase64String(e){try{return new We(Ee.fromBase64String(e))}catch(t){throw new x(k.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new We(Ee.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:We._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Es(e,We._jsonSchema))return We.fromBase64String(e.bytes)}}We._jsonSchemaVersion="firestore/bytes/1.0",We._jsonSchema={type:he("string",We._jsonSchemaVersion),bytes:he("string")};class fc{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new x(k.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ve(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Fd{constructor(e){this._methodName=e}}class ft{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new x(k.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new x(k.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return H(this._lat,e._lat)||H(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:ft._jsonSchemaVersion}}static fromJSON(e){if(Es(e,ft._jsonSchema))return new ft(e.latitude,e.longitude)}}ft._jsonSchemaVersion="firestore/geoPoint/1.0",ft._jsonSchema={type:he("string",ft._jsonSchemaVersion),latitude:he("number"),longitude:he("number")};class dt{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0})(this._values,e._values)}toJSON(){return{type:dt._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Es(e,dt._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new dt(e.vectorValues);throw new x(k.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}dt._jsonSchemaVersion="firestore/vectorValue/1.0",dt._jsonSchema={type:he("string",dt._jsonSchemaVersion),vectorValues:he("object")};const IT=/^__.*__$/;class wT{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Nn(e,this.data,this.fieldMask,t,this.fieldTransforms):new Ts(e,this.data,t,this.fieldTransforms)}}function Ud(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw U(40011,{Ac:n})}}class dc{constructor(e,t,r,s,i,a){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new dc({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.gc(e),r}yc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Si(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(Ud(this.Ac)&&IT.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class AT{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Yi(e)}Cc(e,t,r,s=!1){return new dc({Ac:e,methodName:t,Dc:r,path:ve.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function RT(n){const e=n._freezeSettings(),t=Yi(n._databaseId);return new AT(n._databaseId,!!e.ignoreUndefinedProperties,t)}function bT(n,e,t,r,s,i={}){const a=n.Cc(i.merge||i.mergeFields?2:0,e,t,s);$d("Data must be an object, but it was:",a,r);const u=jd(r,a);let l,h;if(i.merge)l=new Je(a.fieldMask),h=a.fieldTransforms;else if(i.mergeFields){const d=[];for(const m of i.mergeFields){const g=ST(e,m,t);if(!a.contains(g))throw new x(k.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);CT(d,g)||d.push(g)}l=new Je(d),h=a.fieldTransforms.filter((m=>l.covers(m.field)))}else l=null,h=a.fieldTransforms;return new wT(new He(u),l,h)}function Bd(n,e){if(qd(n=Ue(n)))return $d("Unsupported field value:",e,n),jd(n,e);if(n instanceof Fd)return(function(r,s){if(!Ud(s.Ac))throw s.Sc(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(r,s){const i=[];let a=0;for(const u of r){let l=Bd(u,s.wc(a));l==null&&(l={nullValue:"NULL_VALUE"}),i.push(l),a++}return{arrayValue:{values:i}}})(n,e)}return(function(r,s){if((r=Ue(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return hv(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=re.fromDate(r);return{timestampValue:Ii(s.serializer,i)}}if(r instanceof re){const i=new re(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Ii(s.serializer,i)}}if(r instanceof ft)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof We)return{bytesValue:od(s.serializer,r._byteString)};if(r instanceof _e){const i=s.databaseId,a=r.firestore._databaseId;if(!a.isEqual(i))throw s.Sc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Ja(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof dt)return(function(a,u){return{mapValue:{fields:{[Mf]:{stringValue:Lf},[_i]:{arrayValue:{values:a.toArray().map((h=>{if(typeof h!="number")throw u.Sc("VectorValues must only contain numeric values.");return Qa(u.serializer,h)}))}}}}}})(r,s);throw s.Sc(`Unsupported field value: ${qa(r)}`)})(n,e)}function jd(n,e){const t={};return Cf(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Vn(n,((r,s)=>{const i=Bd(s,e.mc(r));i!=null&&(t[r]=i)})),{mapValue:{fields:t}}}function qd(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof re||n instanceof ft||n instanceof We||n instanceof _e||n instanceof Fd||n instanceof dt)}function $d(n,e,t){if(!qd(t)||!Sf(t)){const r=qa(t);throw r==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+r)}}function ST(n,e,t){if((e=Ue(e))instanceof fc)return e._internalPath;if(typeof e=="string")return zd(n,e);throw Si("Field path arguments must be of type string or ",n,!1,void 0,t)}const PT=new RegExp("[~\\*/\\[\\]]");function zd(n,e,t){if(e.search(PT)>=0)throw Si(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new fc(...e.split("."))._internalPath}catch{throw Si(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Si(n,e,t,r,s){const i=r&&!r.isEmpty(),a=s!==void 0;let u=`Function ${e}() called with invalid data`;t&&(u+=" (via `toFirestore()`)"),u+=". ";let l="";return(i||a)&&(l+=" (found",i&&(l+=` in field ${r}`),a&&(l+=` in document ${s}`),l+=")"),new x(k.INVALID_ARGUMENT,u+n+l)}function CT(n,e){return n.some((t=>t.isEqual(e)))}class Hd{constructor(e,t,r,s,i){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new _e(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new kT(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Wd("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class kT extends Hd{data(){return super.data()}}function Wd(n,e){return typeof e=="string"?zd(n,e):e instanceof fc?e._internalPath:e._delegate._internalPath}function VT(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new x(k.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class DT{convertValue(e,t="none"){switch(sn(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ce(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(rn(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw U(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return Vn(e,((s,i)=>{r[s]=this.convertValue(i,t)})),r}convertVectorValue(e){const t=e.fields?.[_i].arrayValue?.values?.map((r=>ce(r.doubleValue)));return new dt(t)}convertGeoPoint(e){return new ft(ce(e.latitude),ce(e.longitude))}convertArray(e,t){return(e.values||[]).map((r=>this.convertValue(r,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const r=zi(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(os(e));default:return null}}convertTimestamp(e){const t=nn(e);return new re(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=ne.fromString(e);Y(fd(r),9688,{name:e});const s=new as(r.get(1),r.get(3)),i=new F(r.popFirst(5));return s.isEqual(t)||St(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}function NT(n,e,t){let r;return r=n?n.toFirestore(e):e,r}class qr{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class En extends Hd{constructor(e,t,r,s,i,a){super(e,t,r,s,a),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new si(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(Wd("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new x(k.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=En._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}En._jsonSchemaVersion="firestore/documentSnapshot/1.0",En._jsonSchema={type:he("string",En._jsonSchemaVersion),bundleSource:he("string","DocumentSnapshot"),bundleName:he("string"),bundle:he("string")};class si extends En{data(e={}){return super.data(e)}}class Jn{constructor(e,t,r,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new qr(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((r=>{e.call(t,new si(this._firestore,this._userDataWriter,r.key,r,new qr(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new x(k.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(s,i){if(s._snapshot.oldDocs.isEmpty()){let a=0;return s._snapshot.docChanges.map((u=>{const l=new si(s._firestore,s._userDataWriter,u.doc.key,u.doc,new qr(s._snapshot.mutatedKeys.has(u.doc.key),s._snapshot.fromCache),s.query.converter);return u.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}}))}{let a=s._snapshot.oldDocs;return s._snapshot.docChanges.filter((u=>i||u.type!==3)).map((u=>{const l=new si(s._firestore,s._userDataWriter,u.doc.key,u.doc,new qr(s._snapshot.mutatedKeys.has(u.doc.key),s._snapshot.fromCache),s.query.converter);let h=-1,d=-1;return u.type!==0&&(h=a.indexOf(u.doc.key),a=a.delete(u.doc.key)),u.type!==1&&(a=a.add(u.doc),d=a.indexOf(u.doc.key)),{type:OT(u.type),doc:l,oldIndex:h,newIndex:d}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new x(k.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Jn._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=ja.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],s=[];return this.docs.forEach((i=>{i._document!==null&&(t.push(i._document),r.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),s.push(i.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function OT(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return U(61501,{type:n})}}Jn._jsonSchemaVersion="firestore/querySnapshot/1.0",Jn._jsonSchema={type:he("string",Jn._jsonSchemaVersion),bundleSource:he("string","QuerySnapshot"),bundleName:he("string"),bundle:he("string")};class Gd extends DT{constructor(e){super(),this.firestore=e}convertBytes(e){return new We(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new _e(this.firestore,null,t)}}function MT(n,e){const t=Gr(n.firestore,bi),r=vT(n),s=NT(n.converter,e);return xT(t,[bT(RT(n.firestore),"addDoc",r._key,s,n.converter!==null,{}).toMutation(r._key,Rt.exists(!1))]).then((()=>r))}function LT(n,...e){n=Ue(n);let t={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||Ql(e[r])||(t=e[r++]);const s={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(Ql(e[r])){const l=e[r];e[r]=l.next?.bind(l),e[r+1]=l.error?.bind(l),e[r+2]=l.complete?.bind(l)}let i,a,u;if(n instanceof _e)a=Gr(n.firestore,bi),u=Ka(n._key.path),i={next:l=>{e[r]&&e[r](FT(a,n,l))},error:e[r+1],complete:e[r+2]};else{const l=Gr(n,to);a=Gr(l.firestore,bi),u=l._query;const h=new Gd(a);i={next:d=>{e[r]&&e[r](new Jn(a,h,l,d))},error:e[r+1],complete:e[r+2]},VT(n._query)}return(function(h,d,m,g){const w=new pT(g),S=new QE(d,w,m);return h.asyncQueue.enqueueAndForget((async()=>HE(await ql(h),S))),()=>{w.Nu(),h.asyncQueue.enqueueAndForget((async()=>WE(await ql(h),S)))}})(xd(a),u,s,i)}function xT(n,e){return(function(r,s){const i=new vn;return r.asyncQueue.enqueueAndForget((async()=>iT(await _T(r),s,i))),i.promise})(xd(n),e)}function FT(n,e,t){const r=t.docs.get(e._key),s=new Gd(n);return new En(n,s,e._key,r,new qr(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(s){_r=s})(gr),ir(new Rn("firestore",((r,{instanceIdentifier:s,options:i})=>{const a=r.getProvider("app").getImmediate(),u=new bi(new Iy(r.getProvider("auth-internal")),new Ry(a,r.getProvider("app-check-internal")),(function(h,d){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new x(k.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new as(h.options.projectId,d)})(a,s),a);return i={useFetchStreams:t,...i},u._setSettings(i),u}),"PUBLIC").setMultipleInstances(!0)),Jt(Zu,el,e),Jt(Zu,el,"esm2020")})();function Kd(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const UT=Kd,Qd=new ys("auth","Firebase",Kd());const Pi=new xa("@firebase/auth");function BT(n,...e){Pi.logLevel<=z.WARN&&Pi.warn(`Auth (${gr}): ${n}`,...e)}function ii(n,...e){Pi.logLevel<=z.ERROR&&Pi.error(`Auth (${gr}): ${n}`,...e)}function yt(n,...e){throw mc(n,...e)}function tt(n,...e){return mc(n,...e)}function pc(n,e,t){const r={...UT(),[e]:t};return new ys("auth","Firebase",r).create(e,{appName:n.name})}function Tn(n){return pc(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function jT(n,e,t){const r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&yt(n,"argument-error"),pc(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function mc(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return Qd.create(n,...e)}function B(n,e,...t){if(!n)throw mc(e,...t)}function It(n){const e="INTERNAL ASSERTION FAILED: "+n;throw ii(e),new Error(e)}function Ct(n,e){n||It(e)}function Ea(){return typeof self<"u"&&self.location?.href||""}function qT(){return Xl()==="http:"||Xl()==="https:"}function Xl(){return typeof self<"u"&&self.location?.protocol||null}function $T(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(qT()||Yg()||"connection"in navigator)?navigator.onLine:!0}function zT(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class Rs{constructor(e,t){this.shortDelay=e,this.longDelay=t,Ct(t>e,"Short delay should be less than long delay!"),this.isMobile=Kg()||Jg()}get(){return $T()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function gc(n,e){Ct(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class Xd{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;It("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;It("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;It("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const HT={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const WT=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],GT=new Rs(3e4,6e4);function _c(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Tr(n,e,t,r,s={}){return Yd(n,s,async()=>{let i={},a={};r&&(e==="GET"?a=r:i={body:JSON.stringify(r)});const u=vs({key:n.config.apiKey,...a}).slice(1),l=await n._getAdditionalHeaders();l["Content-Type"]="application/json",n.languageCode&&(l["X-Firebase-Locale"]=n.languageCode);const h={method:e,headers:l,...i};return Xg()||(h.referrerPolicy="no-referrer"),n.emulatorConfig&&mr(n.emulatorConfig.host)&&(h.credentials="include"),Xd.fetch()(await Jd(n,n.config.apiHost,t,u),h)})}async function Yd(n,e,t){n._canInitEmulator=!1;const r={...HT,...e};try{const s=new QT(n),i=await Promise.race([t(),s.promise]);s.clearNetworkTimeout();const a=await i.json();if("needConfirmation"in a)throw Xs(n,"account-exists-with-different-credential",a);if(i.ok&&!("errorMessage"in a))return a;{const u=i.ok?a.errorMessage:a.error.message,[l,h]=u.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Xs(n,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw Xs(n,"email-already-in-use",a);if(l==="USER_DISABLED")throw Xs(n,"user-disabled",a);const d=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw pc(n,d,h);yt(n,d)}}catch(s){if(s instanceof Ot)throw s;yt(n,"network-request-failed",{message:String(s)})}}async function KT(n,e,t,r,s={}){const i=await Tr(n,e,t,r,s);return"mfaPendingCredential"in i&&yt(n,"multi-factor-auth-required",{_serverResponse:i}),i}async function Jd(n,e,t,r){const s=`${e}${t}?${r}`,i=n,a=i.config.emulator?gc(n.config,s):`${n.config.apiScheme}://${s}`;return WT.includes(t)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(a).toString():a}class QT{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(tt(this.auth,"network-request-failed")),GT.get())})}}function Xs(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const s=tt(n,e,r);return s.customData._tokenResponse=t,s}async function XT(n,e){return Tr(n,"POST","/v1/accounts:delete",e)}async function Ci(n,e){return Tr(n,"POST","/v1/accounts:lookup",e)}function Jr(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function YT(n,e=!1){const t=Ue(n),r=await t.getIdToken(e),s=yc(r);B(s&&s.exp&&s.auth_time&&s.iat,t.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,a=i?.sign_in_provider;return{claims:s,token:r,authTime:Jr(zo(s.auth_time)),issuedAtTime:Jr(zo(s.iat)),expirationTime:Jr(zo(s.exp)),signInProvider:a||null,signInSecondFactor:i?.sign_in_second_factor||null}}function zo(n){return Number(n)*1e3}function yc(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return ii("JWT malformed, contained fewer than 3 sections"),null;try{const s=of(t);return s?JSON.parse(s):(ii("Failed to decode base64 JWT payload"),null)}catch(s){return ii("Caught error parsing JWT payload as JSON",s?.toString()),null}}function Yl(n){const e=yc(n);return B(e,"internal-error"),B(typeof e.exp<"u","internal-error"),B(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function hs(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof Ot&&JT(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function JT({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class ZT{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class Ta{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Jr(this.lastLoginAt),this.creationTime=Jr(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function ki(n){const e=n.auth,t=await n.getIdToken(),r=await hs(n,Ci(e,{idToken:t}));B(r?.users.length,e,"internal-error");const s=r.users[0];n._notifyReloadListener(s);const i=s.providerUserInfo?.length?Zd(s.providerUserInfo):[],a=tI(n.providerData,i),u=n.isAnonymous,l=!(n.email&&s.passwordHash)&&!a?.length,h=u?l:!1,d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new Ta(s.createdAt,s.lastLoginAt),isAnonymous:h};Object.assign(n,d)}async function eI(n){const e=Ue(n);await ki(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function tI(n,e){return[...n.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function Zd(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function nI(n,e){const t=await Yd(n,{},async()=>{const r=vs({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=n.config,a=await Jd(n,s,"/v1/token",`key=${i}`),u=await n._getAdditionalHeaders();u["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:u,body:r};return n.emulatorConfig&&mr(n.emulatorConfig.host)&&(l.credentials="include"),Xd.fetch()(a,l)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function rI(n,e){return Tr(n,"POST","/v2/accounts:revokeToken",_c(n,e))}class Zn{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){B(e.idToken,"internal-error"),B(typeof e.idToken<"u","internal-error"),B(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Yl(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){B(e.length!==0,"internal-error");const t=Yl(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(B(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:s,expiresIn:i}=await nI(e,t);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:s,expirationTime:i}=t,a=new Zn;return r&&(B(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),s&&(B(typeof s=="string","internal-error",{appName:e}),a.accessToken=s),i&&(B(typeof i=="number","internal-error",{appName:e}),a.expirationTime=i),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Zn,this.toJSON())}_performRefresh(){return It("not implemented")}}function qt(n,e){B(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Ze{constructor({uid:e,auth:t,stsTokenManager:r,...s}){this.providerId="firebase",this.proactiveRefresh=new ZT(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Ta(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await hs(this,this.stsTokenManager.getToken(this.auth,e));return B(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return YT(this,e)}reload(){return eI(this)}_assign(e){this!==e&&(B(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Ze({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){B(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await ki(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Ye(this.auth.app))return Promise.reject(Tn(this.auth));const e=await this.getIdToken();return await hs(this,XT(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const r=t.displayName??void 0,s=t.email??void 0,i=t.phoneNumber??void 0,a=t.photoURL??void 0,u=t.tenantId??void 0,l=t._redirectEventId??void 0,h=t.createdAt??void 0,d=t.lastLoginAt??void 0,{uid:m,emailVerified:g,isAnonymous:w,providerData:S,stsTokenManager:V}=t;B(m&&V,e,"internal-error");const C=Zn.fromJSON(this.name,V);B(typeof m=="string",e,"internal-error"),qt(r,e.name),qt(s,e.name),B(typeof g=="boolean",e,"internal-error"),B(typeof w=="boolean",e,"internal-error"),qt(i,e.name),qt(a,e.name),qt(u,e.name),qt(l,e.name),qt(h,e.name),qt(d,e.name);const L=new Ze({uid:m,auth:e,email:s,emailVerified:g,displayName:r,isAnonymous:w,photoURL:a,phoneNumber:i,tenantId:u,stsTokenManager:C,createdAt:h,lastLoginAt:d});return S&&Array.isArray(S)&&(L.providerData=S.map(O=>({...O}))),l&&(L._redirectEventId=l),L}static async _fromIdTokenResponse(e,t,r=!1){const s=new Zn;s.updateFromServerResponse(t);const i=new Ze({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await ki(i),i}static async _fromGetAccountInfoResponse(e,t,r){const s=t.users[0];B(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?Zd(s.providerUserInfo):[],a=!(s.email&&s.passwordHash)&&!i?.length,u=new Zn;u.updateFromIdToken(r);const l=new Ze({uid:s.localId,auth:e,stsTokenManager:u,isAnonymous:a}),h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new Ta(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!i?.length};return Object.assign(l,h),l}}const Jl=new Map;function wt(n){Ct(n instanceof Function,"Expected a class definition");let e=Jl.get(n);return e?(Ct(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Jl.set(n,e),e)}class ep{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}ep.type="NONE";const Zl=ep;function oi(n,e,t){return`firebase:${n}:${e}:${t}`}class er{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=oi(this.userKey,s.apiKey,i),this.fullPersistenceKey=oi("persistence",s.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Ci(this.auth,{idToken:e}).catch(()=>{});return t?Ze._fromGetAccountInfoResponse(this.auth,t,e):null}return Ze._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new er(wt(Zl),e,r);const s=(await Promise.all(t.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let i=s[0]||wt(Zl);const a=oi(r,e.config.apiKey,e.name);let u=null;for(const h of t)try{const d=await h._get(a);if(d){let m;if(typeof d=="string"){const g=await Ci(e,{idToken:d}).catch(()=>{});if(!g)break;m=await Ze._fromGetAccountInfoResponse(e,g,d)}else m=Ze._fromJSON(e,d);h!==i&&(u=m),i=h;break}}catch{}const l=s.filter(h=>h._shouldAllowMigration);return!i._shouldAllowMigration||!l.length?new er(i,e,r):(i=l[0],u&&await i._set(a,u.toJSON()),await Promise.all(t.map(async h=>{if(h!==i)try{await h._remove(a)}catch{}})),new er(i,e,r))}}function eh(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(sp(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(tp(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(op(e))return"Blackberry";if(ap(e))return"Webos";if(np(e))return"Safari";if((e.includes("chrome/")||rp(e))&&!e.includes("edge/"))return"Chrome";if(ip(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function tp(n=Ve()){return/firefox\//i.test(n)}function np(n=Ve()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function rp(n=Ve()){return/crios\//i.test(n)}function sp(n=Ve()){return/iemobile/i.test(n)}function ip(n=Ve()){return/android/i.test(n)}function op(n=Ve()){return/blackberry/i.test(n)}function ap(n=Ve()){return/webos/i.test(n)}function vc(n=Ve()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function sI(n=Ve()){return vc(n)&&!!window.navigator?.standalone}function iI(){return Zg()&&document.documentMode===10}function cp(n=Ve()){return vc(n)||ip(n)||ap(n)||op(n)||/windows phone/i.test(n)||sp(n)}function up(n,e=[]){let t;switch(n){case"Browser":t=eh(Ve());break;case"Worker":t=`${eh(Ve())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${gr}/${r}`}class oI{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=i=>new Promise((a,u)=>{try{const l=e(i);a(l)}catch(l){u(l)}});r.onAbort=t,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const s of t)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}}async function aI(n,e={}){return Tr(n,"GET","/v2/passwordPolicy",_c(n,e))}const cI=6;class uI{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??cI,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),s&&(t.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}class lI{constructor(e,t,r,s){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new th(this),this.idTokenSubscription=new th(this),this.beforeStateQueue=new oI(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Qd,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=wt(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await er.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Ci(this,{idToken:e}),r=await Ze._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Ye(this.app)){const i=this.app.settings.authIdToken;return i?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(i).then(a,a))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let r=t,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const i=this.redirectUser?._redirectEventId,a=r?._redirectEventId,u=await this.tryRedirectSignIn(e);(!i||i===a)&&u?.user&&(r=u.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(i){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(i))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return B(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await ki(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=zT()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Ye(this.app))return Promise.reject(Tn(this));const t=e?Ue(e):null;return t&&B(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&B(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Ye(this.app)?Promise.reject(Tn(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Ye(this.app)?Promise.reject(Tn(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(wt(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await aI(this),t=new uI(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new ys("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await rI(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&wt(e)||this._popupRedirectResolver;B(t,this,"argument-error"),this.redirectPersistenceManager=await er.create(this,[wt(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,s){if(this._deleted)return()=>{};const i=typeof t=="function"?t:t.next.bind(t);let a=!1;const u=this._isInitialized?Promise.resolve():this._initializationPromise;if(B(u,this,"internal-error"),u.then(()=>{a||i(this.currentUser)}),typeof t=="function"){const l=e.addObserver(t,r,s);return()=>{a=!0,l()}}else{const l=e.addObserver(t);return()=>{a=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return B(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=up(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(Ye(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&BT(`Error while retrieving App Check token: ${e.error}`),e?.token}}function no(n){return Ue(n)}class th{constructor(e){this.auth=e,this.observer=null,this.addObserver=a_(t=>this.observer=t)}get next(){return B(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Ec={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function hI(n){Ec=n}function fI(n){return Ec.loadJS(n)}function dI(){return Ec.gapiScript}function pI(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function mI(n,e){const t=Ua(n,"auth");if(t.isInitialized()){const s=t.getImmediate(),i=t.getOptions();if(An(i,e??{}))return s;yt(s,"already-initialized")}return t.initialize({options:e})}function gI(n,e){const t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(wt);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function _I(n,e,t){const r=no(n);B(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=lp(e),{host:a,port:u}=yI(e),l=u===null?"":`:${u}`,h={url:`${i}//${a}${l}/`},d=Object.freeze({host:a,port:u,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){B(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),B(An(h,r.config.emulator)&&An(d,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=h,r.emulatorConfig=d,r.settings.appVerificationDisabledForTesting=!0,mr(a)?(lf(`${i}//${a}${l}`),hf("Auth",!0)):vI()}function lp(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function yI(n){const e=lp(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:nh(r.substr(i.length+1))}}else{const[i,a]=r.split(":");return{host:i,port:nh(a)}}}function nh(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function vI(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class hp{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return It("not implemented")}_getIdTokenResponse(e){return It("not implemented")}_linkToIdToken(e,t){return It("not implemented")}_getReauthenticationResolver(e){return It("not implemented")}}async function tr(n,e){return KT(n,"POST","/v1/accounts:signInWithIdp",_c(n,e))}const EI="http://localhost";class Pn extends hp{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Pn(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):yt("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,...i}=t;if(!r||!s)return null;const a=new Pn(r,s);return a.idToken=i.idToken||void 0,a.accessToken=i.accessToken||void 0,a.secret=i.secret,a.nonce=i.nonce,a.pendingToken=i.pendingToken||null,a}_getIdTokenResponse(e){const t=this.buildRequest();return tr(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,tr(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,tr(e,t)}buildRequest(){const e={requestUri:EI,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=vs(t)}return e}}class Tc{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class bs extends Tc{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class $t extends bs{constructor(){super("facebook.com")}static credential(e){return Pn._fromParams({providerId:$t.PROVIDER_ID,signInMethod:$t.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return $t.credentialFromTaggedObject(e)}static credentialFromError(e){return $t.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return $t.credential(e.oauthAccessToken)}catch{return null}}}$t.FACEBOOK_SIGN_IN_METHOD="facebook.com";$t.PROVIDER_ID="facebook.com";class Tt extends bs{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Pn._fromParams({providerId:Tt.PROVIDER_ID,signInMethod:Tt.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Tt.credentialFromTaggedObject(e)}static credentialFromError(e){return Tt.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return Tt.credential(t,r)}catch{return null}}}Tt.GOOGLE_SIGN_IN_METHOD="google.com";Tt.PROVIDER_ID="google.com";class zt extends bs{constructor(){super("github.com")}static credential(e){return Pn._fromParams({providerId:zt.PROVIDER_ID,signInMethod:zt.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return zt.credentialFromTaggedObject(e)}static credentialFromError(e){return zt.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return zt.credential(e.oauthAccessToken)}catch{return null}}}zt.GITHUB_SIGN_IN_METHOD="github.com";zt.PROVIDER_ID="github.com";class Ht extends bs{constructor(){super("twitter.com")}static credential(e,t){return Pn._fromParams({providerId:Ht.PROVIDER_ID,signInMethod:Ht.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Ht.credentialFromTaggedObject(e)}static credentialFromError(e){return Ht.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return Ht.credential(t,r)}catch{return null}}}Ht.TWITTER_SIGN_IN_METHOD="twitter.com";Ht.PROVIDER_ID="twitter.com";class fr{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,s=!1){const i=await Ze._fromIdTokenResponse(e,r,s),a=rh(r);return new fr({user:i,providerId:a,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const s=rh(r);return new fr({user:e,providerId:s,_tokenResponse:r,operationType:t})}}function rh(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class Vi extends Ot{constructor(e,t,r,s){super(t.code,t.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,Vi.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,s){return new Vi(e,t,r,s)}}function fp(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Vi._fromErrorAndOperation(n,i,e,r):i})}async function TI(n,e,t=!1){const r=await hs(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return fr._forOperation(n,"link",r)}async function II(n,e,t=!1){const{auth:r}=n;if(Ye(r.app))return Promise.reject(Tn(r));const s="reauthenticate";try{const i=await hs(n,fp(r,s,e,n),t);B(i.idToken,r,"internal-error");const a=yc(i.idToken);B(a,r,"internal-error");const{sub:u}=a;return B(n.uid===u,r,"user-mismatch"),fr._forOperation(n,s,i)}catch(i){throw i?.code==="auth/user-not-found"&&yt(r,"user-mismatch"),i}}async function wI(n,e,t=!1){if(Ye(n.app))return Promise.reject(Tn(n));const r="signIn",s=await fp(n,r,e),i=await fr._fromIdTokenResponse(n,r,s);return t||await n._updateCurrentUser(i.user),i}function AI(n,e,t,r){return Ue(n).onIdTokenChanged(e,t,r)}function RI(n,e,t){return Ue(n).beforeAuthStateChanged(e,t)}function bI(n,e,t,r){return Ue(n).onAuthStateChanged(e,t,r)}function SI(n){return Ue(n).signOut()}const Di="__sak";class dp{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Di,"1"),this.storage.removeItem(Di),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const PI=1e3,CI=10;class pp extends dp{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=cp(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),s=this.localCache[t];r!==s&&e(t,s,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((a,u,l)=>{this.notifyListeners(a,l)});return}const r=e.key;t?this.detachListener():this.stopPolling();const s=()=>{const a=this.storage.getItem(r);!t&&this.localCache[r]===a||this.notifyListeners(r,a)},i=this.storage.getItem(r);iI()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,CI):s()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},PI)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}pp.type="LOCAL";const kI=pp;class mp extends dp{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}mp.type="SESSION";const gp=mp;function VI(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class ro{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(s=>s.isListeningto(e));if(t)return t;const r=new ro(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:s,data:i}=t.data,a=this.handlersMap[s];if(!a?.size)return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const u=Array.from(a).map(async h=>h(t.origin,i)),l=await VI(u);t.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:l})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}ro.receivers=[];function Ic(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}class DI{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,a;return new Promise((u,l)=>{const h=Ic("",20);s.port1.start();const d=setTimeout(()=>{l(new Error("unsupported_event"))},r);a={messageChannel:s,onMessage(m){const g=m;if(g.data.eventId===h)switch(g.data.status){case"ack":clearTimeout(d),i=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),u(g.data.response);break;default:clearTimeout(d),clearTimeout(i),l(new Error("invalid_response"));break}}},this.handlers.add(a),s.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:h,data:t},[s.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}function pt(){return window}function NI(n){pt().location.href=n}function _p(){return typeof pt().WorkerGlobalScope<"u"&&typeof pt().importScripts=="function"}async function OI(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function MI(){return navigator?.serviceWorker?.controller||null}function LI(){return _p()?self:null}const yp="firebaseLocalStorageDb",xI=1,Ni="firebaseLocalStorage",vp="fbase_key";class Ss{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function so(n,e){return n.transaction([Ni],e?"readwrite":"readonly").objectStore(Ni)}function FI(){const n=indexedDB.deleteDatabase(yp);return new Ss(n).toPromise()}function Ia(){const n=indexedDB.open(yp,xI);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(Ni,{keyPath:vp})}catch(s){t(s)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(Ni)?e(r):(r.close(),await FI(),e(await Ia()))})})}async function sh(n,e,t){const r=so(n,!0).put({[vp]:e,value:t});return new Ss(r).toPromise()}async function UI(n,e){const t=so(n,!1).get(e),r=await new Ss(t).toPromise();return r===void 0?null:r.value}function ih(n,e){const t=so(n,!0).delete(e);return new Ss(t).toPromise()}const BI=800,jI=3;class Ep{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Ia(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>jI)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return _p()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=ro._getInstance(LI()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await OI(),!this.activeServiceWorker)return;this.sender=new DI(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||MI()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Ia();return await sh(e,Di,"1"),await ih(e,Di),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>sh(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>UI(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>ih(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=so(s,!1).getAll();return new Ss(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),t.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),t.push(s));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),BI)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Ep.type="LOCAL";const qI=Ep;new Rs(3e4,6e4);function Tp(n,e){return e?wt(e):(B(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class wc extends hp{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return tr(e,this._buildIdpRequest())}_linkToIdToken(e,t){return tr(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return tr(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function $I(n){return wI(n.auth,new wc(n),n.bypassAuthState)}function zI(n){const{auth:e,user:t}=n;return B(t,e,"internal-error"),II(t,new wc(n),n.bypassAuthState)}async function HI(n){const{auth:e,user:t}=n;return B(t,e,"internal-error"),TI(t,new wc(n),n.bypassAuthState)}class Ip{constructor(e,t,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:s,tenantId:i,error:a,type:u}=e;if(a){this.reject(a);return}const l={auth:this.auth,requestUri:t,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(u)(l))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return $I;case"linkViaPopup":case"linkViaRedirect":return HI;case"reauthViaPopup":case"reauthViaRedirect":return zI;default:yt(this.auth,"internal-error")}}resolve(e){Ct(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ct(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const WI=new Rs(2e3,1e4);async function GI(n,e,t){if(Ye(n.app))return Promise.reject(tt(n,"operation-not-supported-in-this-environment"));const r=no(n);jT(n,e,Tc);const s=Tp(r,t);return new gn(r,"signInViaPopup",e,s).executeNotNull()}class gn extends Ip{constructor(e,t,r,s,i){super(e,t,s,i),this.provider=r,this.authWindow=null,this.pollId=null,gn.currentPopupAction&&gn.currentPopupAction.cancel(),gn.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return B(e,this.auth,"internal-error"),e}async onExecution(){Ct(this.filter.length===1,"Popup operations only handle one event");const e=Ic();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(tt(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(tt(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,gn.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(tt(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,WI.get())};e()}}gn.currentPopupAction=null;const KI="pendingRedirect",ai=new Map;class QI extends Ip{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=ai.get(this.auth._key());if(!e){try{const r=await XI(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}ai.set(this.auth._key(),e)}return this.bypassAuthState||ai.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function XI(n,e){const t=ZI(e),r=JI(n);if(!await r._isAvailable())return!1;const s=await r._get(t)==="true";return await r._remove(t),s}function YI(n,e){ai.set(n._key(),e)}function JI(n){return wt(n._redirectPersistence)}function ZI(n){return oi(KI,n.config.apiKey,n.name)}async function ew(n,e,t=!1){if(Ye(n.app))return Promise.reject(Tn(n));const r=no(n),s=Tp(r,e),a=await new QI(r,s,t).execute();return a&&!t&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,e)),a}const tw=600*1e3;class nw{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!rw(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!wp(e)){const r=e.error.code?.split("auth/")[1]||"internal-error";t.onError(tt(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=tw&&this.cachedEventUids.clear(),this.cachedEventUids.has(oh(e))}saveEventToCache(e){this.cachedEventUids.add(oh(e)),this.lastProcessedEventTime=Date.now()}}function oh(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function wp({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function rw(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return wp(n);default:return!1}}async function sw(n,e={}){return Tr(n,"GET","/v1/projects",e)}const iw=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,ow=/^https?/;async function aw(n){if(n.config.emulator)return;const{authorizedDomains:e}=await sw(n);for(const t of e)try{if(cw(t))return}catch{}yt(n,"unauthorized-domain")}function cw(n){const e=Ea(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const a=new URL(n);return a.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&a.hostname===r}if(!ow.test(t))return!1;if(iw.test(n))return r===n;const s=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}const uw=new Rs(3e4,6e4);function ah(){const n=pt().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function lw(n){return new Promise((e,t)=>{function r(){ah(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{ah(),t(tt(n,"network-request-failed"))},timeout:uw.get()})}if(pt().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(pt().gapi?.load)r();else{const s=pI("iframefcb");return pt()[s]=()=>{gapi.load?r():t(tt(n,"network-request-failed"))},fI(`${dI()}?onload=${s}`).catch(i=>t(i))}}).catch(e=>{throw ci=null,e})}let ci=null;function hw(n){return ci=ci||lw(n),ci}const fw=new Rs(5e3,15e3),dw="__/auth/iframe",pw="emulator/auth/iframe",mw={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},gw=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function _w(n){const e=n.config;B(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?gc(e,pw):`https://${n.config.authDomain}/${dw}`,r={apiKey:e.apiKey,appName:n.name,v:gr},s=gw.get(n.config.apiHost);s&&(r.eid=s);const i=n._getFrameworks();return i.length&&(r.fw=i.join(",")),`${t}?${vs(r).slice(1)}`}async function yw(n){const e=await hw(n),t=pt().gapi;return B(t,n,"internal-error"),e.open({where:document.body,url:_w(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:mw,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const a=tt(n,"network-request-failed"),u=pt().setTimeout(()=>{i(a)},fw.get());function l(){pt().clearTimeout(u),s(r)}r.ping(l).then(l,()=>{i(a)})}))}const vw={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Ew=500,Tw=600,Iw="_blank",ww="http://localhost";class ch{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function Aw(n,e,t,r=Ew,s=Tw){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let u="";const l={...vw,width:r.toString(),height:s.toString(),top:i,left:a},h=Ve().toLowerCase();t&&(u=rp(h)?Iw:t),tp(h)&&(e=e||ww,l.scrollbars="yes");const d=Object.entries(l).reduce((g,[w,S])=>`${g}${w}=${S},`,"");if(sI(h)&&u!=="_self")return Rw(e||"",u),new ch(null);const m=window.open(e||"",u,d);B(m,n,"popup-blocked");try{m.focus()}catch{}return new ch(m)}function Rw(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}const bw="__/auth/handler",Sw="emulator/auth/handler",Pw=encodeURIComponent("fac");async function uh(n,e,t,r,s,i){B(n.config.authDomain,n,"auth-domain-config-required"),B(n.config.apiKey,n,"invalid-api-key");const a={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:gr,eventId:s};if(e instanceof Tc){e.setDefaultLanguage(n.languageCode),a.providerId=e.providerId||"",o_(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,m]of Object.entries({}))a[d]=m}if(e instanceof bs){const d=e.getScopes().filter(m=>m!=="");d.length>0&&(a.scopes=d.join(","))}n.tenantId&&(a.tid=n.tenantId);const u=a;for(const d of Object.keys(u))u[d]===void 0&&delete u[d];const l=await n._getAppCheckToken(),h=l?`#${Pw}=${encodeURIComponent(l)}`:"";return`${Cw(n)}?${vs(u).slice(1)}${h}`}function Cw({config:n}){return n.emulator?gc(n,Sw):`https://${n.authDomain}/${bw}`}const Ho="webStorageSupport";class kw{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=gp,this._completeRedirectFn=ew,this._overrideRedirectResult=YI}async _openPopup(e,t,r,s){Ct(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const i=await uh(e,t,r,Ea(),s);return Aw(e,i,Ic())}async _openRedirect(e,t,r,s){await this._originValidation(e);const i=await uh(e,t,r,Ea(),s);return NI(i),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:s,promise:i}=this.eventManagers[t];return s?Promise.resolve(s):(Ct(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await yw(e),r=new nw(e);return t.register("authEvent",s=>(B(s?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Ho,{type:Ho},s=>{const i=s?.[0]?.[Ho];i!==void 0&&t(!!i),yt(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=aw(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return cp()||np()||vc()}}const Vw=kw;var lh="@firebase/auth",hh="1.11.1";class Dw{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){B(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function Nw(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Ow(n){ir(new Rn("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:a,authDomain:u}=r.options;B(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:a,authDomain:u,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:up(n)},h=new lI(r,s,i,l);return gI(h,t),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),ir(new Rn("auth-internal",e=>{const t=no(e.getProvider("auth").getImmediate());return(r=>new Dw(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Jt(lh,hh,Nw(n)),Jt(lh,hh,"esm2020")}const Mw=300,Lw=uf("authIdTokenMaxAge")||Mw;let fh=null;const xw=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>Lw)return;const s=t?.token;fh!==s&&(fh=s,await fetch(n,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function Fw(n=mf()){const e=Ua(n,"auth");if(e.isInitialized())return e.getImmediate();const t=mI(n,{popupRedirectResolver:Vw,persistence:[qI,kI,gp]}),r=uf("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const a=xw(i.toString());RI(t,a,()=>a(t.currentUser)),AI(t,u=>a(u))}}const s=af("auth");return s&&_I(t,`http://${s}`),t}function Uw(){return document.getElementsByTagName("head")?.[0]??document}hI({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=s=>{const i=tt("internal-error");i.customData=s,t(i)},r.type="text/javascript",r.charset="UTF-8",Uw().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Ow("Browser");const Bw={apiKey:"AIzaSyBC5VHNEcVL9KP8M0d64ZajF6P4Hzqzafc",authDomain:"bbnme-58716.firebaseapp.com",projectId:"bbnme-58716",storageBucket:"bbnme-58716.appspot.com",messagingSenderId:"155088179379",appId:"1:155088179379:web:5d98445c178b7513f520c6"},Ap=pf(Bw),Rp=ET(Ap),Ac=Fw(Ap),jw=new Tt,Rc=Cg(null);bI(Ac,n=>{Rc.set(n)});var qw=Qe('<button class="svelte-18sv61c"> </button>');function bp(n,e){let t=Bu(e,"label",8,"Button"),r=Bu(e,"onClick",8,()=>{});var s=qw(),i=et(s);Hr(()=>La(i,t())),Yh("click",s,function(...a){r()?.apply(this,a)}),Ge(n,s)}var $w=Qe('<div class="login-container svelte-8ukb9p"><h2>Please sign in to continue</h2> <!></div>');function zw(n,e){fs(e,!1),Bi();var t=$w(),r=Ke(et(t),2);bp(r,{label:"Sign in with Google",onClick:()=>GI(Ac,jw)}),Ge(n,t),ds()}var Hw=Qe('<div class="user-info svelte-rfuq4y"><img alt="Profile" class="svelte-rfuq4y"/> <span> </span></div> <!>',1),Ww=Qe('<nav class="svelte-rfuq4y"><!></nav>');function Gw(n,e){fs(e,!1);const t=()=>tf(Rc,"$user",r),[r,s]=nf();Bi();var i=Ww(),a=et(i);{var u=l=>{var h=Hw(),d=Va(h),m=et(d),g=Ke(m,2),w=et(g),S=Ke(d,2);bp(S,{label:"Sign out",onClick:()=>SI(Ac)}),Hr(()=>{Js(m,"src",t().photoURL),La(w,t().displayName)}),Ge(l,h)};fi(a,l=>{t()&&l(u)})}Ge(n,i),ds(),s()}var Kw=Qe('<form class="svelte-7mtrh0"><h2>Add a new place</h2> <input type="text" placeholder="Place name" required class="svelte-7mtrh0"/> <input type="url" placeholder="Website" class="svelte-7mtrh0"/> <input type="url" placeholder="Image URL" class="svelte-7mtrh0"/> <button type="submit" class="svelte-7mtrh0">Add Place</button></form>');function Qw(n,e){fs(e,!1);let t=Qn(""),r=Qn(""),s=Qn("");async function i(){try{const d=await MT(Ld(Rp,"places"),{name:J(t),website:J(r),image:J(s)});console.log("Document written with ID: ",d.id),be(t,""),be(r,""),be(s,"")}catch(d){console.error("Error adding document: ",d)}}Bi();var a=Kw(),u=Ke(et(a),2),l=Ke(u,2),h=Ke(l,2);Vo(u,()=>J(t),d=>be(t,d)),Vo(l,()=>J(r),d=>be(r,d)),Vo(h,()=>J(s),d=>be(s,d)),Yh("submit",a,Pg(i)),Ge(n,a),ds()}var Xw=Qe('<div class="card svelte-1udyrqm"><!></div>');function Sp(n,e){var t=Xw(),r=et(t);wg(r,e,"default",{}),Ge(n,t)}var Yw=Qe('<a target="_blank" rel="noreferrer">Website</a>'),Jw=Qe('<img class="svelte-13geuu4"/>'),Zw=Qe("<h3> </h3> <!> <!>",1),eA=Qe('<div class="svelte-13geuu4"><h2>Travel Wishlist</h2> <!></div>');function tA(n,e){fs(e,!1);let t=Qn([]);Dg(()=>{const i=LT(Ld(Rp,"places"),a=>{be(t,a.docs.map(u=>({id:u.id,...u.data()})))});return()=>i()}),Bi();var r=eA(),s=Ke(et(r),2);Tg(s,1,()=>J(t),vg,(i,a)=>{Sp(i,{children:(u,l)=>{var h=Zw(),d=Va(h),m=et(d),g=Ke(d,2);{var w=C=>{var L=Yw();Hr(()=>Js(L,"href",J(a).website)),Ge(C,L)};fi(g,C=>{J(a).website&&C(w)})}var S=Ke(g,2);{var V=C=>{var L=Jw();Hr(()=>{Js(L,"src",J(a).image),Js(L,"alt",J(a).name)}),Ge(C,L)};fi(S,C=>{J(a).image&&C(V)})}Hr(()=>La(m,J(a).name)),Ge(u,h)},$$slots:{default:!0}})}),Ge(n,r),ds()}var nA=Qe('<!> <div class="container svelte-1n46o8q"><h1>Clean Girl Travel Wishlist</h1> <!> <!></div>',1),rA=Qe("<main><!></main>");function sA(n){const e=()=>tf(Rc,"$user",t),[t,r]=nf();var s=rA(),i=et(s);{var a=l=>{var h=nA(),d=Va(h);Gw(d,{});var m=Ke(d,2),g=Ke(et(m),2);Sp(g,{children:(S,V)=>{Qw(S,{})},$$slots:{default:!0}});var w=Ke(g,2);tA(w,{}),Ge(l,h)},u=l=>{zw(l,{})};fi(i,l=>{e()?l(a):l(u,!1)})}Ge(n,s),r()}mg(sA,{target:document.getElementById("app")});
