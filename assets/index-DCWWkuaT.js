(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();const of=!1;var oc=Array.isArray,Gm=Array.prototype.indexOf,ac=Array.from,af=Object.defineProperty,mr=Object.getOwnPropertyDescriptor,cf=Object.getOwnPropertyDescriptors,Km=Object.prototype,Qm=Array.prototype,cc=Object.getPrototypeOf,_l=Object.isExtensible;const gr=()=>{};function Xm(n){return n()}function Aa(n){for(var e=0;e<n.length;e++)n[e]()}function uf(){var n,e,t=new Promise((r,s)=>{n=r,e=s});return{promise:t,resolve:n,reject:e}}const xe=2,uc=4,no=8,Gt=16,Kt=32,er=64,ro=128,ft=512,Ce=1024,Ke=2048,Ot=4096,Ze=8192,ln=16384,lc=32768,br=65536,yl=1<<17,lf=1<<18,Ur=1<<19,hf=1<<20,As=32768,ba=1<<21,hc=1<<22,hn=1<<23,_r=Symbol("$state"),Jm=Symbol("legacy props"),Ym=Symbol(""),dr=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function fc(n){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function Zm(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function eg(n){throw new Error("https://svelte.dev/e/effect_in_teardown")}function tg(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function ng(n){throw new Error("https://svelte.dev/e/effect_orphan")}function rg(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function sg(n){throw new Error("https://svelte.dev/e/props_invalid_value")}function ig(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function og(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function ag(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function cg(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const so=1,io=2,ff=4,ug=8,lg=16,hg=1,fg=2,dg=4,pg=8,mg=16,gg=1,_g=2,Oe=Symbol(),yg="http://www.w3.org/1999/xhtml";function vg(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}let Eg=!1;function df(n){return n===this.v}function pf(n,e){return n!=n?e==e:n!==e||n!==null&&typeof n=="object"||typeof n=="function"}function mf(n){return!pf(n,this.v)}let Br=!1,Tg=!1;function wg(){Br=!0}let re=null;function Sr(n){re=n}function bs(n){return gf().get(n)}function Sa(n,e){return gf().set(n,e),e}function st(n,e=!1,t){re={p:re,i:!1,c:null,e:null,s:n,x:null,l:Br&&!e?{s:null,u:null,$:[]}:null}}function it(n){var e=re,t=e.e;if(t!==null){e.e=null;for(var r of t)Nf(r)}return e.i=!0,re=e.p,{}}function Ms(){return!Br||re!==null&&re.l===null}function gf(n){return re===null&&fc(),re.c??=new Map(Ig(re)||void 0)}function Ig(n){let e=n.p;for(;e!==null;){const t=e.c;if(t!==null)return t;e=e.p}return null}let Mn=[];function _f(){var n=Mn;Mn=[],Aa(n)}function Ls(n){if(Mn.length===0&&!gs){var e=Mn;queueMicrotask(()=>{e===Mn&&_f()})}Mn.push(n)}function Ag(){for(;Mn.length>0;)_f()}function yf(n){var e=ee;if(e===null)return Z.f|=hn,n;if((e.f&lc)===0){if((e.f&ro)===0)throw n;e.b.error(n)}else Rr(n,e)}function Rr(n,e){for(;e!==null;){if((e.f&ro)!==0)try{e.b.error(n);return}catch(t){n=t}e=e.parent}throw n}const li=new Set;let oe=null,yi=null,Je=null,Et=[],oo=null,Ra=!1,gs=!1;class Tt{committed=!1;current=new Map;previous=new Map;#e=new Set;#t=new Set;#n=0;#r=0;#c=null;#o=[];#a=[];skipped_effects=new Set;is_fork=!1;process(e){Et=[],yi=null,this.apply();var t={parent:null,effect:null,effects:[],render_effects:[],block_effects:[]};for(const r of e)this.#s(r,t);this.is_fork||this.#u(),this.#r>0||this.is_fork?(this.#i(t.effects),this.#i(t.render_effects),this.#i(t.block_effects)):(yi=this,oe=null,vl(t.render_effects),vl(t.effects),yi=null,this.#c?.resolve()),Je=null}#s(e,t){e.f^=Ce;for(var r=e.first;r!==null;){var s=r.f,i=(s&(Kt|er))!==0,a=i&&(s&Ce)!==0,c=a||(s&Ze)!==0||this.skipped_effects.has(r);if((r.f&ro)!==0&&r.b?.is_pending()&&(t={parent:t,effect:r,effects:[],render_effects:[],block_effects:[]}),!c&&r.fn!==null){i?r.f^=Ce:(s&uc)!==0?t.effects.push(r):$r(r)&&((r.f&Gt)!==0&&t.block_effects.push(r),Cr(r));var l=r.first;if(l!==null){r=l;continue}}var h=r.parent;for(r=r.next;r===null&&h!==null;)h===t.effect&&(this.#i(t.effects),this.#i(t.render_effects),this.#i(t.block_effects),t=t.parent),r=h.next,h=h.parent}}#i(e){for(const t of e)((t.f&Ke)!==0?this.#o:this.#a).push(t),ke(t,Ce)}capture(e,t){this.previous.has(e)||this.previous.set(e,t),(e.f&hn)===0&&(this.current.set(e,e.v),Je?.set(e,e.v))}activate(){oe=this,this.apply()}deactivate(){oe=null,Je=null}flush(){if(this.activate(),Et.length>0){if(vf(),oe!==null&&oe!==this)return}else this.#n===0&&this.process([]);this.deactivate()}discard(){for(const e of this.#t)e(this);this.#t.clear()}#u(){if(this.#r===0){for(const e of this.#e)e();this.#e.clear()}this.#n===0&&this.#l()}#l(){if(li.size>1){this.previous.clear();var e=Je,t=!0,r={parent:null,effect:null,effects:[],render_effects:[],block_effects:[]};for(const s of li){if(s===this){t=!1;continue}const i=[];for(const[c,l]of this.current){if(s.current.has(c))if(t&&l!==s.current.get(c))s.current.set(c,l);else continue;i.push(c)}if(i.length===0)continue;const a=[...s.current.keys()].filter(c=>!this.current.has(c));if(a.length>0){const c=new Set,l=new Map;for(const h of i)Ef(h,a,c,l);if(Et.length>0){oe=s,s.apply();for(const h of Et)s.#s(h,r);Et=[],s.deactivate()}}}oe=null,Je=e}this.committed=!0,li.delete(this)}increment(e){this.#n+=1,e&&(this.#r+=1)}decrement(e){this.#n-=1,e&&(this.#r-=1),this.revive()}revive(){for(const e of this.#o)ke(e,Ke),zn(e);for(const e of this.#a)ke(e,Ot),zn(e);this.#o=[],this.#a=[],this.flush()}oncommit(e){this.#e.add(e)}ondiscard(e){this.#t.add(e)}settled(){return(this.#c??=uf()).promise}static ensure(){if(oe===null){const e=oe=new Tt;li.add(oe),gs||Tt.enqueue(()=>{oe===e&&e.flush()})}return oe}static enqueue(e){Ls(e)}apply(){}}function bg(n){var e=gs;gs=!0;try{for(var t;;){if(Ag(),Et.length===0&&(oe?.flush(),Et.length===0))return oo=null,t;vf()}}finally{gs=e}}function vf(){var n=Un;Ra=!0;try{var e=0;for(Tl(!0);Et.length>0;){var t=Tt.ensure();if(e++>1e3){var r,s;Sg()}t.process(Et),fn.clear()}}finally{Ra=!1,Tl(n),oo=null}}function Sg(){try{rg()}catch(n){Rr(n,oo)}}let xt=null;function vl(n){var e=n.length;if(e!==0){for(var t=0;t<e;){var r=n[t++];if((r.f&(ln|Ze))===0&&$r(r)&&(xt=new Set,Cr(r),r.deps===null&&r.first===null&&r.nodes_start===null&&(r.teardown===null&&r.ac===null?Of(r):r.fn=null),xt?.size>0)){fn.clear();for(const s of xt){if((s.f&(ln|Ze))!==0)continue;const i=[s];let a=s.parent;for(;a!==null;)xt.has(a)&&(xt.delete(a),i.push(a)),a=a.parent;for(let c=i.length-1;c>=0;c--){const l=i[c];(l.f&(ln|Ze))===0&&Cr(l)}}xt.clear()}}xt=null}}function Ef(n,e,t,r){if(!t.has(n)&&(t.add(n),n.reactions!==null))for(const s of n.reactions){const i=s.f;(i&xe)!==0?Ef(s,e,t,r):(i&(hc|Gt))!==0&&(i&Ke)===0&&Tf(s,e,r)&&(ke(s,Ke),zn(s))}}function Tf(n,e,t){const r=t.get(n);if(r!==void 0)return r;if(n.deps!==null)for(const s of n.deps){if(e.includes(s))return!0;if((s.f&xe)!==0&&Tf(s,e,t))return t.set(s,!0),!0}return t.set(n,!1),!1}function zn(n){for(var e=oo=n;e.parent!==null;){e=e.parent;var t=e.f;if(Ra&&e===ee&&(t&Gt)!==0&&(t&lf)===0)return;if((t&(er|Kt))!==0){if((t&Ce)===0)return;e.f^=Ce}}Et.push(e)}function Rg(n){let e=0,t=Hn(0),r;return()=>{uo()&&(L(t),lo(()=>(e===0&&(r=je(()=>n(()=>_s(t)))),e+=1,()=>{Ls(()=>{e-=1,e===0&&(r?.(),r=void 0,_s(t))})})))}}var Pg=br|Ur|ro;function Cg(n,e,t){new kg(n,e,t)}class kg{parent;#e=!1;#t;#n=null;#r;#c;#o;#a=null;#s=null;#i=null;#u=null;#l=null;#d=0;#h=0;#p=!1;#f=null;#v=Rg(()=>(this.#f=Hn(this.#d),()=>{this.#f=null}));constructor(e,t,r){this.#t=e,this.#r=t,this.#c=r,this.parent=ee.b,this.#e=!!this.#r.pending,this.#o=gc(()=>{ee.b=this;{var s=this.#_();try{this.#a=at(()=>r(s))}catch(i){this.error(i)}this.#h>0?this.#g():this.#e=!1}return()=>{this.#l?.remove()}},Pg)}#E(){try{this.#a=at(()=>this.#c(this.#t))}catch(e){this.error(e)}this.#e=!1}#T(){const e=this.#r.pending;e&&(this.#s=at(()=>e(this.#t)),Tt.enqueue(()=>{var t=this.#_();this.#a=this.#m(()=>(Tt.ensure(),at(()=>this.#c(t)))),this.#h>0?this.#g():(yr(this.#s,()=>{this.#s=null}),this.#e=!1)}))}#_(){var e=this.#t;return this.#e&&(this.#l=Wn(),this.#t.before(this.#l),e=this.#l),e}is_pending(){return this.#e||!!this.parent&&this.parent.is_pending()}has_pending_snippet(){return!!this.#r.pending}#m(e){var t=ee,r=Z,s=re;kt(this.#o),We(this.#o),Sr(this.#o.ctx);try{return e()}catch(i){return yf(i),null}finally{kt(t),We(r),Sr(s)}}#g(){const e=this.#r.pending;this.#a!==null&&(this.#u=document.createDocumentFragment(),this.#u.append(this.#l),xf(this.#a,this.#u)),this.#s===null&&(this.#s=at(()=>e(this.#t)))}#y(e){if(!this.has_pending_snippet()){this.parent&&this.parent.#y(e);return}this.#h+=e,this.#h===0&&(this.#e=!1,this.#s&&yr(this.#s,()=>{this.#s=null}),this.#u&&(this.#t.before(this.#u),this.#u=null))}update_pending_count(e){this.#y(e),this.#d+=e,this.#f&&Pr(this.#f,this.#d)}get_effect_pending(){return this.#v(),L(this.#f)}error(e){var t=this.#r.onerror;let r=this.#r.failed;if(this.#p||!t&&!r)throw e;this.#a&&(qe(this.#a),this.#a=null),this.#s&&(qe(this.#s),this.#s=null),this.#i&&(qe(this.#i),this.#i=null);var s=!1,i=!1;const a=()=>{if(s){vg();return}s=!0,i&&cg(),Tt.ensure(),this.#d=0,this.#i!==null&&yr(this.#i,()=>{this.#i=null}),this.#e=this.has_pending_snippet(),this.#a=this.#m(()=>(this.#p=!1,at(()=>this.#c(this.#t)))),this.#h>0?this.#g():this.#e=!1};var c=Z;try{We(null),i=!0,t?.(e,a),i=!1}catch(l){Rr(l,this.#o&&this.#o.parent)}finally{We(c)}r&&Ls(()=>{this.#i=this.#m(()=>{Tt.ensure(),this.#p=!0;try{return at(()=>{r(this.#t,()=>e,()=>a)})}catch(l){return Rr(l,this.#o.parent),null}finally{this.#p=!1}})})}}function Ng(n,e,t,r){const s=Ms()?ao:dc;if(t.length===0&&n.length===0){r(e.map(s));return}var i=oe,a=ee,c=Dg();function l(){Promise.all(t.map(h=>Vg(h))).then(h=>{c();try{r([...e.map(s),...h])}catch(d){(a.f&ln)===0&&Rr(d,a)}i?.deactivate(),ki()}).catch(h=>{Rr(h,a)})}n.length>0?Promise.all(n).then(()=>{c();try{return l()}finally{i?.deactivate(),ki()}}):l()}function Dg(){var n=ee,e=Z,t=re,r=oe;return function(i=!0){kt(n),We(e),Sr(t),i&&r?.activate()}}function ki(){kt(null),We(null),Sr(null)}function ao(n){var e=xe|Ke,t=Z!==null&&(Z.f&xe)!==0?Z:null;return ee!==null&&(ee.f|=Ur),{ctx:re,deps:null,effects:null,equals:df,f:e,fn:n,reactions:null,rv:0,v:Oe,wv:0,parent:t??ee,ac:null}}function Vg(n,e){let t=ee;t===null&&Zm();var r=t.b,s=void 0,i=Hn(Oe),a=!Z,c=new Map;return qg(()=>{var l=uf();s=l.promise;try{Promise.resolve(n()).then(l.resolve,l.reject).then(()=>{h===oe&&h.committed&&h.deactivate(),ki()})}catch(g){l.reject(g),ki()}var h=oe;if(a){var d=!r.is_pending();r.update_pending_count(1),h.increment(d),c.get(h)?.reject(dr),c.delete(h),c.set(h,l)}const m=(g,I=void 0)=>{if(h.activate(),I)I!==dr&&(i.f|=hn,Pr(i,I));else{(i.f&hn)!==0&&(i.f^=hn),Pr(i,g);for(const[S,C]of c){if(c.delete(S),S===h)break;C.reject(dr)}}a&&(r.update_pending_count(-1),h.decrement(d))};l.promise.then(m,g=>m(null,g||"unknown"))}),mc(()=>{for(const l of c.values())l.reject(dr)}),new Promise(l=>{function h(d){function m(){d===s?l(i):h(s)}d.then(m,m)}h(s)})}function dc(n){const e=ao(n);return e.equals=mf,e}function wf(n){var e=n.effects;if(e!==null){n.effects=null;for(var t=0;t<e.length;t+=1)qe(e[t])}}function Og(n){for(var e=n.parent;e!==null;){if((e.f&xe)===0)return e;e=e.parent}return null}function pc(n){var e,t=ee;kt(Og(n));try{n.f&=~As,wf(n),e=$f(n)}finally{kt(t)}return e}function If(n){var e=pc(n);if(n.equals(e)||(n.v=e,n.wv=Uf()),!tr)if(Je!==null)uo()&&Je.set(n,n.v);else{var t=(n.f&ft)===0?Ot:Ce;ke(n,t)}}let Pa=new Set;const fn=new Map;let Af=!1;function Hn(n,e){var t={f:0,v:n,reactions:null,equals:df,rv:0,wv:0};return t}function rn(n,e){const t=Hn(n);return Wg(t),t}function we(n,e=!1,t=!0){const r=Hn(n);return e||(r.equals=mf),Br&&t&&re!==null&&re.l!==null&&(re.l.s??=[]).push(r),r}function K(n,e,t=!1){Z!==null&&(!wt||(Z.f&yl)!==0)&&Ms()&&(Z.f&(xe|Gt|hc|yl))!==0&&!$t?.includes(n)&&ag();let r=t?pr(e):e;return Pr(n,r)}function Pr(n,e){if(!n.equals(e)){var t=n.v;tr?fn.set(n,e):fn.set(n,t),n.v=e;var r=Tt.ensure();r.capture(n,t),(n.f&xe)!==0&&((n.f&Ke)!==0&&pc(n),ke(n,(n.f&ft)!==0?Ce:Ot)),n.wv=Uf(),bf(n,Ke),Ms()&&ee!==null&&(ee.f&Ce)!==0&&(ee.f&(Kt|er))===0&&(tt===null?Gg([n]):tt.push(n)),!r.is_fork&&Pa.size>0&&!Af&&Mg()}return e}function Mg(){Af=!1;const n=Array.from(Pa);for(const e of n)(e.f&Ce)!==0&&ke(e,Ot),$r(e)&&Cr(e);Pa.clear()}function _s(n){K(n,n.v+1)}function bf(n,e){var t=n.reactions;if(t!==null)for(var r=Ms(),s=t.length,i=0;i<s;i++){var a=t[i],c=a.f;if(!(!r&&a===ee)){var l=(c&Ke)===0;if(l&&ke(a,e),(c&xe)!==0){var h=a;Je?.delete(h),(c&As)===0&&(c&ft&&(a.f|=As),bf(h,Ot))}else l&&((c&Gt)!==0&&xt!==null&&xt.add(a),zn(a))}}}function pr(n){if(typeof n!="object"||n===null||_r in n)return n;const e=cc(n);if(e!==Km&&e!==Qm)return n;var t=new Map,r=oc(n),s=rn(0),i=Bn,a=c=>{if(Bn===i)return c();var l=Z,h=Bn;We(null),Il(i);var d=c();return We(l),Il(h),d};return r&&t.set("length",rn(n.length)),new Proxy(n,{defineProperty(c,l,h){(!("value"in h)||h.configurable===!1||h.enumerable===!1||h.writable===!1)&&ig();var d=t.get(l);return d===void 0?d=a(()=>{var m=rn(h.value);return t.set(l,m),m}):K(d,h.value,!0),!0},deleteProperty(c,l){var h=t.get(l);if(h===void 0){if(l in c){const d=a(()=>rn(Oe));t.set(l,d),_s(s)}}else K(h,Oe),_s(s);return!0},get(c,l,h){if(l===_r)return n;var d=t.get(l),m=l in c;if(d===void 0&&(!m||mr(c,l)?.writable)&&(d=a(()=>{var I=pr(m?c[l]:Oe),S=rn(I);return S}),t.set(l,d)),d!==void 0){var g=L(d);return g===Oe?void 0:g}return Reflect.get(c,l,h)},getOwnPropertyDescriptor(c,l){var h=Reflect.getOwnPropertyDescriptor(c,l);if(h&&"value"in h){var d=t.get(l);d&&(h.value=L(d))}else if(h===void 0){var m=t.get(l),g=m?.v;if(m!==void 0&&g!==Oe)return{enumerable:!0,configurable:!0,value:g,writable:!0}}return h},has(c,l){if(l===_r)return!0;var h=t.get(l),d=h!==void 0&&h.v!==Oe||Reflect.has(c,l);if(h!==void 0||ee!==null&&(!d||mr(c,l)?.writable)){h===void 0&&(h=a(()=>{var g=d?pr(c[l]):Oe,I=rn(g);return I}),t.set(l,h));var m=L(h);if(m===Oe)return!1}return d},set(c,l,h,d){var m=t.get(l),g=l in c;if(r&&l==="length")for(var I=h;I<m.v;I+=1){var S=t.get(I+"");S!==void 0?K(S,Oe):I in c&&(S=a(()=>rn(Oe)),t.set(I+"",S))}if(m===void 0)(!g||mr(c,l)?.writable)&&(m=a(()=>rn(void 0)),K(m,pr(h)),t.set(l,m));else{g=m.v!==Oe;var C=a(()=>pr(h));K(m,C)}var R=Reflect.getOwnPropertyDescriptor(c,l);if(R?.set&&R.set.call(d,h),!g){if(r&&typeof l=="string"){var O=t.get("length"),x=Number(l);Number.isInteger(x)&&x>=O.v&&K(O,x+1)}_s(s)}return!0},ownKeys(c){L(s);var l=Reflect.ownKeys(c).filter(m=>{var g=t.get(m);return g===void 0||g.v!==Oe});for(var[h,d]of t)d.v!==Oe&&!(h in c)&&l.push(h);return l},setPrototypeOf(){og()}})}var Ca,Sf,Rf,Pf;function Lg(){if(Ca===void 0){Ca=window,Sf=/Firefox/.test(navigator.userAgent);var n=Element.prototype,e=Node.prototype,t=Text.prototype;Rf=mr(e,"firstChild").get,Pf=mr(e,"nextSibling").get,_l(n)&&(n.__click=void 0,n.__className=void 0,n.__attributes=null,n.__style=void 0,n.__e=void 0),_l(t)&&(t.__t=void 0)}}function Wn(n=""){return document.createTextNode(n)}function Ni(n){return Rf.call(n)}function xs(n){return Pf.call(n)}function ue(n,e){return Ni(n)}function Fn(n,e=!1){{var t=Ni(n);return t instanceof Comment&&t.data===""?xs(t):t}}function le(n,e=1,t=!1){let r=n;for(;e--;)r=xs(r);return r}function xg(n){n.textContent=""}function Cf(){return!1}let El=!1;function Fg(){El||(El=!0,document.addEventListener("reset",n=>{Promise.resolve().then(()=>{if(!n.defaultPrevented)for(const e of n.target.elements)e.__on_r?.()})},{capture:!0}))}function co(n){var e=Z,t=ee;We(null),kt(null);try{return n()}finally{We(e),kt(t)}}function Ug(n,e,t,r=t){n.addEventListener(e,()=>co(t));const s=n.__on_r;s?n.__on_r=()=>{s(),r(!0)}:n.__on_r=()=>r(!0),Fg()}function kf(n){ee===null&&(Z===null&&ng(),tg()),tr&&eg()}function Bg(n,e){var t=e.last;t===null?e.last=e.first=n:(t.next=n,n.prev=t,e.last=n)}function Qt(n,e,t,r=!0){var s=ee;s!==null&&(s.f&Ze)!==0&&(n|=Ze);var i={ctx:re,deps:null,nodes_start:null,nodes_end:null,f:n|Ke|ft,first:null,fn:e,last:null,next:null,parent:s,b:s&&s.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(t)try{Cr(i),i.f|=lc}catch(l){throw qe(i),l}else e!==null&&zn(i);if(r){var a=i;if(t&&a.deps===null&&a.teardown===null&&a.nodes_start===null&&a.first===a.last&&(a.f&Ur)===0&&(a=a.first,(n&Gt)!==0&&(n&br)!==0&&a!==null&&(a.f|=br)),a!==null&&(a.parent=s,s!==null&&Bg(a,s),Z!==null&&(Z.f&xe)!==0&&(n&er)===0)){var c=Z;(c.effects??=[]).push(a)}}return i}function uo(){return Z!==null&&!wt}function mc(n){const e=Qt(no,null,!1);return ke(e,Ce),e.teardown=n,e}function ka(n){kf();var e=ee.f,t=!Z&&(e&Kt)!==0&&(e&lc)===0;if(t){var r=re;(r.e??=[]).push(n)}else return Nf(n)}function Nf(n){return Qt(uc|hf,n,!1)}function $g(n){return kf(),Qt(no|hf,n,!0)}function jg(n){Tt.ensure();const e=Qt(er|Ur,n,!0);return(t={})=>new Promise(r=>{t.outro?yr(e,()=>{qe(e),r(void 0)}):(qe(e),r(void 0))})}function Fs(n,e){var t=re,r={effect:null,ran:!1,deps:n};t.l.$.push(r),r.effect=lo(()=>{n(),!r.ran&&(r.ran=!0,je(e))})}function Us(){var n=re;lo(()=>{for(var e of n.l.$){e.deps();var t=e.effect;(t.f&Ce)!==0&&ke(t,Ot),$r(t)&&Cr(t),e.ran=!1}})}function qg(n){return Qt(hc|Ur,n,!0)}function lo(n,e=0){return Qt(no|e,n,!0)}function Gn(n,e=[],t=[],r=[],s=!1){Ng(r,e,t,i=>{Qt(s?uc:no,()=>n(...i.map(L)),!0)})}function gc(n,e=0){var t=Qt(Gt|e,n,!0);return t}function at(n,e=!0){return Qt(Kt|Ur,n,!0,e)}function Df(n){var e=n.teardown;if(e!==null){const t=tr,r=Z;wl(!0),We(null);try{e.call(null)}finally{wl(t),We(r)}}}function Vf(n,e=!1){var t=n.first;for(n.first=n.last=null;t!==null;){const s=t.ac;s!==null&&co(()=>{s.abort(dr)});var r=t.next;(t.f&er)!==0?t.parent=null:qe(t,e),t=r}}function zg(n){for(var e=n.first;e!==null;){var t=e.next;(e.f&Kt)===0&&qe(e),e=t}}function qe(n,e=!0){var t=!1;(e||(n.f&lf)!==0)&&n.nodes_start!==null&&n.nodes_end!==null&&(Hg(n.nodes_start,n.nodes_end),t=!0),Vf(n,e&&!t),Di(n,0),ke(n,ln);var r=n.transitions;if(r!==null)for(const i of r)i.stop();Df(n);var s=n.parent;s!==null&&s.first!==null&&Of(n),n.next=n.prev=n.teardown=n.ctx=n.deps=n.fn=n.nodes_start=n.nodes_end=n.ac=null}function Hg(n,e){for(;n!==null;){var t=n===e?null:xs(n);n.remove(),n=t}}function Of(n){var e=n.parent,t=n.prev,r=n.next;t!==null&&(t.next=r),r!==null&&(r.prev=t),e!==null&&(e.first===n&&(e.first=r),e.last===n&&(e.last=t))}function yr(n,e,t=!0){var r=[];_c(n,r,!0),Mf(r,()=>{t&&qe(n),e&&e()})}function Mf(n,e){var t=n.length;if(t>0){var r=()=>--t||e();for(var s of n)s.out(r)}else e()}function _c(n,e,t){if((n.f&Ze)===0){if(n.f^=Ze,n.transitions!==null)for(const a of n.transitions)(a.is_global||t)&&e.push(a);for(var r=n.first;r!==null;){var s=r.next,i=(r.f&br)!==0||(r.f&Kt)!==0&&(n.f&Gt)!==0;_c(r,e,i?t:!1),r=s}}}function yc(n){Lf(n,!0)}function Lf(n,e){if((n.f&Ze)!==0){n.f^=Ze,(n.f&Ce)===0&&(ke(n,Ke),zn(n));for(var t=n.first;t!==null;){var r=t.next,s=(t.f&br)!==0||(t.f&Kt)!==0;Lf(t,s?e:!1),t=r}if(n.transitions!==null)for(const i of n.transitions)(i.is_global||e)&&i.in()}}function xf(n,e){for(var t=n.nodes_start,r=n.nodes_end;t!==null;){var s=t===r?null:xs(t);e.append(t),t=s}}let Un=!1;function Tl(n){Un=n}let tr=!1;function wl(n){tr=n}let Z=null,wt=!1;function We(n){Z=n}let ee=null;function kt(n){ee=n}let $t=null;function Wg(n){Z!==null&&($t===null?$t=[n]:$t.push(n))}let $e=null,Xe=0,tt=null;function Gg(n){tt=n}let Ff=1,Ss=0,Bn=Ss;function Il(n){Bn=n}function Uf(){return++Ff}function $r(n){var e=n.f;if((e&Ke)!==0)return!0;if(e&xe&&(n.f&=~As),(e&Ot)!==0){var t=n.deps;if(t!==null)for(var r=t.length,s=0;s<r;s++){var i=t[s];if($r(i)&&If(i),i.wv>n.wv)return!0}(e&ft)!==0&&Je===null&&ke(n,Ce)}return!1}function Bf(n,e,t=!0){var r=n.reactions;if(r!==null&&!$t?.includes(n))for(var s=0;s<r.length;s++){var i=r[s];(i.f&xe)!==0?Bf(i,e,!1):e===i&&(t?ke(i,Ke):(i.f&Ce)!==0&&ke(i,Ot),zn(i))}}function $f(n){var e=$e,t=Xe,r=tt,s=Z,i=$t,a=re,c=wt,l=Bn,h=n.f;$e=null,Xe=0,tt=null,Z=(h&(Kt|er))===0?n:null,$t=null,Sr(n.ctx),wt=!1,Bn=++Ss,n.ac!==null&&(co(()=>{n.ac.abort(dr)}),n.ac=null);try{n.f|=ba;var d=n.fn,m=d(),g=n.deps;if($e!==null){var I;if(Di(n,Xe),g!==null&&Xe>0)for(g.length=Xe+$e.length,I=0;I<$e.length;I++)g[Xe+I]=$e[I];else n.deps=g=$e;if(Un&&uo()&&(n.f&ft)!==0)for(I=Xe;I<g.length;I++)(g[I].reactions??=[]).push(n)}else g!==null&&Xe<g.length&&(Di(n,Xe),g.length=Xe);if(Ms()&&tt!==null&&!wt&&g!==null&&(n.f&(xe|Ot|Ke))===0)for(I=0;I<tt.length;I++)Bf(tt[I],n);return s!==null&&s!==n&&(Ss++,tt!==null&&(r===null?r=tt:r.push(...tt))),(n.f&hn)!==0&&(n.f^=hn),m}catch(S){return yf(S)}finally{n.f^=ba,$e=e,Xe=t,tt=r,Z=s,$t=i,Sr(a),wt=c,Bn=l}}function Kg(n,e){let t=e.reactions;if(t!==null){var r=Gm.call(t,n);if(r!==-1){var s=t.length-1;s===0?t=e.reactions=null:(t[r]=t[s],t.pop())}}t===null&&(e.f&xe)!==0&&($e===null||!$e.includes(e))&&(ke(e,Ot),(e.f&ft)!==0&&(e.f^=ft,e.f&=~As),wf(e),Di(e,0))}function Di(n,e){var t=n.deps;if(t!==null)for(var r=e;r<t.length;r++)Kg(n,t[r])}function Cr(n){var e=n.f;if((e&ln)===0){ke(n,Ce);var t=ee,r=Un;ee=n,Un=!0;try{(e&Gt)!==0?zg(n):Vf(n),Df(n);var s=$f(n);n.teardown=typeof s=="function"?s:null,n.wv=Ff;var i;of&&Tg&&(n.f&Ke)!==0&&n.deps}finally{Un=r,ee=t}}}async function Qg(){await Promise.resolve(),bg()}function L(n){var e=n.f,t=(e&xe)!==0;if(Z!==null&&!wt){var r=ee!==null&&(ee.f&ln)!==0;if(!r&&!$t?.includes(n)){var s=Z.deps;if((Z.f&ba)!==0)n.rv<Ss&&(n.rv=Ss,$e===null&&s!==null&&s[Xe]===n?Xe++:$e===null?$e=[n]:$e.includes(n)||$e.push(n));else{(Z.deps??=[]).push(n);var i=n.reactions;i===null?n.reactions=[Z]:i.includes(Z)||i.push(Z)}}}if(tr){if(fn.has(n))return fn.get(n);if(t){var a=n,c=a.v;return((a.f&Ce)===0&&a.reactions!==null||qf(a))&&(c=pc(a)),fn.set(a,c),c}}else if(t){if(a=n,Je?.has(a))return Je.get(a);$r(a)&&If(a),Un&&uo()&&(a.f&ft)===0&&jf(a)}else if(Je?.has(n))return Je.get(n);if((n.f&hn)!==0)throw n.v;return n.v}function jf(n){if(n.deps!==null){n.f^=ft;for(const e of n.deps)(e.reactions??=[]).push(n),(e.f&xe)!==0&&(e.f&ft)===0&&jf(e)}}function qf(n){if(n.v===Oe)return!0;if(n.deps===null)return!1;for(const e of n.deps)if(fn.has(e)||(e.f&xe)!==0&&qf(e))return!0;return!1}function je(n){var e=wt;try{return wt=!0,n()}finally{wt=e}}const Xg=-7169;function ke(n,e){n.f=n.f&Xg|e}function Jg(n){if(!(typeof n!="object"||!n||n instanceof EventTarget)){if(_r in n)Na(n);else if(!Array.isArray(n))for(let e in n){const t=n[e];typeof t=="object"&&t&&_r in t&&Na(t)}}}function Na(n,e=new Set){if(typeof n=="object"&&n!==null&&!(n instanceof EventTarget)&&!e.has(n)){e.add(n),n instanceof Date&&n.getTime();for(let r in n)try{Na(n[r],e)}catch{}const t=cc(n);if(t!==Object.prototype&&t!==Array.prototype&&t!==Map.prototype&&t!==Set.prototype&&t!==Date.prototype){const r=cf(t);for(let s in r){const i=r[s].get;if(i)try{i.call(n)}catch{}}}}}const Yg=["touchstart","touchmove"];function Zg(n){return Yg.includes(n)}const e_=new Set,Al=new Set;function t_(n,e,t,r={}){function s(i){if(r.capture||hs.call(e,i),!i.cancelBubble)return co(()=>t?.call(this,i))}return n.startsWith("pointer")||n.startsWith("touch")||n==="wheel"?Ls(()=>{e.addEventListener(n,s,r)}):e.addEventListener(n,s,r),s}function yn(n,e,t,r,s){var i={capture:r,passive:s},a=t_(n,e,t,i);(e===document.body||e===window||e===document||e instanceof HTMLMediaElement)&&mc(()=>{e.removeEventListener(n,a,i)})}let bl=null;function hs(n){var e=this,t=e.ownerDocument,r=n.type,s=n.composedPath?.()||[],i=s[0]||n.target;bl=n;var a=0,c=bl===n&&n.__root;if(c){var l=s.indexOf(c);if(l!==-1&&(e===document||e===window)){n.__root=e;return}var h=s.indexOf(e);if(h===-1)return;l<=h&&(a=l)}if(i=s[a]||n.target,i!==e){af(n,"currentTarget",{configurable:!0,get(){return i||t}});var d=Z,m=ee;We(null),kt(null);try{for(var g,I=[];i!==null;){var S=i.assignedSlot||i.parentNode||i.host||null;try{var C=i["__"+r];C!=null&&(!i.disabled||n.target===i)&&C.call(i,n)}catch(R){g?I.push(R):g=R}if(n.cancelBubble||S===e||S===null)break;i=S}if(g){for(let R of I)queueMicrotask(()=>{throw R});throw g}}finally{n.__root=e,delete n.currentTarget,We(d),kt(m)}}}function n_(n){var e=document.createElement("template");return e.innerHTML=n.replaceAll("<!>","<!---->"),e.content}function Da(n,e){var t=ee;t.nodes_start===null&&(t.nodes_start=n,t.nodes_end=e)}function fe(n,e){var t=(e&gg)!==0,r=(e&_g)!==0,s,i=!n.startsWith("<!>");return()=>{s===void 0&&(s=n_(i?n:"<!>"+n),t||(s=Ni(s)));var a=r||Sf?document.importNode(s,!0):s.cloneNode(!0);if(t){var c=Ni(a),l=a.lastChild;Da(c,l)}else Da(a,a);return a}}function vc(){var n=document.createDocumentFragment(),e=document.createComment(""),t=Wn();return n.append(e,t),Da(e,t),n}function se(n,e){n!==null&&n.before(e)}function ho(n,e){var t=e==null?"":typeof e=="object"?e+"":e;t!==(n.__t??=n.nodeValue)&&(n.__t=t,n.nodeValue=t+"")}function r_(n,e){return s_(n,e)}const ar=new Map;function s_(n,{target:e,anchor:t,props:r={},events:s,context:i,intro:a=!0}){Lg();var c=new Set,l=m=>{for(var g=0;g<m.length;g++){var I=m[g];if(!c.has(I)){c.add(I);var S=Zg(I);e.addEventListener(I,hs,{passive:S});var C=ar.get(I);C===void 0?(document.addEventListener(I,hs,{passive:S}),ar.set(I,1)):ar.set(I,C+1)}}};l(ac(e_)),Al.add(l);var h=void 0,d=jg(()=>{var m=t??e.appendChild(Wn());return Cg(m,{pending:()=>{}},g=>{if(i){st({});var I=re;I.c=i}s&&(r.$$events=s),h=n(g,r)||{},i&&it()}),()=>{for(var g of c){e.removeEventListener(g,hs);var I=ar.get(g);--I===0?(document.removeEventListener(g,hs),ar.delete(g)):ar.set(g,I)}Al.delete(l),m!==t&&m.parentNode?.removeChild(m)}});return i_.set(h,d),h}let i_=new WeakMap;class o_{anchor;#e=new Map;#t=new Map;#n=new Map;#r=!0;constructor(e,t=!0){this.anchor=e,this.#r=t}#c=()=>{var e=oe;if(this.#e.has(e)){var t=this.#e.get(e),r=this.#t.get(t);if(r)yc(r);else{var s=this.#n.get(t);s&&(this.#t.set(t,s.effect),this.#n.delete(t),s.fragment.lastChild.remove(),this.anchor.before(s.fragment),r=s.effect)}for(const[i,a]of this.#e){if(this.#e.delete(i),i===e)break;const c=this.#n.get(a);c&&(qe(c.effect),this.#n.delete(a))}for(const[i,a]of this.#t){if(i===t)continue;const c=()=>{if(Array.from(this.#e.values()).includes(i)){var h=document.createDocumentFragment();xf(a,h),h.append(Wn()),this.#n.set(i,{effect:a,fragment:h})}else qe(a);this.#t.delete(i)};this.#r||!r?yr(a,c,!1):c()}}};#o=e=>{this.#e.delete(e);const t=Array.from(this.#e.values());for(const[r,s]of this.#n)t.includes(r)||(qe(s.effect),this.#n.delete(r))};ensure(e,t){var r=oe,s=Cf();if(t&&!this.#t.has(e)&&!this.#n.has(e))if(s){var i=document.createDocumentFragment(),a=Wn();i.append(a),this.#n.set(e,{effect:at(()=>t(a)),fragment:i})}else this.#t.set(e,at(()=>t(this.anchor)));if(this.#e.set(r,e),s){for(const[c,l]of this.#t)c===e?r.skipped_effects.delete(l):r.skipped_effects.add(l);for(const[c,l]of this.#n)c===e?r.skipped_effects.delete(l.effect):r.skipped_effects.add(l.effect);r.oncommit(this.#c),r.ondiscard(this.#o)}else this.#c()}}function ut(n,e,t=!1){var r=new o_(n),s=t?br:0;function i(a,c){r.ensure(a,c)}gc(()=>{var a=!1;e((c,l=!0)=>{a=!0,i(l,c)}),a||i(!1,null)},s)}function zf(n,e){return e}function a_(n,e,t){for(var r=n.items,s=[],i=e.length,a=0;a<i;a++)_c(e[a].e,s,!0);var c=i>0&&s.length===0&&t!==null;if(c){var l=t.parentNode;xg(l),l.append(t),r.clear(),yt(n,e[0].prev,e[i-1].next)}Mf(s,()=>{for(var h=0;h<i;h++){var d=e[h];c||(r.delete(d.k),yt(n,d.prev,d.next)),qe(d.e,!c)}})}function Hf(n,e,t,r,s,i=null){var a=n,c={flags:e,items:new Map,first:null},l=(e&ff)!==0;if(l){var h=n;a=h.appendChild(Wn())}var d=null,m=!1,g=new Map,I=dc(()=>{var O=t();return oc(O)?O:O==null?[]:ac(O)}),S,C;function R(){c_(C,S,c,g,a,s,e,r,t),i!==null&&(S.length===0?d?yc(d):d=at(()=>i(a)):d!==null&&yr(d,()=>{d=null}))}gc(()=>{C??=ee,S=L(I);var O=S.length;if(!(m&&O===0)){m=O===0;var x,V,H,W;if(Cf()){var U=new Set,E=oe;for(V=0;V<O;V+=1){H=S[V],W=r(H,V);var _=c.items.get(W)??g.get(W);_?(e&(so|io))!==0&&Wf(_,H,V,e):(x=Gf(null,c,null,null,H,W,V,s,e,t,!0),g.set(W,x)),U.add(W)}for(const[v,w]of c.items)U.has(v)||E.skipped_effects.add(w.e);E.oncommit(R)}else R();L(I)}})}function c_(n,e,t,r,s,i,a,c,l){var h=(a&ug)!==0,d=(a&(so|io))!==0,m=e.length,g=t.items,I=t.first,S=I,C,R=null,O,x=[],V=[],H,W,U,E;if(h)for(E=0;E<m;E+=1)H=e[E],W=c(H,E),U=g.get(W),U!==void 0&&(U.a?.measure(),(O??=new Set).add(U));for(E=0;E<m;E+=1){if(H=e[E],W=c(H,E),U=g.get(W),U===void 0){var _=r.get(W);if(_!==void 0){r.delete(W),g.set(W,_);var v=R?R.next:S;yt(t,R,_),yt(t,_,v),ua(_,v,s),R=_}else{var w=S?S.e.nodes_start:s;R=Gf(w,t,R,R===null?t.first:R.next,H,W,E,i,a,l)}g.set(W,R),x=[],V=[],S=R.next;continue}if(d&&Wf(U,H,E,a),(U.e.f&Ze)!==0&&(yc(U.e),h&&(U.a?.unfix(),(O??=new Set).delete(U))),U!==S){if(C!==void 0&&C.has(U)){if(x.length<V.length){var T=V[0],A;R=T.prev;var y=x[0],de=x[x.length-1];for(A=0;A<x.length;A+=1)ua(x[A],T,s);for(A=0;A<V.length;A+=1)C.delete(V[A]);yt(t,y.prev,de.next),yt(t,R,y),yt(t,de,T),S=T,R=de,E-=1,x=[],V=[]}else C.delete(U),ua(U,S,s),yt(t,U.prev,U.next),yt(t,U,R===null?t.first:R.next),yt(t,R,U),R=U;continue}for(x=[],V=[];S!==null&&S.k!==W;)(S.e.f&Ze)===0&&(C??=new Set).add(S),V.push(S),S=S.next;if(S===null)continue;U=S}x.push(U),R=U,S=U.next}if(S!==null||C!==void 0){for(var Ae=C===void 0?[]:ac(C);S!==null;)(S.e.f&Ze)===0&&Ae.push(S),S=S.next;var et=Ae.length;if(et>0){var pt=(a&ff)!==0&&m===0?s:null;if(h){for(E=0;E<et;E+=1)Ae[E].a?.measure();for(E=0;E<et;E+=1)Ae[E].a?.fix()}a_(t,Ae,pt)}}h&&Ls(()=>{if(O!==void 0)for(U of O)U.a?.apply()}),n.first=t.first&&t.first.e,n.last=R&&R.e;for(var mt of r.values())qe(mt.e);r.clear()}function Wf(n,e,t,r){(r&so)!==0&&Pr(n.v,e),(r&io)!==0?Pr(n.i,t):n.i=t}function Gf(n,e,t,r,s,i,a,c,l,h,d){var m=(l&so)!==0,g=(l&lg)===0,I=m?g?we(s,!1,!1):Hn(s):s,S=(l&io)===0?a:Hn(a),C={i:S,v:I,k:i,a:null,e:null,prev:t,next:r};try{if(n===null){var R=document.createDocumentFragment();R.append(n=Wn())}return C.e=at(()=>c(n,I,S,h),Eg),C.e.prev=t&&t.e,C.e.next=r&&r.e,t===null?d||(e.first=C):(t.next=C,t.e.next=C.e),r!==null&&(r.prev=C,r.e.prev=C.e),C}finally{}}function ua(n,e,t){for(var r=n.next?n.next.e.nodes_start:t,s=e?e.e.nodes_start:t,i=n.e.nodes_start;i!==null&&i!==r;){var a=xs(i);s.before(i),i=a}}function yt(n,e,t){e===null?n.first=t:(e.next=t,e.e.next=t&&t.e),t!==null&&(t.prev=e,t.e.prev=e&&e.e)}function Ec(n,e,t,r,s){var i=e.$$slots?.[t],a=!1;i===!0&&(i=e.children,a=!0),i===void 0||i(n,a?()=>r:r)}const Sl=[...` 	
\r\fÂ \v\uFEFF`];function u_(n,e,t){var r=n==null?"":""+n;if(t){for(var s in t)if(t[s])r=r?r+" "+s:s;else if(r.length)for(var i=s.length,a=0;(a=r.indexOf(s,a))>=0;){var c=a+i;(a===0||Sl.includes(r[a-1]))&&(c===r.length||Sl.includes(r[c]))?r=(a===0?"":r.substring(0,a))+r.substring(c+1):a=c}}return r===""?null:r}function Tc(n,e,t,r,s,i){var a=n.__className;if(a!==t||a===void 0){var c=u_(t,r,i);c==null?n.removeAttribute("class"):n.className=c,n.__className=t}else if(i&&s!==i)for(var l in i){var h=!!i[l];(s==null||h!==!!s[l])&&n.classList.toggle(l,h)}return i}const l_=Symbol("is custom element"),h_=Symbol("is html");function vi(n,e,t,r){var s=f_(n);s[e]!==(s[e]=t)&&(e==="loading"&&(n[Ym]=t),t==null?n.removeAttribute(e):typeof t!="string"&&d_(n).includes(e)?n[e]=t:n.setAttribute(e,t))}function f_(n){return n.__attributes??={[l_]:n.nodeName.includes("-"),[h_]:n.namespaceURI===yg}}var Rl=new Map;function d_(n){var e=n.getAttribute("is")||n.nodeName,t=Rl.get(e);if(t)return t;Rl.set(e,t=[]);for(var r,s=n,i=Element.prototype;i!==s;){r=cf(s);for(var a in r)r[a].set&&t.push(a);s=cc(s)}return t}function vr(n,e,t=e){var r=new WeakSet;Ug(n,"input",async s=>{var i=s?n.defaultValue:n.value;if(i=la(n)?ha(i):i,t(i),oe!==null&&r.add(oe),await Qg(),i!==(i=e())){var a=n.selectionStart,c=n.selectionEnd,l=n.value.length;if(n.value=i??"",c!==null){var h=n.value.length;a===c&&c===l&&h>l?(n.selectionStart=h,n.selectionEnd=h):(n.selectionStart=a,n.selectionEnd=Math.min(c,h))}}}),je(e)==null&&n.value&&(t(la(n)?ha(n.value):n.value),oe!==null&&r.add(oe)),lo(()=>{var s=e();if(n===document.activeElement){var i=yi??oe;if(r.has(i))return}la(n)&&s===ha(n.value)||n.type==="date"&&!s&&!n.value||s!==n.value&&(n.value=s??"")})}function la(n){var e=n.type;return e==="number"||e==="range"}function ha(n){return n===""?null:+n}function Kf(n){return function(...e){var t=e[0];return t.preventDefault(),n?.apply(this,e)}}function dt(n=!1){const e=re,t=e.l.u;if(!t)return;let r=()=>Jg(e.s);if(n){let s=0,i={};const a=ao(()=>{let c=!1;const l=e.s;for(const h in l)l[h]!==i[h]&&(i[h]=l[h],c=!0);return c&&s++,s});r=()=>L(a)}t.b.length&&$g(()=>{Pl(e,r),Aa(t.b)}),ka(()=>{const s=je(()=>t.m.map(Xm));return()=>{for(const i of s)typeof i=="function"&&i()}}),t.a.length&&ka(()=>{Pl(e,r),Aa(t.a)})}function Pl(n,e){if(n.l.s)for(const t of n.l.s)L(t);e()}function Qf(n,e,t){if(n==null)return e(void 0),gr;const r=je(()=>n.subscribe(e,t));return r.unsubscribe?()=>r.unsubscribe():r}const cr=[];function fo(n,e=gr){let t=null;const r=new Set;function s(c){if(pf(n,c)&&(n=c,t)){const l=!cr.length;for(const h of r)h[1](),cr.push(h,n);if(l){for(let h=0;h<cr.length;h+=2)cr[h][0](cr[h+1]);cr.length=0}}}function i(c){s(c(n))}function a(c,l=gr){const h=[c,l];return r.add(h),r.size===1&&(t=e(s,i)||gr),c(n),()=>{r.delete(h),r.size===0&&t&&(t(),t=null)}}return{set:s,update:i,subscribe:a}}function p_(n){let e;return Qf(n,t=>e=t)(),e}let hi=!1,Va=Symbol();function jt(n,e,t){const r=t[e]??={store:null,source:we(void 0),unsubscribe:gr};if(r.store!==n&&!(Va in t))if(r.unsubscribe(),r.store=n??null,n==null)r.source.v=void 0,r.unsubscribe=gr;else{var s=!0;r.unsubscribe=Qf(n,i=>{s?r.source.v=i:K(r.source,i)}),s=!1}return n&&Va in t?p_(n):L(r.source)}function Bs(){const n={};function e(){mc(()=>{for(var t in n)n[t].unsubscribe();af(n,Va,{enumerable:!1,value:!0})})}return[n,e]}function m_(n){var e=hi;try{return hi=!1,[n(),hi]}finally{hi=e}}function It(n,e,t,r){var s=!Br||(t&fg)!==0,i=(t&pg)!==0,a=(t&mg)!==0,c=r,l=!0,h=()=>(l&&(l=!1,c=a?je(r):r),c),d;if(i){var m=_r in n||Jm in n;d=mr(n,e)?.set??(m&&e in n?V=>n[e]=V:void 0)}var g,I=!1;i?[g,I]=m_(()=>n[e]):g=n[e],g===void 0&&r!==void 0&&(g=h(),d&&(s&&sg(),d(g)));var S;if(s?S=()=>{var V=n[e];return V===void 0?h():(l=!0,V)}:S=()=>{var V=n[e];return V!==void 0&&(c=void 0),V===void 0?c:V},s&&(t&dg)===0)return S;if(d){var C=n.$$legacy;return(function(V,H){return arguments.length>0?((!s||!H||C||I)&&d(H?S():V),V):S()})}var R=!1,O=((t&hg)!==0?ao:dc)(()=>(R=!1,S()));i&&L(O);var x=ee;return(function(V,H){if(arguments.length>0){const W=H?L(O):s&&i?pr(V):V;return K(O,W),R=!0,c!==void 0&&(c=W),V}return tr&&R||(x.f&ln)!==0?O.v:L(O)})}function Xf(n){re===null&&fc(),Br&&re.l!==null?__(re).m.push(n):ka(()=>{const e=je(n);if(typeof e=="function")return e})}function g_(n,e,{bubbles:t=!1,cancelable:r=!1}={}){return new CustomEvent(n,{detail:e,bubbles:t,cancelable:r})}function po(){const n=re;return n===null&&fc(),(e,t,r)=>{const s=n.s.$$events?.[e];if(s){const i=oc(s)?s.slice():[s],a=g_(e,t,r);for(const c of i)c.call(n.x,a);return!a.defaultPrevented}return!0}}function __(n){var e=n.l;return e.u??={a:[],b:[],m:[]}}const y_="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(y_);wg();const v_=()=>{};var Cl={};const Jf=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let s=n.charCodeAt(r);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},E_=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const s=n[t++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=n[t++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=n[t++],a=n[t++],c=n[t++],l=((s&7)<<18|(i&63)<<12|(a&63)<<6|c&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const i=n[t++],a=n[t++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|a&63)}}return e.join("")},Yf={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<n.length;s+=3){const i=n[s],a=s+1<n.length,c=a?n[s+1]:0,l=s+2<n.length,h=l?n[s+2]:0,d=i>>2,m=(i&3)<<4|c>>4;let g=(c&15)<<2|h>>6,I=h&63;l||(I=64,a||(g=64)),r.push(t[d],t[m],t[g],t[I])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(Jf(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):E_(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<n.length;){const i=t[n.charAt(s++)],c=s<n.length?t[n.charAt(s)]:0;++s;const h=s<n.length?t[n.charAt(s)]:64;++s;const m=s<n.length?t[n.charAt(s)]:64;if(++s,i==null||c==null||h==null||m==null)throw new T_;const g=i<<2|c>>4;if(r.push(g),h!==64){const I=c<<4&240|h>>2;if(r.push(I),m!==64){const S=h<<6&192|m;r.push(S)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class T_ extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const w_=function(n){const e=Jf(n);return Yf.encodeByteArray(e,!0)},Vi=function(n){return w_(n).replace(/\./g,"")},Zf=function(n){try{return Yf.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function I_(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const A_=()=>I_().__FIREBASE_DEFAULTS__,b_=()=>{if(typeof process>"u"||typeof Cl>"u")return;const n=Cl.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},S_=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&Zf(n[1]);return e&&JSON.parse(e)},mo=()=>{try{return v_()||A_()||b_()||S_()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},ed=n=>mo()?.emulatorHosts?.[n],td=n=>{const e=ed(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},nd=()=>mo()?.config,rd=n=>mo()?.[`_${n}`];class R_{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}function Sn(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function wc(n){return(await fetch(n,{credentials:"include"})).ok}function P_(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",s=n.iat||0,i=n.sub||n.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a={iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...n};return[Vi(JSON.stringify(t)),Vi(JSON.stringify(a)),""].join(".")}const ys={};function C_(){const n={prod:[],emulator:[]};for(const e of Object.keys(ys))ys[e]?n.emulator.push(e):n.prod.push(e);return n}function k_(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let kl=!1;function Ic(n,e){if(typeof window>"u"||typeof document>"u"||!Sn(window.location.host)||ys[n]===e||ys[n]||kl)return;ys[n]=e;function t(g){return`__firebase__banner__${g}`}const r="__firebase__banner",i=C_().prod.length>0;function a(){const g=document.getElementById(r);g&&g.remove()}function c(g){g.style.display="flex",g.style.background="#7faaf0",g.style.position="fixed",g.style.bottom="5px",g.style.left="5px",g.style.padding=".5em",g.style.borderRadius="5px",g.style.alignItems="center"}function l(g,I){g.setAttribute("width","24"),g.setAttribute("id",I),g.setAttribute("height","24"),g.setAttribute("viewBox","0 0 24 24"),g.setAttribute("fill","none"),g.style.marginLeft="-6px"}function h(){const g=document.createElement("span");return g.style.cursor="pointer",g.style.marginLeft="16px",g.style.fontSize="24px",g.innerHTML=" &times;",g.onclick=()=>{kl=!0,a()},g}function d(g,I){g.setAttribute("id",I),g.innerText="Learn more",g.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",g.setAttribute("target","__blank"),g.style.paddingLeft="5px",g.style.textDecoration="underline"}function m(){const g=k_(r),I=t("text"),S=document.getElementById(I)||document.createElement("span"),C=t("learnmore"),R=document.getElementById(C)||document.createElement("a"),O=t("preprendIcon"),x=document.getElementById(O)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(g.created){const V=g.element;c(V),d(R,C);const H=h();l(x,O),V.append(x,S,R,H),document.body.appendChild(V)}i?(S.innerText="Preview backend disconnected.",x.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(x.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,S.innerText="Preview backend running in this workspace."),S.setAttribute("id",I)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",m):m()}function Fe(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function N_(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Fe())}function D_(){const n=mo()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function V_(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function O_(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function M_(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function L_(){const n=Fe();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function x_(){return!D_()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function F_(){try{return typeof indexedDB=="object"}catch{return!1}}function U_(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{e(s.error?.message||"")}}catch(t){e(t)}})}const B_="FirebaseError";class Mt extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=B_,Object.setPrototypeOf(this,Mt.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,$s.prototype.create)}}class $s{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},s=`${this.service}/${e}`,i=this.errors[e],a=i?$_(i,r):"Error",c=`${this.serviceName}: ${a} (${s}).`;return new Mt(s,c,r)}}function $_(n,e){return n.replace(j_,(t,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const j_=/\{\$([^}]+)}/g;function q_(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Kn(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const s of t){if(!r.includes(s))return!1;const i=n[s],a=e[s];if(Nl(i)&&Nl(a)){if(!Kn(i,a))return!1}else if(i!==a)return!1}for(const s of r)if(!t.includes(s))return!1;return!0}function Nl(n){return n!==null&&typeof n=="object"}function js(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function z_(n,e){const t=new H_(n,e);return t.subscribe.bind(t)}class H_{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let s;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");W_(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:r},s.next===void 0&&(s.next=fa),s.error===void 0&&(s.error=fa),s.complete===void 0&&(s.complete=fa);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function W_(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function fa(){}function ye(n){return n&&n._delegate?n._delegate:n}class vn{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const On="[DEFAULT]";class G_{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new R_;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Q_(e))try{this.getOrInitializeService({instanceIdentifier:On})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=On){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=On){return this.instances.has(e)}getOptions(e=On){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[i,a]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(i);r===c&&a.resolve(s)}return s}onInit(e,t){const r=this.normalizeInstanceIdentifier(t),s=this.onInitCallbacks.get(r)??new Set;s.add(e),this.onInitCallbacks.set(r,s);const i=this.instances.get(r);return i&&e(i,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const s of r)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:K_(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=On){return this.component?this.component.multipleInstances?e:On:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function K_(n){return n===On?void 0:n}function Q_(n){return n.instantiationMode==="EAGER"}class X_{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new G_(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var Q;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Q||(Q={}));const J_={debug:Q.DEBUG,verbose:Q.VERBOSE,info:Q.INFO,warn:Q.WARN,error:Q.ERROR,silent:Q.SILENT},Y_=Q.INFO,Z_={[Q.DEBUG]:"log",[Q.VERBOSE]:"log",[Q.INFO]:"info",[Q.WARN]:"warn",[Q.ERROR]:"error"},ey=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),s=Z_[e];if(s)console[s](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Ac{constructor(e){this.name=e,this._logLevel=Y_,this._logHandler=ey,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Q))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?J_[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Q.DEBUG,...e),this._logHandler(this,Q.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Q.VERBOSE,...e),this._logHandler(this,Q.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Q.INFO,...e),this._logHandler(this,Q.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Q.WARN,...e),this._logHandler(this,Q.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Q.ERROR,...e),this._logHandler(this,Q.ERROR,...e)}}const ty=(n,e)=>e.some(t=>n instanceof t);let Dl,Vl;function ny(){return Dl||(Dl=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function ry(){return Vl||(Vl=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const sd=new WeakMap,Oa=new WeakMap,id=new WeakMap,da=new WeakMap,bc=new WeakMap;function sy(n){const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("success",i),n.removeEventListener("error",a)},i=()=>{t(dn(n.result)),s()},a=()=>{r(n.error),s()};n.addEventListener("success",i),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&sd.set(t,n)}).catch(()=>{}),bc.set(e,n),e}function iy(n){if(Oa.has(n))return;const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("complete",i),n.removeEventListener("error",a),n.removeEventListener("abort",a)},i=()=>{t(),s()},a=()=>{r(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",i),n.addEventListener("error",a),n.addEventListener("abort",a)});Oa.set(n,e)}let Ma={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Oa.get(n);if(e==="objectStoreNames")return n.objectStoreNames||id.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return dn(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function oy(n){Ma=n(Ma)}function ay(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(pa(this),e,...t);return id.set(r,e.sort?e.sort():[e]),dn(r)}:ry().includes(n)?function(...e){return n.apply(pa(this),e),dn(sd.get(this))}:function(...e){return dn(n.apply(pa(this),e))}}function cy(n){return typeof n=="function"?ay(n):(n instanceof IDBTransaction&&iy(n),ty(n,ny())?new Proxy(n,Ma):n)}function dn(n){if(n instanceof IDBRequest)return sy(n);if(da.has(n))return da.get(n);const e=cy(n);return e!==n&&(da.set(n,e),bc.set(e,n)),e}const pa=n=>bc.get(n);function uy(n,e,{blocked:t,upgrade:r,blocking:s,terminated:i}={}){const a=indexedDB.open(n,e),c=dn(a);return r&&a.addEventListener("upgradeneeded",l=>{r(dn(a.result),l.oldVersion,l.newVersion,dn(a.transaction),l)}),t&&a.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),c.then(l=>{i&&l.addEventListener("close",()=>i()),s&&l.addEventListener("versionchange",h=>s(h.oldVersion,h.newVersion,h))}).catch(()=>{}),c}const ly=["get","getKey","getAll","getAllKeys","count"],hy=["put","add","delete","clear"],ma=new Map;function Ol(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(ma.get(e))return ma.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,s=hy.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(s||ly.includes(t)))return;const i=async function(a,...c){const l=this.transaction(a,s?"readwrite":"readonly");let h=l.store;return r&&(h=h.index(c.shift())),(await Promise.all([h[t](...c),s&&l.done]))[0]};return ma.set(e,i),i}oy(n=>({...n,get:(e,t,r)=>Ol(e,t)||n.get(e,t,r),has:(e,t)=>!!Ol(e,t)||n.has(e,t)}));class fy{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(dy(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function dy(n){return n.getComponent()?.type==="VERSION"}const La="@firebase/app",Ml="0.14.5";const qt=new Ac("@firebase/app"),py="@firebase/app-compat",my="@firebase/analytics-compat",gy="@firebase/analytics",_y="@firebase/app-check-compat",yy="@firebase/app-check",vy="@firebase/auth",Ey="@firebase/auth-compat",Ty="@firebase/database",wy="@firebase/data-connect",Iy="@firebase/database-compat",Ay="@firebase/functions",by="@firebase/functions-compat",Sy="@firebase/installations",Ry="@firebase/installations-compat",Py="@firebase/messaging",Cy="@firebase/messaging-compat",ky="@firebase/performance",Ny="@firebase/performance-compat",Dy="@firebase/remote-config",Vy="@firebase/remote-config-compat",Oy="@firebase/storage",My="@firebase/storage-compat",Ly="@firebase/firestore",xy="@firebase/ai",Fy="@firebase/firestore-compat",Uy="firebase",By="12.5.0";const xa="[DEFAULT]",$y={[La]:"fire-core",[py]:"fire-core-compat",[gy]:"fire-analytics",[my]:"fire-analytics-compat",[yy]:"fire-app-check",[_y]:"fire-app-check-compat",[vy]:"fire-auth",[Ey]:"fire-auth-compat",[Ty]:"fire-rtdb",[wy]:"fire-data-connect",[Iy]:"fire-rtdb-compat",[Ay]:"fire-fn",[by]:"fire-fn-compat",[Sy]:"fire-iid",[Ry]:"fire-iid-compat",[Py]:"fire-fcm",[Cy]:"fire-fcm-compat",[ky]:"fire-perf",[Ny]:"fire-perf-compat",[Dy]:"fire-rc",[Vy]:"fire-rc-compat",[Oy]:"fire-gcs",[My]:"fire-gcs-compat",[Ly]:"fire-fst",[Fy]:"fire-fst-compat",[xy]:"fire-vertex","fire-js":"fire-js",[Uy]:"fire-js-all"};const Oi=new Map,jy=new Map,Fa=new Map;function Ll(n,e){try{n.container.addComponent(e)}catch(t){qt.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Qn(n){const e=n.name;if(Fa.has(e))return qt.debug(`There were multiple attempts to register component ${e}.`),!1;Fa.set(e,n);for(const t of Oi.values())Ll(t,n);for(const t of jy.values())Ll(t,n);return!0}function go(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function nt(n){return n==null?!1:n.settings!==void 0}const qy={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},pn=new $s("app","Firebase",qy);class zy{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new vn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw pn.create("app-deleted",{appName:this._name})}}const jr=By;function od(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r={name:xa,automaticDataCollectionEnabled:!0,...e},s=r.name;if(typeof s!="string"||!s)throw pn.create("bad-app-name",{appName:String(s)});if(t||(t=nd()),!t)throw pn.create("no-options");const i=Oi.get(s);if(i){if(Kn(t,i.options)&&Kn(r,i.config))return i;throw pn.create("duplicate-app",{appName:s})}const a=new X_(s);for(const l of Fa.values())a.addComponent(l);const c=new zy(t,r,a);return Oi.set(s,c),c}function Sc(n=xa){const e=Oi.get(n);if(!e&&n===xa&&nd())return od();if(!e)throw pn.create("no-app",{appName:n});return e}function At(n,e,t){let r=$y[n]??n;t&&(r+=`-${t}`);const s=r.match(/\s|\//),i=e.match(/\s|\//);if(s||i){const a=[`Unable to register library "${r}" with version "${e}":`];s&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&i&&a.push("and"),i&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),qt.warn(a.join(" "));return}Qn(new vn(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}const Hy="firebase-heartbeat-database",Wy=1,Rs="firebase-heartbeat-store";let ga=null;function ad(){return ga||(ga=uy(Hy,Wy,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Rs)}catch(t){console.warn(t)}}}}).catch(n=>{throw pn.create("idb-open",{originalErrorMessage:n.message})})),ga}async function Gy(n){try{const t=(await ad()).transaction(Rs),r=await t.objectStore(Rs).get(cd(n));return await t.done,r}catch(e){if(e instanceof Mt)qt.warn(e.message);else{const t=pn.create("idb-get",{originalErrorMessage:e?.message});qt.warn(t.message)}}}async function xl(n,e){try{const r=(await ad()).transaction(Rs,"readwrite");await r.objectStore(Rs).put(e,cd(n)),await r.done}catch(t){if(t instanceof Mt)qt.warn(t.message);else{const r=pn.create("idb-set",{originalErrorMessage:t?.message});qt.warn(r.message)}}}function cd(n){return`${n.name}!${n.options.appId}`}const Ky=1024,Qy=30;class Xy{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Yy(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=Fl();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(s=>s.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:t}),this._heartbeatsCache.heartbeats.length>Qy){const s=Zy(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(s,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){qt.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Fl(),{heartbeatsToSend:t,unsentEntries:r}=Jy(this._heartbeatsCache.heartbeats),s=Vi(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(e){return qt.warn(e),""}}}function Fl(){return new Date().toISOString().substring(0,10)}function Jy(n,e=Ky){const t=[];let r=n.slice();for(const s of n){const i=t.find(a=>a.agent===s.agent);if(i){if(i.dates.push(s.date),Ul(t)>e){i.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),Ul(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class Yy{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return F_()?U_().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await Gy(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return xl(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return xl(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function Ul(n){return Vi(JSON.stringify({version:2,heartbeats:n})).length}function Zy(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function ev(n){Qn(new vn("platform-logger",e=>new fy(e),"PRIVATE")),Qn(new vn("heartbeat",e=>new Xy(e),"PRIVATE")),At(La,Ml,n),At(La,Ml,"esm2020"),At("fire-js","")}ev("");var tv="firebase",nv="12.5.0";At(tv,nv,"app");var Bl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var mn,ud;(function(){var n;function e(E,_){function v(){}v.prototype=_.prototype,E.F=_.prototype,E.prototype=new v,E.prototype.constructor=E,E.D=function(w,T,A){for(var y=Array(arguments.length-2),de=2;de<arguments.length;de++)y[de-2]=arguments[de];return _.prototype[T].apply(w,y)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(E,_,v){v||(v=0);const w=Array(16);if(typeof _=="string")for(var T=0;T<16;++T)w[T]=_.charCodeAt(v++)|_.charCodeAt(v++)<<8|_.charCodeAt(v++)<<16|_.charCodeAt(v++)<<24;else for(T=0;T<16;++T)w[T]=_[v++]|_[v++]<<8|_[v++]<<16|_[v++]<<24;_=E.g[0],v=E.g[1],T=E.g[2];let A=E.g[3],y;y=_+(A^v&(T^A))+w[0]+3614090360&4294967295,_=v+(y<<7&4294967295|y>>>25),y=A+(T^_&(v^T))+w[1]+3905402710&4294967295,A=_+(y<<12&4294967295|y>>>20),y=T+(v^A&(_^v))+w[2]+606105819&4294967295,T=A+(y<<17&4294967295|y>>>15),y=v+(_^T&(A^_))+w[3]+3250441966&4294967295,v=T+(y<<22&4294967295|y>>>10),y=_+(A^v&(T^A))+w[4]+4118548399&4294967295,_=v+(y<<7&4294967295|y>>>25),y=A+(T^_&(v^T))+w[5]+1200080426&4294967295,A=_+(y<<12&4294967295|y>>>20),y=T+(v^A&(_^v))+w[6]+2821735955&4294967295,T=A+(y<<17&4294967295|y>>>15),y=v+(_^T&(A^_))+w[7]+4249261313&4294967295,v=T+(y<<22&4294967295|y>>>10),y=_+(A^v&(T^A))+w[8]+1770035416&4294967295,_=v+(y<<7&4294967295|y>>>25),y=A+(T^_&(v^T))+w[9]+2336552879&4294967295,A=_+(y<<12&4294967295|y>>>20),y=T+(v^A&(_^v))+w[10]+4294925233&4294967295,T=A+(y<<17&4294967295|y>>>15),y=v+(_^T&(A^_))+w[11]+2304563134&4294967295,v=T+(y<<22&4294967295|y>>>10),y=_+(A^v&(T^A))+w[12]+1804603682&4294967295,_=v+(y<<7&4294967295|y>>>25),y=A+(T^_&(v^T))+w[13]+4254626195&4294967295,A=_+(y<<12&4294967295|y>>>20),y=T+(v^A&(_^v))+w[14]+2792965006&4294967295,T=A+(y<<17&4294967295|y>>>15),y=v+(_^T&(A^_))+w[15]+1236535329&4294967295,v=T+(y<<22&4294967295|y>>>10),y=_+(T^A&(v^T))+w[1]+4129170786&4294967295,_=v+(y<<5&4294967295|y>>>27),y=A+(v^T&(_^v))+w[6]+3225465664&4294967295,A=_+(y<<9&4294967295|y>>>23),y=T+(_^v&(A^_))+w[11]+643717713&4294967295,T=A+(y<<14&4294967295|y>>>18),y=v+(A^_&(T^A))+w[0]+3921069994&4294967295,v=T+(y<<20&4294967295|y>>>12),y=_+(T^A&(v^T))+w[5]+3593408605&4294967295,_=v+(y<<5&4294967295|y>>>27),y=A+(v^T&(_^v))+w[10]+38016083&4294967295,A=_+(y<<9&4294967295|y>>>23),y=T+(_^v&(A^_))+w[15]+3634488961&4294967295,T=A+(y<<14&4294967295|y>>>18),y=v+(A^_&(T^A))+w[4]+3889429448&4294967295,v=T+(y<<20&4294967295|y>>>12),y=_+(T^A&(v^T))+w[9]+568446438&4294967295,_=v+(y<<5&4294967295|y>>>27),y=A+(v^T&(_^v))+w[14]+3275163606&4294967295,A=_+(y<<9&4294967295|y>>>23),y=T+(_^v&(A^_))+w[3]+4107603335&4294967295,T=A+(y<<14&4294967295|y>>>18),y=v+(A^_&(T^A))+w[8]+1163531501&4294967295,v=T+(y<<20&4294967295|y>>>12),y=_+(T^A&(v^T))+w[13]+2850285829&4294967295,_=v+(y<<5&4294967295|y>>>27),y=A+(v^T&(_^v))+w[2]+4243563512&4294967295,A=_+(y<<9&4294967295|y>>>23),y=T+(_^v&(A^_))+w[7]+1735328473&4294967295,T=A+(y<<14&4294967295|y>>>18),y=v+(A^_&(T^A))+w[12]+2368359562&4294967295,v=T+(y<<20&4294967295|y>>>12),y=_+(v^T^A)+w[5]+4294588738&4294967295,_=v+(y<<4&4294967295|y>>>28),y=A+(_^v^T)+w[8]+2272392833&4294967295,A=_+(y<<11&4294967295|y>>>21),y=T+(A^_^v)+w[11]+1839030562&4294967295,T=A+(y<<16&4294967295|y>>>16),y=v+(T^A^_)+w[14]+4259657740&4294967295,v=T+(y<<23&4294967295|y>>>9),y=_+(v^T^A)+w[1]+2763975236&4294967295,_=v+(y<<4&4294967295|y>>>28),y=A+(_^v^T)+w[4]+1272893353&4294967295,A=_+(y<<11&4294967295|y>>>21),y=T+(A^_^v)+w[7]+4139469664&4294967295,T=A+(y<<16&4294967295|y>>>16),y=v+(T^A^_)+w[10]+3200236656&4294967295,v=T+(y<<23&4294967295|y>>>9),y=_+(v^T^A)+w[13]+681279174&4294967295,_=v+(y<<4&4294967295|y>>>28),y=A+(_^v^T)+w[0]+3936430074&4294967295,A=_+(y<<11&4294967295|y>>>21),y=T+(A^_^v)+w[3]+3572445317&4294967295,T=A+(y<<16&4294967295|y>>>16),y=v+(T^A^_)+w[6]+76029189&4294967295,v=T+(y<<23&4294967295|y>>>9),y=_+(v^T^A)+w[9]+3654602809&4294967295,_=v+(y<<4&4294967295|y>>>28),y=A+(_^v^T)+w[12]+3873151461&4294967295,A=_+(y<<11&4294967295|y>>>21),y=T+(A^_^v)+w[15]+530742520&4294967295,T=A+(y<<16&4294967295|y>>>16),y=v+(T^A^_)+w[2]+3299628645&4294967295,v=T+(y<<23&4294967295|y>>>9),y=_+(T^(v|~A))+w[0]+4096336452&4294967295,_=v+(y<<6&4294967295|y>>>26),y=A+(v^(_|~T))+w[7]+1126891415&4294967295,A=_+(y<<10&4294967295|y>>>22),y=T+(_^(A|~v))+w[14]+2878612391&4294967295,T=A+(y<<15&4294967295|y>>>17),y=v+(A^(T|~_))+w[5]+4237533241&4294967295,v=T+(y<<21&4294967295|y>>>11),y=_+(T^(v|~A))+w[12]+1700485571&4294967295,_=v+(y<<6&4294967295|y>>>26),y=A+(v^(_|~T))+w[3]+2399980690&4294967295,A=_+(y<<10&4294967295|y>>>22),y=T+(_^(A|~v))+w[10]+4293915773&4294967295,T=A+(y<<15&4294967295|y>>>17),y=v+(A^(T|~_))+w[1]+2240044497&4294967295,v=T+(y<<21&4294967295|y>>>11),y=_+(T^(v|~A))+w[8]+1873313359&4294967295,_=v+(y<<6&4294967295|y>>>26),y=A+(v^(_|~T))+w[15]+4264355552&4294967295,A=_+(y<<10&4294967295|y>>>22),y=T+(_^(A|~v))+w[6]+2734768916&4294967295,T=A+(y<<15&4294967295|y>>>17),y=v+(A^(T|~_))+w[13]+1309151649&4294967295,v=T+(y<<21&4294967295|y>>>11),y=_+(T^(v|~A))+w[4]+4149444226&4294967295,_=v+(y<<6&4294967295|y>>>26),y=A+(v^(_|~T))+w[11]+3174756917&4294967295,A=_+(y<<10&4294967295|y>>>22),y=T+(_^(A|~v))+w[2]+718787259&4294967295,T=A+(y<<15&4294967295|y>>>17),y=v+(A^(T|~_))+w[9]+3951481745&4294967295,E.g[0]=E.g[0]+_&4294967295,E.g[1]=E.g[1]+(T+(y<<21&4294967295|y>>>11))&4294967295,E.g[2]=E.g[2]+T&4294967295,E.g[3]=E.g[3]+A&4294967295}r.prototype.v=function(E,_){_===void 0&&(_=E.length);const v=_-this.blockSize,w=this.C;let T=this.h,A=0;for(;A<_;){if(T==0)for(;A<=v;)s(this,E,A),A+=this.blockSize;if(typeof E=="string"){for(;A<_;)if(w[T++]=E.charCodeAt(A++),T==this.blockSize){s(this,w),T=0;break}}else for(;A<_;)if(w[T++]=E[A++],T==this.blockSize){s(this,w),T=0;break}}this.h=T,this.o+=_},r.prototype.A=function(){var E=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);E[0]=128;for(var _=1;_<E.length-8;++_)E[_]=0;_=this.o*8;for(var v=E.length-8;v<E.length;++v)E[v]=_&255,_/=256;for(this.v(E),E=Array(16),_=0,v=0;v<4;++v)for(let w=0;w<32;w+=8)E[_++]=this.g[v]>>>w&255;return E};function i(E,_){var v=c;return Object.prototype.hasOwnProperty.call(v,E)?v[E]:v[E]=_(E)}function a(E,_){this.h=_;const v=[];let w=!0;for(let T=E.length-1;T>=0;T--){const A=E[T]|0;w&&A==_||(v[T]=A,w=!1)}this.g=v}var c={};function l(E){return-128<=E&&E<128?i(E,function(_){return new a([_|0],_<0?-1:0)}):new a([E|0],E<0?-1:0)}function h(E){if(isNaN(E)||!isFinite(E))return m;if(E<0)return R(h(-E));const _=[];let v=1;for(let w=0;E>=v;w++)_[w]=E/v|0,v*=4294967296;return new a(_,0)}function d(E,_){if(E.length==0)throw Error("number format error: empty string");if(_=_||10,_<2||36<_)throw Error("radix out of range: "+_);if(E.charAt(0)=="-")return R(d(E.substring(1),_));if(E.indexOf("-")>=0)throw Error('number format error: interior "-" character');const v=h(Math.pow(_,8));let w=m;for(let A=0;A<E.length;A+=8){var T=Math.min(8,E.length-A);const y=parseInt(E.substring(A,A+T),_);T<8?(T=h(Math.pow(_,T)),w=w.j(T).add(h(y))):(w=w.j(v),w=w.add(h(y)))}return w}var m=l(0),g=l(1),I=l(16777216);n=a.prototype,n.m=function(){if(C(this))return-R(this).m();let E=0,_=1;for(let v=0;v<this.g.length;v++){const w=this.i(v);E+=(w>=0?w:4294967296+w)*_,_*=4294967296}return E},n.toString=function(E){if(E=E||10,E<2||36<E)throw Error("radix out of range: "+E);if(S(this))return"0";if(C(this))return"-"+R(this).toString(E);const _=h(Math.pow(E,6));var v=this;let w="";for(;;){const T=H(v,_).g;v=O(v,T.j(_));let A=((v.g.length>0?v.g[0]:v.h)>>>0).toString(E);if(v=T,S(v))return A+w;for(;A.length<6;)A="0"+A;w=A+w}},n.i=function(E){return E<0?0:E<this.g.length?this.g[E]:this.h};function S(E){if(E.h!=0)return!1;for(let _=0;_<E.g.length;_++)if(E.g[_]!=0)return!1;return!0}function C(E){return E.h==-1}n.l=function(E){return E=O(this,E),C(E)?-1:S(E)?0:1};function R(E){const _=E.g.length,v=[];for(let w=0;w<_;w++)v[w]=~E.g[w];return new a(v,~E.h).add(g)}n.abs=function(){return C(this)?R(this):this},n.add=function(E){const _=Math.max(this.g.length,E.g.length),v=[];let w=0;for(let T=0;T<=_;T++){let A=w+(this.i(T)&65535)+(E.i(T)&65535),y=(A>>>16)+(this.i(T)>>>16)+(E.i(T)>>>16);w=y>>>16,A&=65535,y&=65535,v[T]=y<<16|A}return new a(v,v[v.length-1]&-2147483648?-1:0)};function O(E,_){return E.add(R(_))}n.j=function(E){if(S(this)||S(E))return m;if(C(this))return C(E)?R(this).j(R(E)):R(R(this).j(E));if(C(E))return R(this.j(R(E)));if(this.l(I)<0&&E.l(I)<0)return h(this.m()*E.m());const _=this.g.length+E.g.length,v=[];for(var w=0;w<2*_;w++)v[w]=0;for(w=0;w<this.g.length;w++)for(let T=0;T<E.g.length;T++){const A=this.i(w)>>>16,y=this.i(w)&65535,de=E.i(T)>>>16,Ae=E.i(T)&65535;v[2*w+2*T]+=y*Ae,x(v,2*w+2*T),v[2*w+2*T+1]+=A*Ae,x(v,2*w+2*T+1),v[2*w+2*T+1]+=y*de,x(v,2*w+2*T+1),v[2*w+2*T+2]+=A*de,x(v,2*w+2*T+2)}for(E=0;E<_;E++)v[E]=v[2*E+1]<<16|v[2*E];for(E=_;E<2*_;E++)v[E]=0;return new a(v,0)};function x(E,_){for(;(E[_]&65535)!=E[_];)E[_+1]+=E[_]>>>16,E[_]&=65535,_++}function V(E,_){this.g=E,this.h=_}function H(E,_){if(S(_))throw Error("division by zero");if(S(E))return new V(m,m);if(C(E))return _=H(R(E),_),new V(R(_.g),R(_.h));if(C(_))return _=H(E,R(_)),new V(R(_.g),_.h);if(E.g.length>30){if(C(E)||C(_))throw Error("slowDivide_ only works with positive integers.");for(var v=g,w=_;w.l(E)<=0;)v=W(v),w=W(w);var T=U(v,1),A=U(w,1);for(w=U(w,2),v=U(v,2);!S(w);){var y=A.add(w);y.l(E)<=0&&(T=T.add(v),A=y),w=U(w,1),v=U(v,1)}return _=O(E,T.j(_)),new V(T,_)}for(T=m;E.l(_)>=0;){for(v=Math.max(1,Math.floor(E.m()/_.m())),w=Math.ceil(Math.log(v)/Math.LN2),w=w<=48?1:Math.pow(2,w-48),A=h(v),y=A.j(_);C(y)||y.l(E)>0;)v-=w,A=h(v),y=A.j(_);S(A)&&(A=g),T=T.add(A),E=O(E,y)}return new V(T,E)}n.B=function(E){return H(this,E).h},n.and=function(E){const _=Math.max(this.g.length,E.g.length),v=[];for(let w=0;w<_;w++)v[w]=this.i(w)&E.i(w);return new a(v,this.h&E.h)},n.or=function(E){const _=Math.max(this.g.length,E.g.length),v=[];for(let w=0;w<_;w++)v[w]=this.i(w)|E.i(w);return new a(v,this.h|E.h)},n.xor=function(E){const _=Math.max(this.g.length,E.g.length),v=[];for(let w=0;w<_;w++)v[w]=this.i(w)^E.i(w);return new a(v,this.h^E.h)};function W(E){const _=E.g.length+1,v=[];for(let w=0;w<_;w++)v[w]=E.i(w)<<1|E.i(w-1)>>>31;return new a(v,E.h)}function U(E,_){const v=_>>5;_%=32;const w=E.g.length-v,T=[];for(let A=0;A<w;A++)T[A]=_>0?E.i(A+v)>>>_|E.i(A+v+1)<<32-_:E.i(A+v);return new a(T,E.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,ud=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.B,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=h,a.fromString=d,mn=a}).apply(typeof Bl<"u"?Bl:typeof self<"u"?self:typeof window<"u"?window:{});var fi=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var ld,fs,hd,Ei,Ua,fd,dd,pd;(function(){var n,e=Object.defineProperty;function t(o){o=[typeof globalThis=="object"&&globalThis,o,typeof window=="object"&&window,typeof self=="object"&&self,typeof fi=="object"&&fi];for(var u=0;u<o.length;++u){var f=o[u];if(f&&f.Math==Math)return f}throw Error("Cannot find global object")}var r=t(this);function s(o,u){if(u)e:{var f=r;o=o.split(".");for(var p=0;p<o.length-1;p++){var b=o[p];if(!(b in f))break e;f=f[b]}o=o[o.length-1],p=f[o],u=u(p),u!=p&&u!=null&&e(f,o,{configurable:!0,writable:!0,value:u})}}s("Symbol.dispose",function(o){return o||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(o){return o||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(o){return o||function(u){var f=[],p;for(p in u)Object.prototype.hasOwnProperty.call(u,p)&&f.push([p,u[p]]);return f}});var i=i||{},a=this||self;function c(o){var u=typeof o;return u=="object"&&o!=null||u=="function"}function l(o,u,f){return o.call.apply(o.bind,arguments)}function h(o,u,f){return h=l,h.apply(null,arguments)}function d(o,u){var f=Array.prototype.slice.call(arguments,1);return function(){var p=f.slice();return p.push.apply(p,arguments),o.apply(this,p)}}function m(o,u){function f(){}f.prototype=u.prototype,o.Z=u.prototype,o.prototype=new f,o.prototype.constructor=o,o.Ob=function(p,b,P){for(var D=Array(arguments.length-2),G=2;G<arguments.length;G++)D[G-2]=arguments[G];return u.prototype[b].apply(p,D)}}var g=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?o=>o&&AsyncContext.Snapshot.wrap(o):o=>o;function I(o){const u=o.length;if(u>0){const f=Array(u);for(let p=0;p<u;p++)f[p]=o[p];return f}return[]}function S(o,u){for(let p=1;p<arguments.length;p++){const b=arguments[p];var f=typeof b;if(f=f!="object"?f:b?Array.isArray(b)?"array":f:"null",f=="array"||f=="object"&&typeof b.length=="number"){f=o.length||0;const P=b.length||0;o.length=f+P;for(let D=0;D<P;D++)o[f+D]=b[D]}else o.push(b)}}class C{constructor(u,f){this.i=u,this.j=f,this.h=0,this.g=null}get(){let u;return this.h>0?(this.h--,u=this.g,this.g=u.next,u.next=null):u=this.i(),u}}function R(o){a.setTimeout(()=>{throw o},0)}function O(){var o=E;let u=null;return o.g&&(u=o.g,o.g=o.g.next,o.g||(o.h=null),u.next=null),u}class x{constructor(){this.h=this.g=null}add(u,f){const p=V.get();p.set(u,f),this.h?this.h.next=p:this.g=p,this.h=p}}var V=new C(()=>new H,o=>o.reset());class H{constructor(){this.next=this.g=this.h=null}set(u,f){this.h=u,this.g=f,this.next=null}reset(){this.next=this.g=this.h=null}}let W,U=!1,E=new x,_=()=>{const o=Promise.resolve(void 0);W=()=>{o.then(v)}};function v(){for(var o;o=O();){try{o.h.call(o.g)}catch(f){R(f)}var u=V;u.j(o),u.h<100&&(u.h++,o.next=u.g,u.g=o)}U=!1}function w(){this.u=this.u,this.C=this.C}w.prototype.u=!1,w.prototype.dispose=function(){this.u||(this.u=!0,this.N())},w.prototype[Symbol.dispose]=function(){this.dispose()},w.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function T(o,u){this.type=o,this.g=this.target=u,this.defaultPrevented=!1}T.prototype.h=function(){this.defaultPrevented=!0};var A=(function(){if(!a.addEventListener||!Object.defineProperty)return!1;var o=!1,u=Object.defineProperty({},"passive",{get:function(){o=!0}});try{const f=()=>{};a.addEventListener("test",f,u),a.removeEventListener("test",f,u)}catch{}return o})();function y(o){return/^[\s\xa0]*$/.test(o)}function de(o,u){T.call(this,o?o.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,o&&this.init(o,u)}m(de,T),de.prototype.init=function(o,u){const f=this.type=o.type,p=o.changedTouches&&o.changedTouches.length?o.changedTouches[0]:null;this.target=o.target||o.srcElement,this.g=u,u=o.relatedTarget,u||(f=="mouseover"?u=o.fromElement:f=="mouseout"&&(u=o.toElement)),this.relatedTarget=u,p?(this.clientX=p.clientX!==void 0?p.clientX:p.pageX,this.clientY=p.clientY!==void 0?p.clientY:p.pageY,this.screenX=p.screenX||0,this.screenY=p.screenY||0):(this.clientX=o.clientX!==void 0?o.clientX:o.pageX,this.clientY=o.clientY!==void 0?o.clientY:o.pageY,this.screenX=o.screenX||0,this.screenY=o.screenY||0),this.button=o.button,this.key=o.key||"",this.ctrlKey=o.ctrlKey,this.altKey=o.altKey,this.shiftKey=o.shiftKey,this.metaKey=o.metaKey,this.pointerId=o.pointerId||0,this.pointerType=o.pointerType,this.state=o.state,this.i=o,o.defaultPrevented&&de.Z.h.call(this)},de.prototype.h=function(){de.Z.h.call(this);const o=this.i;o.preventDefault?o.preventDefault():o.returnValue=!1};var Ae="closure_listenable_"+(Math.random()*1e6|0),et=0;function pt(o,u,f,p,b){this.listener=o,this.proxy=null,this.src=u,this.type=f,this.capture=!!p,this.ha=b,this.key=++et,this.da=this.fa=!1}function mt(o){o.da=!0,o.listener=null,o.proxy=null,o.src=null,o.ha=null}function Xt(o,u,f){for(const p in o)u.call(f,o[p],p,o)}function ot(o,u){for(const f in o)u.call(void 0,o[f],f,o)}function Lt(o){const u={};for(const f in o)u[f]=o[f];return u}const Fo="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Js(o,u){let f,p;for(let b=1;b<arguments.length;b++){p=arguments[b];for(f in p)o[f]=p[f];for(let P=0;P<Fo.length;P++)f=Fo[P],Object.prototype.hasOwnProperty.call(p,f)&&(o[f]=p[f])}}function Kr(o){this.src=o,this.g={},this.h=0}Kr.prototype.add=function(o,u,f,p,b){const P=o.toString();o=this.g[P],o||(o=this.g[P]=[],this.h++);const D=Bo(o,u,p,b);return D>-1?(u=o[D],f||(u.fa=!1)):(u=new pt(u,this.src,P,!!p,b),u.fa=f,o.push(u)),u};function Uo(o,u){const f=u.type;if(f in o.g){var p=o.g[f],b=Array.prototype.indexOf.call(p,u,void 0),P;(P=b>=0)&&Array.prototype.splice.call(p,b,1),P&&(mt(u),o.g[f].length==0&&(delete o.g[f],o.h--))}}function Bo(o,u,f,p){for(let b=0;b<o.length;++b){const P=o[b];if(!P.da&&P.listener==u&&P.capture==!!f&&P.ha==p)return b}return-1}var $o="closure_lm_"+(Math.random()*1e6|0),jo={};function vu(o,u,f,p,b){if(Array.isArray(u)){for(let P=0;P<u.length;P++)vu(o,u[P],f,p,b);return null}return f=wu(f),o&&o[Ae]?o.J(u,f,c(p)?!!p.capture:!1,b):ym(o,u,f,!1,p,b)}function ym(o,u,f,p,b,P){if(!u)throw Error("Invalid event type");const D=c(b)?!!b.capture:!!b;let G=zo(o);if(G||(o[$o]=G=new Kr(o)),f=G.add(u,f,p,D,P),f.proxy)return f;if(p=vm(),f.proxy=p,p.src=o,p.listener=f,o.addEventListener)A||(b=D),b===void 0&&(b=!1),o.addEventListener(u.toString(),p,b);else if(o.attachEvent)o.attachEvent(Tu(u.toString()),p);else if(o.addListener&&o.removeListener)o.addListener(p);else throw Error("addEventListener and attachEvent are unavailable.");return f}function vm(){function o(f){return u.call(o.src,o.listener,f)}const u=Em;return o}function Eu(o,u,f,p,b){if(Array.isArray(u))for(var P=0;P<u.length;P++)Eu(o,u[P],f,p,b);else p=c(p)?!!p.capture:!!p,f=wu(f),o&&o[Ae]?(o=o.i,P=String(u).toString(),P in o.g&&(u=o.g[P],f=Bo(u,f,p,b),f>-1&&(mt(u[f]),Array.prototype.splice.call(u,f,1),u.length==0&&(delete o.g[P],o.h--)))):o&&(o=zo(o))&&(u=o.g[u.toString()],o=-1,u&&(o=Bo(u,f,p,b)),(f=o>-1?u[o]:null)&&qo(f))}function qo(o){if(typeof o!="number"&&o&&!o.da){var u=o.src;if(u&&u[Ae])Uo(u.i,o);else{var f=o.type,p=o.proxy;u.removeEventListener?u.removeEventListener(f,p,o.capture):u.detachEvent?u.detachEvent(Tu(f),p):u.addListener&&u.removeListener&&u.removeListener(p),(f=zo(u))?(Uo(f,o),f.h==0&&(f.src=null,u[$o]=null)):mt(o)}}}function Tu(o){return o in jo?jo[o]:jo[o]="on"+o}function Em(o,u){if(o.da)o=!0;else{u=new de(u,this);const f=o.listener,p=o.ha||o.src;o.fa&&qo(o),o=f.call(p,u)}return o}function zo(o){return o=o[$o],o instanceof Kr?o:null}var Ho="__closure_events_fn_"+(Math.random()*1e9>>>0);function wu(o){return typeof o=="function"?o:(o[Ho]||(o[Ho]=function(u){return o.handleEvent(u)}),o[Ho])}function De(){w.call(this),this.i=new Kr(this),this.M=this,this.G=null}m(De,w),De.prototype[Ae]=!0,De.prototype.removeEventListener=function(o,u,f,p){Eu(this,o,u,f,p)};function Ue(o,u){var f,p=o.G;if(p)for(f=[];p;p=p.G)f.push(p);if(o=o.M,p=u.type||u,typeof u=="string")u=new T(u,o);else if(u instanceof T)u.target=u.target||o;else{var b=u;u=new T(p,o),Js(u,b)}b=!0;let P,D;if(f)for(D=f.length-1;D>=0;D--)P=u.g=f[D],b=Ys(P,p,!0,u)&&b;if(P=u.g=o,b=Ys(P,p,!0,u)&&b,b=Ys(P,p,!1,u)&&b,f)for(D=0;D<f.length;D++)P=u.g=f[D],b=Ys(P,p,!1,u)&&b}De.prototype.N=function(){if(De.Z.N.call(this),this.i){var o=this.i;for(const u in o.g){const f=o.g[u];for(let p=0;p<f.length;p++)mt(f[p]);delete o.g[u],o.h--}}this.G=null},De.prototype.J=function(o,u,f,p){return this.i.add(String(o),u,!1,f,p)},De.prototype.K=function(o,u,f,p){return this.i.add(String(o),u,!0,f,p)};function Ys(o,u,f,p){if(u=o.i.g[String(u)],!u)return!0;u=u.concat();let b=!0;for(let P=0;P<u.length;++P){const D=u[P];if(D&&!D.da&&D.capture==f){const G=D.listener,ve=D.ha||D.src;D.fa&&Uo(o.i,D),b=G.call(ve,p)!==!1&&b}}return b&&!p.defaultPrevented}function Tm(o,u){if(typeof o!="function")if(o&&typeof o.handleEvent=="function")o=h(o.handleEvent,o);else throw Error("Invalid listener argument");return Number(u)>2147483647?-1:a.setTimeout(o,u||0)}function Iu(o){o.g=Tm(()=>{o.g=null,o.i&&(o.i=!1,Iu(o))},o.l);const u=o.h;o.h=null,o.m.apply(null,u)}class wm extends w{constructor(u,f){super(),this.m=u,this.l=f,this.h=null,this.i=!1,this.g=null}j(u){this.h=arguments,this.g?this.i=!0:Iu(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Qr(o){w.call(this),this.h=o,this.g={}}m(Qr,w);var Au=[];function bu(o){Xt(o.g,function(u,f){this.g.hasOwnProperty(f)&&qo(u)},o),o.g={}}Qr.prototype.N=function(){Qr.Z.N.call(this),bu(this)},Qr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Wo=a.JSON.stringify,Im=a.JSON.parse,Am=class{stringify(o){return a.JSON.stringify(o,void 0)}parse(o){return a.JSON.parse(o,void 0)}};function Su(){}function Ru(){}var Xr={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Go(){T.call(this,"d")}m(Go,T);function Ko(){T.call(this,"c")}m(Ko,T);var Cn={},Pu=null;function Zs(){return Pu=Pu||new De}Cn.Ia="serverreachability";function Cu(o){T.call(this,Cn.Ia,o)}m(Cu,T);function Jr(o){const u=Zs();Ue(u,new Cu(u))}Cn.STAT_EVENT="statevent";function ku(o,u){T.call(this,Cn.STAT_EVENT,o),this.stat=u}m(ku,T);function Be(o){const u=Zs();Ue(u,new ku(u,o))}Cn.Ja="timingevent";function Nu(o,u){T.call(this,Cn.Ja,o),this.size=u}m(Nu,T);function Yr(o,u){if(typeof o!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){o()},u)}function Zr(){this.g=!0}Zr.prototype.ua=function(){this.g=!1};function bm(o,u,f,p,b,P){o.info(function(){if(o.g)if(P){var D="",G=P.split("&");for(let ne=0;ne<G.length;ne++){var ve=G[ne].split("=");if(ve.length>1){const be=ve[0];ve=ve[1];const _t=be.split("_");D=_t.length>=2&&_t[1]=="type"?D+(be+"="+ve+"&"):D+(be+"=redacted&")}}}else D=null;else D=P;return"XMLHTTP REQ ("+p+") [attempt "+b+"]: "+u+`
`+f+`
`+D})}function Sm(o,u,f,p,b,P,D){o.info(function(){return"XMLHTTP RESP ("+p+") [ attempt "+b+"]: "+u+`
`+f+`
`+P+" "+D})}function sr(o,u,f,p){o.info(function(){return"XMLHTTP TEXT ("+u+"): "+Pm(o,f)+(p?" "+p:"")})}function Rm(o,u){o.info(function(){return"TIMEOUT: "+u})}Zr.prototype.info=function(){};function Pm(o,u){if(!o.g)return u;if(!u)return null;try{const P=JSON.parse(u);if(P){for(o=0;o<P.length;o++)if(Array.isArray(P[o])){var f=P[o];if(!(f.length<2)){var p=f[1];if(Array.isArray(p)&&!(p.length<1)){var b=p[0];if(b!="noop"&&b!="stop"&&b!="close")for(let D=1;D<p.length;D++)p[D]=""}}}}return Wo(P)}catch{return u}}var ei={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Du={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Vu;function Qo(){}m(Qo,Su),Qo.prototype.g=function(){return new XMLHttpRequest},Vu=new Qo;function es(o){return encodeURIComponent(String(o))}function Cm(o){var u=1;o=o.split(":");const f=[];for(;u>0&&o.length;)f.push(o.shift()),u--;return o.length&&f.push(o.join(":")),f}function Jt(o,u,f,p){this.j=o,this.i=u,this.l=f,this.S=p||1,this.V=new Qr(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Ou}function Ou(){this.i=null,this.g="",this.h=!1}var Mu={},Xo={};function Jo(o,u,f){o.M=1,o.A=ni(gt(u)),o.u=f,o.R=!0,Lu(o,null)}function Lu(o,u){o.F=Date.now(),ti(o),o.B=gt(o.A);var f=o.B,p=o.S;Array.isArray(p)||(p=[String(p)]),Qu(f.i,"t",p),o.C=0,f=o.j.L,o.h=new Ou,o.g=dl(o.j,f?u:null,!o.u),o.P>0&&(o.O=new wm(h(o.Y,o,o.g),o.P)),u=o.V,f=o.g,p=o.ba;var b="readystatechange";Array.isArray(b)||(b&&(Au[0]=b.toString()),b=Au);for(let P=0;P<b.length;P++){const D=vu(f,b[P],p||u.handleEvent,!1,u.h||u);if(!D)break;u.g[D.key]=D}u=o.J?Lt(o.J):{},o.u?(o.v||(o.v="POST"),u["Content-Type"]="application/x-www-form-urlencoded",o.g.ea(o.B,o.v,o.u,u)):(o.v="GET",o.g.ea(o.B,o.v,null,u)),Jr(),bm(o.i,o.v,o.B,o.l,o.S,o.u)}Jt.prototype.ba=function(o){o=o.target;const u=this.O;u&&en(o)==3?u.j():this.Y(o)},Jt.prototype.Y=function(o){try{if(o==this.g)e:{const G=en(this.g),ve=this.g.ya(),ne=this.g.ca();if(!(G<3)&&(G!=3||this.g&&(this.h.h||this.g.la()||nl(this.g)))){this.K||G!=4||ve==7||(ve==8||ne<=0?Jr(3):Jr(2)),Yo(this);var u=this.g.ca();this.X=u;var f=km(this);if(this.o=u==200,Sm(this.i,this.v,this.B,this.l,this.S,G,u),this.o){if(this.U&&!this.L){t:{if(this.g){var p,b=this.g;if((p=b.g?b.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!y(p)){var P=p;break t}}P=null}if(o=P)sr(this.i,this.l,o,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Zo(this,o);else{this.o=!1,this.m=3,Be(12),kn(this),ts(this);break e}}if(this.R){o=!0;let be;for(;!this.K&&this.C<f.length;)if(be=Nm(this,f),be==Xo){G==4&&(this.m=4,Be(14),o=!1),sr(this.i,this.l,null,"[Incomplete Response]");break}else if(be==Mu){this.m=4,Be(15),sr(this.i,this.l,f,"[Invalid Chunk]"),o=!1;break}else sr(this.i,this.l,be,null),Zo(this,be);if(xu(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),G!=4||f.length!=0||this.h.h||(this.m=1,Be(16),o=!1),this.o=this.o&&o,!o)sr(this.i,this.l,f,"[Invalid Chunked Response]"),kn(this),ts(this);else if(f.length>0&&!this.W){this.W=!0;var D=this.j;D.g==this&&D.aa&&!D.P&&(D.j.info("Great, no buffering proxy detected. Bytes received: "+f.length),aa(D),D.P=!0,Be(11))}}else sr(this.i,this.l,f,null),Zo(this,f);G==4&&kn(this),this.o&&!this.K&&(G==4?ul(this.j,this):(this.o=!1,ti(this)))}else Hm(this.g),u==400&&f.indexOf("Unknown SID")>0?(this.m=3,Be(12)):(this.m=0,Be(13)),kn(this),ts(this)}}}catch{}finally{}};function km(o){if(!xu(o))return o.g.la();const u=nl(o.g);if(u==="")return"";let f="";const p=u.length,b=en(o.g)==4;if(!o.h.i){if(typeof TextDecoder>"u")return kn(o),ts(o),"";o.h.i=new a.TextDecoder}for(let P=0;P<p;P++)o.h.h=!0,f+=o.h.i.decode(u[P],{stream:!(b&&P==p-1)});return u.length=0,o.h.g+=f,o.C=0,o.h.g}function xu(o){return o.g?o.v=="GET"&&o.M!=2&&o.j.Aa:!1}function Nm(o,u){var f=o.C,p=u.indexOf(`
`,f);return p==-1?Xo:(f=Number(u.substring(f,p)),isNaN(f)?Mu:(p+=1,p+f>u.length?Xo:(u=u.slice(p,p+f),o.C=p+f,u)))}Jt.prototype.cancel=function(){this.K=!0,kn(this)};function ti(o){o.T=Date.now()+o.H,Fu(o,o.H)}function Fu(o,u){if(o.D!=null)throw Error("WatchDog timer not null");o.D=Yr(h(o.aa,o),u)}function Yo(o){o.D&&(a.clearTimeout(o.D),o.D=null)}Jt.prototype.aa=function(){this.D=null;const o=Date.now();o-this.T>=0?(Rm(this.i,this.B),this.M!=2&&(Jr(),Be(17)),kn(this),this.m=2,ts(this)):Fu(this,this.T-o)};function ts(o){o.j.I==0||o.K||ul(o.j,o)}function kn(o){Yo(o);var u=o.O;u&&typeof u.dispose=="function"&&u.dispose(),o.O=null,bu(o.V),o.g&&(u=o.g,o.g=null,u.abort(),u.dispose())}function Zo(o,u){try{var f=o.j;if(f.I!=0&&(f.g==o||ea(f.h,o))){if(!o.L&&ea(f.h,o)&&f.I==3){try{var p=f.Ba.g.parse(u)}catch{p=null}if(Array.isArray(p)&&p.length==3){var b=p;if(b[0]==0){e:if(!f.v){if(f.g)if(f.g.F+3e3<o.F)ai(f),ii(f);else break e;oa(f),Be(18)}}else f.xa=b[1],0<f.xa-f.K&&b[2]<37500&&f.F&&f.A==0&&!f.C&&(f.C=Yr(h(f.Va,f),6e3));$u(f.h)<=1&&f.ta&&(f.ta=void 0)}else Dn(f,11)}else if((o.L||f.g==o)&&ai(f),!y(u))for(b=f.Ba.g.parse(u),u=0;u<b.length;u++){let ne=b[u];const be=ne[0];if(!(be<=f.K))if(f.K=be,ne=ne[1],f.I==2)if(ne[0]=="c"){f.M=ne[1],f.ba=ne[2];const _t=ne[3];_t!=null&&(f.ka=_t,f.j.info("VER="+f.ka));const Vn=ne[4];Vn!=null&&(f.za=Vn,f.j.info("SVER="+f.za));const tn=ne[5];tn!=null&&typeof tn=="number"&&tn>0&&(p=1.5*tn,f.O=p,f.j.info("backChannelRequestTimeoutMs_="+p)),p=f;const nn=o.g;if(nn){const ui=nn.g?nn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ui){var P=p.h;P.g||ui.indexOf("spdy")==-1&&ui.indexOf("quic")==-1&&ui.indexOf("h2")==-1||(P.j=P.l,P.g=new Set,P.h&&(ta(P,P.h),P.h=null))}if(p.G){const ca=nn.g?nn.g.getResponseHeader("X-HTTP-Session-Id"):null;ca&&(p.wa=ca,ie(p.J,p.G,ca))}}f.I=3,f.l&&f.l.ra(),f.aa&&(f.T=Date.now()-o.F,f.j.info("Handshake RTT: "+f.T+"ms")),p=f;var D=o;if(p.na=fl(p,p.L?p.ba:null,p.W),D.L){ju(p.h,D);var G=D,ve=p.O;ve&&(G.H=ve),G.D&&(Yo(G),ti(G)),p.g=D}else al(p);f.i.length>0&&oi(f)}else ne[0]!="stop"&&ne[0]!="close"||Dn(f,7);else f.I==3&&(ne[0]=="stop"||ne[0]=="close"?ne[0]=="stop"?Dn(f,7):ia(f):ne[0]!="noop"&&f.l&&f.l.qa(ne),f.A=0)}}Jr(4)}catch{}}var Dm=class{constructor(o,u){this.g=o,this.map=u}};function Uu(o){this.l=o||10,a.PerformanceNavigationTiming?(o=a.performance.getEntriesByType("navigation"),o=o.length>0&&(o[0].nextHopProtocol=="hq"||o[0].nextHopProtocol=="h2")):o=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=o?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Bu(o){return o.h?!0:o.g?o.g.size>=o.j:!1}function $u(o){return o.h?1:o.g?o.g.size:0}function ea(o,u){return o.h?o.h==u:o.g?o.g.has(u):!1}function ta(o,u){o.g?o.g.add(u):o.h=u}function ju(o,u){o.h&&o.h==u?o.h=null:o.g&&o.g.has(u)&&o.g.delete(u)}Uu.prototype.cancel=function(){if(this.i=qu(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const o of this.g.values())o.cancel();this.g.clear()}};function qu(o){if(o.h!=null)return o.i.concat(o.h.G);if(o.g!=null&&o.g.size!==0){let u=o.i;for(const f of o.g.values())u=u.concat(f.G);return u}return I(o.i)}var zu=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Vm(o,u){if(o){o=o.split("&");for(let f=0;f<o.length;f++){const p=o[f].indexOf("=");let b,P=null;p>=0?(b=o[f].substring(0,p),P=o[f].substring(p+1)):b=o[f],u(b,P?decodeURIComponent(P.replace(/\+/g," ")):"")}}}function Yt(o){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let u;o instanceof Yt?(this.l=o.l,ns(this,o.j),this.o=o.o,this.g=o.g,rs(this,o.u),this.h=o.h,na(this,Xu(o.i)),this.m=o.m):o&&(u=String(o).match(zu))?(this.l=!1,ns(this,u[1]||"",!0),this.o=ss(u[2]||""),this.g=ss(u[3]||"",!0),rs(this,u[4]),this.h=ss(u[5]||"",!0),na(this,u[6]||"",!0),this.m=ss(u[7]||"")):(this.l=!1,this.i=new os(null,this.l))}Yt.prototype.toString=function(){const o=[];var u=this.j;u&&o.push(is(u,Hu,!0),":");var f=this.g;return(f||u=="file")&&(o.push("//"),(u=this.o)&&o.push(is(u,Hu,!0),"@"),o.push(es(f).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f=this.u,f!=null&&o.push(":",String(f))),(f=this.h)&&(this.g&&f.charAt(0)!="/"&&o.push("/"),o.push(is(f,f.charAt(0)=="/"?Lm:Mm,!0))),(f=this.i.toString())&&o.push("?",f),(f=this.m)&&o.push("#",is(f,Fm)),o.join("")},Yt.prototype.resolve=function(o){const u=gt(this);let f=!!o.j;f?ns(u,o.j):f=!!o.o,f?u.o=o.o:f=!!o.g,f?u.g=o.g:f=o.u!=null;var p=o.h;if(f)rs(u,o.u);else if(f=!!o.h){if(p.charAt(0)!="/")if(this.g&&!this.h)p="/"+p;else{var b=u.h.lastIndexOf("/");b!=-1&&(p=u.h.slice(0,b+1)+p)}if(b=p,b==".."||b==".")p="";else if(b.indexOf("./")!=-1||b.indexOf("/.")!=-1){p=b.lastIndexOf("/",0)==0,b=b.split("/");const P=[];for(let D=0;D<b.length;){const G=b[D++];G=="."?p&&D==b.length&&P.push(""):G==".."?((P.length>1||P.length==1&&P[0]!="")&&P.pop(),p&&D==b.length&&P.push("")):(P.push(G),p=!0)}p=P.join("/")}else p=b}return f?u.h=p:f=o.i.toString()!=="",f?na(u,Xu(o.i)):f=!!o.m,f&&(u.m=o.m),u};function gt(o){return new Yt(o)}function ns(o,u,f){o.j=f?ss(u,!0):u,o.j&&(o.j=o.j.replace(/:$/,""))}function rs(o,u){if(u){if(u=Number(u),isNaN(u)||u<0)throw Error("Bad port number "+u);o.u=u}else o.u=null}function na(o,u,f){u instanceof os?(o.i=u,Um(o.i,o.l)):(f||(u=is(u,xm)),o.i=new os(u,o.l))}function ie(o,u,f){o.i.set(u,f)}function ni(o){return ie(o,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),o}function ss(o,u){return o?u?decodeURI(o.replace(/%25/g,"%2525")):decodeURIComponent(o):""}function is(o,u,f){return typeof o=="string"?(o=encodeURI(o).replace(u,Om),f&&(o=o.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),o):null}function Om(o){return o=o.charCodeAt(0),"%"+(o>>4&15).toString(16)+(o&15).toString(16)}var Hu=/[#\/\?@]/g,Mm=/[#\?:]/g,Lm=/[#\?]/g,xm=/[#\?@]/g,Fm=/#/g;function os(o,u){this.h=this.g=null,this.i=o||null,this.j=!!u}function Nn(o){o.g||(o.g=new Map,o.h=0,o.i&&Vm(o.i,function(u,f){o.add(decodeURIComponent(u.replace(/\+/g," ")),f)}))}n=os.prototype,n.add=function(o,u){Nn(this),this.i=null,o=ir(this,o);let f=this.g.get(o);return f||this.g.set(o,f=[]),f.push(u),this.h+=1,this};function Wu(o,u){Nn(o),u=ir(o,u),o.g.has(u)&&(o.i=null,o.h-=o.g.get(u).length,o.g.delete(u))}function Gu(o,u){return Nn(o),u=ir(o,u),o.g.has(u)}n.forEach=function(o,u){Nn(this),this.g.forEach(function(f,p){f.forEach(function(b){o.call(u,b,p,this)},this)},this)};function Ku(o,u){Nn(o);let f=[];if(typeof u=="string")Gu(o,u)&&(f=f.concat(o.g.get(ir(o,u))));else for(o=Array.from(o.g.values()),u=0;u<o.length;u++)f=f.concat(o[u]);return f}n.set=function(o,u){return Nn(this),this.i=null,o=ir(this,o),Gu(this,o)&&(this.h-=this.g.get(o).length),this.g.set(o,[u]),this.h+=1,this},n.get=function(o,u){return o?(o=Ku(this,o),o.length>0?String(o[0]):u):u};function Qu(o,u,f){Wu(o,u),f.length>0&&(o.i=null,o.g.set(ir(o,u),I(f)),o.h+=f.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const o=[],u=Array.from(this.g.keys());for(let p=0;p<u.length;p++){var f=u[p];const b=es(f);f=Ku(this,f);for(let P=0;P<f.length;P++){let D=b;f[P]!==""&&(D+="="+es(f[P])),o.push(D)}}return this.i=o.join("&")};function Xu(o){const u=new os;return u.i=o.i,o.g&&(u.g=new Map(o.g),u.h=o.h),u}function ir(o,u){return u=String(u),o.j&&(u=u.toLowerCase()),u}function Um(o,u){u&&!o.j&&(Nn(o),o.i=null,o.g.forEach(function(f,p){const b=p.toLowerCase();p!=b&&(Wu(this,p),Qu(this,b,f))},o)),o.j=u}function Bm(o,u){const f=new Zr;if(a.Image){const p=new Image;p.onload=d(Zt,f,"TestLoadImage: loaded",!0,u,p),p.onerror=d(Zt,f,"TestLoadImage: error",!1,u,p),p.onabort=d(Zt,f,"TestLoadImage: abort",!1,u,p),p.ontimeout=d(Zt,f,"TestLoadImage: timeout",!1,u,p),a.setTimeout(function(){p.ontimeout&&p.ontimeout()},1e4),p.src=o}else u(!1)}function $m(o,u){const f=new Zr,p=new AbortController,b=setTimeout(()=>{p.abort(),Zt(f,"TestPingServer: timeout",!1,u)},1e4);fetch(o,{signal:p.signal}).then(P=>{clearTimeout(b),P.ok?Zt(f,"TestPingServer: ok",!0,u):Zt(f,"TestPingServer: server error",!1,u)}).catch(()=>{clearTimeout(b),Zt(f,"TestPingServer: error",!1,u)})}function Zt(o,u,f,p,b){try{b&&(b.onload=null,b.onerror=null,b.onabort=null,b.ontimeout=null),p(f)}catch{}}function jm(){this.g=new Am}function ra(o){this.i=o.Sb||null,this.h=o.ab||!1}m(ra,Su),ra.prototype.g=function(){return new ri(this.i,this.h)};function ri(o,u){De.call(this),this.H=o,this.o=u,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}m(ri,De),n=ri.prototype,n.open=function(o,u){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=o,this.D=u,this.readyState=1,cs(this)},n.send=function(o){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const u={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};o&&(u.body=o),(this.H||a).fetch(new Request(this.D,u)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,as(this)),this.readyState=0},n.Pa=function(o){if(this.g&&(this.l=o,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=o.headers,this.readyState=2,cs(this)),this.g&&(this.readyState=3,cs(this),this.g)))if(this.responseType==="arraybuffer")o.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in o){if(this.j=o.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Ju(this)}else o.text().then(this.Oa.bind(this),this.ga.bind(this))};function Ju(o){o.j.read().then(o.Ma.bind(o)).catch(o.ga.bind(o))}n.Ma=function(o){if(this.g){if(this.o&&o.value)this.response.push(o.value);else if(!this.o){var u=o.value?o.value:new Uint8Array(0);(u=this.B.decode(u,{stream:!o.done}))&&(this.response=this.responseText+=u)}o.done?as(this):cs(this),this.readyState==3&&Ju(this)}},n.Oa=function(o){this.g&&(this.response=this.responseText=o,as(this))},n.Na=function(o){this.g&&(this.response=o,as(this))},n.ga=function(){this.g&&as(this)};function as(o){o.readyState=4,o.l=null,o.j=null,o.B=null,cs(o)}n.setRequestHeader=function(o,u){this.A.append(o,u)},n.getResponseHeader=function(o){return this.h&&this.h.get(o.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const o=[],u=this.h.entries();for(var f=u.next();!f.done;)f=f.value,o.push(f[0]+": "+f[1]),f=u.next();return o.join(`\r
`)};function cs(o){o.onreadystatechange&&o.onreadystatechange.call(o)}Object.defineProperty(ri.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(o){this.m=o?"include":"same-origin"}});function Yu(o){let u="";return Xt(o,function(f,p){u+=p,u+=":",u+=f,u+=`\r
`}),u}function sa(o,u,f){e:{for(p in f){var p=!1;break e}p=!0}p||(f=Yu(f),typeof o=="string"?f!=null&&es(f):ie(o,u,f))}function pe(o){De.call(this),this.headers=new Map,this.L=o||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}m(pe,De);var qm=/^https?$/i,zm=["POST","PUT"];n=pe.prototype,n.Fa=function(o){this.H=o},n.ea=function(o,u,f,p){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+o);u=u?u.toUpperCase():"GET",this.D=o,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Vu.g(),this.g.onreadystatechange=g(h(this.Ca,this));try{this.B=!0,this.g.open(u,String(o),!0),this.B=!1}catch(P){Zu(this,P);return}if(o=f||"",f=new Map(this.headers),p)if(Object.getPrototypeOf(p)===Object.prototype)for(var b in p)f.set(b,p[b]);else if(typeof p.keys=="function"&&typeof p.get=="function")for(const P of p.keys())f.set(P,p.get(P));else throw Error("Unknown input type for opt_headers: "+String(p));p=Array.from(f.keys()).find(P=>P.toLowerCase()=="content-type"),b=a.FormData&&o instanceof a.FormData,!(Array.prototype.indexOf.call(zm,u,void 0)>=0)||p||b||f.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[P,D]of f)this.g.setRequestHeader(P,D);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(o),this.v=!1}catch(P){Zu(this,P)}};function Zu(o,u){o.h=!1,o.g&&(o.j=!0,o.g.abort(),o.j=!1),o.l=u,o.o=5,el(o),si(o)}function el(o){o.A||(o.A=!0,Ue(o,"complete"),Ue(o,"error"))}n.abort=function(o){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=o||7,Ue(this,"complete"),Ue(this,"abort"),si(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),si(this,!0)),pe.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?tl(this):this.Xa())},n.Xa=function(){tl(this)};function tl(o){if(o.h&&typeof i<"u"){if(o.v&&en(o)==4)setTimeout(o.Ca.bind(o),0);else if(Ue(o,"readystatechange"),en(o)==4){o.h=!1;try{const P=o.ca();e:switch(P){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var u=!0;break e;default:u=!1}var f;if(!(f=u)){var p;if(p=P===0){let D=String(o.D).match(zu)[1]||null;!D&&a.self&&a.self.location&&(D=a.self.location.protocol.slice(0,-1)),p=!qm.test(D?D.toLowerCase():"")}f=p}if(f)Ue(o,"complete"),Ue(o,"success");else{o.o=6;try{var b=en(o)>2?o.g.statusText:""}catch{b=""}o.l=b+" ["+o.ca()+"]",el(o)}}finally{si(o)}}}}function si(o,u){if(o.g){o.m&&(clearTimeout(o.m),o.m=null);const f=o.g;o.g=null,u||Ue(o,"ready");try{f.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function en(o){return o.g?o.g.readyState:0}n.ca=function(){try{return en(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(o){if(this.g){var u=this.g.responseText;return o&&u.indexOf(o)==0&&(u=u.substring(o.length)),Im(u)}};function nl(o){try{if(!o.g)return null;if("response"in o.g)return o.g.response;switch(o.F){case"":case"text":return o.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in o.g)return o.g.mozResponseArrayBuffer}return null}catch{return null}}function Hm(o){const u={};o=(o.g&&en(o)>=2&&o.g.getAllResponseHeaders()||"").split(`\r
`);for(let p=0;p<o.length;p++){if(y(o[p]))continue;var f=Cm(o[p]);const b=f[0];if(f=f[1],typeof f!="string")continue;f=f.trim();const P=u[b]||[];u[b]=P,P.push(f)}ot(u,function(p){return p.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function us(o,u,f){return f&&f.internalChannelParams&&f.internalChannelParams[o]||u}function rl(o){this.za=0,this.i=[],this.j=new Zr,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=us("failFast",!1,o),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=us("baseRetryDelayMs",5e3,o),this.Za=us("retryDelaySeedMs",1e4,o),this.Ta=us("forwardChannelMaxRetries",2,o),this.va=us("forwardChannelRequestTimeoutMs",2e4,o),this.ma=o&&o.xmlHttpFactory||void 0,this.Ua=o&&o.Rb||void 0,this.Aa=o&&o.useFetchStreams||!1,this.O=void 0,this.L=o&&o.supportsCrossDomainXhr||!1,this.M="",this.h=new Uu(o&&o.concurrentRequestLimit),this.Ba=new jm,this.S=o&&o.fastHandshake||!1,this.R=o&&o.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=o&&o.Pb||!1,o&&o.ua&&this.j.ua(),o&&o.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&o&&o.detectBufferingProxy||!1,this.ia=void 0,o&&o.longPollingTimeout&&o.longPollingTimeout>0&&(this.ia=o.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=rl.prototype,n.ka=8,n.I=1,n.connect=function(o,u,f,p){Be(0),this.W=o,this.H=u||{},f&&p!==void 0&&(this.H.OSID=f,this.H.OAID=p),this.F=this.X,this.J=fl(this,null,this.W),oi(this)};function ia(o){if(sl(o),o.I==3){var u=o.V++,f=gt(o.J);if(ie(f,"SID",o.M),ie(f,"RID",u),ie(f,"TYPE","terminate"),ls(o,f),u=new Jt(o,o.j,u),u.M=2,u.A=ni(gt(f)),f=!1,a.navigator&&a.navigator.sendBeacon)try{f=a.navigator.sendBeacon(u.A.toString(),"")}catch{}!f&&a.Image&&(new Image().src=u.A,f=!0),f||(u.g=dl(u.j,null),u.g.ea(u.A)),u.F=Date.now(),ti(u)}hl(o)}function ii(o){o.g&&(aa(o),o.g.cancel(),o.g=null)}function sl(o){ii(o),o.v&&(a.clearTimeout(o.v),o.v=null),ai(o),o.h.cancel(),o.m&&(typeof o.m=="number"&&a.clearTimeout(o.m),o.m=null)}function oi(o){if(!Bu(o.h)&&!o.m){o.m=!0;var u=o.Ea;W||_(),U||(W(),U=!0),E.add(u,o),o.D=0}}function Wm(o,u){return $u(o.h)>=o.h.j-(o.m?1:0)?!1:o.m?(o.i=u.G.concat(o.i),!0):o.I==1||o.I==2||o.D>=(o.Sa?0:o.Ta)?!1:(o.m=Yr(h(o.Ea,o,u),ll(o,o.D)),o.D++,!0)}n.Ea=function(o){if(this.m)if(this.m=null,this.I==1){if(!o){this.V=Math.floor(Math.random()*1e5),o=this.V++;const b=new Jt(this,this.j,o);let P=this.o;if(this.U&&(P?(P=Lt(P),Js(P,this.U)):P=this.U),this.u!==null||this.R||(b.J=P,P=null),this.S)e:{for(var u=0,f=0;f<this.i.length;f++){t:{var p=this.i[f];if("__data__"in p.map&&(p=p.map.__data__,typeof p=="string")){p=p.length;break t}p=void 0}if(p===void 0)break;if(u+=p,u>4096){u=f;break e}if(u===4096||f===this.i.length-1){u=f+1;break e}}u=1e3}else u=1e3;u=ol(this,b,u),f=gt(this.J),ie(f,"RID",o),ie(f,"CVER",22),this.G&&ie(f,"X-HTTP-Session-Id",this.G),ls(this,f),P&&(this.R?u="headers="+es(Yu(P))+"&"+u:this.u&&sa(f,this.u,P)),ta(this.h,b),this.Ra&&ie(f,"TYPE","init"),this.S?(ie(f,"$req",u),ie(f,"SID","null"),b.U=!0,Jo(b,f,null)):Jo(b,f,u),this.I=2}}else this.I==3&&(o?il(this,o):this.i.length==0||Bu(this.h)||il(this))};function il(o,u){var f;u?f=u.l:f=o.V++;const p=gt(o.J);ie(p,"SID",o.M),ie(p,"RID",f),ie(p,"AID",o.K),ls(o,p),o.u&&o.o&&sa(p,o.u,o.o),f=new Jt(o,o.j,f,o.D+1),o.u===null&&(f.J=o.o),u&&(o.i=u.G.concat(o.i)),u=ol(o,f,1e3),f.H=Math.round(o.va*.5)+Math.round(o.va*.5*Math.random()),ta(o.h,f),Jo(f,p,u)}function ls(o,u){o.H&&Xt(o.H,function(f,p){ie(u,p,f)}),o.l&&Xt({},function(f,p){ie(u,p,f)})}function ol(o,u,f){f=Math.min(o.i.length,f);const p=o.l?h(o.l.Ka,o.l,o):null;e:{var b=o.i;let G=-1;for(;;){const ve=["count="+f];G==-1?f>0?(G=b[0].g,ve.push("ofs="+G)):G=0:ve.push("ofs="+G);let ne=!0;for(let be=0;be<f;be++){var P=b[be].g;const _t=b[be].map;if(P-=G,P<0)G=Math.max(0,b[be].g-100),ne=!1;else try{P="req"+P+"_"||"";try{var D=_t instanceof Map?_t:Object.entries(_t);for(const[Vn,tn]of D){let nn=tn;c(tn)&&(nn=Wo(tn)),ve.push(P+Vn+"="+encodeURIComponent(nn))}}catch(Vn){throw ve.push(P+"type="+encodeURIComponent("_badmap")),Vn}}catch{p&&p(_t)}}if(ne){D=ve.join("&");break e}}D=void 0}return o=o.i.splice(0,f),u.G=o,D}function al(o){if(!o.g&&!o.v){o.Y=1;var u=o.Da;W||_(),U||(W(),U=!0),E.add(u,o),o.A=0}}function oa(o){return o.g||o.v||o.A>=3?!1:(o.Y++,o.v=Yr(h(o.Da,o),ll(o,o.A)),o.A++,!0)}n.Da=function(){if(this.v=null,cl(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var o=4*this.T;this.j.info("BP detection timer enabled: "+o),this.B=Yr(h(this.Wa,this),o)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Be(10),ii(this),cl(this))};function aa(o){o.B!=null&&(a.clearTimeout(o.B),o.B=null)}function cl(o){o.g=new Jt(o,o.j,"rpc",o.Y),o.u===null&&(o.g.J=o.o),o.g.P=0;var u=gt(o.na);ie(u,"RID","rpc"),ie(u,"SID",o.M),ie(u,"AID",o.K),ie(u,"CI",o.F?"0":"1"),!o.F&&o.ia&&ie(u,"TO",o.ia),ie(u,"TYPE","xmlhttp"),ls(o,u),o.u&&o.o&&sa(u,o.u,o.o),o.O&&(o.g.H=o.O);var f=o.g;o=o.ba,f.M=1,f.A=ni(gt(u)),f.u=null,f.R=!0,Lu(f,o)}n.Va=function(){this.C!=null&&(this.C=null,ii(this),oa(this),Be(19))};function ai(o){o.C!=null&&(a.clearTimeout(o.C),o.C=null)}function ul(o,u){var f=null;if(o.g==u){ai(o),aa(o),o.g=null;var p=2}else if(ea(o.h,u))f=u.G,ju(o.h,u),p=1;else return;if(o.I!=0){if(u.o)if(p==1){f=u.u?u.u.length:0,u=Date.now()-u.F;var b=o.D;p=Zs(),Ue(p,new Nu(p,f)),oi(o)}else al(o);else if(b=u.m,b==3||b==0&&u.X>0||!(p==1&&Wm(o,u)||p==2&&oa(o)))switch(f&&f.length>0&&(u=o.h,u.i=u.i.concat(f)),b){case 1:Dn(o,5);break;case 4:Dn(o,10);break;case 3:Dn(o,6);break;default:Dn(o,2)}}}function ll(o,u){let f=o.Qa+Math.floor(Math.random()*o.Za);return o.isActive()||(f*=2),f*u}function Dn(o,u){if(o.j.info("Error code "+u),u==2){var f=h(o.bb,o),p=o.Ua;const b=!p;p=new Yt(p||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||ns(p,"https"),ni(p),b?Bm(p.toString(),f):$m(p.toString(),f)}else Be(2);o.I=0,o.l&&o.l.pa(u),hl(o),sl(o)}n.bb=function(o){o?(this.j.info("Successfully pinged google.com"),Be(2)):(this.j.info("Failed to ping google.com"),Be(1))};function hl(o){if(o.I=0,o.ja=[],o.l){const u=qu(o.h);(u.length!=0||o.i.length!=0)&&(S(o.ja,u),S(o.ja,o.i),o.h.i.length=0,I(o.i),o.i.length=0),o.l.oa()}}function fl(o,u,f){var p=f instanceof Yt?gt(f):new Yt(f);if(p.g!="")u&&(p.g=u+"."+p.g),rs(p,p.u);else{var b=a.location;p=b.protocol,u=u?u+"."+b.hostname:b.hostname,b=+b.port;const P=new Yt(null);p&&ns(P,p),u&&(P.g=u),b&&rs(P,b),f&&(P.h=f),p=P}return f=o.G,u=o.wa,f&&u&&ie(p,f,u),ie(p,"VER",o.ka),ls(o,p),p}function dl(o,u,f){if(u&&!o.L)throw Error("Can't create secondary domain capable XhrIo object.");return u=o.Aa&&!o.ma?new pe(new ra({ab:f})):new pe(o.ma),u.Fa(o.L),u}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function pl(){}n=pl.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function ci(){}ci.prototype.g=function(o,u){return new Qe(o,u)};function Qe(o,u){De.call(this),this.g=new rl(u),this.l=o,this.h=u&&u.messageUrlParams||null,o=u&&u.messageHeaders||null,u&&u.clientProtocolHeaderRequired&&(o?o["X-Client-Protocol"]="webchannel":o={"X-Client-Protocol":"webchannel"}),this.g.o=o,o=u&&u.initMessageHeaders||null,u&&u.messageContentType&&(o?o["X-WebChannel-Content-Type"]=u.messageContentType:o={"X-WebChannel-Content-Type":u.messageContentType}),u&&u.sa&&(o?o["X-WebChannel-Client-Profile"]=u.sa:o={"X-WebChannel-Client-Profile":u.sa}),this.g.U=o,(o=u&&u.Qb)&&!y(o)&&(this.g.u=o),this.A=u&&u.supportsCrossDomainXhr||!1,this.v=u&&u.sendRawJson||!1,(u=u&&u.httpSessionIdParam)&&!y(u)&&(this.g.G=u,o=this.h,o!==null&&u in o&&(o=this.h,u in o&&delete o[u])),this.j=new or(this)}m(Qe,De),Qe.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Qe.prototype.close=function(){ia(this.g)},Qe.prototype.o=function(o){var u=this.g;if(typeof o=="string"){var f={};f.__data__=o,o=f}else this.v&&(f={},f.__data__=Wo(o),o=f);u.i.push(new Dm(u.Ya++,o)),u.I==3&&oi(u)},Qe.prototype.N=function(){this.g.l=null,delete this.j,ia(this.g),delete this.g,Qe.Z.N.call(this)};function ml(o){Go.call(this),o.__headers__&&(this.headers=o.__headers__,this.statusCode=o.__status__,delete o.__headers__,delete o.__status__);var u=o.__sm__;if(u){e:{for(const f in u){o=f;break e}o=void 0}(this.i=o)&&(o=this.i,u=u!==null&&o in u?u[o]:void 0),this.data=u}else this.data=o}m(ml,Go);function gl(){Ko.call(this),this.status=1}m(gl,Ko);function or(o){this.g=o}m(or,pl),or.prototype.ra=function(){Ue(this.g,"a")},or.prototype.qa=function(o){Ue(this.g,new ml(o))},or.prototype.pa=function(o){Ue(this.g,new gl)},or.prototype.oa=function(){Ue(this.g,"b")},ci.prototype.createWebChannel=ci.prototype.g,Qe.prototype.send=Qe.prototype.o,Qe.prototype.open=Qe.prototype.m,Qe.prototype.close=Qe.prototype.close,pd=function(){return new ci},dd=function(){return Zs()},fd=Cn,Ua={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},ei.NO_ERROR=0,ei.TIMEOUT=8,ei.HTTP_ERROR=6,Ei=ei,Du.COMPLETE="complete",hd=Du,Ru.EventType=Xr,Xr.OPEN="a",Xr.CLOSE="b",Xr.ERROR="c",Xr.MESSAGE="d",De.prototype.listen=De.prototype.J,fs=Ru,pe.prototype.listenOnce=pe.prototype.K,pe.prototype.getLastError=pe.prototype.Ha,pe.prototype.getLastErrorCode=pe.prototype.ya,pe.prototype.getStatus=pe.prototype.ca,pe.prototype.getResponseJson=pe.prototype.La,pe.prototype.getResponseText=pe.prototype.la,pe.prototype.send=pe.prototype.ea,pe.prototype.setWithCredentials=pe.prototype.Fa,ld=pe}).apply(typeof fi<"u"?fi:typeof self<"u"?self:typeof window<"u"?window:{});const $l="@firebase/firestore",jl="4.9.2";class Me{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Me.UNAUTHENTICATED=new Me(null),Me.GOOGLE_CREDENTIALS=new Me("google-credentials-uid"),Me.FIRST_PARTY=new Me("first-party-uid"),Me.MOCK_USER=new Me("mock-user");let qr="12.3.0";const Xn=new Ac("@firebase/firestore");function ur(){return Xn.logLevel}function M(n,...e){if(Xn.logLevel<=Q.DEBUG){const t=e.map(Rc);Xn.debug(`Firestore (${qr}): ${n}`,...t)}}function zt(n,...e){if(Xn.logLevel<=Q.ERROR){const t=e.map(Rc);Xn.error(`Firestore (${qr}): ${n}`,...t)}}function kr(n,...e){if(Xn.logLevel<=Q.WARN){const t=e.map(Rc);Xn.warn(`Firestore (${qr}): ${n}`,...t)}}function Rc(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function $(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,md(n,r,t)}function md(n,e,t){let r=`FIRESTORE (${qr}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw zt(r),new Error(r)}function te(n,e,t,r){let s="Unexpected state";typeof t=="string"?s=t:r=t,n||md(e,s,r)}function z(n,e){return n}const N={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class F extends Mt{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class $n{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class gd{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class rv{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Me.UNAUTHENTICATED)))}shutdown(){}}class sv{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class iv{constructor(e){this.t=e,this.currentUser=Me.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){te(this.o===void 0,42304);let r=this.i;const s=l=>this.i!==r?(r=this.i,t(l)):Promise.resolve();let i=new $n;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new $n,e.enqueueRetryable((()=>s(this.currentUser)))};const a=()=>{const l=i;e.enqueueRetryable((async()=>{await l.promise,await s(this.currentUser)}))},c=l=>{M("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit((l=>c(l))),setTimeout((()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?c(l):(M("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new $n)}}),0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((r=>this.i!==e?(M("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(te(typeof r.accessToken=="string",31837,{l:r}),new gd(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return te(e===null||typeof e=="string",2055,{h:e}),new Me(e)}}class ov{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=Me.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class av{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new ov(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(Me.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class ql{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class cv{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,nt(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){te(this.o===void 0,3512);const r=i=>{i.error!=null&&M("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const a=i.token!==this.m;return this.m=i.token,M("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable((()=>r(i)))};const s=i=>{M("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((i=>s(i))),setTimeout((()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):M("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new ql(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(te(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new ql(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function uv(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}class Pc{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=uv(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<t&&(r+=e.charAt(s[i]%62))}return r}}function X(n,e){return n<e?-1:n>e?1:0}function Ba(n,e){const t=Math.min(n.length,e.length);for(let r=0;r<t;r++){const s=n.charAt(r),i=e.charAt(r);if(s!==i)return _a(s)===_a(i)?X(s,i):_a(s)?1:-1}return X(n.length,e.length)}const lv=55296,hv=57343;function _a(n){const e=n.charCodeAt(0);return e>=lv&&e<=hv}function Nr(n,e,t){return n.length===e.length&&n.every(((r,s)=>t(r,e[s])))}const zl="__name__";class vt{constructor(e,t,r){t===void 0?t=0:t>e.length&&$(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&$(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return vt.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof vt?e.forEach((r=>{t.push(r)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let s=0;s<r;s++){const i=vt.compareSegments(e.get(s),t.get(s));if(i!==0)return i}return X(e.length,t.length)}static compareSegments(e,t){const r=vt.isNumericId(e),s=vt.isNumericId(t);return r&&!s?-1:!r&&s?1:r&&s?vt.extractNumericId(e).compare(vt.extractNumericId(t)):Ba(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return mn.fromString(e.substring(4,e.length-2))}}class ae extends vt{construct(e,t,r){return new ae(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new F(N.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter((s=>s.length>0)))}return new ae(t)}static emptyPath(){return new ae([])}}const fv=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Pe extends vt{construct(e,t,r){return new Pe(e,t,r)}static isValidIdentifier(e){return fv.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Pe.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===zl}static keyField(){return new Pe([zl])}static fromServerFormat(e){const t=[];let r="",s=0;const i=()=>{if(r.length===0)throw new F(N.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let a=!1;for(;s<e.length;){const c=e[s];if(c==="\\"){if(s+1===e.length)throw new F(N.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new F(N.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,s+=2}else c==="`"?(a=!a,s++):c!=="."||a?(r+=c,s++):(i(),s++)}if(i(),a)throw new F(N.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Pe(t)}static emptyPath(){return new Pe([])}}class B{constructor(e){this.path=e}static fromPath(e){return new B(ae.fromString(e))}static fromName(e){return new B(ae.fromString(e).popFirst(5))}static empty(){return new B(ae.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ae.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return ae.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new B(new ae(e.slice()))}}function _d(n,e,t){if(!t)throw new F(N.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function dv(n,e,t,r){if(e===!0&&r===!0)throw new F(N.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function Hl(n){if(!B.isDocumentKey(n))throw new F(N.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function Wl(n){if(B.isDocumentKey(n))throw new F(N.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function yd(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function Cc(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":$(12329,{type:typeof n})}function gn(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new F(N.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Cc(n);throw new F(N.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function _e(n,e){const t={typeString:n};return e&&(t.value=e),t}function qs(n,e){if(!yd(n))throw new F(N.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const s=e[r].typeString,i="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}const a=n[r];if(s&&typeof a!==s){t=`JSON field '${r}' must be a ${s}.`;break}if(i!==void 0&&a!==i.value){t=`Expected '${r}' field to equal '${i.value}'`;break}}if(t)throw new F(N.INVALID_ARGUMENT,t);return!0}const Gl=-62135596800,Kl=1e6;class ce{static now(){return ce.fromMillis(Date.now())}static fromDate(e){return ce.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*Kl);return new ce(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new F(N.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new F(N.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<Gl)throw new F(N.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new F(N.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Kl}_compareTo(e){return this.seconds===e.seconds?X(this.nanoseconds,e.nanoseconds):X(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:ce._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(qs(e,ce._jsonSchema))return new ce(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Gl;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}ce._jsonSchemaVersion="firestore/timestamp/1.0",ce._jsonSchema={type:_e("string",ce._jsonSchemaVersion),seconds:_e("number"),nanoseconds:_e("number")};class q{static fromTimestamp(e){return new q(e)}static min(){return new q(new ce(0,0))}static max(){return new q(new ce(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Ps=-1;function pv(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,s=q.fromTimestamp(r===1e9?new ce(t+1,0):new ce(t,r));return new En(s,B.empty(),e)}function mv(n){return new En(n.readTime,n.key,Ps)}class En{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new En(q.min(),B.empty(),Ps)}static max(){return new En(q.max(),B.empty(),Ps)}}function gv(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=B.comparator(n.documentKey,e.documentKey),t!==0?t:X(n.largestBatchId,e.largestBatchId))}const _v="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class yv{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function zr(n){if(n.code!==N.FAILED_PRECONDITION||n.message!==_v)throw n;M("LocalStore","Unexpectedly lost primary lease")}class k{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&$(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new k(((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(t,i).next(r,s)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof k?t:k.resolve(t)}catch(t){return k.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):k.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):k.reject(t)}static resolve(e){return new k(((t,r)=>{t(e)}))}static reject(e){return new k(((t,r)=>{r(e)}))}static waitFor(e){return new k(((t,r)=>{let s=0,i=0,a=!1;e.forEach((c=>{++s,c.next((()=>{++i,a&&i===s&&t()}),(l=>r(l)))})),a=!0,i===s&&t()}))}static or(e){let t=k.resolve(!1);for(const r of e)t=t.next((s=>s?k.resolve(s):r()));return t}static forEach(e,t){const r=[];return e.forEach(((s,i)=>{r.push(t.call(this,s,i))})),this.waitFor(r)}static mapArray(e,t){return new k(((r,s)=>{const i=e.length,a=new Array(i);let c=0;for(let l=0;l<i;l++){const h=l;t(e[h]).next((d=>{a[h]=d,++c,c===i&&r(a)}),(d=>s(d)))}}))}static doWhile(e,t){return new k(((r,s)=>{const i=()=>{e()===!0?t().next((()=>{i()}),s):r()};i()}))}}function vv(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Hr(n){return n.name==="IndexedDbTransactionError"}class _o{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>t.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}_o.ce=-1;const kc=-1;function yo(n){return n==null}function Mi(n){return n===0&&1/n==-1/0}function Ev(n){return typeof n=="number"&&Number.isInteger(n)&&!Mi(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const vd="";function Tv(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=Ql(e)),e=wv(n.get(t),e);return Ql(e)}function wv(n,e){let t=e;const r=n.length;for(let s=0;s<r;s++){const i=n.charAt(s);switch(i){case"\0":t+="";break;case vd:t+="";break;default:t+=i}}return t}function Ql(n){return n+vd+""}function Xl(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Rn(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Ed(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class he{constructor(e,t){this.comparator=e,this.root=t||Re.EMPTY}insert(e,t){return new he(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Re.BLACK,null,null))}remove(e){return new he(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Re.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return t+r.left.size;s<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,r)=>(e(t,r),!1)))}toString(){const e=[];return this.inorderTraversal(((t,r)=>(e.push(`${t}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new di(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new di(this.root,e,this.comparator,!1)}getReverseIterator(){return new di(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new di(this.root,e,this.comparator,!0)}}class di{constructor(e,t,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?r(e.key,t):1,t&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Re{constructor(e,t,r,s,i){this.key=e,this.value=t,this.color=r??Re.RED,this.left=s??Re.EMPTY,this.right=i??Re.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,s,i){return new Re(e??this.key,t??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,t,r),null):i===0?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Re.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),t(e,s.key)===0){if(s.right.isEmpty())return Re.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Re.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Re.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw $(43730,{key:this.key,value:this.value});if(this.right.isRed())throw $(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw $(27949);return e+(this.isRed()?0:1)}}Re.EMPTY=null,Re.RED=!0,Re.BLACK=!1;Re.EMPTY=new class{constructor(){this.size=0}get key(){throw $(57766)}get value(){throw $(16141)}get color(){throw $(16727)}get left(){throw $(29726)}get right(){throw $(36894)}copy(e,t,r,s,i){return this}insert(e,t,r){return new Re(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Ie{constructor(e){this.comparator=e,this.data=new he(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,r)=>(e(t),!1)))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Jl(this.data.getIterator())}getIteratorFrom(e){return new Jl(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((r=>{t=t.add(r)})),t}isEqual(e){if(!(e instanceof Ie)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Ie(this.comparator);return t.data=e,t}}class Jl{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Ye{constructor(e){this.fields=e,e.sort(Pe.comparator)}static empty(){return new Ye([])}unionWith(e){let t=new Ie(Pe.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Ye(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Nr(this.fields,e.fields,((t,r)=>t.isEqual(r)))}}class Td extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Ne{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new Td("Invalid base64 string: "+i):i}})(e);return new Ne(t)}static fromUint8Array(e){const t=(function(s){let i="";for(let a=0;a<s.length;++a)i+=String.fromCharCode(s[a]);return i})(e);return new Ne(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const r=new Uint8Array(t.length);for(let s=0;s<t.length;s++)r[s]=t.charCodeAt(s);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return X(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ne.EMPTY_BYTE_STRING=new Ne("");const Iv=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Tn(n){if(te(!!n,39018),typeof n=="string"){let e=0;const t=Iv.exec(n);if(te(!!t,46558,{timestamp:n}),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:me(n.seconds),nanos:me(n.nanos)}}function me(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function wn(n){return typeof n=="string"?Ne.fromBase64String(n):Ne.fromUint8Array(n)}const wd="server_timestamp",Id="__type__",Ad="__previous_value__",bd="__local_write_time__";function Nc(n){return(n?.mapValue?.fields||{})[Id]?.stringValue===wd}function vo(n){const e=n.mapValue.fields[Ad];return Nc(e)?vo(e):e}function Cs(n){const e=Tn(n.mapValue.fields[bd].timestampValue);return new ce(e.seconds,e.nanos)}class Av{constructor(e,t,r,s,i,a,c,l,h,d){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=a,this.autoDetectLongPolling=c,this.longPollingOptions=l,this.useFetchStreams=h,this.isUsingEmulator=d}}const Li="(default)";class ks{constructor(e,t){this.projectId=e,this.database=t||Li}static empty(){return new ks("","")}get isDefaultDatabase(){return this.database===Li}isEqual(e){return e instanceof ks&&e.projectId===this.projectId&&e.database===this.database}}const Sd="__type__",bv="__max__",pi={mapValue:{}},Rd="__vector__",xi="value";function In(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Nc(n)?4:Rv(n)?9007199254740991:Sv(n)?10:11:$(28295,{value:n})}function Nt(n,e){if(n===e)return!0;const t=In(n);if(t!==In(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Cs(n).isEqual(Cs(e));case 3:return(function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const a=Tn(s.timestampValue),c=Tn(i.timestampValue);return a.seconds===c.seconds&&a.nanos===c.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(s,i){return wn(s.bytesValue).isEqual(wn(i.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(s,i){return me(s.geoPointValue.latitude)===me(i.geoPointValue.latitude)&&me(s.geoPointValue.longitude)===me(i.geoPointValue.longitude)})(n,e);case 2:return(function(s,i){if("integerValue"in s&&"integerValue"in i)return me(s.integerValue)===me(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const a=me(s.doubleValue),c=me(i.doubleValue);return a===c?Mi(a)===Mi(c):isNaN(a)&&isNaN(c)}return!1})(n,e);case 9:return Nr(n.arrayValue.values||[],e.arrayValue.values||[],Nt);case 10:case 11:return(function(s,i){const a=s.mapValue.fields||{},c=i.mapValue.fields||{};if(Xl(a)!==Xl(c))return!1;for(const l in a)if(a.hasOwnProperty(l)&&(c[l]===void 0||!Nt(a[l],c[l])))return!1;return!0})(n,e);default:return $(52216,{left:n})}}function Ns(n,e){return(n.values||[]).find((t=>Nt(t,e)))!==void 0}function Dr(n,e){if(n===e)return 0;const t=In(n),r=In(e);if(t!==r)return X(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return X(n.booleanValue,e.booleanValue);case 2:return(function(i,a){const c=me(i.integerValue||i.doubleValue),l=me(a.integerValue||a.doubleValue);return c<l?-1:c>l?1:c===l?0:isNaN(c)?isNaN(l)?0:-1:1})(n,e);case 3:return Yl(n.timestampValue,e.timestampValue);case 4:return Yl(Cs(n),Cs(e));case 5:return Ba(n.stringValue,e.stringValue);case 6:return(function(i,a){const c=wn(i),l=wn(a);return c.compareTo(l)})(n.bytesValue,e.bytesValue);case 7:return(function(i,a){const c=i.split("/"),l=a.split("/");for(let h=0;h<c.length&&h<l.length;h++){const d=X(c[h],l[h]);if(d!==0)return d}return X(c.length,l.length)})(n.referenceValue,e.referenceValue);case 8:return(function(i,a){const c=X(me(i.latitude),me(a.latitude));return c!==0?c:X(me(i.longitude),me(a.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return Zl(n.arrayValue,e.arrayValue);case 10:return(function(i,a){const c=i.fields||{},l=a.fields||{},h=c[xi]?.arrayValue,d=l[xi]?.arrayValue,m=X(h?.values?.length||0,d?.values?.length||0);return m!==0?m:Zl(h,d)})(n.mapValue,e.mapValue);case 11:return(function(i,a){if(i===pi.mapValue&&a===pi.mapValue)return 0;if(i===pi.mapValue)return 1;if(a===pi.mapValue)return-1;const c=i.fields||{},l=Object.keys(c),h=a.fields||{},d=Object.keys(h);l.sort(),d.sort();for(let m=0;m<l.length&&m<d.length;++m){const g=Ba(l[m],d[m]);if(g!==0)return g;const I=Dr(c[l[m]],h[d[m]]);if(I!==0)return I}return X(l.length,d.length)})(n.mapValue,e.mapValue);default:throw $(23264,{he:t})}}function Yl(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return X(n,e);const t=Tn(n),r=Tn(e),s=X(t.seconds,r.seconds);return s!==0?s:X(t.nanos,r.nanos)}function Zl(n,e){const t=n.values||[],r=e.values||[];for(let s=0;s<t.length&&s<r.length;++s){const i=Dr(t[s],r[s]);if(i)return i}return X(t.length,r.length)}function Vr(n){return $a(n)}function $a(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const r=Tn(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return wn(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return B.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",s=!0;for(const i of t.values||[])s?s=!1:r+=",",r+=$a(i);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){const r=Object.keys(t.fields||{}).sort();let s="{",i=!0;for(const a of r)i?i=!1:s+=",",s+=`${a}:${$a(t.fields[a])}`;return s+"}"})(n.mapValue):$(61005,{value:n})}function Ti(n){switch(In(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=vo(n);return e?16+Ti(e):16;case 5:return 2*n.stringValue.length;case 6:return wn(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((s,i)=>s+Ti(i)),0)})(n.arrayValue);case 10:case 11:return(function(r){let s=0;return Rn(r.fields,((i,a)=>{s+=i.length+Ti(a)})),s})(n.mapValue);default:throw $(13486,{value:n})}}function ja(n){return!!n&&"integerValue"in n}function Dc(n){return!!n&&"arrayValue"in n}function eh(n){return!!n&&"nullValue"in n}function th(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function wi(n){return!!n&&"mapValue"in n}function Sv(n){return(n?.mapValue?.fields||{})[Sd]?.stringValue===Rd}function vs(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return Rn(n.mapValue.fields,((t,r)=>e.mapValue.fields[t]=vs(r))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=vs(n.arrayValue.values[t]);return e}return{...n}}function Rv(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===bv}class He{constructor(e){this.value=e}static empty(){return new He({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!wi(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=vs(t)}setAll(e){let t=Pe.emptyPath(),r={},s=[];e.forEach(((a,c)=>{if(!t.isImmediateParentOf(c)){const l=this.getFieldsMap(t);this.applyChanges(l,r,s),r={},s=[],t=c.popLast()}a?r[c.lastSegment()]=vs(a):s.push(c.lastSegment())}));const i=this.getFieldsMap(t);this.applyChanges(i,r,s)}delete(e){const t=this.field(e.popLast());wi(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Nt(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=t.mapValue.fields[e.get(r)];wi(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,r){Rn(t,((s,i)=>e[s]=i));for(const s of r)delete e[s]}clone(){return new He(vs(this.value))}}function Pd(n){const e=[];return Rn(n.fields,((t,r)=>{const s=new Pe([t]);if(wi(r)){const i=Pd(r.mapValue).fields;if(i.length===0)e.push(s);else for(const a of i)e.push(s.child(a))}else e.push(s)})),new Ye(e)}class Le{constructor(e,t,r,s,i,a,c){this.key=e,this.documentType=t,this.version=r,this.readTime=s,this.createTime=i,this.data=a,this.documentState=c}static newInvalidDocument(e){return new Le(e,0,q.min(),q.min(),q.min(),He.empty(),0)}static newFoundDocument(e,t,r,s){return new Le(e,1,t,q.min(),r,s,0)}static newNoDocument(e,t){return new Le(e,2,t,q.min(),q.min(),He.empty(),0)}static newUnknownDocument(e,t){return new Le(e,3,t,q.min(),q.min(),He.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(q.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=He.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=He.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=q.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Le&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Le(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Fi{constructor(e,t){this.position=e,this.inclusive=t}}function nh(n,e,t){let r=0;for(let s=0;s<n.position.length;s++){const i=e[s],a=n.position[s];if(i.field.isKeyField()?r=B.comparator(B.fromName(a.referenceValue),t.key):r=Dr(a,t.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function rh(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Nt(n.position[t],e.position[t]))return!1;return!0}class Ui{constructor(e,t="asc"){this.field=e,this.dir=t}}function Pv(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class Cd{}class Ee extends Cd{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new kv(e,t,r):t==="array-contains"?new Vv(e,r):t==="in"?new Ov(e,r):t==="not-in"?new Mv(e,r):t==="array-contains-any"?new Lv(e,r):new Ee(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new Nv(e,r):new Dv(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Dr(t,this.value)):t!==null&&In(this.value)===In(t)&&this.matchesComparison(Dr(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return $(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Dt extends Cd{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Dt(e,t)}matches(e){return kd(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function kd(n){return n.op==="and"}function Nd(n){return Cv(n)&&kd(n)}function Cv(n){for(const e of n.filters)if(e instanceof Dt)return!1;return!0}function qa(n){if(n instanceof Ee)return n.field.canonicalString()+n.op.toString()+Vr(n.value);if(Nd(n))return n.filters.map((e=>qa(e))).join(",");{const e=n.filters.map((t=>qa(t))).join(",");return`${n.op}(${e})`}}function Dd(n,e){return n instanceof Ee?(function(r,s){return s instanceof Ee&&r.op===s.op&&r.field.isEqual(s.field)&&Nt(r.value,s.value)})(n,e):n instanceof Dt?(function(r,s){return s instanceof Dt&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce(((i,a,c)=>i&&Dd(a,s.filters[c])),!0):!1})(n,e):void $(19439)}function Vd(n){return n instanceof Ee?(function(t){return`${t.field.canonicalString()} ${t.op} ${Vr(t.value)}`})(n):n instanceof Dt?(function(t){return t.op.toString()+" {"+t.getFilters().map(Vd).join(" ,")+"}"})(n):"Filter"}class kv extends Ee{constructor(e,t,r){super(e,t,r),this.key=B.fromName(r.referenceValue)}matches(e){const t=B.comparator(e.key,this.key);return this.matchesComparison(t)}}class Nv extends Ee{constructor(e,t){super(e,"in",t),this.keys=Od("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class Dv extends Ee{constructor(e,t){super(e,"not-in",t),this.keys=Od("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function Od(n,e){return(e.arrayValue?.values||[]).map((t=>B.fromName(t.referenceValue)))}class Vv extends Ee{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Dc(t)&&Ns(t.arrayValue,this.value)}}class Ov extends Ee{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Ns(this.value.arrayValue,t)}}class Mv extends Ee{constructor(e,t){super(e,"not-in",t)}matches(e){if(Ns(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Ns(this.value.arrayValue,t)}}class Lv extends Ee{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Dc(t)||!t.arrayValue.values)&&t.arrayValue.values.some((r=>Ns(this.value.arrayValue,r)))}}class xv{constructor(e,t=null,r=[],s=[],i=null,a=null,c=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=a,this.endAt=c,this.Te=null}}function sh(n,e=null,t=[],r=[],s=null,i=null,a=null){return new xv(n,e,t,r,s,i,a)}function Vc(n){const e=z(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((r=>qa(r))).join(","),t+="|ob:",t+=e.orderBy.map((r=>(function(i){return i.field.canonicalString()+i.dir})(r))).join(","),yo(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((r=>Vr(r))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((r=>Vr(r))).join(",")),e.Te=t}return e.Te}function Oc(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!Pv(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!Dd(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!rh(n.startAt,e.startAt)&&rh(n.endAt,e.endAt)}function za(n){return B.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}class Eo{constructor(e,t=null,r=[],s=[],i=null,a="F",c=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=a,this.startAt=c,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function Fv(n,e,t,r,s,i,a,c){return new Eo(n,e,t,r,s,i,a,c)}function Mc(n){return new Eo(n)}function ih(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function Uv(n){return n.collectionGroup!==null}function Es(n){const e=z(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),t.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let c=new Ie(Pe.comparator);return a.filters.forEach((l=>{l.getFlattenedFilters().forEach((h=>{h.isInequality()&&(c=c.add(h.field))}))})),c})(e).forEach((i=>{t.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new Ui(i,r))})),t.has(Pe.keyField().canonicalString())||e.Ie.push(new Ui(Pe.keyField(),r))}return e.Ie}function bt(n){const e=z(n);return e.Ee||(e.Ee=Bv(e,Es(n))),e.Ee}function Bv(n,e){if(n.limitType==="F")return sh(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((s=>{const i=s.dir==="desc"?"asc":"desc";return new Ui(s.field,i)}));const t=n.endAt?new Fi(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Fi(n.startAt.position,n.startAt.inclusive):null;return sh(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function Ha(n,e,t){return new Eo(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function To(n,e){return Oc(bt(n),bt(e))&&n.limitType===e.limitType}function Md(n){return`${Vc(bt(n))}|lt:${n.limitType}`}function lr(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map((s=>Vd(s))).join(", ")}]`),yo(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map((s=>(function(a){return`${a.field.canonicalString()} (${a.dir})`})(s))).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map((s=>Vr(s))).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map((s=>Vr(s))).join(",")),`Target(${r})`})(bt(n))}; limitType=${n.limitType})`}function wo(n,e){return e.isFoundDocument()&&(function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):B.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)})(n,e)&&(function(r,s){for(const i of Es(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0})(n,e)&&(function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0})(n,e)&&(function(r,s){return!(r.startAt&&!(function(a,c,l){const h=nh(a,c,l);return a.inclusive?h<=0:h<0})(r.startAt,Es(r),s)||r.endAt&&!(function(a,c,l){const h=nh(a,c,l);return a.inclusive?h>=0:h>0})(r.endAt,Es(r),s))})(n,e)}function $v(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function Ld(n){return(e,t)=>{let r=!1;for(const s of Es(n)){const i=jv(s,e,t);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function jv(n,e,t){const r=n.field.isKeyField()?B.comparator(e.key,t.key):(function(i,a,c){const l=a.data.field(i),h=c.data.field(i);return l!==null&&h!==null?Dr(l,h):$(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return $(19790,{direction:n.dir})}}class nr{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[t]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Rn(this.inner,((t,r)=>{for(const[s,i]of r)e(s,i)}))}isEmpty(){return Ed(this.inner)}size(){return this.innerSize}}const qv=new he(B.comparator);function Ht(){return qv}const xd=new he(B.comparator);function ds(...n){let e=xd;for(const t of n)e=e.insert(t.key,t);return e}function Fd(n){let e=xd;return n.forEach(((t,r)=>e=e.insert(t,r.overlayedDocument))),e}function Ln(){return Ts()}function Ud(){return Ts()}function Ts(){return new nr((n=>n.toString()),((n,e)=>n.isEqual(e)))}const zv=new he(B.comparator),Hv=new Ie(B.comparator);function J(...n){let e=Hv;for(const t of n)e=e.add(t);return e}const Wv=new Ie(X);function Gv(){return Wv}function Lc(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Mi(e)?"-0":e}}function Bd(n){return{integerValue:""+n}}function Kv(n,e){return Ev(e)?Bd(e):Lc(n,e)}class Io{constructor(){this._=void 0}}function Qv(n,e,t){return n instanceof Bi?(function(s,i){const a={fields:{[Id]:{stringValue:wd},[bd]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&Nc(i)&&(i=vo(i)),i&&(a.fields[Ad]=i),{mapValue:a}})(t,e):n instanceof Ds?jd(n,e):n instanceof Vs?qd(n,e):(function(s,i){const a=$d(s,i),c=oh(a)+oh(s.Ae);return ja(a)&&ja(s.Ae)?Bd(c):Lc(s.serializer,c)})(n,e)}function Xv(n,e,t){return n instanceof Ds?jd(n,e):n instanceof Vs?qd(n,e):t}function $d(n,e){return n instanceof $i?(function(r){return ja(r)||(function(i){return!!i&&"doubleValue"in i})(r)})(e)?e:{integerValue:0}:null}class Bi extends Io{}class Ds extends Io{constructor(e){super(),this.elements=e}}function jd(n,e){const t=zd(e);for(const r of n.elements)t.some((s=>Nt(s,r)))||t.push(r);return{arrayValue:{values:t}}}class Vs extends Io{constructor(e){super(),this.elements=e}}function qd(n,e){let t=zd(e);for(const r of n.elements)t=t.filter((s=>!Nt(s,r)));return{arrayValue:{values:t}}}class $i extends Io{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function oh(n){return me(n.integerValue||n.doubleValue)}function zd(n){return Dc(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function Jv(n,e){return n.field.isEqual(e.field)&&(function(r,s){return r instanceof Ds&&s instanceof Ds||r instanceof Vs&&s instanceof Vs?Nr(r.elements,s.elements,Nt):r instanceof $i&&s instanceof $i?Nt(r.Ae,s.Ae):r instanceof Bi&&s instanceof Bi})(n.transform,e.transform)}class Yv{constructor(e,t){this.version=e,this.transformResults=t}}class lt{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new lt}static exists(e){return new lt(void 0,e)}static updateTime(e){return new lt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Ii(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Ao{}function Hd(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new xc(n.key,lt.none()):new zs(n.key,n.data,lt.none());{const t=n.data,r=He.empty();let s=new Ie(Pe.comparator);for(let i of e.fields)if(!s.has(i)){let a=t.field(i);a===null&&i.length>1&&(i=i.popLast(),a=t.field(i)),a===null?r.delete(i):r.set(i,a),s=s.add(i)}return new Pn(n.key,r,new Ye(s.toArray()),lt.none())}}function Zv(n,e,t){n instanceof zs?(function(s,i,a){const c=s.value.clone(),l=ch(s.fieldTransforms,i,a.transformResults);c.setAll(l),i.convertToFoundDocument(a.version,c).setHasCommittedMutations()})(n,e,t):n instanceof Pn?(function(s,i,a){if(!Ii(s.precondition,i))return void i.convertToUnknownDocument(a.version);const c=ch(s.fieldTransforms,i,a.transformResults),l=i.data;l.setAll(Wd(s)),l.setAll(c),i.convertToFoundDocument(a.version,l).setHasCommittedMutations()})(n,e,t):(function(s,i,a){i.convertToNoDocument(a.version).setHasCommittedMutations()})(0,e,t)}function ws(n,e,t,r){return n instanceof zs?(function(i,a,c,l){if(!Ii(i.precondition,a))return c;const h=i.value.clone(),d=uh(i.fieldTransforms,l,a);return h.setAll(d),a.convertToFoundDocument(a.version,h).setHasLocalMutations(),null})(n,e,t,r):n instanceof Pn?(function(i,a,c,l){if(!Ii(i.precondition,a))return c;const h=uh(i.fieldTransforms,l,a),d=a.data;return d.setAll(Wd(i)),d.setAll(h),a.convertToFoundDocument(a.version,d).setHasLocalMutations(),c===null?null:c.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map((m=>m.field)))})(n,e,t,r):(function(i,a,c){return Ii(i.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):c})(n,e,t)}function eE(n,e){let t=null;for(const r of n.fieldTransforms){const s=e.data.field(r.field),i=$d(r.transform,s||null);i!=null&&(t===null&&(t=He.empty()),t.set(r.field,i))}return t||null}function ah(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&Nr(r,s,((i,a)=>Jv(i,a)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class zs extends Ao{constructor(e,t,r,s=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Pn extends Ao{constructor(e,t,r,s,i=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Wd(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}})),e}function ch(n,e,t){const r=new Map;te(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let s=0;s<t.length;s++){const i=n[s],a=i.transform,c=e.data.field(i.field);r.set(i.field,Xv(a,c,t[s]))}return r}function uh(n,e,t){const r=new Map;for(const s of n){const i=s.transform,a=t.data.field(s.field);r.set(s.field,Qv(i,a,e))}return r}class xc extends Ao{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class tE extends Ao{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class nE{constructor(e,t,r,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&Zv(i,e,r[s])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=ws(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=ws(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=Ud();return this.mutations.forEach((s=>{const i=e.get(s.key),a=i.overlayedDocument;let c=this.applyToLocalView(a,i.mutatedFields);c=t.has(s.key)?null:c;const l=Hd(a,c);l!==null&&r.set(s.key,l),a.isValidDocument()||a.convertToNoDocument(q.min())})),r}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),J())}isEqual(e){return this.batchId===e.batchId&&Nr(this.mutations,e.mutations,((t,r)=>ah(t,r)))&&Nr(this.baseMutations,e.baseMutations,((t,r)=>ah(t,r)))}}class Fc{constructor(e,t,r,s){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=s}static from(e,t,r){te(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let s=(function(){return zv})();const i=e.mutations;for(let a=0;a<i.length;a++)s=s.insert(i[a].key,r[a].version);return new Fc(e,t,r,s)}}class rE{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class sE{constructor(e,t){this.count=e,this.unchangedNames=t}}var ge,Y;function iE(n){switch(n){case N.OK:return $(64938);case N.CANCELLED:case N.UNKNOWN:case N.DEADLINE_EXCEEDED:case N.RESOURCE_EXHAUSTED:case N.INTERNAL:case N.UNAVAILABLE:case N.UNAUTHENTICATED:return!1;case N.INVALID_ARGUMENT:case N.NOT_FOUND:case N.ALREADY_EXISTS:case N.PERMISSION_DENIED:case N.FAILED_PRECONDITION:case N.ABORTED:case N.OUT_OF_RANGE:case N.UNIMPLEMENTED:case N.DATA_LOSS:return!0;default:return $(15467,{code:n})}}function Gd(n){if(n===void 0)return zt("GRPC error has no .code"),N.UNKNOWN;switch(n){case ge.OK:return N.OK;case ge.CANCELLED:return N.CANCELLED;case ge.UNKNOWN:return N.UNKNOWN;case ge.DEADLINE_EXCEEDED:return N.DEADLINE_EXCEEDED;case ge.RESOURCE_EXHAUSTED:return N.RESOURCE_EXHAUSTED;case ge.INTERNAL:return N.INTERNAL;case ge.UNAVAILABLE:return N.UNAVAILABLE;case ge.UNAUTHENTICATED:return N.UNAUTHENTICATED;case ge.INVALID_ARGUMENT:return N.INVALID_ARGUMENT;case ge.NOT_FOUND:return N.NOT_FOUND;case ge.ALREADY_EXISTS:return N.ALREADY_EXISTS;case ge.PERMISSION_DENIED:return N.PERMISSION_DENIED;case ge.FAILED_PRECONDITION:return N.FAILED_PRECONDITION;case ge.ABORTED:return N.ABORTED;case ge.OUT_OF_RANGE:return N.OUT_OF_RANGE;case ge.UNIMPLEMENTED:return N.UNIMPLEMENTED;case ge.DATA_LOSS:return N.DATA_LOSS;default:return $(39323,{code:n})}}(Y=ge||(ge={}))[Y.OK=0]="OK",Y[Y.CANCELLED=1]="CANCELLED",Y[Y.UNKNOWN=2]="UNKNOWN",Y[Y.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Y[Y.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Y[Y.NOT_FOUND=5]="NOT_FOUND",Y[Y.ALREADY_EXISTS=6]="ALREADY_EXISTS",Y[Y.PERMISSION_DENIED=7]="PERMISSION_DENIED",Y[Y.UNAUTHENTICATED=16]="UNAUTHENTICATED",Y[Y.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Y[Y.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Y[Y.ABORTED=10]="ABORTED",Y[Y.OUT_OF_RANGE=11]="OUT_OF_RANGE",Y[Y.UNIMPLEMENTED=12]="UNIMPLEMENTED",Y[Y.INTERNAL=13]="INTERNAL",Y[Y.UNAVAILABLE=14]="UNAVAILABLE",Y[Y.DATA_LOSS=15]="DATA_LOSS";function oE(){return new TextEncoder}const aE=new mn([4294967295,4294967295],0);function lh(n){const e=oE().encode(n),t=new ud;return t.update(e),new Uint8Array(t.digest())}function hh(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new mn([t,r],0),new mn([s,i],0)]}class Uc{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new ps(`Invalid padding: ${t}`);if(r<0)throw new ps(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new ps(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new ps(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=mn.fromNumber(this.ge)}ye(e,t,r){let s=e.add(t.multiply(mn.fromNumber(r)));return s.compare(aE)===1&&(s=new mn([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=lh(e),[r,s]=hh(t);for(let i=0;i<this.hashCount;i++){const a=this.ye(r,s,i);if(!this.we(a))return!1}return!0}static create(e,t,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),a=new Uc(i,s,t);return r.forEach((c=>a.insert(c))),a}insert(e){if(this.ge===0)return;const t=lh(e),[r,s]=hh(t);for(let i=0;i<this.hashCount;i++){const a=this.ye(r,s,i);this.Se(a)}}Se(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class ps extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class bo{constructor(e,t,r,s,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const s=new Map;return s.set(e,Hs.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new bo(q.min(),s,new he(X),Ht(),J())}}class Hs{constructor(e,t,r,s,i){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new Hs(r,t,J(),J(),J())}}class Ai{constructor(e,t,r,s){this.be=e,this.removedTargetIds=t,this.key=r,this.De=s}}class Kd{constructor(e,t){this.targetId=e,this.Ce=t}}class Qd{constructor(e,t,r=Ne.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=s}}class fh{constructor(){this.ve=0,this.Fe=dh(),this.Me=Ne.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=J(),t=J(),r=J();return this.Fe.forEach(((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:r=r.add(s);break;default:$(38017,{changeType:i})}})),new Hs(this.Me,this.xe,e,t,r)}qe(){this.Oe=!1,this.Fe=dh()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,te(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class cE{constructor(e){this.Ge=e,this.ze=new Map,this.je=Ht(),this.Je=mi(),this.He=mi(),this.Ye=new he(X)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:$(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((r,s)=>{this.rt(s)&&t(s)}))}st(e){const t=e.targetId,r=e.Ce.count,s=this.ot(t);if(s){const i=s.target;if(za(i))if(r===0){const a=new B(i.path);this.et(t,a,Le.newNoDocument(a,q.min()))}else te(r===1,20013,{expectedCount:r});else{const a=this._t(t);if(a!==r){const c=this.ut(e),l=c?this.ct(c,e,a):1;if(l!==0){this.it(t);const h=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,h)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=t;let a,c;try{a=wn(r).toUint8Array()}catch(l){if(l instanceof Td)return kr("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{c=new Uc(a,s,i)}catch(l){return kr(l instanceof ps?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return c.ge===0?null:c}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){const r=this.Ge.getRemoteKeysForTarget(t);let s=0;return r.forEach((i=>{const a=this.Ge.ht(),c=`projects/${a.projectId}/databases/${a.database}/documents/${i.path.canonicalString()}`;e.mightContain(c)||(this.et(t,i,null),s++)})),s}Tt(e){const t=new Map;this.ze.forEach(((i,a)=>{const c=this.ot(a);if(c){if(i.current&&za(c.target)){const l=new B(c.target.path);this.It(l).has(a)||this.Et(a,l)||this.et(a,l,Le.newNoDocument(l,e))}i.Be&&(t.set(a,i.ke()),i.qe())}}));let r=J();this.He.forEach(((i,a)=>{let c=!0;a.forEachWhile((l=>{const h=this.ot(l);return!h||h.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)})),c&&(r=r.add(i))})),this.je.forEach(((i,a)=>a.setReadTime(e)));const s=new bo(e,t,this.Ye,this.je,r);return this.je=Ht(),this.Je=mi(),this.He=mi(),this.Ye=new he(X),s}Xe(e,t){if(!this.rt(e))return;const r=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,r),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,t)?s.Qe(t,1):s.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new fh,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Ie(X),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Ie(X),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||M("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new fh),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function mi(){return new he(B.comparator)}function dh(){return new he(B.comparator)}const uE={asc:"ASCENDING",desc:"DESCENDING"},lE={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},hE={and:"AND",or:"OR"};class fE{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Wa(n,e){return n.useProto3Json||yo(e)?e:{value:e}}function ji(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Xd(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function dE(n,e){return ji(n,e.toTimestamp())}function St(n){return te(!!n,49232),q.fromTimestamp((function(t){const r=Tn(t);return new ce(r.seconds,r.nanos)})(n))}function Bc(n,e){return Ga(n,e).canonicalString()}function Ga(n,e){const t=(function(s){return new ae(["projects",s.projectId,"databases",s.database])})(n).child("documents");return e===void 0?t:t.child(e)}function Jd(n){const e=ae.fromString(n);return te(np(e),10190,{key:e.toString()}),e}function Ka(n,e){return Bc(n.databaseId,e.path)}function ya(n,e){const t=Jd(e);if(t.get(1)!==n.databaseId.projectId)throw new F(N.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new F(N.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new B(Zd(t))}function Yd(n,e){return Bc(n.databaseId,e)}function pE(n){const e=Jd(n);return e.length===4?ae.emptyPath():Zd(e)}function Qa(n){return new ae(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Zd(n){return te(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function ph(n,e,t){return{name:Ka(n,e),fields:t.value.mapValue.fields}}function mE(n,e){let t;if("targetChange"in e){e.targetChange;const r=(function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:$(39313,{state:h})})(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=(function(h,d){return h.useProto3Json?(te(d===void 0||typeof d=="string",58123),Ne.fromBase64String(d||"")):(te(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),Ne.fromUint8Array(d||new Uint8Array))})(n,e.targetChange.resumeToken),a=e.targetChange.cause,c=a&&(function(h){const d=h.code===void 0?N.UNKNOWN:Gd(h.code);return new F(d,h.message||"")})(a);t=new Qd(r,s,i,c||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=ya(n,r.document.name),i=St(r.document.updateTime),a=r.document.createTime?St(r.document.createTime):q.min(),c=new He({mapValue:{fields:r.document.fields}}),l=Le.newFoundDocument(s,i,a,c),h=r.targetIds||[],d=r.removedTargetIds||[];t=new Ai(h,d,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=ya(n,r.document),i=r.readTime?St(r.readTime):q.min(),a=Le.newNoDocument(s,i),c=r.removedTargetIds||[];t=new Ai([],c,a.key,a)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=ya(n,r.document),i=r.removedTargetIds||[];t=new Ai([],i,s,null)}else{if(!("filter"in e))return $(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,a=new sE(s,i),c=r.targetId;t=new Kd(c,a)}}return t}function gE(n,e){let t;if(e instanceof zs)t={update:ph(n,e.key,e.value)};else if(e instanceof xc)t={delete:Ka(n,e.key)};else if(e instanceof Pn)t={update:ph(n,e.key,e.data),updateMask:bE(e.fieldMask)};else{if(!(e instanceof tE))return $(16599,{Vt:e.type});t={verify:Ka(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((r=>(function(i,a){const c=a.transform;if(c instanceof Bi)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof Ds)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof Vs)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof $i)return{fieldPath:a.field.canonicalString(),increment:c.Ae};throw $(20930,{transform:a.transform})})(0,r)))),e.precondition.isNone||(t.currentDocument=(function(s,i){return i.updateTime!==void 0?{updateTime:dE(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:$(27497)})(n,e.precondition)),t}function _E(n,e){return n&&n.length>0?(te(e!==void 0,14353),n.map((t=>(function(s,i){let a=s.updateTime?St(s.updateTime):St(i);return a.isEqual(q.min())&&(a=St(i)),new Yv(a,s.transformResults||[])})(t,e)))):[]}function yE(n,e){return{documents:[Yd(n,e.path)]}}function vE(n,e){const t={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=Yd(n,s);const i=(function(h){if(h.length!==0)return tp(Dt.create(h,"and"))})(e.filters);i&&(t.structuredQuery.where=i);const a=(function(h){if(h.length!==0)return h.map((d=>(function(g){return{field:hr(g.field),direction:wE(g.dir)}})(d)))})(e.orderBy);a&&(t.structuredQuery.orderBy=a);const c=Wa(n,e.limit);return c!==null&&(t.structuredQuery.limit=c),e.startAt&&(t.structuredQuery.startAt=(function(h){return{before:h.inclusive,values:h.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(h){return{before:!h.inclusive,values:h.position}})(e.endAt)),{ft:t,parent:s}}function EE(n){let e=pE(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let s=null;if(r>0){te(r===1,65062);const d=t.from[0];d.allDescendants?s=d.collectionId:e=e.child(d.collectionId)}let i=[];t.where&&(i=(function(m){const g=ep(m);return g instanceof Dt&&Nd(g)?g.getFilters():[g]})(t.where));let a=[];t.orderBy&&(a=(function(m){return m.map((g=>(function(S){return new Ui(fr(S.field),(function(R){switch(R){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(S.direction))})(g)))})(t.orderBy));let c=null;t.limit&&(c=(function(m){let g;return g=typeof m=="object"?m.value:m,yo(g)?null:g})(t.limit));let l=null;t.startAt&&(l=(function(m){const g=!!m.before,I=m.values||[];return new Fi(I,g)})(t.startAt));let h=null;return t.endAt&&(h=(function(m){const g=!m.before,I=m.values||[];return new Fi(I,g)})(t.endAt)),Fv(e,s,a,i,c,"F",l,h)}function TE(n,e){const t=(function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return $(28987,{purpose:s})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function ep(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=fr(t.unaryFilter.field);return Ee.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=fr(t.unaryFilter.field);return Ee.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=fr(t.unaryFilter.field);return Ee.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=fr(t.unaryFilter.field);return Ee.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return $(61313);default:return $(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Ee.create(fr(t.fieldFilter.field),(function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return $(58110);default:return $(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Dt.create(t.compositeFilter.filters.map((r=>ep(r))),(function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return $(1026)}})(t.compositeFilter.op))})(n):$(30097,{filter:n})}function wE(n){return uE[n]}function IE(n){return lE[n]}function AE(n){return hE[n]}function hr(n){return{fieldPath:n.canonicalString()}}function fr(n){return Pe.fromServerFormat(n.fieldPath)}function tp(n){return n instanceof Ee?(function(t){if(t.op==="=="){if(th(t.value))return{unaryFilter:{field:hr(t.field),op:"IS_NAN"}};if(eh(t.value))return{unaryFilter:{field:hr(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(th(t.value))return{unaryFilter:{field:hr(t.field),op:"IS_NOT_NAN"}};if(eh(t.value))return{unaryFilter:{field:hr(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:hr(t.field),op:IE(t.op),value:t.value}}})(n):n instanceof Dt?(function(t){const r=t.getFilters().map((s=>tp(s)));return r.length===1?r[0]:{compositeFilter:{op:AE(t.op),filters:r}}})(n):$(54877,{filter:n})}function bE(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function np(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}class un{constructor(e,t,r,s,i=q.min(),a=q.min(),c=Ne.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=c,this.expectedCount=l}withSequenceNumber(e){return new un(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new un(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new un(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new un(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class SE{constructor(e){this.yt=e}}function RE(n){const e=EE({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Ha(e,e.limit,"L"):e}class PE{constructor(){this.Cn=new CE}addToCollectionParentIndex(e,t){return this.Cn.add(t),k.resolve()}getCollectionParents(e,t){return k.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return k.resolve()}deleteFieldIndex(e,t){return k.resolve()}deleteAllFieldIndexes(e){return k.resolve()}createTargetIndexes(e,t){return k.resolve()}getDocumentsMatchingTarget(e,t){return k.resolve(null)}getIndexType(e,t){return k.resolve(0)}getFieldIndexes(e,t){return k.resolve([])}getNextCollectionGroupToUpdate(e){return k.resolve(null)}getMinOffset(e,t){return k.resolve(En.min())}getMinOffsetFromCollectionGroup(e,t){return k.resolve(En.min())}updateCollectionGroup(e,t,r){return k.resolve()}updateIndexEntries(e,t){return k.resolve()}}class CE{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t]||new Ie(ae.comparator),i=!s.has(r);return this.index[t]=s.add(r),i}has(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t];return s&&s.has(r)}getEntries(e){return(this.index[e]||new Ie(ae.comparator)).toArray()}}const mh={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},rp=41943040;class ze{static withCacheSize(e){return new ze(e,ze.DEFAULT_COLLECTION_PERCENTILE,ze.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}ze.DEFAULT_COLLECTION_PERCENTILE=10,ze.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ze.DEFAULT=new ze(rp,ze.DEFAULT_COLLECTION_PERCENTILE,ze.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ze.DISABLED=new ze(-1,0,0);class Or{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Or(0)}static cr(){return new Or(-1)}}const gh="LruGarbageCollector",kE=1048576;function _h([n,e],[t,r]){const s=X(n,t);return s===0?X(e,r):s}class NE{constructor(e){this.Ir=e,this.buffer=new Ie(_h),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();_h(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class DE{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){M(gh,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Hr(t)?M(gh,"Ignoring IndexedDB error during garbage collection: ",t):await zr(t)}await this.Vr(3e5)}))}}class VE{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((r=>Math.floor(t/100*r)))}nthSequenceNumber(e,t){if(t===0)return k.resolve(_o.ce);const r=new NE(t);return this.mr.forEachTarget(e,(s=>r.Ar(s.sequenceNumber))).next((()=>this.mr.pr(e,(s=>r.Ar(s))))).next((()=>r.maxValue))}removeTargets(e,t,r){return this.mr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(M("LruGarbageCollector","Garbage collection skipped; disabled"),k.resolve(mh)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(M("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),mh):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let r,s,i,a,c,l,h;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((m=>(m>this.params.maximumSequenceNumbersToCollect?(M("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${m}`),s=this.params.maximumSequenceNumbersToCollect):s=m,a=Date.now(),this.nthSequenceNumber(e,s)))).next((m=>(r=m,c=Date.now(),this.removeTargets(e,r,t)))).next((m=>(i=m,l=Date.now(),this.removeOrphanedDocuments(e,r)))).next((m=>(h=Date.now(),ur()<=Q.DEBUG&&M("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-d}ms
	Determined least recently used ${s} in `+(c-a)+`ms
	Removed ${i} targets in `+(l-c)+`ms
	Removed ${m} documents in `+(h-l)+`ms
Total Duration: ${h-d}ms`),k.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:m}))))}}function OE(n,e){return new VE(n,e)}class ME{constructor(){this.changes=new nr((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Le.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?k.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class LE{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class xE{constructor(e,t,r,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next((s=>(r=s,this.remoteDocumentCache.getEntry(e,t)))).next((s=>(r!==null&&ws(r.mutation,s,Ye.empty(),ce.now()),s)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.getLocalViewOfDocuments(e,r,J()).next((()=>r))))}getLocalViewOfDocuments(e,t,r=J()){const s=Ln();return this.populateOverlays(e,s,t).next((()=>this.computeViews(e,t,s,r).next((i=>{let a=ds();return i.forEach(((c,l)=>{a=a.insert(c,l.overlayedDocument)})),a}))))}getOverlayedDocuments(e,t){const r=Ln();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,J())))}populateOverlays(e,t,r){const s=[];return r.forEach((i=>{t.has(i)||s.push(i)})),this.documentOverlayCache.getOverlays(e,s).next((i=>{i.forEach(((a,c)=>{t.set(a,c)}))}))}computeViews(e,t,r,s){let i=Ht();const a=Ts(),c=(function(){return Ts()})();return t.forEach(((l,h)=>{const d=r.get(h.key);s.has(h.key)&&(d===void 0||d.mutation instanceof Pn)?i=i.insert(h.key,h):d!==void 0?(a.set(h.key,d.mutation.getFieldMask()),ws(d.mutation,h,d.mutation.getFieldMask(),ce.now())):a.set(h.key,Ye.empty())})),this.recalculateAndSaveOverlays(e,i).next((l=>(l.forEach(((h,d)=>a.set(h,d))),t.forEach(((h,d)=>c.set(h,new LE(d,a.get(h)??null)))),c)))}recalculateAndSaveOverlays(e,t){const r=Ts();let s=new he(((a,c)=>a-c)),i=J();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((a=>{for(const c of a)c.keys().forEach((l=>{const h=t.get(l);if(h===null)return;let d=r.get(l)||Ye.empty();d=c.applyToLocalView(h,d),r.set(l,d);const m=(s.get(c.batchId)||J()).add(l);s=s.insert(c.batchId,m)}))})).next((()=>{const a=[],c=s.getReverseIterator();for(;c.hasNext();){const l=c.getNext(),h=l.key,d=l.value,m=Ud();d.forEach((g=>{if(!i.has(g)){const I=Hd(t.get(g),r.get(g));I!==null&&m.set(g,I),i=i.add(g)}})),a.push(this.documentOverlayCache.saveOverlays(e,h,m))}return k.waitFor(a)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,t,r,s){return(function(a){return B.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Uv(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,s):this.getDocumentsMatchingCollectionQuery(e,t,r,s)}getNextDocuments(e,t,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,s).next((i=>{const a=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,s-i.size):k.resolve(Ln());let c=Ps,l=i;return a.next((h=>k.forEach(h,((d,m)=>(c<m.largestBatchId&&(c=m.largestBatchId),i.get(d)?k.resolve():this.remoteDocumentCache.getEntry(e,d).next((g=>{l=l.insert(d,g)}))))).next((()=>this.populateOverlays(e,h,i))).next((()=>this.computeViews(e,l,h,J()))).next((d=>({batchId:c,changes:Fd(d)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new B(t)).next((r=>{let s=ds();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s}))}getDocumentsMatchingCollectionGroupQuery(e,t,r,s){const i=t.collectionGroup;let a=ds();return this.indexManager.getCollectionParents(e,i).next((c=>k.forEach(c,(l=>{const h=(function(m,g){return new Eo(g,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)})(t,l.child(i));return this.getDocumentsMatchingCollectionQuery(e,h,r,s).next((d=>{d.forEach(((m,g)=>{a=a.insert(m,g)}))}))})).next((()=>a))))}getDocumentsMatchingCollectionQuery(e,t,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next((a=>(i=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,i,s)))).next((a=>{i.forEach(((l,h)=>{const d=h.getKey();a.get(d)===null&&(a=a.insert(d,Le.newInvalidDocument(d)))}));let c=ds();return a.forEach(((l,h)=>{const d=i.get(l);d!==void 0&&ws(d.mutation,h,Ye.empty(),ce.now()),wo(t,h)&&(c=c.insert(l,h))})),c}))}}class FE{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return k.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(s){return{id:s.id,version:s.version,createTime:St(s.createTime)}})(t)),k.resolve()}getNamedQuery(e,t){return k.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(s){return{name:s.name,query:RE(s.bundledQuery),readTime:St(s.readTime)}})(t)),k.resolve()}}class UE{constructor(){this.overlays=new he(B.comparator),this.qr=new Map}getOverlay(e,t){return k.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Ln();return k.forEach(t,(s=>this.getOverlay(e,s).next((i=>{i!==null&&r.set(s,i)})))).next((()=>r))}saveOverlays(e,t,r){return r.forEach(((s,i)=>{this.St(e,t,i)})),k.resolve()}removeOverlaysForBatchId(e,t,r){const s=this.qr.get(r);return s!==void 0&&(s.forEach((i=>this.overlays=this.overlays.remove(i))),this.qr.delete(r)),k.resolve()}getOverlaysForCollection(e,t,r){const s=Ln(),i=t.length+1,a=new B(t.child("")),c=this.overlays.getIteratorFrom(a);for(;c.hasNext();){const l=c.getNext().value,h=l.getKey();if(!t.isPrefixOf(h.path))break;h.path.length===i&&l.largestBatchId>r&&s.set(l.getKey(),l)}return k.resolve(s)}getOverlaysForCollectionGroup(e,t,r,s){let i=new he(((h,d)=>h-d));const a=this.overlays.getIterator();for(;a.hasNext();){const h=a.getNext().value;if(h.getKey().getCollectionGroup()===t&&h.largestBatchId>r){let d=i.get(h.largestBatchId);d===null&&(d=Ln(),i=i.insert(h.largestBatchId,d)),d.set(h.getKey(),h)}}const c=Ln(),l=i.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach(((h,d)=>c.set(h,d))),!(c.size()>=s)););return k.resolve(c)}St(e,t,r){const s=this.overlays.get(r.key);if(s!==null){const a=this.qr.get(s.largestBatchId).delete(r.key);this.qr.set(s.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new rE(t,r));let i=this.qr.get(t);i===void 0&&(i=J(),this.qr.set(t,i)),this.qr.set(t,i.add(r.key))}}class BE{constructor(){this.sessionToken=Ne.EMPTY_BYTE_STRING}getSessionToken(e){return k.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,k.resolve()}}class $c{constructor(){this.Qr=new Ie(Se.$r),this.Ur=new Ie(Se.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const r=new Se(e,t);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,t){e.forEach((r=>this.addReference(r,t)))}removeReference(e,t){this.Gr(new Se(e,t))}zr(e,t){e.forEach((r=>this.removeReference(r,t)))}jr(e){const t=new B(new ae([])),r=new Se(t,e),s=new Se(t,e+1),i=[];return this.Ur.forEachInRange([r,s],(a=>{this.Gr(a),i.push(a.key)})),i}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new B(new ae([])),r=new Se(t,e),s=new Se(t,e+1);let i=J();return this.Ur.forEachInRange([r,s],(a=>{i=i.add(a.key)})),i}containsKey(e){const t=new Se(e,0),r=this.Qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class Se{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return B.comparator(e.key,t.key)||X(e.Yr,t.Yr)}static Kr(e,t){return X(e.Yr,t.Yr)||B.comparator(e.key,t.key)}}class $E{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Ie(Se.$r)}checkEmpty(e){return k.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,s){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new nE(i,t,r,s);this.mutationQueue.push(a);for(const c of s)this.Zr=this.Zr.add(new Se(c.key,i)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return k.resolve(a)}lookupMutationBatch(e,t){return k.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,s=this.ei(r),i=s<0?0:s;return k.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return k.resolve(this.mutationQueue.length===0?kc:this.tr-1)}getAllMutationBatches(e){return k.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new Se(t,0),s=new Se(t,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([r,s],(a=>{const c=this.Xr(a.Yr);i.push(c)})),k.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Ie(X);return t.forEach((s=>{const i=new Se(s,0),a=new Se(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,a],(c=>{r=r.add(c.Yr)}))})),k.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,s=r.length+1;let i=r;B.isDocumentKey(i)||(i=i.child(""));const a=new Se(new B(i),0);let c=new Ie(X);return this.Zr.forEachWhile((l=>{const h=l.key.path;return!!r.isPrefixOf(h)&&(h.length===s&&(c=c.add(l.Yr)),!0)}),a),k.resolve(this.ti(c))}ti(e){const t=[];return e.forEach((r=>{const s=this.Xr(r);s!==null&&t.push(s)})),t}removeMutationBatch(e,t){te(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return k.forEach(t.mutations,(s=>{const i=new Se(s.key,t.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)})).next((()=>{this.Zr=r}))}ir(e){}containsKey(e,t){const r=new Se(t,0),s=this.Zr.firstAfterOrEqual(r);return k.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,k.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class jE{constructor(e){this.ri=e,this.docs=(function(){return new he(B.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,s=this.docs.get(r),i=s?s.size:0,a=this.ri(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return k.resolve(r?r.document.mutableCopy():Le.newInvalidDocument(t))}getEntries(e,t){let r=Ht();return t.forEach((s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():Le.newInvalidDocument(s))})),k.resolve(r)}getDocumentsMatchingQuery(e,t,r,s){let i=Ht();const a=t.path,c=new B(a.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(c);for(;l.hasNext();){const{key:h,value:{document:d}}=l.getNext();if(!a.isPrefixOf(h.path))break;h.path.length>a.length+1||gv(mv(d),r)<=0||(s.has(d.key)||wo(t,d))&&(i=i.insert(d.key,d.mutableCopy()))}return k.resolve(i)}getAllFromCollectionGroup(e,t,r,s){$(9500)}ii(e,t){return k.forEach(this.docs,(r=>t(r)))}newChangeBuffer(e){return new qE(this)}getSize(e){return k.resolve(this.size)}}class qE extends ME{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((r,s)=>{s.isValidDocument()?t.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(r)})),k.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class zE{constructor(e){this.persistence=e,this.si=new nr((t=>Vc(t)),Oc),this.lastRemoteSnapshotVersion=q.min(),this.highestTargetId=0,this.oi=0,this._i=new $c,this.targetCount=0,this.ai=Or.ur()}forEachTarget(e,t){return this.si.forEach(((r,s)=>t(s))),k.resolve()}getLastRemoteSnapshotVersion(e){return k.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return k.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),k.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.oi&&(this.oi=t),k.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Or(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,k.resolve()}updateTargetData(e,t){return this.Pr(t),k.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,k.resolve()}removeTargets(e,t,r){let s=0;const i=[];return this.si.forEach(((a,c)=>{c.sequenceNumber<=t&&r.get(c.targetId)===null&&(this.si.delete(a),i.push(this.removeMatchingKeysForTargetId(e,c.targetId)),s++)})),k.waitFor(i).next((()=>s))}getTargetCount(e){return k.resolve(this.targetCount)}getTargetData(e,t){const r=this.si.get(t)||null;return k.resolve(r)}addMatchingKeys(e,t,r){return this._i.Wr(t,r),k.resolve()}removeMatchingKeys(e,t,r){this._i.zr(t,r);const s=this.persistence.referenceDelegate,i=[];return s&&t.forEach((a=>{i.push(s.markPotentiallyOrphaned(e,a))})),k.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),k.resolve()}getMatchingKeysForTargetId(e,t){const r=this._i.Hr(t);return k.resolve(r)}containsKey(e,t){return k.resolve(this._i.containsKey(t))}}class sp{constructor(e,t){this.ui={},this.overlays={},this.ci=new _o(0),this.li=!1,this.li=!0,this.hi=new BE,this.referenceDelegate=e(this),this.Pi=new zE(this),this.indexManager=new PE,this.remoteDocumentCache=(function(s){return new jE(s)})((r=>this.referenceDelegate.Ti(r))),this.serializer=new SE(t),this.Ii=new FE(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new UE,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ui[e.toKey()];return r||(r=new $E(t,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,r){M("MemoryPersistence","Starting transaction:",e);const s=new HE(this.ci.next());return this.referenceDelegate.Ei(),r(s).next((i=>this.referenceDelegate.di(s).next((()=>i)))).toPromise().then((i=>(s.raiseOnCommittedEvent(),i)))}Ai(e,t){return k.or(Object.values(this.ui).map((r=>()=>r.containsKey(e,t))))}}class HE extends yv{constructor(e){super(),this.currentSequenceNumber=e}}class jc{constructor(e){this.persistence=e,this.Ri=new $c,this.Vi=null}static mi(e){return new jc(e)}get fi(){if(this.Vi)return this.Vi;throw $(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.fi.delete(r.toString()),k.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.fi.add(r.toString()),k.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),k.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((s=>this.fi.add(s.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((s=>{s.forEach((i=>this.fi.add(i.toString())))})).next((()=>r.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return k.forEach(this.fi,(r=>{const s=B.fromPath(r);return this.gi(e,s).next((i=>{i||t.removeEntry(s,q.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((r=>{r?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return k.or([()=>k.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class qi{constructor(e,t){this.persistence=e,this.pi=new nr((r=>Tv(r.path)),((r,s)=>r.isEqual(s))),this.garbageCollector=OE(this,t)}static mi(e,t){return new qi(e,t)}Ei(){}di(e){return k.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>t.next((s=>r+s))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}pr(e,t){return k.forEach(this.pi,((r,s)=>this.br(e,r,s).next((i=>i?k.resolve():t(s)))))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.ii(e,(a=>this.br(e,a,t).next((c=>{c||(r++,i.removeEntry(a,q.min()))})))).next((()=>i.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),k.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),k.resolve()}removeReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),k.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),k.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Ti(e.data.value)),t}br(e,t,r){return k.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const s=this.pi.get(t);return k.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class qc{constructor(e,t,r,s){this.targetId=e,this.fromCache=t,this.Es=r,this.ds=s}static As(e,t){let r=J(),s=J();for(const i of t.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new qc(e,t.fromCache,r,s)}}class WE{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class GE{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return x_()?8:vv(Fe())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,s){const i={result:null};return this.ys(e,t).next((a=>{i.result=a})).next((()=>{if(!i.result)return this.ws(e,t,s,r).next((a=>{i.result=a}))})).next((()=>{if(i.result)return;const a=new WE;return this.Ss(e,t,a).next((c=>{if(i.result=c,this.Vs)return this.bs(e,t,a,c.size)}))})).next((()=>i.result))}bs(e,t,r,s){return r.documentReadCount<this.fs?(ur()<=Q.DEBUG&&M("QueryEngine","SDK will not create cache indexes for query:",lr(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),k.resolve()):(ur()<=Q.DEBUG&&M("QueryEngine","Query:",lr(t),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.gs*s?(ur()<=Q.DEBUG&&M("QueryEngine","The SDK decides to create cache indexes for query:",lr(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,bt(t))):k.resolve())}ys(e,t){if(ih(t))return k.resolve(null);let r=bt(t);return this.indexManager.getIndexType(e,r).next((s=>s===0?null:(t.limit!==null&&s===1&&(t=Ha(t,null,"F"),r=bt(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next((i=>{const a=J(...i);return this.ps.getDocuments(e,a).next((c=>this.indexManager.getMinOffset(e,r).next((l=>{const h=this.Ds(t,c);return this.Cs(t,h,a,l.readTime)?this.ys(e,Ha(t,null,"F")):this.vs(e,h,t,l)}))))})))))}ws(e,t,r,s){return ih(t)||s.isEqual(q.min())?k.resolve(null):this.ps.getDocuments(e,r).next((i=>{const a=this.Ds(t,i);return this.Cs(t,a,r,s)?k.resolve(null):(ur()<=Q.DEBUG&&M("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),lr(t)),this.vs(e,a,t,pv(s,Ps)).next((c=>c)))}))}Ds(e,t){let r=new Ie(Ld(e));return t.forEach(((s,i)=>{wo(e,i)&&(r=r.add(i))})),r}Cs(e,t,r,s){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const i=e.limitType==="F"?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Ss(e,t,r){return ur()<=Q.DEBUG&&M("QueryEngine","Using full collection scan to execute query:",lr(t)),this.ps.getDocumentsMatchingQuery(e,t,En.min(),r)}vs(e,t,r,s){return this.ps.getDocumentsMatchingQuery(e,r,s).next((i=>(t.forEach((a=>{i=i.insert(a.key,a)})),i)))}}const zc="LocalStore",KE=3e8;class QE{constructor(e,t,r,s){this.persistence=e,this.Fs=t,this.serializer=s,this.Ms=new he(X),this.xs=new nr((i=>Vc(i)),Oc),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new xE(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function XE(n,e,t,r){return new QE(n,e,t,r)}async function ip(n,e){const t=z(n);return await t.persistence.runTransaction("Handle user change","readonly",(r=>{let s;return t.mutationQueue.getAllMutationBatches(r).next((i=>(s=i,t.Bs(e),t.mutationQueue.getAllMutationBatches(r)))).next((i=>{const a=[],c=[];let l=J();for(const h of s){a.push(h.batchId);for(const d of h.mutations)l=l.add(d.key)}for(const h of i){c.push(h.batchId);for(const d of h.mutations)l=l.add(d.key)}return t.localDocuments.getDocuments(r,l).next((h=>({Ls:h,removedBatchIds:a,addedBatchIds:c})))}))}))}function JE(n,e){const t=z(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const s=e.batch.keys(),i=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(c,l,h,d){const m=h.batch,g=m.keys();let I=k.resolve();return g.forEach((S=>{I=I.next((()=>d.getEntry(l,S))).next((C=>{const R=h.docVersions.get(S);te(R!==null,48541),C.version.compareTo(R)<0&&(m.applyToRemoteDocument(C,h),C.isValidDocument()&&(C.setReadTime(h.commitVersion),d.addEntry(C)))}))})),I.next((()=>c.mutationQueue.removeMutationBatch(l,m)))})(t,r,e,i).next((()=>i.apply(r))).next((()=>t.mutationQueue.performConsistencyCheck(r))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(c){let l=J();for(let h=0;h<c.mutationResults.length;++h)c.mutationResults[h].transformResults.length>0&&(l=l.add(c.batch.mutations[h].key));return l})(e)))).next((()=>t.localDocuments.getDocuments(r,s)))}))}function op(n){const e=z(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function YE(n,e){const t=z(n),r=e.snapshotVersion;let s=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(i=>{const a=t.Ns.newChangeBuffer({trackRemovals:!0});s=t.Ms;const c=[];e.targetChanges.forEach(((d,m)=>{const g=s.get(m);if(!g)return;c.push(t.Pi.removeMatchingKeys(i,d.removedDocuments,m).next((()=>t.Pi.addMatchingKeys(i,d.addedDocuments,m))));let I=g.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(m)!==null?I=I.withResumeToken(Ne.EMPTY_BYTE_STRING,q.min()).withLastLimboFreeSnapshotVersion(q.min()):d.resumeToken.approximateByteSize()>0&&(I=I.withResumeToken(d.resumeToken,r)),s=s.insert(m,I),(function(C,R,O){return C.resumeToken.approximateByteSize()===0||R.snapshotVersion.toMicroseconds()-C.snapshotVersion.toMicroseconds()>=KE?!0:O.addedDocuments.size+O.modifiedDocuments.size+O.removedDocuments.size>0})(g,I,d)&&c.push(t.Pi.updateTargetData(i,I))}));let l=Ht(),h=J();if(e.documentUpdates.forEach((d=>{e.resolvedLimboDocuments.has(d)&&c.push(t.persistence.referenceDelegate.updateLimboDocument(i,d))})),c.push(ZE(i,a,e.documentUpdates).next((d=>{l=d.ks,h=d.qs}))),!r.isEqual(q.min())){const d=t.Pi.getLastRemoteSnapshotVersion(i).next((m=>t.Pi.setTargetsMetadata(i,i.currentSequenceNumber,r)));c.push(d)}return k.waitFor(c).next((()=>a.apply(i))).next((()=>t.localDocuments.getLocalViewOfDocuments(i,l,h))).next((()=>l))})).then((i=>(t.Ms=s,i)))}function ZE(n,e,t){let r=J(),s=J();return t.forEach((i=>r=r.add(i))),e.getEntries(n,r).next((i=>{let a=Ht();return t.forEach(((c,l)=>{const h=i.get(c);l.isFoundDocument()!==h.isFoundDocument()&&(s=s.add(c)),l.isNoDocument()&&l.version.isEqual(q.min())?(e.removeEntry(c,l.readTime),a=a.insert(c,l)):!h.isValidDocument()||l.version.compareTo(h.version)>0||l.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(l),a=a.insert(c,l)):M(zc,"Ignoring outdated watch update for ",c,". Current version:",h.version," Watch version:",l.version)})),{ks:a,qs:s}}))}function eT(n,e){const t=z(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=kc),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function tT(n,e){const t=z(n);return t.persistence.runTransaction("Allocate target","readwrite",(r=>{let s;return t.Pi.getTargetData(r,e).next((i=>i?(s=i,k.resolve(s)):t.Pi.allocateTargetId(r).next((a=>(s=new un(e,a,"TargetPurposeListen",r.currentSequenceNumber),t.Pi.addTargetData(r,s).next((()=>s)))))))})).then((r=>{const s=t.Ms.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(r.targetId,r),t.xs.set(e,r.targetId)),r}))}async function Xa(n,e,t){const r=z(n),s=r.Ms.get(e),i=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",i,(a=>r.persistence.referenceDelegate.removeTarget(a,s)))}catch(a){if(!Hr(a))throw a;M(zc,`Failed to update sequence numbers for target ${e}: ${a}`)}r.Ms=r.Ms.remove(e),r.xs.delete(s.target)}function yh(n,e,t){const r=z(n);let s=q.min(),i=J();return r.persistence.runTransaction("Execute query","readwrite",(a=>(function(l,h,d){const m=z(l),g=m.xs.get(d);return g!==void 0?k.resolve(m.Ms.get(g)):m.Pi.getTargetData(h,d)})(r,a,bt(e)).next((c=>{if(c)return s=c.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(a,c.targetId).next((l=>{i=l}))})).next((()=>r.Fs.getDocumentsMatchingQuery(a,e,t?s:q.min(),t?i:J()))).next((c=>(nT(r,$v(e),c),{documents:c,Qs:i})))))}function nT(n,e,t){let r=n.Os.get(e)||q.min();t.forEach(((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)})),n.Os.set(e,r)}class vh{constructor(){this.activeTargetIds=Gv()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class rT{constructor(){this.Mo=new vh,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,r){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new vh,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class sT{Oo(e){}shutdown(){}}const Eh="ConnectivityMonitor";class Th{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){M(Eh,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){M(Eh,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let gi=null;function Ja(){return gi===null?gi=(function(){return 268435456+Math.round(2147483648*Math.random())})():gi++,"0x"+gi.toString(16)}const va="RestConnection",iT={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class oT{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${r}/databases/${s}`,this.Wo=this.databaseId.database===Li?`project_id=${r}`:`project_id=${r}&database_id=${s}`}Go(e,t,r,s,i){const a=Ja(),c=this.zo(e,t.toUriEncodedString());M(va,`Sending RPC '${e}' ${a}:`,c,r);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,s,i);const{host:h}=new URL(c),d=Sn(h);return this.Jo(e,c,l,r,d).then((m=>(M(va,`Received RPC '${e}' ${a}: `,m),m)),(m=>{throw kr(va,`RPC '${e}' ${a} failed with error: `,m,"url: ",c,"request:",r),m}))}Ho(e,t,r,s,i,a){return this.Go(e,t,r,s,i)}jo(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+qr})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((s,i)=>e[i]=s)),r&&r.headers.forEach(((s,i)=>e[i]=s))}zo(e,t){const r=iT[e];return`${this.Uo}/v1/${t}:${r}`}terminate(){}}class aT{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const Ve="WebChannelConnection";class cT extends oT{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,s,i){const a=Ja();return new Promise(((c,l)=>{const h=new ld;h.setWithCredentials(!0),h.listenOnce(hd.COMPLETE,(()=>{try{switch(h.getLastErrorCode()){case Ei.NO_ERROR:const m=h.getResponseJson();M(Ve,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(m)),c(m);break;case Ei.TIMEOUT:M(Ve,`RPC '${e}' ${a} timed out`),l(new F(N.DEADLINE_EXCEEDED,"Request time out"));break;case Ei.HTTP_ERROR:const g=h.getStatus();if(M(Ve,`RPC '${e}' ${a} failed with status:`,g,"response text:",h.getResponseText()),g>0){let I=h.getResponseJson();Array.isArray(I)&&(I=I[0]);const S=I?.error;if(S&&S.status&&S.message){const C=(function(O){const x=O.toLowerCase().replace(/_/g,"-");return Object.values(N).indexOf(x)>=0?x:N.UNKNOWN})(S.status);l(new F(C,S.message))}else l(new F(N.UNKNOWN,"Server responded with status "+h.getStatus()))}else l(new F(N.UNAVAILABLE,"Connection failed."));break;default:$(9055,{l_:e,streamId:a,h_:h.getLastErrorCode(),P_:h.getLastError()})}}finally{M(Ve,`RPC '${e}' ${a} completed.`)}}));const d=JSON.stringify(s);M(Ve,`RPC '${e}' ${a} sending request:`,s),h.send(t,"POST",d,r,15)}))}T_(e,t,r){const s=Ja(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=pd(),c=dd(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(l.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,t,r),l.encodeInitMessageHeaders=!0;const d=i.join("");M(Ve,`Creating RPC '${e}' stream ${s}: ${d}`,l);const m=a.createWebChannel(d,l);this.I_(m);let g=!1,I=!1;const S=new aT({Yo:R=>{I?M(Ve,`Not sending because RPC '${e}' stream ${s} is closed:`,R):(g||(M(Ve,`Opening RPC '${e}' stream ${s} transport.`),m.open(),g=!0),M(Ve,`RPC '${e}' stream ${s} sending:`,R),m.send(R))},Zo:()=>m.close()}),C=(R,O,x)=>{R.listen(O,(V=>{try{x(V)}catch(H){setTimeout((()=>{throw H}),0)}}))};return C(m,fs.EventType.OPEN,(()=>{I||(M(Ve,`RPC '${e}' stream ${s} transport opened.`),S.o_())})),C(m,fs.EventType.CLOSE,(()=>{I||(I=!0,M(Ve,`RPC '${e}' stream ${s} transport closed`),S.a_(),this.E_(m))})),C(m,fs.EventType.ERROR,(R=>{I||(I=!0,kr(Ve,`RPC '${e}' stream ${s} transport errored. Name:`,R.name,"Message:",R.message),S.a_(new F(N.UNAVAILABLE,"The operation could not be completed")))})),C(m,fs.EventType.MESSAGE,(R=>{if(!I){const O=R.data[0];te(!!O,16349);const x=O,V=x?.error||x[0]?.error;if(V){M(Ve,`RPC '${e}' stream ${s} received error:`,V);const H=V.status;let W=(function(_){const v=ge[_];if(v!==void 0)return Gd(v)})(H),U=V.message;W===void 0&&(W=N.INTERNAL,U="Unknown error status: "+H+" with message "+V.message),I=!0,S.a_(new F(W,U)),m.close()}else M(Ve,`RPC '${e}' stream ${s} received:`,O),S.u_(O)}})),C(c,fd.STAT_EVENT,(R=>{R.stat===Ua.PROXY?M(Ve,`RPC '${e}' stream ${s} detected buffering proxy`):R.stat===Ua.NOPROXY&&M(Ve,`RPC '${e}' stream ${s} detected no buffering proxy`)})),setTimeout((()=>{S.__()}),0),S}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function Ea(){return typeof document<"u"?document:null}function So(n){return new fE(n,!0)}class ap{constructor(e,t,r=1e3,s=1.5,i=6e4){this.Mi=e,this.timerId=t,this.d_=r,this.A_=s,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),s=Math.max(0,t-r);s>0&&M("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const wh="PersistentStream";class cp{constructor(e,t,r,s,i,a,c,l){this.Mi=e,this.S_=r,this.b_=s,this.connection=i,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=c,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new ap(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===N.RESOURCE_EXHAUSTED?(zt(t.toString()),zt("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===N.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,s])=>{this.D_===t&&this.G_(r,s)}),(r=>{e((()=>{const s=new F(N.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(s)}))}))}G_(e,t){const r=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{r((()=>this.listener.Xo()))})),this.stream.t_((()=>{r((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((s=>{r((()=>this.z_(s)))})),this.stream.onMessage((s=>{r((()=>++this.F_==1?this.J_(s):this.onNext(s)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return M(wh,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(M(wh,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class uT extends cp{constructor(e,t,r,s,i,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,s,a),this.serializer=i}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=mE(this.serializer,e),r=(function(i){if(!("targetChange"in i))return q.min();const a=i.targetChange;return a.targetIds&&a.targetIds.length?q.min():a.readTime?St(a.readTime):q.min()})(e);return this.listener.H_(t,r)}Y_(e){const t={};t.database=Qa(this.serializer),t.addTarget=(function(i,a){let c;const l=a.target;if(c=za(l)?{documents:yE(i,l)}:{query:vE(i,l).ft},c.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){c.resumeToken=Xd(i,a.resumeToken);const h=Wa(i,a.expectedCount);h!==null&&(c.expectedCount=h)}else if(a.snapshotVersion.compareTo(q.min())>0){c.readTime=ji(i,a.snapshotVersion.toTimestamp());const h=Wa(i,a.expectedCount);h!==null&&(c.expectedCount=h)}return c})(this.serializer,e);const r=TE(this.serializer,e);r&&(t.labels=r),this.q_(t)}Z_(e){const t={};t.database=Qa(this.serializer),t.removeTarget=e,this.q_(t)}}class lT extends cp{constructor(e,t,r,s,i,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,s,a),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return te(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,te(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){te(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=_E(e.writeResults,e.commitTime),r=St(e.commitTime);return this.listener.na(r,t)}ra(){const e={};e.database=Qa(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((r=>gE(this.serializer,r)))};this.q_(t)}}class hT{}class fT extends hT{constructor(e,t,r,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new F(N.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,a])=>this.connection.Go(e,Ga(t,r),s,i,a))).catch((i=>{throw i.name==="FirebaseError"?(i.code===N.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new F(N.UNKNOWN,i.toString())}))}Ho(e,t,r,s,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,c])=>this.connection.Ho(e,Ga(t,r),s,a,c,i))).catch((a=>{throw a.name==="FirebaseError"?(a.code===N.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new F(N.UNKNOWN,a.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class dT{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(zt(t),this.aa=!1):M("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Jn="RemoteStore";class pT{constructor(e,t,r,s,i){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo((a=>{r.enqueueAndForget((async()=>{rr(this)&&(M(Jn,"Restarting streams for network reachability change."),await(async function(l){const h=z(l);h.Ea.add(4),await Ws(h),h.Ra.set("Unknown"),h.Ea.delete(4),await Ro(h)})(this))}))})),this.Ra=new dT(r,s)}}async function Ro(n){if(rr(n))for(const e of n.da)await e(!0)}async function Ws(n){for(const e of n.da)await e(!1)}function up(n,e){const t=z(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),Kc(t)?Gc(t):Wr(t).O_()&&Wc(t,e))}function Hc(n,e){const t=z(n),r=Wr(t);t.Ia.delete(e),r.O_()&&lp(t,e),t.Ia.size===0&&(r.O_()?r.L_():rr(t)&&t.Ra.set("Unknown"))}function Wc(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(q.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Wr(n).Y_(e)}function lp(n,e){n.Va.Ue(e),Wr(n).Z_(e)}function Gc(n){n.Va=new cE({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),Wr(n).start(),n.Ra.ua()}function Kc(n){return rr(n)&&!Wr(n).x_()&&n.Ia.size>0}function rr(n){return z(n).Ea.size===0}function hp(n){n.Va=void 0}async function mT(n){n.Ra.set("Online")}async function gT(n){n.Ia.forEach(((e,t)=>{Wc(n,e)}))}async function _T(n,e){hp(n),Kc(n)?(n.Ra.ha(e),Gc(n)):n.Ra.set("Unknown")}async function yT(n,e,t){if(n.Ra.set("Online"),e instanceof Qd&&e.state===2&&e.cause)try{await(async function(s,i){const a=i.cause;for(const c of i.targetIds)s.Ia.has(c)&&(await s.remoteSyncer.rejectListen(c,a),s.Ia.delete(c),s.Va.removeTarget(c))})(n,e)}catch(r){M(Jn,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await zi(n,r)}else if(e instanceof Ai?n.Va.Ze(e):e instanceof Kd?n.Va.st(e):n.Va.tt(e),!t.isEqual(q.min()))try{const r=await op(n.localStore);t.compareTo(r)>=0&&await(function(i,a){const c=i.Va.Tt(a);return c.targetChanges.forEach(((l,h)=>{if(l.resumeToken.approximateByteSize()>0){const d=i.Ia.get(h);d&&i.Ia.set(h,d.withResumeToken(l.resumeToken,a))}})),c.targetMismatches.forEach(((l,h)=>{const d=i.Ia.get(l);if(!d)return;i.Ia.set(l,d.withResumeToken(Ne.EMPTY_BYTE_STRING,d.snapshotVersion)),lp(i,l);const m=new un(d.target,l,h,d.sequenceNumber);Wc(i,m)})),i.remoteSyncer.applyRemoteEvent(c)})(n,t)}catch(r){M(Jn,"Failed to raise snapshot:",r),await zi(n,r)}}async function zi(n,e,t){if(!Hr(e))throw e;n.Ea.add(1),await Ws(n),n.Ra.set("Offline"),t||(t=()=>op(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{M(Jn,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await Ro(n)}))}function fp(n,e){return e().catch((t=>zi(n,t,e)))}async function Po(n){const e=z(n),t=An(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:kc;for(;vT(e);)try{const s=await eT(e.localStore,r);if(s===null){e.Ta.length===0&&t.L_();break}r=s.batchId,ET(e,s)}catch(s){await zi(e,s)}dp(e)&&pp(e)}function vT(n){return rr(n)&&n.Ta.length<10}function ET(n,e){n.Ta.push(e);const t=An(n);t.O_()&&t.X_&&t.ea(e.mutations)}function dp(n){return rr(n)&&!An(n).x_()&&n.Ta.length>0}function pp(n){An(n).start()}async function TT(n){An(n).ra()}async function wT(n){const e=An(n);for(const t of n.Ta)e.ea(t.mutations)}async function IT(n,e,t){const r=n.Ta.shift(),s=Fc.from(r,e,t);await fp(n,(()=>n.remoteSyncer.applySuccessfulWrite(s))),await Po(n)}async function AT(n,e){e&&An(n).X_&&await(async function(r,s){if((function(a){return iE(a)&&a!==N.ABORTED})(s.code)){const i=r.Ta.shift();An(r).B_(),await fp(r,(()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s))),await Po(r)}})(n,e),dp(n)&&pp(n)}async function Ih(n,e){const t=z(n);t.asyncQueue.verifyOperationInProgress(),M(Jn,"RemoteStore received new credentials");const r=rr(t);t.Ea.add(3),await Ws(t),r&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await Ro(t)}async function bT(n,e){const t=z(n);e?(t.Ea.delete(2),await Ro(t)):e||(t.Ea.add(2),await Ws(t),t.Ra.set("Unknown"))}function Wr(n){return n.ma||(n.ma=(function(t,r,s){const i=z(t);return i.sa(),new uT(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)})(n.datastore,n.asyncQueue,{Xo:mT.bind(null,n),t_:gT.bind(null,n),r_:_T.bind(null,n),H_:yT.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),Kc(n)?Gc(n):n.Ra.set("Unknown")):(await n.ma.stop(),hp(n))}))),n.ma}function An(n){return n.fa||(n.fa=(function(t,r,s){const i=z(t);return i.sa(),new lT(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:TT.bind(null,n),r_:AT.bind(null,n),ta:wT.bind(null,n),na:IT.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await Po(n)):(await n.fa.stop(),n.Ta.length>0&&(M(Jn,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class Qc{constructor(e,t,r,s,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new $n,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((a=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,s,i){const a=Date.now()+r,c=new Qc(e,t,a,s,i);return c.start(r),c}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new F(N.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Xc(n,e){if(zt("AsyncQueue",`${e}: ${n}`),Hr(n))return new F(N.UNAVAILABLE,`${e}: ${n}`);throw n}class Er{static emptySet(e){return new Er(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||B.comparator(t.key,r.key):(t,r)=>B.comparator(t.key,r.key),this.keyedMap=ds(),this.sortedSet=new he(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,r)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Er)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new Er;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class Ah{constructor(){this.ga=new he(B.comparator)}track(e){const t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):$(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,r)=>{e.push(r)})),e}}class Mr{constructor(e,t,r,s,i,a,c,l,h){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=a,this.syncStateChanged=c,this.excludesMetadataChanges=l,this.hasCachedResults=h}static fromInitialDocuments(e,t,r,s,i){const a=[];return t.forEach((c=>{a.push({type:0,doc:c})})),new Mr(e,t,Er.emptySet(t),a,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&To(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==r[s].type||!t[s].doc.isEqual(r[s].doc))return!1;return!0}}class ST{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class RT{constructor(){this.queries=bh(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){const s=z(t),i=s.queries;s.queries=bh(),i.forEach(((a,c)=>{for(const l of c.Sa)l.onError(r)}))})(this,new F(N.ABORTED,"Firestore shutting down"))}}function bh(){return new nr((n=>Md(n)),To)}async function PT(n,e){const t=z(n);let r=3;const s=e.query;let i=t.queries.get(s);i?!i.ba()&&e.Da()&&(r=2):(i=new ST,r=e.Da()?0:1);try{switch(r){case 0:i.wa=await t.onListen(s,!0);break;case 1:i.wa=await t.onListen(s,!1);break;case 2:await t.onFirstRemoteStoreListen(s)}}catch(a){const c=Xc(a,`Initialization of query '${lr(e.query)}' failed`);return void e.onError(c)}t.queries.set(s,i),i.Sa.push(e),e.va(t.onlineState),i.wa&&e.Fa(i.wa)&&Jc(t)}async function CT(n,e){const t=z(n),r=e.query;let s=3;const i=t.queries.get(r);if(i){const a=i.Sa.indexOf(e);a>=0&&(i.Sa.splice(a,1),i.Sa.length===0?s=e.Da()?0:1:!i.ba()&&e.Da()&&(s=2))}switch(s){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function kT(n,e){const t=z(n);let r=!1;for(const s of e){const i=s.query,a=t.queries.get(i);if(a){for(const c of a.Sa)c.Fa(s)&&(r=!0);a.wa=s}}r&&Jc(t)}function NT(n,e,t){const r=z(n),s=r.queries.get(e);if(s)for(const i of s.Sa)i.onError(t);r.queries.delete(e)}function Jc(n){n.Ca.forEach((e=>{e.next()}))}var Ya,Sh;(Sh=Ya||(Ya={})).Ma="default",Sh.Cache="cache";class DT{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Mr(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const r=t!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Mr.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Ya.Cache}}class mp{constructor(e){this.key=e}}class gp{constructor(e){this.key=e}}class VT{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=J(),this.mutatedKeys=J(),this.eu=Ld(e),this.tu=new Er(this.eu)}get nu(){return this.Ya}ru(e,t){const r=t?t.iu:new Ah,s=t?t.tu:this.tu;let i=t?t.mutatedKeys:this.mutatedKeys,a=s,c=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,h=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal(((d,m)=>{const g=s.get(d),I=wo(this.query,m)?m:null,S=!!g&&this.mutatedKeys.has(g.key),C=!!I&&(I.hasLocalMutations||this.mutatedKeys.has(I.key)&&I.hasCommittedMutations);let R=!1;g&&I?g.data.isEqual(I.data)?S!==C&&(r.track({type:3,doc:I}),R=!0):this.su(g,I)||(r.track({type:2,doc:I}),R=!0,(l&&this.eu(I,l)>0||h&&this.eu(I,h)<0)&&(c=!0)):!g&&I?(r.track({type:0,doc:I}),R=!0):g&&!I&&(r.track({type:1,doc:g}),R=!0,(l||h)&&(c=!0)),R&&(I?(a=a.add(I),i=C?i.add(d):i.delete(d)):(a=a.delete(d),i=i.delete(d)))})),this.query.limit!==null)for(;a.size>this.query.limit;){const d=this.query.limitType==="F"?a.last():a.first();a=a.delete(d.key),i=i.delete(d.key),r.track({type:1,doc:d})}return{tu:a,iu:r,Cs:c,mutatedKeys:i}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,s){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const a=e.iu.ya();a.sort(((d,m)=>(function(I,S){const C=R=>{switch(R){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return $(20277,{Rt:R})}};return C(I)-C(S)})(d.type,m.type)||this.eu(d.doc,m.doc))),this.ou(r),s=s??!1;const c=t&&!s?this._u():[],l=this.Xa.size===0&&this.current&&!s?1:0,h=l!==this.Za;return this.Za=l,a.length!==0||h?{snapshot:new Mr(this.query,e.tu,i,a,e.mutatedKeys,l===0,h,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:c}:{au:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Ah,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=J(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))}));const t=[];return e.forEach((r=>{this.Xa.has(r)||t.push(new gp(r))})),this.Xa.forEach((r=>{e.has(r)||t.push(new mp(r))})),t}cu(e){this.Ya=e.Qs,this.Xa=J();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Mr.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Yc="SyncEngine";class OT{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class MT{constructor(e){this.key=e,this.hu=!1}}class LT{constructor(e,t,r,s,i,a){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new nr((c=>Md(c)),To),this.Iu=new Map,this.Eu=new Set,this.du=new he(B.comparator),this.Au=new Map,this.Ru=new $c,this.Vu={},this.mu=new Map,this.fu=Or.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function xT(n,e,t=!0){const r=wp(n);let s;const i=r.Tu.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.lu()):s=await _p(r,e,t,!0),s}async function FT(n,e){const t=wp(n);await _p(t,e,!0,!1)}async function _p(n,e,t,r){const s=await tT(n.localStore,bt(e)),i=s.targetId,a=n.sharedClientState.addLocalQueryTarget(i,t);let c;return r&&(c=await UT(n,e,i,a==="current",s.resumeToken)),n.isPrimaryClient&&t&&up(n.remoteStore,s),c}async function UT(n,e,t,r,s){n.pu=(m,g,I)=>(async function(C,R,O,x){let V=R.view.ru(O);V.Cs&&(V=await yh(C.localStore,R.query,!1).then((({documents:E})=>R.view.ru(E,V))));const H=x&&x.targetChanges.get(R.targetId),W=x&&x.targetMismatches.get(R.targetId)!=null,U=R.view.applyChanges(V,C.isPrimaryClient,H,W);return Ph(C,R.targetId,U.au),U.snapshot})(n,m,g,I);const i=await yh(n.localStore,e,!0),a=new VT(e,i.Qs),c=a.ru(i.documents),l=Hs.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",s),h=a.applyChanges(c,n.isPrimaryClient,l);Ph(n,t,h.au);const d=new OT(e,t,a);return n.Tu.set(e,d),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),h.snapshot}async function BT(n,e,t){const r=z(n),s=r.Tu.get(e),i=r.Iu.get(s.targetId);if(i.length>1)return r.Iu.set(s.targetId,i.filter((a=>!To(a,e)))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await Xa(r.localStore,s.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(s.targetId),t&&Hc(r.remoteStore,s.targetId),Za(r,s.targetId)})).catch(zr)):(Za(r,s.targetId),await Xa(r.localStore,s.targetId,!0))}async function $T(n,e){const t=z(n),r=t.Tu.get(e),s=t.Iu.get(r.targetId);t.isPrimaryClient&&s.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Hc(t.remoteStore,r.targetId))}async function jT(n,e,t){const r=QT(n);try{const s=await(function(a,c){const l=z(a),h=ce.now(),d=c.reduce(((I,S)=>I.add(S.key)),J());let m,g;return l.persistence.runTransaction("Locally write mutations","readwrite",(I=>{let S=Ht(),C=J();return l.Ns.getEntries(I,d).next((R=>{S=R,S.forEach(((O,x)=>{x.isValidDocument()||(C=C.add(O))}))})).next((()=>l.localDocuments.getOverlayedDocuments(I,S))).next((R=>{m=R;const O=[];for(const x of c){const V=eE(x,m.get(x.key).overlayedDocument);V!=null&&O.push(new Pn(x.key,V,Pd(V.value.mapValue),lt.exists(!0)))}return l.mutationQueue.addMutationBatch(I,h,O,c)})).next((R=>{g=R;const O=R.applyToLocalDocumentSet(m,C);return l.documentOverlayCache.saveOverlays(I,R.batchId,O)}))})).then((()=>({batchId:g.batchId,changes:Fd(m)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),(function(a,c,l){let h=a.Vu[a.currentUser.toKey()];h||(h=new he(X)),h=h.insert(c,l),a.Vu[a.currentUser.toKey()]=h})(r,s.batchId,t),await Gs(r,s.changes),await Po(r.remoteStore)}catch(s){const i=Xc(s,"Failed to persist write");t.reject(i)}}async function yp(n,e){const t=z(n);try{const r=await YE(t.localStore,e);e.targetChanges.forEach(((s,i)=>{const a=t.Au.get(i);a&&(te(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?a.hu=!0:s.modifiedDocuments.size>0?te(a.hu,14607):s.removedDocuments.size>0&&(te(a.hu,42227),a.hu=!1))})),await Gs(t,r,e)}catch(r){await zr(r)}}function Rh(n,e,t){const r=z(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const s=[];r.Tu.forEach(((i,a)=>{const c=a.view.va(e);c.snapshot&&s.push(c.snapshot)})),(function(a,c){const l=z(a);l.onlineState=c;let h=!1;l.queries.forEach(((d,m)=>{for(const g of m.Sa)g.va(c)&&(h=!0)})),h&&Jc(l)})(r.eventManager,e),s.length&&r.Pu.H_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function qT(n,e,t){const r=z(n);r.sharedClientState.updateQueryState(e,"rejected",t);const s=r.Au.get(e),i=s&&s.key;if(i){let a=new he(B.comparator);a=a.insert(i,Le.newNoDocument(i,q.min()));const c=J().add(i),l=new bo(q.min(),new Map,new he(X),a,c);await yp(r,l),r.du=r.du.remove(i),r.Au.delete(e),Zc(r)}else await Xa(r.localStore,e,!1).then((()=>Za(r,e,t))).catch(zr)}async function zT(n,e){const t=z(n),r=e.batch.batchId;try{const s=await JE(t.localStore,e);Ep(t,r,null),vp(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await Gs(t,s)}catch(s){await zr(s)}}async function HT(n,e,t){const r=z(n);try{const s=await(function(a,c){const l=z(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",(h=>{let d;return l.mutationQueue.lookupMutationBatch(h,c).next((m=>(te(m!==null,37113),d=m.keys(),l.mutationQueue.removeMutationBatch(h,m)))).next((()=>l.mutationQueue.performConsistencyCheck(h))).next((()=>l.documentOverlayCache.removeOverlaysForBatchId(h,d,c))).next((()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,d))).next((()=>l.localDocuments.getDocuments(h,d)))}))})(r.localStore,e);Ep(r,e,t),vp(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await Gs(r,s)}catch(s){await zr(s)}}function vp(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function Ep(n,e,t){const r=z(n);let s=r.Vu[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(t?i.reject(t):i.resolve(),s=s.remove(e)),r.Vu[r.currentUser.toKey()]=s}}function Za(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Iu.get(e))n.Tu.delete(r),t&&n.Pu.yu(r,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((r=>{n.Ru.containsKey(r)||Tp(n,r)}))}function Tp(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(Hc(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),Zc(n))}function Ph(n,e,t){for(const r of t)r instanceof mp?(n.Ru.addReference(r.key,e),WT(n,r)):r instanceof gp?(M(Yc,"Document no longer in limbo: "+r.key),n.Ru.removeReference(r.key,e),n.Ru.containsKey(r.key)||Tp(n,r.key)):$(19791,{wu:r})}function WT(n,e){const t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Eu.has(r)||(M(Yc,"New document in limbo: "+t),n.Eu.add(r),Zc(n))}function Zc(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new B(ae.fromString(e)),r=n.fu.next();n.Au.set(r,new MT(t)),n.du=n.du.insert(t,r),up(n.remoteStore,new un(bt(Mc(t.path)),r,"TargetPurposeLimboResolution",_o.ce))}}async function Gs(n,e,t){const r=z(n),s=[],i=[],a=[];r.Tu.isEmpty()||(r.Tu.forEach(((c,l)=>{a.push(r.pu(l,e,t).then((h=>{if((h||t)&&r.isPrimaryClient){const d=h?!h.fromCache:t?.targetChanges.get(l.targetId)?.current;r.sharedClientState.updateQueryState(l.targetId,d?"current":"not-current")}if(h){s.push(h);const d=qc.As(l.targetId,h);i.push(d)}})))})),await Promise.all(a),r.Pu.H_(s),await(async function(l,h){const d=z(l);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",(m=>k.forEach(h,(g=>k.forEach(g.Es,(I=>d.persistence.referenceDelegate.addReference(m,g.targetId,I))).next((()=>k.forEach(g.ds,(I=>d.persistence.referenceDelegate.removeReference(m,g.targetId,I)))))))))}catch(m){if(!Hr(m))throw m;M(zc,"Failed to update sequence numbers: "+m)}for(const m of h){const g=m.targetId;if(!m.fromCache){const I=d.Ms.get(g),S=I.snapshotVersion,C=I.withLastLimboFreeSnapshotVersion(S);d.Ms=d.Ms.insert(g,C)}}})(r.localStore,i))}async function GT(n,e){const t=z(n);if(!t.currentUser.isEqual(e)){M(Yc,"User change. New user:",e.toKey());const r=await ip(t.localStore,e);t.currentUser=e,(function(i,a){i.mu.forEach((c=>{c.forEach((l=>{l.reject(new F(N.CANCELLED,a))}))})),i.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Gs(t,r.Ls)}}function KT(n,e){const t=z(n),r=t.Au.get(e);if(r&&r.hu)return J().add(r.key);{let s=J();const i=t.Iu.get(e);if(!i)return s;for(const a of i){const c=t.Tu.get(a);s=s.unionWith(c.view.nu)}return s}}function wp(n){const e=z(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=yp.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=KT.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=qT.bind(null,e),e.Pu.H_=kT.bind(null,e.eventManager),e.Pu.yu=NT.bind(null,e.eventManager),e}function QT(n){const e=z(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=zT.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=HT.bind(null,e),e}class Hi{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=So(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return XE(this.persistence,new GE,e.initialUser,this.serializer)}Cu(e){return new sp(jc.mi,this.serializer)}Du(e){return new rT}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Hi.provider={build:()=>new Hi};class XT extends Hi{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){te(this.persistence.referenceDelegate instanceof qi,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new DE(r,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?ze.withCacheSize(this.cacheSizeBytes):ze.DEFAULT;return new sp((r=>qi.mi(r,t)),this.serializer)}}class ec{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Rh(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=GT.bind(null,this.syncEngine),await bT(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new RT})()}createDatastore(e){const t=So(e.databaseInfo.databaseId),r=(function(i){return new cT(i)})(e.databaseInfo);return(function(i,a,c,l){return new fT(i,a,c,l)})(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return(function(r,s,i,a,c){return new pT(r,s,i,a,c)})(this.localStore,this.datastore,e.asyncQueue,(t=>Rh(this.syncEngine,t,0)),(function(){return Th.v()?new Th:new sT})())}createSyncEngine(e,t){return(function(s,i,a,c,l,h,d){const m=new LT(s,i,a,c,l,h);return d&&(m.gu=!0),m})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const r=z(t);M(Jn,"RemoteStore shutting down."),r.Ea.add(5),await Ws(r),r.Aa.shutdown(),r.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}ec.provider={build:()=>new ec};class JT{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):zt("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const bn="FirestoreClient";class YT{constructor(e,t,r,s,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=s,this.user=Me.UNAUTHENTICATED,this.clientId=Pc.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,(async a=>{M(bn,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a})),this.appCheckCredentials.start(r,(a=>(M(bn,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new $n;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=Xc(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function Ta(n,e){n.asyncQueue.verifyOperationInProgress(),M(bn,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener((async s=>{r.isEqual(s)||(await ip(e.localStore,s),r=s)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function Ch(n,e){n.asyncQueue.verifyOperationInProgress();const t=await ZT(n);M(bn,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((r=>Ih(e.remoteStore,r))),n.setAppCheckTokenChangeListener(((r,s)=>Ih(e.remoteStore,s))),n._onlineComponents=e}async function ZT(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){M(bn,"Using user provided OfflineComponentProvider");try{await Ta(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(s){return s.name==="FirebaseError"?s.code===N.FAILED_PRECONDITION||s.code===N.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11})(t))throw t;kr("Error using user provided cache. Falling back to memory cache: "+t),await Ta(n,new Hi)}}else M(bn,"Using default OfflineComponentProvider"),await Ta(n,new XT(void 0));return n._offlineComponents}async function Ip(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(M(bn,"Using user provided OnlineComponentProvider"),await Ch(n,n._uninitializedComponentsProvider._online)):(M(bn,"Using default OnlineComponentProvider"),await Ch(n,new ec))),n._onlineComponents}function ew(n){return Ip(n).then((e=>e.syncEngine))}async function kh(n){const e=await Ip(n),t=e.eventManager;return t.onListen=xT.bind(null,e.syncEngine),t.onUnlisten=BT.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=FT.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=$T.bind(null,e.syncEngine),t}function Ap(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const Nh=new Map;const bp="firestore.googleapis.com",Dh=!0;class Vh{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new F(N.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=bp,this.ssl=Dh}else this.host=e.host,this.ssl=e.ssl??Dh;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=rp;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<kE)throw new F(N.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}dv("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Ap(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new F(N.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new F(N.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new F(N.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,s){return r.timeoutSeconds===s.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Co{constructor(e,t,r,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Vh({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new F(N.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new F(N.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Vh(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new rv;switch(r.type){case"firstParty":return new av(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new F(N.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const r=Nh.get(t);r&&(M("ComponentProvider","Removing Datastore"),Nh.delete(t),r.terminate())})(this),Promise.resolve()}}function tw(n,e,t,r={}){n=gn(n,Co);const s=Sn(e),i=n._getSettings(),a={...i,emulatorOptions:n._getEmulatorOptions()},c=`${e}:${t}`;s&&(wc(`https://${c}`),Ic("Firestore",!0)),i.host!==bp&&i.host!==c&&kr("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...i,host:c,ssl:s,emulatorOptions:r};if(!Kn(l,a)&&(n._setSettings(l),r.mockUserToken)){let h,d;if(typeof r.mockUserToken=="string")h=r.mockUserToken,d=Me.MOCK_USER;else{h=P_(r.mockUserToken,n._app?.options.projectId);const m=r.mockUserToken.sub||r.mockUserToken.user_id;if(!m)throw new F(N.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new Me(m)}n._authCredentials=new sv(new gd(h,d))}}class ko{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new ko(this.firestore,e,this._query)}}class Te{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new _n(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Te(this.firestore,e,this._key)}toJSON(){return{type:Te._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(qs(t,Te._jsonSchema))return new Te(e,r||null,new B(ae.fromString(t.referencePath)))}}Te._jsonSchemaVersion="firestore/documentReference/1.0",Te._jsonSchema={type:_e("string",Te._jsonSchemaVersion),referencePath:_e("string")};class _n extends ko{constructor(e,t,r){super(e,t,Mc(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Te(this.firestore,null,new B(e))}withConverter(e){return new _n(this.firestore,e,this._path)}}function Sp(n,e,...t){if(n=ye(n),_d("collection","path",e),n instanceof Co){const r=ae.fromString(e,...t);return Wl(r),new _n(n,null,r)}{if(!(n instanceof Te||n instanceof _n))throw new F(N.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(ae.fromString(e,...t));return Wl(r),new _n(n.firestore,null,r)}}function eu(n,e,...t){if(n=ye(n),arguments.length===1&&(e=Pc.newId()),_d("doc","path",e),n instanceof Co){const r=ae.fromString(e,...t);return Hl(r),new Te(n,null,new B(r))}{if(!(n instanceof Te||n instanceof _n))throw new F(N.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(ae.fromString(e,...t));return Hl(r),new Te(n.firestore,n instanceof _n?n.converter:null,new B(r))}}const Oh="AsyncQueue";class Mh{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new ap(this,"async_queue_retry"),this._c=()=>{const r=Ea();r&&M(Oh,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const t=Ea();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Ea();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new $n;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Hr(e))throw e;M(Oh,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((r=>{throw this.nc=r,this.rc=!1,zt("INTERNAL UNHANDLED ERROR: ",Lh(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const s=Qc.createAndSchedule(this,e,t,r,(i=>this.hc(i)));return this.tc.push(s),s}uc(){this.nc&&$(47125,{Pc:Lh(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,r)=>t.targetTimeMs-r.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function Lh(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}function xh(n){return(function(t,r){if(typeof t!="object"||t===null)return!1;const s=t;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1})(n,["next","error","complete"])}class Lr extends Co{constructor(e,t,r,s){super(e,t,r,s),this.type="firestore",this._queue=new Mh,this._persistenceKey=s?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Mh(e),this._firestoreClient=void 0,await e}}}function nw(n,e){const t=typeof n=="object"?n:Sc(),r=typeof n=="string"?n:Li,s=go(t,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=td("firestore");i&&tw(s,...i)}return s}function Rp(n){if(n._terminated)throw new F(N.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||rw(n),n._firestoreClient}function rw(n){const e=n._freezeSettings(),t=(function(s,i,a,c){return new Av(s,i,a,c.host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,Ap(c.experimentalLongPollingOptions),c.useFetchStreams,c.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new YT(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(s){const i=s?._online.build();return{_offline:s?._offline.build(i),_online:i}})(n._componentsProvider))}class rt{constructor(e){this._byteString=e}static fromBase64String(e){try{return new rt(Ne.fromBase64String(e))}catch(t){throw new F(N.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new rt(Ne.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:rt._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(qs(e,rt._jsonSchema))return rt.fromBase64String(e.bytes)}}rt._jsonSchemaVersion="firestore/bytes/1.0",rt._jsonSchema={type:_e("string",rt._jsonSchemaVersion),bytes:_e("string")};class No{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new F(N.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Pe(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class tu{constructor(e){this._methodName=e}}class Rt{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new F(N.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new F(N.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return X(this._lat,e._lat)||X(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Rt._jsonSchemaVersion}}static fromJSON(e){if(qs(e,Rt._jsonSchema))return new Rt(e.latitude,e.longitude)}}Rt._jsonSchemaVersion="firestore/geoPoint/1.0",Rt._jsonSchema={type:_e("string",Rt._jsonSchemaVersion),latitude:_e("number"),longitude:_e("number")};class Pt{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Pt._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(qs(e,Pt._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new Pt(e.vectorValues);throw new F(N.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Pt._jsonSchemaVersion="firestore/vectorValue/1.0",Pt._jsonSchema={type:_e("string",Pt._jsonSchemaVersion),vectorValues:_e("object")};const sw=/^__.*__$/;class iw{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Pn(e,this.data,this.fieldMask,t,this.fieldTransforms):new zs(e,this.data,t,this.fieldTransforms)}}class Pp{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Pn(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Cp(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw $(40011,{Ac:n})}}class nu{constructor(e,t,r,s,i,a){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new nu({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.gc(e),r}yc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Wi(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(Cp(this.Ac)&&sw.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class ow{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||So(e)}Cc(e,t,r,s=!1){return new nu({Ac:e,methodName:t,Dc:r,path:Pe.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function kp(n){const e=n._freezeSettings(),t=So(n._databaseId);return new ow(n._databaseId,!!e.ignoreUndefinedProperties,t)}function aw(n,e,t,r,s,i={}){const a=n.Cc(i.merge||i.mergeFields?2:0,e,t,s);ru("Data must be an object, but it was:",a,r);const c=Np(r,a);let l,h;if(i.merge)l=new Ye(a.fieldMask),h=a.fieldTransforms;else if(i.mergeFields){const d=[];for(const m of i.mergeFields){const g=tc(e,m,t);if(!a.contains(g))throw new F(N.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);Vp(d,g)||d.push(g)}l=new Ye(d),h=a.fieldTransforms.filter((m=>l.covers(m.field)))}else l=null,h=a.fieldTransforms;return new iw(new He(c),l,h)}class Do extends tu{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Do}}function cw(n,e,t,r){const s=n.Cc(1,e,t);ru("Data must be an object, but it was:",s,r);const i=[],a=He.empty();Rn(r,((l,h)=>{const d=su(e,l,t);h=ye(h);const m=s.yc(d);if(h instanceof Do)i.push(d);else{const g=Vo(h,m);g!=null&&(i.push(d),a.set(d,g))}}));const c=new Ye(i);return new Pp(a,c,s.fieldTransforms)}function uw(n,e,t,r,s,i){const a=n.Cc(1,e,t),c=[tc(e,r,t)],l=[s];if(i.length%2!=0)throw new F(N.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<i.length;g+=2)c.push(tc(e,i[g])),l.push(i[g+1]);const h=[],d=He.empty();for(let g=c.length-1;g>=0;--g)if(!Vp(h,c[g])){const I=c[g];let S=l[g];S=ye(S);const C=a.yc(I);if(S instanceof Do)h.push(I);else{const R=Vo(S,C);R!=null&&(h.push(I),d.set(I,R))}}const m=new Ye(h);return new Pp(d,m,a.fieldTransforms)}function Vo(n,e){if(Dp(n=ye(n)))return ru("Unsupported field value:",e,n),Np(n,e);if(n instanceof tu)return(function(r,s){if(!Cp(s.Ac))throw s.Sc(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(r,s){const i=[];let a=0;for(const c of r){let l=Vo(c,s.wc(a));l==null&&(l={nullValue:"NULL_VALUE"}),i.push(l),a++}return{arrayValue:{values:i}}})(n,e)}return(function(r,s){if((r=ye(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return Kv(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=ce.fromDate(r);return{timestampValue:ji(s.serializer,i)}}if(r instanceof ce){const i=new ce(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:ji(s.serializer,i)}}if(r instanceof Rt)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof rt)return{bytesValue:Xd(s.serializer,r._byteString)};if(r instanceof Te){const i=s.databaseId,a=r.firestore._databaseId;if(!a.isEqual(i))throw s.Sc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Bc(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof Pt)return(function(a,c){return{mapValue:{fields:{[Sd]:{stringValue:Rd},[xi]:{arrayValue:{values:a.toArray().map((h=>{if(typeof h!="number")throw c.Sc("VectorValues must only contain numeric values.");return Lc(c.serializer,h)}))}}}}}})(r,s);throw s.Sc(`Unsupported field value: ${Cc(r)}`)})(n,e)}function Np(n,e){const t={};return Ed(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Rn(n,((r,s)=>{const i=Vo(s,e.mc(r));i!=null&&(t[r]=i)})),{mapValue:{fields:t}}}function Dp(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof ce||n instanceof Rt||n instanceof rt||n instanceof Te||n instanceof tu||n instanceof Pt)}function ru(n,e,t){if(!Dp(t)||!yd(t)){const r=Cc(t);throw r==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+r)}}function tc(n,e,t){if((e=ye(e))instanceof No)return e._internalPath;if(typeof e=="string")return su(n,e);throw Wi("Field path arguments must be of type string or ",n,!1,void 0,t)}const lw=new RegExp("[~\\*/\\[\\]]");function su(n,e,t){if(e.search(lw)>=0)throw Wi(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new No(...e.split("."))._internalPath}catch{throw Wi(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Wi(n,e,t,r,s){const i=r&&!r.isEmpty(),a=s!==void 0;let c=`Function ${e}() called with invalid data`;t&&(c+=" (via `toFirestore()`)"),c+=". ";let l="";return(i||a)&&(l+=" (found",i&&(l+=` in field ${r}`),a&&(l+=` in document ${s}`),l+=")"),new F(N.INVALID_ARGUMENT,c+n+l)}function Vp(n,e){return n.some((t=>t.isEqual(e)))}class Op{constructor(e,t,r,s,i){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Te(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new hw(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Mp("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class hw extends Op{data(){return super.data()}}function Mp(n,e){return typeof e=="string"?su(n,e):e instanceof No?e._internalPath:e._delegate._internalPath}function fw(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new F(N.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class dw{convertValue(e,t="none"){switch(In(e)){case 0:return null;case 1:return e.booleanValue;case 2:return me(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(wn(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw $(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return Rn(e,((s,i)=>{r[s]=this.convertValue(i,t)})),r}convertVectorValue(e){const t=e.fields?.[xi].arrayValue?.values?.map((r=>me(r.doubleValue)));return new Pt(t)}convertGeoPoint(e){return new Rt(me(e.latitude),me(e.longitude))}convertArray(e,t){return(e.values||[]).map((r=>this.convertValue(r,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const r=vo(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Cs(e));default:return null}}convertTimestamp(e){const t=Tn(e);return new ce(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=ae.fromString(e);te(np(r),9688,{name:e});const s=new ks(r.get(1),r.get(3)),i=new B(r.popFirst(5));return s.isEqual(t)||zt(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}function pw(n,e,t){let r;return r=n?n.toFirestore(e):e,r}class ms{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class jn extends Op{constructor(e,t,r,s,i,a){super(e,t,r,s,a),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new bi(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(Mp("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new F(N.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=jn._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}jn._jsonSchemaVersion="firestore/documentSnapshot/1.0",jn._jsonSchema={type:_e("string",jn._jsonSchemaVersion),bundleSource:_e("string","DocumentSnapshot"),bundleName:_e("string"),bundle:_e("string")};class bi extends jn{data(e={}){return super.data(e)}}class Tr{constructor(e,t,r,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new ms(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((r=>{e.call(t,new bi(this._firestore,this._userDataWriter,r.key,r,new ms(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new F(N.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(s,i){if(s._snapshot.oldDocs.isEmpty()){let a=0;return s._snapshot.docChanges.map((c=>{const l=new bi(s._firestore,s._userDataWriter,c.doc.key,c.doc,new ms(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);return c.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}}))}{let a=s._snapshot.oldDocs;return s._snapshot.docChanges.filter((c=>i||c.type!==3)).map((c=>{const l=new bi(s._firestore,s._userDataWriter,c.doc.key,c.doc,new ms(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);let h=-1,d=-1;return c.type!==0&&(h=a.indexOf(c.doc.key),a=a.delete(c.doc.key)),c.type!==1&&(a=a.add(c.doc),d=a.indexOf(c.doc.key)),{type:mw(c.type),doc:l,oldIndex:h,newIndex:d}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new F(N.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Tr._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Pc.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],s=[];return this.docs.forEach((i=>{i._document!==null&&(t.push(i._document),r.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),s.push(i.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function mw(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return $(61501,{type:n})}}Tr._jsonSchemaVersion="firestore/querySnapshot/1.0",Tr._jsonSchema={type:_e("string",Tr._jsonSchemaVersion),bundleSource:_e("string","QuerySnapshot"),bundleName:_e("string"),bundle:_e("string")};class Lp extends dw{constructor(e){super(),this.firestore=e}convertBytes(e){return new rt(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Te(this.firestore,null,t)}}function gw(n,e,t,...r){n=gn(n,Te);const s=gn(n.firestore,Lr),i=kp(s);let a;return a=typeof(e=ye(e))=="string"||e instanceof No?uw(i,"updateDoc",n._key,e,t,r):cw(i,"updateDoc",n._key,e),iu(s,[a.toMutation(n._key,lt.exists(!0))])}function _w(n){return iu(gn(n.firestore,Lr),[new xc(n._key,lt.none())])}function yw(n,e){const t=gn(n.firestore,Lr),r=eu(n),s=pw(n.converter,e);return iu(t,[aw(kp(n.firestore),"addDoc",r._key,s,n.converter!==null,{}).toMutation(r._key,lt.exists(!1))]).then((()=>r))}function vw(n,...e){n=ye(n);let t={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||xh(e[r])||(t=e[r++]);const s={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(xh(e[r])){const l=e[r];e[r]=l.next?.bind(l),e[r+1]=l.error?.bind(l),e[r+2]=l.complete?.bind(l)}let i,a,c;if(n instanceof Te)a=gn(n.firestore,Lr),c=Mc(n._key.path),i={next:l=>{e[r]&&e[r](Ew(a,n,l))},error:e[r+1],complete:e[r+2]};else{const l=gn(n,ko);a=gn(l.firestore,Lr),c=l._query;const h=new Lp(a);i={next:d=>{e[r]&&e[r](new Tr(a,h,l,d))},error:e[r+1],complete:e[r+2]},fw(n._query)}return(function(h,d,m,g){const I=new JT(g),S=new DT(d,I,m);return h.asyncQueue.enqueueAndForget((async()=>PT(await kh(h),S))),()=>{I.Nu(),h.asyncQueue.enqueueAndForget((async()=>CT(await kh(h),S)))}})(Rp(a),c,s,i)}function iu(n,e){return(function(r,s){const i=new $n;return r.asyncQueue.enqueueAndForget((async()=>jT(await ew(r),s,i))),i.promise})(Rp(n),e)}function Ew(n,e,t){const r=t.docs.get(e._key),s=new Lp(n);return new jn(n,s,e._key,r,new ms(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(s){qr=s})(jr),Qn(new vn("firestore",((r,{instanceIdentifier:s,options:i})=>{const a=r.getProvider("app").getImmediate(),c=new Lr(new iv(r.getProvider("auth-internal")),new cv(a,r.getProvider("app-check-internal")),(function(h,d){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new F(N.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ks(h.options.projectId,d)})(a,s),a);return i={useFetchStreams:t,...i},c._setSettings(i),c}),"PUBLIC").setMultipleInstances(!0)),At($l,jl,e),At($l,jl,"esm2020")})();function xp(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Tw=xp,Fp=new $s("auth","Firebase",xp());const Gi=new Ac("@firebase/auth");function ww(n,...e){Gi.logLevel<=Q.WARN&&Gi.warn(`Auth (${jr}): ${n}`,...e)}function Si(n,...e){Gi.logLevel<=Q.ERROR&&Gi.error(`Auth (${jr}): ${n}`,...e)}function Vt(n,...e){throw au(n,...e)}function ht(n,...e){return au(n,...e)}function ou(n,e,t){const r={...Tw(),[e]:t};return new $s("auth","Firebase",r).create(e,{appName:n.name})}function qn(n){return ou(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Iw(n,e,t){const r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&Vt(n,"argument-error"),ou(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function au(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return Fp.create(n,...e)}function j(n,e,...t){if(!n)throw au(e,...t)}function Ut(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Si(e),new Error(e)}function Wt(n,e){n||Ut(e)}function nc(){return typeof self<"u"&&self.location?.href||""}function Aw(){return Fh()==="http:"||Fh()==="https:"}function Fh(){return typeof self<"u"&&self.location?.protocol||null}function bw(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Aw()||O_()||"connection"in navigator)?navigator.onLine:!0}function Sw(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class Ks{constructor(e,t){this.shortDelay=e,this.longDelay=t,Wt(t>e,"Short delay should be less than long delay!"),this.isMobile=N_()||M_()}get(){return bw()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function cu(n,e){Wt(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class Up{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ut("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ut("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ut("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Rw={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const Pw=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Cw=new Ks(3e4,6e4);function uu(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Gr(n,e,t,r,s={}){return Bp(n,s,async()=>{let i={},a={};r&&(e==="GET"?a=r:i={body:JSON.stringify(r)});const c=js({key:n.config.apiKey,...a}).slice(1),l=await n._getAdditionalHeaders();l["Content-Type"]="application/json",n.languageCode&&(l["X-Firebase-Locale"]=n.languageCode);const h={method:e,headers:l,...i};return V_()||(h.referrerPolicy="no-referrer"),n.emulatorConfig&&Sn(n.emulatorConfig.host)&&(h.credentials="include"),Up.fetch()(await $p(n,n.config.apiHost,t,c),h)})}async function Bp(n,e,t){n._canInitEmulator=!1;const r={...Rw,...e};try{const s=new Nw(n),i=await Promise.race([t(),s.promise]);s.clearNetworkTimeout();const a=await i.json();if("needConfirmation"in a)throw _i(n,"account-exists-with-different-credential",a);if(i.ok&&!("errorMessage"in a))return a;{const c=i.ok?a.errorMessage:a.error.message,[l,h]=c.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw _i(n,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw _i(n,"email-already-in-use",a);if(l==="USER_DISABLED")throw _i(n,"user-disabled",a);const d=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw ou(n,d,h);Vt(n,d)}}catch(s){if(s instanceof Mt)throw s;Vt(n,"network-request-failed",{message:String(s)})}}async function kw(n,e,t,r,s={}){const i=await Gr(n,e,t,r,s);return"mfaPendingCredential"in i&&Vt(n,"multi-factor-auth-required",{_serverResponse:i}),i}async function $p(n,e,t,r){const s=`${e}${t}?${r}`,i=n,a=i.config.emulator?cu(n.config,s):`${n.config.apiScheme}://${s}`;return Pw.includes(t)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(a).toString():a}class Nw{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(ht(this.auth,"network-request-failed")),Cw.get())})}}function _i(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const s=ht(n,e,r);return s.customData._tokenResponse=t,s}async function Dw(n,e){return Gr(n,"POST","/v1/accounts:delete",e)}async function Ki(n,e){return Gr(n,"POST","/v1/accounts:lookup",e)}function Is(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Vw(n,e=!1){const t=ye(n),r=await t.getIdToken(e),s=lu(r);j(s&&s.exp&&s.auth_time&&s.iat,t.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,a=i?.sign_in_provider;return{claims:s,token:r,authTime:Is(wa(s.auth_time)),issuedAtTime:Is(wa(s.iat)),expirationTime:Is(wa(s.exp)),signInProvider:a||null,signInSecondFactor:i?.sign_in_second_factor||null}}function wa(n){return Number(n)*1e3}function lu(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Si("JWT malformed, contained fewer than 3 sections"),null;try{const s=Zf(t);return s?JSON.parse(s):(Si("Failed to decode base64 JWT payload"),null)}catch(s){return Si("Caught error parsing JWT payload as JSON",s?.toString()),null}}function Uh(n){const e=lu(n);return j(e,"internal-error"),j(typeof e.exp<"u","internal-error"),j(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Os(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof Mt&&Ow(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function Ow({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class Mw{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class rc{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Is(this.lastLoginAt),this.creationTime=Is(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Qi(n){const e=n.auth,t=await n.getIdToken(),r=await Os(n,Ki(e,{idToken:t}));j(r?.users.length,e,"internal-error");const s=r.users[0];n._notifyReloadListener(s);const i=s.providerUserInfo?.length?jp(s.providerUserInfo):[],a=xw(n.providerData,i),c=n.isAnonymous,l=!(n.email&&s.passwordHash)&&!a?.length,h=c?l:!1,d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new rc(s.createdAt,s.lastLoginAt),isAnonymous:h};Object.assign(n,d)}async function Lw(n){const e=ye(n);await Qi(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function xw(n,e){return[...n.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function jp(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function Fw(n,e){const t=await Bp(n,{},async()=>{const r=js({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=n.config,a=await $p(n,s,"/v1/token",`key=${i}`),c=await n._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:c,body:r};return n.emulatorConfig&&Sn(n.emulatorConfig.host)&&(l.credentials="include"),Up.fetch()(a,l)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function Uw(n,e){return Gr(n,"POST","/v2/accounts:revokeToken",uu(n,e))}class wr{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){j(e.idToken,"internal-error"),j(typeof e.idToken<"u","internal-error"),j(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Uh(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){j(e.length!==0,"internal-error");const t=Uh(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(j(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:s,expiresIn:i}=await Fw(e,t);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:s,expirationTime:i}=t,a=new wr;return r&&(j(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),s&&(j(typeof s=="string","internal-error",{appName:e}),a.accessToken=s),i&&(j(typeof i=="number","internal-error",{appName:e}),a.expirationTime=i),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new wr,this.toJSON())}_performRefresh(){return Ut("not implemented")}}function sn(n,e){j(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class ct{constructor({uid:e,auth:t,stsTokenManager:r,...s}){this.providerId="firebase",this.proactiveRefresh=new Mw(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new rc(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await Os(this,this.stsTokenManager.getToken(this.auth,e));return j(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return Vw(this,e)}reload(){return Lw(this)}_assign(e){this!==e&&(j(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new ct({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){j(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await Qi(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(nt(this.auth.app))return Promise.reject(qn(this.auth));const e=await this.getIdToken();return await Os(this,Dw(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const r=t.displayName??void 0,s=t.email??void 0,i=t.phoneNumber??void 0,a=t.photoURL??void 0,c=t.tenantId??void 0,l=t._redirectEventId??void 0,h=t.createdAt??void 0,d=t.lastLoginAt??void 0,{uid:m,emailVerified:g,isAnonymous:I,providerData:S,stsTokenManager:C}=t;j(m&&C,e,"internal-error");const R=wr.fromJSON(this.name,C);j(typeof m=="string",e,"internal-error"),sn(r,e.name),sn(s,e.name),j(typeof g=="boolean",e,"internal-error"),j(typeof I=="boolean",e,"internal-error"),sn(i,e.name),sn(a,e.name),sn(c,e.name),sn(l,e.name),sn(h,e.name),sn(d,e.name);const O=new ct({uid:m,auth:e,email:s,emailVerified:g,displayName:r,isAnonymous:I,photoURL:a,phoneNumber:i,tenantId:c,stsTokenManager:R,createdAt:h,lastLoginAt:d});return S&&Array.isArray(S)&&(O.providerData=S.map(x=>({...x}))),l&&(O._redirectEventId=l),O}static async _fromIdTokenResponse(e,t,r=!1){const s=new wr;s.updateFromServerResponse(t);const i=new ct({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await Qi(i),i}static async _fromGetAccountInfoResponse(e,t,r){const s=t.users[0];j(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?jp(s.providerUserInfo):[],a=!(s.email&&s.passwordHash)&&!i?.length,c=new wr;c.updateFromIdToken(r);const l=new ct({uid:s.localId,auth:e,stsTokenManager:c,isAnonymous:a}),h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new rc(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!i?.length};return Object.assign(l,h),l}}const Bh=new Map;function Bt(n){Wt(n instanceof Function,"Expected a class definition");let e=Bh.get(n);return e?(Wt(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Bh.set(n,e),e)}class qp{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}qp.type="NONE";const $h=qp;function Ri(n,e,t){return`firebase:${n}:${e}:${t}`}class Ir{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=Ri(this.userKey,s.apiKey,i),this.fullPersistenceKey=Ri("persistence",s.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Ki(this.auth,{idToken:e}).catch(()=>{});return t?ct._fromGetAccountInfoResponse(this.auth,t,e):null}return ct._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new Ir(Bt($h),e,r);const s=(await Promise.all(t.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let i=s[0]||Bt($h);const a=Ri(r,e.config.apiKey,e.name);let c=null;for(const h of t)try{const d=await h._get(a);if(d){let m;if(typeof d=="string"){const g=await Ki(e,{idToken:d}).catch(()=>{});if(!g)break;m=await ct._fromGetAccountInfoResponse(e,g,d)}else m=ct._fromJSON(e,d);h!==i&&(c=m),i=h;break}}catch{}const l=s.filter(h=>h._shouldAllowMigration);return!i._shouldAllowMigration||!l.length?new Ir(i,e,r):(i=l[0],c&&await i._set(a,c.toJSON()),await Promise.all(t.map(async h=>{if(h!==i)try{await h._remove(a)}catch{}})),new Ir(i,e,r))}}function jh(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Gp(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(zp(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Qp(e))return"Blackberry";if(Xp(e))return"Webos";if(Hp(e))return"Safari";if((e.includes("chrome/")||Wp(e))&&!e.includes("edge/"))return"Chrome";if(Kp(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function zp(n=Fe()){return/firefox\//i.test(n)}function Hp(n=Fe()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Wp(n=Fe()){return/crios\//i.test(n)}function Gp(n=Fe()){return/iemobile/i.test(n)}function Kp(n=Fe()){return/android/i.test(n)}function Qp(n=Fe()){return/blackberry/i.test(n)}function Xp(n=Fe()){return/webos/i.test(n)}function hu(n=Fe()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function Bw(n=Fe()){return hu(n)&&!!window.navigator?.standalone}function $w(){return L_()&&document.documentMode===10}function Jp(n=Fe()){return hu(n)||Kp(n)||Xp(n)||Qp(n)||/windows phone/i.test(n)||Gp(n)}function Yp(n,e=[]){let t;switch(n){case"Browser":t=jh(Fe());break;case"Worker":t=`${jh(Fe())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${jr}/${r}`}class jw{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=i=>new Promise((a,c)=>{try{const l=e(i);a(l)}catch(l){c(l)}});r.onAbort=t,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const s of t)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}}async function qw(n,e={}){return Gr(n,"GET","/v2/passwordPolicy",uu(n,e))}const zw=6;class Hw{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??zw,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),s&&(t.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}class Ww{constructor(e,t,r,s){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new qh(this),this.idTokenSubscription=new qh(this),this.beforeStateQueue=new jw(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Fp,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Bt(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Ir.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Ki(this,{idToken:e}),r=await ct._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(nt(this.app)){const i=this.app.settings.authIdToken;return i?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(i).then(a,a))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let r=t,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const i=this.redirectUser?._redirectEventId,a=r?._redirectEventId,c=await this.tryRedirectSignIn(e);(!i||i===a)&&c?.user&&(r=c.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(i){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(i))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return j(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Qi(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=Sw()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(nt(this.app))return Promise.reject(qn(this));const t=e?ye(e):null;return t&&j(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&j(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return nt(this.app)?Promise.reject(qn(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return nt(this.app)?Promise.reject(qn(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Bt(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await qw(this),t=new Hw(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new $s("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await Uw(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Bt(e)||this._popupRedirectResolver;j(t,this,"argument-error"),this.redirectPersistenceManager=await Ir.create(this,[Bt(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,s){if(this._deleted)return()=>{};const i=typeof t=="function"?t:t.next.bind(t);let a=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(j(c,this,"internal-error"),c.then(()=>{a||i(this.currentUser)}),typeof t=="function"){const l=e.addObserver(t,r,s);return()=>{a=!0,l()}}else{const l=e.addObserver(t);return()=>{a=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return j(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Yp(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(nt(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&ww(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Oo(n){return ye(n)}class qh{constructor(e){this.auth=e,this.observer=null,this.addObserver=z_(t=>this.observer=t)}get next(){return j(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let fu={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Gw(n){fu=n}function Kw(n){return fu.loadJS(n)}function Qw(){return fu.gapiScript}function Xw(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function Jw(n,e){const t=go(n,"auth");if(t.isInitialized()){const s=t.getImmediate(),i=t.getOptions();if(Kn(i,e??{}))return s;Vt(s,"already-initialized")}return t.initialize({options:e})}function Yw(n,e){const t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(Bt);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function Zw(n,e,t){const r=Oo(n);j(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=Zp(e),{host:a,port:c}=eI(e),l=c===null?"":`:${c}`,h={url:`${i}//${a}${l}/`},d=Object.freeze({host:a,port:c,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){j(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),j(Kn(h,r.config.emulator)&&Kn(d,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=h,r.emulatorConfig=d,r.settings.appVerificationDisabledForTesting=!0,Sn(a)?(wc(`${i}//${a}${l}`),Ic("Auth",!0)):tI()}function Zp(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function eI(n){const e=Zp(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:zh(r.substr(i.length+1))}}else{const[i,a]=r.split(":");return{host:i,port:zh(a)}}}function zh(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function tI(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class em{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Ut("not implemented")}_getIdTokenResponse(e){return Ut("not implemented")}_linkToIdToken(e,t){return Ut("not implemented")}_getReauthenticationResolver(e){return Ut("not implemented")}}async function Ar(n,e){return kw(n,"POST","/v1/accounts:signInWithIdp",uu(n,e))}const nI="http://localhost";class Yn extends em{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Yn(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Vt("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,...i}=t;if(!r||!s)return null;const a=new Yn(r,s);return a.idToken=i.idToken||void 0,a.accessToken=i.accessToken||void 0,a.secret=i.secret,a.nonce=i.nonce,a.pendingToken=i.pendingToken||null,a}_getIdTokenResponse(e){const t=this.buildRequest();return Ar(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,Ar(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Ar(e,t)}buildRequest(){const e={requestUri:nI,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=js(t)}return e}}class du{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Qs extends du{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class on extends Qs{constructor(){super("facebook.com")}static credential(e){return Yn._fromParams({providerId:on.PROVIDER_ID,signInMethod:on.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return on.credentialFromTaggedObject(e)}static credentialFromError(e){return on.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return on.credential(e.oauthAccessToken)}catch{return null}}}on.FACEBOOK_SIGN_IN_METHOD="facebook.com";on.PROVIDER_ID="facebook.com";class Ft extends Qs{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Yn._fromParams({providerId:Ft.PROVIDER_ID,signInMethod:Ft.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Ft.credentialFromTaggedObject(e)}static credentialFromError(e){return Ft.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return Ft.credential(t,r)}catch{return null}}}Ft.GOOGLE_SIGN_IN_METHOD="google.com";Ft.PROVIDER_ID="google.com";class an extends Qs{constructor(){super("github.com")}static credential(e){return Yn._fromParams({providerId:an.PROVIDER_ID,signInMethod:an.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return an.credentialFromTaggedObject(e)}static credentialFromError(e){return an.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return an.credential(e.oauthAccessToken)}catch{return null}}}an.GITHUB_SIGN_IN_METHOD="github.com";an.PROVIDER_ID="github.com";class cn extends Qs{constructor(){super("twitter.com")}static credential(e,t){return Yn._fromParams({providerId:cn.PROVIDER_ID,signInMethod:cn.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return cn.credentialFromTaggedObject(e)}static credentialFromError(e){return cn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return cn.credential(t,r)}catch{return null}}}cn.TWITTER_SIGN_IN_METHOD="twitter.com";cn.PROVIDER_ID="twitter.com";class xr{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,s=!1){const i=await ct._fromIdTokenResponse(e,r,s),a=Hh(r);return new xr({user:i,providerId:a,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const s=Hh(r);return new xr({user:e,providerId:s,_tokenResponse:r,operationType:t})}}function Hh(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class Xi extends Mt{constructor(e,t,r,s){super(t.code,t.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,Xi.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,s){return new Xi(e,t,r,s)}}function tm(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Xi._fromErrorAndOperation(n,i,e,r):i})}async function rI(n,e,t=!1){const r=await Os(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return xr._forOperation(n,"link",r)}async function sI(n,e,t=!1){const{auth:r}=n;if(nt(r.app))return Promise.reject(qn(r));const s="reauthenticate";try{const i=await Os(n,tm(r,s,e,n),t);j(i.idToken,r,"internal-error");const a=lu(i.idToken);j(a,r,"internal-error");const{sub:c}=a;return j(n.uid===c,r,"user-mismatch"),xr._forOperation(n,s,i)}catch(i){throw i?.code==="auth/user-not-found"&&Vt(r,"user-mismatch"),i}}async function iI(n,e,t=!1){if(nt(n.app))return Promise.reject(qn(n));const r="signIn",s=await tm(n,r,e),i=await xr._fromIdTokenResponse(n,r,s);return t||await n._updateCurrentUser(i.user),i}function oI(n,e,t,r){return ye(n).onIdTokenChanged(e,t,r)}function aI(n,e,t){return ye(n).beforeAuthStateChanged(e,t)}function cI(n,e,t,r){return ye(n).onAuthStateChanged(e,t,r)}function uI(n){return ye(n).signOut()}const Ji="__sak";class nm{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Ji,"1"),this.storage.removeItem(Ji),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const lI=1e3,hI=10;class rm extends nm{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Jp(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),s=this.localCache[t];r!==s&&e(t,s,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((a,c,l)=>{this.notifyListeners(a,l)});return}const r=e.key;t?this.detachListener():this.stopPolling();const s=()=>{const a=this.storage.getItem(r);!t&&this.localCache[r]===a||this.notifyListeners(r,a)},i=this.storage.getItem(r);$w()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,hI):s()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},lI)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}rm.type="LOCAL";const fI=rm;class sm extends nm{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}sm.type="SESSION";const im=sm;function dI(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class Mo{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(s=>s.isListeningto(e));if(t)return t;const r=new Mo(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:s,data:i}=t.data,a=this.handlersMap[s];if(!a?.size)return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const c=Array.from(a).map(async h=>h(t.origin,i)),l=await dI(c);t.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:l})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Mo.receivers=[];function pu(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}class pI{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,a;return new Promise((c,l)=>{const h=pu("",20);s.port1.start();const d=setTimeout(()=>{l(new Error("unsupported_event"))},r);a={messageChannel:s,onMessage(m){const g=m;if(g.data.eventId===h)switch(g.data.status){case"ack":clearTimeout(d),i=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),c(g.data.response);break;default:clearTimeout(d),clearTimeout(i),l(new Error("invalid_response"));break}}},this.handlers.add(a),s.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:h,data:t},[s.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}function Ct(){return window}function mI(n){Ct().location.href=n}function om(){return typeof Ct().WorkerGlobalScope<"u"&&typeof Ct().importScripts=="function"}async function gI(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function _I(){return navigator?.serviceWorker?.controller||null}function yI(){return om()?self:null}const am="firebaseLocalStorageDb",vI=1,Yi="firebaseLocalStorage",cm="fbase_key";class Xs{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Lo(n,e){return n.transaction([Yi],e?"readwrite":"readonly").objectStore(Yi)}function EI(){const n=indexedDB.deleteDatabase(am);return new Xs(n).toPromise()}function sc(){const n=indexedDB.open(am,vI);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(Yi,{keyPath:cm})}catch(s){t(s)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(Yi)?e(r):(r.close(),await EI(),e(await sc()))})})}async function Wh(n,e,t){const r=Lo(n,!0).put({[cm]:e,value:t});return new Xs(r).toPromise()}async function TI(n,e){const t=Lo(n,!1).get(e),r=await new Xs(t).toPromise();return r===void 0?null:r.value}function Gh(n,e){const t=Lo(n,!0).delete(e);return new Xs(t).toPromise()}const wI=800,II=3;class um{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await sc(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>II)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return om()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Mo._getInstance(yI()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await gI(),!this.activeServiceWorker)return;this.sender=new pI(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||_I()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await sc();return await Wh(e,Ji,"1"),await Gh(e,Ji),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>Wh(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>TI(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Gh(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=Lo(s,!1).getAll();return new Xs(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),t.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),t.push(s));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),wI)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}um.type="LOCAL";const AI=um;new Ks(3e4,6e4);function lm(n,e){return e?Bt(e):(j(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class mu extends em{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ar(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Ar(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Ar(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function bI(n){return iI(n.auth,new mu(n),n.bypassAuthState)}function SI(n){const{auth:e,user:t}=n;return j(t,e,"internal-error"),sI(t,new mu(n),n.bypassAuthState)}async function RI(n){const{auth:e,user:t}=n;return j(t,e,"internal-error"),rI(t,new mu(n),n.bypassAuthState)}class hm{constructor(e,t,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:s,tenantId:i,error:a,type:c}=e;if(a){this.reject(a);return}const l={auth:this.auth,requestUri:t,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(l))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return bI;case"linkViaPopup":case"linkViaRedirect":return RI;case"reauthViaPopup":case"reauthViaRedirect":return SI;default:Vt(this.auth,"internal-error")}}resolve(e){Wt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Wt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const PI=new Ks(2e3,1e4);async function CI(n,e,t){if(nt(n.app))return Promise.reject(ht(n,"operation-not-supported-in-this-environment"));const r=Oo(n);Iw(n,e,du);const s=lm(r,t);return new xn(r,"signInViaPopup",e,s).executeNotNull()}class xn extends hm{constructor(e,t,r,s,i){super(e,t,s,i),this.provider=r,this.authWindow=null,this.pollId=null,xn.currentPopupAction&&xn.currentPopupAction.cancel(),xn.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return j(e,this.auth,"internal-error"),e}async onExecution(){Wt(this.filter.length===1,"Popup operations only handle one event");const e=pu();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(ht(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(ht(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,xn.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ht(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,PI.get())};e()}}xn.currentPopupAction=null;const kI="pendingRedirect",Pi=new Map;class NI extends hm{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=Pi.get(this.auth._key());if(!e){try{const r=await DI(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Pi.set(this.auth._key(),e)}return this.bypassAuthState||Pi.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function DI(n,e){const t=MI(e),r=OI(n);if(!await r._isAvailable())return!1;const s=await r._get(t)==="true";return await r._remove(t),s}function VI(n,e){Pi.set(n._key(),e)}function OI(n){return Bt(n._redirectPersistence)}function MI(n){return Ri(kI,n.config.apiKey,n.name)}async function LI(n,e,t=!1){if(nt(n.app))return Promise.reject(qn(n));const r=Oo(n),s=lm(r,e),a=await new NI(r,s,t).execute();return a&&!t&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,e)),a}const xI=600*1e3;class FI{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!UI(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!fm(e)){const r=e.error.code?.split("auth/")[1]||"internal-error";t.onError(ht(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=xI&&this.cachedEventUids.clear(),this.cachedEventUids.has(Kh(e))}saveEventToCache(e){this.cachedEventUids.add(Kh(e)),this.lastProcessedEventTime=Date.now()}}function Kh(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function fm({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function UI(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return fm(n);default:return!1}}async function BI(n,e={}){return Gr(n,"GET","/v1/projects",e)}const $I=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,jI=/^https?/;async function qI(n){if(n.config.emulator)return;const{authorizedDomains:e}=await BI(n);for(const t of e)try{if(zI(t))return}catch{}Vt(n,"unauthorized-domain")}function zI(n){const e=nc(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const a=new URL(n);return a.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&a.hostname===r}if(!jI.test(t))return!1;if($I.test(n))return r===n;const s=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}const HI=new Ks(3e4,6e4);function Qh(){const n=Ct().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function WI(n){return new Promise((e,t)=>{function r(){Qh(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Qh(),t(ht(n,"network-request-failed"))},timeout:HI.get()})}if(Ct().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Ct().gapi?.load)r();else{const s=Xw("iframefcb");return Ct()[s]=()=>{gapi.load?r():t(ht(n,"network-request-failed"))},Kw(`${Qw()}?onload=${s}`).catch(i=>t(i))}}).catch(e=>{throw Ci=null,e})}let Ci=null;function GI(n){return Ci=Ci||WI(n),Ci}const KI=new Ks(5e3,15e3),QI="__/auth/iframe",XI="emulator/auth/iframe",JI={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},YI=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function ZI(n){const e=n.config;j(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?cu(e,XI):`https://${n.config.authDomain}/${QI}`,r={apiKey:e.apiKey,appName:n.name,v:jr},s=YI.get(n.config.apiHost);s&&(r.eid=s);const i=n._getFrameworks();return i.length&&(r.fw=i.join(",")),`${t}?${js(r).slice(1)}`}async function eA(n){const e=await GI(n),t=Ct().gapi;return j(t,n,"internal-error"),e.open({where:document.body,url:ZI(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:JI,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const a=ht(n,"network-request-failed"),c=Ct().setTimeout(()=>{i(a)},KI.get());function l(){Ct().clearTimeout(c),s(r)}r.ping(l).then(l,()=>{i(a)})}))}const tA={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},nA=500,rA=600,sA="_blank",iA="http://localhost";class Xh{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function oA(n,e,t,r=nA,s=rA){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let c="";const l={...tA,width:r.toString(),height:s.toString(),top:i,left:a},h=Fe().toLowerCase();t&&(c=Wp(h)?sA:t),zp(h)&&(e=e||iA,l.scrollbars="yes");const d=Object.entries(l).reduce((g,[I,S])=>`${g}${I}=${S},`,"");if(Bw(h)&&c!=="_self")return aA(e||"",c),new Xh(null);const m=window.open(e||"",c,d);j(m,n,"popup-blocked");try{m.focus()}catch{}return new Xh(m)}function aA(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}const cA="__/auth/handler",uA="emulator/auth/handler",lA=encodeURIComponent("fac");async function Jh(n,e,t,r,s,i){j(n.config.authDomain,n,"auth-domain-config-required"),j(n.config.apiKey,n,"invalid-api-key");const a={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:jr,eventId:s};if(e instanceof du){e.setDefaultLanguage(n.languageCode),a.providerId=e.providerId||"",q_(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,m]of Object.entries({}))a[d]=m}if(e instanceof Qs){const d=e.getScopes().filter(m=>m!=="");d.length>0&&(a.scopes=d.join(","))}n.tenantId&&(a.tid=n.tenantId);const c=a;for(const d of Object.keys(c))c[d]===void 0&&delete c[d];const l=await n._getAppCheckToken(),h=l?`#${lA}=${encodeURIComponent(l)}`:"";return`${hA(n)}?${js(c).slice(1)}${h}`}function hA({config:n}){return n.emulator?cu(n,uA):`https://${n.authDomain}/${cA}`}const Ia="webStorageSupport";class fA{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=im,this._completeRedirectFn=LI,this._overrideRedirectResult=VI}async _openPopup(e,t,r,s){Wt(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const i=await Jh(e,t,r,nc(),s);return oA(e,i,pu())}async _openRedirect(e,t,r,s){await this._originValidation(e);const i=await Jh(e,t,r,nc(),s);return mI(i),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:s,promise:i}=this.eventManagers[t];return s?Promise.resolve(s):(Wt(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await eA(e),r=new FI(e);return t.register("authEvent",s=>(j(s?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Ia,{type:Ia},s=>{const i=s?.[0]?.[Ia];i!==void 0&&t(!!i),Vt(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=qI(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Jp()||Hp()||hu()}}const dA=fA;var Yh="@firebase/auth",Zh="1.11.1";class pA{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){j(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function mA(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function gA(n){Qn(new vn("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:a,authDomain:c}=r.options;j(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:a,authDomain:c,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Yp(n)},h=new Ww(r,s,i,l);return Yw(h,t),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Qn(new vn("auth-internal",e=>{const t=Oo(e.getProvider("auth").getImmediate());return(r=>new pA(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),At(Yh,Zh,mA(n)),At(Yh,Zh,"esm2020")}const _A=300,yA=rd("authIdTokenMaxAge")||_A;let ef=null;const vA=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>yA)return;const s=t?.token;ef!==s&&(ef=s,await fetch(n,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function EA(n=Sc()){const e=go(n,"auth");if(e.isInitialized())return e.getImmediate();const t=Jw(n,{popupRedirectResolver:dA,persistence:[AI,fI,im]}),r=rd("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const a=vA(i.toString());aI(t,a,()=>a(t.currentUser)),oI(t,c=>a(c))}}const s=ed("auth");return s&&Zw(t,`http://${s}`),t}function TA(){return document.getElementsByTagName("head")?.[0]??document}Gw({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=s=>{const i=ht("internal-error");i.customData=s,t(i)},r.type="text/javascript",r.charset="UTF-8",TA().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});gA("Browser");const wA={apiKey:"AIzaSyBC5VHNEcVL9KP8M0d64ZajF6P4Hzqzafc",authDomain:"bbnme-58716.firebaseapp.com",projectId:"bbnme-58716",storageBucket:"bbnme-58716.appspot.com",messagingSenderId:"155088179379",appId:"1:155088179379:web:5d98445c178b7513f520c6"},gu=od(wA),Zi=nw(gu),_u=EA(gu),IA=new Ft,xo=fo(null),dm=fo(!0);cI(_u,n=>{xo.set(n),dm.set(!1)});var AA=fe('<button class="svelte-18sv61c"> </button>');function Zn(n,e){let t=It(e,"label",8,"Button"),r=It(e,"onClick",8,()=>{});var s=AA(),i=ue(s);Gn(()=>ho(i,t())),yn("click",s,function(...a){r()?.apply(this,a)}),se(n,s)}var bA=fe('<div class="login-container svelte-8ukb9p"><h2 class="svelte-8ukb9p">Please sign in to continue</h2> <!></div>');function SA(n,e){st(e,!1),dt();var t=bA(),r=le(ue(t),2);Zn(r,{label:"Sign in with Google",onClick:()=>CI(_u,IA)}),se(n,t),it()}var RA=fe('<button class="hamburger-button svelte-p9dp8"><div class="bar svelte-p9dp8"></div> <div class="bar svelte-p9dp8"></div> <div class="bar svelte-p9dp8"></div></button>');function PA(n,e){st(e,!1);const t=po();function r(){t("toggle")}dt();var s=RA();yn("click",s,r),se(n,s),it()}var CA=fe('<span class="not-authorized-message svelte-rfuq4y">Unauthorized user</span>'),kA=fe(`<nav class="svelte-rfuq4y"><!> <div class="navbar-title svelte-rfuq4y"><h1 class="svelte-rfuq4y">bb'n'me</h1></div> <div class="user-status svelte-rfuq4y"><!></div></nav>`);function NA(n,e){st(e,!1);const t=()=>jt(l,"$isAuthorizedToWriteStore",s),r=()=>jt(xo,"$user",s),[s,i]=Bs(),a=we(),c=po(),l=bs("isAuthorizedToWrite");function h(){c("toggle")}Fs(()=>t(),()=>{K(a,t())}),Us(),dt();var d=kA(),m=ue(d);PA(m,{$$events:{toggle:h}});var g=le(m,4),I=ue(g);{var S=C=>{var R=CA();se(C,R)};ut(I,C=>{r()&&!L(a)&&C(S)})}se(n,d),it(),i()}var DA=fe('<span class="not-authorized-message svelte-12buoxc">Unauthorized user</span>'),VA=fe('<div class="user-profile svelte-12buoxc"><img alt="Profile" class="svelte-12buoxc"/> <span class="svelte-12buoxc"> </span> <!></div> <div class="nav-links-wrapper svelte-12buoxc"><div class="nav-links svelte-12buoxc"><a href="/" class="svelte-12buoxc">Home</a></div></div> <div class="sidenav-footer svelte-12buoxc"><!></div>',1),OA=fe('<div><button class="close-button svelte-12buoxc">&times;</button> <!></div>');function MA(n,e){st(e,!1);const t=()=>jt(h,"$isAuthorizedToWriteStore",s),r=()=>jt(xo,"$user",s),[s,i]=Bs(),a=we();let c=It(e,"isOpen",8,!1);const l=po(),h=bs("isAuthorizedToWrite");function d(){l("close")}Fs(()=>t(),()=>{K(a,t())}),Us(),dt();var m=OA();let g;var I=ue(m),S=le(I,2);{var C=R=>{var O=VA(),x=Fn(O),V=ue(x),H=le(V,2),W=ue(H),U=le(H,2);{var E=w=>{var T=DA();se(w,T)};ut(U,w=>{L(a)||w(E)})}var _=le(x,4),v=ue(_);Zn(v,{label:"Sign out",onClick:()=>uI(_u)}),Gn(()=>{vi(V,"src",(r(),je(()=>r().photoURL))),ho(W,(r(),je(()=>r().displayName)))}),se(R,O)};ut(S,R=>{r()&&R(C)})}Gn(()=>g=Tc(m,1,"sidenav svelte-12buoxc",null,g,{open:c()})),yn("click",I,d),se(n,m),it(),i()}var LA=fe('<form class="svelte-7mtrh0"><h2 class="svelte-7mtrh0">Add a new place</h2> <input type="text" placeholder="Place name" required class="svelte-7mtrh0"/> <input type="url" placeholder="Website" class="svelte-7mtrh0"/> <input type="url" placeholder="Image URL" class="svelte-7mtrh0"/> <!></form>');function xA(n,e){st(e,!1);let t=we(""),r=we(""),s=we("");async function i(){try{const m=await yw(Sp(Zi,"places"),{name:L(t),website:L(r),image:L(s)});console.log("Document written with ID: ",m.id),K(t,""),K(r,""),K(s,"")}catch(m){console.error("Error adding document: ",m)}}dt();var a=LA(),c=le(ue(a),2),l=le(c,2),h=le(l,2),d=le(h,2);Zn(d,{label:"Add Place",type:"submit"}),vr(c,()=>L(t),m=>K(t,m)),vr(l,()=>L(r),m=>K(r,m)),vr(h,()=>L(s),m=>K(s,m)),yn("submit",a,Kf(i)),se(n,a),it()}var FA=fe('<div class="card svelte-1udyrqm"><!></div>');function pm(n,e){var t=FA(),r=ue(t);Ec(r,e,"default",{}),se(n,t)}var UA=fe('<div class="dropdown-menu svelte-1222uzl"><!> <!></div>'),BA=fe('<div class="see-more-menu svelte-1222uzl"><button class="see-more-button svelte-1222uzl"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="svelte-1222uzl"><path d="M12 10C10.9 10 10 10.9 10 12C10 13.1 10.9 14 12 14C13.1 14 14 13.1 14 12C14 10.9 13.1 10 12 10ZM19 10C17.9 10 17 10.9 17 12C17 13.1 17.9 14 19 14C20.1 14 21 13.1 21 12C21 10.9 20.1 10 19 10ZM5 10C3.9 10 3 10.9 3 12C3 13.1 3.9 14 5 14C6.1 14 7 13.1 7 12C7 10.9 6.1 10 5 10Z" fill="var(--text-color)"></path></svg></button> <!></div>');function $A(n,e){st(e,!1);let t=It(e,"place",8),r=It(e,"isAuthorizedToWrite",8,!1);const s=po();let i=we(!1);function a(S){S.stopPropagation(),K(i,!L(i))}function c(){s("edit",t()),K(i,!1)}function l(){s("delete",t().id),K(i,!1)}function h(S){L(i)&&!S.target.closest(".see-more-menu")&&K(i,!1)}dt();var d=BA();yn("click",Ca,h);var m=ue(d),g=le(m,2);{var I=S=>{var C=UA(),R=ue(C);Zn(R,{label:"Edit",onClick:c});var O=le(R,2);Zn(O,{label:"Delete",onClick:l}),se(S,C)};ut(g,S=>{L(i)&&r()&&S(I)})}yn("click",m,a),se(n,d),it()}var jA=fe('<form class="svelte-136zmjt"><h2 class="svelte-136zmjt">Edit Place</h2> <input type="text" placeholder="Place name" required class="svelte-136zmjt"/> <input type="url" placeholder="Website" class="svelte-136zmjt"/> <input type="url" placeholder="Image URL" class="svelte-136zmjt"/> <div class="actions svelte-136zmjt"><!> <!></div></form>');function qA(n,e){st(e,!1);let t=It(e,"place",8),r=It(e,"onSave",8,()=>{}),s=It(e,"onCancel",8,()=>{}),i=we(t().name),a=we(t().website),c=we(t().image);async function l(){try{const R=eu(Zi,"places",t().id);await gw(R,{name:L(i),website:L(a),image:L(c)}),console.log("Document successfully updated!"),r()()}catch(R){console.error("Error updating document: ",R)}}dt();var h=jA(),d=le(ue(h),2),m=le(d,2),g=le(m,2),I=le(g,2),S=ue(I);Zn(S,{label:"Save",type:"submit"});var C=le(S,2);Zn(C,{label:"Cancel",get onClick(){return s()}}),vr(d,()=>L(i),R=>K(i,R)),vr(m,()=>L(a),R=>K(a,R)),vr(g,()=>L(c),R=>K(c,R)),yn("submit",h,Kf(l)),se(n,h),it()}var zA=fe('<a target="_blank" rel="noreferrer" class="image-wrapper svelte-13geuu4"><img class="svelte-13geuu4"/> <!></a>'),HA=fe('<div class="place-header svelte-13geuu4"><h3 class="svelte-13geuu4"><b> </b></h3></div> <!>',1),WA=fe('<div class="svelte-13geuu4"><h2 class="svelte-13geuu4">Travel Wishlist</h2> <!></div>');function GA(n,e){st(e,!1);const t=()=>jt(a,"$isAuthorizedToWriteStore",r),[r,s]=Bs(),i=we(),a=bs("isAuthorizedToWrite");let c=we([]),l=we(null);Xf(()=>{const C=vw(Sp(Zi,"places"),R=>{K(c,R.docs.map(O=>({id:O.id,...O.data()})))});return()=>C()});async function h(C){try{await _w(eu(Zi,"places",C)),console.log("Document successfully deleted!")}catch(R){console.error("Error removing document: ",R)}}function d(C){K(l,C)}function m(){K(l,null)}function g(){K(l,null)}Fs(()=>t(),()=>{K(i,t())}),Us(),dt();var I=WA(),S=le(ue(I),2);Hf(S,1,()=>L(c),zf,(C,R)=>{pm(C,{children:(O,x)=>{var V=vc(),H=Fn(V);{var W=E=>{qA(E,{get place(){return L(l)},onSave:m,onCancel:g})},U=E=>{var _=HA(),v=Fn(_),w=ue(v),T=ue(w),A=ue(T),y=le(v,2);{var de=Ae=>{var et=zA(),pt=ue(et),mt=le(pt,2);{var Xt=ot=>{$A(ot,{get place(){return L(R)},get isAuthorizedToWrite(){return L(i)},$$events:{edit:Lt=>d(Lt.detail),delete:Lt=>h(Lt.detail)}})};ut(mt,ot=>{L(i)&&ot(Xt)})}Gn(()=>{vi(et,"href",(L(R),je(()=>L(R).website))),vi(pt,"src",(L(R),je(()=>L(R).image))),vi(pt,"alt",(L(R),je(()=>L(R).name)))}),se(Ae,et)};ut(y,Ae=>{L(R),je(()=>L(R).image)&&Ae(de)})}Gn(()=>ho(A,(L(R),je(()=>L(R).name)))),se(E,_)};ut(H,E=>{L(l),L(R),je(()=>L(l)&&L(l).id===L(R).id)?E(W):E(U,!1)})}se(O,V)},$$slots:{default:!0}})}),se(n,I),it(),s()}var KA=fe("<button> </button>"),QA=fe('<div class="tabs-container svelte-126ak3w"><div class="tab-headers svelte-126ak3w"></div> <div class="tab-content svelte-126ak3w"><!></div></div>');function XA(n,e){st(e,!1);let t=It(e,"activeTab",12,1);const r=fo(t());Sa("activeTab",r);let s=[],i=we([]);function a(g){return s=[...s,g],K(i,[...L(i),g]),s.length-1}Sa("registerTab",a);function c(g){t(g),r.set(t())}dt();var l=QA(),h=ue(l);Hf(h,5,()=>L(i),zf,(g,I,S)=>{var C=KA();let R;var O=ue(C);Gn(()=>{R=Tc(C,1,"tab-header svelte-126ak3w",null,R,{active:t()===S}),ho(O,L(I))}),yn("click",C,()=>c(S)),se(g,C)});var d=le(h,2),m=ue(d);Ec(m,e,"default",{}),se(n,l),it()}var JA=fe('<div class="tab-panel svelte-1vjnlah"><!></div>');function tf(n,e){st(e,!1);const t=()=>jt(c,"$activeTabStore",r),[r,s]=Bs(),i=we();let a=It(e,"title",8);const c=bs("activeTab"),l=bs("registerTab");let h=we();K(h,l(a())),Fs(()=>(t(),L(h)),()=>{K(i,t()===L(h))}),Us(),dt();var d=vc(),m=Fn(d);{var g=I=>{var S=JA(),C=ue(S);Ec(C,e,"default",{}),se(I,S)};ut(m,I=>{L(i)&&I(g)})}se(n,d),it(),s()}const YA="type.googleapis.com/google.protobuf.Int64Value",ZA="type.googleapis.com/google.protobuf.UInt64Value";function mm(n,e){const t={};for(const r in n)n.hasOwnProperty(r)&&(t[r]=e(n[r]));return t}function eo(n){if(n==null)return null;if(n instanceof Number&&(n=n.valueOf()),typeof n=="number"&&isFinite(n)||n===!0||n===!1||Object.prototype.toString.call(n)==="[object String]")return n;if(n instanceof Date)return n.toISOString();if(Array.isArray(n))return n.map(e=>eo(e));if(typeof n=="function"||typeof n=="object")return mm(n,e=>eo(e));throw new Error("Data cannot be encoded in JSON: "+n)}function Fr(n){if(n==null)return n;if(n["@type"])switch(n["@type"]){case YA:case ZA:{const e=Number(n.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+n);return e}default:throw new Error("Data cannot be decoded from JSON: "+n)}return Array.isArray(n)?n.map(e=>Fr(e)):typeof n=="function"||typeof n=="object"?mm(n,e=>Fr(e)):n}const yu="functions";const nf={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ge extends Mt{constructor(e,t,r){super(`${yu}/${e}`,t||""),this.details=r,Object.setPrototypeOf(this,Ge.prototype)}}function eb(n){if(n>=200&&n<300)return"ok";switch(n){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function to(n,e){let t=eb(n),r=t,s;try{const i=e&&e.error;if(i){const a=i.status;if(typeof a=="string"){if(!nf[a])return new Ge("internal","internal");t=nf[a],r=a}const c=i.message;typeof c=="string"&&(r=c),s=i.details,s!==void 0&&(s=Fr(s))}}catch{}return t==="ok"?null:new Ge(t,r,s)}class tb{constructor(e,t,r,s){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,nt(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=t.getImmediate({optional:!0}),this.messaging=r.getImmediate({optional:!0}),this.auth||t.get().then(i=>this.auth=i,()=>{}),this.messaging||r.get().then(i=>this.messaging=i,()=>{}),this.appCheck||s?.get().then(i=>this.appCheck=i,()=>{})}async getAuthToken(){if(this.auth)try{return(await this.auth.getToken())?.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){const t=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return t.error?null:t.token}return null}async getContext(e){const t=await this.getAuthToken(),r=await this.getMessagingToken(),s=await this.getAppCheckToken(e);return{authToken:t,messagingToken:r,appCheckToken:s}}}const ic="us-central1",nb=/^data: (.*?)(?:\n|$)/;function rb(n){let e=null;return{promise:new Promise((t,r)=>{e=setTimeout(()=>{r(new Ge("deadline-exceeded","deadline-exceeded"))},n)}),cancel:()=>{e&&clearTimeout(e)}}}class sb{constructor(e,t,r,s,i=ic,a=(...c)=>fetch(...c)){this.app=e,this.fetchImpl=a,this.emulatorOrigin=null,this.contextProvider=new tb(e,t,r,s),this.cancelAllRequests=new Promise(c=>{this.deleteService=()=>Promise.resolve(c())});try{const c=new URL(i);this.customDomain=c.origin+(c.pathname==="/"?"":c.pathname),this.region=ic}catch{this.customDomain=null,this.region=i}}_delete(){return this.deleteService()}_url(e){const t=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${t}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${t}.cloudfunctions.net/${e}`}}function ib(n,e,t){const r=Sn(e);n.emulatorOrigin=`http${r?"s":""}://${e}:${t}`,r&&(wc(n.emulatorOrigin+"/backends"),Ic("Functions",!0))}function ob(n,e,t){const r=s=>cb(n,e,s,{});return r.stream=(s,i)=>lb(n,e,s,i),r}function gm(n){return n.emulatorOrigin&&Sn(n.emulatorOrigin)?"include":void 0}async function ab(n,e,t,r,s){t["Content-Type"]="application/json";let i;try{i=await r(n,{method:"POST",body:JSON.stringify(e),headers:t,credentials:gm(s)})}catch{return{status:0,json:null}}let a=null;try{a=await i.json()}catch{}return{status:i.status,json:a}}async function _m(n,e){const t={},r=await n.contextProvider.getContext(e.limitedUseAppCheckTokens);return r.authToken&&(t.Authorization="Bearer "+r.authToken),r.messagingToken&&(t["Firebase-Instance-ID-Token"]=r.messagingToken),r.appCheckToken!==null&&(t["X-Firebase-AppCheck"]=r.appCheckToken),t}function cb(n,e,t,r){const s=n._url(e);return ub(n,s,t,r)}async function ub(n,e,t,r){t=eo(t);const s={data:t},i=await _m(n,r),a=r.timeout||7e4,c=rb(a),l=await Promise.race([ab(e,s,i,n.fetchImpl,n),c.promise,n.cancelAllRequests]);if(c.cancel(),!l)throw new Ge("cancelled","Firebase Functions instance was deleted.");const h=to(l.status,l.json);if(h)throw h;if(!l.json)throw new Ge("internal","Response is not valid JSON object.");let d=l.json.data;if(typeof d>"u"&&(d=l.json.result),typeof d>"u")throw new Ge("internal","Response is missing data field.");return{data:Fr(d)}}function lb(n,e,t,r){const s=n._url(e);return hb(n,s,t,r||{})}async function hb(n,e,t,r){t=eo(t);const s={data:t},i=await _m(n,r);i["Content-Type"]="application/json",i.Accept="text/event-stream";let a;try{a=await n.fetchImpl(e,{method:"POST",body:JSON.stringify(s),headers:i,signal:r?.signal,credentials:gm(n)})}catch(g){if(g instanceof Error&&g.name==="AbortError"){const S=new Ge("cancelled","Request was cancelled.");return{data:Promise.reject(S),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(S)}}}}}}const I=to(0,null);return{data:Promise.reject(I),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(I)}}}}}}let c,l;const h=new Promise((g,I)=>{c=g,l=I});r?.signal?.addEventListener("abort",()=>{const g=new Ge("cancelled","Request was cancelled.");l(g)});const d=a.body.getReader(),m=fb(d,c,l,r?.signal);return{stream:{[Symbol.asyncIterator](){const g=m.getReader();return{async next(){const{value:I,done:S}=await g.read();return{value:I,done:S}},async return(){return await g.cancel(),{done:!0,value:void 0}}}}},data:h}}function fb(n,e,t,r){const s=(a,c)=>{const l=a.match(nb);if(!l)return;const h=l[1];try{const d=JSON.parse(h);if("result"in d){e(Fr(d.result));return}if("message"in d){c.enqueue(Fr(d.message));return}if("error"in d){const m=to(0,d);c.error(m),t(m);return}}catch(d){if(d instanceof Ge){c.error(d),t(d);return}}},i=new TextDecoder;return new ReadableStream({start(a){let c="";return l();async function l(){if(r?.aborted){const h=new Ge("cancelled","Request was cancelled");return a.error(h),t(h),Promise.resolve()}try{const{value:h,done:d}=await n.read();if(d){c.trim()&&s(c.trim(),a),a.close();return}if(r?.aborted){const g=new Ge("cancelled","Request was cancelled");a.error(g),t(g),await n.cancel();return}c+=i.decode(h,{stream:!0});const m=c.split(`
`);c=m.pop()||"";for(const g of m)g.trim()&&s(g.trim(),a);return l()}catch(h){const d=h instanceof Ge?h:to(0,null);a.error(d),t(d)}}},cancel(){return n.cancel()}})}const rf="@firebase/functions",sf="0.13.1";const db="auth-internal",pb="app-check-internal",mb="messaging-internal";function gb(n){const e=(t,{instanceIdentifier:r})=>{const s=t.getProvider("app").getImmediate(),i=t.getProvider(db),a=t.getProvider(mb),c=t.getProvider(pb);return new sb(s,i,a,c,r)};Qn(new vn(yu,e,"PUBLIC").setMultipleInstances(!0)),At(rf,sf,n),At(rf,sf,"esm2020")}function _b(n=Sc(),e=ic){const r=go(ye(n),yu).getImmediate({identifier:e}),s=td("functions");return s&&yb(r,...s),r}function yb(n,e,t){ib(ye(n),e,t)}function vb(n,e,t){return ob(ye(n),e)}gb();var Eb=fe('<div class="loading-screen svelte-1n46o8q"><img src="./assets/loading_image.png" alt="Loading..." class="loading-image svelte-1n46o8q"/></div>'),Tb=fe("<!> <!>",1),wb=fe('<!> <!> <div class="container svelte-1n46o8q"><!></div>',1),Ib=fe("<main><!></main>");function Ab(n,e){st(e,!1);const t=()=>jt(dm,"$authLoading",i),r=()=>jt(xo,"$user",i),s=()=>jt(d,"$isAuthorizedToWriteStore",i),[i,a]=Bs(),c=_b(gu),l=vb(c,"checkAuthorization"),h=1e3,d=fo(!1);let m=we(!1),g=we(!1);Sa("isAuthorizedToWrite",d),Xf(()=>{setTimeout(()=>{},h)});function I(){K(g,!L(g))}Fs(()=>(t(),r()),()=>{!t()&&r()?l().then(V=>{d.set(V.data.status==="authorized"),K(m,!0)}).catch(V=>{console.error("Error checking authorization:",V),d.set(!1),K(m,!0)}):!t()&&!r()?(d.set(!1),K(m,!0)):(d.set(!1),K(m,!1))}),Us(),dt();var S=Ib();let C;var R=ue(S);{var O=V=>{var H=Eb();se(V,H)},x=V=>{var H=vc(),W=Fn(H);{var U=_=>{var v=wb(),w=Fn(v);NA(w,{$$events:{toggle:I}});var T=le(w,2);MA(T,{get isOpen(){return L(g)},$$events:{close:I}});var A=le(T,2),y=ue(A);XA(y,{children:(de,Ae)=>{var et=Tb(),pt=Fn(et);{var mt=ot=>{tf(ot,{title:"Add Place",children:(Lt,Fo)=>{pm(Lt,{children:(Js,Kr)=>{xA(Js,{})},$$slots:{default:!0}})},$$slots:{default:!0}})};ut(pt,ot=>{L(m)&&s()&&ot(mt)})}var Xt=le(pt,2);tf(Xt,{title:"Travel Wishlist",children:(ot,Lt)=>{GA(ot,{})},$$slots:{default:!0}}),se(de,et)},$$slots:{default:!0}}),se(_,v)},E=_=>{SA(_,{})};ut(W,_=>{r()?_(U):_(E,!1)},!0)}se(V,H)};ut(R,V=>{t()||!L(m)?V(O):V(x,!1)})}Gn(()=>C=Tc(S,1,"svelte-1n46o8q",null,C,{"fullscreen-main":t()||!L(m)})),se(n,S),it(),a()}r_(Ab,{target:document.getElementById("app")});
