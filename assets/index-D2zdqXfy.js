(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();const ef=!1;var Za=Array.isArray,Um=Array.prototype.indexOf,ec=Array.from,tf=Object.defineProperty,ur=Object.getOwnPropertyDescriptor,nf=Object.getOwnPropertyDescriptors,Bm=Object.prototype,$m=Array.prototype,tc=Object.getPrototypeOf,fl=Object.isExtensible;const lr=()=>{};function jm(n){return n()}function _a(n){for(var e=0;e<n.length;e++)n[e]()}function rf(){var n,e,t=new Promise((r,s)=>{n=r,e=s});return{promise:t,resolve:n,reject:e}}const Me=2,nc=4,Ji=8,$t=16,jt=32,Gn=64,Yi=128,lt=512,Se=1024,Qe=2048,Ct=4096,tt=8192,sn=16384,rc=32768,Tr=65536,dl=1<<17,sf=1<<18,Lr=1<<19,of=1<<20,Ts=32768,ya=1<<21,sc=1<<22,on=1<<23,hr=Symbol("$state"),qm=Symbol("legacy props"),zm=Symbol(""),ar=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function ic(n){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function Hm(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function Wm(n){throw new Error("https://svelte.dev/e/effect_in_teardown")}function Gm(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Km(n){throw new Error("https://svelte.dev/e/effect_orphan")}function Qm(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Xm(n){throw new Error("https://svelte.dev/e/props_invalid_value")}function Jm(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Ym(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Zm(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function eg(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const tg=1,ng=2,rg=16,sg=2,ig=4,og=8,ag=1,cg=2,De=Symbol(),ug="http://www.w3.org/1999/xhtml";function lg(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}let hg=!1;function af(n){return n===this.v}function cf(n,e){return n!=n?e==e:n!==e||n!==null&&typeof n=="object"||typeof n=="function"}function uf(n){return!cf(n,this.v)}let xr=!1,fg=!1;function dg(){xr=!0}let re=null;function Ir(n){re=n}function oc(n){return lf().get(n)}function pg(n,e){return lf().set(n,e),e}function qt(n,e=!1,t){re={p:re,i:!1,c:null,e:null,s:n,x:null,l:xr&&!e?{s:null,u:null,$:[]}:null}}function zt(n){var e=re,t=e.e;if(t!==null){e.e=null;for(var r of t)bf(r)}return e.i=!0,re=e.p,{}}function Ds(){return!xr||re!==null&&re.l===null}function lf(n){return re===null&&ic(),re.c??=new Map(mg(re)||void 0)}function mg(n){let e=n.p;for(;e!==null;){const t=e.c;if(t!==null)return t;e=e.p}return null}let Nn=[];function hf(){var n=Nn;Nn=[],_a(n)}function Zi(n){if(Nn.length===0&&!ds){var e=Nn;queueMicrotask(()=>{e===Nn&&hf()})}Nn.push(n)}function gg(){for(;Nn.length>0;)hf()}function ff(n){var e=J;if(e===null)return X.f|=on,n;if((e.f&rc)===0){if((e.f&Yi)===0)throw n;e.b.error(n)}else wr(n,e)}function wr(n,e){for(;e!==null;){if((e.f&Yi)!==0)try{e.b.error(n);return}catch(t){n=t}e=e.parent}throw n}const ii=new Set;let ie=null,di=null,Ze=null,mt=[],eo=null,va=!1,ds=!1;class gt{committed=!1;current=new Map;previous=new Map;#e=new Set;#t=new Set;#n=0;#r=0;#c=null;#o=[];#a=[];skipped_effects=new Set;is_fork=!1;process(e){mt=[],di=null,this.apply();var t={parent:null,effect:null,effects:[],render_effects:[],block_effects:[]};for(const r of e)this.#s(r,t);this.is_fork||this.#u(),this.#r>0||this.is_fork?(this.#i(t.effects),this.#i(t.render_effects),this.#i(t.block_effects)):(di=this,ie=null,pl(t.render_effects),pl(t.effects),di=null,this.#c?.resolve()),Ze=null}#s(e,t){e.f^=Se;for(var r=e.first;r!==null;){var s=r.f,i=(s&(jt|Gn))!==0,a=i&&(s&Se)!==0,c=a||(s&tt)!==0||this.skipped_effects.has(r);if((r.f&Yi)!==0&&r.b?.is_pending()&&(t={parent:t,effect:r,effects:[],render_effects:[],block_effects:[]}),!c&&r.fn!==null){i?r.f^=Se:(s&nc)!==0?t.effects.push(r):Fr(r)&&((r.f&$t)!==0&&t.block_effects.push(r),Rr(r));var l=r.first;if(l!==null){r=l;continue}}var h=r.parent;for(r=r.next;r===null&&h!==null;)h===t.effect&&(this.#i(t.effects),this.#i(t.render_effects),this.#i(t.block_effects),t=t.parent),r=h.next,h=h.parent}}#i(e){for(const t of e)((t.f&Qe)!==0?this.#o:this.#a).push(t),Pe(t,Se)}capture(e,t){this.previous.has(e)||this.previous.set(e,t),(e.f&on)===0&&(this.current.set(e,e.v),Ze?.set(e,e.v))}activate(){ie=this,this.apply()}deactivate(){ie=null,Ze=null}flush(){if(this.activate(),mt.length>0){if(df(),ie!==null&&ie!==this)return}else this.#n===0&&this.process([]);this.deactivate()}discard(){for(const e of this.#t)e(this);this.#t.clear()}#u(){if(this.#r===0){for(const e of this.#e)e();this.#e.clear()}this.#n===0&&this.#l()}#l(){if(ii.size>1){this.previous.clear();var e=Ze,t=!0,r={parent:null,effect:null,effects:[],render_effects:[],block_effects:[]};for(const s of ii){if(s===this){t=!1;continue}const i=[];for(const[c,l]of this.current){if(s.current.has(c))if(t&&l!==s.current.get(c))s.current.set(c,l);else continue;i.push(c)}if(i.length===0)continue;const a=[...s.current.keys()].filter(c=>!this.current.has(c));if(a.length>0){const c=new Set,l=new Map;for(const h of i)pf(h,a,c,l);if(mt.length>0){ie=s,s.apply();for(const h of mt)s.#s(h,r);mt=[],s.deactivate()}}}ie=null,Ze=e}this.committed=!0,ii.delete(this)}increment(e){this.#n+=1,e&&(this.#r+=1)}decrement(e){this.#n-=1,e&&(this.#r-=1),this.revive()}revive(){for(const e of this.#o)Pe(e,Qe),Un(e);for(const e of this.#a)Pe(e,Ct),Un(e);this.#o=[],this.#a=[],this.flush()}oncommit(e){this.#e.add(e)}ondiscard(e){this.#t.add(e)}settled(){return(this.#c??=rf()).promise}static ensure(){if(ie===null){const e=ie=new gt;ii.add(ie),ds||gt.enqueue(()=>{ie===e&&e.flush()})}return ie}static enqueue(e){Zi(e)}apply(){}}function _g(n){var e=ds;ds=!0;try{for(var t;;){if(gg(),mt.length===0&&(ie?.flush(),mt.length===0))return eo=null,t;df()}}finally{ds=e}}function df(){var n=On;va=!0;try{var e=0;for(_l(!0);mt.length>0;){var t=gt.ensure();if(e++>1e3){var r,s;yg()}t.process(mt),an.clear()}}finally{va=!1,_l(n),eo=null}}function yg(){try{Qm()}catch(n){wr(n,eo)}}let Dt=null;function pl(n){var e=n.length;if(e!==0){for(var t=0;t<e;){var r=n[t++];if((r.f&(sn|tt))===0&&Fr(r)&&(Dt=new Set,Rr(r),r.deps===null&&r.first===null&&r.nodes_start===null&&(r.teardown===null&&r.ac===null?Pf(r):r.fn=null),Dt?.size>0)){an.clear();for(const s of Dt){if((s.f&(sn|tt))!==0)continue;const i=[s];let a=s.parent;for(;a!==null;)Dt.has(a)&&(Dt.delete(a),i.push(a)),a=a.parent;for(let c=i.length-1;c>=0;c--){const l=i[c];(l.f&(sn|tt))===0&&Rr(l)}}Dt.clear()}}Dt=null}}function pf(n,e,t,r){if(!t.has(n)&&(t.add(n),n.reactions!==null))for(const s of n.reactions){const i=s.f;(i&Me)!==0?pf(s,e,t,r):(i&(sc|$t))!==0&&(i&Qe)===0&&mf(s,e,r)&&(Pe(s,Qe),Un(s))}}function mf(n,e,t){const r=t.get(n);if(r!==void 0)return r;if(n.deps!==null)for(const s of n.deps){if(e.includes(s))return!0;if((s.f&Me)!==0&&mf(s,e,t))return t.set(s,!0),!0}return t.set(n,!1),!1}function Un(n){for(var e=eo=n;e.parent!==null;){e=e.parent;var t=e.f;if(va&&e===J&&(t&$t)!==0&&(t&sf)===0)return;if((t&(Gn|jt))!==0){if((t&Se)===0)return;e.f^=Se}}mt.push(e)}function vg(n){let e=0,t=Bn(0),r;return()=>{no()&&(F(t),io(()=>(e===0&&(r=He(()=>n(()=>ps(t)))),e+=1,()=>{Zi(()=>{e-=1,e===0&&(r?.(),r=void 0,ps(t))})})))}}var Eg=Tr|Lr|Yi;function Tg(n,e,t){new Ig(n,e,t)}class Ig{parent;#e=!1;#t;#n=null;#r;#c;#o;#a=null;#s=null;#i=null;#u=null;#l=null;#d=0;#h=0;#p=!1;#f=null;#v=vg(()=>(this.#f=Bn(this.#d),()=>{this.#f=null}));constructor(e,t,r){this.#t=e,this.#r=t,this.#c=r,this.parent=J.b,this.#e=!!this.#r.pending,this.#o=hc(()=>{J.b=this;{var s=this.#_();try{this.#a=ot(()=>r(s))}catch(i){this.error(i)}this.#h>0?this.#g():this.#e=!1}return()=>{this.#l?.remove()}},Eg)}#E(){try{this.#a=ot(()=>this.#c(this.#t))}catch(e){this.error(e)}this.#e=!1}#T(){const e=this.#r.pending;e&&(this.#s=ot(()=>e(this.#t)),gt.enqueue(()=>{var t=this.#_();this.#a=this.#m(()=>(gt.ensure(),ot(()=>this.#c(t)))),this.#h>0?this.#g():(dr(this.#s,()=>{this.#s=null}),this.#e=!1)}))}#_(){var e=this.#t;return this.#e&&(this.#l=Ar(),this.#t.before(this.#l),e=this.#l),e}is_pending(){return this.#e||!!this.parent&&this.parent.is_pending()}has_pending_snippet(){return!!this.#r.pending}#m(e){var t=J,r=X,s=re;bt(this.#o),Ge(this.#o),Ir(this.#o.ctx);try{return e()}catch(i){return ff(i),null}finally{bt(t),Ge(r),Ir(s)}}#g(){const e=this.#r.pending;this.#a!==null&&(this.#u=document.createDocumentFragment(),this.#u.append(this.#l),Nf(this.#a,this.#u)),this.#s===null&&(this.#s=ot(()=>e(this.#t)))}#y(e){if(!this.has_pending_snippet()){this.parent&&this.parent.#y(e);return}this.#h+=e,this.#h===0&&(this.#e=!1,this.#s&&dr(this.#s,()=>{this.#s=null}),this.#u&&(this.#t.before(this.#u),this.#u=null))}update_pending_count(e){this.#y(e),this.#d+=e,this.#f&&Is(this.#f,this.#d)}get_effect_pending(){return this.#v(),F(this.#f)}error(e){var t=this.#r.onerror;let r=this.#r.failed;if(this.#p||!t&&!r)throw e;this.#a&&(qe(this.#a),this.#a=null),this.#s&&(qe(this.#s),this.#s=null),this.#i&&(qe(this.#i),this.#i=null);var s=!1,i=!1;const a=()=>{if(s){lg();return}s=!0,i&&eg(),gt.ensure(),this.#d=0,this.#i!==null&&dr(this.#i,()=>{this.#i=null}),this.#e=this.has_pending_snippet(),this.#a=this.#m(()=>(this.#p=!1,ot(()=>this.#c(this.#t)))),this.#h>0?this.#g():this.#e=!1};var c=X;try{Ge(null),i=!0,t?.(e,a),i=!1}catch(l){wr(l,this.#o&&this.#o.parent)}finally{Ge(c)}r&&Zi(()=>{this.#i=this.#m(()=>{gt.ensure(),this.#p=!0;try{return ot(()=>{r(this.#t,()=>e,()=>a)})}catch(l){return wr(l,this.#o.parent),null}finally{this.#p=!1}})})}}function wg(n,e,t,r){const s=Ds()?ac:cc;if(t.length===0&&n.length===0){r(e.map(s));return}var i=ie,a=J,c=Ag();function l(){Promise.all(t.map(h=>bg(h))).then(h=>{c();try{r([...e.map(s),...h])}catch(d){(a.f&sn)===0&&wr(d,a)}i?.deactivate(),bi()}).catch(h=>{wr(h,a)})}n.length>0?Promise.all(n).then(()=>{c();try{return l()}finally{i?.deactivate(),bi()}}):l()}function Ag(){var n=J,e=X,t=re,r=ie;return function(i=!0){bt(n),Ge(e),Ir(t),i&&r?.activate()}}function bi(){bt(null),Ge(null),Ir(null)}function ac(n){var e=Me|Qe,t=X!==null&&(X.f&Me)!==0?X:null;return J!==null&&(J.f|=Lr),{ctx:re,deps:null,effects:null,equals:af,f:e,fn:n,reactions:null,rv:0,v:De,wv:0,parent:t??J,ac:null}}function bg(n,e){let t=J;t===null&&Hm();var r=t.b,s=void 0,i=Bn(De),a=!X,c=new Map;return Mg(()=>{var l=rf();s=l.promise;try{Promise.resolve(n()).then(l.resolve,l.reject).then(()=>{h===ie&&h.committed&&h.deactivate(),bi()})}catch(g){l.reject(g),bi()}var h=ie;if(a){var d=!r.is_pending();r.update_pending_count(1),h.increment(d),c.get(h)?.reject(ar),c.delete(h),c.set(h,l)}const m=(g,I=void 0)=>{if(h.activate(),I)I!==ar&&(i.f|=on,Is(i,I));else{(i.f&on)!==0&&(i.f^=on),Is(i,g);for(const[P,C]of c){if(c.delete(P),P===h)break;C.reject(ar)}}a&&(r.update_pending_count(-1),h.decrement(d))};l.promise.then(m,g=>m(null,g||"unknown"))}),lc(()=>{for(const l of c.values())l.reject(ar)}),new Promise(l=>{function h(d){function m(){d===s?l(i):h(s)}d.then(m,m)}h(s)})}function cc(n){const e=ac(n);return e.equals=uf,e}function gf(n){var e=n.effects;if(e!==null){n.effects=null;for(var t=0;t<e.length;t+=1)qe(e[t])}}function Rg(n){for(var e=n.parent;e!==null;){if((e.f&Me)===0)return e;e=e.parent}return null}function uc(n){var e,t=J;bt(Rg(n));try{n.f&=~Ts,gf(n),e=Mf(n)}finally{bt(t)}return e}function _f(n){var e=uc(n);if(n.equals(e)||(n.v=e,n.wv=Vf()),!Kn)if(Ze!==null)no()&&Ze.set(n,n.v);else{var t=(n.f&lt)===0?Ct:Se;Pe(n,t)}}let Ea=new Set;const an=new Map;let yf=!1;function Bn(n,e){var t={f:0,v:n,reactions:null,equals:af,rv:0,wv:0};return t}function Yt(n,e){const t=Bn(n);return Fg(t),t}function je(n,e=!1,t=!0){const r=Bn(n);return e||(r.equals=uf),xr&&t&&re!==null&&re.l!==null&&(re.l.s??=[]).push(r),r}function ee(n,e,t=!1){X!==null&&(!_t||(X.f&dl)!==0)&&Ds()&&(X.f&(Me|$t|sc|dl))!==0&&!Lt?.includes(n)&&Zm();let r=t?cr(e):e;return Is(n,r)}function Is(n,e){if(!n.equals(e)){var t=n.v;Kn?an.set(n,e):an.set(n,t),n.v=e;var r=gt.ensure();r.capture(n,t),(n.f&Me)!==0&&((n.f&Qe)!==0&&uc(n),Pe(n,(n.f&lt)!==0?Se:Ct)),n.wv=Vf(),vf(n,Qe),Ds()&&J!==null&&(J.f&Se)!==0&&(J.f&(jt|Gn))===0&&(nt===null?Ug([n]):nt.push(n)),!r.is_fork&&Ea.size>0&&!yf&&Sg()}return e}function Sg(){yf=!1;const n=Array.from(Ea);for(const e of n)(e.f&Se)!==0&&Pe(e,Ct),Fr(e)&&Rr(e);Ea.clear()}function ps(n){ee(n,n.v+1)}function vf(n,e){var t=n.reactions;if(t!==null)for(var r=Ds(),s=t.length,i=0;i<s;i++){var a=t[i],c=a.f;if(!(!r&&a===J)){var l=(c&Qe)===0;if(l&&Pe(a,e),(c&Me)!==0){var h=a;Ze?.delete(h),(c&Ts)===0&&(c&lt&&(a.f|=Ts),vf(h,Ct))}else l&&((c&$t)!==0&&Dt!==null&&Dt.add(a),Un(a))}}}function cr(n){if(typeof n!="object"||n===null||hr in n)return n;const e=tc(n);if(e!==Bm&&e!==$m)return n;var t=new Map,r=Za(n),s=Yt(0),i=Mn,a=c=>{if(Mn===i)return c();var l=X,h=Mn;Ge(null),vl(i);var d=c();return Ge(l),vl(h),d};return r&&t.set("length",Yt(n.length)),new Proxy(n,{defineProperty(c,l,h){(!("value"in h)||h.configurable===!1||h.enumerable===!1||h.writable===!1)&&Jm();var d=t.get(l);return d===void 0?d=a(()=>{var m=Yt(h.value);return t.set(l,m),m}):ee(d,h.value,!0),!0},deleteProperty(c,l){var h=t.get(l);if(h===void 0){if(l in c){const d=a(()=>Yt(De));t.set(l,d),ps(s)}}else ee(h,De),ps(s);return!0},get(c,l,h){if(l===hr)return n;var d=t.get(l),m=l in c;if(d===void 0&&(!m||ur(c,l)?.writable)&&(d=a(()=>{var I=cr(m?c[l]:De),P=Yt(I);return P}),t.set(l,d)),d!==void 0){var g=F(d);return g===De?void 0:g}return Reflect.get(c,l,h)},getOwnPropertyDescriptor(c,l){var h=Reflect.getOwnPropertyDescriptor(c,l);if(h&&"value"in h){var d=t.get(l);d&&(h.value=F(d))}else if(h===void 0){var m=t.get(l),g=m?.v;if(m!==void 0&&g!==De)return{enumerable:!0,configurable:!0,value:g,writable:!0}}return h},has(c,l){if(l===hr)return!0;var h=t.get(l),d=h!==void 0&&h.v!==De||Reflect.has(c,l);if(h!==void 0||J!==null&&(!d||ur(c,l)?.writable)){h===void 0&&(h=a(()=>{var g=d?cr(c[l]):De,I=Yt(g);return I}),t.set(l,h));var m=F(h);if(m===De)return!1}return d},set(c,l,h,d){var m=t.get(l),g=l in c;if(r&&l==="length")for(var I=h;I<m.v;I+=1){var P=t.get(I+"");P!==void 0?ee(P,De):I in c&&(P=a(()=>Yt(De)),t.set(I+"",P))}if(m===void 0)(!g||ur(c,l)?.writable)&&(m=a(()=>Yt(void 0)),ee(m,cr(h)),t.set(l,m));else{g=m.v!==De;var C=a(()=>cr(h));ee(m,C)}var S=Reflect.getOwnPropertyDescriptor(c,l);if(S?.set&&S.set.call(d,h),!g){if(r&&typeof l=="string"){var L=t.get("length"),O=Number(l);Number.isInteger(O)&&O>=L.v&&ee(L,O+1)}ps(s)}return!0},ownKeys(c){F(s);var l=Reflect.ownKeys(c).filter(m=>{var g=t.get(m);return g===void 0||g.v!==De});for(var[h,d]of t)d.v!==De&&!(h in c)&&l.push(h);return l},setPrototypeOf(){Ym()}})}var ml,Ef,Tf,If;function Pg(){if(ml===void 0){ml=window,Ef=/Firefox/.test(navigator.userAgent);var n=Element.prototype,e=Node.prototype,t=Text.prototype;Tf=ur(e,"firstChild").get,If=ur(e,"nextSibling").get,fl(n)&&(n.__click=void 0,n.__className=void 0,n.__attributes=null,n.__style=void 0,n.__e=void 0),fl(t)&&(t.__t=void 0)}}function Ar(n=""){return document.createTextNode(n)}function Ri(n){return Tf.call(n)}function Vs(n){return If.call(n)}function ye(n,e){return Ri(n)}function fr(n,e=!1){{var t=Ri(n);return t instanceof Comment&&t.data===""?Vs(t):t}}function he(n,e=1,t=!1){let r=n;for(;e--;)r=Vs(r);return r}function Cg(n){n.textContent=""}function wf(){return!1}let gl=!1;function kg(){gl||(gl=!0,document.addEventListener("reset",n=>{Promise.resolve().then(()=>{if(!n.defaultPrevented)for(const e of n.target.elements)e.__on_r?.()})},{capture:!0}))}function to(n){var e=X,t=J;Ge(null),bt(null);try{return n()}finally{Ge(e),bt(t)}}function Ng(n,e,t,r=t){n.addEventListener(e,()=>to(t));const s=n.__on_r;s?n.__on_r=()=>{s(),r(!0)}:n.__on_r=()=>r(!0),kg()}function Af(n){J===null&&(X===null&&Km(),Gm()),Kn&&Wm()}function Dg(n,e){var t=e.last;t===null?e.last=e.first=n:(t.next=n,n.prev=t,e.last=n)}function Ht(n,e,t,r=!0){var s=J;s!==null&&(s.f&tt)!==0&&(n|=tt);var i={ctx:re,deps:null,nodes_start:null,nodes_end:null,f:n|Qe|lt,first:null,fn:e,last:null,next:null,parent:s,b:s&&s.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(t)try{Rr(i),i.f|=rc}catch(l){throw qe(i),l}else e!==null&&Un(i);if(r){var a=i;if(t&&a.deps===null&&a.teardown===null&&a.nodes_start===null&&a.first===a.last&&(a.f&Lr)===0&&(a=a.first,(n&$t)!==0&&(n&Tr)!==0&&a!==null&&(a.f|=Tr)),a!==null&&(a.parent=s,s!==null&&Dg(a,s),X!==null&&(X.f&Me)!==0&&(n&Gn)===0)){var c=X;(c.effects??=[]).push(a)}}return i}function no(){return X!==null&&!_t}function lc(n){const e=Ht(Ji,null,!1);return Pe(e,Se),e.teardown=n,e}function Ta(n){Af();var e=J.f,t=!X&&(e&jt)!==0&&(e&rc)===0;if(t){var r=re;(r.e??=[]).push(n)}else return bf(n)}function bf(n){return Ht(nc|of,n,!1)}function Vg(n){return Af(),Ht(Ji|of,n,!0)}function Og(n){gt.ensure();const e=Ht(Gn|Lr,n,!0);return(t={})=>new Promise(r=>{t.outro?dr(e,()=>{qe(e),r(void 0)}):(qe(e),r(void 0))})}function ro(n,e){var t=re,r={effect:null,ran:!1,deps:n};t.l.$.push(r),r.effect=io(()=>{n(),!r.ran&&(r.ran=!0,He(e))})}function so(){var n=re;io(()=>{for(var e of n.l.$){e.deps();var t=e.effect;(t.f&Se)!==0&&Pe(t,Ct),Fr(t)&&Rr(t),e.ran=!1}})}function Mg(n){return Ht(sc|Lr,n,!0)}function io(n,e=0){return Ht(Ji|e,n,!0)}function br(n,e=[],t=[],r=[],s=!1){wg(r,e,t,i=>{Ht(s?nc:Ji,()=>n(...i.map(F)),!0)})}function hc(n,e=0){var t=Ht($t|e,n,!0);return t}function ot(n,e=!0){return Ht(jt|Lr,n,!0,e)}function Rf(n){var e=n.teardown;if(e!==null){const t=Kn,r=X;yl(!0),Ge(null);try{e.call(null)}finally{yl(t),Ge(r)}}}function Sf(n,e=!1){var t=n.first;for(n.first=n.last=null;t!==null;){const s=t.ac;s!==null&&to(()=>{s.abort(ar)});var r=t.next;(t.f&Gn)!==0?t.parent=null:qe(t,e),t=r}}function Lg(n){for(var e=n.first;e!==null;){var t=e.next;(e.f&jt)===0&&qe(e),e=t}}function qe(n,e=!0){var t=!1;(e||(n.f&sf)!==0)&&n.nodes_start!==null&&n.nodes_end!==null&&(xg(n.nodes_start,n.nodes_end),t=!0),Sf(n,e&&!t),Si(n,0),Pe(n,sn);var r=n.transitions;if(r!==null)for(const i of r)i.stop();Rf(n);var s=n.parent;s!==null&&s.first!==null&&Pf(n),n.next=n.prev=n.teardown=n.ctx=n.deps=n.fn=n.nodes_start=n.nodes_end=n.ac=null}function xg(n,e){for(;n!==null;){var t=n===e?null:Vs(n);n.remove(),n=t}}function Pf(n){var e=n.parent,t=n.prev,r=n.next;t!==null&&(t.next=r),r!==null&&(r.prev=t),e!==null&&(e.first===n&&(e.first=r),e.last===n&&(e.last=t))}function dr(n,e,t=!0){var r=[];fc(n,r,!0),Cf(r,()=>{t&&qe(n),e&&e()})}function Cf(n,e){var t=n.length;if(t>0){var r=()=>--t||e();for(var s of n)s.out(r)}else e()}function fc(n,e,t){if((n.f&tt)===0){if(n.f^=tt,n.transitions!==null)for(const a of n.transitions)(a.is_global||t)&&e.push(a);for(var r=n.first;r!==null;){var s=r.next,i=(r.f&Tr)!==0||(r.f&jt)!==0&&(n.f&$t)!==0;fc(r,e,i?t:!1),r=s}}}function dc(n){kf(n,!0)}function kf(n,e){if((n.f&tt)!==0){n.f^=tt,(n.f&Se)===0&&(Pe(n,Qe),Un(n));for(var t=n.first;t!==null;){var r=t.next,s=(t.f&Tr)!==0||(t.f&jt)!==0;kf(t,s?e:!1),t=r}if(n.transitions!==null)for(const i of n.transitions)(i.is_global||e)&&i.in()}}function Nf(n,e){for(var t=n.nodes_start,r=n.nodes_end;t!==null;){var s=t===r?null:Vs(t);e.append(t),t=s}}let On=!1;function _l(n){On=n}let Kn=!1;function yl(n){Kn=n}let X=null,_t=!1;function Ge(n){X=n}let J=null;function bt(n){J=n}let Lt=null;function Fg(n){X!==null&&(Lt===null?Lt=[n]:Lt.push(n))}let $e=null,Ye=0,nt=null;function Ug(n){nt=n}let Df=1,ws=0,Mn=ws;function vl(n){Mn=n}function Vf(){return++Df}function Fr(n){var e=n.f;if((e&Qe)!==0)return!0;if(e&Me&&(n.f&=~Ts),(e&Ct)!==0){var t=n.deps;if(t!==null)for(var r=t.length,s=0;s<r;s++){var i=t[s];if(Fr(i)&&_f(i),i.wv>n.wv)return!0}(e&lt)!==0&&Ze===null&&Pe(n,Se)}return!1}function Of(n,e,t=!0){var r=n.reactions;if(r!==null&&!Lt?.includes(n))for(var s=0;s<r.length;s++){var i=r[s];(i.f&Me)!==0?Of(i,e,!1):e===i&&(t?Pe(i,Qe):(i.f&Se)!==0&&Pe(i,Ct),Un(i))}}function Mf(n){var e=$e,t=Ye,r=nt,s=X,i=Lt,a=re,c=_t,l=Mn,h=n.f;$e=null,Ye=0,nt=null,X=(h&(jt|Gn))===0?n:null,Lt=null,Ir(n.ctx),_t=!1,Mn=++ws,n.ac!==null&&(to(()=>{n.ac.abort(ar)}),n.ac=null);try{n.f|=ya;var d=n.fn,m=d(),g=n.deps;if($e!==null){var I;if(Si(n,Ye),g!==null&&Ye>0)for(g.length=Ye+$e.length,I=0;I<$e.length;I++)g[Ye+I]=$e[I];else n.deps=g=$e;if(On&&no()&&(n.f&lt)!==0)for(I=Ye;I<g.length;I++)(g[I].reactions??=[]).push(n)}else g!==null&&Ye<g.length&&(Si(n,Ye),g.length=Ye);if(Ds()&&nt!==null&&!_t&&g!==null&&(n.f&(Me|Ct|Qe))===0)for(I=0;I<nt.length;I++)Of(nt[I],n);return s!==null&&s!==n&&(ws++,nt!==null&&(r===null?r=nt:r.push(...nt))),(n.f&on)!==0&&(n.f^=on),m}catch(P){return ff(P)}finally{n.f^=ya,$e=e,Ye=t,nt=r,X=s,Lt=i,Ir(a),_t=c,Mn=l}}function Bg(n,e){let t=e.reactions;if(t!==null){var r=Um.call(t,n);if(r!==-1){var s=t.length-1;s===0?t=e.reactions=null:(t[r]=t[s],t.pop())}}t===null&&(e.f&Me)!==0&&($e===null||!$e.includes(e))&&(Pe(e,Ct),(e.f&lt)!==0&&(e.f^=lt,e.f&=~Ts),gf(e),Si(e,0))}function Si(n,e){var t=n.deps;if(t!==null)for(var r=e;r<t.length;r++)Bg(n,t[r])}function Rr(n){var e=n.f;if((e&sn)===0){Pe(n,Se);var t=J,r=On;J=n,On=!0;try{(e&$t)!==0?Lg(n):Sf(n),Rf(n);var s=Mf(n);n.teardown=typeof s=="function"?s:null,n.wv=Df;var i;ef&&fg&&(n.f&Qe)!==0&&n.deps}finally{On=r,J=t}}}async function $g(){await Promise.resolve(),_g()}function F(n){var e=n.f,t=(e&Me)!==0;if(X!==null&&!_t){var r=J!==null&&(J.f&sn)!==0;if(!r&&!Lt?.includes(n)){var s=X.deps;if((X.f&ya)!==0)n.rv<ws&&(n.rv=ws,$e===null&&s!==null&&s[Ye]===n?Ye++:$e===null?$e=[n]:$e.includes(n)||$e.push(n));else{(X.deps??=[]).push(n);var i=n.reactions;i===null?n.reactions=[X]:i.includes(X)||i.push(X)}}}if(Kn){if(an.has(n))return an.get(n);if(t){var a=n,c=a.v;return((a.f&Se)===0&&a.reactions!==null||xf(a))&&(c=uc(a)),an.set(a,c),c}}else if(t){if(a=n,Ze?.has(a))return Ze.get(a);Fr(a)&&_f(a),On&&no()&&(a.f&lt)===0&&Lf(a)}else if(Ze?.has(n))return Ze.get(n);if((n.f&on)!==0)throw n.v;return n.v}function Lf(n){if(n.deps!==null){n.f^=lt;for(const e of n.deps)(e.reactions??=[]).push(n),(e.f&Me)!==0&&(e.f&lt)===0&&Lf(e)}}function xf(n){if(n.v===De)return!0;if(n.deps===null)return!1;for(const e of n.deps)if(an.has(e)||(e.f&Me)!==0&&xf(e))return!0;return!1}function He(n){var e=_t;try{return _t=!0,n()}finally{_t=e}}const jg=-7169;function Pe(n,e){n.f=n.f&jg|e}function qg(n){if(!(typeof n!="object"||!n||n instanceof EventTarget)){if(hr in n)Ia(n);else if(!Array.isArray(n))for(let e in n){const t=n[e];typeof t=="object"&&t&&hr in t&&Ia(t)}}}function Ia(n,e=new Set){if(typeof n=="object"&&n!==null&&!(n instanceof EventTarget)&&!e.has(n)){e.add(n),n instanceof Date&&n.getTime();for(let r in n)try{Ia(n[r],e)}catch{}const t=tc(n);if(t!==Object.prototype&&t!==Array.prototype&&t!==Map.prototype&&t!==Set.prototype&&t!==Date.prototype){const r=nf(t);for(let s in r){const i=r[s].get;if(i)try{i.call(n)}catch{}}}}}const zg=["touchstart","touchmove"];function Hg(n){return zg.includes(n)}const Wg=new Set,El=new Set;function Gg(n,e,t,r={}){function s(i){if(r.capture||cs.call(e,i),!i.cancelBubble)return to(()=>t?.call(this,i))}return n.startsWith("pointer")||n.startsWith("touch")||n==="wheel"?Zi(()=>{e.addEventListener(n,s,r)}):e.addEventListener(n,s,r),s}function Os(n,e,t,r,s){var i={capture:r,passive:s},a=Gg(n,e,t,i);(e===document.body||e===window||e===document||e instanceof HTMLMediaElement)&&lc(()=>{e.removeEventListener(n,a,i)})}let Tl=null;function cs(n){var e=this,t=e.ownerDocument,r=n.type,s=n.composedPath?.()||[],i=s[0]||n.target;Tl=n;var a=0,c=Tl===n&&n.__root;if(c){var l=s.indexOf(c);if(l!==-1&&(e===document||e===window)){n.__root=e;return}var h=s.indexOf(e);if(h===-1)return;l<=h&&(a=l)}if(i=s[a]||n.target,i!==e){tf(n,"currentTarget",{configurable:!0,get(){return i||t}});var d=X,m=J;Ge(null),bt(null);try{for(var g,I=[];i!==null;){var P=i.assignedSlot||i.parentNode||i.host||null;try{var C=i["__"+r];C!=null&&(!i.disabled||n.target===i)&&C.call(i,n)}catch(S){g?I.push(S):g=S}if(n.cancelBubble||P===e||P===null)break;i=P}if(g){for(let S of I)queueMicrotask(()=>{throw S});throw g}}finally{n.__root=e,delete n.currentTarget,Ge(d),bt(m)}}}function Kg(n){var e=document.createElement("template");return e.innerHTML=n.replaceAll("<!>","<!---->"),e.content}function wa(n,e){var t=J;t.nodes_start===null&&(t.nodes_start=n,t.nodes_end=e)}function Ie(n,e){var t=(e&ag)!==0,r=(e&cg)!==0,s,i=!n.startsWith("<!>");return()=>{s===void 0&&(s=Kg(i?n:"<!>"+n),t||(s=Ri(s)));var a=r||Ef?document.importNode(s,!0):s.cloneNode(!0);if(t){var c=Ri(a),l=a.lastChild;wa(c,l)}else wa(a,a);return a}}function Aa(){var n=document.createDocumentFragment(),e=document.createComment(""),t=Ar();return n.append(e,t),wa(e,t),n}function le(n,e){n!==null&&n.before(e)}function pc(n,e){var t=e==null?"":typeof e=="object"?e+"":e;t!==(n.__t??=n.nodeValue)&&(n.__t=t,n.nodeValue=t+"")}function Qg(n,e){return Xg(n,e)}const tr=new Map;function Xg(n,{target:e,anchor:t,props:r={},events:s,context:i,intro:a=!0}){Pg();var c=new Set,l=m=>{for(var g=0;g<m.length;g++){var I=m[g];if(!c.has(I)){c.add(I);var P=Hg(I);e.addEventListener(I,cs,{passive:P});var C=tr.get(I);C===void 0?(document.addEventListener(I,cs,{passive:P}),tr.set(I,1)):tr.set(I,C+1)}}};l(ec(Wg)),El.add(l);var h=void 0,d=Og(()=>{var m=t??e.appendChild(Ar());return Tg(m,{pending:()=>{}},g=>{if(i){qt({});var I=re;I.c=i}s&&(r.$$events=s),h=n(g,r)||{},i&&zt()}),()=>{for(var g of c){e.removeEventListener(g,cs);var I=tr.get(g);--I===0?(document.removeEventListener(g,cs),tr.delete(g)):tr.set(g,I)}El.delete(l),m!==t&&m.parentNode?.removeChild(m)}});return Jg.set(h,d),h}let Jg=new WeakMap;class Yg{anchor;#e=new Map;#t=new Map;#n=new Map;#r=!0;constructor(e,t=!0){this.anchor=e,this.#r=t}#c=()=>{var e=ie;if(this.#e.has(e)){var t=this.#e.get(e),r=this.#t.get(t);if(r)dc(r);else{var s=this.#n.get(t);s&&(this.#t.set(t,s.effect),this.#n.delete(t),s.fragment.lastChild.remove(),this.anchor.before(s.fragment),r=s.effect)}for(const[i,a]of this.#e){if(this.#e.delete(i),i===e)break;const c=this.#n.get(a);c&&(qe(c.effect),this.#n.delete(a))}for(const[i,a]of this.#t){if(i===t)continue;const c=()=>{if(Array.from(this.#e.values()).includes(i)){var h=document.createDocumentFragment();Nf(a,h),h.append(Ar()),this.#n.set(i,{effect:a,fragment:h})}else qe(a);this.#t.delete(i)};this.#r||!r?dr(a,c,!1):c()}}};#o=e=>{this.#e.delete(e);const t=Array.from(this.#e.values());for(const[r,s]of this.#n)t.includes(r)||(qe(s.effect),this.#n.delete(r))};ensure(e,t){var r=ie,s=wf();if(t&&!this.#t.has(e)&&!this.#n.has(e))if(s){var i=document.createDocumentFragment(),a=Ar();i.append(a),this.#n.set(e,{effect:ot(()=>t(a)),fragment:i})}else this.#t.set(e,ot(()=>t(this.anchor)));if(this.#e.set(r,e),s){for(const[c,l]of this.#t)c===e?r.skipped_effects.delete(l):r.skipped_effects.add(l);for(const[c,l]of this.#n)c===e?r.skipped_effects.delete(l.effect):r.skipped_effects.add(l.effect);r.oncommit(this.#c),r.ondiscard(this.#o)}else this.#c()}}function yt(n,e,t=!1){var r=new Yg(n),s=t?Tr:0;function i(a,c){r.ensure(a,c)}hc(()=>{var a=!1;e((c,l=!0)=>{a=!0,i(l,c)}),a||i(!1,null)},s)}function Zg(n,e){return e}function e_(n,e,t){for(var r=n.items,s=[],i=e.length,a=0;a<i;a++)fc(e[a].e,s,!0);var c=i>0&&s.length===0&&t!==null;if(c){var l=t.parentNode;Cg(l),l.append(t),r.clear(),dt(n,e[0].prev,e[i-1].next)}Cf(s,()=>{for(var h=0;h<i;h++){var d=e[h];c||(r.delete(d.k),dt(n,d.prev,d.next)),qe(d.e,!c)}})}function t_(n,e,t,r,s,i=null){var a=n,c={flags:e,items:new Map,first:null},l=null,h=!1,d=new Map,m=cc(()=>{var C=t();return Za(C)?C:C==null?[]:ec(C)}),g,I;function P(){n_(I,g,c,d,a,s,e,r,t),i!==null&&(g.length===0?l?dc(l):l=ot(()=>i(a)):l!==null&&dr(l,()=>{l=null}))}hc(()=>{I??=J,g=F(m);var C=g.length;if(!(h&&C===0)){h=C===0;var S,L,O,V;if(wf()){var z=new Set,Y=ie;for(L=0;L<C;L+=1){O=g[L],V=r(O,L);var Z=c.items.get(V)??d.get(V);Z?Ff(Z,O,L):(S=Uf(null,c,null,null,O,V,L,s,e,t,!0),d.set(V,S)),z.add(V)}for(const[T,_]of c.items)z.has(T)||Y.skipped_effects.add(_.e);Y.oncommit(P)}else P();F(m)}})}function n_(n,e,t,r,s,i,a,c,l){var h=e.length,d=t.items,m=t.first,g=m,I,P=null,C=[],S=[],L,O,V,z;for(z=0;z<h;z+=1){if(L=e[z],O=c(L,z),V=d.get(O),V===void 0){var Y=r.get(O);if(Y!==void 0){r.delete(O),d.set(O,Y);var Z=P?P.next:g;dt(t,P,Y),dt(t,Y,Z),na(Y,Z,s),P=Y}else{var T=g?g.e.nodes_start:s;P=Uf(T,t,P,P===null?t.first:P.next,L,O,z,i,a,l)}d.set(O,P),C=[],S=[],g=P.next;continue}if(Ff(V,L,z),(V.e.f&tt)!==0&&dc(V.e),V!==g){if(I!==void 0&&I.has(V)){if(C.length<S.length){var _=S[0],y;P=_.prev;var w=C[0],E=C[C.length-1];for(y=0;y<C.length;y+=1)na(C[y],_,s);for(y=0;y<S.length;y+=1)I.delete(S[y]);dt(t,w.prev,E.next),dt(t,P,w),dt(t,E,_),g=_,P=E,z-=1,C=[],S=[]}else I.delete(V),na(V,g,s),dt(t,V.prev,V.next),dt(t,V,P===null?t.first:P.next),dt(t,P,V),P=V;continue}for(C=[],S=[];g!==null&&g.k!==O;)(g.e.f&tt)===0&&(I??=new Set).add(g),S.push(g),g=g.next;if(g===null)continue;V=g}C.push(V),P=V,g=V.next}if(g!==null||I!==void 0){for(var A=I===void 0?[]:ec(I);g!==null;)(g.e.f&tt)===0&&A.push(g),g=g.next;var v=A.length;if(v>0){var de=null;e_(t,A,de)}}n.first=t.first&&t.first.e,n.last=P&&P.e;for(var Xe of r.values())qe(Xe.e);r.clear()}function Ff(n,e,t,r){Is(n.v,e),n.i=t}function Uf(n,e,t,r,s,i,a,c,l,h,d){var m=(l&tg)!==0,g=(l&rg)===0,I=m?g?je(s,!1,!1):Bn(s):s,P=(l&ng)===0?a:Bn(a),C={i:P,v:I,k:i,a:null,e:null,prev:t,next:r};try{if(n===null){var S=document.createDocumentFragment();S.append(n=Ar())}return C.e=ot(()=>c(n,I,P,h),hg),C.e.prev=t&&t.e,C.e.next=r&&r.e,t===null?d||(e.first=C):(t.next=C,t.e.next=C.e),r!==null&&(r.prev=C,r.e.prev=C.e),C}finally{}}function na(n,e,t){for(var r=n.next?n.next.e.nodes_start:t,s=e?e.e.nodes_start:t,i=n.e.nodes_start;i!==null&&i!==r;){var a=Vs(i);s.before(i),i=a}}function dt(n,e,t){e===null?n.first=t:(e.next=t,e.e.next=t&&t.e),t!==null&&(t.prev=e,t.e.prev=e&&e.e)}function r_(n,e,t,r,s){var i=e.$$slots?.[t],a=!1;i===!0&&(i=e.children,a=!0),i===void 0||i(n,a?()=>r:r)}const Il=[...` 	
\r\fÂ \v\uFEFF`];function s_(n,e,t){var r=n==null?"":""+n;if(t){for(var s in t)if(t[s])r=r?r+" "+s:s;else if(r.length)for(var i=s.length,a=0;(a=r.indexOf(s,a))>=0;){var c=a+i;(a===0||Il.includes(r[a-1]))&&(c===r.length||Il.includes(r[c]))?r=(a===0?"":r.substring(0,a))+r.substring(c+1):a=c}}return r===""?null:r}function Bf(n,e,t,r,s,i){var a=n.__className;if(a!==t||a===void 0){var c=s_(t,r,i);c==null?n.removeAttribute("class"):n.className=c,n.__className=t}else if(i&&s!==i)for(var l in i){var h=!!i[l];(s==null||h!==!!s[l])&&n.classList.toggle(l,h)}return i}const i_=Symbol("is custom element"),o_=Symbol("is html");function pi(n,e,t,r){var s=a_(n);s[e]!==(s[e]=t)&&(e==="loading"&&(n[zm]=t),t==null?n.removeAttribute(e):typeof t!="string"&&c_(n).includes(e)?n[e]=t:n.setAttribute(e,t))}function a_(n){return n.__attributes??={[i_]:n.nodeName.includes("-"),[o_]:n.namespaceURI===ug}}var wl=new Map;function c_(n){var e=n.getAttribute("is")||n.nodeName,t=wl.get(e);if(t)return t;wl.set(e,t=[]);for(var r,s=n,i=Element.prototype;i!==s;){r=nf(s);for(var a in r)r[a].set&&t.push(a);s=tc(s)}return t}function pr(n,e,t=e){var r=new WeakSet;Ng(n,"input",async s=>{var i=s?n.defaultValue:n.value;if(i=ra(n)?sa(i):i,t(i),ie!==null&&r.add(ie),await $g(),i!==(i=e())){var a=n.selectionStart,c=n.selectionEnd,l=n.value.length;if(n.value=i??"",c!==null){var h=n.value.length;a===c&&c===l&&h>l?(n.selectionStart=h,n.selectionEnd=h):(n.selectionStart=a,n.selectionEnd=Math.min(c,h))}}}),He(e)==null&&n.value&&(t(ra(n)?sa(n.value):n.value),ie!==null&&r.add(ie)),io(()=>{var s=e();if(n===document.activeElement){var i=di??ie;if(r.has(i))return}ra(n)&&s===sa(n.value)||n.type==="date"&&!s&&!n.value||s!==n.value&&(n.value=s??"")})}function ra(n){var e=n.type;return e==="number"||e==="range"}function sa(n){return n===""?null:+n}function $f(n){return function(...e){var t=e[0];return t.preventDefault(),n?.apply(this,e)}}function Tn(n=!1){const e=re,t=e.l.u;if(!t)return;let r=()=>qg(e.s);if(n){let s=0,i={};const a=ac(()=>{let c=!1;const l=e.s;for(const h in l)l[h]!==i[h]&&(i[h]=l[h],c=!0);return c&&s++,s});r=()=>F(a)}t.b.length&&Vg(()=>{Al(e,r),_a(t.b)}),Ta(()=>{const s=He(()=>t.m.map(jm));return()=>{for(const i of s)typeof i=="function"&&i()}}),t.a.length&&Ta(()=>{Al(e,r),_a(t.a)})}function Al(n,e){if(n.l.s)for(const t of n.l.s)F(t);e()}function jf(n,e,t){if(n==null)return e(void 0),lr;const r=He(()=>n.subscribe(e,t));return r.unsubscribe?()=>r.unsubscribe():r}const nr=[];function mc(n,e=lr){let t=null;const r=new Set;function s(c){if(cf(n,c)&&(n=c,t)){const l=!nr.length;for(const h of r)h[1](),nr.push(h,n);if(l){for(let h=0;h<nr.length;h+=2)nr[h][0](nr[h+1]);nr.length=0}}}function i(c){s(c(n))}function a(c,l=lr){const h=[c,l];return r.add(h),r.size===1&&(t=e(s,i)||lr),c(n),()=>{r.delete(h),r.size===0&&t&&(t(),t=null)}}return{set:s,update:i,subscribe:a}}function u_(n){let e;return jf(n,t=>e=t)(),e}let oi=!1,ba=Symbol();function cn(n,e,t){const r=t[e]??={store:null,source:je(void 0),unsubscribe:lr};if(r.store!==n&&!(ba in t))if(r.unsubscribe(),r.store=n??null,n==null)r.source.v=void 0,r.unsubscribe=lr;else{var s=!0;r.unsubscribe=jf(n,i=>{s?r.source.v=i:ee(r.source,i)}),s=!1}return n&&ba in t?u_(n):F(r.source)}function oo(){const n={};function e(){lc(()=>{for(var t in n)n[t].unsubscribe();tf(n,ba,{enumerable:!1,value:!0})})}return[n,e]}function l_(n){var e=oi;try{return oi=!1,[n(),oi]}finally{oi=e}}function mr(n,e,t,r){var s=!xr||(t&sg)!==0,i=(t&og)!==0,a=r,c=!0,l=()=>(c&&(c=!1,a=r),a),h;{var d=hr in n||qm in n;h=ur(n,e)?.set??(d&&e in n?O=>n[e]=O:void 0)}var m,g=!1;[m,g]=l_(()=>n[e]),m===void 0&&r!==void 0&&(m=l(),h&&(s&&Xm(),h(m)));var I;if(s?I=()=>{var O=n[e];return O===void 0?l():(c=!0,O)}:I=()=>{var O=n[e];return O!==void 0&&(a=void 0),O===void 0?a:O},s&&(t&ig)===0)return I;if(h){var P=n.$$legacy;return(function(O,V){return arguments.length>0?((!s||!V||P||g)&&h(V?I():O),O):I()})}var C=!1,S=cc(()=>(C=!1,I()));F(S);var L=J;return(function(O,V){if(arguments.length>0){const z=V?F(S):s&&i?cr(O):O;return ee(S,z),C=!0,a!==void 0&&(a=z),O}return Kn&&C||(L.f&sn)!==0?S.v:F(S)})}function qf(n){re===null&&ic(),xr&&re.l!==null?f_(re).m.push(n):Ta(()=>{const e=He(n);if(typeof e=="function")return e})}function h_(n,e,{bubbles:t=!1,cancelable:r=!1}={}){return new CustomEvent(n,{detail:e,bubbles:t,cancelable:r})}function gc(){const n=re;return n===null&&ic(),(e,t,r)=>{const s=n.s.$$events?.[e];if(s){const i=Za(s)?s.slice():[s],a=h_(e,t,r);for(const c of i)c.call(n.x,a);return!a.defaultPrevented}return!0}}function f_(n){var e=n.l;return e.u??={a:[],b:[],m:[]}}const d_="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(d_);dg();const p_=()=>{};var bl={};const zf=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let s=n.charCodeAt(r);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},m_=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const s=n[t++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=n[t++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=n[t++],a=n[t++],c=n[t++],l=((s&7)<<18|(i&63)<<12|(a&63)<<6|c&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const i=n[t++],a=n[t++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|a&63)}}return e.join("")},Hf={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<n.length;s+=3){const i=n[s],a=s+1<n.length,c=a?n[s+1]:0,l=s+2<n.length,h=l?n[s+2]:0,d=i>>2,m=(i&3)<<4|c>>4;let g=(c&15)<<2|h>>6,I=h&63;l||(I=64,a||(g=64)),r.push(t[d],t[m],t[g],t[I])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(zf(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):m_(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<n.length;){const i=t[n.charAt(s++)],c=s<n.length?t[n.charAt(s)]:0;++s;const h=s<n.length?t[n.charAt(s)]:64;++s;const m=s<n.length?t[n.charAt(s)]:64;if(++s,i==null||c==null||h==null||m==null)throw new g_;const g=i<<2|c>>4;if(r.push(g),h!==64){const I=c<<4&240|h>>2;if(r.push(I),m!==64){const P=h<<6&192|m;r.push(P)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class g_ extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const __=function(n){const e=zf(n);return Hf.encodeByteArray(e,!0)},Pi=function(n){return __(n).replace(/\./g,"")},Wf=function(n){try{return Hf.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function y_(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const v_=()=>y_().__FIREBASE_DEFAULTS__,E_=()=>{if(typeof process>"u"||typeof bl>"u")return;const n=bl.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},T_=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&Wf(n[1]);return e&&JSON.parse(e)},ao=()=>{try{return p_()||v_()||E_()||T_()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Gf=n=>ao()?.emulatorHosts?.[n],Kf=n=>{const e=Gf(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},Qf=()=>ao()?.config,Xf=n=>ao()?.[`_${n}`];class I_{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}function In(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function _c(n){return(await fetch(n,{credentials:"include"})).ok}function w_(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",s=n.iat||0,i=n.sub||n.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a={iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...n};return[Pi(JSON.stringify(t)),Pi(JSON.stringify(a)),""].join(".")}const ms={};function A_(){const n={prod:[],emulator:[]};for(const e of Object.keys(ms))ms[e]?n.emulator.push(e):n.prod.push(e);return n}function b_(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let Rl=!1;function yc(n,e){if(typeof window>"u"||typeof document>"u"||!In(window.location.host)||ms[n]===e||ms[n]||Rl)return;ms[n]=e;function t(g){return`__firebase__banner__${g}`}const r="__firebase__banner",i=A_().prod.length>0;function a(){const g=document.getElementById(r);g&&g.remove()}function c(g){g.style.display="flex",g.style.background="#7faaf0",g.style.position="fixed",g.style.bottom="5px",g.style.left="5px",g.style.padding=".5em",g.style.borderRadius="5px",g.style.alignItems="center"}function l(g,I){g.setAttribute("width","24"),g.setAttribute("id",I),g.setAttribute("height","24"),g.setAttribute("viewBox","0 0 24 24"),g.setAttribute("fill","none"),g.style.marginLeft="-6px"}function h(){const g=document.createElement("span");return g.style.cursor="pointer",g.style.marginLeft="16px",g.style.fontSize="24px",g.innerHTML=" &times;",g.onclick=()=>{Rl=!0,a()},g}function d(g,I){g.setAttribute("id",I),g.innerText="Learn more",g.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",g.setAttribute("target","__blank"),g.style.paddingLeft="5px",g.style.textDecoration="underline"}function m(){const g=b_(r),I=t("text"),P=document.getElementById(I)||document.createElement("span"),C=t("learnmore"),S=document.getElementById(C)||document.createElement("a"),L=t("preprendIcon"),O=document.getElementById(L)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(g.created){const V=g.element;c(V),d(S,C);const z=h();l(O,L),V.append(O,P,S,z),document.body.appendChild(V)}i?(P.innerText="Preview backend disconnected.",O.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(O.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,P.innerText="Preview backend running in this workspace."),P.setAttribute("id",I)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",m):m()}function Le(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function R_(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Le())}function S_(){const n=ao()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function P_(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function C_(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function k_(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function N_(){const n=Le();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function D_(){return!S_()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function V_(){try{return typeof indexedDB=="object"}catch{return!1}}function O_(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{e(s.error?.message||"")}}catch(t){e(t)}})}const M_="FirebaseError";class kt extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=M_,Object.setPrototypeOf(this,kt.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ms.prototype.create)}}class Ms{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},s=`${this.service}/${e}`,i=this.errors[e],a=i?L_(i,r):"Error",c=`${this.serviceName}: ${a} (${s}).`;return new kt(s,c,r)}}function L_(n,e){return n.replace(x_,(t,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const x_=/\{\$([^}]+)}/g;function F_(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function $n(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const s of t){if(!r.includes(s))return!1;const i=n[s],a=e[s];if(Sl(i)&&Sl(a)){if(!$n(i,a))return!1}else if(i!==a)return!1}for(const s of r)if(!t.includes(s))return!1;return!0}function Sl(n){return n!==null&&typeof n=="object"}function Ls(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function U_(n,e){const t=new B_(n,e);return t.subscribe.bind(t)}class B_{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let s;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");$_(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:r},s.next===void 0&&(s.next=ia),s.error===void 0&&(s.error=ia),s.complete===void 0&&(s.complete=ia);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function $_(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function ia(){}function ge(n){return n&&n._delegate?n._delegate:n}class pn{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const kn="[DEFAULT]";class j_{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new I_;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(z_(e))try{this.getOrInitializeService({instanceIdentifier:kn})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=kn){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=kn){return this.instances.has(e)}getOptions(e=kn){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[i,a]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(i);r===c&&a.resolve(s)}return s}onInit(e,t){const r=this.normalizeInstanceIdentifier(t),s=this.onInitCallbacks.get(r)??new Set;s.add(e),this.onInitCallbacks.set(r,s);const i=this.instances.get(r);return i&&e(i,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const s of r)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:q_(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=kn){return this.component?this.component.multipleInstances?e:kn:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function q_(n){return n===kn?void 0:n}function z_(n){return n.instantiationMode==="EAGER"}class H_{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new j_(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var W;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(W||(W={}));const W_={debug:W.DEBUG,verbose:W.VERBOSE,info:W.INFO,warn:W.WARN,error:W.ERROR,silent:W.SILENT},G_=W.INFO,K_={[W.DEBUG]:"log",[W.VERBOSE]:"log",[W.INFO]:"info",[W.WARN]:"warn",[W.ERROR]:"error"},Q_=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),s=K_[e];if(s)console[s](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class vc{constructor(e){this.name=e,this._logLevel=G_,this._logHandler=Q_,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in W))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?W_[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,W.DEBUG,...e),this._logHandler(this,W.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,W.VERBOSE,...e),this._logHandler(this,W.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,W.INFO,...e),this._logHandler(this,W.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,W.WARN,...e),this._logHandler(this,W.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,W.ERROR,...e),this._logHandler(this,W.ERROR,...e)}}const X_=(n,e)=>e.some(t=>n instanceof t);let Pl,Cl;function J_(){return Pl||(Pl=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Y_(){return Cl||(Cl=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Jf=new WeakMap,Ra=new WeakMap,Yf=new WeakMap,oa=new WeakMap,Ec=new WeakMap;function Z_(n){const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("success",i),n.removeEventListener("error",a)},i=()=>{t(un(n.result)),s()},a=()=>{r(n.error),s()};n.addEventListener("success",i),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&Jf.set(t,n)}).catch(()=>{}),Ec.set(e,n),e}function ey(n){if(Ra.has(n))return;const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("complete",i),n.removeEventListener("error",a),n.removeEventListener("abort",a)},i=()=>{t(),s()},a=()=>{r(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",i),n.addEventListener("error",a),n.addEventListener("abort",a)});Ra.set(n,e)}let Sa={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Ra.get(n);if(e==="objectStoreNames")return n.objectStoreNames||Yf.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return un(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function ty(n){Sa=n(Sa)}function ny(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(aa(this),e,...t);return Yf.set(r,e.sort?e.sort():[e]),un(r)}:Y_().includes(n)?function(...e){return n.apply(aa(this),e),un(Jf.get(this))}:function(...e){return un(n.apply(aa(this),e))}}function ry(n){return typeof n=="function"?ny(n):(n instanceof IDBTransaction&&ey(n),X_(n,J_())?new Proxy(n,Sa):n)}function un(n){if(n instanceof IDBRequest)return Z_(n);if(oa.has(n))return oa.get(n);const e=ry(n);return e!==n&&(oa.set(n,e),Ec.set(e,n)),e}const aa=n=>Ec.get(n);function sy(n,e,{blocked:t,upgrade:r,blocking:s,terminated:i}={}){const a=indexedDB.open(n,e),c=un(a);return r&&a.addEventListener("upgradeneeded",l=>{r(un(a.result),l.oldVersion,l.newVersion,un(a.transaction),l)}),t&&a.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),c.then(l=>{i&&l.addEventListener("close",()=>i()),s&&l.addEventListener("versionchange",h=>s(h.oldVersion,h.newVersion,h))}).catch(()=>{}),c}const iy=["get","getKey","getAll","getAllKeys","count"],oy=["put","add","delete","clear"],ca=new Map;function kl(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(ca.get(e))return ca.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,s=oy.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(s||iy.includes(t)))return;const i=async function(a,...c){const l=this.transaction(a,s?"readwrite":"readonly");let h=l.store;return r&&(h=h.index(c.shift())),(await Promise.all([h[t](...c),s&&l.done]))[0]};return ca.set(e,i),i}ty(n=>({...n,get:(e,t,r)=>kl(e,t)||n.get(e,t,r),has:(e,t)=>!!kl(e,t)||n.has(e,t)}));class ay{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(cy(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function cy(n){return n.getComponent()?.type==="VERSION"}const Pa="@firebase/app",Nl="0.14.5";const xt=new vc("@firebase/app"),uy="@firebase/app-compat",ly="@firebase/analytics-compat",hy="@firebase/analytics",fy="@firebase/app-check-compat",dy="@firebase/app-check",py="@firebase/auth",my="@firebase/auth-compat",gy="@firebase/database",_y="@firebase/data-connect",yy="@firebase/database-compat",vy="@firebase/functions",Ey="@firebase/functions-compat",Ty="@firebase/installations",Iy="@firebase/installations-compat",wy="@firebase/messaging",Ay="@firebase/messaging-compat",by="@firebase/performance",Ry="@firebase/performance-compat",Sy="@firebase/remote-config",Py="@firebase/remote-config-compat",Cy="@firebase/storage",ky="@firebase/storage-compat",Ny="@firebase/firestore",Dy="@firebase/ai",Vy="@firebase/firestore-compat",Oy="firebase",My="12.5.0";const Ca="[DEFAULT]",Ly={[Pa]:"fire-core",[uy]:"fire-core-compat",[hy]:"fire-analytics",[ly]:"fire-analytics-compat",[dy]:"fire-app-check",[fy]:"fire-app-check-compat",[py]:"fire-auth",[my]:"fire-auth-compat",[gy]:"fire-rtdb",[_y]:"fire-data-connect",[yy]:"fire-rtdb-compat",[vy]:"fire-fn",[Ey]:"fire-fn-compat",[Ty]:"fire-iid",[Iy]:"fire-iid-compat",[wy]:"fire-fcm",[Ay]:"fire-fcm-compat",[by]:"fire-perf",[Ry]:"fire-perf-compat",[Sy]:"fire-rc",[Py]:"fire-rc-compat",[Cy]:"fire-gcs",[ky]:"fire-gcs-compat",[Ny]:"fire-fst",[Vy]:"fire-fst-compat",[Dy]:"fire-vertex","fire-js":"fire-js",[Oy]:"fire-js-all"};const Ci=new Map,xy=new Map,ka=new Map;function Dl(n,e){try{n.container.addComponent(e)}catch(t){xt.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function jn(n){const e=n.name;if(ka.has(e))return xt.debug(`There were multiple attempts to register component ${e}.`),!1;ka.set(e,n);for(const t of Ci.values())Dl(t,n);for(const t of xy.values())Dl(t,n);return!0}function co(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function rt(n){return n==null?!1:n.settings!==void 0}const Fy={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ln=new Ms("app","Firebase",Fy);class Uy{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new pn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ln.create("app-deleted",{appName:this._name})}}const Ur=My;function Zf(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r={name:Ca,automaticDataCollectionEnabled:!0,...e},s=r.name;if(typeof s!="string"||!s)throw ln.create("bad-app-name",{appName:String(s)});if(t||(t=Qf()),!t)throw ln.create("no-options");const i=Ci.get(s);if(i){if($n(t,i.options)&&$n(r,i.config))return i;throw ln.create("duplicate-app",{appName:s})}const a=new H_(s);for(const l of ka.values())a.addComponent(l);const c=new Uy(t,r,a);return Ci.set(s,c),c}function Tc(n=Ca){const e=Ci.get(n);if(!e&&n===Ca&&Qf())return Zf();if(!e)throw ln.create("no-app",{appName:n});return e}function vt(n,e,t){let r=Ly[n]??n;t&&(r+=`-${t}`);const s=r.match(/\s|\//),i=e.match(/\s|\//);if(s||i){const a=[`Unable to register library "${r}" with version "${e}":`];s&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&i&&a.push("and"),i&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),xt.warn(a.join(" "));return}jn(new pn(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}const By="firebase-heartbeat-database",$y=1,As="firebase-heartbeat-store";let ua=null;function ed(){return ua||(ua=sy(By,$y,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(As)}catch(t){console.warn(t)}}}}).catch(n=>{throw ln.create("idb-open",{originalErrorMessage:n.message})})),ua}async function jy(n){try{const t=(await ed()).transaction(As),r=await t.objectStore(As).get(td(n));return await t.done,r}catch(e){if(e instanceof kt)xt.warn(e.message);else{const t=ln.create("idb-get",{originalErrorMessage:e?.message});xt.warn(t.message)}}}async function Vl(n,e){try{const r=(await ed()).transaction(As,"readwrite");await r.objectStore(As).put(e,td(n)),await r.done}catch(t){if(t instanceof kt)xt.warn(t.message);else{const r=ln.create("idb-set",{originalErrorMessage:t?.message});xt.warn(r.message)}}}function td(n){return`${n.name}!${n.options.appId}`}const qy=1024,zy=30;class Hy{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Gy(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=Ol();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(s=>s.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:t}),this._heartbeatsCache.heartbeats.length>zy){const s=Ky(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(s,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){xt.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Ol(),{heartbeatsToSend:t,unsentEntries:r}=Wy(this._heartbeatsCache.heartbeats),s=Pi(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(e){return xt.warn(e),""}}}function Ol(){return new Date().toISOString().substring(0,10)}function Wy(n,e=qy){const t=[];let r=n.slice();for(const s of n){const i=t.find(a=>a.agent===s.agent);if(i){if(i.dates.push(s.date),Ml(t)>e){i.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),Ml(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class Gy{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return V_()?O_().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await jy(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Vl(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Vl(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function Ml(n){return Pi(JSON.stringify({version:2,heartbeats:n})).length}function Ky(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function Qy(n){jn(new pn("platform-logger",e=>new ay(e),"PRIVATE")),jn(new pn("heartbeat",e=>new Hy(e),"PRIVATE")),vt(Pa,Nl,n),vt(Pa,Nl,"esm2020"),vt("fire-js","")}Qy("");var Xy="firebase",Jy="12.5.0";vt(Xy,Jy,"app");var Ll=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var hn,nd;(function(){var n;function e(T,_){function y(){}y.prototype=_.prototype,T.F=_.prototype,T.prototype=new y,T.prototype.constructor=T,T.D=function(w,E,A){for(var v=Array(arguments.length-2),de=2;de<arguments.length;de++)v[de-2]=arguments[de];return _.prototype[E].apply(w,v)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(T,_,y){y||(y=0);const w=Array(16);if(typeof _=="string")for(var E=0;E<16;++E)w[E]=_.charCodeAt(y++)|_.charCodeAt(y++)<<8|_.charCodeAt(y++)<<16|_.charCodeAt(y++)<<24;else for(E=0;E<16;++E)w[E]=_[y++]|_[y++]<<8|_[y++]<<16|_[y++]<<24;_=T.g[0],y=T.g[1],E=T.g[2];let A=T.g[3],v;v=_+(A^y&(E^A))+w[0]+3614090360&4294967295,_=y+(v<<7&4294967295|v>>>25),v=A+(E^_&(y^E))+w[1]+3905402710&4294967295,A=_+(v<<12&4294967295|v>>>20),v=E+(y^A&(_^y))+w[2]+606105819&4294967295,E=A+(v<<17&4294967295|v>>>15),v=y+(_^E&(A^_))+w[3]+3250441966&4294967295,y=E+(v<<22&4294967295|v>>>10),v=_+(A^y&(E^A))+w[4]+4118548399&4294967295,_=y+(v<<7&4294967295|v>>>25),v=A+(E^_&(y^E))+w[5]+1200080426&4294967295,A=_+(v<<12&4294967295|v>>>20),v=E+(y^A&(_^y))+w[6]+2821735955&4294967295,E=A+(v<<17&4294967295|v>>>15),v=y+(_^E&(A^_))+w[7]+4249261313&4294967295,y=E+(v<<22&4294967295|v>>>10),v=_+(A^y&(E^A))+w[8]+1770035416&4294967295,_=y+(v<<7&4294967295|v>>>25),v=A+(E^_&(y^E))+w[9]+2336552879&4294967295,A=_+(v<<12&4294967295|v>>>20),v=E+(y^A&(_^y))+w[10]+4294925233&4294967295,E=A+(v<<17&4294967295|v>>>15),v=y+(_^E&(A^_))+w[11]+2304563134&4294967295,y=E+(v<<22&4294967295|v>>>10),v=_+(A^y&(E^A))+w[12]+1804603682&4294967295,_=y+(v<<7&4294967295|v>>>25),v=A+(E^_&(y^E))+w[13]+4254626195&4294967295,A=_+(v<<12&4294967295|v>>>20),v=E+(y^A&(_^y))+w[14]+2792965006&4294967295,E=A+(v<<17&4294967295|v>>>15),v=y+(_^E&(A^_))+w[15]+1236535329&4294967295,y=E+(v<<22&4294967295|v>>>10),v=_+(E^A&(y^E))+w[1]+4129170786&4294967295,_=y+(v<<5&4294967295|v>>>27),v=A+(y^E&(_^y))+w[6]+3225465664&4294967295,A=_+(v<<9&4294967295|v>>>23),v=E+(_^y&(A^_))+w[11]+643717713&4294967295,E=A+(v<<14&4294967295|v>>>18),v=y+(A^_&(E^A))+w[0]+3921069994&4294967295,y=E+(v<<20&4294967295|v>>>12),v=_+(E^A&(y^E))+w[5]+3593408605&4294967295,_=y+(v<<5&4294967295|v>>>27),v=A+(y^E&(_^y))+w[10]+38016083&4294967295,A=_+(v<<9&4294967295|v>>>23),v=E+(_^y&(A^_))+w[15]+3634488961&4294967295,E=A+(v<<14&4294967295|v>>>18),v=y+(A^_&(E^A))+w[4]+3889429448&4294967295,y=E+(v<<20&4294967295|v>>>12),v=_+(E^A&(y^E))+w[9]+568446438&4294967295,_=y+(v<<5&4294967295|v>>>27),v=A+(y^E&(_^y))+w[14]+3275163606&4294967295,A=_+(v<<9&4294967295|v>>>23),v=E+(_^y&(A^_))+w[3]+4107603335&4294967295,E=A+(v<<14&4294967295|v>>>18),v=y+(A^_&(E^A))+w[8]+1163531501&4294967295,y=E+(v<<20&4294967295|v>>>12),v=_+(E^A&(y^E))+w[13]+2850285829&4294967295,_=y+(v<<5&4294967295|v>>>27),v=A+(y^E&(_^y))+w[2]+4243563512&4294967295,A=_+(v<<9&4294967295|v>>>23),v=E+(_^y&(A^_))+w[7]+1735328473&4294967295,E=A+(v<<14&4294967295|v>>>18),v=y+(A^_&(E^A))+w[12]+2368359562&4294967295,y=E+(v<<20&4294967295|v>>>12),v=_+(y^E^A)+w[5]+4294588738&4294967295,_=y+(v<<4&4294967295|v>>>28),v=A+(_^y^E)+w[8]+2272392833&4294967295,A=_+(v<<11&4294967295|v>>>21),v=E+(A^_^y)+w[11]+1839030562&4294967295,E=A+(v<<16&4294967295|v>>>16),v=y+(E^A^_)+w[14]+4259657740&4294967295,y=E+(v<<23&4294967295|v>>>9),v=_+(y^E^A)+w[1]+2763975236&4294967295,_=y+(v<<4&4294967295|v>>>28),v=A+(_^y^E)+w[4]+1272893353&4294967295,A=_+(v<<11&4294967295|v>>>21),v=E+(A^_^y)+w[7]+4139469664&4294967295,E=A+(v<<16&4294967295|v>>>16),v=y+(E^A^_)+w[10]+3200236656&4294967295,y=E+(v<<23&4294967295|v>>>9),v=_+(y^E^A)+w[13]+681279174&4294967295,_=y+(v<<4&4294967295|v>>>28),v=A+(_^y^E)+w[0]+3936430074&4294967295,A=_+(v<<11&4294967295|v>>>21),v=E+(A^_^y)+w[3]+3572445317&4294967295,E=A+(v<<16&4294967295|v>>>16),v=y+(E^A^_)+w[6]+76029189&4294967295,y=E+(v<<23&4294967295|v>>>9),v=_+(y^E^A)+w[9]+3654602809&4294967295,_=y+(v<<4&4294967295|v>>>28),v=A+(_^y^E)+w[12]+3873151461&4294967295,A=_+(v<<11&4294967295|v>>>21),v=E+(A^_^y)+w[15]+530742520&4294967295,E=A+(v<<16&4294967295|v>>>16),v=y+(E^A^_)+w[2]+3299628645&4294967295,y=E+(v<<23&4294967295|v>>>9),v=_+(E^(y|~A))+w[0]+4096336452&4294967295,_=y+(v<<6&4294967295|v>>>26),v=A+(y^(_|~E))+w[7]+1126891415&4294967295,A=_+(v<<10&4294967295|v>>>22),v=E+(_^(A|~y))+w[14]+2878612391&4294967295,E=A+(v<<15&4294967295|v>>>17),v=y+(A^(E|~_))+w[5]+4237533241&4294967295,y=E+(v<<21&4294967295|v>>>11),v=_+(E^(y|~A))+w[12]+1700485571&4294967295,_=y+(v<<6&4294967295|v>>>26),v=A+(y^(_|~E))+w[3]+2399980690&4294967295,A=_+(v<<10&4294967295|v>>>22),v=E+(_^(A|~y))+w[10]+4293915773&4294967295,E=A+(v<<15&4294967295|v>>>17),v=y+(A^(E|~_))+w[1]+2240044497&4294967295,y=E+(v<<21&4294967295|v>>>11),v=_+(E^(y|~A))+w[8]+1873313359&4294967295,_=y+(v<<6&4294967295|v>>>26),v=A+(y^(_|~E))+w[15]+4264355552&4294967295,A=_+(v<<10&4294967295|v>>>22),v=E+(_^(A|~y))+w[6]+2734768916&4294967295,E=A+(v<<15&4294967295|v>>>17),v=y+(A^(E|~_))+w[13]+1309151649&4294967295,y=E+(v<<21&4294967295|v>>>11),v=_+(E^(y|~A))+w[4]+4149444226&4294967295,_=y+(v<<6&4294967295|v>>>26),v=A+(y^(_|~E))+w[11]+3174756917&4294967295,A=_+(v<<10&4294967295|v>>>22),v=E+(_^(A|~y))+w[2]+718787259&4294967295,E=A+(v<<15&4294967295|v>>>17),v=y+(A^(E|~_))+w[9]+3951481745&4294967295,T.g[0]=T.g[0]+_&4294967295,T.g[1]=T.g[1]+(E+(v<<21&4294967295|v>>>11))&4294967295,T.g[2]=T.g[2]+E&4294967295,T.g[3]=T.g[3]+A&4294967295}r.prototype.v=function(T,_){_===void 0&&(_=T.length);const y=_-this.blockSize,w=this.C;let E=this.h,A=0;for(;A<_;){if(E==0)for(;A<=y;)s(this,T,A),A+=this.blockSize;if(typeof T=="string"){for(;A<_;)if(w[E++]=T.charCodeAt(A++),E==this.blockSize){s(this,w),E=0;break}}else for(;A<_;)if(w[E++]=T[A++],E==this.blockSize){s(this,w),E=0;break}}this.h=E,this.o+=_},r.prototype.A=function(){var T=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);T[0]=128;for(var _=1;_<T.length-8;++_)T[_]=0;_=this.o*8;for(var y=T.length-8;y<T.length;++y)T[y]=_&255,_/=256;for(this.v(T),T=Array(16),_=0,y=0;y<4;++y)for(let w=0;w<32;w+=8)T[_++]=this.g[y]>>>w&255;return T};function i(T,_){var y=c;return Object.prototype.hasOwnProperty.call(y,T)?y[T]:y[T]=_(T)}function a(T,_){this.h=_;const y=[];let w=!0;for(let E=T.length-1;E>=0;E--){const A=T[E]|0;w&&A==_||(y[E]=A,w=!1)}this.g=y}var c={};function l(T){return-128<=T&&T<128?i(T,function(_){return new a([_|0],_<0?-1:0)}):new a([T|0],T<0?-1:0)}function h(T){if(isNaN(T)||!isFinite(T))return m;if(T<0)return S(h(-T));const _=[];let y=1;for(let w=0;T>=y;w++)_[w]=T/y|0,y*=4294967296;return new a(_,0)}function d(T,_){if(T.length==0)throw Error("number format error: empty string");if(_=_||10,_<2||36<_)throw Error("radix out of range: "+_);if(T.charAt(0)=="-")return S(d(T.substring(1),_));if(T.indexOf("-")>=0)throw Error('number format error: interior "-" character');const y=h(Math.pow(_,8));let w=m;for(let A=0;A<T.length;A+=8){var E=Math.min(8,T.length-A);const v=parseInt(T.substring(A,A+E),_);E<8?(E=h(Math.pow(_,E)),w=w.j(E).add(h(v))):(w=w.j(y),w=w.add(h(v)))}return w}var m=l(0),g=l(1),I=l(16777216);n=a.prototype,n.m=function(){if(C(this))return-S(this).m();let T=0,_=1;for(let y=0;y<this.g.length;y++){const w=this.i(y);T+=(w>=0?w:4294967296+w)*_,_*=4294967296}return T},n.toString=function(T){if(T=T||10,T<2||36<T)throw Error("radix out of range: "+T);if(P(this))return"0";if(C(this))return"-"+S(this).toString(T);const _=h(Math.pow(T,6));var y=this;let w="";for(;;){const E=z(y,_).g;y=L(y,E.j(_));let A=((y.g.length>0?y.g[0]:y.h)>>>0).toString(T);if(y=E,P(y))return A+w;for(;A.length<6;)A="0"+A;w=A+w}},n.i=function(T){return T<0?0:T<this.g.length?this.g[T]:this.h};function P(T){if(T.h!=0)return!1;for(let _=0;_<T.g.length;_++)if(T.g[_]!=0)return!1;return!0}function C(T){return T.h==-1}n.l=function(T){return T=L(this,T),C(T)?-1:P(T)?0:1};function S(T){const _=T.g.length,y=[];for(let w=0;w<_;w++)y[w]=~T.g[w];return new a(y,~T.h).add(g)}n.abs=function(){return C(this)?S(this):this},n.add=function(T){const _=Math.max(this.g.length,T.g.length),y=[];let w=0;for(let E=0;E<=_;E++){let A=w+(this.i(E)&65535)+(T.i(E)&65535),v=(A>>>16)+(this.i(E)>>>16)+(T.i(E)>>>16);w=v>>>16,A&=65535,v&=65535,y[E]=v<<16|A}return new a(y,y[y.length-1]&-2147483648?-1:0)};function L(T,_){return T.add(S(_))}n.j=function(T){if(P(this)||P(T))return m;if(C(this))return C(T)?S(this).j(S(T)):S(S(this).j(T));if(C(T))return S(this.j(S(T)));if(this.l(I)<0&&T.l(I)<0)return h(this.m()*T.m());const _=this.g.length+T.g.length,y=[];for(var w=0;w<2*_;w++)y[w]=0;for(w=0;w<this.g.length;w++)for(let E=0;E<T.g.length;E++){const A=this.i(w)>>>16,v=this.i(w)&65535,de=T.i(E)>>>16,Xe=T.i(E)&65535;y[2*w+2*E]+=v*Xe,O(y,2*w+2*E),y[2*w+2*E+1]+=A*Xe,O(y,2*w+2*E+1),y[2*w+2*E+1]+=v*de,O(y,2*w+2*E+1),y[2*w+2*E+2]+=A*de,O(y,2*w+2*E+2)}for(T=0;T<_;T++)y[T]=y[2*T+1]<<16|y[2*T];for(T=_;T<2*_;T++)y[T]=0;return new a(y,0)};function O(T,_){for(;(T[_]&65535)!=T[_];)T[_+1]+=T[_]>>>16,T[_]&=65535,_++}function V(T,_){this.g=T,this.h=_}function z(T,_){if(P(_))throw Error("division by zero");if(P(T))return new V(m,m);if(C(T))return _=z(S(T),_),new V(S(_.g),S(_.h));if(C(_))return _=z(T,S(_)),new V(S(_.g),_.h);if(T.g.length>30){if(C(T)||C(_))throw Error("slowDivide_ only works with positive integers.");for(var y=g,w=_;w.l(T)<=0;)y=Y(y),w=Y(w);var E=Z(y,1),A=Z(w,1);for(w=Z(w,2),y=Z(y,2);!P(w);){var v=A.add(w);v.l(T)<=0&&(E=E.add(y),A=v),w=Z(w,1),y=Z(y,1)}return _=L(T,E.j(_)),new V(E,_)}for(E=m;T.l(_)>=0;){for(y=Math.max(1,Math.floor(T.m()/_.m())),w=Math.ceil(Math.log(y)/Math.LN2),w=w<=48?1:Math.pow(2,w-48),A=h(y),v=A.j(_);C(v)||v.l(T)>0;)y-=w,A=h(y),v=A.j(_);P(A)&&(A=g),E=E.add(A),T=L(T,v)}return new V(E,T)}n.B=function(T){return z(this,T).h},n.and=function(T){const _=Math.max(this.g.length,T.g.length),y=[];for(let w=0;w<_;w++)y[w]=this.i(w)&T.i(w);return new a(y,this.h&T.h)},n.or=function(T){const _=Math.max(this.g.length,T.g.length),y=[];for(let w=0;w<_;w++)y[w]=this.i(w)|T.i(w);return new a(y,this.h|T.h)},n.xor=function(T){const _=Math.max(this.g.length,T.g.length),y=[];for(let w=0;w<_;w++)y[w]=this.i(w)^T.i(w);return new a(y,this.h^T.h)};function Y(T){const _=T.g.length+1,y=[];for(let w=0;w<_;w++)y[w]=T.i(w)<<1|T.i(w-1)>>>31;return new a(y,T.h)}function Z(T,_){const y=_>>5;_%=32;const w=T.g.length-y,E=[];for(let A=0;A<w;A++)E[A]=_>0?T.i(A+y)>>>_|T.i(A+y+1)<<32-_:T.i(A+y);return new a(E,T.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,nd=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.B,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=h,a.fromString=d,hn=a}).apply(typeof Ll<"u"?Ll:typeof self<"u"?self:typeof window<"u"?window:{});var ai=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var rd,us,sd,mi,Na,id,od,ad;(function(){var n,e=Object.defineProperty;function t(o){o=[typeof globalThis=="object"&&globalThis,o,typeof window=="object"&&window,typeof self=="object"&&self,typeof ai=="object"&&ai];for(var u=0;u<o.length;++u){var f=o[u];if(f&&f.Math==Math)return f}throw Error("Cannot find global object")}var r=t(this);function s(o,u){if(u)e:{var f=r;o=o.split(".");for(var p=0;p<o.length-1;p++){var b=o[p];if(!(b in f))break e;f=f[b]}o=o[o.length-1],p=f[o],u=u(p),u!=p&&u!=null&&e(f,o,{configurable:!0,writable:!0,value:u})}}s("Symbol.dispose",function(o){return o||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(o){return o||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(o){return o||function(u){var f=[],p;for(p in u)Object.prototype.hasOwnProperty.call(u,p)&&f.push([p,u[p]]);return f}});var i=i||{},a=this||self;function c(o){var u=typeof o;return u=="object"&&o!=null||u=="function"}function l(o,u,f){return o.call.apply(o.bind,arguments)}function h(o,u,f){return h=l,h.apply(null,arguments)}function d(o,u){var f=Array.prototype.slice.call(arguments,1);return function(){var p=f.slice();return p.push.apply(p,arguments),o.apply(this,p)}}function m(o,u){function f(){}f.prototype=u.prototype,o.Z=u.prototype,o.prototype=new f,o.prototype.constructor=o,o.Ob=function(p,b,R){for(var D=Array(arguments.length-2),H=2;H<arguments.length;H++)D[H-2]=arguments[H];return u.prototype[b].apply(p,D)}}var g=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?o=>o&&AsyncContext.Snapshot.wrap(o):o=>o;function I(o){const u=o.length;if(u>0){const f=Array(u);for(let p=0;p<u;p++)f[p]=o[p];return f}return[]}function P(o,u){for(let p=1;p<arguments.length;p++){const b=arguments[p];var f=typeof b;if(f=f!="object"?f:b?Array.isArray(b)?"array":f:"null",f=="array"||f=="object"&&typeof b.length=="number"){f=o.length||0;const R=b.length||0;o.length=f+R;for(let D=0;D<R;D++)o[f+D]=b[D]}else o.push(b)}}class C{constructor(u,f){this.i=u,this.j=f,this.h=0,this.g=null}get(){let u;return this.h>0?(this.h--,u=this.g,this.g=u.next,u.next=null):u=this.i(),u}}function S(o){a.setTimeout(()=>{throw o},0)}function L(){var o=T;let u=null;return o.g&&(u=o.g,o.g=o.g.next,o.g||(o.h=null),u.next=null),u}class O{constructor(){this.h=this.g=null}add(u,f){const p=V.get();p.set(u,f),this.h?this.h.next=p:this.g=p,this.h=p}}var V=new C(()=>new z,o=>o.reset());class z{constructor(){this.next=this.g=this.h=null}set(u,f){this.h=u,this.g=f,this.next=null}reset(){this.next=this.g=this.h=null}}let Y,Z=!1,T=new O,_=()=>{const o=Promise.resolve(void 0);Y=()=>{o.then(y)}};function y(){for(var o;o=L();){try{o.h.call(o.g)}catch(f){S(f)}var u=V;u.j(o),u.h<100&&(u.h++,o.next=u.g,u.g=o)}Z=!1}function w(){this.u=this.u,this.C=this.C}w.prototype.u=!1,w.prototype.dispose=function(){this.u||(this.u=!0,this.N())},w.prototype[Symbol.dispose]=function(){this.dispose()},w.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function E(o,u){this.type=o,this.g=this.target=u,this.defaultPrevented=!1}E.prototype.h=function(){this.defaultPrevented=!0};var A=(function(){if(!a.addEventListener||!Object.defineProperty)return!1;var o=!1,u=Object.defineProperty({},"passive",{get:function(){o=!0}});try{const f=()=>{};a.addEventListener("test",f,u),a.removeEventListener("test",f,u)}catch{}return o})();function v(o){return/^[\s\xa0]*$/.test(o)}function de(o,u){E.call(this,o?o.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,o&&this.init(o,u)}m(de,E),de.prototype.init=function(o,u){const f=this.type=o.type,p=o.changedTouches&&o.changedTouches.length?o.changedTouches[0]:null;this.target=o.target||o.srcElement,this.g=u,u=o.relatedTarget,u||(f=="mouseover"?u=o.fromElement:f=="mouseout"&&(u=o.toElement)),this.relatedTarget=u,p?(this.clientX=p.clientX!==void 0?p.clientX:p.pageX,this.clientY=p.clientY!==void 0?p.clientY:p.pageY,this.screenX=p.screenX||0,this.screenY=p.screenY||0):(this.clientX=o.clientX!==void 0?o.clientX:o.pageX,this.clientY=o.clientY!==void 0?o.clientY:o.pageY,this.screenX=o.screenX||0,this.screenY=o.screenY||0),this.button=o.button,this.key=o.key||"",this.ctrlKey=o.ctrlKey,this.altKey=o.altKey,this.shiftKey=o.shiftKey,this.metaKey=o.metaKey,this.pointerId=o.pointerId||0,this.pointerType=o.pointerType,this.state=o.state,this.i=o,o.defaultPrevented&&de.Z.h.call(this)},de.prototype.h=function(){de.Z.h.call(this);const o=this.i;o.preventDefault?o.preventDefault():o.returnValue=!1};var Xe="closure_listenable_"+(Math.random()*1e6|0),it=0;function xe(o,u,f,p,b){this.listener=o,this.proxy=null,this.src=u,this.type=f,this.capture=!!p,this.ha=b,this.key=++it,this.da=this.fa=!1}function Fe(o){o.da=!0,o.listener=null,o.proxy=null,o.src=null,o.ha=null}function Nt(o,u,f){for(const p in o)u.call(f,o[p],p,o)}function Hr(o,u){for(const f in o)u.call(void 0,o[f],f,o)}function Jn(o){const u={};for(const f in o)u[f]=o[f];return u}const Hs="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function No(o,u){let f,p;for(let b=1;b<arguments.length;b++){p=arguments[b];for(f in p)o[f]=p[f];for(let R=0;R<Hs.length;R++)f=Hs[R],Object.prototype.hasOwnProperty.call(p,f)&&(o[f]=p[f])}}function Ws(o){this.src=o,this.g={},this.h=0}Ws.prototype.add=function(o,u,f,p,b){const R=o.toString();o=this.g[R],o||(o=this.g[R]=[],this.h++);const D=Vo(o,u,p,b);return D>-1?(u=o[D],f||(u.fa=!1)):(u=new xe(u,this.src,R,!!p,b),u.fa=f,o.push(u)),u};function Do(o,u){const f=u.type;if(f in o.g){var p=o.g[f],b=Array.prototype.indexOf.call(p,u,void 0),R;(R=b>=0)&&Array.prototype.splice.call(p,b,1),R&&(Fe(u),o.g[f].length==0&&(delete o.g[f],o.h--))}}function Vo(o,u,f,p){for(let b=0;b<o.length;++b){const R=o[b];if(!R.da&&R.listener==u&&R.capture==!!f&&R.ha==p)return b}return-1}var Oo="closure_lm_"+(Math.random()*1e6|0),Mo={};function pu(o,u,f,p,b){if(Array.isArray(u)){for(let R=0;R<u.length;R++)pu(o,u[R],f,p,b);return null}return f=_u(f),o&&o[Xe]?o.J(u,f,c(p)?!!p.capture:!1,b):lm(o,u,f,!1,p,b)}function lm(o,u,f,p,b,R){if(!u)throw Error("Invalid event type");const D=c(b)?!!b.capture:!!b;let H=xo(o);if(H||(o[Oo]=H=new Ws(o)),f=H.add(u,f,p,D,R),f.proxy)return f;if(p=hm(),f.proxy=p,p.src=o,p.listener=f,o.addEventListener)A||(b=D),b===void 0&&(b=!1),o.addEventListener(u.toString(),p,b);else if(o.attachEvent)o.attachEvent(gu(u.toString()),p);else if(o.addListener&&o.removeListener)o.addListener(p);else throw Error("addEventListener and attachEvent are unavailable.");return f}function hm(){function o(f){return u.call(o.src,o.listener,f)}const u=fm;return o}function mu(o,u,f,p,b){if(Array.isArray(u))for(var R=0;R<u.length;R++)mu(o,u[R],f,p,b);else p=c(p)?!!p.capture:!!p,f=_u(f),o&&o[Xe]?(o=o.i,R=String(u).toString(),R in o.g&&(u=o.g[R],f=Vo(u,f,p,b),f>-1&&(Fe(u[f]),Array.prototype.splice.call(u,f,1),u.length==0&&(delete o.g[R],o.h--)))):o&&(o=xo(o))&&(u=o.g[u.toString()],o=-1,u&&(o=Vo(u,f,p,b)),(f=o>-1?u[o]:null)&&Lo(f))}function Lo(o){if(typeof o!="number"&&o&&!o.da){var u=o.src;if(u&&u[Xe])Do(u.i,o);else{var f=o.type,p=o.proxy;u.removeEventListener?u.removeEventListener(f,p,o.capture):u.detachEvent?u.detachEvent(gu(f),p):u.addListener&&u.removeListener&&u.removeListener(p),(f=xo(u))?(Do(f,o),f.h==0&&(f.src=null,u[Oo]=null)):Fe(o)}}}function gu(o){return o in Mo?Mo[o]:Mo[o]="on"+o}function fm(o,u){if(o.da)o=!0;else{u=new de(u,this);const f=o.listener,p=o.ha||o.src;o.fa&&Lo(o),o=f.call(p,u)}return o}function xo(o){return o=o[Oo],o instanceof Ws?o:null}var Fo="__closure_events_fn_"+(Math.random()*1e9>>>0);function _u(o){return typeof o=="function"?o:(o[Fo]||(o[Fo]=function(u){return o.handleEvent(u)}),o[Fo])}function ke(){w.call(this),this.i=new Ws(this),this.M=this,this.G=null}m(ke,w),ke.prototype[Xe]=!0,ke.prototype.removeEventListener=function(o,u,f,p){mu(this,o,u,f,p)};function Ue(o,u){var f,p=o.G;if(p)for(f=[];p;p=p.G)f.push(p);if(o=o.M,p=u.type||u,typeof u=="string")u=new E(u,o);else if(u instanceof E)u.target=u.target||o;else{var b=u;u=new E(p,o),No(u,b)}b=!0;let R,D;if(f)for(D=f.length-1;D>=0;D--)R=u.g=f[D],b=Gs(R,p,!0,u)&&b;if(R=u.g=o,b=Gs(R,p,!0,u)&&b,b=Gs(R,p,!1,u)&&b,f)for(D=0;D<f.length;D++)R=u.g=f[D],b=Gs(R,p,!1,u)&&b}ke.prototype.N=function(){if(ke.Z.N.call(this),this.i){var o=this.i;for(const u in o.g){const f=o.g[u];for(let p=0;p<f.length;p++)Fe(f[p]);delete o.g[u],o.h--}}this.G=null},ke.prototype.J=function(o,u,f,p){return this.i.add(String(o),u,!1,f,p)},ke.prototype.K=function(o,u,f,p){return this.i.add(String(o),u,!0,f,p)};function Gs(o,u,f,p){if(u=o.i.g[String(u)],!u)return!0;u=u.concat();let b=!0;for(let R=0;R<u.length;++R){const D=u[R];if(D&&!D.da&&D.capture==f){const H=D.listener,_e=D.ha||D.src;D.fa&&Do(o.i,D),b=H.call(_e,p)!==!1&&b}}return b&&!p.defaultPrevented}function dm(o,u){if(typeof o!="function")if(o&&typeof o.handleEvent=="function")o=h(o.handleEvent,o);else throw Error("Invalid listener argument");return Number(u)>2147483647?-1:a.setTimeout(o,u||0)}function yu(o){o.g=dm(()=>{o.g=null,o.i&&(o.i=!1,yu(o))},o.l);const u=o.h;o.h=null,o.m.apply(null,u)}class pm extends w{constructor(u,f){super(),this.m=u,this.l=f,this.h=null,this.i=!1,this.g=null}j(u){this.h=arguments,this.g?this.i=!0:yu(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Wr(o){w.call(this),this.h=o,this.g={}}m(Wr,w);var vu=[];function Eu(o){Nt(o.g,function(u,f){this.g.hasOwnProperty(f)&&Lo(u)},o),o.g={}}Wr.prototype.N=function(){Wr.Z.N.call(this),Eu(this)},Wr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Uo=a.JSON.stringify,mm=a.JSON.parse,gm=class{stringify(o){return a.JSON.stringify(o,void 0)}parse(o){return a.JSON.parse(o,void 0)}};function Tu(){}function Iu(){}var Gr={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Bo(){E.call(this,"d")}m(Bo,E);function $o(){E.call(this,"c")}m($o,E);var bn={},wu=null;function Ks(){return wu=wu||new ke}bn.Ia="serverreachability";function Au(o){E.call(this,bn.Ia,o)}m(Au,E);function Kr(o){const u=Ks();Ue(u,new Au(u))}bn.STAT_EVENT="statevent";function bu(o,u){E.call(this,bn.STAT_EVENT,o),this.stat=u}m(bu,E);function Be(o){const u=Ks();Ue(u,new bu(u,o))}bn.Ja="timingevent";function Ru(o,u){E.call(this,bn.Ja,o),this.size=u}m(Ru,E);function Qr(o,u){if(typeof o!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){o()},u)}function Xr(){this.g=!0}Xr.prototype.ua=function(){this.g=!1};function _m(o,u,f,p,b,R){o.info(function(){if(o.g)if(R){var D="",H=R.split("&");for(let ne=0;ne<H.length;ne++){var _e=H[ne].split("=");if(_e.length>1){const we=_e[0];_e=_e[1];const ft=we.split("_");D=ft.length>=2&&ft[1]=="type"?D+(we+"="+_e+"&"):D+(we+"=redacted&")}}}else D=null;else D=R;return"XMLHTTP REQ ("+p+") [attempt "+b+"]: "+u+`
`+f+`
`+D})}function ym(o,u,f,p,b,R,D){o.info(function(){return"XMLHTTP RESP ("+p+") [ attempt "+b+"]: "+u+`
`+f+`
`+R+" "+D})}function Yn(o,u,f,p){o.info(function(){return"XMLHTTP TEXT ("+u+"): "+Em(o,f)+(p?" "+p:"")})}function vm(o,u){o.info(function(){return"TIMEOUT: "+u})}Xr.prototype.info=function(){};function Em(o,u){if(!o.g)return u;if(!u)return null;try{const R=JSON.parse(u);if(R){for(o=0;o<R.length;o++)if(Array.isArray(R[o])){var f=R[o];if(!(f.length<2)){var p=f[1];if(Array.isArray(p)&&!(p.length<1)){var b=p[0];if(b!="noop"&&b!="stop"&&b!="close")for(let D=1;D<p.length;D++)p[D]=""}}}}return Uo(R)}catch{return u}}var Qs={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Su={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Pu;function jo(){}m(jo,Tu),jo.prototype.g=function(){return new XMLHttpRequest},Pu=new jo;function Jr(o){return encodeURIComponent(String(o))}function Tm(o){var u=1;o=o.split(":");const f=[];for(;u>0&&o.length;)f.push(o.shift()),u--;return o.length&&f.push(o.join(":")),f}function Wt(o,u,f,p){this.j=o,this.i=u,this.l=f,this.S=p||1,this.V=new Wr(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Cu}function Cu(){this.i=null,this.g="",this.h=!1}var ku={},qo={};function zo(o,u,f){o.M=1,o.A=Js(ht(u)),o.u=f,o.R=!0,Nu(o,null)}function Nu(o,u){o.F=Date.now(),Xs(o),o.B=ht(o.A);var f=o.B,p=o.S;Array.isArray(p)||(p=[String(p)]),zu(f.i,"t",p),o.C=0,f=o.j.L,o.h=new Cu,o.g=cl(o.j,f?u:null,!o.u),o.P>0&&(o.O=new pm(h(o.Y,o,o.g),o.P)),u=o.V,f=o.g,p=o.ba;var b="readystatechange";Array.isArray(b)||(b&&(vu[0]=b.toString()),b=vu);for(let R=0;R<b.length;R++){const D=pu(f,b[R],p||u.handleEvent,!1,u.h||u);if(!D)break;u.g[D.key]=D}u=o.J?Jn(o.J):{},o.u?(o.v||(o.v="POST"),u["Content-Type"]="application/x-www-form-urlencoded",o.g.ea(o.B,o.v,o.u,u)):(o.v="GET",o.g.ea(o.B,o.v,null,u)),Kr(),_m(o.i,o.v,o.B,o.l,o.S,o.u)}Wt.prototype.ba=function(o){o=o.target;const u=this.O;u&&Qt(o)==3?u.j():this.Y(o)},Wt.prototype.Y=function(o){try{if(o==this.g)e:{const H=Qt(this.g),_e=this.g.ya(),ne=this.g.ca();if(!(H<3)&&(H!=3||this.g&&(this.h.h||this.g.la()||Ju(this.g)))){this.K||H!=4||_e==7||(_e==8||ne<=0?Kr(3):Kr(2)),Ho(this);var u=this.g.ca();this.X=u;var f=Im(this);if(this.o=u==200,ym(this.i,this.v,this.B,this.l,this.S,H,u),this.o){if(this.U&&!this.L){t:{if(this.g){var p,b=this.g;if((p=b.g?b.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!v(p)){var R=p;break t}}R=null}if(o=R)Yn(this.i,this.l,o,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Wo(this,o);else{this.o=!1,this.m=3,Be(12),Rn(this),Yr(this);break e}}if(this.R){o=!0;let we;for(;!this.K&&this.C<f.length;)if(we=wm(this,f),we==qo){H==4&&(this.m=4,Be(14),o=!1),Yn(this.i,this.l,null,"[Incomplete Response]");break}else if(we==ku){this.m=4,Be(15),Yn(this.i,this.l,f,"[Invalid Chunk]"),o=!1;break}else Yn(this.i,this.l,we,null),Wo(this,we);if(Du(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),H!=4||f.length!=0||this.h.h||(this.m=1,Be(16),o=!1),this.o=this.o&&o,!o)Yn(this.i,this.l,f,"[Invalid Chunked Response]"),Rn(this),Yr(this);else if(f.length>0&&!this.W){this.W=!0;var D=this.j;D.g==this&&D.aa&&!D.P&&(D.j.info("Great, no buffering proxy detected. Bytes received: "+f.length),ea(D),D.P=!0,Be(11))}}else Yn(this.i,this.l,f,null),Wo(this,f);H==4&&Rn(this),this.o&&!this.K&&(H==4?sl(this.j,this):(this.o=!1,Xs(this)))}else xm(this.g),u==400&&f.indexOf("Unknown SID")>0?(this.m=3,Be(12)):(this.m=0,Be(13)),Rn(this),Yr(this)}}}catch{}finally{}};function Im(o){if(!Du(o))return o.g.la();const u=Ju(o.g);if(u==="")return"";let f="";const p=u.length,b=Qt(o.g)==4;if(!o.h.i){if(typeof TextDecoder>"u")return Rn(o),Yr(o),"";o.h.i=new a.TextDecoder}for(let R=0;R<p;R++)o.h.h=!0,f+=o.h.i.decode(u[R],{stream:!(b&&R==p-1)});return u.length=0,o.h.g+=f,o.C=0,o.h.g}function Du(o){return o.g?o.v=="GET"&&o.M!=2&&o.j.Aa:!1}function wm(o,u){var f=o.C,p=u.indexOf(`
`,f);return p==-1?qo:(f=Number(u.substring(f,p)),isNaN(f)?ku:(p+=1,p+f>u.length?qo:(u=u.slice(p,p+f),o.C=p+f,u)))}Wt.prototype.cancel=function(){this.K=!0,Rn(this)};function Xs(o){o.T=Date.now()+o.H,Vu(o,o.H)}function Vu(o,u){if(o.D!=null)throw Error("WatchDog timer not null");o.D=Qr(h(o.aa,o),u)}function Ho(o){o.D&&(a.clearTimeout(o.D),o.D=null)}Wt.prototype.aa=function(){this.D=null;const o=Date.now();o-this.T>=0?(vm(this.i,this.B),this.M!=2&&(Kr(),Be(17)),Rn(this),this.m=2,Yr(this)):Vu(this,this.T-o)};function Yr(o){o.j.I==0||o.K||sl(o.j,o)}function Rn(o){Ho(o);var u=o.O;u&&typeof u.dispose=="function"&&u.dispose(),o.O=null,Eu(o.V),o.g&&(u=o.g,o.g=null,u.abort(),u.dispose())}function Wo(o,u){try{var f=o.j;if(f.I!=0&&(f.g==o||Go(f.h,o))){if(!o.L&&Go(f.h,o)&&f.I==3){try{var p=f.Ba.g.parse(u)}catch{p=null}if(Array.isArray(p)&&p.length==3){var b=p;if(b[0]==0){e:if(!f.v){if(f.g)if(f.g.F+3e3<o.F)ni(f),ei(f);else break e;Zo(f),Be(18)}}else f.xa=b[1],0<f.xa-f.K&&b[2]<37500&&f.F&&f.A==0&&!f.C&&(f.C=Qr(h(f.Va,f),6e3));Lu(f.h)<=1&&f.ta&&(f.ta=void 0)}else Pn(f,11)}else if((o.L||f.g==o)&&ni(f),!v(u))for(b=f.Ba.g.parse(u),u=0;u<b.length;u++){let ne=b[u];const we=ne[0];if(!(we<=f.K))if(f.K=we,ne=ne[1],f.I==2)if(ne[0]=="c"){f.M=ne[1],f.ba=ne[2];const ft=ne[3];ft!=null&&(f.ka=ft,f.j.info("VER="+f.ka));const Cn=ne[4];Cn!=null&&(f.za=Cn,f.j.info("SVER="+f.za));const Xt=ne[5];Xt!=null&&typeof Xt=="number"&&Xt>0&&(p=1.5*Xt,f.O=p,f.j.info("backChannelRequestTimeoutMs_="+p)),p=f;const Jt=o.g;if(Jt){const si=Jt.g?Jt.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(si){var R=p.h;R.g||si.indexOf("spdy")==-1&&si.indexOf("quic")==-1&&si.indexOf("h2")==-1||(R.j=R.l,R.g=new Set,R.h&&(Ko(R,R.h),R.h=null))}if(p.G){const ta=Jt.g?Jt.g.getResponseHeader("X-HTTP-Session-Id"):null;ta&&(p.wa=ta,se(p.J,p.G,ta))}}f.I=3,f.l&&f.l.ra(),f.aa&&(f.T=Date.now()-o.F,f.j.info("Handshake RTT: "+f.T+"ms")),p=f;var D=o;if(p.na=al(p,p.L?p.ba:null,p.W),D.L){xu(p.h,D);var H=D,_e=p.O;_e&&(H.H=_e),H.D&&(Ho(H),Xs(H)),p.g=D}else nl(p);f.i.length>0&&ti(f)}else ne[0]!="stop"&&ne[0]!="close"||Pn(f,7);else f.I==3&&(ne[0]=="stop"||ne[0]=="close"?ne[0]=="stop"?Pn(f,7):Yo(f):ne[0]!="noop"&&f.l&&f.l.qa(ne),f.A=0)}}Kr(4)}catch{}}var Am=class{constructor(o,u){this.g=o,this.map=u}};function Ou(o){this.l=o||10,a.PerformanceNavigationTiming?(o=a.performance.getEntriesByType("navigation"),o=o.length>0&&(o[0].nextHopProtocol=="hq"||o[0].nextHopProtocol=="h2")):o=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=o?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Mu(o){return o.h?!0:o.g?o.g.size>=o.j:!1}function Lu(o){return o.h?1:o.g?o.g.size:0}function Go(o,u){return o.h?o.h==u:o.g?o.g.has(u):!1}function Ko(o,u){o.g?o.g.add(u):o.h=u}function xu(o,u){o.h&&o.h==u?o.h=null:o.g&&o.g.has(u)&&o.g.delete(u)}Ou.prototype.cancel=function(){if(this.i=Fu(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const o of this.g.values())o.cancel();this.g.clear()}};function Fu(o){if(o.h!=null)return o.i.concat(o.h.G);if(o.g!=null&&o.g.size!==0){let u=o.i;for(const f of o.g.values())u=u.concat(f.G);return u}return I(o.i)}var Uu=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function bm(o,u){if(o){o=o.split("&");for(let f=0;f<o.length;f++){const p=o[f].indexOf("=");let b,R=null;p>=0?(b=o[f].substring(0,p),R=o[f].substring(p+1)):b=o[f],u(b,R?decodeURIComponent(R.replace(/\+/g," ")):"")}}}function Gt(o){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let u;o instanceof Gt?(this.l=o.l,Zr(this,o.j),this.o=o.o,this.g=o.g,es(this,o.u),this.h=o.h,Qo(this,Hu(o.i)),this.m=o.m):o&&(u=String(o).match(Uu))?(this.l=!1,Zr(this,u[1]||"",!0),this.o=ts(u[2]||""),this.g=ts(u[3]||"",!0),es(this,u[4]),this.h=ts(u[5]||"",!0),Qo(this,u[6]||"",!0),this.m=ts(u[7]||"")):(this.l=!1,this.i=new rs(null,this.l))}Gt.prototype.toString=function(){const o=[];var u=this.j;u&&o.push(ns(u,Bu,!0),":");var f=this.g;return(f||u=="file")&&(o.push("//"),(u=this.o)&&o.push(ns(u,Bu,!0),"@"),o.push(Jr(f).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f=this.u,f!=null&&o.push(":",String(f))),(f=this.h)&&(this.g&&f.charAt(0)!="/"&&o.push("/"),o.push(ns(f,f.charAt(0)=="/"?Pm:Sm,!0))),(f=this.i.toString())&&o.push("?",f),(f=this.m)&&o.push("#",ns(f,km)),o.join("")},Gt.prototype.resolve=function(o){const u=ht(this);let f=!!o.j;f?Zr(u,o.j):f=!!o.o,f?u.o=o.o:f=!!o.g,f?u.g=o.g:f=o.u!=null;var p=o.h;if(f)es(u,o.u);else if(f=!!o.h){if(p.charAt(0)!="/")if(this.g&&!this.h)p="/"+p;else{var b=u.h.lastIndexOf("/");b!=-1&&(p=u.h.slice(0,b+1)+p)}if(b=p,b==".."||b==".")p="";else if(b.indexOf("./")!=-1||b.indexOf("/.")!=-1){p=b.lastIndexOf("/",0)==0,b=b.split("/");const R=[];for(let D=0;D<b.length;){const H=b[D++];H=="."?p&&D==b.length&&R.push(""):H==".."?((R.length>1||R.length==1&&R[0]!="")&&R.pop(),p&&D==b.length&&R.push("")):(R.push(H),p=!0)}p=R.join("/")}else p=b}return f?u.h=p:f=o.i.toString()!=="",f?Qo(u,Hu(o.i)):f=!!o.m,f&&(u.m=o.m),u};function ht(o){return new Gt(o)}function Zr(o,u,f){o.j=f?ts(u,!0):u,o.j&&(o.j=o.j.replace(/:$/,""))}function es(o,u){if(u){if(u=Number(u),isNaN(u)||u<0)throw Error("Bad port number "+u);o.u=u}else o.u=null}function Qo(o,u,f){u instanceof rs?(o.i=u,Nm(o.i,o.l)):(f||(u=ns(u,Cm)),o.i=new rs(u,o.l))}function se(o,u,f){o.i.set(u,f)}function Js(o){return se(o,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),o}function ts(o,u){return o?u?decodeURI(o.replace(/%25/g,"%2525")):decodeURIComponent(o):""}function ns(o,u,f){return typeof o=="string"?(o=encodeURI(o).replace(u,Rm),f&&(o=o.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),o):null}function Rm(o){return o=o.charCodeAt(0),"%"+(o>>4&15).toString(16)+(o&15).toString(16)}var Bu=/[#\/\?@]/g,Sm=/[#\?:]/g,Pm=/[#\?]/g,Cm=/[#\?@]/g,km=/#/g;function rs(o,u){this.h=this.g=null,this.i=o||null,this.j=!!u}function Sn(o){o.g||(o.g=new Map,o.h=0,o.i&&bm(o.i,function(u,f){o.add(decodeURIComponent(u.replace(/\+/g," ")),f)}))}n=rs.prototype,n.add=function(o,u){Sn(this),this.i=null,o=Zn(this,o);let f=this.g.get(o);return f||this.g.set(o,f=[]),f.push(u),this.h+=1,this};function $u(o,u){Sn(o),u=Zn(o,u),o.g.has(u)&&(o.i=null,o.h-=o.g.get(u).length,o.g.delete(u))}function ju(o,u){return Sn(o),u=Zn(o,u),o.g.has(u)}n.forEach=function(o,u){Sn(this),this.g.forEach(function(f,p){f.forEach(function(b){o.call(u,b,p,this)},this)},this)};function qu(o,u){Sn(o);let f=[];if(typeof u=="string")ju(o,u)&&(f=f.concat(o.g.get(Zn(o,u))));else for(o=Array.from(o.g.values()),u=0;u<o.length;u++)f=f.concat(o[u]);return f}n.set=function(o,u){return Sn(this),this.i=null,o=Zn(this,o),ju(this,o)&&(this.h-=this.g.get(o).length),this.g.set(o,[u]),this.h+=1,this},n.get=function(o,u){return o?(o=qu(this,o),o.length>0?String(o[0]):u):u};function zu(o,u,f){$u(o,u),f.length>0&&(o.i=null,o.g.set(Zn(o,u),I(f)),o.h+=f.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const o=[],u=Array.from(this.g.keys());for(let p=0;p<u.length;p++){var f=u[p];const b=Jr(f);f=qu(this,f);for(let R=0;R<f.length;R++){let D=b;f[R]!==""&&(D+="="+Jr(f[R])),o.push(D)}}return this.i=o.join("&")};function Hu(o){const u=new rs;return u.i=o.i,o.g&&(u.g=new Map(o.g),u.h=o.h),u}function Zn(o,u){return u=String(u),o.j&&(u=u.toLowerCase()),u}function Nm(o,u){u&&!o.j&&(Sn(o),o.i=null,o.g.forEach(function(f,p){const b=p.toLowerCase();p!=b&&($u(this,p),zu(this,b,f))},o)),o.j=u}function Dm(o,u){const f=new Xr;if(a.Image){const p=new Image;p.onload=d(Kt,f,"TestLoadImage: loaded",!0,u,p),p.onerror=d(Kt,f,"TestLoadImage: error",!1,u,p),p.onabort=d(Kt,f,"TestLoadImage: abort",!1,u,p),p.ontimeout=d(Kt,f,"TestLoadImage: timeout",!1,u,p),a.setTimeout(function(){p.ontimeout&&p.ontimeout()},1e4),p.src=o}else u(!1)}function Vm(o,u){const f=new Xr,p=new AbortController,b=setTimeout(()=>{p.abort(),Kt(f,"TestPingServer: timeout",!1,u)},1e4);fetch(o,{signal:p.signal}).then(R=>{clearTimeout(b),R.ok?Kt(f,"TestPingServer: ok",!0,u):Kt(f,"TestPingServer: server error",!1,u)}).catch(()=>{clearTimeout(b),Kt(f,"TestPingServer: error",!1,u)})}function Kt(o,u,f,p,b){try{b&&(b.onload=null,b.onerror=null,b.onabort=null,b.ontimeout=null),p(f)}catch{}}function Om(){this.g=new gm}function Xo(o){this.i=o.Sb||null,this.h=o.ab||!1}m(Xo,Tu),Xo.prototype.g=function(){return new Ys(this.i,this.h)};function Ys(o,u){ke.call(this),this.H=o,this.o=u,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}m(Ys,ke),n=Ys.prototype,n.open=function(o,u){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=o,this.D=u,this.readyState=1,is(this)},n.send=function(o){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const u={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};o&&(u.body=o),(this.H||a).fetch(new Request(this.D,u)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,ss(this)),this.readyState=0},n.Pa=function(o){if(this.g&&(this.l=o,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=o.headers,this.readyState=2,is(this)),this.g&&(this.readyState=3,is(this),this.g)))if(this.responseType==="arraybuffer")o.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in o){if(this.j=o.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Wu(this)}else o.text().then(this.Oa.bind(this),this.ga.bind(this))};function Wu(o){o.j.read().then(o.Ma.bind(o)).catch(o.ga.bind(o))}n.Ma=function(o){if(this.g){if(this.o&&o.value)this.response.push(o.value);else if(!this.o){var u=o.value?o.value:new Uint8Array(0);(u=this.B.decode(u,{stream:!o.done}))&&(this.response=this.responseText+=u)}o.done?ss(this):is(this),this.readyState==3&&Wu(this)}},n.Oa=function(o){this.g&&(this.response=this.responseText=o,ss(this))},n.Na=function(o){this.g&&(this.response=o,ss(this))},n.ga=function(){this.g&&ss(this)};function ss(o){o.readyState=4,o.l=null,o.j=null,o.B=null,is(o)}n.setRequestHeader=function(o,u){this.A.append(o,u)},n.getResponseHeader=function(o){return this.h&&this.h.get(o.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const o=[],u=this.h.entries();for(var f=u.next();!f.done;)f=f.value,o.push(f[0]+": "+f[1]),f=u.next();return o.join(`\r
`)};function is(o){o.onreadystatechange&&o.onreadystatechange.call(o)}Object.defineProperty(Ys.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(o){this.m=o?"include":"same-origin"}});function Gu(o){let u="";return Nt(o,function(f,p){u+=p,u+=":",u+=f,u+=`\r
`}),u}function Jo(o,u,f){e:{for(p in f){var p=!1;break e}p=!0}p||(f=Gu(f),typeof o=="string"?f!=null&&Jr(f):se(o,u,f))}function ue(o){ke.call(this),this.headers=new Map,this.L=o||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}m(ue,ke);var Mm=/^https?$/i,Lm=["POST","PUT"];n=ue.prototype,n.Fa=function(o){this.H=o},n.ea=function(o,u,f,p){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+o);u=u?u.toUpperCase():"GET",this.D=o,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Pu.g(),this.g.onreadystatechange=g(h(this.Ca,this));try{this.B=!0,this.g.open(u,String(o),!0),this.B=!1}catch(R){Ku(this,R);return}if(o=f||"",f=new Map(this.headers),p)if(Object.getPrototypeOf(p)===Object.prototype)for(var b in p)f.set(b,p[b]);else if(typeof p.keys=="function"&&typeof p.get=="function")for(const R of p.keys())f.set(R,p.get(R));else throw Error("Unknown input type for opt_headers: "+String(p));p=Array.from(f.keys()).find(R=>R.toLowerCase()=="content-type"),b=a.FormData&&o instanceof a.FormData,!(Array.prototype.indexOf.call(Lm,u,void 0)>=0)||p||b||f.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[R,D]of f)this.g.setRequestHeader(R,D);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(o),this.v=!1}catch(R){Ku(this,R)}};function Ku(o,u){o.h=!1,o.g&&(o.j=!0,o.g.abort(),o.j=!1),o.l=u,o.o=5,Qu(o),Zs(o)}function Qu(o){o.A||(o.A=!0,Ue(o,"complete"),Ue(o,"error"))}n.abort=function(o){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=o||7,Ue(this,"complete"),Ue(this,"abort"),Zs(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Zs(this,!0)),ue.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?Xu(this):this.Xa())},n.Xa=function(){Xu(this)};function Xu(o){if(o.h&&typeof i<"u"){if(o.v&&Qt(o)==4)setTimeout(o.Ca.bind(o),0);else if(Ue(o,"readystatechange"),Qt(o)==4){o.h=!1;try{const R=o.ca();e:switch(R){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var u=!0;break e;default:u=!1}var f;if(!(f=u)){var p;if(p=R===0){let D=String(o.D).match(Uu)[1]||null;!D&&a.self&&a.self.location&&(D=a.self.location.protocol.slice(0,-1)),p=!Mm.test(D?D.toLowerCase():"")}f=p}if(f)Ue(o,"complete"),Ue(o,"success");else{o.o=6;try{var b=Qt(o)>2?o.g.statusText:""}catch{b=""}o.l=b+" ["+o.ca()+"]",Qu(o)}}finally{Zs(o)}}}}function Zs(o,u){if(o.g){o.m&&(clearTimeout(o.m),o.m=null);const f=o.g;o.g=null,u||Ue(o,"ready");try{f.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function Qt(o){return o.g?o.g.readyState:0}n.ca=function(){try{return Qt(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(o){if(this.g){var u=this.g.responseText;return o&&u.indexOf(o)==0&&(u=u.substring(o.length)),mm(u)}};function Ju(o){try{if(!o.g)return null;if("response"in o.g)return o.g.response;switch(o.F){case"":case"text":return o.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in o.g)return o.g.mozResponseArrayBuffer}return null}catch{return null}}function xm(o){const u={};o=(o.g&&Qt(o)>=2&&o.g.getAllResponseHeaders()||"").split(`\r
`);for(let p=0;p<o.length;p++){if(v(o[p]))continue;var f=Tm(o[p]);const b=f[0];if(f=f[1],typeof f!="string")continue;f=f.trim();const R=u[b]||[];u[b]=R,R.push(f)}Hr(u,function(p){return p.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function os(o,u,f){return f&&f.internalChannelParams&&f.internalChannelParams[o]||u}function Yu(o){this.za=0,this.i=[],this.j=new Xr,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=os("failFast",!1,o),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=os("baseRetryDelayMs",5e3,o),this.Za=os("retryDelaySeedMs",1e4,o),this.Ta=os("forwardChannelMaxRetries",2,o),this.va=os("forwardChannelRequestTimeoutMs",2e4,o),this.ma=o&&o.xmlHttpFactory||void 0,this.Ua=o&&o.Rb||void 0,this.Aa=o&&o.useFetchStreams||!1,this.O=void 0,this.L=o&&o.supportsCrossDomainXhr||!1,this.M="",this.h=new Ou(o&&o.concurrentRequestLimit),this.Ba=new Om,this.S=o&&o.fastHandshake||!1,this.R=o&&o.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=o&&o.Pb||!1,o&&o.ua&&this.j.ua(),o&&o.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&o&&o.detectBufferingProxy||!1,this.ia=void 0,o&&o.longPollingTimeout&&o.longPollingTimeout>0&&(this.ia=o.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Yu.prototype,n.ka=8,n.I=1,n.connect=function(o,u,f,p){Be(0),this.W=o,this.H=u||{},f&&p!==void 0&&(this.H.OSID=f,this.H.OAID=p),this.F=this.X,this.J=al(this,null,this.W),ti(this)};function Yo(o){if(Zu(o),o.I==3){var u=o.V++,f=ht(o.J);if(se(f,"SID",o.M),se(f,"RID",u),se(f,"TYPE","terminate"),as(o,f),u=new Wt(o,o.j,u),u.M=2,u.A=Js(ht(f)),f=!1,a.navigator&&a.navigator.sendBeacon)try{f=a.navigator.sendBeacon(u.A.toString(),"")}catch{}!f&&a.Image&&(new Image().src=u.A,f=!0),f||(u.g=cl(u.j,null),u.g.ea(u.A)),u.F=Date.now(),Xs(u)}ol(o)}function ei(o){o.g&&(ea(o),o.g.cancel(),o.g=null)}function Zu(o){ei(o),o.v&&(a.clearTimeout(o.v),o.v=null),ni(o),o.h.cancel(),o.m&&(typeof o.m=="number"&&a.clearTimeout(o.m),o.m=null)}function ti(o){if(!Mu(o.h)&&!o.m){o.m=!0;var u=o.Ea;Y||_(),Z||(Y(),Z=!0),T.add(u,o),o.D=0}}function Fm(o,u){return Lu(o.h)>=o.h.j-(o.m?1:0)?!1:o.m?(o.i=u.G.concat(o.i),!0):o.I==1||o.I==2||o.D>=(o.Sa?0:o.Ta)?!1:(o.m=Qr(h(o.Ea,o,u),il(o,o.D)),o.D++,!0)}n.Ea=function(o){if(this.m)if(this.m=null,this.I==1){if(!o){this.V=Math.floor(Math.random()*1e5),o=this.V++;const b=new Wt(this,this.j,o);let R=this.o;if(this.U&&(R?(R=Jn(R),No(R,this.U)):R=this.U),this.u!==null||this.R||(b.J=R,R=null),this.S)e:{for(var u=0,f=0;f<this.i.length;f++){t:{var p=this.i[f];if("__data__"in p.map&&(p=p.map.__data__,typeof p=="string")){p=p.length;break t}p=void 0}if(p===void 0)break;if(u+=p,u>4096){u=f;break e}if(u===4096||f===this.i.length-1){u=f+1;break e}}u=1e3}else u=1e3;u=tl(this,b,u),f=ht(this.J),se(f,"RID",o),se(f,"CVER",22),this.G&&se(f,"X-HTTP-Session-Id",this.G),as(this,f),R&&(this.R?u="headers="+Jr(Gu(R))+"&"+u:this.u&&Jo(f,this.u,R)),Ko(this.h,b),this.Ra&&se(f,"TYPE","init"),this.S?(se(f,"$req",u),se(f,"SID","null"),b.U=!0,zo(b,f,null)):zo(b,f,u),this.I=2}}else this.I==3&&(o?el(this,o):this.i.length==0||Mu(this.h)||el(this))};function el(o,u){var f;u?f=u.l:f=o.V++;const p=ht(o.J);se(p,"SID",o.M),se(p,"RID",f),se(p,"AID",o.K),as(o,p),o.u&&o.o&&Jo(p,o.u,o.o),f=new Wt(o,o.j,f,o.D+1),o.u===null&&(f.J=o.o),u&&(o.i=u.G.concat(o.i)),u=tl(o,f,1e3),f.H=Math.round(o.va*.5)+Math.round(o.va*.5*Math.random()),Ko(o.h,f),zo(f,p,u)}function as(o,u){o.H&&Nt(o.H,function(f,p){se(u,p,f)}),o.l&&Nt({},function(f,p){se(u,p,f)})}function tl(o,u,f){f=Math.min(o.i.length,f);const p=o.l?h(o.l.Ka,o.l,o):null;e:{var b=o.i;let H=-1;for(;;){const _e=["count="+f];H==-1?f>0?(H=b[0].g,_e.push("ofs="+H)):H=0:_e.push("ofs="+H);let ne=!0;for(let we=0;we<f;we++){var R=b[we].g;const ft=b[we].map;if(R-=H,R<0)H=Math.max(0,b[we].g-100),ne=!1;else try{R="req"+R+"_"||"";try{var D=ft instanceof Map?ft:Object.entries(ft);for(const[Cn,Xt]of D){let Jt=Xt;c(Xt)&&(Jt=Uo(Xt)),_e.push(R+Cn+"="+encodeURIComponent(Jt))}}catch(Cn){throw _e.push(R+"type="+encodeURIComponent("_badmap")),Cn}}catch{p&&p(ft)}}if(ne){D=_e.join("&");break e}}D=void 0}return o=o.i.splice(0,f),u.G=o,D}function nl(o){if(!o.g&&!o.v){o.Y=1;var u=o.Da;Y||_(),Z||(Y(),Z=!0),T.add(u,o),o.A=0}}function Zo(o){return o.g||o.v||o.A>=3?!1:(o.Y++,o.v=Qr(h(o.Da,o),il(o,o.A)),o.A++,!0)}n.Da=function(){if(this.v=null,rl(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var o=4*this.T;this.j.info("BP detection timer enabled: "+o),this.B=Qr(h(this.Wa,this),o)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Be(10),ei(this),rl(this))};function ea(o){o.B!=null&&(a.clearTimeout(o.B),o.B=null)}function rl(o){o.g=new Wt(o,o.j,"rpc",o.Y),o.u===null&&(o.g.J=o.o),o.g.P=0;var u=ht(o.na);se(u,"RID","rpc"),se(u,"SID",o.M),se(u,"AID",o.K),se(u,"CI",o.F?"0":"1"),!o.F&&o.ia&&se(u,"TO",o.ia),se(u,"TYPE","xmlhttp"),as(o,u),o.u&&o.o&&Jo(u,o.u,o.o),o.O&&(o.g.H=o.O);var f=o.g;o=o.ba,f.M=1,f.A=Js(ht(u)),f.u=null,f.R=!0,Nu(f,o)}n.Va=function(){this.C!=null&&(this.C=null,ei(this),Zo(this),Be(19))};function ni(o){o.C!=null&&(a.clearTimeout(o.C),o.C=null)}function sl(o,u){var f=null;if(o.g==u){ni(o),ea(o),o.g=null;var p=2}else if(Go(o.h,u))f=u.G,xu(o.h,u),p=1;else return;if(o.I!=0){if(u.o)if(p==1){f=u.u?u.u.length:0,u=Date.now()-u.F;var b=o.D;p=Ks(),Ue(p,new Ru(p,f)),ti(o)}else nl(o);else if(b=u.m,b==3||b==0&&u.X>0||!(p==1&&Fm(o,u)||p==2&&Zo(o)))switch(f&&f.length>0&&(u=o.h,u.i=u.i.concat(f)),b){case 1:Pn(o,5);break;case 4:Pn(o,10);break;case 3:Pn(o,6);break;default:Pn(o,2)}}}function il(o,u){let f=o.Qa+Math.floor(Math.random()*o.Za);return o.isActive()||(f*=2),f*u}function Pn(o,u){if(o.j.info("Error code "+u),u==2){var f=h(o.bb,o),p=o.Ua;const b=!p;p=new Gt(p||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Zr(p,"https"),Js(p),b?Dm(p.toString(),f):Vm(p.toString(),f)}else Be(2);o.I=0,o.l&&o.l.pa(u),ol(o),Zu(o)}n.bb=function(o){o?(this.j.info("Successfully pinged google.com"),Be(2)):(this.j.info("Failed to ping google.com"),Be(1))};function ol(o){if(o.I=0,o.ja=[],o.l){const u=Fu(o.h);(u.length!=0||o.i.length!=0)&&(P(o.ja,u),P(o.ja,o.i),o.h.i.length=0,I(o.i),o.i.length=0),o.l.oa()}}function al(o,u,f){var p=f instanceof Gt?ht(f):new Gt(f);if(p.g!="")u&&(p.g=u+"."+p.g),es(p,p.u);else{var b=a.location;p=b.protocol,u=u?u+"."+b.hostname:b.hostname,b=+b.port;const R=new Gt(null);p&&Zr(R,p),u&&(R.g=u),b&&es(R,b),f&&(R.h=f),p=R}return f=o.G,u=o.wa,f&&u&&se(p,f,u),se(p,"VER",o.ka),as(o,p),p}function cl(o,u,f){if(u&&!o.L)throw Error("Can't create secondary domain capable XhrIo object.");return u=o.Aa&&!o.ma?new ue(new Xo({ab:f})):new ue(o.ma),u.Fa(o.L),u}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function ul(){}n=ul.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function ri(){}ri.prototype.g=function(o,u){return new Je(o,u)};function Je(o,u){ke.call(this),this.g=new Yu(u),this.l=o,this.h=u&&u.messageUrlParams||null,o=u&&u.messageHeaders||null,u&&u.clientProtocolHeaderRequired&&(o?o["X-Client-Protocol"]="webchannel":o={"X-Client-Protocol":"webchannel"}),this.g.o=o,o=u&&u.initMessageHeaders||null,u&&u.messageContentType&&(o?o["X-WebChannel-Content-Type"]=u.messageContentType:o={"X-WebChannel-Content-Type":u.messageContentType}),u&&u.sa&&(o?o["X-WebChannel-Client-Profile"]=u.sa:o={"X-WebChannel-Client-Profile":u.sa}),this.g.U=o,(o=u&&u.Qb)&&!v(o)&&(this.g.u=o),this.A=u&&u.supportsCrossDomainXhr||!1,this.v=u&&u.sendRawJson||!1,(u=u&&u.httpSessionIdParam)&&!v(u)&&(this.g.G=u,o=this.h,o!==null&&u in o&&(o=this.h,u in o&&delete o[u])),this.j=new er(this)}m(Je,ke),Je.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Je.prototype.close=function(){Yo(this.g)},Je.prototype.o=function(o){var u=this.g;if(typeof o=="string"){var f={};f.__data__=o,o=f}else this.v&&(f={},f.__data__=Uo(o),o=f);u.i.push(new Am(u.Ya++,o)),u.I==3&&ti(u)},Je.prototype.N=function(){this.g.l=null,delete this.j,Yo(this.g),delete this.g,Je.Z.N.call(this)};function ll(o){Bo.call(this),o.__headers__&&(this.headers=o.__headers__,this.statusCode=o.__status__,delete o.__headers__,delete o.__status__);var u=o.__sm__;if(u){e:{for(const f in u){o=f;break e}o=void 0}(this.i=o)&&(o=this.i,u=u!==null&&o in u?u[o]:void 0),this.data=u}else this.data=o}m(ll,Bo);function hl(){$o.call(this),this.status=1}m(hl,$o);function er(o){this.g=o}m(er,ul),er.prototype.ra=function(){Ue(this.g,"a")},er.prototype.qa=function(o){Ue(this.g,new ll(o))},er.prototype.pa=function(o){Ue(this.g,new hl)},er.prototype.oa=function(){Ue(this.g,"b")},ri.prototype.createWebChannel=ri.prototype.g,Je.prototype.send=Je.prototype.o,Je.prototype.open=Je.prototype.m,Je.prototype.close=Je.prototype.close,ad=function(){return new ri},od=function(){return Ks()},id=bn,Na={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Qs.NO_ERROR=0,Qs.TIMEOUT=8,Qs.HTTP_ERROR=6,mi=Qs,Su.COMPLETE="complete",sd=Su,Iu.EventType=Gr,Gr.OPEN="a",Gr.CLOSE="b",Gr.ERROR="c",Gr.MESSAGE="d",ke.prototype.listen=ke.prototype.J,us=Iu,ue.prototype.listenOnce=ue.prototype.K,ue.prototype.getLastError=ue.prototype.Ha,ue.prototype.getLastErrorCode=ue.prototype.ya,ue.prototype.getStatus=ue.prototype.ca,ue.prototype.getResponseJson=ue.prototype.La,ue.prototype.getResponseText=ue.prototype.la,ue.prototype.send=ue.prototype.ea,ue.prototype.setWithCredentials=ue.prototype.Fa,rd=ue}).apply(typeof ai<"u"?ai:typeof self<"u"?self:typeof window<"u"?window:{});const xl="@firebase/firestore",Fl="4.9.2";class Ve{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Ve.UNAUTHENTICATED=new Ve(null),Ve.GOOGLE_CREDENTIALS=new Ve("google-credentials-uid"),Ve.FIRST_PARTY=new Ve("first-party-uid"),Ve.MOCK_USER=new Ve("mock-user");let Br="12.3.0";const qn=new vc("@firebase/firestore");function rr(){return qn.logLevel}function M(n,...e){if(qn.logLevel<=W.DEBUG){const t=e.map(Ic);qn.debug(`Firestore (${Br}): ${n}`,...t)}}function Ft(n,...e){if(qn.logLevel<=W.ERROR){const t=e.map(Ic);qn.error(`Firestore (${Br}): ${n}`,...t)}}function Sr(n,...e){if(qn.logLevel<=W.WARN){const t=e.map(Ic);qn.warn(`Firestore (${Br}): ${n}`,...t)}}function Ic(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function B(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,cd(n,r,t)}function cd(n,e,t){let r=`FIRESTORE (${Br}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw Ft(r),new Error(r)}function te(n,e,t,r){let s="Unexpected state";typeof t=="string"?s=t:r=t,n||cd(e,s,r)}function q(n,e){return n}const N={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class x extends kt{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Ln{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class ud{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Yy{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Ve.UNAUTHENTICATED)))}shutdown(){}}class Zy{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class ev{constructor(e){this.t=e,this.currentUser=Ve.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){te(this.o===void 0,42304);let r=this.i;const s=l=>this.i!==r?(r=this.i,t(l)):Promise.resolve();let i=new Ln;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Ln,e.enqueueRetryable((()=>s(this.currentUser)))};const a=()=>{const l=i;e.enqueueRetryable((async()=>{await l.promise,await s(this.currentUser)}))},c=l=>{M("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit((l=>c(l))),setTimeout((()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?c(l):(M("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Ln)}}),0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((r=>this.i!==e?(M("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(te(typeof r.accessToken=="string",31837,{l:r}),new ud(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return te(e===null||typeof e=="string",2055,{h:e}),new Ve(e)}}class tv{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=Ve.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class nv{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new tv(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(Ve.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Ul{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class rv{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,rt(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){te(this.o===void 0,3512);const r=i=>{i.error!=null&&M("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const a=i.token!==this.m;return this.m=i.token,M("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable((()=>r(i)))};const s=i=>{M("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((i=>s(i))),setTimeout((()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):M("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new Ul(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(te(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new Ul(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function sv(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}class wc{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=sv(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<t&&(r+=e.charAt(s[i]%62))}return r}}function G(n,e){return n<e?-1:n>e?1:0}function Da(n,e){const t=Math.min(n.length,e.length);for(let r=0;r<t;r++){const s=n.charAt(r),i=e.charAt(r);if(s!==i)return la(s)===la(i)?G(s,i):la(s)?1:-1}return G(n.length,e.length)}const iv=55296,ov=57343;function la(n){const e=n.charCodeAt(0);return e>=iv&&e<=ov}function Pr(n,e,t){return n.length===e.length&&n.every(((r,s)=>t(r,e[s])))}const Bl="__name__";class pt{constructor(e,t,r){t===void 0?t=0:t>e.length&&B(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&B(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return pt.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof pt?e.forEach((r=>{t.push(r)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let s=0;s<r;s++){const i=pt.compareSegments(e.get(s),t.get(s));if(i!==0)return i}return G(e.length,t.length)}static compareSegments(e,t){const r=pt.isNumericId(e),s=pt.isNumericId(t);return r&&!s?-1:!r&&s?1:r&&s?pt.extractNumericId(e).compare(pt.extractNumericId(t)):Da(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return hn.fromString(e.substring(4,e.length-2))}}class oe extends pt{construct(e,t,r){return new oe(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new x(N.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter((s=>s.length>0)))}return new oe(t)}static emptyPath(){return new oe([])}}const av=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Re extends pt{construct(e,t,r){return new Re(e,t,r)}static isValidIdentifier(e){return av.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Re.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Bl}static keyField(){return new Re([Bl])}static fromServerFormat(e){const t=[];let r="",s=0;const i=()=>{if(r.length===0)throw new x(N.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let a=!1;for(;s<e.length;){const c=e[s];if(c==="\\"){if(s+1===e.length)throw new x(N.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new x(N.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,s+=2}else c==="`"?(a=!a,s++):c!=="."||a?(r+=c,s++):(i(),s++)}if(i(),a)throw new x(N.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Re(t)}static emptyPath(){return new Re([])}}class U{constructor(e){this.path=e}static fromPath(e){return new U(oe.fromString(e))}static fromName(e){return new U(oe.fromString(e).popFirst(5))}static empty(){return new U(oe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&oe.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return oe.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new U(new oe(e.slice()))}}function ld(n,e,t){if(!t)throw new x(N.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function cv(n,e,t,r){if(e===!0&&r===!0)throw new x(N.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function $l(n){if(!U.isDocumentKey(n))throw new x(N.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function jl(n){if(U.isDocumentKey(n))throw new x(N.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function hd(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function Ac(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":B(12329,{type:typeof n})}function fn(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new x(N.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Ac(n);throw new x(N.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function me(n,e){const t={typeString:n};return e&&(t.value=e),t}function xs(n,e){if(!hd(n))throw new x(N.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const s=e[r].typeString,i="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}const a=n[r];if(s&&typeof a!==s){t=`JSON field '${r}' must be a ${s}.`;break}if(i!==void 0&&a!==i.value){t=`Expected '${r}' field to equal '${i.value}'`;break}}if(t)throw new x(N.INVALID_ARGUMENT,t);return!0}const ql=-62135596800,zl=1e6;class ae{static now(){return ae.fromMillis(Date.now())}static fromDate(e){return ae.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*zl);return new ae(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new x(N.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new x(N.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<ql)throw new x(N.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new x(N.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/zl}_compareTo(e){return this.seconds===e.seconds?G(this.nanoseconds,e.nanoseconds):G(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:ae._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(xs(e,ae._jsonSchema))return new ae(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-ql;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}ae._jsonSchemaVersion="firestore/timestamp/1.0",ae._jsonSchema={type:me("string",ae._jsonSchemaVersion),seconds:me("number"),nanoseconds:me("number")};class j{static fromTimestamp(e){return new j(e)}static min(){return new j(new ae(0,0))}static max(){return new j(new ae(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const bs=-1;function uv(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,s=j.fromTimestamp(r===1e9?new ae(t+1,0):new ae(t,r));return new mn(s,U.empty(),e)}function lv(n){return new mn(n.readTime,n.key,bs)}class mn{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new mn(j.min(),U.empty(),bs)}static max(){return new mn(j.max(),U.empty(),bs)}}function hv(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=U.comparator(n.documentKey,e.documentKey),t!==0?t:G(n.largestBatchId,e.largestBatchId))}const fv="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class dv{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function $r(n){if(n.code!==N.FAILED_PRECONDITION||n.message!==fv)throw n;M("LocalStore","Unexpectedly lost primary lease")}class k{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&B(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new k(((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(t,i).next(r,s)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof k?t:k.resolve(t)}catch(t){return k.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):k.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):k.reject(t)}static resolve(e){return new k(((t,r)=>{t(e)}))}static reject(e){return new k(((t,r)=>{r(e)}))}static waitFor(e){return new k(((t,r)=>{let s=0,i=0,a=!1;e.forEach((c=>{++s,c.next((()=>{++i,a&&i===s&&t()}),(l=>r(l)))})),a=!0,i===s&&t()}))}static or(e){let t=k.resolve(!1);for(const r of e)t=t.next((s=>s?k.resolve(s):r()));return t}static forEach(e,t){const r=[];return e.forEach(((s,i)=>{r.push(t.call(this,s,i))})),this.waitFor(r)}static mapArray(e,t){return new k(((r,s)=>{const i=e.length,a=new Array(i);let c=0;for(let l=0;l<i;l++){const h=l;t(e[h]).next((d=>{a[h]=d,++c,c===i&&r(a)}),(d=>s(d)))}}))}static doWhile(e,t){return new k(((r,s)=>{const i=()=>{e()===!0?t().next((()=>{i()}),s):r()};i()}))}}function pv(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function jr(n){return n.name==="IndexedDbTransactionError"}class uo{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>t.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}uo.ce=-1;const bc=-1;function lo(n){return n==null}function ki(n){return n===0&&1/n==-1/0}function mv(n){return typeof n=="number"&&Number.isInteger(n)&&!ki(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const fd="";function gv(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=Hl(e)),e=_v(n.get(t),e);return Hl(e)}function _v(n,e){let t=e;const r=n.length;for(let s=0;s<r;s++){const i=n.charAt(s);switch(i){case"\0":t+="";break;case fd:t+="";break;default:t+=i}}return t}function Hl(n){return n+fd+""}function Wl(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function wn(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function dd(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class ce{constructor(e,t){this.comparator=e,this.root=t||be.EMPTY}insert(e,t){return new ce(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,be.BLACK,null,null))}remove(e){return new ce(this.comparator,this.root.remove(e,this.comparator).copy(null,null,be.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return t+r.left.size;s<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,r)=>(e(t,r),!1)))}toString(){const e=[];return this.inorderTraversal(((t,r)=>(e.push(`${t}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ci(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ci(this.root,e,this.comparator,!1)}getReverseIterator(){return new ci(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ci(this.root,e,this.comparator,!0)}}class ci{constructor(e,t,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?r(e.key,t):1,t&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class be{constructor(e,t,r,s,i){this.key=e,this.value=t,this.color=r??be.RED,this.left=s??be.EMPTY,this.right=i??be.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,s,i){return new be(e??this.key,t??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,t,r),null):i===0?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return be.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),t(e,s.key)===0){if(s.right.isEmpty())return be.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,be.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,be.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw B(43730,{key:this.key,value:this.value});if(this.right.isRed())throw B(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw B(27949);return e+(this.isRed()?0:1)}}be.EMPTY=null,be.RED=!0,be.BLACK=!1;be.EMPTY=new class{constructor(){this.size=0}get key(){throw B(57766)}get value(){throw B(16141)}get color(){throw B(16727)}get left(){throw B(29726)}get right(){throw B(36894)}copy(e,t,r,s,i){return this}insert(e,t,r){return new be(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Te{constructor(e){this.comparator=e,this.data=new ce(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,r)=>(e(t),!1)))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Gl(this.data.getIterator())}getIteratorFrom(e){return new Gl(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((r=>{t=t.add(r)})),t}isEqual(e){if(!(e instanceof Te)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Te(this.comparator);return t.data=e,t}}class Gl{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class et{constructor(e){this.fields=e,e.sort(Re.comparator)}static empty(){return new et([])}unionWith(e){let t=new Te(Re.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new et(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Pr(this.fields,e.fields,((t,r)=>t.isEqual(r)))}}class pd extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Ce{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new pd("Invalid base64 string: "+i):i}})(e);return new Ce(t)}static fromUint8Array(e){const t=(function(s){let i="";for(let a=0;a<s.length;++a)i+=String.fromCharCode(s[a]);return i})(e);return new Ce(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const r=new Uint8Array(t.length);for(let s=0;s<t.length;s++)r[s]=t.charCodeAt(s);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return G(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ce.EMPTY_BYTE_STRING=new Ce("");const yv=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function gn(n){if(te(!!n,39018),typeof n=="string"){let e=0;const t=yv.exec(n);if(te(!!t,46558,{timestamp:n}),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:fe(n.seconds),nanos:fe(n.nanos)}}function fe(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function _n(n){return typeof n=="string"?Ce.fromBase64String(n):Ce.fromUint8Array(n)}const md="server_timestamp",gd="__type__",_d="__previous_value__",yd="__local_write_time__";function Rc(n){return(n?.mapValue?.fields||{})[gd]?.stringValue===md}function ho(n){const e=n.mapValue.fields[_d];return Rc(e)?ho(e):e}function Rs(n){const e=gn(n.mapValue.fields[yd].timestampValue);return new ae(e.seconds,e.nanos)}class vv{constructor(e,t,r,s,i,a,c,l,h,d){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=a,this.autoDetectLongPolling=c,this.longPollingOptions=l,this.useFetchStreams=h,this.isUsingEmulator=d}}const Ni="(default)";class Ss{constructor(e,t){this.projectId=e,this.database=t||Ni}static empty(){return new Ss("","")}get isDefaultDatabase(){return this.database===Ni}isEqual(e){return e instanceof Ss&&e.projectId===this.projectId&&e.database===this.database}}const vd="__type__",Ev="__max__",ui={mapValue:{}},Ed="__vector__",Di="value";function yn(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Rc(n)?4:Iv(n)?9007199254740991:Tv(n)?10:11:B(28295,{value:n})}function Rt(n,e){if(n===e)return!0;const t=yn(n);if(t!==yn(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Rs(n).isEqual(Rs(e));case 3:return(function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const a=gn(s.timestampValue),c=gn(i.timestampValue);return a.seconds===c.seconds&&a.nanos===c.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(s,i){return _n(s.bytesValue).isEqual(_n(i.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(s,i){return fe(s.geoPointValue.latitude)===fe(i.geoPointValue.latitude)&&fe(s.geoPointValue.longitude)===fe(i.geoPointValue.longitude)})(n,e);case 2:return(function(s,i){if("integerValue"in s&&"integerValue"in i)return fe(s.integerValue)===fe(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const a=fe(s.doubleValue),c=fe(i.doubleValue);return a===c?ki(a)===ki(c):isNaN(a)&&isNaN(c)}return!1})(n,e);case 9:return Pr(n.arrayValue.values||[],e.arrayValue.values||[],Rt);case 10:case 11:return(function(s,i){const a=s.mapValue.fields||{},c=i.mapValue.fields||{};if(Wl(a)!==Wl(c))return!1;for(const l in a)if(a.hasOwnProperty(l)&&(c[l]===void 0||!Rt(a[l],c[l])))return!1;return!0})(n,e);default:return B(52216,{left:n})}}function Ps(n,e){return(n.values||[]).find((t=>Rt(t,e)))!==void 0}function Cr(n,e){if(n===e)return 0;const t=yn(n),r=yn(e);if(t!==r)return G(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return G(n.booleanValue,e.booleanValue);case 2:return(function(i,a){const c=fe(i.integerValue||i.doubleValue),l=fe(a.integerValue||a.doubleValue);return c<l?-1:c>l?1:c===l?0:isNaN(c)?isNaN(l)?0:-1:1})(n,e);case 3:return Kl(n.timestampValue,e.timestampValue);case 4:return Kl(Rs(n),Rs(e));case 5:return Da(n.stringValue,e.stringValue);case 6:return(function(i,a){const c=_n(i),l=_n(a);return c.compareTo(l)})(n.bytesValue,e.bytesValue);case 7:return(function(i,a){const c=i.split("/"),l=a.split("/");for(let h=0;h<c.length&&h<l.length;h++){const d=G(c[h],l[h]);if(d!==0)return d}return G(c.length,l.length)})(n.referenceValue,e.referenceValue);case 8:return(function(i,a){const c=G(fe(i.latitude),fe(a.latitude));return c!==0?c:G(fe(i.longitude),fe(a.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return Ql(n.arrayValue,e.arrayValue);case 10:return(function(i,a){const c=i.fields||{},l=a.fields||{},h=c[Di]?.arrayValue,d=l[Di]?.arrayValue,m=G(h?.values?.length||0,d?.values?.length||0);return m!==0?m:Ql(h,d)})(n.mapValue,e.mapValue);case 11:return(function(i,a){if(i===ui.mapValue&&a===ui.mapValue)return 0;if(i===ui.mapValue)return 1;if(a===ui.mapValue)return-1;const c=i.fields||{},l=Object.keys(c),h=a.fields||{},d=Object.keys(h);l.sort(),d.sort();for(let m=0;m<l.length&&m<d.length;++m){const g=Da(l[m],d[m]);if(g!==0)return g;const I=Cr(c[l[m]],h[d[m]]);if(I!==0)return I}return G(l.length,d.length)})(n.mapValue,e.mapValue);default:throw B(23264,{he:t})}}function Kl(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return G(n,e);const t=gn(n),r=gn(e),s=G(t.seconds,r.seconds);return s!==0?s:G(t.nanos,r.nanos)}function Ql(n,e){const t=n.values||[],r=e.values||[];for(let s=0;s<t.length&&s<r.length;++s){const i=Cr(t[s],r[s]);if(i)return i}return G(t.length,r.length)}function kr(n){return Va(n)}function Va(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const r=gn(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return _n(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return U.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",s=!0;for(const i of t.values||[])s?s=!1:r+=",",r+=Va(i);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){const r=Object.keys(t.fields||{}).sort();let s="{",i=!0;for(const a of r)i?i=!1:s+=",",s+=`${a}:${Va(t.fields[a])}`;return s+"}"})(n.mapValue):B(61005,{value:n})}function gi(n){switch(yn(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=ho(n);return e?16+gi(e):16;case 5:return 2*n.stringValue.length;case 6:return _n(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((s,i)=>s+gi(i)),0)})(n.arrayValue);case 10:case 11:return(function(r){let s=0;return wn(r.fields,((i,a)=>{s+=i.length+gi(a)})),s})(n.mapValue);default:throw B(13486,{value:n})}}function Oa(n){return!!n&&"integerValue"in n}function Sc(n){return!!n&&"arrayValue"in n}function Xl(n){return!!n&&"nullValue"in n}function Jl(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function _i(n){return!!n&&"mapValue"in n}function Tv(n){return(n?.mapValue?.fields||{})[vd]?.stringValue===Ed}function gs(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return wn(n.mapValue.fields,((t,r)=>e.mapValue.fields[t]=gs(r))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=gs(n.arrayValue.values[t]);return e}return{...n}}function Iv(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===Ev}class We{constructor(e){this.value=e}static empty(){return new We({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!_i(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=gs(t)}setAll(e){let t=Re.emptyPath(),r={},s=[];e.forEach(((a,c)=>{if(!t.isImmediateParentOf(c)){const l=this.getFieldsMap(t);this.applyChanges(l,r,s),r={},s=[],t=c.popLast()}a?r[c.lastSegment()]=gs(a):s.push(c.lastSegment())}));const i=this.getFieldsMap(t);this.applyChanges(i,r,s)}delete(e){const t=this.field(e.popLast());_i(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Rt(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=t.mapValue.fields[e.get(r)];_i(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,r){wn(t,((s,i)=>e[s]=i));for(const s of r)delete e[s]}clone(){return new We(gs(this.value))}}function Td(n){const e=[];return wn(n.fields,((t,r)=>{const s=new Re([t]);if(_i(r)){const i=Td(r.mapValue).fields;if(i.length===0)e.push(s);else for(const a of i)e.push(s.child(a))}else e.push(s)})),new et(e)}class Oe{constructor(e,t,r,s,i,a,c){this.key=e,this.documentType=t,this.version=r,this.readTime=s,this.createTime=i,this.data=a,this.documentState=c}static newInvalidDocument(e){return new Oe(e,0,j.min(),j.min(),j.min(),We.empty(),0)}static newFoundDocument(e,t,r,s){return new Oe(e,1,t,j.min(),r,s,0)}static newNoDocument(e,t){return new Oe(e,2,t,j.min(),j.min(),We.empty(),0)}static newUnknownDocument(e,t){return new Oe(e,3,t,j.min(),j.min(),We.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(j.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=We.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=We.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=j.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Oe&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Oe(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Vi{constructor(e,t){this.position=e,this.inclusive=t}}function Yl(n,e,t){let r=0;for(let s=0;s<n.position.length;s++){const i=e[s],a=n.position[s];if(i.field.isKeyField()?r=U.comparator(U.fromName(a.referenceValue),t.key):r=Cr(a,t.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function Zl(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Rt(n.position[t],e.position[t]))return!1;return!0}class Oi{constructor(e,t="asc"){this.field=e,this.dir=t}}function wv(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class Id{}class ve extends Id{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new bv(e,t,r):t==="array-contains"?new Pv(e,r):t==="in"?new Cv(e,r):t==="not-in"?new kv(e,r):t==="array-contains-any"?new Nv(e,r):new ve(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new Rv(e,r):new Sv(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Cr(t,this.value)):t!==null&&yn(this.value)===yn(t)&&this.matchesComparison(Cr(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return B(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class St extends Id{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new St(e,t)}matches(e){return wd(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function wd(n){return n.op==="and"}function Ad(n){return Av(n)&&wd(n)}function Av(n){for(const e of n.filters)if(e instanceof St)return!1;return!0}function Ma(n){if(n instanceof ve)return n.field.canonicalString()+n.op.toString()+kr(n.value);if(Ad(n))return n.filters.map((e=>Ma(e))).join(",");{const e=n.filters.map((t=>Ma(t))).join(",");return`${n.op}(${e})`}}function bd(n,e){return n instanceof ve?(function(r,s){return s instanceof ve&&r.op===s.op&&r.field.isEqual(s.field)&&Rt(r.value,s.value)})(n,e):n instanceof St?(function(r,s){return s instanceof St&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce(((i,a,c)=>i&&bd(a,s.filters[c])),!0):!1})(n,e):void B(19439)}function Rd(n){return n instanceof ve?(function(t){return`${t.field.canonicalString()} ${t.op} ${kr(t.value)}`})(n):n instanceof St?(function(t){return t.op.toString()+" {"+t.getFilters().map(Rd).join(" ,")+"}"})(n):"Filter"}class bv extends ve{constructor(e,t,r){super(e,t,r),this.key=U.fromName(r.referenceValue)}matches(e){const t=U.comparator(e.key,this.key);return this.matchesComparison(t)}}class Rv extends ve{constructor(e,t){super(e,"in",t),this.keys=Sd("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class Sv extends ve{constructor(e,t){super(e,"not-in",t),this.keys=Sd("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function Sd(n,e){return(e.arrayValue?.values||[]).map((t=>U.fromName(t.referenceValue)))}class Pv extends ve{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Sc(t)&&Ps(t.arrayValue,this.value)}}class Cv extends ve{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Ps(this.value.arrayValue,t)}}class kv extends ve{constructor(e,t){super(e,"not-in",t)}matches(e){if(Ps(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Ps(this.value.arrayValue,t)}}class Nv extends ve{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Sc(t)||!t.arrayValue.values)&&t.arrayValue.values.some((r=>Ps(this.value.arrayValue,r)))}}class Dv{constructor(e,t=null,r=[],s=[],i=null,a=null,c=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=a,this.endAt=c,this.Te=null}}function eh(n,e=null,t=[],r=[],s=null,i=null,a=null){return new Dv(n,e,t,r,s,i,a)}function Pc(n){const e=q(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((r=>Ma(r))).join(","),t+="|ob:",t+=e.orderBy.map((r=>(function(i){return i.field.canonicalString()+i.dir})(r))).join(","),lo(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((r=>kr(r))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((r=>kr(r))).join(",")),e.Te=t}return e.Te}function Cc(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!wv(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!bd(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Zl(n.startAt,e.startAt)&&Zl(n.endAt,e.endAt)}function La(n){return U.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}class fo{constructor(e,t=null,r=[],s=[],i=null,a="F",c=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=a,this.startAt=c,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function Vv(n,e,t,r,s,i,a,c){return new fo(n,e,t,r,s,i,a,c)}function kc(n){return new fo(n)}function th(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function Ov(n){return n.collectionGroup!==null}function _s(n){const e=q(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),t.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let c=new Te(Re.comparator);return a.filters.forEach((l=>{l.getFlattenedFilters().forEach((h=>{h.isInequality()&&(c=c.add(h.field))}))})),c})(e).forEach((i=>{t.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new Oi(i,r))})),t.has(Re.keyField().canonicalString())||e.Ie.push(new Oi(Re.keyField(),r))}return e.Ie}function Et(n){const e=q(n);return e.Ee||(e.Ee=Mv(e,_s(n))),e.Ee}function Mv(n,e){if(n.limitType==="F")return eh(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((s=>{const i=s.dir==="desc"?"asc":"desc";return new Oi(s.field,i)}));const t=n.endAt?new Vi(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Vi(n.startAt.position,n.startAt.inclusive):null;return eh(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function xa(n,e,t){return new fo(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function po(n,e){return Cc(Et(n),Et(e))&&n.limitType===e.limitType}function Pd(n){return`${Pc(Et(n))}|lt:${n.limitType}`}function sr(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map((s=>Rd(s))).join(", ")}]`),lo(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map((s=>(function(a){return`${a.field.canonicalString()} (${a.dir})`})(s))).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map((s=>kr(s))).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map((s=>kr(s))).join(",")),`Target(${r})`})(Et(n))}; limitType=${n.limitType})`}function mo(n,e){return e.isFoundDocument()&&(function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):U.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)})(n,e)&&(function(r,s){for(const i of _s(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0})(n,e)&&(function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0})(n,e)&&(function(r,s){return!(r.startAt&&!(function(a,c,l){const h=Yl(a,c,l);return a.inclusive?h<=0:h<0})(r.startAt,_s(r),s)||r.endAt&&!(function(a,c,l){const h=Yl(a,c,l);return a.inclusive?h>=0:h>0})(r.endAt,_s(r),s))})(n,e)}function Lv(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function Cd(n){return(e,t)=>{let r=!1;for(const s of _s(n)){const i=xv(s,e,t);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function xv(n,e,t){const r=n.field.isKeyField()?U.comparator(e.key,t.key):(function(i,a,c){const l=a.data.field(i),h=c.data.field(i);return l!==null&&h!==null?Cr(l,h):B(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return B(19790,{direction:n.dir})}}class Qn{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[t]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){wn(this.inner,((t,r)=>{for(const[s,i]of r)e(s,i)}))}isEmpty(){return dd(this.inner)}size(){return this.innerSize}}const Fv=new ce(U.comparator);function Ut(){return Fv}const kd=new ce(U.comparator);function ls(...n){let e=kd;for(const t of n)e=e.insert(t.key,t);return e}function Nd(n){let e=kd;return n.forEach(((t,r)=>e=e.insert(t,r.overlayedDocument))),e}function Dn(){return ys()}function Dd(){return ys()}function ys(){return new Qn((n=>n.toString()),((n,e)=>n.isEqual(e)))}const Uv=new ce(U.comparator),Bv=new Te(U.comparator);function K(...n){let e=Bv;for(const t of n)e=e.add(t);return e}const $v=new Te(G);function jv(){return $v}function Nc(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ki(e)?"-0":e}}function Vd(n){return{integerValue:""+n}}function qv(n,e){return mv(e)?Vd(e):Nc(n,e)}class go{constructor(){this._=void 0}}function zv(n,e,t){return n instanceof Mi?(function(s,i){const a={fields:{[gd]:{stringValue:md},[yd]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&Rc(i)&&(i=ho(i)),i&&(a.fields[_d]=i),{mapValue:a}})(t,e):n instanceof Cs?Md(n,e):n instanceof ks?Ld(n,e):(function(s,i){const a=Od(s,i),c=nh(a)+nh(s.Ae);return Oa(a)&&Oa(s.Ae)?Vd(c):Nc(s.serializer,c)})(n,e)}function Hv(n,e,t){return n instanceof Cs?Md(n,e):n instanceof ks?Ld(n,e):t}function Od(n,e){return n instanceof Li?(function(r){return Oa(r)||(function(i){return!!i&&"doubleValue"in i})(r)})(e)?e:{integerValue:0}:null}class Mi extends go{}class Cs extends go{constructor(e){super(),this.elements=e}}function Md(n,e){const t=xd(e);for(const r of n.elements)t.some((s=>Rt(s,r)))||t.push(r);return{arrayValue:{values:t}}}class ks extends go{constructor(e){super(),this.elements=e}}function Ld(n,e){let t=xd(e);for(const r of n.elements)t=t.filter((s=>!Rt(s,r)));return{arrayValue:{values:t}}}class Li extends go{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function nh(n){return fe(n.integerValue||n.doubleValue)}function xd(n){return Sc(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function Wv(n,e){return n.field.isEqual(e.field)&&(function(r,s){return r instanceof Cs&&s instanceof Cs||r instanceof ks&&s instanceof ks?Pr(r.elements,s.elements,Rt):r instanceof Li&&s instanceof Li?Rt(r.Ae,s.Ae):r instanceof Mi&&s instanceof Mi})(n.transform,e.transform)}class Gv{constructor(e,t){this.version=e,this.transformResults=t}}class ct{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new ct}static exists(e){return new ct(void 0,e)}static updateTime(e){return new ct(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function yi(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class _o{}function Fd(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Dc(n.key,ct.none()):new Fs(n.key,n.data,ct.none());{const t=n.data,r=We.empty();let s=new Te(Re.comparator);for(let i of e.fields)if(!s.has(i)){let a=t.field(i);a===null&&i.length>1&&(i=i.popLast(),a=t.field(i)),a===null?r.delete(i):r.set(i,a),s=s.add(i)}return new An(n.key,r,new et(s.toArray()),ct.none())}}function Kv(n,e,t){n instanceof Fs?(function(s,i,a){const c=s.value.clone(),l=sh(s.fieldTransforms,i,a.transformResults);c.setAll(l),i.convertToFoundDocument(a.version,c).setHasCommittedMutations()})(n,e,t):n instanceof An?(function(s,i,a){if(!yi(s.precondition,i))return void i.convertToUnknownDocument(a.version);const c=sh(s.fieldTransforms,i,a.transformResults),l=i.data;l.setAll(Ud(s)),l.setAll(c),i.convertToFoundDocument(a.version,l).setHasCommittedMutations()})(n,e,t):(function(s,i,a){i.convertToNoDocument(a.version).setHasCommittedMutations()})(0,e,t)}function vs(n,e,t,r){return n instanceof Fs?(function(i,a,c,l){if(!yi(i.precondition,a))return c;const h=i.value.clone(),d=ih(i.fieldTransforms,l,a);return h.setAll(d),a.convertToFoundDocument(a.version,h).setHasLocalMutations(),null})(n,e,t,r):n instanceof An?(function(i,a,c,l){if(!yi(i.precondition,a))return c;const h=ih(i.fieldTransforms,l,a),d=a.data;return d.setAll(Ud(i)),d.setAll(h),a.convertToFoundDocument(a.version,d).setHasLocalMutations(),c===null?null:c.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map((m=>m.field)))})(n,e,t,r):(function(i,a,c){return yi(i.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):c})(n,e,t)}function Qv(n,e){let t=null;for(const r of n.fieldTransforms){const s=e.data.field(r.field),i=Od(r.transform,s||null);i!=null&&(t===null&&(t=We.empty()),t.set(r.field,i))}return t||null}function rh(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&Pr(r,s,((i,a)=>Wv(i,a)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Fs extends _o{constructor(e,t,r,s=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class An extends _o{constructor(e,t,r,s,i=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Ud(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}})),e}function sh(n,e,t){const r=new Map;te(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let s=0;s<t.length;s++){const i=n[s],a=i.transform,c=e.data.field(i.field);r.set(i.field,Hv(a,c,t[s]))}return r}function ih(n,e,t){const r=new Map;for(const s of n){const i=s.transform,a=t.data.field(s.field);r.set(s.field,zv(i,a,e))}return r}class Dc extends _o{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Xv extends _o{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Jv{constructor(e,t,r,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&Kv(i,e,r[s])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=vs(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=vs(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=Dd();return this.mutations.forEach((s=>{const i=e.get(s.key),a=i.overlayedDocument;let c=this.applyToLocalView(a,i.mutatedFields);c=t.has(s.key)?null:c;const l=Fd(a,c);l!==null&&r.set(s.key,l),a.isValidDocument()||a.convertToNoDocument(j.min())})),r}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),K())}isEqual(e){return this.batchId===e.batchId&&Pr(this.mutations,e.mutations,((t,r)=>rh(t,r)))&&Pr(this.baseMutations,e.baseMutations,((t,r)=>rh(t,r)))}}class Vc{constructor(e,t,r,s){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=s}static from(e,t,r){te(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let s=(function(){return Uv})();const i=e.mutations;for(let a=0;a<i.length;a++)s=s.insert(i[a].key,r[a].version);return new Vc(e,t,r,s)}}class Yv{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class Zv{constructor(e,t){this.count=e,this.unchangedNames=t}}var pe,Q;function eE(n){switch(n){case N.OK:return B(64938);case N.CANCELLED:case N.UNKNOWN:case N.DEADLINE_EXCEEDED:case N.RESOURCE_EXHAUSTED:case N.INTERNAL:case N.UNAVAILABLE:case N.UNAUTHENTICATED:return!1;case N.INVALID_ARGUMENT:case N.NOT_FOUND:case N.ALREADY_EXISTS:case N.PERMISSION_DENIED:case N.FAILED_PRECONDITION:case N.ABORTED:case N.OUT_OF_RANGE:case N.UNIMPLEMENTED:case N.DATA_LOSS:return!0;default:return B(15467,{code:n})}}function Bd(n){if(n===void 0)return Ft("GRPC error has no .code"),N.UNKNOWN;switch(n){case pe.OK:return N.OK;case pe.CANCELLED:return N.CANCELLED;case pe.UNKNOWN:return N.UNKNOWN;case pe.DEADLINE_EXCEEDED:return N.DEADLINE_EXCEEDED;case pe.RESOURCE_EXHAUSTED:return N.RESOURCE_EXHAUSTED;case pe.INTERNAL:return N.INTERNAL;case pe.UNAVAILABLE:return N.UNAVAILABLE;case pe.UNAUTHENTICATED:return N.UNAUTHENTICATED;case pe.INVALID_ARGUMENT:return N.INVALID_ARGUMENT;case pe.NOT_FOUND:return N.NOT_FOUND;case pe.ALREADY_EXISTS:return N.ALREADY_EXISTS;case pe.PERMISSION_DENIED:return N.PERMISSION_DENIED;case pe.FAILED_PRECONDITION:return N.FAILED_PRECONDITION;case pe.ABORTED:return N.ABORTED;case pe.OUT_OF_RANGE:return N.OUT_OF_RANGE;case pe.UNIMPLEMENTED:return N.UNIMPLEMENTED;case pe.DATA_LOSS:return N.DATA_LOSS;default:return B(39323,{code:n})}}(Q=pe||(pe={}))[Q.OK=0]="OK",Q[Q.CANCELLED=1]="CANCELLED",Q[Q.UNKNOWN=2]="UNKNOWN",Q[Q.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Q[Q.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Q[Q.NOT_FOUND=5]="NOT_FOUND",Q[Q.ALREADY_EXISTS=6]="ALREADY_EXISTS",Q[Q.PERMISSION_DENIED=7]="PERMISSION_DENIED",Q[Q.UNAUTHENTICATED=16]="UNAUTHENTICATED",Q[Q.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Q[Q.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Q[Q.ABORTED=10]="ABORTED",Q[Q.OUT_OF_RANGE=11]="OUT_OF_RANGE",Q[Q.UNIMPLEMENTED=12]="UNIMPLEMENTED",Q[Q.INTERNAL=13]="INTERNAL",Q[Q.UNAVAILABLE=14]="UNAVAILABLE",Q[Q.DATA_LOSS=15]="DATA_LOSS";function tE(){return new TextEncoder}const nE=new hn([4294967295,4294967295],0);function oh(n){const e=tE().encode(n),t=new nd;return t.update(e),new Uint8Array(t.digest())}function ah(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new hn([t,r],0),new hn([s,i],0)]}class Oc{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new hs(`Invalid padding: ${t}`);if(r<0)throw new hs(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new hs(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new hs(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=hn.fromNumber(this.ge)}ye(e,t,r){let s=e.add(t.multiply(hn.fromNumber(r)));return s.compare(nE)===1&&(s=new hn([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=oh(e),[r,s]=ah(t);for(let i=0;i<this.hashCount;i++){const a=this.ye(r,s,i);if(!this.we(a))return!1}return!0}static create(e,t,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),a=new Oc(i,s,t);return r.forEach((c=>a.insert(c))),a}insert(e){if(this.ge===0)return;const t=oh(e),[r,s]=ah(t);for(let i=0;i<this.hashCount;i++){const a=this.ye(r,s,i);this.Se(a)}}Se(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class hs extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class yo{constructor(e,t,r,s,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const s=new Map;return s.set(e,Us.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new yo(j.min(),s,new ce(G),Ut(),K())}}class Us{constructor(e,t,r,s,i){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new Us(r,t,K(),K(),K())}}class vi{constructor(e,t,r,s){this.be=e,this.removedTargetIds=t,this.key=r,this.De=s}}class $d{constructor(e,t){this.targetId=e,this.Ce=t}}class jd{constructor(e,t,r=Ce.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=s}}class ch{constructor(){this.ve=0,this.Fe=uh(),this.Me=Ce.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=K(),t=K(),r=K();return this.Fe.forEach(((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:r=r.add(s);break;default:B(38017,{changeType:i})}})),new Us(this.Me,this.xe,e,t,r)}qe(){this.Oe=!1,this.Fe=uh()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,te(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class rE{constructor(e){this.Ge=e,this.ze=new Map,this.je=Ut(),this.Je=li(),this.He=li(),this.Ye=new ce(G)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:B(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((r,s)=>{this.rt(s)&&t(s)}))}st(e){const t=e.targetId,r=e.Ce.count,s=this.ot(t);if(s){const i=s.target;if(La(i))if(r===0){const a=new U(i.path);this.et(t,a,Oe.newNoDocument(a,j.min()))}else te(r===1,20013,{expectedCount:r});else{const a=this._t(t);if(a!==r){const c=this.ut(e),l=c?this.ct(c,e,a):1;if(l!==0){this.it(t);const h=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,h)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=t;let a,c;try{a=_n(r).toUint8Array()}catch(l){if(l instanceof pd)return Sr("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{c=new Oc(a,s,i)}catch(l){return Sr(l instanceof hs?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return c.ge===0?null:c}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){const r=this.Ge.getRemoteKeysForTarget(t);let s=0;return r.forEach((i=>{const a=this.Ge.ht(),c=`projects/${a.projectId}/databases/${a.database}/documents/${i.path.canonicalString()}`;e.mightContain(c)||(this.et(t,i,null),s++)})),s}Tt(e){const t=new Map;this.ze.forEach(((i,a)=>{const c=this.ot(a);if(c){if(i.current&&La(c.target)){const l=new U(c.target.path);this.It(l).has(a)||this.Et(a,l)||this.et(a,l,Oe.newNoDocument(l,e))}i.Be&&(t.set(a,i.ke()),i.qe())}}));let r=K();this.He.forEach(((i,a)=>{let c=!0;a.forEachWhile((l=>{const h=this.ot(l);return!h||h.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)})),c&&(r=r.add(i))})),this.je.forEach(((i,a)=>a.setReadTime(e)));const s=new yo(e,t,this.Ye,this.je,r);return this.je=Ut(),this.Je=li(),this.He=li(),this.Ye=new ce(G),s}Xe(e,t){if(!this.rt(e))return;const r=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,r),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,t)?s.Qe(t,1):s.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new ch,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Te(G),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Te(G),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||M("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new ch),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function li(){return new ce(U.comparator)}function uh(){return new ce(U.comparator)}const sE={asc:"ASCENDING",desc:"DESCENDING"},iE={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},oE={and:"AND",or:"OR"};class aE{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Fa(n,e){return n.useProto3Json||lo(e)?e:{value:e}}function xi(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function qd(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function cE(n,e){return xi(n,e.toTimestamp())}function Tt(n){return te(!!n,49232),j.fromTimestamp((function(t){const r=gn(t);return new ae(r.seconds,r.nanos)})(n))}function Mc(n,e){return Ua(n,e).canonicalString()}function Ua(n,e){const t=(function(s){return new oe(["projects",s.projectId,"databases",s.database])})(n).child("documents");return e===void 0?t:t.child(e)}function zd(n){const e=oe.fromString(n);return te(Qd(e),10190,{key:e.toString()}),e}function Ba(n,e){return Mc(n.databaseId,e.path)}function ha(n,e){const t=zd(e);if(t.get(1)!==n.databaseId.projectId)throw new x(N.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new x(N.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new U(Wd(t))}function Hd(n,e){return Mc(n.databaseId,e)}function uE(n){const e=zd(n);return e.length===4?oe.emptyPath():Wd(e)}function $a(n){return new oe(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Wd(n){return te(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function lh(n,e,t){return{name:Ba(n,e),fields:t.value.mapValue.fields}}function lE(n,e){let t;if("targetChange"in e){e.targetChange;const r=(function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:B(39313,{state:h})})(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=(function(h,d){return h.useProto3Json?(te(d===void 0||typeof d=="string",58123),Ce.fromBase64String(d||"")):(te(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),Ce.fromUint8Array(d||new Uint8Array))})(n,e.targetChange.resumeToken),a=e.targetChange.cause,c=a&&(function(h){const d=h.code===void 0?N.UNKNOWN:Bd(h.code);return new x(d,h.message||"")})(a);t=new jd(r,s,i,c||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=ha(n,r.document.name),i=Tt(r.document.updateTime),a=r.document.createTime?Tt(r.document.createTime):j.min(),c=new We({mapValue:{fields:r.document.fields}}),l=Oe.newFoundDocument(s,i,a,c),h=r.targetIds||[],d=r.removedTargetIds||[];t=new vi(h,d,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=ha(n,r.document),i=r.readTime?Tt(r.readTime):j.min(),a=Oe.newNoDocument(s,i),c=r.removedTargetIds||[];t=new vi([],c,a.key,a)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=ha(n,r.document),i=r.removedTargetIds||[];t=new vi([],i,s,null)}else{if(!("filter"in e))return B(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,a=new Zv(s,i),c=r.targetId;t=new $d(c,a)}}return t}function hE(n,e){let t;if(e instanceof Fs)t={update:lh(n,e.key,e.value)};else if(e instanceof Dc)t={delete:Ba(n,e.key)};else if(e instanceof An)t={update:lh(n,e.key,e.data),updateMask:EE(e.fieldMask)};else{if(!(e instanceof Xv))return B(16599,{Vt:e.type});t={verify:Ba(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((r=>(function(i,a){const c=a.transform;if(c instanceof Mi)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof Cs)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof ks)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof Li)return{fieldPath:a.field.canonicalString(),increment:c.Ae};throw B(20930,{transform:a.transform})})(0,r)))),e.precondition.isNone||(t.currentDocument=(function(s,i){return i.updateTime!==void 0?{updateTime:cE(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:B(27497)})(n,e.precondition)),t}function fE(n,e){return n&&n.length>0?(te(e!==void 0,14353),n.map((t=>(function(s,i){let a=s.updateTime?Tt(s.updateTime):Tt(i);return a.isEqual(j.min())&&(a=Tt(i)),new Gv(a,s.transformResults||[])})(t,e)))):[]}function dE(n,e){return{documents:[Hd(n,e.path)]}}function pE(n,e){const t={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=Hd(n,s);const i=(function(h){if(h.length!==0)return Kd(St.create(h,"and"))})(e.filters);i&&(t.structuredQuery.where=i);const a=(function(h){if(h.length!==0)return h.map((d=>(function(g){return{field:ir(g.field),direction:_E(g.dir)}})(d)))})(e.orderBy);a&&(t.structuredQuery.orderBy=a);const c=Fa(n,e.limit);return c!==null&&(t.structuredQuery.limit=c),e.startAt&&(t.structuredQuery.startAt=(function(h){return{before:h.inclusive,values:h.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(h){return{before:!h.inclusive,values:h.position}})(e.endAt)),{ft:t,parent:s}}function mE(n){let e=uE(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let s=null;if(r>0){te(r===1,65062);const d=t.from[0];d.allDescendants?s=d.collectionId:e=e.child(d.collectionId)}let i=[];t.where&&(i=(function(m){const g=Gd(m);return g instanceof St&&Ad(g)?g.getFilters():[g]})(t.where));let a=[];t.orderBy&&(a=(function(m){return m.map((g=>(function(P){return new Oi(or(P.field),(function(S){switch(S){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(P.direction))})(g)))})(t.orderBy));let c=null;t.limit&&(c=(function(m){let g;return g=typeof m=="object"?m.value:m,lo(g)?null:g})(t.limit));let l=null;t.startAt&&(l=(function(m){const g=!!m.before,I=m.values||[];return new Vi(I,g)})(t.startAt));let h=null;return t.endAt&&(h=(function(m){const g=!m.before,I=m.values||[];return new Vi(I,g)})(t.endAt)),Vv(e,s,a,i,c,"F",l,h)}function gE(n,e){const t=(function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return B(28987,{purpose:s})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Gd(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=or(t.unaryFilter.field);return ve.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=or(t.unaryFilter.field);return ve.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=or(t.unaryFilter.field);return ve.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=or(t.unaryFilter.field);return ve.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return B(61313);default:return B(60726)}})(n):n.fieldFilter!==void 0?(function(t){return ve.create(or(t.fieldFilter.field),(function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return B(58110);default:return B(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return St.create(t.compositeFilter.filters.map((r=>Gd(r))),(function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return B(1026)}})(t.compositeFilter.op))})(n):B(30097,{filter:n})}function _E(n){return sE[n]}function yE(n){return iE[n]}function vE(n){return oE[n]}function ir(n){return{fieldPath:n.canonicalString()}}function or(n){return Re.fromServerFormat(n.fieldPath)}function Kd(n){return n instanceof ve?(function(t){if(t.op==="=="){if(Jl(t.value))return{unaryFilter:{field:ir(t.field),op:"IS_NAN"}};if(Xl(t.value))return{unaryFilter:{field:ir(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Jl(t.value))return{unaryFilter:{field:ir(t.field),op:"IS_NOT_NAN"}};if(Xl(t.value))return{unaryFilter:{field:ir(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ir(t.field),op:yE(t.op),value:t.value}}})(n):n instanceof St?(function(t){const r=t.getFilters().map((s=>Kd(s)));return r.length===1?r[0]:{compositeFilter:{op:vE(t.op),filters:r}}})(n):B(54877,{filter:n})}function EE(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function Qd(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}class rn{constructor(e,t,r,s,i=j.min(),a=j.min(),c=Ce.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=c,this.expectedCount=l}withSequenceNumber(e){return new rn(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new rn(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new rn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new rn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class TE{constructor(e){this.yt=e}}function IE(n){const e=mE({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?xa(e,e.limit,"L"):e}class wE{constructor(){this.Cn=new AE}addToCollectionParentIndex(e,t){return this.Cn.add(t),k.resolve()}getCollectionParents(e,t){return k.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return k.resolve()}deleteFieldIndex(e,t){return k.resolve()}deleteAllFieldIndexes(e){return k.resolve()}createTargetIndexes(e,t){return k.resolve()}getDocumentsMatchingTarget(e,t){return k.resolve(null)}getIndexType(e,t){return k.resolve(0)}getFieldIndexes(e,t){return k.resolve([])}getNextCollectionGroupToUpdate(e){return k.resolve(null)}getMinOffset(e,t){return k.resolve(mn.min())}getMinOffsetFromCollectionGroup(e,t){return k.resolve(mn.min())}updateCollectionGroup(e,t,r){return k.resolve()}updateIndexEntries(e,t){return k.resolve()}}class AE{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t]||new Te(oe.comparator),i=!s.has(r);return this.index[t]=s.add(r),i}has(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t];return s&&s.has(r)}getEntries(e){return(this.index[e]||new Te(oe.comparator)).toArray()}}const hh={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Xd=41943040;class ze{static withCacheSize(e){return new ze(e,ze.DEFAULT_COLLECTION_PERCENTILE,ze.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}ze.DEFAULT_COLLECTION_PERCENTILE=10,ze.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ze.DEFAULT=new ze(Xd,ze.DEFAULT_COLLECTION_PERCENTILE,ze.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ze.DISABLED=new ze(-1,0,0);class Nr{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Nr(0)}static cr(){return new Nr(-1)}}const fh="LruGarbageCollector",bE=1048576;function dh([n,e],[t,r]){const s=G(n,t);return s===0?G(e,r):s}class RE{constructor(e){this.Ir=e,this.buffer=new Te(dh),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();dh(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class SE{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){M(fh,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){jr(t)?M(fh,"Ignoring IndexedDB error during garbage collection: ",t):await $r(t)}await this.Vr(3e5)}))}}class PE{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((r=>Math.floor(t/100*r)))}nthSequenceNumber(e,t){if(t===0)return k.resolve(uo.ce);const r=new RE(t);return this.mr.forEachTarget(e,(s=>r.Ar(s.sequenceNumber))).next((()=>this.mr.pr(e,(s=>r.Ar(s))))).next((()=>r.maxValue))}removeTargets(e,t,r){return this.mr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(M("LruGarbageCollector","Garbage collection skipped; disabled"),k.resolve(hh)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(M("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),hh):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let r,s,i,a,c,l,h;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((m=>(m>this.params.maximumSequenceNumbersToCollect?(M("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${m}`),s=this.params.maximumSequenceNumbersToCollect):s=m,a=Date.now(),this.nthSequenceNumber(e,s)))).next((m=>(r=m,c=Date.now(),this.removeTargets(e,r,t)))).next((m=>(i=m,l=Date.now(),this.removeOrphanedDocuments(e,r)))).next((m=>(h=Date.now(),rr()<=W.DEBUG&&M("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-d}ms
	Determined least recently used ${s} in `+(c-a)+`ms
	Removed ${i} targets in `+(l-c)+`ms
	Removed ${m} documents in `+(h-l)+`ms
Total Duration: ${h-d}ms`),k.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:m}))))}}function CE(n,e){return new PE(n,e)}class kE{constructor(){this.changes=new Qn((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Oe.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?k.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class NE{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class DE{constructor(e,t,r,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next((s=>(r=s,this.remoteDocumentCache.getEntry(e,t)))).next((s=>(r!==null&&vs(r.mutation,s,et.empty(),ae.now()),s)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.getLocalViewOfDocuments(e,r,K()).next((()=>r))))}getLocalViewOfDocuments(e,t,r=K()){const s=Dn();return this.populateOverlays(e,s,t).next((()=>this.computeViews(e,t,s,r).next((i=>{let a=ls();return i.forEach(((c,l)=>{a=a.insert(c,l.overlayedDocument)})),a}))))}getOverlayedDocuments(e,t){const r=Dn();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,K())))}populateOverlays(e,t,r){const s=[];return r.forEach((i=>{t.has(i)||s.push(i)})),this.documentOverlayCache.getOverlays(e,s).next((i=>{i.forEach(((a,c)=>{t.set(a,c)}))}))}computeViews(e,t,r,s){let i=Ut();const a=ys(),c=(function(){return ys()})();return t.forEach(((l,h)=>{const d=r.get(h.key);s.has(h.key)&&(d===void 0||d.mutation instanceof An)?i=i.insert(h.key,h):d!==void 0?(a.set(h.key,d.mutation.getFieldMask()),vs(d.mutation,h,d.mutation.getFieldMask(),ae.now())):a.set(h.key,et.empty())})),this.recalculateAndSaveOverlays(e,i).next((l=>(l.forEach(((h,d)=>a.set(h,d))),t.forEach(((h,d)=>c.set(h,new NE(d,a.get(h)??null)))),c)))}recalculateAndSaveOverlays(e,t){const r=ys();let s=new ce(((a,c)=>a-c)),i=K();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((a=>{for(const c of a)c.keys().forEach((l=>{const h=t.get(l);if(h===null)return;let d=r.get(l)||et.empty();d=c.applyToLocalView(h,d),r.set(l,d);const m=(s.get(c.batchId)||K()).add(l);s=s.insert(c.batchId,m)}))})).next((()=>{const a=[],c=s.getReverseIterator();for(;c.hasNext();){const l=c.getNext(),h=l.key,d=l.value,m=Dd();d.forEach((g=>{if(!i.has(g)){const I=Fd(t.get(g),r.get(g));I!==null&&m.set(g,I),i=i.add(g)}})),a.push(this.documentOverlayCache.saveOverlays(e,h,m))}return k.waitFor(a)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,t,r,s){return(function(a){return U.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Ov(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,s):this.getDocumentsMatchingCollectionQuery(e,t,r,s)}getNextDocuments(e,t,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,s).next((i=>{const a=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,s-i.size):k.resolve(Dn());let c=bs,l=i;return a.next((h=>k.forEach(h,((d,m)=>(c<m.largestBatchId&&(c=m.largestBatchId),i.get(d)?k.resolve():this.remoteDocumentCache.getEntry(e,d).next((g=>{l=l.insert(d,g)}))))).next((()=>this.populateOverlays(e,h,i))).next((()=>this.computeViews(e,l,h,K()))).next((d=>({batchId:c,changes:Nd(d)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new U(t)).next((r=>{let s=ls();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s}))}getDocumentsMatchingCollectionGroupQuery(e,t,r,s){const i=t.collectionGroup;let a=ls();return this.indexManager.getCollectionParents(e,i).next((c=>k.forEach(c,(l=>{const h=(function(m,g){return new fo(g,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)})(t,l.child(i));return this.getDocumentsMatchingCollectionQuery(e,h,r,s).next((d=>{d.forEach(((m,g)=>{a=a.insert(m,g)}))}))})).next((()=>a))))}getDocumentsMatchingCollectionQuery(e,t,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next((a=>(i=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,i,s)))).next((a=>{i.forEach(((l,h)=>{const d=h.getKey();a.get(d)===null&&(a=a.insert(d,Oe.newInvalidDocument(d)))}));let c=ls();return a.forEach(((l,h)=>{const d=i.get(l);d!==void 0&&vs(d.mutation,h,et.empty(),ae.now()),mo(t,h)&&(c=c.insert(l,h))})),c}))}}class VE{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return k.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(s){return{id:s.id,version:s.version,createTime:Tt(s.createTime)}})(t)),k.resolve()}getNamedQuery(e,t){return k.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(s){return{name:s.name,query:IE(s.bundledQuery),readTime:Tt(s.readTime)}})(t)),k.resolve()}}class OE{constructor(){this.overlays=new ce(U.comparator),this.qr=new Map}getOverlay(e,t){return k.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Dn();return k.forEach(t,(s=>this.getOverlay(e,s).next((i=>{i!==null&&r.set(s,i)})))).next((()=>r))}saveOverlays(e,t,r){return r.forEach(((s,i)=>{this.St(e,t,i)})),k.resolve()}removeOverlaysForBatchId(e,t,r){const s=this.qr.get(r);return s!==void 0&&(s.forEach((i=>this.overlays=this.overlays.remove(i))),this.qr.delete(r)),k.resolve()}getOverlaysForCollection(e,t,r){const s=Dn(),i=t.length+1,a=new U(t.child("")),c=this.overlays.getIteratorFrom(a);for(;c.hasNext();){const l=c.getNext().value,h=l.getKey();if(!t.isPrefixOf(h.path))break;h.path.length===i&&l.largestBatchId>r&&s.set(l.getKey(),l)}return k.resolve(s)}getOverlaysForCollectionGroup(e,t,r,s){let i=new ce(((h,d)=>h-d));const a=this.overlays.getIterator();for(;a.hasNext();){const h=a.getNext().value;if(h.getKey().getCollectionGroup()===t&&h.largestBatchId>r){let d=i.get(h.largestBatchId);d===null&&(d=Dn(),i=i.insert(h.largestBatchId,d)),d.set(h.getKey(),h)}}const c=Dn(),l=i.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach(((h,d)=>c.set(h,d))),!(c.size()>=s)););return k.resolve(c)}St(e,t,r){const s=this.overlays.get(r.key);if(s!==null){const a=this.qr.get(s.largestBatchId).delete(r.key);this.qr.set(s.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new Yv(t,r));let i=this.qr.get(t);i===void 0&&(i=K(),this.qr.set(t,i)),this.qr.set(t,i.add(r.key))}}class ME{constructor(){this.sessionToken=Ce.EMPTY_BYTE_STRING}getSessionToken(e){return k.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,k.resolve()}}class Lc{constructor(){this.Qr=new Te(Ae.$r),this.Ur=new Te(Ae.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const r=new Ae(e,t);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,t){e.forEach((r=>this.addReference(r,t)))}removeReference(e,t){this.Gr(new Ae(e,t))}zr(e,t){e.forEach((r=>this.removeReference(r,t)))}jr(e){const t=new U(new oe([])),r=new Ae(t,e),s=new Ae(t,e+1),i=[];return this.Ur.forEachInRange([r,s],(a=>{this.Gr(a),i.push(a.key)})),i}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new U(new oe([])),r=new Ae(t,e),s=new Ae(t,e+1);let i=K();return this.Ur.forEachInRange([r,s],(a=>{i=i.add(a.key)})),i}containsKey(e){const t=new Ae(e,0),r=this.Qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class Ae{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return U.comparator(e.key,t.key)||G(e.Yr,t.Yr)}static Kr(e,t){return G(e.Yr,t.Yr)||U.comparator(e.key,t.key)}}class LE{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Te(Ae.$r)}checkEmpty(e){return k.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,s){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new Jv(i,t,r,s);this.mutationQueue.push(a);for(const c of s)this.Zr=this.Zr.add(new Ae(c.key,i)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return k.resolve(a)}lookupMutationBatch(e,t){return k.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,s=this.ei(r),i=s<0?0:s;return k.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return k.resolve(this.mutationQueue.length===0?bc:this.tr-1)}getAllMutationBatches(e){return k.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new Ae(t,0),s=new Ae(t,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([r,s],(a=>{const c=this.Xr(a.Yr);i.push(c)})),k.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Te(G);return t.forEach((s=>{const i=new Ae(s,0),a=new Ae(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,a],(c=>{r=r.add(c.Yr)}))})),k.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,s=r.length+1;let i=r;U.isDocumentKey(i)||(i=i.child(""));const a=new Ae(new U(i),0);let c=new Te(G);return this.Zr.forEachWhile((l=>{const h=l.key.path;return!!r.isPrefixOf(h)&&(h.length===s&&(c=c.add(l.Yr)),!0)}),a),k.resolve(this.ti(c))}ti(e){const t=[];return e.forEach((r=>{const s=this.Xr(r);s!==null&&t.push(s)})),t}removeMutationBatch(e,t){te(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return k.forEach(t.mutations,(s=>{const i=new Ae(s.key,t.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)})).next((()=>{this.Zr=r}))}ir(e){}containsKey(e,t){const r=new Ae(t,0),s=this.Zr.firstAfterOrEqual(r);return k.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,k.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class xE{constructor(e){this.ri=e,this.docs=(function(){return new ce(U.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,s=this.docs.get(r),i=s?s.size:0,a=this.ri(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return k.resolve(r?r.document.mutableCopy():Oe.newInvalidDocument(t))}getEntries(e,t){let r=Ut();return t.forEach((s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():Oe.newInvalidDocument(s))})),k.resolve(r)}getDocumentsMatchingQuery(e,t,r,s){let i=Ut();const a=t.path,c=new U(a.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(c);for(;l.hasNext();){const{key:h,value:{document:d}}=l.getNext();if(!a.isPrefixOf(h.path))break;h.path.length>a.length+1||hv(lv(d),r)<=0||(s.has(d.key)||mo(t,d))&&(i=i.insert(d.key,d.mutableCopy()))}return k.resolve(i)}getAllFromCollectionGroup(e,t,r,s){B(9500)}ii(e,t){return k.forEach(this.docs,(r=>t(r)))}newChangeBuffer(e){return new FE(this)}getSize(e){return k.resolve(this.size)}}class FE extends kE{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((r,s)=>{s.isValidDocument()?t.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(r)})),k.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class UE{constructor(e){this.persistence=e,this.si=new Qn((t=>Pc(t)),Cc),this.lastRemoteSnapshotVersion=j.min(),this.highestTargetId=0,this.oi=0,this._i=new Lc,this.targetCount=0,this.ai=Nr.ur()}forEachTarget(e,t){return this.si.forEach(((r,s)=>t(s))),k.resolve()}getLastRemoteSnapshotVersion(e){return k.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return k.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),k.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.oi&&(this.oi=t),k.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Nr(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,k.resolve()}updateTargetData(e,t){return this.Pr(t),k.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,k.resolve()}removeTargets(e,t,r){let s=0;const i=[];return this.si.forEach(((a,c)=>{c.sequenceNumber<=t&&r.get(c.targetId)===null&&(this.si.delete(a),i.push(this.removeMatchingKeysForTargetId(e,c.targetId)),s++)})),k.waitFor(i).next((()=>s))}getTargetCount(e){return k.resolve(this.targetCount)}getTargetData(e,t){const r=this.si.get(t)||null;return k.resolve(r)}addMatchingKeys(e,t,r){return this._i.Wr(t,r),k.resolve()}removeMatchingKeys(e,t,r){this._i.zr(t,r);const s=this.persistence.referenceDelegate,i=[];return s&&t.forEach((a=>{i.push(s.markPotentiallyOrphaned(e,a))})),k.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),k.resolve()}getMatchingKeysForTargetId(e,t){const r=this._i.Hr(t);return k.resolve(r)}containsKey(e,t){return k.resolve(this._i.containsKey(t))}}class Jd{constructor(e,t){this.ui={},this.overlays={},this.ci=new uo(0),this.li=!1,this.li=!0,this.hi=new ME,this.referenceDelegate=e(this),this.Pi=new UE(this),this.indexManager=new wE,this.remoteDocumentCache=(function(s){return new xE(s)})((r=>this.referenceDelegate.Ti(r))),this.serializer=new TE(t),this.Ii=new VE(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new OE,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ui[e.toKey()];return r||(r=new LE(t,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,r){M("MemoryPersistence","Starting transaction:",e);const s=new BE(this.ci.next());return this.referenceDelegate.Ei(),r(s).next((i=>this.referenceDelegate.di(s).next((()=>i)))).toPromise().then((i=>(s.raiseOnCommittedEvent(),i)))}Ai(e,t){return k.or(Object.values(this.ui).map((r=>()=>r.containsKey(e,t))))}}class BE extends dv{constructor(e){super(),this.currentSequenceNumber=e}}class xc{constructor(e){this.persistence=e,this.Ri=new Lc,this.Vi=null}static mi(e){return new xc(e)}get fi(){if(this.Vi)return this.Vi;throw B(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.fi.delete(r.toString()),k.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.fi.add(r.toString()),k.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),k.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((s=>this.fi.add(s.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((s=>{s.forEach((i=>this.fi.add(i.toString())))})).next((()=>r.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return k.forEach(this.fi,(r=>{const s=U.fromPath(r);return this.gi(e,s).next((i=>{i||t.removeEntry(s,j.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((r=>{r?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return k.or([()=>k.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class Fi{constructor(e,t){this.persistence=e,this.pi=new Qn((r=>gv(r.path)),((r,s)=>r.isEqual(s))),this.garbageCollector=CE(this,t)}static mi(e,t){return new Fi(e,t)}Ei(){}di(e){return k.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>t.next((s=>r+s))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}pr(e,t){return k.forEach(this.pi,((r,s)=>this.br(e,r,s).next((i=>i?k.resolve():t(s)))))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.ii(e,(a=>this.br(e,a,t).next((c=>{c||(r++,i.removeEntry(a,j.min()))})))).next((()=>i.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),k.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),k.resolve()}removeReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),k.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),k.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=gi(e.data.value)),t}br(e,t,r){return k.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const s=this.pi.get(t);return k.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class Fc{constructor(e,t,r,s){this.targetId=e,this.fromCache=t,this.Es=r,this.ds=s}static As(e,t){let r=K(),s=K();for(const i of t.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new Fc(e,t.fromCache,r,s)}}class $E{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class jE{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return D_()?8:pv(Le())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,s){const i={result:null};return this.ys(e,t).next((a=>{i.result=a})).next((()=>{if(!i.result)return this.ws(e,t,s,r).next((a=>{i.result=a}))})).next((()=>{if(i.result)return;const a=new $E;return this.Ss(e,t,a).next((c=>{if(i.result=c,this.Vs)return this.bs(e,t,a,c.size)}))})).next((()=>i.result))}bs(e,t,r,s){return r.documentReadCount<this.fs?(rr()<=W.DEBUG&&M("QueryEngine","SDK will not create cache indexes for query:",sr(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),k.resolve()):(rr()<=W.DEBUG&&M("QueryEngine","Query:",sr(t),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.gs*s?(rr()<=W.DEBUG&&M("QueryEngine","The SDK decides to create cache indexes for query:",sr(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Et(t))):k.resolve())}ys(e,t){if(th(t))return k.resolve(null);let r=Et(t);return this.indexManager.getIndexType(e,r).next((s=>s===0?null:(t.limit!==null&&s===1&&(t=xa(t,null,"F"),r=Et(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next((i=>{const a=K(...i);return this.ps.getDocuments(e,a).next((c=>this.indexManager.getMinOffset(e,r).next((l=>{const h=this.Ds(t,c);return this.Cs(t,h,a,l.readTime)?this.ys(e,xa(t,null,"F")):this.vs(e,h,t,l)}))))})))))}ws(e,t,r,s){return th(t)||s.isEqual(j.min())?k.resolve(null):this.ps.getDocuments(e,r).next((i=>{const a=this.Ds(t,i);return this.Cs(t,a,r,s)?k.resolve(null):(rr()<=W.DEBUG&&M("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),sr(t)),this.vs(e,a,t,uv(s,bs)).next((c=>c)))}))}Ds(e,t){let r=new Te(Cd(e));return t.forEach(((s,i)=>{mo(e,i)&&(r=r.add(i))})),r}Cs(e,t,r,s){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const i=e.limitType==="F"?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Ss(e,t,r){return rr()<=W.DEBUG&&M("QueryEngine","Using full collection scan to execute query:",sr(t)),this.ps.getDocumentsMatchingQuery(e,t,mn.min(),r)}vs(e,t,r,s){return this.ps.getDocumentsMatchingQuery(e,r,s).next((i=>(t.forEach((a=>{i=i.insert(a.key,a)})),i)))}}const Uc="LocalStore",qE=3e8;class zE{constructor(e,t,r,s){this.persistence=e,this.Fs=t,this.serializer=s,this.Ms=new ce(G),this.xs=new Qn((i=>Pc(i)),Cc),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new DE(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function HE(n,e,t,r){return new zE(n,e,t,r)}async function Yd(n,e){const t=q(n);return await t.persistence.runTransaction("Handle user change","readonly",(r=>{let s;return t.mutationQueue.getAllMutationBatches(r).next((i=>(s=i,t.Bs(e),t.mutationQueue.getAllMutationBatches(r)))).next((i=>{const a=[],c=[];let l=K();for(const h of s){a.push(h.batchId);for(const d of h.mutations)l=l.add(d.key)}for(const h of i){c.push(h.batchId);for(const d of h.mutations)l=l.add(d.key)}return t.localDocuments.getDocuments(r,l).next((h=>({Ls:h,removedBatchIds:a,addedBatchIds:c})))}))}))}function WE(n,e){const t=q(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const s=e.batch.keys(),i=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(c,l,h,d){const m=h.batch,g=m.keys();let I=k.resolve();return g.forEach((P=>{I=I.next((()=>d.getEntry(l,P))).next((C=>{const S=h.docVersions.get(P);te(S!==null,48541),C.version.compareTo(S)<0&&(m.applyToRemoteDocument(C,h),C.isValidDocument()&&(C.setReadTime(h.commitVersion),d.addEntry(C)))}))})),I.next((()=>c.mutationQueue.removeMutationBatch(l,m)))})(t,r,e,i).next((()=>i.apply(r))).next((()=>t.mutationQueue.performConsistencyCheck(r))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(c){let l=K();for(let h=0;h<c.mutationResults.length;++h)c.mutationResults[h].transformResults.length>0&&(l=l.add(c.batch.mutations[h].key));return l})(e)))).next((()=>t.localDocuments.getDocuments(r,s)))}))}function Zd(n){const e=q(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function GE(n,e){const t=q(n),r=e.snapshotVersion;let s=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(i=>{const a=t.Ns.newChangeBuffer({trackRemovals:!0});s=t.Ms;const c=[];e.targetChanges.forEach(((d,m)=>{const g=s.get(m);if(!g)return;c.push(t.Pi.removeMatchingKeys(i,d.removedDocuments,m).next((()=>t.Pi.addMatchingKeys(i,d.addedDocuments,m))));let I=g.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(m)!==null?I=I.withResumeToken(Ce.EMPTY_BYTE_STRING,j.min()).withLastLimboFreeSnapshotVersion(j.min()):d.resumeToken.approximateByteSize()>0&&(I=I.withResumeToken(d.resumeToken,r)),s=s.insert(m,I),(function(C,S,L){return C.resumeToken.approximateByteSize()===0||S.snapshotVersion.toMicroseconds()-C.snapshotVersion.toMicroseconds()>=qE?!0:L.addedDocuments.size+L.modifiedDocuments.size+L.removedDocuments.size>0})(g,I,d)&&c.push(t.Pi.updateTargetData(i,I))}));let l=Ut(),h=K();if(e.documentUpdates.forEach((d=>{e.resolvedLimboDocuments.has(d)&&c.push(t.persistence.referenceDelegate.updateLimboDocument(i,d))})),c.push(KE(i,a,e.documentUpdates).next((d=>{l=d.ks,h=d.qs}))),!r.isEqual(j.min())){const d=t.Pi.getLastRemoteSnapshotVersion(i).next((m=>t.Pi.setTargetsMetadata(i,i.currentSequenceNumber,r)));c.push(d)}return k.waitFor(c).next((()=>a.apply(i))).next((()=>t.localDocuments.getLocalViewOfDocuments(i,l,h))).next((()=>l))})).then((i=>(t.Ms=s,i)))}function KE(n,e,t){let r=K(),s=K();return t.forEach((i=>r=r.add(i))),e.getEntries(n,r).next((i=>{let a=Ut();return t.forEach(((c,l)=>{const h=i.get(c);l.isFoundDocument()!==h.isFoundDocument()&&(s=s.add(c)),l.isNoDocument()&&l.version.isEqual(j.min())?(e.removeEntry(c,l.readTime),a=a.insert(c,l)):!h.isValidDocument()||l.version.compareTo(h.version)>0||l.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(l),a=a.insert(c,l)):M(Uc,"Ignoring outdated watch update for ",c,". Current version:",h.version," Watch version:",l.version)})),{ks:a,qs:s}}))}function QE(n,e){const t=q(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=bc),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function XE(n,e){const t=q(n);return t.persistence.runTransaction("Allocate target","readwrite",(r=>{let s;return t.Pi.getTargetData(r,e).next((i=>i?(s=i,k.resolve(s)):t.Pi.allocateTargetId(r).next((a=>(s=new rn(e,a,"TargetPurposeListen",r.currentSequenceNumber),t.Pi.addTargetData(r,s).next((()=>s)))))))})).then((r=>{const s=t.Ms.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(r.targetId,r),t.xs.set(e,r.targetId)),r}))}async function ja(n,e,t){const r=q(n),s=r.Ms.get(e),i=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",i,(a=>r.persistence.referenceDelegate.removeTarget(a,s)))}catch(a){if(!jr(a))throw a;M(Uc,`Failed to update sequence numbers for target ${e}: ${a}`)}r.Ms=r.Ms.remove(e),r.xs.delete(s.target)}function ph(n,e,t){const r=q(n);let s=j.min(),i=K();return r.persistence.runTransaction("Execute query","readwrite",(a=>(function(l,h,d){const m=q(l),g=m.xs.get(d);return g!==void 0?k.resolve(m.Ms.get(g)):m.Pi.getTargetData(h,d)})(r,a,Et(e)).next((c=>{if(c)return s=c.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(a,c.targetId).next((l=>{i=l}))})).next((()=>r.Fs.getDocumentsMatchingQuery(a,e,t?s:j.min(),t?i:K()))).next((c=>(JE(r,Lv(e),c),{documents:c,Qs:i})))))}function JE(n,e,t){let r=n.Os.get(e)||j.min();t.forEach(((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)})),n.Os.set(e,r)}class mh{constructor(){this.activeTargetIds=jv()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class YE{constructor(){this.Mo=new mh,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,r){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new mh,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class ZE{Oo(e){}shutdown(){}}const gh="ConnectivityMonitor";class _h{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){M(gh,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){M(gh,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let hi=null;function qa(){return hi===null?hi=(function(){return 268435456+Math.round(2147483648*Math.random())})():hi++,"0x"+hi.toString(16)}const fa="RestConnection",eT={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class tT{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${r}/databases/${s}`,this.Wo=this.databaseId.database===Ni?`project_id=${r}`:`project_id=${r}&database_id=${s}`}Go(e,t,r,s,i){const a=qa(),c=this.zo(e,t.toUriEncodedString());M(fa,`Sending RPC '${e}' ${a}:`,c,r);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,s,i);const{host:h}=new URL(c),d=In(h);return this.Jo(e,c,l,r,d).then((m=>(M(fa,`Received RPC '${e}' ${a}: `,m),m)),(m=>{throw Sr(fa,`RPC '${e}' ${a} failed with error: `,m,"url: ",c,"request:",r),m}))}Ho(e,t,r,s,i,a){return this.Go(e,t,r,s,i)}jo(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Br})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((s,i)=>e[i]=s)),r&&r.headers.forEach(((s,i)=>e[i]=s))}zo(e,t){const r=eT[e];return`${this.Uo}/v1/${t}:${r}`}terminate(){}}class nT{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const Ne="WebChannelConnection";class rT extends tT{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,s,i){const a=qa();return new Promise(((c,l)=>{const h=new rd;h.setWithCredentials(!0),h.listenOnce(sd.COMPLETE,(()=>{try{switch(h.getLastErrorCode()){case mi.NO_ERROR:const m=h.getResponseJson();M(Ne,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(m)),c(m);break;case mi.TIMEOUT:M(Ne,`RPC '${e}' ${a} timed out`),l(new x(N.DEADLINE_EXCEEDED,"Request time out"));break;case mi.HTTP_ERROR:const g=h.getStatus();if(M(Ne,`RPC '${e}' ${a} failed with status:`,g,"response text:",h.getResponseText()),g>0){let I=h.getResponseJson();Array.isArray(I)&&(I=I[0]);const P=I?.error;if(P&&P.status&&P.message){const C=(function(L){const O=L.toLowerCase().replace(/_/g,"-");return Object.values(N).indexOf(O)>=0?O:N.UNKNOWN})(P.status);l(new x(C,P.message))}else l(new x(N.UNKNOWN,"Server responded with status "+h.getStatus()))}else l(new x(N.UNAVAILABLE,"Connection failed."));break;default:B(9055,{l_:e,streamId:a,h_:h.getLastErrorCode(),P_:h.getLastError()})}}finally{M(Ne,`RPC '${e}' ${a} completed.`)}}));const d=JSON.stringify(s);M(Ne,`RPC '${e}' ${a} sending request:`,s),h.send(t,"POST",d,r,15)}))}T_(e,t,r){const s=qa(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=ad(),c=od(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(l.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,t,r),l.encodeInitMessageHeaders=!0;const d=i.join("");M(Ne,`Creating RPC '${e}' stream ${s}: ${d}`,l);const m=a.createWebChannel(d,l);this.I_(m);let g=!1,I=!1;const P=new nT({Yo:S=>{I?M(Ne,`Not sending because RPC '${e}' stream ${s} is closed:`,S):(g||(M(Ne,`Opening RPC '${e}' stream ${s} transport.`),m.open(),g=!0),M(Ne,`RPC '${e}' stream ${s} sending:`,S),m.send(S))},Zo:()=>m.close()}),C=(S,L,O)=>{S.listen(L,(V=>{try{O(V)}catch(z){setTimeout((()=>{throw z}),0)}}))};return C(m,us.EventType.OPEN,(()=>{I||(M(Ne,`RPC '${e}' stream ${s} transport opened.`),P.o_())})),C(m,us.EventType.CLOSE,(()=>{I||(I=!0,M(Ne,`RPC '${e}' stream ${s} transport closed`),P.a_(),this.E_(m))})),C(m,us.EventType.ERROR,(S=>{I||(I=!0,Sr(Ne,`RPC '${e}' stream ${s} transport errored. Name:`,S.name,"Message:",S.message),P.a_(new x(N.UNAVAILABLE,"The operation could not be completed")))})),C(m,us.EventType.MESSAGE,(S=>{if(!I){const L=S.data[0];te(!!L,16349);const O=L,V=O?.error||O[0]?.error;if(V){M(Ne,`RPC '${e}' stream ${s} received error:`,V);const z=V.status;let Y=(function(_){const y=pe[_];if(y!==void 0)return Bd(y)})(z),Z=V.message;Y===void 0&&(Y=N.INTERNAL,Z="Unknown error status: "+z+" with message "+V.message),I=!0,P.a_(new x(Y,Z)),m.close()}else M(Ne,`RPC '${e}' stream ${s} received:`,L),P.u_(L)}})),C(c,id.STAT_EVENT,(S=>{S.stat===Na.PROXY?M(Ne,`RPC '${e}' stream ${s} detected buffering proxy`):S.stat===Na.NOPROXY&&M(Ne,`RPC '${e}' stream ${s} detected no buffering proxy`)})),setTimeout((()=>{P.__()}),0),P}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function da(){return typeof document<"u"?document:null}function vo(n){return new aE(n,!0)}class ep{constructor(e,t,r=1e3,s=1.5,i=6e4){this.Mi=e,this.timerId=t,this.d_=r,this.A_=s,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),s=Math.max(0,t-r);s>0&&M("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const yh="PersistentStream";class tp{constructor(e,t,r,s,i,a,c,l){this.Mi=e,this.S_=r,this.b_=s,this.connection=i,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=c,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new ep(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===N.RESOURCE_EXHAUSTED?(Ft(t.toString()),Ft("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===N.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,s])=>{this.D_===t&&this.G_(r,s)}),(r=>{e((()=>{const s=new x(N.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(s)}))}))}G_(e,t){const r=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{r((()=>this.listener.Xo()))})),this.stream.t_((()=>{r((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((s=>{r((()=>this.z_(s)))})),this.stream.onMessage((s=>{r((()=>++this.F_==1?this.J_(s):this.onNext(s)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return M(yh,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(M(yh,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class sT extends tp{constructor(e,t,r,s,i,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,s,a),this.serializer=i}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=lE(this.serializer,e),r=(function(i){if(!("targetChange"in i))return j.min();const a=i.targetChange;return a.targetIds&&a.targetIds.length?j.min():a.readTime?Tt(a.readTime):j.min()})(e);return this.listener.H_(t,r)}Y_(e){const t={};t.database=$a(this.serializer),t.addTarget=(function(i,a){let c;const l=a.target;if(c=La(l)?{documents:dE(i,l)}:{query:pE(i,l).ft},c.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){c.resumeToken=qd(i,a.resumeToken);const h=Fa(i,a.expectedCount);h!==null&&(c.expectedCount=h)}else if(a.snapshotVersion.compareTo(j.min())>0){c.readTime=xi(i,a.snapshotVersion.toTimestamp());const h=Fa(i,a.expectedCount);h!==null&&(c.expectedCount=h)}return c})(this.serializer,e);const r=gE(this.serializer,e);r&&(t.labels=r),this.q_(t)}Z_(e){const t={};t.database=$a(this.serializer),t.removeTarget=e,this.q_(t)}}class iT extends tp{constructor(e,t,r,s,i,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,s,a),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return te(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,te(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){te(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=fE(e.writeResults,e.commitTime),r=Tt(e.commitTime);return this.listener.na(r,t)}ra(){const e={};e.database=$a(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((r=>hE(this.serializer,r)))};this.q_(t)}}class oT{}class aT extends oT{constructor(e,t,r,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new x(N.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,a])=>this.connection.Go(e,Ua(t,r),s,i,a))).catch((i=>{throw i.name==="FirebaseError"?(i.code===N.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new x(N.UNKNOWN,i.toString())}))}Ho(e,t,r,s,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,c])=>this.connection.Ho(e,Ua(t,r),s,a,c,i))).catch((a=>{throw a.name==="FirebaseError"?(a.code===N.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new x(N.UNKNOWN,a.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class cT{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Ft(t),this.aa=!1):M("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const zn="RemoteStore";class uT{constructor(e,t,r,s,i){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo((a=>{r.enqueueAndForget((async()=>{Xn(this)&&(M(zn,"Restarting streams for network reachability change."),await(async function(l){const h=q(l);h.Ea.add(4),await Bs(h),h.Ra.set("Unknown"),h.Ea.delete(4),await Eo(h)})(this))}))})),this.Ra=new cT(r,s)}}async function Eo(n){if(Xn(n))for(const e of n.da)await e(!0)}async function Bs(n){for(const e of n.da)await e(!1)}function np(n,e){const t=q(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),qc(t)?jc(t):qr(t).O_()&&$c(t,e))}function Bc(n,e){const t=q(n),r=qr(t);t.Ia.delete(e),r.O_()&&rp(t,e),t.Ia.size===0&&(r.O_()?r.L_():Xn(t)&&t.Ra.set("Unknown"))}function $c(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(j.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}qr(n).Y_(e)}function rp(n,e){n.Va.Ue(e),qr(n).Z_(e)}function jc(n){n.Va=new rE({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),qr(n).start(),n.Ra.ua()}function qc(n){return Xn(n)&&!qr(n).x_()&&n.Ia.size>0}function Xn(n){return q(n).Ea.size===0}function sp(n){n.Va=void 0}async function lT(n){n.Ra.set("Online")}async function hT(n){n.Ia.forEach(((e,t)=>{$c(n,e)}))}async function fT(n,e){sp(n),qc(n)?(n.Ra.ha(e),jc(n)):n.Ra.set("Unknown")}async function dT(n,e,t){if(n.Ra.set("Online"),e instanceof jd&&e.state===2&&e.cause)try{await(async function(s,i){const a=i.cause;for(const c of i.targetIds)s.Ia.has(c)&&(await s.remoteSyncer.rejectListen(c,a),s.Ia.delete(c),s.Va.removeTarget(c))})(n,e)}catch(r){M(zn,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Ui(n,r)}else if(e instanceof vi?n.Va.Ze(e):e instanceof $d?n.Va.st(e):n.Va.tt(e),!t.isEqual(j.min()))try{const r=await Zd(n.localStore);t.compareTo(r)>=0&&await(function(i,a){const c=i.Va.Tt(a);return c.targetChanges.forEach(((l,h)=>{if(l.resumeToken.approximateByteSize()>0){const d=i.Ia.get(h);d&&i.Ia.set(h,d.withResumeToken(l.resumeToken,a))}})),c.targetMismatches.forEach(((l,h)=>{const d=i.Ia.get(l);if(!d)return;i.Ia.set(l,d.withResumeToken(Ce.EMPTY_BYTE_STRING,d.snapshotVersion)),rp(i,l);const m=new rn(d.target,l,h,d.sequenceNumber);$c(i,m)})),i.remoteSyncer.applyRemoteEvent(c)})(n,t)}catch(r){M(zn,"Failed to raise snapshot:",r),await Ui(n,r)}}async function Ui(n,e,t){if(!jr(e))throw e;n.Ea.add(1),await Bs(n),n.Ra.set("Offline"),t||(t=()=>Zd(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{M(zn,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await Eo(n)}))}function ip(n,e){return e().catch((t=>Ui(n,t,e)))}async function To(n){const e=q(n),t=vn(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:bc;for(;pT(e);)try{const s=await QE(e.localStore,r);if(s===null){e.Ta.length===0&&t.L_();break}r=s.batchId,mT(e,s)}catch(s){await Ui(e,s)}op(e)&&ap(e)}function pT(n){return Xn(n)&&n.Ta.length<10}function mT(n,e){n.Ta.push(e);const t=vn(n);t.O_()&&t.X_&&t.ea(e.mutations)}function op(n){return Xn(n)&&!vn(n).x_()&&n.Ta.length>0}function ap(n){vn(n).start()}async function gT(n){vn(n).ra()}async function _T(n){const e=vn(n);for(const t of n.Ta)e.ea(t.mutations)}async function yT(n,e,t){const r=n.Ta.shift(),s=Vc.from(r,e,t);await ip(n,(()=>n.remoteSyncer.applySuccessfulWrite(s))),await To(n)}async function vT(n,e){e&&vn(n).X_&&await(async function(r,s){if((function(a){return eE(a)&&a!==N.ABORTED})(s.code)){const i=r.Ta.shift();vn(r).B_(),await ip(r,(()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s))),await To(r)}})(n,e),op(n)&&ap(n)}async function vh(n,e){const t=q(n);t.asyncQueue.verifyOperationInProgress(),M(zn,"RemoteStore received new credentials");const r=Xn(t);t.Ea.add(3),await Bs(t),r&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await Eo(t)}async function ET(n,e){const t=q(n);e?(t.Ea.delete(2),await Eo(t)):e||(t.Ea.add(2),await Bs(t),t.Ra.set("Unknown"))}function qr(n){return n.ma||(n.ma=(function(t,r,s){const i=q(t);return i.sa(),new sT(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)})(n.datastore,n.asyncQueue,{Xo:lT.bind(null,n),t_:hT.bind(null,n),r_:fT.bind(null,n),H_:dT.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),qc(n)?jc(n):n.Ra.set("Unknown")):(await n.ma.stop(),sp(n))}))),n.ma}function vn(n){return n.fa||(n.fa=(function(t,r,s){const i=q(t);return i.sa(),new iT(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:gT.bind(null,n),r_:vT.bind(null,n),ta:_T.bind(null,n),na:yT.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await To(n)):(await n.fa.stop(),n.Ta.length>0&&(M(zn,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class zc{constructor(e,t,r,s,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new Ln,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((a=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,s,i){const a=Date.now()+r,c=new zc(e,t,a,s,i);return c.start(r),c}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new x(N.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Hc(n,e){if(Ft("AsyncQueue",`${e}: ${n}`),jr(n))return new x(N.UNAVAILABLE,`${e}: ${n}`);throw n}class gr{static emptySet(e){return new gr(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||U.comparator(t.key,r.key):(t,r)=>U.comparator(t.key,r.key),this.keyedMap=ls(),this.sortedSet=new ce(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,r)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof gr)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new gr;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class Eh{constructor(){this.ga=new ce(U.comparator)}track(e){const t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):B(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,r)=>{e.push(r)})),e}}class Dr{constructor(e,t,r,s,i,a,c,l,h){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=a,this.syncStateChanged=c,this.excludesMetadataChanges=l,this.hasCachedResults=h}static fromInitialDocuments(e,t,r,s,i){const a=[];return t.forEach((c=>{a.push({type:0,doc:c})})),new Dr(e,t,gr.emptySet(t),a,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&po(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==r[s].type||!t[s].doc.isEqual(r[s].doc))return!1;return!0}}class TT{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class IT{constructor(){this.queries=Th(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){const s=q(t),i=s.queries;s.queries=Th(),i.forEach(((a,c)=>{for(const l of c.Sa)l.onError(r)}))})(this,new x(N.ABORTED,"Firestore shutting down"))}}function Th(){return new Qn((n=>Pd(n)),po)}async function wT(n,e){const t=q(n);let r=3;const s=e.query;let i=t.queries.get(s);i?!i.ba()&&e.Da()&&(r=2):(i=new TT,r=e.Da()?0:1);try{switch(r){case 0:i.wa=await t.onListen(s,!0);break;case 1:i.wa=await t.onListen(s,!1);break;case 2:await t.onFirstRemoteStoreListen(s)}}catch(a){const c=Hc(a,`Initialization of query '${sr(e.query)}' failed`);return void e.onError(c)}t.queries.set(s,i),i.Sa.push(e),e.va(t.onlineState),i.wa&&e.Fa(i.wa)&&Wc(t)}async function AT(n,e){const t=q(n),r=e.query;let s=3;const i=t.queries.get(r);if(i){const a=i.Sa.indexOf(e);a>=0&&(i.Sa.splice(a,1),i.Sa.length===0?s=e.Da()?0:1:!i.ba()&&e.Da()&&(s=2))}switch(s){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function bT(n,e){const t=q(n);let r=!1;for(const s of e){const i=s.query,a=t.queries.get(i);if(a){for(const c of a.Sa)c.Fa(s)&&(r=!0);a.wa=s}}r&&Wc(t)}function RT(n,e,t){const r=q(n),s=r.queries.get(e);if(s)for(const i of s.Sa)i.onError(t);r.queries.delete(e)}function Wc(n){n.Ca.forEach((e=>{e.next()}))}var za,Ih;(Ih=za||(za={})).Ma="default",Ih.Cache="cache";class ST{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Dr(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const r=t!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Dr.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==za.Cache}}class cp{constructor(e){this.key=e}}class up{constructor(e){this.key=e}}class PT{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=K(),this.mutatedKeys=K(),this.eu=Cd(e),this.tu=new gr(this.eu)}get nu(){return this.Ya}ru(e,t){const r=t?t.iu:new Eh,s=t?t.tu:this.tu;let i=t?t.mutatedKeys:this.mutatedKeys,a=s,c=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,h=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal(((d,m)=>{const g=s.get(d),I=mo(this.query,m)?m:null,P=!!g&&this.mutatedKeys.has(g.key),C=!!I&&(I.hasLocalMutations||this.mutatedKeys.has(I.key)&&I.hasCommittedMutations);let S=!1;g&&I?g.data.isEqual(I.data)?P!==C&&(r.track({type:3,doc:I}),S=!0):this.su(g,I)||(r.track({type:2,doc:I}),S=!0,(l&&this.eu(I,l)>0||h&&this.eu(I,h)<0)&&(c=!0)):!g&&I?(r.track({type:0,doc:I}),S=!0):g&&!I&&(r.track({type:1,doc:g}),S=!0,(l||h)&&(c=!0)),S&&(I?(a=a.add(I),i=C?i.add(d):i.delete(d)):(a=a.delete(d),i=i.delete(d)))})),this.query.limit!==null)for(;a.size>this.query.limit;){const d=this.query.limitType==="F"?a.last():a.first();a=a.delete(d.key),i=i.delete(d.key),r.track({type:1,doc:d})}return{tu:a,iu:r,Cs:c,mutatedKeys:i}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,s){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const a=e.iu.ya();a.sort(((d,m)=>(function(I,P){const C=S=>{switch(S){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return B(20277,{Rt:S})}};return C(I)-C(P)})(d.type,m.type)||this.eu(d.doc,m.doc))),this.ou(r),s=s??!1;const c=t&&!s?this._u():[],l=this.Xa.size===0&&this.current&&!s?1:0,h=l!==this.Za;return this.Za=l,a.length!==0||h?{snapshot:new Dr(this.query,e.tu,i,a,e.mutatedKeys,l===0,h,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:c}:{au:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Eh,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=K(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))}));const t=[];return e.forEach((r=>{this.Xa.has(r)||t.push(new up(r))})),this.Xa.forEach((r=>{e.has(r)||t.push(new cp(r))})),t}cu(e){this.Ya=e.Qs,this.Xa=K();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Dr.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Gc="SyncEngine";class CT{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class kT{constructor(e){this.key=e,this.hu=!1}}class NT{constructor(e,t,r,s,i,a){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new Qn((c=>Pd(c)),po),this.Iu=new Map,this.Eu=new Set,this.du=new ce(U.comparator),this.Au=new Map,this.Ru=new Lc,this.Vu={},this.mu=new Map,this.fu=Nr.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function DT(n,e,t=!0){const r=mp(n);let s;const i=r.Tu.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.lu()):s=await lp(r,e,t,!0),s}async function VT(n,e){const t=mp(n);await lp(t,e,!0,!1)}async function lp(n,e,t,r){const s=await XE(n.localStore,Et(e)),i=s.targetId,a=n.sharedClientState.addLocalQueryTarget(i,t);let c;return r&&(c=await OT(n,e,i,a==="current",s.resumeToken)),n.isPrimaryClient&&t&&np(n.remoteStore,s),c}async function OT(n,e,t,r,s){n.pu=(m,g,I)=>(async function(C,S,L,O){let V=S.view.ru(L);V.Cs&&(V=await ph(C.localStore,S.query,!1).then((({documents:T})=>S.view.ru(T,V))));const z=O&&O.targetChanges.get(S.targetId),Y=O&&O.targetMismatches.get(S.targetId)!=null,Z=S.view.applyChanges(V,C.isPrimaryClient,z,Y);return Ah(C,S.targetId,Z.au),Z.snapshot})(n,m,g,I);const i=await ph(n.localStore,e,!0),a=new PT(e,i.Qs),c=a.ru(i.documents),l=Us.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",s),h=a.applyChanges(c,n.isPrimaryClient,l);Ah(n,t,h.au);const d=new CT(e,t,a);return n.Tu.set(e,d),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),h.snapshot}async function MT(n,e,t){const r=q(n),s=r.Tu.get(e),i=r.Iu.get(s.targetId);if(i.length>1)return r.Iu.set(s.targetId,i.filter((a=>!po(a,e)))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await ja(r.localStore,s.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(s.targetId),t&&Bc(r.remoteStore,s.targetId),Ha(r,s.targetId)})).catch($r)):(Ha(r,s.targetId),await ja(r.localStore,s.targetId,!0))}async function LT(n,e){const t=q(n),r=t.Tu.get(e),s=t.Iu.get(r.targetId);t.isPrimaryClient&&s.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Bc(t.remoteStore,r.targetId))}async function xT(n,e,t){const r=zT(n);try{const s=await(function(a,c){const l=q(a),h=ae.now(),d=c.reduce(((I,P)=>I.add(P.key)),K());let m,g;return l.persistence.runTransaction("Locally write mutations","readwrite",(I=>{let P=Ut(),C=K();return l.Ns.getEntries(I,d).next((S=>{P=S,P.forEach(((L,O)=>{O.isValidDocument()||(C=C.add(L))}))})).next((()=>l.localDocuments.getOverlayedDocuments(I,P))).next((S=>{m=S;const L=[];for(const O of c){const V=Qv(O,m.get(O.key).overlayedDocument);V!=null&&L.push(new An(O.key,V,Td(V.value.mapValue),ct.exists(!0)))}return l.mutationQueue.addMutationBatch(I,h,L,c)})).next((S=>{g=S;const L=S.applyToLocalDocumentSet(m,C);return l.documentOverlayCache.saveOverlays(I,S.batchId,L)}))})).then((()=>({batchId:g.batchId,changes:Nd(m)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),(function(a,c,l){let h=a.Vu[a.currentUser.toKey()];h||(h=new ce(G)),h=h.insert(c,l),a.Vu[a.currentUser.toKey()]=h})(r,s.batchId,t),await $s(r,s.changes),await To(r.remoteStore)}catch(s){const i=Hc(s,"Failed to persist write");t.reject(i)}}async function hp(n,e){const t=q(n);try{const r=await GE(t.localStore,e);e.targetChanges.forEach(((s,i)=>{const a=t.Au.get(i);a&&(te(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?a.hu=!0:s.modifiedDocuments.size>0?te(a.hu,14607):s.removedDocuments.size>0&&(te(a.hu,42227),a.hu=!1))})),await $s(t,r,e)}catch(r){await $r(r)}}function wh(n,e,t){const r=q(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const s=[];r.Tu.forEach(((i,a)=>{const c=a.view.va(e);c.snapshot&&s.push(c.snapshot)})),(function(a,c){const l=q(a);l.onlineState=c;let h=!1;l.queries.forEach(((d,m)=>{for(const g of m.Sa)g.va(c)&&(h=!0)})),h&&Wc(l)})(r.eventManager,e),s.length&&r.Pu.H_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function FT(n,e,t){const r=q(n);r.sharedClientState.updateQueryState(e,"rejected",t);const s=r.Au.get(e),i=s&&s.key;if(i){let a=new ce(U.comparator);a=a.insert(i,Oe.newNoDocument(i,j.min()));const c=K().add(i),l=new yo(j.min(),new Map,new ce(G),a,c);await hp(r,l),r.du=r.du.remove(i),r.Au.delete(e),Kc(r)}else await ja(r.localStore,e,!1).then((()=>Ha(r,e,t))).catch($r)}async function UT(n,e){const t=q(n),r=e.batch.batchId;try{const s=await WE(t.localStore,e);dp(t,r,null),fp(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await $s(t,s)}catch(s){await $r(s)}}async function BT(n,e,t){const r=q(n);try{const s=await(function(a,c){const l=q(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",(h=>{let d;return l.mutationQueue.lookupMutationBatch(h,c).next((m=>(te(m!==null,37113),d=m.keys(),l.mutationQueue.removeMutationBatch(h,m)))).next((()=>l.mutationQueue.performConsistencyCheck(h))).next((()=>l.documentOverlayCache.removeOverlaysForBatchId(h,d,c))).next((()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,d))).next((()=>l.localDocuments.getDocuments(h,d)))}))})(r.localStore,e);dp(r,e,t),fp(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await $s(r,s)}catch(s){await $r(s)}}function fp(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function dp(n,e,t){const r=q(n);let s=r.Vu[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(t?i.reject(t):i.resolve(),s=s.remove(e)),r.Vu[r.currentUser.toKey()]=s}}function Ha(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Iu.get(e))n.Tu.delete(r),t&&n.Pu.yu(r,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((r=>{n.Ru.containsKey(r)||pp(n,r)}))}function pp(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(Bc(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),Kc(n))}function Ah(n,e,t){for(const r of t)r instanceof cp?(n.Ru.addReference(r.key,e),$T(n,r)):r instanceof up?(M(Gc,"Document no longer in limbo: "+r.key),n.Ru.removeReference(r.key,e),n.Ru.containsKey(r.key)||pp(n,r.key)):B(19791,{wu:r})}function $T(n,e){const t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Eu.has(r)||(M(Gc,"New document in limbo: "+t),n.Eu.add(r),Kc(n))}function Kc(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new U(oe.fromString(e)),r=n.fu.next();n.Au.set(r,new kT(t)),n.du=n.du.insert(t,r),np(n.remoteStore,new rn(Et(kc(t.path)),r,"TargetPurposeLimboResolution",uo.ce))}}async function $s(n,e,t){const r=q(n),s=[],i=[],a=[];r.Tu.isEmpty()||(r.Tu.forEach(((c,l)=>{a.push(r.pu(l,e,t).then((h=>{if((h||t)&&r.isPrimaryClient){const d=h?!h.fromCache:t?.targetChanges.get(l.targetId)?.current;r.sharedClientState.updateQueryState(l.targetId,d?"current":"not-current")}if(h){s.push(h);const d=Fc.As(l.targetId,h);i.push(d)}})))})),await Promise.all(a),r.Pu.H_(s),await(async function(l,h){const d=q(l);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",(m=>k.forEach(h,(g=>k.forEach(g.Es,(I=>d.persistence.referenceDelegate.addReference(m,g.targetId,I))).next((()=>k.forEach(g.ds,(I=>d.persistence.referenceDelegate.removeReference(m,g.targetId,I)))))))))}catch(m){if(!jr(m))throw m;M(Uc,"Failed to update sequence numbers: "+m)}for(const m of h){const g=m.targetId;if(!m.fromCache){const I=d.Ms.get(g),P=I.snapshotVersion,C=I.withLastLimboFreeSnapshotVersion(P);d.Ms=d.Ms.insert(g,C)}}})(r.localStore,i))}async function jT(n,e){const t=q(n);if(!t.currentUser.isEqual(e)){M(Gc,"User change. New user:",e.toKey());const r=await Yd(t.localStore,e);t.currentUser=e,(function(i,a){i.mu.forEach((c=>{c.forEach((l=>{l.reject(new x(N.CANCELLED,a))}))})),i.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await $s(t,r.Ls)}}function qT(n,e){const t=q(n),r=t.Au.get(e);if(r&&r.hu)return K().add(r.key);{let s=K();const i=t.Iu.get(e);if(!i)return s;for(const a of i){const c=t.Tu.get(a);s=s.unionWith(c.view.nu)}return s}}function mp(n){const e=q(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=hp.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=qT.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=FT.bind(null,e),e.Pu.H_=bT.bind(null,e.eventManager),e.Pu.yu=RT.bind(null,e.eventManager),e}function zT(n){const e=q(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=UT.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=BT.bind(null,e),e}class Bi{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=vo(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return HE(this.persistence,new jE,e.initialUser,this.serializer)}Cu(e){return new Jd(xc.mi,this.serializer)}Du(e){return new YE}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Bi.provider={build:()=>new Bi};class HT extends Bi{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){te(this.persistence.referenceDelegate instanceof Fi,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new SE(r,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?ze.withCacheSize(this.cacheSizeBytes):ze.DEFAULT;return new Jd((r=>Fi.mi(r,t)),this.serializer)}}class Wa{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>wh(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=jT.bind(null,this.syncEngine),await ET(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new IT})()}createDatastore(e){const t=vo(e.databaseInfo.databaseId),r=(function(i){return new rT(i)})(e.databaseInfo);return(function(i,a,c,l){return new aT(i,a,c,l)})(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return(function(r,s,i,a,c){return new uT(r,s,i,a,c)})(this.localStore,this.datastore,e.asyncQueue,(t=>wh(this.syncEngine,t,0)),(function(){return _h.v()?new _h:new ZE})())}createSyncEngine(e,t){return(function(s,i,a,c,l,h,d){const m=new NT(s,i,a,c,l,h);return d&&(m.gu=!0),m})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const r=q(t);M(zn,"RemoteStore shutting down."),r.Ea.add(5),await Bs(r),r.Aa.shutdown(),r.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Wa.provider={build:()=>new Wa};class WT{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Ft("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const En="FirestoreClient";class GT{constructor(e,t,r,s,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=s,this.user=Ve.UNAUTHENTICATED,this.clientId=wc.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,(async a=>{M(En,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a})),this.appCheckCredentials.start(r,(a=>(M(En,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ln;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=Hc(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function pa(n,e){n.asyncQueue.verifyOperationInProgress(),M(En,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener((async s=>{r.isEqual(s)||(await Yd(e.localStore,s),r=s)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function bh(n,e){n.asyncQueue.verifyOperationInProgress();const t=await KT(n);M(En,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((r=>vh(e.remoteStore,r))),n.setAppCheckTokenChangeListener(((r,s)=>vh(e.remoteStore,s))),n._onlineComponents=e}async function KT(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){M(En,"Using user provided OfflineComponentProvider");try{await pa(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(s){return s.name==="FirebaseError"?s.code===N.FAILED_PRECONDITION||s.code===N.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11})(t))throw t;Sr("Error using user provided cache. Falling back to memory cache: "+t),await pa(n,new Bi)}}else M(En,"Using default OfflineComponentProvider"),await pa(n,new HT(void 0));return n._offlineComponents}async function gp(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(M(En,"Using user provided OnlineComponentProvider"),await bh(n,n._uninitializedComponentsProvider._online)):(M(En,"Using default OnlineComponentProvider"),await bh(n,new Wa))),n._onlineComponents}function QT(n){return gp(n).then((e=>e.syncEngine))}async function Rh(n){const e=await gp(n),t=e.eventManager;return t.onListen=DT.bind(null,e.syncEngine),t.onUnlisten=MT.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=VT.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=LT.bind(null,e.syncEngine),t}function _p(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const Sh=new Map;const yp="firestore.googleapis.com",Ph=!0;class Ch{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new x(N.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=yp,this.ssl=Ph}else this.host=e.host,this.ssl=e.ssl??Ph;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Xd;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<bE)throw new x(N.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}cv("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=_p(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new x(N.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new x(N.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new x(N.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,s){return r.timeoutSeconds===s.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Io{constructor(e,t,r,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Ch({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new x(N.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new x(N.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Ch(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new Yy;switch(r.type){case"firstParty":return new nv(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new x(N.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const r=Sh.get(t);r&&(M("ComponentProvider","Removing Datastore"),Sh.delete(t),r.terminate())})(this),Promise.resolve()}}function XT(n,e,t,r={}){n=fn(n,Io);const s=In(e),i=n._getSettings(),a={...i,emulatorOptions:n._getEmulatorOptions()},c=`${e}:${t}`;s&&(_c(`https://${c}`),yc("Firestore",!0)),i.host!==yp&&i.host!==c&&Sr("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...i,host:c,ssl:s,emulatorOptions:r};if(!$n(l,a)&&(n._setSettings(l),r.mockUserToken)){let h,d;if(typeof r.mockUserToken=="string")h=r.mockUserToken,d=Ve.MOCK_USER;else{h=w_(r.mockUserToken,n._app?.options.projectId);const m=r.mockUserToken.sub||r.mockUserToken.user_id;if(!m)throw new x(N.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new Ve(m)}n._authCredentials=new Zy(new ud(h,d))}}class wo{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new wo(this.firestore,e,this._query)}}class Ee{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new dn(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ee(this.firestore,e,this._key)}toJSON(){return{type:Ee._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(xs(t,Ee._jsonSchema))return new Ee(e,r||null,new U(oe.fromString(t.referencePath)))}}Ee._jsonSchemaVersion="firestore/documentReference/1.0",Ee._jsonSchema={type:me("string",Ee._jsonSchemaVersion),referencePath:me("string")};class dn extends wo{constructor(e,t,r){super(e,t,kc(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ee(this.firestore,null,new U(e))}withConverter(e){return new dn(this.firestore,e,this._path)}}function vp(n,e,...t){if(n=ge(n),ld("collection","path",e),n instanceof Io){const r=oe.fromString(e,...t);return jl(r),new dn(n,null,r)}{if(!(n instanceof Ee||n instanceof dn))throw new x(N.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(oe.fromString(e,...t));return jl(r),new dn(n.firestore,null,r)}}function Qc(n,e,...t){if(n=ge(n),arguments.length===1&&(e=wc.newId()),ld("doc","path",e),n instanceof Io){const r=oe.fromString(e,...t);return $l(r),new Ee(n,null,new U(r))}{if(!(n instanceof Ee||n instanceof dn))throw new x(N.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(oe.fromString(e,...t));return $l(r),new Ee(n.firestore,n instanceof dn?n.converter:null,new U(r))}}const kh="AsyncQueue";class Nh{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new ep(this,"async_queue_retry"),this._c=()=>{const r=da();r&&M(kh,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const t=da();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=da();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new Ln;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!jr(e))throw e;M(kh,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((r=>{throw this.nc=r,this.rc=!1,Ft("INTERNAL UNHANDLED ERROR: ",Dh(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const s=zc.createAndSchedule(this,e,t,r,(i=>this.hc(i)));return this.tc.push(s),s}uc(){this.nc&&B(47125,{Pc:Dh(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,r)=>t.targetTimeMs-r.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function Dh(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}function Vh(n){return(function(t,r){if(typeof t!="object"||t===null)return!1;const s=t;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1})(n,["next","error","complete"])}class Vr extends Io{constructor(e,t,r,s){super(e,t,r,s),this.type="firestore",this._queue=new Nh,this._persistenceKey=s?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Nh(e),this._firestoreClient=void 0,await e}}}function JT(n,e){const t=typeof n=="object"?n:Tc(),r=typeof n=="string"?n:Ni,s=co(t,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=Kf("firestore");i&&XT(s,...i)}return s}function Ep(n){if(n._terminated)throw new x(N.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||YT(n),n._firestoreClient}function YT(n){const e=n._freezeSettings(),t=(function(s,i,a,c){return new vv(s,i,a,c.host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,_p(c.experimentalLongPollingOptions),c.useFetchStreams,c.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new GT(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(s){const i=s?._online.build();return{_offline:s?._offline.build(i),_online:i}})(n._componentsProvider))}class st{constructor(e){this._byteString=e}static fromBase64String(e){try{return new st(Ce.fromBase64String(e))}catch(t){throw new x(N.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new st(Ce.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:st._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(xs(e,st._jsonSchema))return st.fromBase64String(e.bytes)}}st._jsonSchemaVersion="firestore/bytes/1.0",st._jsonSchema={type:me("string",st._jsonSchemaVersion),bytes:me("string")};class Ao{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new x(N.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Re(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Xc{constructor(e){this._methodName=e}}class It{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new x(N.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new x(N.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return G(this._lat,e._lat)||G(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:It._jsonSchemaVersion}}static fromJSON(e){if(xs(e,It._jsonSchema))return new It(e.latitude,e.longitude)}}It._jsonSchemaVersion="firestore/geoPoint/1.0",It._jsonSchema={type:me("string",It._jsonSchemaVersion),latitude:me("number"),longitude:me("number")};class wt{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0})(this._values,e._values)}toJSON(){return{type:wt._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(xs(e,wt._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new wt(e.vectorValues);throw new x(N.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}wt._jsonSchemaVersion="firestore/vectorValue/1.0",wt._jsonSchema={type:me("string",wt._jsonSchemaVersion),vectorValues:me("object")};const ZT=/^__.*__$/;class eI{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new An(e,this.data,this.fieldMask,t,this.fieldTransforms):new Fs(e,this.data,t,this.fieldTransforms)}}class Tp{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new An(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Ip(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw B(40011,{Ac:n})}}class Jc{constructor(e,t,r,s,i,a){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Jc({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.gc(e),r}yc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return $i(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(Ip(this.Ac)&&ZT.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class tI{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||vo(e)}Cc(e,t,r,s=!1){return new Jc({Ac:e,methodName:t,Dc:r,path:Re.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function wp(n){const e=n._freezeSettings(),t=vo(n._databaseId);return new tI(n._databaseId,!!e.ignoreUndefinedProperties,t)}function nI(n,e,t,r,s,i={}){const a=n.Cc(i.merge||i.mergeFields?2:0,e,t,s);Yc("Data must be an object, but it was:",a,r);const c=Ap(r,a);let l,h;if(i.merge)l=new et(a.fieldMask),h=a.fieldTransforms;else if(i.mergeFields){const d=[];for(const m of i.mergeFields){const g=Ga(e,m,t);if(!a.contains(g))throw new x(N.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);Rp(d,g)||d.push(g)}l=new et(d),h=a.fieldTransforms.filter((m=>l.covers(m.field)))}else l=null,h=a.fieldTransforms;return new eI(new We(c),l,h)}class bo extends Xc{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof bo}}function rI(n,e,t,r){const s=n.Cc(1,e,t);Yc("Data must be an object, but it was:",s,r);const i=[],a=We.empty();wn(r,((l,h)=>{const d=Zc(e,l,t);h=ge(h);const m=s.yc(d);if(h instanceof bo)i.push(d);else{const g=Ro(h,m);g!=null&&(i.push(d),a.set(d,g))}}));const c=new et(i);return new Tp(a,c,s.fieldTransforms)}function sI(n,e,t,r,s,i){const a=n.Cc(1,e,t),c=[Ga(e,r,t)],l=[s];if(i.length%2!=0)throw new x(N.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<i.length;g+=2)c.push(Ga(e,i[g])),l.push(i[g+1]);const h=[],d=We.empty();for(let g=c.length-1;g>=0;--g)if(!Rp(h,c[g])){const I=c[g];let P=l[g];P=ge(P);const C=a.yc(I);if(P instanceof bo)h.push(I);else{const S=Ro(P,C);S!=null&&(h.push(I),d.set(I,S))}}const m=new et(h);return new Tp(d,m,a.fieldTransforms)}function Ro(n,e){if(bp(n=ge(n)))return Yc("Unsupported field value:",e,n),Ap(n,e);if(n instanceof Xc)return(function(r,s){if(!Ip(s.Ac))throw s.Sc(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(r,s){const i=[];let a=0;for(const c of r){let l=Ro(c,s.wc(a));l==null&&(l={nullValue:"NULL_VALUE"}),i.push(l),a++}return{arrayValue:{values:i}}})(n,e)}return(function(r,s){if((r=ge(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return qv(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=ae.fromDate(r);return{timestampValue:xi(s.serializer,i)}}if(r instanceof ae){const i=new ae(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:xi(s.serializer,i)}}if(r instanceof It)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof st)return{bytesValue:qd(s.serializer,r._byteString)};if(r instanceof Ee){const i=s.databaseId,a=r.firestore._databaseId;if(!a.isEqual(i))throw s.Sc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Mc(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof wt)return(function(a,c){return{mapValue:{fields:{[vd]:{stringValue:Ed},[Di]:{arrayValue:{values:a.toArray().map((h=>{if(typeof h!="number")throw c.Sc("VectorValues must only contain numeric values.");return Nc(c.serializer,h)}))}}}}}})(r,s);throw s.Sc(`Unsupported field value: ${Ac(r)}`)})(n,e)}function Ap(n,e){const t={};return dd(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):wn(n,((r,s)=>{const i=Ro(s,e.mc(r));i!=null&&(t[r]=i)})),{mapValue:{fields:t}}}function bp(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof ae||n instanceof It||n instanceof st||n instanceof Ee||n instanceof Xc||n instanceof wt)}function Yc(n,e,t){if(!bp(t)||!hd(t)){const r=Ac(t);throw r==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+r)}}function Ga(n,e,t){if((e=ge(e))instanceof Ao)return e._internalPath;if(typeof e=="string")return Zc(n,e);throw $i("Field path arguments must be of type string or ",n,!1,void 0,t)}const iI=new RegExp("[~\\*/\\[\\]]");function Zc(n,e,t){if(e.search(iI)>=0)throw $i(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Ao(...e.split("."))._internalPath}catch{throw $i(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function $i(n,e,t,r,s){const i=r&&!r.isEmpty(),a=s!==void 0;let c=`Function ${e}() called with invalid data`;t&&(c+=" (via `toFirestore()`)"),c+=". ";let l="";return(i||a)&&(l+=" (found",i&&(l+=` in field ${r}`),a&&(l+=` in document ${s}`),l+=")"),new x(N.INVALID_ARGUMENT,c+n+l)}function Rp(n,e){return n.some((t=>t.isEqual(e)))}class Sp{constructor(e,t,r,s,i){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Ee(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new oI(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Pp("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class oI extends Sp{data(){return super.data()}}function Pp(n,e){return typeof e=="string"?Zc(n,e):e instanceof Ao?e._internalPath:e._delegate._internalPath}function aI(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new x(N.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class cI{convertValue(e,t="none"){switch(yn(e)){case 0:return null;case 1:return e.booleanValue;case 2:return fe(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(_n(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw B(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return wn(e,((s,i)=>{r[s]=this.convertValue(i,t)})),r}convertVectorValue(e){const t=e.fields?.[Di].arrayValue?.values?.map((r=>fe(r.doubleValue)));return new wt(t)}convertGeoPoint(e){return new It(fe(e.latitude),fe(e.longitude))}convertArray(e,t){return(e.values||[]).map((r=>this.convertValue(r,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const r=ho(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Rs(e));default:return null}}convertTimestamp(e){const t=gn(e);return new ae(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=oe.fromString(e);te(Qd(r),9688,{name:e});const s=new Ss(r.get(1),r.get(3)),i=new U(r.popFirst(5));return s.isEqual(t)||Ft(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}function uI(n,e,t){let r;return r=n?n.toFirestore(e):e,r}class fs{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class xn extends Sp{constructor(e,t,r,s,i,a){super(e,t,r,s,a),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Ei(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(Pp("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new x(N.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=xn._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}xn._jsonSchemaVersion="firestore/documentSnapshot/1.0",xn._jsonSchema={type:me("string",xn._jsonSchemaVersion),bundleSource:me("string","DocumentSnapshot"),bundleName:me("string"),bundle:me("string")};class Ei extends xn{data(e={}){return super.data(e)}}class _r{constructor(e,t,r,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new fs(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((r=>{e.call(t,new Ei(this._firestore,this._userDataWriter,r.key,r,new fs(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new x(N.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(s,i){if(s._snapshot.oldDocs.isEmpty()){let a=0;return s._snapshot.docChanges.map((c=>{const l=new Ei(s._firestore,s._userDataWriter,c.doc.key,c.doc,new fs(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);return c.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}}))}{let a=s._snapshot.oldDocs;return s._snapshot.docChanges.filter((c=>i||c.type!==3)).map((c=>{const l=new Ei(s._firestore,s._userDataWriter,c.doc.key,c.doc,new fs(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);let h=-1,d=-1;return c.type!==0&&(h=a.indexOf(c.doc.key),a=a.delete(c.doc.key)),c.type!==1&&(a=a.add(c.doc),d=a.indexOf(c.doc.key)),{type:lI(c.type),doc:l,oldIndex:h,newIndex:d}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new x(N.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=_r._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=wc.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],s=[];return this.docs.forEach((i=>{i._document!==null&&(t.push(i._document),r.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),s.push(i.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function lI(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return B(61501,{type:n})}}_r._jsonSchemaVersion="firestore/querySnapshot/1.0",_r._jsonSchema={type:me("string",_r._jsonSchemaVersion),bundleSource:me("string","QuerySnapshot"),bundleName:me("string"),bundle:me("string")};class Cp extends cI{constructor(e){super(),this.firestore=e}convertBytes(e){return new st(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Ee(this.firestore,null,t)}}function hI(n,e,t,...r){n=fn(n,Ee);const s=fn(n.firestore,Vr),i=wp(s);let a;return a=typeof(e=ge(e))=="string"||e instanceof Ao?sI(i,"updateDoc",n._key,e,t,r):rI(i,"updateDoc",n._key,e),eu(s,[a.toMutation(n._key,ct.exists(!0))])}function fI(n){return eu(fn(n.firestore,Vr),[new Dc(n._key,ct.none())])}function dI(n,e){const t=fn(n.firestore,Vr),r=Qc(n),s=uI(n.converter,e);return eu(t,[nI(wp(n.firestore),"addDoc",r._key,s,n.converter!==null,{}).toMutation(r._key,ct.exists(!1))]).then((()=>r))}function pI(n,...e){n=ge(n);let t={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||Vh(e[r])||(t=e[r++]);const s={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(Vh(e[r])){const l=e[r];e[r]=l.next?.bind(l),e[r+1]=l.error?.bind(l),e[r+2]=l.complete?.bind(l)}let i,a,c;if(n instanceof Ee)a=fn(n.firestore,Vr),c=kc(n._key.path),i={next:l=>{e[r]&&e[r](mI(a,n,l))},error:e[r+1],complete:e[r+2]};else{const l=fn(n,wo);a=fn(l.firestore,Vr),c=l._query;const h=new Cp(a);i={next:d=>{e[r]&&e[r](new _r(a,h,l,d))},error:e[r+1],complete:e[r+2]},aI(n._query)}return(function(h,d,m,g){const I=new WT(g),P=new ST(d,I,m);return h.asyncQueue.enqueueAndForget((async()=>wT(await Rh(h),P))),()=>{I.Nu(),h.asyncQueue.enqueueAndForget((async()=>AT(await Rh(h),P)))}})(Ep(a),c,s,i)}function eu(n,e){return(function(r,s){const i=new Ln;return r.asyncQueue.enqueueAndForget((async()=>xT(await QT(r),s,i))),i.promise})(Ep(n),e)}function mI(n,e,t){const r=t.docs.get(e._key),s=new Cp(n);return new xn(n,s,e._key,r,new fs(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(s){Br=s})(Ur),jn(new pn("firestore",((r,{instanceIdentifier:s,options:i})=>{const a=r.getProvider("app").getImmediate(),c=new Vr(new ev(r.getProvider("auth-internal")),new rv(a,r.getProvider("app-check-internal")),(function(h,d){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new x(N.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ss(h.options.projectId,d)})(a,s),a);return i={useFetchStreams:t,...i},c._setSettings(i),c}),"PUBLIC").setMultipleInstances(!0)),vt(xl,Fl,e),vt(xl,Fl,"esm2020")})();function kp(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const gI=kp,Np=new Ms("auth","Firebase",kp());const ji=new vc("@firebase/auth");function _I(n,...e){ji.logLevel<=W.WARN&&ji.warn(`Auth (${Ur}): ${n}`,...e)}function Ti(n,...e){ji.logLevel<=W.ERROR&&ji.error(`Auth (${Ur}): ${n}`,...e)}function Pt(n,...e){throw nu(n,...e)}function ut(n,...e){return nu(n,...e)}function tu(n,e,t){const r={...gI(),[e]:t};return new Ms("auth","Firebase",r).create(e,{appName:n.name})}function Fn(n){return tu(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function yI(n,e,t){const r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&Pt(n,"argument-error"),tu(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function nu(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return Np.create(n,...e)}function $(n,e,...t){if(!n)throw nu(e,...t)}function Ot(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Ti(e),new Error(e)}function Bt(n,e){n||Ot(e)}function Ka(){return typeof self<"u"&&self.location?.href||""}function vI(){return Oh()==="http:"||Oh()==="https:"}function Oh(){return typeof self<"u"&&self.location?.protocol||null}function EI(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(vI()||C_()||"connection"in navigator)?navigator.onLine:!0}function TI(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class js{constructor(e,t){this.shortDelay=e,this.longDelay=t,Bt(t>e,"Short delay should be less than long delay!"),this.isMobile=R_()||k_()}get(){return EI()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function ru(n,e){Bt(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class Dp{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ot("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ot("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ot("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const II={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const wI=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],AI=new js(3e4,6e4);function su(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function zr(n,e,t,r,s={}){return Vp(n,s,async()=>{let i={},a={};r&&(e==="GET"?a=r:i={body:JSON.stringify(r)});const c=Ls({key:n.config.apiKey,...a}).slice(1),l=await n._getAdditionalHeaders();l["Content-Type"]="application/json",n.languageCode&&(l["X-Firebase-Locale"]=n.languageCode);const h={method:e,headers:l,...i};return P_()||(h.referrerPolicy="no-referrer"),n.emulatorConfig&&In(n.emulatorConfig.host)&&(h.credentials="include"),Dp.fetch()(await Op(n,n.config.apiHost,t,c),h)})}async function Vp(n,e,t){n._canInitEmulator=!1;const r={...II,...e};try{const s=new RI(n),i=await Promise.race([t(),s.promise]);s.clearNetworkTimeout();const a=await i.json();if("needConfirmation"in a)throw fi(n,"account-exists-with-different-credential",a);if(i.ok&&!("errorMessage"in a))return a;{const c=i.ok?a.errorMessage:a.error.message,[l,h]=c.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw fi(n,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw fi(n,"email-already-in-use",a);if(l==="USER_DISABLED")throw fi(n,"user-disabled",a);const d=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw tu(n,d,h);Pt(n,d)}}catch(s){if(s instanceof kt)throw s;Pt(n,"network-request-failed",{message:String(s)})}}async function bI(n,e,t,r,s={}){const i=await zr(n,e,t,r,s);return"mfaPendingCredential"in i&&Pt(n,"multi-factor-auth-required",{_serverResponse:i}),i}async function Op(n,e,t,r){const s=`${e}${t}?${r}`,i=n,a=i.config.emulator?ru(n.config,s):`${n.config.apiScheme}://${s}`;return wI.includes(t)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(a).toString():a}class RI{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(ut(this.auth,"network-request-failed")),AI.get())})}}function fi(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const s=ut(n,e,r);return s.customData._tokenResponse=t,s}async function SI(n,e){return zr(n,"POST","/v1/accounts:delete",e)}async function qi(n,e){return zr(n,"POST","/v1/accounts:lookup",e)}function Es(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function PI(n,e=!1){const t=ge(n),r=await t.getIdToken(e),s=iu(r);$(s&&s.exp&&s.auth_time&&s.iat,t.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,a=i?.sign_in_provider;return{claims:s,token:r,authTime:Es(ma(s.auth_time)),issuedAtTime:Es(ma(s.iat)),expirationTime:Es(ma(s.exp)),signInProvider:a||null,signInSecondFactor:i?.sign_in_second_factor||null}}function ma(n){return Number(n)*1e3}function iu(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Ti("JWT malformed, contained fewer than 3 sections"),null;try{const s=Wf(t);return s?JSON.parse(s):(Ti("Failed to decode base64 JWT payload"),null)}catch(s){return Ti("Caught error parsing JWT payload as JSON",s?.toString()),null}}function Mh(n){const e=iu(n);return $(e,"internal-error"),$(typeof e.exp<"u","internal-error"),$(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Ns(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof kt&&CI(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function CI({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class kI{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class Qa{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Es(this.lastLoginAt),this.creationTime=Es(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function zi(n){const e=n.auth,t=await n.getIdToken(),r=await Ns(n,qi(e,{idToken:t}));$(r?.users.length,e,"internal-error");const s=r.users[0];n._notifyReloadListener(s);const i=s.providerUserInfo?.length?Mp(s.providerUserInfo):[],a=DI(n.providerData,i),c=n.isAnonymous,l=!(n.email&&s.passwordHash)&&!a?.length,h=c?l:!1,d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new Qa(s.createdAt,s.lastLoginAt),isAnonymous:h};Object.assign(n,d)}async function NI(n){const e=ge(n);await zi(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function DI(n,e){return[...n.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function Mp(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function VI(n,e){const t=await Vp(n,{},async()=>{const r=Ls({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=n.config,a=await Op(n,s,"/v1/token",`key=${i}`),c=await n._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:c,body:r};return n.emulatorConfig&&In(n.emulatorConfig.host)&&(l.credentials="include"),Dp.fetch()(a,l)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function OI(n,e){return zr(n,"POST","/v2/accounts:revokeToken",su(n,e))}class yr{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){$(e.idToken,"internal-error"),$(typeof e.idToken<"u","internal-error"),$(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Mh(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){$(e.length!==0,"internal-error");const t=Mh(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:($(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:s,expiresIn:i}=await VI(e,t);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:s,expirationTime:i}=t,a=new yr;return r&&($(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),s&&($(typeof s=="string","internal-error",{appName:e}),a.accessToken=s),i&&($(typeof i=="number","internal-error",{appName:e}),a.expirationTime=i),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new yr,this.toJSON())}_performRefresh(){return Ot("not implemented")}}function Zt(n,e){$(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class at{constructor({uid:e,auth:t,stsTokenManager:r,...s}){this.providerId="firebase",this.proactiveRefresh=new kI(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Qa(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await Ns(this,this.stsTokenManager.getToken(this.auth,e));return $(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return PI(this,e)}reload(){return NI(this)}_assign(e){this!==e&&($(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new at({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){$(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await zi(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(rt(this.auth.app))return Promise.reject(Fn(this.auth));const e=await this.getIdToken();return await Ns(this,SI(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const r=t.displayName??void 0,s=t.email??void 0,i=t.phoneNumber??void 0,a=t.photoURL??void 0,c=t.tenantId??void 0,l=t._redirectEventId??void 0,h=t.createdAt??void 0,d=t.lastLoginAt??void 0,{uid:m,emailVerified:g,isAnonymous:I,providerData:P,stsTokenManager:C}=t;$(m&&C,e,"internal-error");const S=yr.fromJSON(this.name,C);$(typeof m=="string",e,"internal-error"),Zt(r,e.name),Zt(s,e.name),$(typeof g=="boolean",e,"internal-error"),$(typeof I=="boolean",e,"internal-error"),Zt(i,e.name),Zt(a,e.name),Zt(c,e.name),Zt(l,e.name),Zt(h,e.name),Zt(d,e.name);const L=new at({uid:m,auth:e,email:s,emailVerified:g,displayName:r,isAnonymous:I,photoURL:a,phoneNumber:i,tenantId:c,stsTokenManager:S,createdAt:h,lastLoginAt:d});return P&&Array.isArray(P)&&(L.providerData=P.map(O=>({...O}))),l&&(L._redirectEventId=l),L}static async _fromIdTokenResponse(e,t,r=!1){const s=new yr;s.updateFromServerResponse(t);const i=new at({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await zi(i),i}static async _fromGetAccountInfoResponse(e,t,r){const s=t.users[0];$(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?Mp(s.providerUserInfo):[],a=!(s.email&&s.passwordHash)&&!i?.length,c=new yr;c.updateFromIdToken(r);const l=new at({uid:s.localId,auth:e,stsTokenManager:c,isAnonymous:a}),h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new Qa(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!i?.length};return Object.assign(l,h),l}}const Lh=new Map;function Mt(n){Bt(n instanceof Function,"Expected a class definition");let e=Lh.get(n);return e?(Bt(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Lh.set(n,e),e)}class Lp{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Lp.type="NONE";const xh=Lp;function Ii(n,e,t){return`firebase:${n}:${e}:${t}`}class vr{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=Ii(this.userKey,s.apiKey,i),this.fullPersistenceKey=Ii("persistence",s.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await qi(this.auth,{idToken:e}).catch(()=>{});return t?at._fromGetAccountInfoResponse(this.auth,t,e):null}return at._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new vr(Mt(xh),e,r);const s=(await Promise.all(t.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let i=s[0]||Mt(xh);const a=Ii(r,e.config.apiKey,e.name);let c=null;for(const h of t)try{const d=await h._get(a);if(d){let m;if(typeof d=="string"){const g=await qi(e,{idToken:d}).catch(()=>{});if(!g)break;m=await at._fromGetAccountInfoResponse(e,g,d)}else m=at._fromJSON(e,d);h!==i&&(c=m),i=h;break}}catch{}const l=s.filter(h=>h._shouldAllowMigration);return!i._shouldAllowMigration||!l.length?new vr(i,e,r):(i=l[0],c&&await i._set(a,c.toJSON()),await Promise.all(t.map(async h=>{if(h!==i)try{await h._remove(a)}catch{}})),new vr(i,e,r))}}function Fh(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Bp(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(xp(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(jp(e))return"Blackberry";if(qp(e))return"Webos";if(Fp(e))return"Safari";if((e.includes("chrome/")||Up(e))&&!e.includes("edge/"))return"Chrome";if($p(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function xp(n=Le()){return/firefox\//i.test(n)}function Fp(n=Le()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Up(n=Le()){return/crios\//i.test(n)}function Bp(n=Le()){return/iemobile/i.test(n)}function $p(n=Le()){return/android/i.test(n)}function jp(n=Le()){return/blackberry/i.test(n)}function qp(n=Le()){return/webos/i.test(n)}function ou(n=Le()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function MI(n=Le()){return ou(n)&&!!window.navigator?.standalone}function LI(){return N_()&&document.documentMode===10}function zp(n=Le()){return ou(n)||$p(n)||qp(n)||jp(n)||/windows phone/i.test(n)||Bp(n)}function Hp(n,e=[]){let t;switch(n){case"Browser":t=Fh(Le());break;case"Worker":t=`${Fh(Le())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Ur}/${r}`}class xI{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=i=>new Promise((a,c)=>{try{const l=e(i);a(l)}catch(l){c(l)}});r.onAbort=t,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const s of t)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}}async function FI(n,e={}){return zr(n,"GET","/v2/passwordPolicy",su(n,e))}const UI=6;class BI{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??UI,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),s&&(t.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}class $I{constructor(e,t,r,s){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Uh(this),this.idTokenSubscription=new Uh(this),this.beforeStateQueue=new xI(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Np,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Mt(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await vr.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await qi(this,{idToken:e}),r=await at._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(rt(this.app)){const i=this.app.settings.authIdToken;return i?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(i).then(a,a))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let r=t,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const i=this.redirectUser?._redirectEventId,a=r?._redirectEventId,c=await this.tryRedirectSignIn(e);(!i||i===a)&&c?.user&&(r=c.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(i){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(i))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return $(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await zi(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=TI()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(rt(this.app))return Promise.reject(Fn(this));const t=e?ge(e):null;return t&&$(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&$(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return rt(this.app)?Promise.reject(Fn(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return rt(this.app)?Promise.reject(Fn(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Mt(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await FI(this),t=new BI(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Ms("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await OI(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Mt(e)||this._popupRedirectResolver;$(t,this,"argument-error"),this.redirectPersistenceManager=await vr.create(this,[Mt(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,s){if(this._deleted)return()=>{};const i=typeof t=="function"?t:t.next.bind(t);let a=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if($(c,this,"internal-error"),c.then(()=>{a||i(this.currentUser)}),typeof t=="function"){const l=e.addObserver(t,r,s);return()=>{a=!0,l()}}else{const l=e.addObserver(t);return()=>{a=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return $(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Hp(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(rt(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&_I(`Error while retrieving App Check token: ${e.error}`),e?.token}}function So(n){return ge(n)}class Uh{constructor(e){this.auth=e,this.observer=null,this.addObserver=U_(t=>this.observer=t)}get next(){return $(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let au={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function jI(n){au=n}function qI(n){return au.loadJS(n)}function zI(){return au.gapiScript}function HI(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function WI(n,e){const t=co(n,"auth");if(t.isInitialized()){const s=t.getImmediate(),i=t.getOptions();if($n(i,e??{}))return s;Pt(s,"already-initialized")}return t.initialize({options:e})}function GI(n,e){const t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(Mt);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function KI(n,e,t){const r=So(n);$(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=Wp(e),{host:a,port:c}=QI(e),l=c===null?"":`:${c}`,h={url:`${i}//${a}${l}/`},d=Object.freeze({host:a,port:c,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){$(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),$($n(h,r.config.emulator)&&$n(d,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=h,r.emulatorConfig=d,r.settings.appVerificationDisabledForTesting=!0,In(a)?(_c(`${i}//${a}${l}`),yc("Auth",!0)):XI()}function Wp(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function QI(n){const e=Wp(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:Bh(r.substr(i.length+1))}}else{const[i,a]=r.split(":");return{host:i,port:Bh(a)}}}function Bh(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function XI(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class Gp{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Ot("not implemented")}_getIdTokenResponse(e){return Ot("not implemented")}_linkToIdToken(e,t){return Ot("not implemented")}_getReauthenticationResolver(e){return Ot("not implemented")}}async function Er(n,e){return bI(n,"POST","/v1/accounts:signInWithIdp",su(n,e))}const JI="http://localhost";class Hn extends Gp{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Hn(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Pt("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,...i}=t;if(!r||!s)return null;const a=new Hn(r,s);return a.idToken=i.idToken||void 0,a.accessToken=i.accessToken||void 0,a.secret=i.secret,a.nonce=i.nonce,a.pendingToken=i.pendingToken||null,a}_getIdTokenResponse(e){const t=this.buildRequest();return Er(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,Er(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Er(e,t)}buildRequest(){const e={requestUri:JI,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Ls(t)}return e}}class cu{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class qs extends cu{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class en extends qs{constructor(){super("facebook.com")}static credential(e){return Hn._fromParams({providerId:en.PROVIDER_ID,signInMethod:en.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return en.credentialFromTaggedObject(e)}static credentialFromError(e){return en.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return en.credential(e.oauthAccessToken)}catch{return null}}}en.FACEBOOK_SIGN_IN_METHOD="facebook.com";en.PROVIDER_ID="facebook.com";class Vt extends qs{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Hn._fromParams({providerId:Vt.PROVIDER_ID,signInMethod:Vt.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Vt.credentialFromTaggedObject(e)}static credentialFromError(e){return Vt.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return Vt.credential(t,r)}catch{return null}}}Vt.GOOGLE_SIGN_IN_METHOD="google.com";Vt.PROVIDER_ID="google.com";class tn extends qs{constructor(){super("github.com")}static credential(e){return Hn._fromParams({providerId:tn.PROVIDER_ID,signInMethod:tn.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return tn.credentialFromTaggedObject(e)}static credentialFromError(e){return tn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return tn.credential(e.oauthAccessToken)}catch{return null}}}tn.GITHUB_SIGN_IN_METHOD="github.com";tn.PROVIDER_ID="github.com";class nn extends qs{constructor(){super("twitter.com")}static credential(e,t){return Hn._fromParams({providerId:nn.PROVIDER_ID,signInMethod:nn.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return nn.credentialFromTaggedObject(e)}static credentialFromError(e){return nn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return nn.credential(t,r)}catch{return null}}}nn.TWITTER_SIGN_IN_METHOD="twitter.com";nn.PROVIDER_ID="twitter.com";class Or{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,s=!1){const i=await at._fromIdTokenResponse(e,r,s),a=$h(r);return new Or({user:i,providerId:a,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const s=$h(r);return new Or({user:e,providerId:s,_tokenResponse:r,operationType:t})}}function $h(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class Hi extends kt{constructor(e,t,r,s){super(t.code,t.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,Hi.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,s){return new Hi(e,t,r,s)}}function Kp(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Hi._fromErrorAndOperation(n,i,e,r):i})}async function YI(n,e,t=!1){const r=await Ns(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Or._forOperation(n,"link",r)}async function ZI(n,e,t=!1){const{auth:r}=n;if(rt(r.app))return Promise.reject(Fn(r));const s="reauthenticate";try{const i=await Ns(n,Kp(r,s,e,n),t);$(i.idToken,r,"internal-error");const a=iu(i.idToken);$(a,r,"internal-error");const{sub:c}=a;return $(n.uid===c,r,"user-mismatch"),Or._forOperation(n,s,i)}catch(i){throw i?.code==="auth/user-not-found"&&Pt(r,"user-mismatch"),i}}async function ew(n,e,t=!1){if(rt(n.app))return Promise.reject(Fn(n));const r="signIn",s=await Kp(n,r,e),i=await Or._fromIdTokenResponse(n,r,s);return t||await n._updateCurrentUser(i.user),i}function tw(n,e,t,r){return ge(n).onIdTokenChanged(e,t,r)}function nw(n,e,t){return ge(n).beforeAuthStateChanged(e,t)}function rw(n,e,t,r){return ge(n).onAuthStateChanged(e,t,r)}function sw(n){return ge(n).signOut()}const Wi="__sak";class Qp{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Wi,"1"),this.storage.removeItem(Wi),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const iw=1e3,ow=10;class Xp extends Qp{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=zp(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),s=this.localCache[t];r!==s&&e(t,s,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((a,c,l)=>{this.notifyListeners(a,l)});return}const r=e.key;t?this.detachListener():this.stopPolling();const s=()=>{const a=this.storage.getItem(r);!t&&this.localCache[r]===a||this.notifyListeners(r,a)},i=this.storage.getItem(r);LI()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,ow):s()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},iw)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Xp.type="LOCAL";const aw=Xp;class Jp extends Qp{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Jp.type="SESSION";const Yp=Jp;function cw(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class Po{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(s=>s.isListeningto(e));if(t)return t;const r=new Po(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:s,data:i}=t.data,a=this.handlersMap[s];if(!a?.size)return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const c=Array.from(a).map(async h=>h(t.origin,i)),l=await cw(c);t.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:l})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Po.receivers=[];function uu(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}class uw{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,a;return new Promise((c,l)=>{const h=uu("",20);s.port1.start();const d=setTimeout(()=>{l(new Error("unsupported_event"))},r);a={messageChannel:s,onMessage(m){const g=m;if(g.data.eventId===h)switch(g.data.status){case"ack":clearTimeout(d),i=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),c(g.data.response);break;default:clearTimeout(d),clearTimeout(i),l(new Error("invalid_response"));break}}},this.handlers.add(a),s.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:h,data:t},[s.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}function At(){return window}function lw(n){At().location.href=n}function Zp(){return typeof At().WorkerGlobalScope<"u"&&typeof At().importScripts=="function"}async function hw(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function fw(){return navigator?.serviceWorker?.controller||null}function dw(){return Zp()?self:null}const em="firebaseLocalStorageDb",pw=1,Gi="firebaseLocalStorage",tm="fbase_key";class zs{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Co(n,e){return n.transaction([Gi],e?"readwrite":"readonly").objectStore(Gi)}function mw(){const n=indexedDB.deleteDatabase(em);return new zs(n).toPromise()}function Xa(){const n=indexedDB.open(em,pw);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(Gi,{keyPath:tm})}catch(s){t(s)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(Gi)?e(r):(r.close(),await mw(),e(await Xa()))})})}async function jh(n,e,t){const r=Co(n,!0).put({[tm]:e,value:t});return new zs(r).toPromise()}async function gw(n,e){const t=Co(n,!1).get(e),r=await new zs(t).toPromise();return r===void 0?null:r.value}function qh(n,e){const t=Co(n,!0).delete(e);return new zs(t).toPromise()}const _w=800,yw=3;class nm{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Xa(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>yw)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Zp()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Po._getInstance(dw()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await hw(),!this.activeServiceWorker)return;this.sender=new uw(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||fw()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Xa();return await jh(e,Wi,"1"),await qh(e,Wi),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>jh(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>gw(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>qh(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=Co(s,!1).getAll();return new zs(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),t.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),t.push(s));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),_w)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}nm.type="LOCAL";const vw=nm;new js(3e4,6e4);function rm(n,e){return e?Mt(e):($(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class lu extends Gp{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Er(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Er(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Er(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Ew(n){return ew(n.auth,new lu(n),n.bypassAuthState)}function Tw(n){const{auth:e,user:t}=n;return $(t,e,"internal-error"),ZI(t,new lu(n),n.bypassAuthState)}async function Iw(n){const{auth:e,user:t}=n;return $(t,e,"internal-error"),YI(t,new lu(n),n.bypassAuthState)}class sm{constructor(e,t,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:s,tenantId:i,error:a,type:c}=e;if(a){this.reject(a);return}const l={auth:this.auth,requestUri:t,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(l))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Ew;case"linkViaPopup":case"linkViaRedirect":return Iw;case"reauthViaPopup":case"reauthViaRedirect":return Tw;default:Pt(this.auth,"internal-error")}}resolve(e){Bt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Bt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const ww=new js(2e3,1e4);async function Aw(n,e,t){if(rt(n.app))return Promise.reject(ut(n,"operation-not-supported-in-this-environment"));const r=So(n);yI(n,e,cu);const s=rm(r,t);return new Vn(r,"signInViaPopup",e,s).executeNotNull()}class Vn extends sm{constructor(e,t,r,s,i){super(e,t,s,i),this.provider=r,this.authWindow=null,this.pollId=null,Vn.currentPopupAction&&Vn.currentPopupAction.cancel(),Vn.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return $(e,this.auth,"internal-error"),e}async onExecution(){Bt(this.filter.length===1,"Popup operations only handle one event");const e=uu();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(ut(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(ut(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Vn.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ut(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,ww.get())};e()}}Vn.currentPopupAction=null;const bw="pendingRedirect",wi=new Map;class Rw extends sm{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=wi.get(this.auth._key());if(!e){try{const r=await Sw(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}wi.set(this.auth._key(),e)}return this.bypassAuthState||wi.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Sw(n,e){const t=kw(e),r=Cw(n);if(!await r._isAvailable())return!1;const s=await r._get(t)==="true";return await r._remove(t),s}function Pw(n,e){wi.set(n._key(),e)}function Cw(n){return Mt(n._redirectPersistence)}function kw(n){return Ii(bw,n.config.apiKey,n.name)}async function Nw(n,e,t=!1){if(rt(n.app))return Promise.reject(Fn(n));const r=So(n),s=rm(r,e),a=await new Rw(r,s,t).execute();return a&&!t&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,e)),a}const Dw=600*1e3;class Vw{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Ow(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!im(e)){const r=e.error.code?.split("auth/")[1]||"internal-error";t.onError(ut(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Dw&&this.cachedEventUids.clear(),this.cachedEventUids.has(zh(e))}saveEventToCache(e){this.cachedEventUids.add(zh(e)),this.lastProcessedEventTime=Date.now()}}function zh(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function im({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function Ow(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return im(n);default:return!1}}async function Mw(n,e={}){return zr(n,"GET","/v1/projects",e)}const Lw=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,xw=/^https?/;async function Fw(n){if(n.config.emulator)return;const{authorizedDomains:e}=await Mw(n);for(const t of e)try{if(Uw(t))return}catch{}Pt(n,"unauthorized-domain")}function Uw(n){const e=Ka(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const a=new URL(n);return a.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&a.hostname===r}if(!xw.test(t))return!1;if(Lw.test(n))return r===n;const s=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}const Bw=new js(3e4,6e4);function Hh(){const n=At().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function $w(n){return new Promise((e,t)=>{function r(){Hh(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Hh(),t(ut(n,"network-request-failed"))},timeout:Bw.get()})}if(At().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(At().gapi?.load)r();else{const s=HI("iframefcb");return At()[s]=()=>{gapi.load?r():t(ut(n,"network-request-failed"))},qI(`${zI()}?onload=${s}`).catch(i=>t(i))}}).catch(e=>{throw Ai=null,e})}let Ai=null;function jw(n){return Ai=Ai||$w(n),Ai}const qw=new js(5e3,15e3),zw="__/auth/iframe",Hw="emulator/auth/iframe",Ww={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Gw=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Kw(n){const e=n.config;$(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?ru(e,Hw):`https://${n.config.authDomain}/${zw}`,r={apiKey:e.apiKey,appName:n.name,v:Ur},s=Gw.get(n.config.apiHost);s&&(r.eid=s);const i=n._getFrameworks();return i.length&&(r.fw=i.join(",")),`${t}?${Ls(r).slice(1)}`}async function Qw(n){const e=await jw(n),t=At().gapi;return $(t,n,"internal-error"),e.open({where:document.body,url:Kw(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Ww,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const a=ut(n,"network-request-failed"),c=At().setTimeout(()=>{i(a)},qw.get());function l(){At().clearTimeout(c),s(r)}r.ping(l).then(l,()=>{i(a)})}))}const Xw={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Jw=500,Yw=600,Zw="_blank",eA="http://localhost";class Wh{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function tA(n,e,t,r=Jw,s=Yw){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let c="";const l={...Xw,width:r.toString(),height:s.toString(),top:i,left:a},h=Le().toLowerCase();t&&(c=Up(h)?Zw:t),xp(h)&&(e=e||eA,l.scrollbars="yes");const d=Object.entries(l).reduce((g,[I,P])=>`${g}${I}=${P},`,"");if(MI(h)&&c!=="_self")return nA(e||"",c),new Wh(null);const m=window.open(e||"",c,d);$(m,n,"popup-blocked");try{m.focus()}catch{}return new Wh(m)}function nA(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}const rA="__/auth/handler",sA="emulator/auth/handler",iA=encodeURIComponent("fac");async function Gh(n,e,t,r,s,i){$(n.config.authDomain,n,"auth-domain-config-required"),$(n.config.apiKey,n,"invalid-api-key");const a={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Ur,eventId:s};if(e instanceof cu){e.setDefaultLanguage(n.languageCode),a.providerId=e.providerId||"",F_(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,m]of Object.entries({}))a[d]=m}if(e instanceof qs){const d=e.getScopes().filter(m=>m!=="");d.length>0&&(a.scopes=d.join(","))}n.tenantId&&(a.tid=n.tenantId);const c=a;for(const d of Object.keys(c))c[d]===void 0&&delete c[d];const l=await n._getAppCheckToken(),h=l?`#${iA}=${encodeURIComponent(l)}`:"";return`${oA(n)}?${Ls(c).slice(1)}${h}`}function oA({config:n}){return n.emulator?ru(n,sA):`https://${n.authDomain}/${rA}`}const ga="webStorageSupport";class aA{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Yp,this._completeRedirectFn=Nw,this._overrideRedirectResult=Pw}async _openPopup(e,t,r,s){Bt(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const i=await Gh(e,t,r,Ka(),s);return tA(e,i,uu())}async _openRedirect(e,t,r,s){await this._originValidation(e);const i=await Gh(e,t,r,Ka(),s);return lw(i),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:s,promise:i}=this.eventManagers[t];return s?Promise.resolve(s):(Bt(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await Qw(e),r=new Vw(e);return t.register("authEvent",s=>($(s?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(ga,{type:ga},s=>{const i=s?.[0]?.[ga];i!==void 0&&t(!!i),Pt(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=Fw(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return zp()||Fp()||ou()}}const cA=aA;var Kh="@firebase/auth",Qh="1.11.1";class uA{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){$(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function lA(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function hA(n){jn(new pn("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:a,authDomain:c}=r.options;$(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:a,authDomain:c,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Hp(n)},h=new $I(r,s,i,l);return GI(h,t),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),jn(new pn("auth-internal",e=>{const t=So(e.getProvider("auth").getImmediate());return(r=>new uA(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),vt(Kh,Qh,lA(n)),vt(Kh,Qh,"esm2020")}const fA=300,dA=Xf("authIdTokenMaxAge")||fA;let Xh=null;const pA=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>dA)return;const s=t?.token;Xh!==s&&(Xh=s,await fetch(n,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function mA(n=Tc()){const e=co(n,"auth");if(e.isInitialized())return e.getImmediate();const t=WI(n,{popupRedirectResolver:cA,persistence:[vw,aw,Yp]}),r=Xf("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const a=pA(i.toString());nw(t,a,()=>a(t.currentUser)),tw(t,c=>a(c))}}const s=Gf("auth");return s&&KI(t,`http://${s}`),t}function gA(){return document.getElementsByTagName("head")?.[0]??document}jI({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=s=>{const i=ut("internal-error");i.customData=s,t(i)},r.type="text/javascript",r.charset="UTF-8",gA().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});hA("Browser");const _A={apiKey:"AIzaSyBC5VHNEcVL9KP8M0d64ZajF6P4Hzqzafc",authDomain:"bbnme-58716.firebaseapp.com",projectId:"bbnme-58716",storageBucket:"bbnme-58716.appspot.com",messagingSenderId:"155088179379",appId:"1:155088179379:web:5d98445c178b7513f520c6"},hu=Zf(_A),Ki=JT(hu),fu=mA(hu),yA=new Vt,ko=mc(null),om=mc(!0);rw(fu,n=>{ko.set(n),om.set(!1)});var vA=Ie('<button class="svelte-18sv61c"> </button>');function Wn(n,e){let t=mr(e,"label",8,"Button"),r=mr(e,"onClick",8,()=>{});var s=vA(),i=ye(s);br(()=>pc(i,t())),Os("click",s,function(...a){r()?.apply(this,a)}),le(n,s)}var EA=Ie('<div class="login-container svelte-8ukb9p"><h2 class="svelte-8ukb9p">Please sign in to continue</h2> <!></div>');function TA(n,e){qt(e,!1),Tn();var t=EA(),r=he(ye(t),2);Wn(r,{label:"Sign in with Google",onClick:()=>Aw(fu,yA)}),le(n,t),zt()}var IA=Ie('<button class="hamburger-button svelte-p9dp8"><div class="bar svelte-p9dp8"></div> <div class="bar svelte-p9dp8"></div> <div class="bar svelte-p9dp8"></div></button>');function wA(n,e){qt(e,!1);const t=gc();function r(){t("toggle")}Tn();var s=IA();Os("click",s,r),le(n,s),zt()}var AA=Ie('<span class="not-authorized-message svelte-rfuq4y">Unauthorized user</span>'),bA=Ie(`<nav class="svelte-rfuq4y"><!> <div class="navbar-title svelte-rfuq4y"><h1 class="svelte-rfuq4y">bb'n'me</h1></div> <div class="user-status svelte-rfuq4y"><!></div></nav>`);function RA(n,e){qt(e,!1);const t=()=>cn(l,"$isAuthorizedToWriteStore",s),r=()=>cn(ko,"$user",s),[s,i]=oo(),a=je(),c=gc(),l=oc("isAuthorizedToWrite");function h(){c("toggle")}ro(()=>t(),()=>{ee(a,t())}),so(),Tn();var d=bA(),m=ye(d);wA(m,{$$events:{toggle:h}});var g=he(m,4),I=ye(g);{var P=C=>{var S=AA();le(C,S)};yt(I,C=>{r()&&!F(a)&&C(P)})}le(n,d),zt(),i()}var SA=Ie('<span class="not-authorized-message svelte-12buoxc">Unauthorized user</span>'),PA=Ie('<div class="user-profile svelte-12buoxc"><img alt="Profile" class="svelte-12buoxc"/> <span class="svelte-12buoxc"> </span> <!></div> <div class="nav-links-wrapper svelte-12buoxc"><div class="nav-links svelte-12buoxc"><a href="/" class="svelte-12buoxc">Home</a></div></div> <div class="sidenav-footer svelte-12buoxc"><!></div>',1),CA=Ie('<div><button class="close-button svelte-12buoxc">&times;</button> <!></div>');function kA(n,e){qt(e,!1);const t=()=>cn(h,"$isAuthorizedToWriteStore",s),r=()=>cn(ko,"$user",s),[s,i]=oo(),a=je();let c=mr(e,"isOpen",8,!1);const l=gc(),h=oc("isAuthorizedToWrite");function d(){l("close")}ro(()=>t(),()=>{ee(a,t())}),so(),Tn();var m=CA();let g;var I=ye(m),P=he(I,2);{var C=S=>{var L=PA(),O=fr(L),V=ye(O),z=he(V,2),Y=ye(z),Z=he(z,2);{var T=w=>{var E=SA();le(w,E)};yt(Z,w=>{F(a)||w(T)})}var _=he(O,4),y=ye(_);Wn(y,{label:"Sign out",onClick:()=>sw(fu)}),br(()=>{pi(V,"src",(r(),He(()=>r().photoURL))),pc(Y,(r(),He(()=>r().displayName)))}),le(S,L)};yt(P,S=>{r()&&S(C)})}br(()=>g=Bf(m,1,"sidenav svelte-12buoxc",null,g,{open:c()})),Os("click",I,d),le(n,m),zt(),i()}var NA=Ie('<form class="svelte-7mtrh0"><h2 class="svelte-7mtrh0">Add a new place</h2> <input type="text" placeholder="Place name" required class="svelte-7mtrh0"/> <input type="url" placeholder="Website" class="svelte-7mtrh0"/> <input type="url" placeholder="Image URL" class="svelte-7mtrh0"/> <!></form>');function DA(n,e){qt(e,!1);let t=je(""),r=je(""),s=je("");async function i(){try{const m=await dI(vp(Ki,"places"),{name:F(t),website:F(r),image:F(s)});console.log("Document written with ID: ",m.id),ee(t,""),ee(r,""),ee(s,"")}catch(m){console.error("Error adding document: ",m)}}Tn();var a=NA(),c=he(ye(a),2),l=he(c,2),h=he(l,2),d=he(h,2);Wn(d,{label:"Add Place",type:"submit"}),pr(c,()=>F(t),m=>ee(t,m)),pr(l,()=>F(r),m=>ee(r,m)),pr(h,()=>F(s),m=>ee(s,m)),Os("submit",a,$f(i)),le(n,a),zt()}var VA=Ie('<div class="card svelte-1udyrqm"><!></div>');function Ja(n,e){var t=VA(),r=ye(t);r_(r,e,"default",{}),le(n,t)}var OA=Ie('<form class="svelte-136zmjt"><h2 class="svelte-136zmjt">Edit Place</h2> <input type="text" placeholder="Place name" required class="svelte-136zmjt"/> <input type="url" placeholder="Website" class="svelte-136zmjt"/> <input type="url" placeholder="Image URL" class="svelte-136zmjt"/> <div class="actions svelte-136zmjt"><!> <!></div></form>');function MA(n,e){qt(e,!1);let t=mr(e,"place",8),r=mr(e,"onSave",8,()=>{}),s=mr(e,"onCancel",8,()=>{}),i=je(t().name),a=je(t().website),c=je(t().image);async function l(){try{const S=Qc(Ki,"places",t().id);await hI(S,{name:F(i),website:F(a),image:F(c)}),console.log("Document successfully updated!"),r()()}catch(S){console.error("Error updating document: ",S)}}Tn();var h=OA(),d=he(ye(h),2),m=he(d,2),g=he(m,2),I=he(g,2),P=ye(I);Wn(P,{label:"Save",type:"submit"});var C=he(P,2);Wn(C,{label:"Cancel",get onClick(){return s()}}),pr(d,()=>F(i),S=>ee(i,S)),pr(m,()=>F(a),S=>ee(a,S)),pr(g,()=>F(c),S=>ee(c,S)),Os("submit",h,$f(l)),le(n,h),zt()}var LA=Ie('<a target="_blank" rel="noreferrer"><img class="svelte-13geuu4"/></a>'),xA=Ie('<div class="actions svelte-13geuu4"><!> <!></div>'),FA=Ie('<h3 class="svelte-13geuu4"><b> </b></h3> <!> <!>',1),UA=Ie('<div class="svelte-13geuu4"><h2 class="svelte-13geuu4">Travel Wishlist</h2> <!></div>');function BA(n,e){qt(e,!1);const t=()=>cn(a,"$isAuthorizedToWriteStore",r),[r,s]=oo(),i=je(),a=oc("isAuthorizedToWrite");let c=je([]),l=je(null);qf(()=>{const C=pI(vp(Ki,"places"),S=>{ee(c,S.docs.map(L=>({id:L.id,...L.data()})))});return()=>C()});async function h(C){try{await fI(Qc(Ki,"places",C)),console.log("Document successfully deleted!")}catch(S){console.error("Error removing document: ",S)}}function d(C){ee(l,C)}function m(){ee(l,null)}function g(){ee(l,null)}ro(()=>t(),()=>{ee(i,t())}),so(),Tn();var I=UA(),P=he(ye(I),2);t_(P,1,()=>F(c),Zg,(C,S)=>{Ja(C,{children:(L,O)=>{var V=Aa(),z=fr(V);{var Y=T=>{MA(T,{get place(){return F(l)},onSave:m,onCancel:g})},Z=T=>{var _=FA(),y=fr(_),w=ye(y),E=ye(w),A=he(y,2);{var v=it=>{var xe=LA(),Fe=ye(xe);br(()=>{pi(xe,"href",(F(S),He(()=>F(S).website))),pi(Fe,"src",(F(S),He(()=>F(S).image))),pi(Fe,"alt",(F(S),He(()=>F(S).name)))}),le(it,xe)};yt(A,it=>{F(S),He(()=>F(S).image)&&it(v)})}var de=he(A,2);{var Xe=it=>{var xe=xA(),Fe=ye(xe);Wn(Fe,{label:"Edit",onClick:()=>d(F(S))});var Nt=he(Fe,2);Wn(Nt,{label:"Delete",onClick:()=>h(F(S).id)}),le(it,xe)};yt(de,it=>{F(i)&&it(Xe)})}br(()=>pc(E,(F(S),He(()=>F(S).name)))),le(T,_)};yt(z,T=>{F(l),F(S),He(()=>F(l)&&F(l).id===F(S).id)?T(Y):T(Z,!1)})}le(L,V)},$$slots:{default:!0}})}),le(n,I),zt(),s()}const $A="type.googleapis.com/google.protobuf.Int64Value",jA="type.googleapis.com/google.protobuf.UInt64Value";function am(n,e){const t={};for(const r in n)n.hasOwnProperty(r)&&(t[r]=e(n[r]));return t}function Qi(n){if(n==null)return null;if(n instanceof Number&&(n=n.valueOf()),typeof n=="number"&&isFinite(n)||n===!0||n===!1||Object.prototype.toString.call(n)==="[object String]")return n;if(n instanceof Date)return n.toISOString();if(Array.isArray(n))return n.map(e=>Qi(e));if(typeof n=="function"||typeof n=="object")return am(n,e=>Qi(e));throw new Error("Data cannot be encoded in JSON: "+n)}function Mr(n){if(n==null)return n;if(n["@type"])switch(n["@type"]){case $A:case jA:{const e=Number(n.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+n);return e}default:throw new Error("Data cannot be decoded from JSON: "+n)}return Array.isArray(n)?n.map(e=>Mr(e)):typeof n=="function"||typeof n=="object"?am(n,e=>Mr(e)):n}const du="functions";const Jh={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ke extends kt{constructor(e,t,r){super(`${du}/${e}`,t||""),this.details=r,Object.setPrototypeOf(this,Ke.prototype)}}function qA(n){if(n>=200&&n<300)return"ok";switch(n){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function Xi(n,e){let t=qA(n),r=t,s;try{const i=e&&e.error;if(i){const a=i.status;if(typeof a=="string"){if(!Jh[a])return new Ke("internal","internal");t=Jh[a],r=a}const c=i.message;typeof c=="string"&&(r=c),s=i.details,s!==void 0&&(s=Mr(s))}}catch{}return t==="ok"?null:new Ke(t,r,s)}class zA{constructor(e,t,r,s){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,rt(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=t.getImmediate({optional:!0}),this.messaging=r.getImmediate({optional:!0}),this.auth||t.get().then(i=>this.auth=i,()=>{}),this.messaging||r.get().then(i=>this.messaging=i,()=>{}),this.appCheck||s?.get().then(i=>this.appCheck=i,()=>{})}async getAuthToken(){if(this.auth)try{return(await this.auth.getToken())?.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){const t=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return t.error?null:t.token}return null}async getContext(e){const t=await this.getAuthToken(),r=await this.getMessagingToken(),s=await this.getAppCheckToken(e);return{authToken:t,messagingToken:r,appCheckToken:s}}}const Ya="us-central1",HA=/^data: (.*?)(?:\n|$)/;function WA(n){let e=null;return{promise:new Promise((t,r)=>{e=setTimeout(()=>{r(new Ke("deadline-exceeded","deadline-exceeded"))},n)}),cancel:()=>{e&&clearTimeout(e)}}}class GA{constructor(e,t,r,s,i=Ya,a=(...c)=>fetch(...c)){this.app=e,this.fetchImpl=a,this.emulatorOrigin=null,this.contextProvider=new zA(e,t,r,s),this.cancelAllRequests=new Promise(c=>{this.deleteService=()=>Promise.resolve(c())});try{const c=new URL(i);this.customDomain=c.origin+(c.pathname==="/"?"":c.pathname),this.region=Ya}catch{this.customDomain=null,this.region=i}}_delete(){return this.deleteService()}_url(e){const t=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${t}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${t}.cloudfunctions.net/${e}`}}function KA(n,e,t){const r=In(e);n.emulatorOrigin=`http${r?"s":""}://${e}:${t}`,r&&(_c(n.emulatorOrigin+"/backends"),yc("Functions",!0))}function QA(n,e,t){const r=s=>JA(n,e,s,{});return r.stream=(s,i)=>ZA(n,e,s,i),r}function cm(n){return n.emulatorOrigin&&In(n.emulatorOrigin)?"include":void 0}async function XA(n,e,t,r,s){t["Content-Type"]="application/json";let i;try{i=await r(n,{method:"POST",body:JSON.stringify(e),headers:t,credentials:cm(s)})}catch{return{status:0,json:null}}let a=null;try{a=await i.json()}catch{}return{status:i.status,json:a}}async function um(n,e){const t={},r=await n.contextProvider.getContext(e.limitedUseAppCheckTokens);return r.authToken&&(t.Authorization="Bearer "+r.authToken),r.messagingToken&&(t["Firebase-Instance-ID-Token"]=r.messagingToken),r.appCheckToken!==null&&(t["X-Firebase-AppCheck"]=r.appCheckToken),t}function JA(n,e,t,r){const s=n._url(e);return YA(n,s,t,r)}async function YA(n,e,t,r){t=Qi(t);const s={data:t},i=await um(n,r),a=r.timeout||7e4,c=WA(a),l=await Promise.race([XA(e,s,i,n.fetchImpl,n),c.promise,n.cancelAllRequests]);if(c.cancel(),!l)throw new Ke("cancelled","Firebase Functions instance was deleted.");const h=Xi(l.status,l.json);if(h)throw h;if(!l.json)throw new Ke("internal","Response is not valid JSON object.");let d=l.json.data;if(typeof d>"u"&&(d=l.json.result),typeof d>"u")throw new Ke("internal","Response is missing data field.");return{data:Mr(d)}}function ZA(n,e,t,r){const s=n._url(e);return eb(n,s,t,r||{})}async function eb(n,e,t,r){t=Qi(t);const s={data:t},i=await um(n,r);i["Content-Type"]="application/json",i.Accept="text/event-stream";let a;try{a=await n.fetchImpl(e,{method:"POST",body:JSON.stringify(s),headers:i,signal:r?.signal,credentials:cm(n)})}catch(g){if(g instanceof Error&&g.name==="AbortError"){const P=new Ke("cancelled","Request was cancelled.");return{data:Promise.reject(P),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(P)}}}}}}const I=Xi(0,null);return{data:Promise.reject(I),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(I)}}}}}}let c,l;const h=new Promise((g,I)=>{c=g,l=I});r?.signal?.addEventListener("abort",()=>{const g=new Ke("cancelled","Request was cancelled.");l(g)});const d=a.body.getReader(),m=tb(d,c,l,r?.signal);return{stream:{[Symbol.asyncIterator](){const g=m.getReader();return{async next(){const{value:I,done:P}=await g.read();return{value:I,done:P}},async return(){return await g.cancel(),{done:!0,value:void 0}}}}},data:h}}function tb(n,e,t,r){const s=(a,c)=>{const l=a.match(HA);if(!l)return;const h=l[1];try{const d=JSON.parse(h);if("result"in d){e(Mr(d.result));return}if("message"in d){c.enqueue(Mr(d.message));return}if("error"in d){const m=Xi(0,d);c.error(m),t(m);return}}catch(d){if(d instanceof Ke){c.error(d),t(d);return}}},i=new TextDecoder;return new ReadableStream({start(a){let c="";return l();async function l(){if(r?.aborted){const h=new Ke("cancelled","Request was cancelled");return a.error(h),t(h),Promise.resolve()}try{const{value:h,done:d}=await n.read();if(d){c.trim()&&s(c.trim(),a),a.close();return}if(r?.aborted){const g=new Ke("cancelled","Request was cancelled");a.error(g),t(g),await n.cancel();return}c+=i.decode(h,{stream:!0});const m=c.split(`
`);c=m.pop()||"";for(const g of m)g.trim()&&s(g.trim(),a);return l()}catch(h){const d=h instanceof Ke?h:Xi(0,null);a.error(d),t(d)}}},cancel(){return n.cancel()}})}const Yh="@firebase/functions",Zh="0.13.1";const nb="auth-internal",rb="app-check-internal",sb="messaging-internal";function ib(n){const e=(t,{instanceIdentifier:r})=>{const s=t.getProvider("app").getImmediate(),i=t.getProvider(nb),a=t.getProvider(sb),c=t.getProvider(rb);return new GA(s,i,a,c,r)};jn(new pn(du,e,"PUBLIC").setMultipleInstances(!0)),vt(Yh,Zh,n),vt(Yh,Zh,"esm2020")}function ob(n=Tc(),e=Ya){const r=co(ge(n),du).getImmediate({identifier:e}),s=Kf("functions");return s&&ab(r,...s),r}function ab(n,e,t){KA(ge(n),e,t)}function cb(n,e,t){return QA(ge(n),e)}ib();var ub=Ie('<div class="loading-screen svelte-1n46o8q"><img src="./assets/loading_image.png" alt="Loading..." class="loading-image svelte-1n46o8q"/></div>'),lb=Ie("<p>Checking authorization...</p>"),hb=Ie('<!> <!> <div class="container svelte-1n46o8q"><!> <!></div>',1),fb=Ie("<main><!></main>");function db(n,e){qt(e,!1);const t=()=>cn(om,"$authLoading",i),r=()=>cn(ko,"$user",i),s=()=>cn(d,"$isAuthorizedToWriteStore",i),[i,a]=oo(),c=ob(hu),l=cb(c,"checkAuthorization"),h=1e3,d=mc(!1);let m=je(!1),g=je(!1);pg("isAuthorizedToWrite",d),qf(()=>{setTimeout(()=>{},h)});function I(){ee(g,!F(g))}ro(()=>(t(),r()),()=>{!t()&&r()?l().then(V=>{d.set(V.data.status==="authorized"),ee(m,!0)}).catch(V=>{console.error("Error checking authorization:",V),d.set(!1),ee(m,!0)}):!t()&&!r()?(d.set(!1),ee(m,!0)):(d.set(!1),ee(m,!1))}),so(),Tn();var P=fb();let C;var S=ye(P);{var L=V=>{var z=ub();le(V,z)},O=V=>{var z=Aa(),Y=fr(z);{var Z=_=>{var y=hb(),w=fr(y);RA(w,{$$events:{toggle:I}});var E=he(w,2);kA(E,{get isOpen(){return F(g)},$$events:{close:I}});var A=he(E,2),v=ye(A);{var de=xe=>{var Fe=Aa(),Nt=fr(Fe);{var Hr=Jn=>{Ja(Jn,{children:(Hs,No)=>{DA(Hs,{})},$$slots:{default:!0}})};yt(Nt,Jn=>{s()&&Jn(Hr)})}le(xe,Fe)},Xe=xe=>{Ja(xe,{children:(Fe,Nt)=>{var Hr=lb();le(Fe,Hr)},$$slots:{default:!0}})};yt(v,xe=>{F(m)?xe(de):xe(Xe,!1)})}var it=he(v,2);BA(it,{}),le(_,y)},T=_=>{TA(_,{})};yt(Y,_=>{r()?_(Z):_(T,!1)},!0)}le(V,z)};yt(S,V=>{t()||!F(m)?V(L):V(O,!1)})}br(()=>C=Bf(P,1,"svelte-1n46o8q",null,C,{"fullscreen-main":t()||!F(m)})),le(n,P),zt(),a()}Qg(db,{target:document.getElementById("app")});
